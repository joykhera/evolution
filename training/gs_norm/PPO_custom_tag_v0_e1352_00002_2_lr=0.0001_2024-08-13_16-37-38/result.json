{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.17551196695517296, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.5045047114135097, "policy_loss": -0.004579772571811364, "vf_loss": 3.5077445387209534, "vf_explained_var": 0.0020764905308920238, "kl": 0.006699777618302373, "entropy": 1.6026823810168676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.502151715174002, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.301215428397769, "policy_loss": -0.001158324159711363, "vf_loss": 6.30181309659645, "vf_explained_var": 0.005428872758118564, "kl": 0.002803142951395376, "entropy": 1.6065978844329794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 294.0, "episode_reward_min": -146.0, "episode_reward_mean": 29.333333333333332, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -206.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.0, "predator_policy": 88.0}, "policy_reward_mean": {"prey_policy": -10.055555555555555, "predator_policy": 24.72222222222222}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, -22.0, -3.0, 14.0, -26.0, 77.0, 90.0, -22.0, 15.0, 29.0, -23.0, -146.0, 121.0, 191.0, 294.0, -55.0, -93.0, 71.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.0, 11.0, -111.0, 2.0, 2.0, -22.0, 14.0, 0.0, -118.0, 11.0, 22.0, 52.0, 88.0, 0.0, -175.0, 0.0, 10.0, -46.0, 3.0, 0.0, -62.0, 7.0, -154.0, -138.0, 43.0, 68.0, 191.0, 0.0, 121.0, 169.0, -110.0, 0.0, -46.0, -124.0, -206.0, 131.0], "policy_predator_policy_reward": [0.0, 0.0, 87.0, 0.0, 0.0, 17.0, 0.0, 0.0, 55.0, 26.0, 3.0, 0.0, 2.0, 0.0, 83.0, 70.0, 51.0, 0.0, 0.0, 26.0, 0.0, 32.0, 69.0, 77.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 55.0, 75.0, 2.0, 88.0, 58.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9327363342694596, "mean_inference_ms": 2.856286394543577, "mean_action_processing_ms": 0.35634242567929, "mean_env_wait_ms": 0.31965535307825094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017543633778889973, "StateBufferConnector_ms": 0.0034888585408528647, "ViewRequirementAgentConnector_ms": 0.12567241986592612}, "num_episodes": 18, "episode_return_max": 294.0, "episode_return_min": -146.0, "episode_return_mean": 29.333333333333332, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.1568456378977, "num_env_steps_trained_throughput_per_sec": 320.1568456378977, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12493.887, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12493.825, "sample_time_ms": 2071.204, "learn_time_ms": 10404.941, "learn_throughput": 384.433, "synch_weights_time_ms": 15.041}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "e1352_00002", "date": "2024-08-13_19-01-55", "timestamp": 1723590115, "time_this_iter_s": 12.550344228744507, "time_total_s": 12.550344228744507, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17b8040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.550344228744507, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 57.363157894736844, "ram_util_percent": 83.65789473684211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.26230903708390774, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.571358865026444, "policy_loss": -0.001041236276142102, "vf_loss": 3.5714999361643716, "vf_explained_var": -0.00010158306076413109, "kl": 0.00450080568358087, "entropy": 1.598251101075026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0629363459884804, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.951060342031812, "policy_loss": -0.0019018463765778555, "vf_loss": 6.952372272430904, "vf_explained_var": 0.02484385642425093, "kl": 0.005899226102974545, "entropy": 1.6033630494718198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 294.0, "episode_reward_min": -305.0, "episode_reward_mean": 27.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -250.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.0, "predator_policy": 157.0}, "policy_reward_mean": {"prey_policy": -16.180555555555557, "predator_policy": 29.930555555555557}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, -22.0, -3.0, 14.0, -26.0, 77.0, 90.0, -22.0, 15.0, 29.0, -23.0, -146.0, 121.0, 191.0, 294.0, -55.0, -93.0, 71.0, 108.0, 85.0, 46.0, -18.0, 215.0, 88.0, 219.0, -305.0, -295.0, 92.0, 205.0, 19.0, -25.0, 103.0, -26.0, -63.0, -18.0, 32.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.0, 11.0, -111.0, 2.0, 2.0, -22.0, 14.0, 0.0, -118.0, 11.0, 22.0, 52.0, 88.0, 0.0, -175.0, 0.0, 10.0, -46.0, 3.0, 0.0, -62.0, 7.0, -154.0, -138.0, 43.0, 68.0, 191.0, 0.0, 121.0, 169.0, -110.0, 0.0, -46.0, -124.0, -206.0, 131.0, 0.0, 79.0, 16.0, 43.0, 171.0, -250.0, 20.0, -94.0, 27.0, 182.0, 84.0, -7.0, 140.0, 10.0, -224.0, -238.0, -243.0, -214.0, -205.0, 164.0, 149.0, 12.0, -2.0, 9.0, 68.0, -191.0, 77.0, 4.0, -226.0, 51.0, 11.0, -153.0, -44.0, -61.0, 31.0, 1.0], "policy_predator_policy_reward": [0.0, 0.0, 87.0, 0.0, 0.0, 17.0, 0.0, 0.0, 55.0, 26.0, 3.0, 0.0, 2.0, 0.0, 83.0, 70.0, 51.0, 0.0, 0.0, 26.0, 0.0, 32.0, 69.0, 77.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 55.0, 75.0, 2.0, 88.0, 58.0, 2.0, 27.0, 0.0, 26.0, 125.0, 0.0, 1.0, 55.0, 0.0, 6.0, 0.0, 11.0, 45.0, 24.0, 157.0, 0.0, 40.0, 122.0, 34.0, 99.0, 38.0, 6.0, 1.0, 11.0, 12.0, 86.0, 0.0, 22.0, 31.0, 118.0, 79.0, 0.0, 39.0, 48.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9892626770633153, "mean_inference_ms": 3.0189096290197557, "mean_action_processing_ms": 0.3844352452666823, "mean_env_wait_ms": 0.3397908946473967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043358405431111656, "StateBufferConnector_ms": 0.003599789407518175, "ViewRequirementAgentConnector_ms": 0.2200133270687527}, "num_episodes": 18, "episode_return_max": 294.0, "episode_return_min": -305.0, "episode_return_mean": 27.5, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.176679004423637, "num_env_steps_trained_throughput_per_sec": 21.176679004423637, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 100690.479, "restore_workers_time_ms": 0.058, "training_step_time_ms": 100690.354, "sample_time_ms": 2311.167, "learn_time_ms": 98363.681, "learn_throughput": 40.665, "synch_weights_time_ms": 13.624}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "e1352_00002", "date": "2024-08-13_19-05-07", "timestamp": 1723590307, "time_this_iter_s": 188.91773414611816, "time_total_s": 201.46807837486267, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1710790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 201.46807837486267, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 64.11739130434783, "ram_util_percent": 83.85217391304349}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.23769419197012823, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 4.837277265578981, "policy_loss": -0.002827627019138721, "vf_loss": 4.839119980701063, "vf_explained_var": 0.00010972218538718248, "kl": 0.009848888107280535, "entropy": 1.5954298010578862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8146404214952357, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.553964360050424, "policy_loss": -0.006216755800599617, "vf_loss": 6.5596132399543885, "vf_explained_var": 0.006686475636467101, "kl": 0.0056785922861425425, "entropy": 1.5989684656814294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 294.0, "episode_reward_min": -305.0, "episode_reward_mean": 12.333333333333334, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -300.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.0, "predator_policy": 157.0}, "policy_reward_mean": {"prey_policy": -27.796296296296298, "predator_policy": 33.96296296296296}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, -22.0, -3.0, 14.0, -26.0, 77.0, 90.0, -22.0, 15.0, 29.0, -23.0, -146.0, 121.0, 191.0, 294.0, -55.0, -93.0, 71.0, 108.0, 85.0, 46.0, -18.0, 215.0, 88.0, 219.0, -305.0, -295.0, 92.0, 205.0, 19.0, -25.0, 103.0, -26.0, -63.0, -18.0, 32.0, 231.0, -7.0, 114.0, -111.0, 33.0, -7.0, -112.0, -136.0, -116.0, -128.0, -28.0, -23.0, -38.0, -25.0, 78.0, -67.0, 15.0, 3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.0, 11.0, -111.0, 2.0, 2.0, -22.0, 14.0, 0.0, -118.0, 11.0, 22.0, 52.0, 88.0, 0.0, -175.0, 0.0, 10.0, -46.0, 3.0, 0.0, -62.0, 7.0, -154.0, -138.0, 43.0, 68.0, 191.0, 0.0, 121.0, 169.0, -110.0, 0.0, -46.0, -124.0, -206.0, 131.0, 0.0, 79.0, 16.0, 43.0, 171.0, -250.0, 20.0, -94.0, 27.0, 182.0, 84.0, -7.0, 140.0, 10.0, -224.0, -238.0, -243.0, -214.0, -205.0, 164.0, 149.0, 12.0, -2.0, 9.0, 68.0, -191.0, 77.0, 4.0, -226.0, 51.0, 11.0, -153.0, -44.0, -61.0, 31.0, 1.0, 158.0, 73.0, -122.0, 24.0, 15.0, 76.0, -90.0, -140.0, -21.0, -39.0, 14.0, -126.0, -209.0, -20.0, 13.0, -300.0, -273.0, -46.0, -281.0, 6.0, -6.0, -97.0, -128.0, -29.0, -37.0, -68.0, -12.0, -60.0, 2.0, 76.0, -106.0, -68.0, 0.0, -19.0, 0.0, 3.0], "policy_predator_policy_reward": [0.0, 0.0, 87.0, 0.0, 0.0, 17.0, 0.0, 0.0, 55.0, 26.0, 3.0, 0.0, 2.0, 0.0, 83.0, 70.0, 51.0, 0.0, 0.0, 26.0, 0.0, 32.0, 69.0, 77.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 55.0, 75.0, 2.0, 88.0, 58.0, 2.0, 27.0, 0.0, 26.0, 125.0, 0.0, 1.0, 55.0, 0.0, 6.0, 0.0, 11.0, 45.0, 24.0, 157.0, 0.0, 40.0, 122.0, 34.0, 99.0, 38.0, 6.0, 1.0, 11.0, 12.0, 86.0, 0.0, 22.0, 31.0, 118.0, 79.0, 0.0, 39.0, 48.0, 0.0, 0.0, 0.0, 0.0, 10.0, 81.0, 23.0, 0.0, 54.0, 65.0, 1.0, 92.0, 6.0, 99.0, 10.0, 107.0, 151.0, 0.0, 97.0, 106.0, 3.0, 144.0, 58.0, 17.0, 66.0, 68.0, 0.0, 67.0, 47.0, 0.0, 0.0, 0.0, 34.0, 73.0, 0.0, 34.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9631050811149633, "mean_inference_ms": 2.960207314367767, "mean_action_processing_ms": 0.3775678086569116, "mean_env_wait_ms": 0.33130892195470724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03313068990354185, "StateBufferConnector_ms": 0.0037380942591914426, "ViewRequirementAgentConnector_ms": 0.1917231965948034}, "num_episodes": 18, "episode_return_max": 294.0, "episode_return_min": -305.0, "episode_return_mean": 12.333333333333334, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.9307251365588, "num_env_steps_trained_throughput_per_sec": 352.9307251365588, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 70904.878, "restore_workers_time_ms": 0.043, "training_step_time_ms": 70904.777, "sample_time_ms": 2058.009, "learn_time_ms": 68830.732, "learn_throughput": 58.114, "synch_weights_time_ms": 13.585}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "e1352_00002", "date": "2024-08-13_19-05-18", "timestamp": 1723590318, "time_this_iter_s": 11.375398874282837, "time_total_s": 212.8434772491455, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b7be50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 212.8434772491455, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 53.19375, "ram_util_percent": 83.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.40984209150509543, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 4.421496562604551, "policy_loss": -0.0034217777439619775, "vf_loss": 4.423889524596078, "vf_explained_var": 0.0016858856198648927, "kl": 0.010288145584716473, "entropy": 1.5994774359243888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1095201484385937, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 5.459163399348183, "policy_loss": -0.0006348189937256316, "vf_loss": 5.459544081914992, "vf_explained_var": 0.00949819942630788, "kl": 0.002541254363890458, "entropy": 1.5999344096612678, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 294.0, "episode_reward_min": -305.0, "episode_reward_mean": 11.347222222222221, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -300.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.0, "predator_policy": 157.0}, "policy_reward_mean": {"prey_policy": -28.17361111111111, "predator_policy": 33.84722222222222}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, -22.0, -3.0, 14.0, -26.0, 77.0, 90.0, -22.0, 15.0, 29.0, -23.0, -146.0, 121.0, 191.0, 294.0, -55.0, -93.0, 71.0, 108.0, 85.0, 46.0, -18.0, 215.0, 88.0, 219.0, -305.0, -295.0, 92.0, 205.0, 19.0, -25.0, 103.0, -26.0, -63.0, -18.0, 32.0, 231.0, -7.0, 114.0, -111.0, 33.0, -7.0, -112.0, -136.0, -116.0, -128.0, -28.0, -23.0, -38.0, -25.0, 78.0, -67.0, 15.0, 3.0, -90.0, 50.0, -15.0, -78.0, 126.0, 53.0, -98.0, 16.0, 195.0, -27.0, 127.0, -16.0, -3.0, -46.0, 20.0, 51.0, -108.0, -6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.0, 11.0, -111.0, 2.0, 2.0, -22.0, 14.0, 0.0, -118.0, 11.0, 22.0, 52.0, 88.0, 0.0, -175.0, 0.0, 10.0, -46.0, 3.0, 0.0, -62.0, 7.0, -154.0, -138.0, 43.0, 68.0, 191.0, 0.0, 121.0, 169.0, -110.0, 0.0, -46.0, -124.0, -206.0, 131.0, 0.0, 79.0, 16.0, 43.0, 171.0, -250.0, 20.0, -94.0, 27.0, 182.0, 84.0, -7.0, 140.0, 10.0, -224.0, -238.0, -243.0, -214.0, -205.0, 164.0, 149.0, 12.0, -2.0, 9.0, 68.0, -191.0, 77.0, 4.0, -226.0, 51.0, 11.0, -153.0, -44.0, -61.0, 31.0, 1.0, 158.0, 73.0, -122.0, 24.0, 15.0, 76.0, -90.0, -140.0, -21.0, -39.0, 14.0, -126.0, -209.0, -20.0, 13.0, -300.0, -273.0, -46.0, -281.0, 6.0, -6.0, -97.0, -128.0, -29.0, -37.0, -68.0, -12.0, -60.0, 2.0, 76.0, -106.0, -68.0, 0.0, -19.0, 0.0, 3.0, 20.0, -293.0, -20.0, 17.0, 0.0, -80.0, -34.0, -122.0, 0.0, 121.0, 29.0, 0.0, 28.0, -262.0, 16.0, 0.0, 24.0, 171.0, -34.0, -55.0, -87.0, 107.0, -20.0, -28.0, -202.0, 49.0, -154.0, -4.0, 20.0, 0.0, 54.0, -75.0, -97.0, -132.0, 0.0, -12.0], "policy_predator_policy_reward": [0.0, 0.0, 87.0, 0.0, 0.0, 17.0, 0.0, 0.0, 55.0, 26.0, 3.0, 0.0, 2.0, 0.0, 83.0, 70.0, 51.0, 0.0, 0.0, 26.0, 0.0, 32.0, 69.0, 77.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 55.0, 75.0, 2.0, 88.0, 58.0, 2.0, 27.0, 0.0, 26.0, 125.0, 0.0, 1.0, 55.0, 0.0, 6.0, 0.0, 11.0, 45.0, 24.0, 157.0, 0.0, 40.0, 122.0, 34.0, 99.0, 38.0, 6.0, 1.0, 11.0, 12.0, 86.0, 0.0, 22.0, 31.0, 118.0, 79.0, 0.0, 39.0, 48.0, 0.0, 0.0, 0.0, 0.0, 10.0, 81.0, 23.0, 0.0, 54.0, 65.0, 1.0, 92.0, 6.0, 99.0, 10.0, 107.0, 151.0, 0.0, 97.0, 106.0, 3.0, 144.0, 58.0, 17.0, 66.0, 68.0, 0.0, 67.0, 47.0, 0.0, 0.0, 0.0, 34.0, 73.0, 0.0, 34.0, 0.0, 0.0, 123.0, 60.0, 53.0, 0.0, 0.0, 65.0, 61.0, 17.0, 0.0, 5.0, 20.0, 4.0, 0.0, 136.0, 0.0, 0.0, 0.0, 0.0, 29.0, 33.0, 19.0, 88.0, 24.0, 8.0, 24.0, 126.0, 34.0, 78.0, 0.0, 0.0, 18.0, 54.0, 70.0, 51.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9346587358707524, "mean_inference_ms": 2.885440852917627, "mean_action_processing_ms": 0.36842027081341855, "mean_env_wait_ms": 0.3218989786870537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800093756781684, "StateBufferConnector_ms": 0.003673798508114285, "ViewRequirementAgentConnector_ms": 0.1786775059170193}, "num_episodes": 18, "episode_return_max": 294.0, "episode_return_min": -305.0, "episode_return_mean": 11.347222222222221, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.24904032950786, "num_env_steps_trained_throughput_per_sec": 352.24904032950786, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 56017.56, "restore_workers_time_ms": 0.036, "training_step_time_ms": 56017.476, "sample_time_ms": 1930.05, "learn_time_ms": 54068.83, "learn_throughput": 73.98, "synch_weights_time_ms": 16.295}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "e1352_00002", "date": "2024-08-13_19-05-29", "timestamp": 1723590329, "time_this_iter_s": 11.401735305786133, "time_total_s": 224.24521255493164, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32d6bf820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 224.24521255493164, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 52.69375, "ram_util_percent": 83.59375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.46319115485936874, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 4.217891371313226, "policy_loss": -0.003634406352494523, "vf_loss": 4.220195839392445, "vf_explained_var": -0.000353914530819686, "kl": 0.013299145036163538, "entropy": 1.5846080014945338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0990942548309999, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 6.294615466758688, "policy_loss": -0.002542857618179547, "vf_loss": 6.296826281623235, "vf_explained_var": 0.007613388066569333, "kl": 0.0066409614023806175, "entropy": 1.5778070042373011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 294.0, "episode_reward_min": -305.0, "episode_reward_mean": 11.292929292929292, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -300.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.0, "predator_policy": 157.0}, "policy_reward_mean": {"prey_policy": -27.449494949494948, "predator_policy": 33.0959595959596}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, -22.0, -3.0, 14.0, -26.0, 77.0, 90.0, -22.0, 15.0, 29.0, -23.0, -146.0, 121.0, 191.0, 294.0, -55.0, -93.0, 71.0, 108.0, 85.0, 46.0, -18.0, 215.0, 88.0, 219.0, -305.0, -295.0, 92.0, 205.0, 19.0, -25.0, 103.0, -26.0, -63.0, -18.0, 32.0, 231.0, -7.0, 114.0, -111.0, 33.0, -7.0, -112.0, -136.0, -116.0, -128.0, -28.0, -23.0, -38.0, -25.0, 78.0, -67.0, 15.0, 3.0, -90.0, 50.0, -15.0, -78.0, 126.0, 53.0, -98.0, 16.0, 195.0, -27.0, 127.0, -16.0, -3.0, -46.0, 20.0, 51.0, -108.0, -6.0, -33.0, 262.0, -131.0, -128.0, 79.0, -39.0, 56.0, -165.0, 79.0, 12.0, 128.0, -63.0, -92.0, 94.0, 83.0, -11.0, 29.0, -83.0, 72.0, 54.0, -20.0, 21.0, 33.0, 8.0, 0.0, 15.0, 41.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.0, 11.0, -111.0, 2.0, 2.0, -22.0, 14.0, 0.0, -118.0, 11.0, 22.0, 52.0, 88.0, 0.0, -175.0, 0.0, 10.0, -46.0, 3.0, 0.0, -62.0, 7.0, -154.0, -138.0, 43.0, 68.0, 191.0, 0.0, 121.0, 169.0, -110.0, 0.0, -46.0, -124.0, -206.0, 131.0, 0.0, 79.0, 16.0, 43.0, 171.0, -250.0, 20.0, -94.0, 27.0, 182.0, 84.0, -7.0, 140.0, 10.0, -224.0, -238.0, -243.0, -214.0, -205.0, 164.0, 149.0, 12.0, -2.0, 9.0, 68.0, -191.0, 77.0, 4.0, -226.0, 51.0, 11.0, -153.0, -44.0, -61.0, 31.0, 1.0, 158.0, 73.0, -122.0, 24.0, 15.0, 76.0, -90.0, -140.0, -21.0, -39.0, 14.0, -126.0, -209.0, -20.0, 13.0, -300.0, -273.0, -46.0, -281.0, 6.0, -6.0, -97.0, -128.0, -29.0, -37.0, -68.0, -12.0, -60.0, 2.0, 76.0, -106.0, -68.0, 0.0, -19.0, 0.0, 3.0, 20.0, -293.0, -20.0, 17.0, 0.0, -80.0, -34.0, -122.0, 0.0, 121.0, 29.0, 0.0, 28.0, -262.0, 16.0, 0.0, 24.0, 171.0, -34.0, -55.0, -87.0, 107.0, -20.0, -28.0, -202.0, 49.0, -154.0, -4.0, 20.0, 0.0, 54.0, -75.0, -97.0, -132.0, 0.0, -12.0, -76.0, 0.0, 102.0, 160.0, -278.0, -47.0, -125.0, -110.0, 0.0, 28.0, -164.0, 14.0, 21.0, 35.0, -179.0, -93.0, 79.0, 0.0, 0.0, -37.0, 116.0, 12.0, -229.0, 0.0, -184.0, 0.0, -39.0, 109.0, 111.0, -118.0, -70.0, 24.0, 3.0, 4.0, -7.0, -197.0, -54.0, 69.0, 73.0, -109.0, 0.0, -63.0, -138.0, 35.0, 31.0, 0.0, -18.0, -27.0, 0.0, 0.0, 0.0, 15.0, -70.0, 13.0], "policy_predator_policy_reward": [0.0, 0.0, 87.0, 0.0, 0.0, 17.0, 0.0, 0.0, 55.0, 26.0, 3.0, 0.0, 2.0, 0.0, 83.0, 70.0, 51.0, 0.0, 0.0, 26.0, 0.0, 32.0, 69.0, 77.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 55.0, 75.0, 2.0, 88.0, 58.0, 2.0, 27.0, 0.0, 26.0, 125.0, 0.0, 1.0, 55.0, 0.0, 6.0, 0.0, 11.0, 45.0, 24.0, 157.0, 0.0, 40.0, 122.0, 34.0, 99.0, 38.0, 6.0, 1.0, 11.0, 12.0, 86.0, 0.0, 22.0, 31.0, 118.0, 79.0, 0.0, 39.0, 48.0, 0.0, 0.0, 0.0, 0.0, 10.0, 81.0, 23.0, 0.0, 54.0, 65.0, 1.0, 92.0, 6.0, 99.0, 10.0, 107.0, 151.0, 0.0, 97.0, 106.0, 3.0, 144.0, 58.0, 17.0, 66.0, 68.0, 0.0, 67.0, 47.0, 0.0, 0.0, 0.0, 34.0, 73.0, 0.0, 34.0, 0.0, 0.0, 123.0, 60.0, 53.0, 0.0, 0.0, 65.0, 61.0, 17.0, 0.0, 5.0, 20.0, 4.0, 0.0, 136.0, 0.0, 0.0, 0.0, 0.0, 29.0, 33.0, 19.0, 88.0, 24.0, 8.0, 24.0, 126.0, 34.0, 78.0, 0.0, 0.0, 18.0, 54.0, 70.0, 51.0, 6.0, 0.0, 0.0, 43.0, 0.0, 0.0, 116.0, 78.0, 107.0, 0.0, 11.0, 40.0, 60.0, 51.0, 0.0, 0.0, 11.0, 96.0, 0.0, 0.0, 15.0, 34.0, 0.0, 0.0, 111.0, 55.0, 0.0, 92.0, 6.0, 18.0, 31.0, 59.0, 0.0, 35.0, 6.0, 16.0, 81.0, 40.0, 57.0, 0.0, 89.0, 1.0, 0.0, 43.0, 69.0, 55.0, 0.0, 2.0, 53.0, 0.0, 0.0, 0.0, 0.0, 0.0, 51.0, 47.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9087896003912216, "mean_inference_ms": 2.8318704829971857, "mean_action_processing_ms": 0.361290565347513, "mean_env_wait_ms": 0.31379871184853214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023091441453105273, "StateBufferConnector_ms": 0.00361673759691643, "ViewRequirementAgentConnector_ms": 0.1610971460438738}, "num_episodes": 27, "episode_return_max": 294.0, "episode_return_min": -305.0, "episode_return_mean": 11.292929292929292, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 343.07521200934684, "num_env_steps_trained_throughput_per_sec": 343.07521200934684, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 47145.9, "restore_workers_time_ms": 0.031, "training_step_time_ms": 47145.824, "sample_time_ms": 1939.44, "learn_time_ms": 45189.095, "learn_throughput": 88.517, "synch_weights_time_ms": 15.219}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "e1352_00002", "date": "2024-08-13_19-05-41", "timestamp": 1723590341, "time_this_iter_s": 11.691293954849243, "time_total_s": 235.93650650978088, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1710790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 235.93650650978088, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 55.45882352941175, "ram_util_percent": 83.71764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.38915121383255435, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 3.7589892672483254, "policy_loss": -0.0019129853954331743, "vf_loss": 3.7602027724028897, "vf_explained_var": -0.0015049481202685643, "kl": 0.006994917525694573, "entropy": 1.5738630114409027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5316206271607409, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 6.109234349689786, "policy_loss": -0.0036751531005378753, "vf_loss": 6.112535842259725, "vf_explained_var": 0.02122262022482655, "kl": 0.0074729315781573, "entropy": 1.5725746063959032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 262.0, "episode_reward_min": -305.0, "episode_reward_mean": 8.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -300.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.0, "predator_policy": 157.0}, "policy_reward_mean": {"prey_policy": -30.02, "predator_policy": 34.455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.0, 108.0, 85.0, 46.0, -18.0, 215.0, 88.0, 219.0, -305.0, -295.0, 92.0, 205.0, 19.0, -25.0, 103.0, -26.0, -63.0, -18.0, 32.0, 231.0, -7.0, 114.0, -111.0, 33.0, -7.0, -112.0, -136.0, -116.0, -128.0, -28.0, -23.0, -38.0, -25.0, 78.0, -67.0, 15.0, 3.0, -90.0, 50.0, -15.0, -78.0, 126.0, 53.0, -98.0, 16.0, 195.0, -27.0, 127.0, -16.0, -3.0, -46.0, 20.0, 51.0, -108.0, -6.0, -33.0, 262.0, -131.0, -128.0, 79.0, -39.0, 56.0, -165.0, 79.0, 12.0, 128.0, -63.0, -92.0, 94.0, 83.0, -11.0, 29.0, -83.0, 72.0, 54.0, -20.0, 21.0, 33.0, 8.0, 0.0, 15.0, 41.0, 0.0, 57.0, -28.0, -94.0, 17.0, 66.0, -50.0, -124.0, -13.0, 91.0, -126.0, 218.0, 28.0, -83.0, 86.0, 159.0, -86.0, 108.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-206.0, 131.0, 0.0, 79.0, 16.0, 43.0, 171.0, -250.0, 20.0, -94.0, 27.0, 182.0, 84.0, -7.0, 140.0, 10.0, -224.0, -238.0, -243.0, -214.0, -205.0, 164.0, 149.0, 12.0, -2.0, 9.0, 68.0, -191.0, 77.0, 4.0, -226.0, 51.0, 11.0, -153.0, -44.0, -61.0, 31.0, 1.0, 158.0, 73.0, -122.0, 24.0, 15.0, 76.0, -90.0, -140.0, -21.0, -39.0, 14.0, -126.0, -209.0, -20.0, 13.0, -300.0, -273.0, -46.0, -281.0, 6.0, -6.0, -97.0, -128.0, -29.0, -37.0, -68.0, -12.0, -60.0, 2.0, 76.0, -106.0, -68.0, 0.0, -19.0, 0.0, 3.0, 20.0, -293.0, -20.0, 17.0, 0.0, -80.0, -34.0, -122.0, 0.0, 121.0, 29.0, 0.0, 28.0, -262.0, 16.0, 0.0, 24.0, 171.0, -34.0, -55.0, -87.0, 107.0, -20.0, -28.0, -202.0, 49.0, -154.0, -4.0, 20.0, 0.0, 54.0, -75.0, -97.0, -132.0, 0.0, -12.0, -76.0, 0.0, 102.0, 160.0, -278.0, -47.0, -125.0, -110.0, 0.0, 28.0, -164.0, 14.0, 21.0, 35.0, -179.0, -93.0, 79.0, 0.0, 0.0, -37.0, 116.0, 12.0, -229.0, 0.0, -184.0, 0.0, -39.0, 109.0, 111.0, -118.0, -70.0, 24.0, 3.0, 4.0, -7.0, -197.0, -54.0, 69.0, 73.0, -109.0, 0.0, -63.0, -138.0, 35.0, 31.0, 0.0, -18.0, -27.0, 0.0, 0.0, 0.0, 15.0, -70.0, 13.0, 0.0, 0.0, 0.0, 5.0, -146.0, 5.0, 24.0, -236.0, 4.0, 7.0, 0.0, 5.0, 49.0, -230.0, 0.0, -250.0, -105.0, 0.0, 0.0, 91.0, -124.0, -119.0, -20.0, 186.0, 1.0, 27.0, -123.0, -62.0, 0.0, 67.0, 115.0, 44.0, -58.0, -102.0, 127.0, -38.0], "policy_predator_policy_reward": [88.0, 58.0, 2.0, 27.0, 0.0, 26.0, 125.0, 0.0, 1.0, 55.0, 0.0, 6.0, 0.0, 11.0, 45.0, 24.0, 157.0, 0.0, 40.0, 122.0, 34.0, 99.0, 38.0, 6.0, 1.0, 11.0, 12.0, 86.0, 0.0, 22.0, 31.0, 118.0, 79.0, 0.0, 39.0, 48.0, 0.0, 0.0, 0.0, 0.0, 10.0, 81.0, 23.0, 0.0, 54.0, 65.0, 1.0, 92.0, 6.0, 99.0, 10.0, 107.0, 151.0, 0.0, 97.0, 106.0, 3.0, 144.0, 58.0, 17.0, 66.0, 68.0, 0.0, 67.0, 47.0, 0.0, 0.0, 0.0, 34.0, 73.0, 0.0, 34.0, 0.0, 0.0, 123.0, 60.0, 53.0, 0.0, 0.0, 65.0, 61.0, 17.0, 0.0, 5.0, 20.0, 4.0, 0.0, 136.0, 0.0, 0.0, 0.0, 0.0, 29.0, 33.0, 19.0, 88.0, 24.0, 8.0, 24.0, 126.0, 34.0, 78.0, 0.0, 0.0, 18.0, 54.0, 70.0, 51.0, 6.0, 0.0, 0.0, 43.0, 0.0, 0.0, 116.0, 78.0, 107.0, 0.0, 11.0, 40.0, 60.0, 51.0, 0.0, 0.0, 11.0, 96.0, 0.0, 0.0, 15.0, 34.0, 0.0, 0.0, 111.0, 55.0, 0.0, 92.0, 6.0, 18.0, 31.0, 59.0, 0.0, 35.0, 6.0, 16.0, 81.0, 40.0, 57.0, 0.0, 89.0, 1.0, 0.0, 43.0, 69.0, 55.0, 0.0, 2.0, 53.0, 0.0, 0.0, 0.0, 0.0, 0.0, 51.0, 47.0, 0.0, 0.0, 50.0, 2.0, 113.0, 0.0, 118.0, 0.0, 0.0, 6.0, 55.0, 6.0, 110.0, 21.0, 54.0, 72.0, 92.0, 0.0, 0.0, 0.0, 109.0, 8.0, 52.0, 0.0, 0.0, 0.0, 54.0, 48.0, 19.0, 0.0, 0.0, 0.0, 0.0, 74.0, 0.0, 19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8868526940490703, "mean_inference_ms": 2.7891003536732546, "mean_action_processing_ms": 0.3565204164358664, "mean_env_wait_ms": 0.3071500536985848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020436644554138184, "StateBufferConnector_ms": 0.003836989402770996, "ViewRequirementAgentConnector_ms": 0.15585803985595703}, "num_episodes": 18, "episode_return_max": 262.0, "episode_return_min": -305.0, "episode_return_mean": 8.87, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 5.136611945366632, "num_env_steps_trained_throughput_per_sec": 5.136611945366632, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 169075.487, "restore_workers_time_ms": 0.028, "training_step_time_ms": 169075.414, "sample_time_ms": 1887.721, "learn_time_ms": 167167.601, "learn_throughput": 23.928, "synch_weights_time_ms": 16.928}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "e1352_00002", "date": "2024-08-13_19-18-40", "timestamp": 1723591120, "time_this_iter_s": 778.8205289840698, "time_total_s": 1014.7570354938507, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b63820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1014.7570354938507, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 88.20487804878047, "ram_util_percent": 83.80975609756098}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.37476111036286786, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 2.72289400100708, "policy_loss": -0.002017106969899956, "vf_loss": 2.7244680448814673, "vf_explained_var": 0.004615889276776995, "kl": 0.004430608157379733, "entropy": 1.5717896098182316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1692018172452374, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 5.134656545220229, "policy_loss": -0.0034027654237838256, "vf_loss": 5.1377440233079215, "vf_explained_var": 0.03127193148173983, "kl": 0.006306069385769032, "entropy": 1.571804390887104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 262.0, "episode_reward_min": -165.0, "episode_reward_mean": 7.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -300.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.0, "predator_policy": 151.0}, "policy_reward_mean": {"prey_policy": -28.215, "predator_policy": 32.14}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 231.0, -7.0, 114.0, -111.0, 33.0, -7.0, -112.0, -136.0, -116.0, -128.0, -28.0, -23.0, -38.0, -25.0, 78.0, -67.0, 15.0, 3.0, -90.0, 50.0, -15.0, -78.0, 126.0, 53.0, -98.0, 16.0, 195.0, -27.0, 127.0, -16.0, -3.0, -46.0, 20.0, 51.0, -108.0, -6.0, -33.0, 262.0, -131.0, -128.0, 79.0, -39.0, 56.0, -165.0, 79.0, 12.0, 128.0, -63.0, -92.0, 94.0, 83.0, -11.0, 29.0, -83.0, 72.0, 54.0, -20.0, 21.0, 33.0, 8.0, 0.0, 15.0, 41.0, 0.0, 57.0, -28.0, -94.0, 17.0, 66.0, -50.0, -124.0, -13.0, 91.0, -126.0, 218.0, 28.0, -83.0, 86.0, 159.0, -86.0, 108.0, -76.0, 69.0, 5.0, -58.0, -55.0, -23.0, 121.0, 100.0, -46.0, 30.0, 77.0, 2.0, 79.0, -42.0, 113.0, 81.0, 60.0, -38.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [31.0, 1.0, 158.0, 73.0, -122.0, 24.0, 15.0, 76.0, -90.0, -140.0, -21.0, -39.0, 14.0, -126.0, -209.0, -20.0, 13.0, -300.0, -273.0, -46.0, -281.0, 6.0, -6.0, -97.0, -128.0, -29.0, -37.0, -68.0, -12.0, -60.0, 2.0, 76.0, -106.0, -68.0, 0.0, -19.0, 0.0, 3.0, 20.0, -293.0, -20.0, 17.0, 0.0, -80.0, -34.0, -122.0, 0.0, 121.0, 29.0, 0.0, 28.0, -262.0, 16.0, 0.0, 24.0, 171.0, -34.0, -55.0, -87.0, 107.0, -20.0, -28.0, -202.0, 49.0, -154.0, -4.0, 20.0, 0.0, 54.0, -75.0, -97.0, -132.0, 0.0, -12.0, -76.0, 0.0, 102.0, 160.0, -278.0, -47.0, -125.0, -110.0, 0.0, 28.0, -164.0, 14.0, 21.0, 35.0, -179.0, -93.0, 79.0, 0.0, 0.0, -37.0, 116.0, 12.0, -229.0, 0.0, -184.0, 0.0, -39.0, 109.0, 111.0, -118.0, -70.0, 24.0, 3.0, 4.0, -7.0, -197.0, -54.0, 69.0, 73.0, -109.0, 0.0, -63.0, -138.0, 35.0, 31.0, 0.0, -18.0, -27.0, 0.0, 0.0, 0.0, 15.0, -70.0, 13.0, 0.0, 0.0, 0.0, 5.0, -146.0, 5.0, 24.0, -236.0, 4.0, 7.0, 0.0, 5.0, 49.0, -230.0, 0.0, -250.0, -105.0, 0.0, 0.0, 91.0, -124.0, -119.0, -20.0, 186.0, 1.0, 27.0, -123.0, -62.0, 0.0, 67.0, 115.0, 44.0, -58.0, -102.0, 127.0, -38.0, 8.0, -201.0, -69.0, 101.0, 9.0, -148.0, -21.0, -146.0, 0.0, -110.0, -73.0, 7.0, -55.0, 123.0, -18.0, 40.0, 7.0, -116.0, 29.0, -6.0, 86.0, -48.0, -21.0, -7.0, 31.0, 27.0, -29.0, -54.0, -11.0, 93.0, 28.0, 53.0, 0.0, 43.0, -56.0, -45.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 10.0, 81.0, 23.0, 0.0, 54.0, 65.0, 1.0, 92.0, 6.0, 99.0, 10.0, 107.0, 151.0, 0.0, 97.0, 106.0, 3.0, 144.0, 58.0, 17.0, 66.0, 68.0, 0.0, 67.0, 47.0, 0.0, 0.0, 0.0, 34.0, 73.0, 0.0, 34.0, 0.0, 0.0, 123.0, 60.0, 53.0, 0.0, 0.0, 65.0, 61.0, 17.0, 0.0, 5.0, 20.0, 4.0, 0.0, 136.0, 0.0, 0.0, 0.0, 0.0, 29.0, 33.0, 19.0, 88.0, 24.0, 8.0, 24.0, 126.0, 34.0, 78.0, 0.0, 0.0, 18.0, 54.0, 70.0, 51.0, 6.0, 0.0, 0.0, 43.0, 0.0, 0.0, 116.0, 78.0, 107.0, 0.0, 11.0, 40.0, 60.0, 51.0, 0.0, 0.0, 11.0, 96.0, 0.0, 0.0, 15.0, 34.0, 0.0, 0.0, 111.0, 55.0, 0.0, 92.0, 6.0, 18.0, 31.0, 59.0, 0.0, 35.0, 6.0, 16.0, 81.0, 40.0, 57.0, 0.0, 89.0, 1.0, 0.0, 43.0, 69.0, 55.0, 0.0, 2.0, 53.0, 0.0, 0.0, 0.0, 0.0, 0.0, 51.0, 47.0, 0.0, 0.0, 50.0, 2.0, 113.0, 0.0, 118.0, 0.0, 0.0, 6.0, 55.0, 6.0, 110.0, 21.0, 54.0, 72.0, 92.0, 0.0, 0.0, 0.0, 109.0, 8.0, 52.0, 0.0, 0.0, 0.0, 54.0, 48.0, 19.0, 0.0, 0.0, 0.0, 0.0, 74.0, 0.0, 19.0, 102.0, 15.0, 36.0, 1.0, 59.0, 85.0, 79.0, 30.0, 0.0, 55.0, 43.0, 0.0, 8.0, 45.0, 43.0, 35.0, 5.0, 58.0, 4.0, 3.0, 21.0, 18.0, 30.0, 0.0, 21.0, 0.0, 41.0, 0.0, 31.0, 0.0, 0.0, 0.0, 3.0, 14.0, 53.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8691618957099565, "mean_inference_ms": 2.7530354160306785, "mean_action_processing_ms": 0.35049206876988137, "mean_env_wait_ms": 0.3031373365092555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008849382400512695, "StateBufferConnector_ms": 0.0038466453552246094, "ViewRequirementAgentConnector_ms": 0.14393460750579834}, "num_episodes": 18, "episode_return_max": 262.0, "episode_return_min": -165.0, "episode_return_mean": 7.85, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.95540948933038, "num_env_steps_trained_throughput_per_sec": 210.95540948933038, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 147630.612, "restore_workers_time_ms": 0.026, "training_step_time_ms": 147630.543, "sample_time_ms": 2156.553, "learn_time_ms": 145454.143, "learn_throughput": 27.5, "synch_weights_time_ms": 16.773}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "e1352_00002", "date": "2024-08-13_19-18-59", "timestamp": 1723591139, "time_this_iter_s": 19.12779211997986, "time_total_s": 1033.8848276138306, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb33a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1033.8848276138306, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 84.29629629629629, "ram_util_percent": 83.94074074074075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.32086549973282863, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 0.8125874215175235, "policy_loss": -0.007181343212280245, "vf_loss": 0.8191221404958654, "vf_explained_var": 0.025576476697568542, "kl": 0.012932446064542814, "entropy": 1.5756422349384853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3548922737557736, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 3.8700391566311874, "policy_loss": -0.003502597691116746, "vf_loss": 3.8733590276153, "vf_explained_var": 0.053572027393119045, "kl": 0.0036546452724819357, "entropy": 1.5809999220585698, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 262.0, "episode_reward_min": -165.0, "episode_reward_mean": 20.12, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -293.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.0, "predator_policy": 136.0}, "policy_reward_mean": {"prey_policy": -15.605, "predator_policy": 25.665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, -90.0, 50.0, -15.0, -78.0, 126.0, 53.0, -98.0, 16.0, 195.0, -27.0, 127.0, -16.0, -3.0, -46.0, 20.0, 51.0, -108.0, -6.0, -33.0, 262.0, -131.0, -128.0, 79.0, -39.0, 56.0, -165.0, 79.0, 12.0, 128.0, -63.0, -92.0, 94.0, 83.0, -11.0, 29.0, -83.0, 72.0, 54.0, -20.0, 21.0, 33.0, 8.0, 0.0, 15.0, 41.0, 0.0, 57.0, -28.0, -94.0, 17.0, 66.0, -50.0, -124.0, -13.0, 91.0, -126.0, 218.0, 28.0, -83.0, 86.0, 159.0, -86.0, 108.0, -76.0, 69.0, 5.0, -58.0, -55.0, -23.0, 121.0, 100.0, -46.0, 30.0, 77.0, 2.0, 79.0, -42.0, 113.0, 81.0, 60.0, -38.0, 20.0, -36.0, 36.0, 49.0, 17.0, 68.0, -1.0, 71.0, 112.0, 113.0, -37.0, 70.0, 70.0, 41.0, 123.0, 132.0, 48.0, 36.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 3.0, 20.0, -293.0, -20.0, 17.0, 0.0, -80.0, -34.0, -122.0, 0.0, 121.0, 29.0, 0.0, 28.0, -262.0, 16.0, 0.0, 24.0, 171.0, -34.0, -55.0, -87.0, 107.0, -20.0, -28.0, -202.0, 49.0, -154.0, -4.0, 20.0, 0.0, 54.0, -75.0, -97.0, -132.0, 0.0, -12.0, -76.0, 0.0, 102.0, 160.0, -278.0, -47.0, -125.0, -110.0, 0.0, 28.0, -164.0, 14.0, 21.0, 35.0, -179.0, -93.0, 79.0, 0.0, 0.0, -37.0, 116.0, 12.0, -229.0, 0.0, -184.0, 0.0, -39.0, 109.0, 111.0, -118.0, -70.0, 24.0, 3.0, 4.0, -7.0, -197.0, -54.0, 69.0, 73.0, -109.0, 0.0, -63.0, -138.0, 35.0, 31.0, 0.0, -18.0, -27.0, 0.0, 0.0, 0.0, 15.0, -70.0, 13.0, 0.0, 0.0, 0.0, 5.0, -146.0, 5.0, 24.0, -236.0, 4.0, 7.0, 0.0, 5.0, 49.0, -230.0, 0.0, -250.0, -105.0, 0.0, 0.0, 91.0, -124.0, -119.0, -20.0, 186.0, 1.0, 27.0, -123.0, -62.0, 0.0, 67.0, 115.0, 44.0, -58.0, -102.0, 127.0, -38.0, 8.0, -201.0, -69.0, 101.0, 9.0, -148.0, -21.0, -146.0, 0.0, -110.0, -73.0, 7.0, -55.0, 123.0, -18.0, 40.0, 7.0, -116.0, 29.0, -6.0, 86.0, -48.0, -21.0, -7.0, 31.0, 27.0, -29.0, -54.0, -11.0, 93.0, 28.0, 53.0, 0.0, 43.0, -56.0, -45.0, 11.0, 9.0, -37.0, -32.0, -2.0, 27.0, 23.0, 26.0, 8.0, 9.0, 64.0, -18.0, -45.0, 16.0, 67.0, 4.0, 33.0, 50.0, 64.0, 41.0, 19.0, -112.0, 0.0, 70.0, 1.0, 60.0, 41.0, 0.0, 58.0, 65.0, -18.0, 130.0, 12.0, 36.0, 0.0, 34.0], "policy_predator_policy_reward": [0.0, 0.0, 123.0, 60.0, 53.0, 0.0, 0.0, 65.0, 61.0, 17.0, 0.0, 5.0, 20.0, 4.0, 0.0, 136.0, 0.0, 0.0, 0.0, 0.0, 29.0, 33.0, 19.0, 88.0, 24.0, 8.0, 24.0, 126.0, 34.0, 78.0, 0.0, 0.0, 18.0, 54.0, 70.0, 51.0, 6.0, 0.0, 0.0, 43.0, 0.0, 0.0, 116.0, 78.0, 107.0, 0.0, 11.0, 40.0, 60.0, 51.0, 0.0, 0.0, 11.0, 96.0, 0.0, 0.0, 15.0, 34.0, 0.0, 0.0, 111.0, 55.0, 0.0, 92.0, 6.0, 18.0, 31.0, 59.0, 0.0, 35.0, 6.0, 16.0, 81.0, 40.0, 57.0, 0.0, 89.0, 1.0, 0.0, 43.0, 69.0, 55.0, 0.0, 2.0, 53.0, 0.0, 0.0, 0.0, 0.0, 0.0, 51.0, 47.0, 0.0, 0.0, 50.0, 2.0, 113.0, 0.0, 118.0, 0.0, 0.0, 6.0, 55.0, 6.0, 110.0, 21.0, 54.0, 72.0, 92.0, 0.0, 0.0, 0.0, 109.0, 8.0, 52.0, 0.0, 0.0, 0.0, 54.0, 48.0, 19.0, 0.0, 0.0, 0.0, 0.0, 74.0, 0.0, 19.0, 102.0, 15.0, 36.0, 1.0, 59.0, 85.0, 79.0, 30.0, 0.0, 55.0, 43.0, 0.0, 8.0, 45.0, 43.0, 35.0, 5.0, 58.0, 4.0, 3.0, 21.0, 18.0, 30.0, 0.0, 21.0, 0.0, 41.0, 0.0, 31.0, 0.0, 0.0, 0.0, 3.0, 14.0, 53.0, 10.0, 0.0, 0.0, 19.0, 14.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 9.0, 13.0, 0.0, 28.0, 0.0, 0.0, 0.0, 29.0, 0.0, 8.0, 0.0, 56.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 2.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8703969786374262, "mean_inference_ms": 2.7595440644165863, "mean_action_processing_ms": 0.351188680494916, "mean_env_wait_ms": 0.3042699287099387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007375121116638184, "StateBufferConnector_ms": 0.003901243209838867, "ViewRequirementAgentConnector_ms": 0.14046239852905273}, "num_episodes": 18, "episode_return_max": 262.0, "episode_return_min": -165.0, "episode_return_mean": 20.12, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 61.548262130867975, "num_env_steps_trained_throughput_per_sec": 61.548262130867975, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 137300.493, "restore_workers_time_ms": 0.025, "training_step_time_ms": 137300.424, "sample_time_ms": 2110.063, "learn_time_ms": 135166.659, "learn_throughput": 29.593, "synch_weights_time_ms": 20.184}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "e1352_00002", "date": "2024-08-13_19-20-04", "timestamp": 1723591204, "time_this_iter_s": 65.03840589523315, "time_total_s": 1098.9232335090637, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb71f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1098.9232335090637, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 58.12352941176471, "ram_util_percent": 83.74705882352943}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3276178354072192, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 3.4169581789188284, "policy_loss": -0.005061251013761475, "vf_loss": 3.4214642769445187, "vf_explained_var": 0.0033363370037583447, "kl": 0.011103216198546607, "entropy": 1.5568805055012778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.812736027906575, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 5.405745181078633, "policy_loss": -0.002122211102741184, "vf_loss": 5.407777587572734, "vf_explained_var": 0.007284487366045593, "kl": 0.0035919448293737087, "entropy": 1.5901761247367454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 218.0, "episode_reward_min": -165.0, "episode_reward_mean": 17.3, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -372.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -16.545, "predator_policy": 25.195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-128.0, 79.0, -39.0, 56.0, -165.0, 79.0, 12.0, 128.0, -63.0, -92.0, 94.0, 83.0, -11.0, 29.0, -83.0, 72.0, 54.0, -20.0, 21.0, 33.0, 8.0, 0.0, 15.0, 41.0, 0.0, 57.0, -28.0, -94.0, 17.0, 66.0, -50.0, -124.0, -13.0, 91.0, -126.0, 218.0, 28.0, -83.0, 86.0, 159.0, -86.0, 108.0, -76.0, 69.0, 5.0, -58.0, -55.0, -23.0, 121.0, 100.0, -46.0, 30.0, 77.0, 2.0, 79.0, -42.0, 113.0, 81.0, 60.0, -38.0, 20.0, -36.0, 36.0, 49.0, 17.0, 68.0, -1.0, 71.0, 112.0, 113.0, -37.0, 70.0, 70.0, 41.0, 123.0, 132.0, 48.0, 36.0, 30.0, -117.0, -1.0, 37.0, -153.0, -107.0, 55.0, 109.0, 28.0, -57.0, -38.0, 36.0, 40.0, 50.0, -12.0, -16.0, 0.0, 3.0, 104.0, 83.0, -39.0, -65.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-125.0, -110.0, 0.0, 28.0, -164.0, 14.0, 21.0, 35.0, -179.0, -93.0, 79.0, 0.0, 0.0, -37.0, 116.0, 12.0, -229.0, 0.0, -184.0, 0.0, -39.0, 109.0, 111.0, -118.0, -70.0, 24.0, 3.0, 4.0, -7.0, -197.0, -54.0, 69.0, 73.0, -109.0, 0.0, -63.0, -138.0, 35.0, 31.0, 0.0, -18.0, -27.0, 0.0, 0.0, 0.0, 15.0, -70.0, 13.0, 0.0, 0.0, 0.0, 5.0, -146.0, 5.0, 24.0, -236.0, 4.0, 7.0, 0.0, 5.0, 49.0, -230.0, 0.0, -250.0, -105.0, 0.0, 0.0, 91.0, -124.0, -119.0, -20.0, 186.0, 1.0, 27.0, -123.0, -62.0, 0.0, 67.0, 115.0, 44.0, -58.0, -102.0, 127.0, -38.0, 8.0, -201.0, -69.0, 101.0, 9.0, -148.0, -21.0, -146.0, 0.0, -110.0, -73.0, 7.0, -55.0, 123.0, -18.0, 40.0, 7.0, -116.0, 29.0, -6.0, 86.0, -48.0, -21.0, -7.0, 31.0, 27.0, -29.0, -54.0, -11.0, 93.0, 28.0, 53.0, 0.0, 43.0, -56.0, -45.0, 11.0, 9.0, -37.0, -32.0, -2.0, 27.0, 23.0, 26.0, 8.0, 9.0, 64.0, -18.0, -45.0, 16.0, 67.0, 4.0, 33.0, 50.0, 64.0, 41.0, 19.0, -112.0, 0.0, 70.0, 1.0, 60.0, 41.0, 0.0, 58.0, 65.0, -18.0, 130.0, 12.0, 36.0, 0.0, 34.0, 0.0, 25.0, 30.0, -372.0, -75.0, 25.0, 37.0, 0.0, -368.0, 16.0, -211.0, -10.0, 28.0, 22.0, 0.0, 109.0, -18.0, 3.0, -90.0, -54.0, -202.0, 11.0, 43.0, -85.0, -15.0, 27.0, 50.0, 0.0, -23.0, -12.0, -64.0, -31.0, -32.0, 8.0, -56.0, 23.0, 90.0, 0.0, 19.0, 63.0, -73.0, -37.0, -34.0, -146.0], "policy_predator_policy_reward": [107.0, 0.0, 11.0, 40.0, 60.0, 51.0, 0.0, 0.0, 11.0, 96.0, 0.0, 0.0, 15.0, 34.0, 0.0, 0.0, 111.0, 55.0, 0.0, 92.0, 6.0, 18.0, 31.0, 59.0, 0.0, 35.0, 6.0, 16.0, 81.0, 40.0, 57.0, 0.0, 89.0, 1.0, 0.0, 43.0, 69.0, 55.0, 0.0, 2.0, 53.0, 0.0, 0.0, 0.0, 0.0, 0.0, 51.0, 47.0, 0.0, 0.0, 50.0, 2.0, 113.0, 0.0, 118.0, 0.0, 0.0, 6.0, 55.0, 6.0, 110.0, 21.0, 54.0, 72.0, 92.0, 0.0, 0.0, 0.0, 109.0, 8.0, 52.0, 0.0, 0.0, 0.0, 54.0, 48.0, 19.0, 0.0, 0.0, 0.0, 0.0, 74.0, 0.0, 19.0, 102.0, 15.0, 36.0, 1.0, 59.0, 85.0, 79.0, 30.0, 0.0, 55.0, 43.0, 0.0, 8.0, 45.0, 43.0, 35.0, 5.0, 58.0, 4.0, 3.0, 21.0, 18.0, 30.0, 0.0, 21.0, 0.0, 41.0, 0.0, 31.0, 0.0, 0.0, 0.0, 3.0, 14.0, 53.0, 10.0, 0.0, 0.0, 19.0, 14.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 9.0, 13.0, 0.0, 28.0, 0.0, 0.0, 0.0, 29.0, 0.0, 8.0, 0.0, 56.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 2.0, 0.0, 0.0, 5.0, 142.0, 83.0, 1.0, 48.0, 0.0, 0.0, 0.0, 199.0, 86.0, 28.0, 5.0, 0.0, 0.0, 0.0, 30.0, 13.0, 72.0, 15.0, 44.0, 109.0, 28.0, 50.0, 11.0, 17.0, 0.0, 0.0, 6.0, 17.0, 0.0, 79.0, 0.0, 24.0, 36.0, 0.0, 11.0, 3.0, 0.0, 1.0, 0.0, 71.0, 95.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8874190478450359, "mean_inference_ms": 2.8041901375163047, "mean_action_processing_ms": 0.35923731070269027, "mean_env_wait_ms": 0.31028372437434903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006012320518493652, "StateBufferConnector_ms": 0.0039032697677612305, "ViewRequirementAgentConnector_ms": 0.15296494960784912}, "num_episodes": 22, "episode_return_max": 218.0, "episode_return_min": -165.0, "episode_return_mean": 17.3, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.6816674416316, "num_env_steps_trained_throughput_per_sec": 332.6816674416316, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 123380.829, "restore_workers_time_ms": 0.024, "training_step_time_ms": 123380.762, "sample_time_ms": 2107.897, "learn_time_ms": 121249.636, "learn_throughput": 32.99, "synch_weights_time_ms": 19.838}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "e1352_00002", "date": "2024-08-13_19-20-16", "timestamp": 1723591216, "time_this_iter_s": 12.121186017990112, "time_total_s": 1111.0444195270538, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bbbee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1111.0444195270538, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 49.747058823529414, "ram_util_percent": 83.52941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7113792332943785, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 5.299626972435643, "policy_loss": -0.0019015069127023693, "vf_loss": 5.3010022392979375, "vf_explained_var": 0.00829413649897096, "kl": 0.010524841392122236, "entropy": 1.5293772438215831, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.474137042652047, "cur_kl_coeff": 0.0125, "cur_lr": 0.00010000000000000003, "total_loss": 6.985664801875119, "policy_loss": -0.004368974694060704, "vf_loss": 6.989962770068456, "vf_explained_var": 0.03135277155845884, "kl": 0.005680951613922127, "entropy": 1.5709760613542385, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 273.0, "episode_reward_min": -167.0, "episode_reward_mean": 15.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -372.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -19.795, "predator_policy": 27.48}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.0, 0.0, 57.0, -28.0, -94.0, 17.0, 66.0, -50.0, -124.0, -13.0, 91.0, -126.0, 218.0, 28.0, -83.0, 86.0, 159.0, -86.0, 108.0, -76.0, 69.0, 5.0, -58.0, -55.0, -23.0, 121.0, 100.0, -46.0, 30.0, 77.0, 2.0, 79.0, -42.0, 113.0, 81.0, 60.0, -38.0, 20.0, -36.0, 36.0, 49.0, 17.0, 68.0, -1.0, 71.0, 112.0, 113.0, -37.0, 70.0, 70.0, 41.0, 123.0, 132.0, 48.0, 36.0, 30.0, -117.0, -1.0, 37.0, -153.0, -107.0, 55.0, 109.0, 28.0, -57.0, -38.0, 36.0, 40.0, 50.0, -12.0, -16.0, 0.0, 3.0, 104.0, 83.0, -39.0, -65.0, -54.0, -132.0, 2.0, -16.0, 174.0, -23.0, -91.0, 25.0, 14.0, -65.0, -62.0, -10.0, -167.0, -24.0, 52.0, -35.0, -13.0, -35.0, 44.0, 273.0, 45.0, 24.0, 43.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-70.0, 13.0, 0.0, 0.0, 0.0, 5.0, -146.0, 5.0, 24.0, -236.0, 4.0, 7.0, 0.0, 5.0, 49.0, -230.0, 0.0, -250.0, -105.0, 0.0, 0.0, 91.0, -124.0, -119.0, -20.0, 186.0, 1.0, 27.0, -123.0, -62.0, 0.0, 67.0, 115.0, 44.0, -58.0, -102.0, 127.0, -38.0, 8.0, -201.0, -69.0, 101.0, 9.0, -148.0, -21.0, -146.0, 0.0, -110.0, -73.0, 7.0, -55.0, 123.0, -18.0, 40.0, 7.0, -116.0, 29.0, -6.0, 86.0, -48.0, -21.0, -7.0, 31.0, 27.0, -29.0, -54.0, -11.0, 93.0, 28.0, 53.0, 0.0, 43.0, -56.0, -45.0, 11.0, 9.0, -37.0, -32.0, -2.0, 27.0, 23.0, 26.0, 8.0, 9.0, 64.0, -18.0, -45.0, 16.0, 67.0, 4.0, 33.0, 50.0, 64.0, 41.0, 19.0, -112.0, 0.0, 70.0, 1.0, 60.0, 41.0, 0.0, 58.0, 65.0, -18.0, 130.0, 12.0, 36.0, 0.0, 34.0, 0.0, 25.0, 30.0, -372.0, -75.0, 25.0, 37.0, 0.0, -368.0, 16.0, -211.0, -10.0, 28.0, 22.0, 0.0, 109.0, -18.0, 3.0, -90.0, -54.0, -202.0, 11.0, 43.0, -85.0, -15.0, 27.0, 50.0, 0.0, -23.0, -12.0, -64.0, -31.0, -32.0, 8.0, -56.0, 23.0, 90.0, 0.0, 19.0, 63.0, -73.0, -37.0, -34.0, -146.0, -15.0, -334.0, -235.0, -56.0, -104.0, 6.0, -38.0, 3.0, 25.0, 145.0, -134.0, 11.0, -75.0, -156.0, 2.0, 17.0, -31.0, 19.0, -131.0, 0.0, -134.0, -59.0, -2.0, -18.0, -200.0, -144.0, 47.0, -250.0, 43.0, 0.0, 11.0, -158.0, -27.0, -18.0, -159.0, 31.0, 62.0, -49.0, 184.0, 69.0, 45.0, 0.0, -98.0, 34.0, 0.0, 39.0], "policy_predator_policy_reward": [51.0, 47.0, 0.0, 0.0, 50.0, 2.0, 113.0, 0.0, 118.0, 0.0, 0.0, 6.0, 55.0, 6.0, 110.0, 21.0, 54.0, 72.0, 92.0, 0.0, 0.0, 0.0, 109.0, 8.0, 52.0, 0.0, 0.0, 0.0, 54.0, 48.0, 19.0, 0.0, 0.0, 0.0, 0.0, 74.0, 0.0, 19.0, 102.0, 15.0, 36.0, 1.0, 59.0, 85.0, 79.0, 30.0, 0.0, 55.0, 43.0, 0.0, 8.0, 45.0, 43.0, 35.0, 5.0, 58.0, 4.0, 3.0, 21.0, 18.0, 30.0, 0.0, 21.0, 0.0, 41.0, 0.0, 31.0, 0.0, 0.0, 0.0, 3.0, 14.0, 53.0, 10.0, 0.0, 0.0, 19.0, 14.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 9.0, 13.0, 0.0, 28.0, 0.0, 0.0, 0.0, 29.0, 0.0, 8.0, 0.0, 56.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 2.0, 0.0, 0.0, 5.0, 142.0, 83.0, 1.0, 48.0, 0.0, 0.0, 0.0, 199.0, 86.0, 28.0, 5.0, 0.0, 0.0, 0.0, 30.0, 13.0, 72.0, 15.0, 44.0, 109.0, 28.0, 50.0, 11.0, 17.0, 0.0, 0.0, 6.0, 17.0, 0.0, 79.0, 0.0, 24.0, 36.0, 0.0, 11.0, 3.0, 0.0, 1.0, 0.0, 71.0, 95.0, 20.0, 148.0, 147.0, 125.0, 34.0, 32.0, 68.0, 19.0, 0.0, 4.0, 0.0, 30.0, 70.0, 57.0, 83.0, 6.0, 0.0, 25.0, 1.0, 0.0, 66.0, 121.0, 10.0, 9.0, 1.0, 72.0, 105.0, 62.0, 117.0, 0.0, 9.0, 32.0, 80.0, 32.0, 0.0, 28.0, 65.0, 2.0, 29.0, 14.0, 6.0, 0.0, 0.0, 49.0, 39.0, 4.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9143300271414116, "mean_inference_ms": 2.86908275166527, "mean_action_processing_ms": 0.3681765193379376, "mean_env_wait_ms": 0.321930169911704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005413532257080078, "StateBufferConnector_ms": 0.004443168640136719, "ViewRequirementAgentConnector_ms": 0.1662532091140747}, "num_episodes": 23, "episode_return_max": 273.0, "episode_return_min": -167.0, "episode_return_mean": 15.37, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 343.3128372117103, "num_env_steps_trained_throughput_per_sec": 343.3128372117103, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 112207.866, "restore_workers_time_ms": 0.026, "training_step_time_ms": 112207.798, "sample_time_ms": 2166.03, "learn_time_ms": 110019.161, "learn_throughput": 36.357, "synch_weights_time_ms": 19.441}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "e1352_00002", "date": "2024-08-13_19-20-28", "timestamp": 1723591228, "time_this_iter_s": 11.69543170928955, "time_total_s": 1122.7398512363434, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bbb280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1122.7398512363434, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 50.71176470588235, "ram_util_percent": 83.49411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5483019334811067, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 2.219117066721437, "policy_loss": -0.002025638925276263, "vf_loss": 2.220441876328181, "vf_explained_var": 0.007937534524019433, "kl": 0.014016634524807812, "entropy": 1.5599432285500583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8256103338703276, "cur_kl_coeff": 0.0125, "cur_lr": 0.00010000000000000003, "total_loss": 4.782643104356433, "policy_loss": -0.002665830118133238, "vf_loss": 4.7852245567967655, "vf_explained_var": 0.04455981554177703, "kl": 0.006750562799904097, "entropy": 1.556285656507684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 273.0, "episode_reward_min": -167.0, "episode_reward_mean": 20.41, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -372.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -15.45, "predator_policy": 25.655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [108.0, -76.0, 69.0, 5.0, -58.0, -55.0, -23.0, 121.0, 100.0, -46.0, 30.0, 77.0, 2.0, 79.0, -42.0, 113.0, 81.0, 60.0, -38.0, 20.0, -36.0, 36.0, 49.0, 17.0, 68.0, -1.0, 71.0, 112.0, 113.0, -37.0, 70.0, 70.0, 41.0, 123.0, 132.0, 48.0, 36.0, 30.0, -117.0, -1.0, 37.0, -153.0, -107.0, 55.0, 109.0, 28.0, -57.0, -38.0, 36.0, 40.0, 50.0, -12.0, -16.0, 0.0, 3.0, 104.0, 83.0, -39.0, -65.0, -54.0, -132.0, 2.0, -16.0, 174.0, -23.0, -91.0, 25.0, 14.0, -65.0, -62.0, -10.0, -167.0, -24.0, 52.0, -35.0, -13.0, -35.0, 44.0, 273.0, 45.0, 24.0, 43.0, 34.0, 5.0, -46.0, 74.0, 65.0, 16.0, 63.0, 125.0, -10.0, 50.0, -50.0, -76.0, 0.0, -3.0, 70.0, 127.0, -5.0, 224.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [127.0, -38.0, 8.0, -201.0, -69.0, 101.0, 9.0, -148.0, -21.0, -146.0, 0.0, -110.0, -73.0, 7.0, -55.0, 123.0, -18.0, 40.0, 7.0, -116.0, 29.0, -6.0, 86.0, -48.0, -21.0, -7.0, 31.0, 27.0, -29.0, -54.0, -11.0, 93.0, 28.0, 53.0, 0.0, 43.0, -56.0, -45.0, 11.0, 9.0, -37.0, -32.0, -2.0, 27.0, 23.0, 26.0, 8.0, 9.0, 64.0, -18.0, -45.0, 16.0, 67.0, 4.0, 33.0, 50.0, 64.0, 41.0, 19.0, -112.0, 0.0, 70.0, 1.0, 60.0, 41.0, 0.0, 58.0, 65.0, -18.0, 130.0, 12.0, 36.0, 0.0, 34.0, 0.0, 25.0, 30.0, -372.0, -75.0, 25.0, 37.0, 0.0, -368.0, 16.0, -211.0, -10.0, 28.0, 22.0, 0.0, 109.0, -18.0, 3.0, -90.0, -54.0, -202.0, 11.0, 43.0, -85.0, -15.0, 27.0, 50.0, 0.0, -23.0, -12.0, -64.0, -31.0, -32.0, 8.0, -56.0, 23.0, 90.0, 0.0, 19.0, 63.0, -73.0, -37.0, -34.0, -146.0, -15.0, -334.0, -235.0, -56.0, -104.0, 6.0, -38.0, 3.0, 25.0, 145.0, -134.0, 11.0, -75.0, -156.0, 2.0, 17.0, -31.0, 19.0, -131.0, 0.0, -134.0, -59.0, -2.0, -18.0, -200.0, -144.0, 47.0, -250.0, 43.0, 0.0, 11.0, -158.0, -27.0, -18.0, -159.0, 31.0, 62.0, -49.0, 184.0, 69.0, 45.0, 0.0, -98.0, 34.0, 0.0, 39.0, -30.0, 0.0, 3.0, 2.0, -51.0, -53.0, 74.0, 0.0, 65.0, 0.0, 5.0, -8.0, -6.0, 66.0, 3.0, 103.0, -170.0, 13.0, 20.0, -18.0, -107.0, -51.0, 1.0, -166.0, 0.0, 0.0, -3.0, -92.0, 50.0, 1.0, 48.0, -42.0, -10.0, 0.0, 103.0, 117.0], "policy_predator_policy_reward": [0.0, 19.0, 102.0, 15.0, 36.0, 1.0, 59.0, 85.0, 79.0, 30.0, 0.0, 55.0, 43.0, 0.0, 8.0, 45.0, 43.0, 35.0, 5.0, 58.0, 4.0, 3.0, 21.0, 18.0, 30.0, 0.0, 21.0, 0.0, 41.0, 0.0, 31.0, 0.0, 0.0, 0.0, 3.0, 14.0, 53.0, 10.0, 0.0, 0.0, 19.0, 14.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 9.0, 13.0, 0.0, 28.0, 0.0, 0.0, 0.0, 29.0, 0.0, 8.0, 0.0, 56.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 2.0, 0.0, 0.0, 5.0, 142.0, 83.0, 1.0, 48.0, 0.0, 0.0, 0.0, 199.0, 86.0, 28.0, 5.0, 0.0, 0.0, 0.0, 30.0, 13.0, 72.0, 15.0, 44.0, 109.0, 28.0, 50.0, 11.0, 17.0, 0.0, 0.0, 6.0, 17.0, 0.0, 79.0, 0.0, 24.0, 36.0, 0.0, 11.0, 3.0, 0.0, 1.0, 0.0, 71.0, 95.0, 20.0, 148.0, 147.0, 125.0, 34.0, 32.0, 68.0, 19.0, 0.0, 4.0, 0.0, 30.0, 70.0, 57.0, 83.0, 6.0, 0.0, 25.0, 1.0, 0.0, 66.0, 121.0, 10.0, 9.0, 1.0, 72.0, 105.0, 62.0, 117.0, 0.0, 9.0, 32.0, 80.0, 32.0, 0.0, 28.0, 65.0, 2.0, 29.0, 14.0, 6.0, 0.0, 0.0, 49.0, 39.0, 4.0, 0.0, 30.0, 34.0, 0.0, 0.0, 26.0, 32.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 3.0, 19.0, 0.0, 49.0, 98.0, 15.0, 33.0, 25.0, 83.0, 83.0, 6.0, 0.0, 0.0, 90.0, 2.0, 7.0, 12.0, 29.0, 92.0, 5.0, 0.0, 0.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9370594178498024, "mean_inference_ms": 2.92004577384537, "mean_action_processing_ms": 0.3760151038624575, "mean_env_wait_ms": 0.33029617538284095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00556337833404541, "StateBufferConnector_ms": 0.004320263862609863, "ViewRequirementAgentConnector_ms": 0.1712416410446167}, "num_episodes": 18, "episode_return_max": 273.0, "episode_return_min": -167.0, "episode_return_mean": 20.41, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.8234356284198, "num_env_steps_trained_throughput_per_sec": 356.8234356284198, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 112079.48, "restore_workers_time_ms": 0.024, "training_step_time_ms": 112079.414, "sample_time_ms": 2137.021, "learn_time_ms": 109919.856, "learn_throughput": 36.39, "synch_weights_time_ms": 19.237}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "e1352_00002", "date": "2024-08-13_19-20-40", "timestamp": 1723591240, "time_this_iter_s": 11.270370960235596, "time_total_s": 1134.010222196579, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bbbe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1134.010222196579, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 50.2375, "ram_util_percent": 83.56875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.30948579585544334, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 1.1731384663354782, "policy_loss": -0.00478779653668719, "vf_loss": 1.1770613810372732, "vf_explained_var": 0.0006512105149566812, "kl": 0.01729762885363688, "entropy": 1.5358572805369342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5523807384822734, "cur_kl_coeff": 0.0125, "cur_lr": 0.00010000000000000003, "total_loss": 3.325995627912895, "policy_loss": -0.0015588441936338626, "vf_loss": 3.3275096573526897, "vf_explained_var": 0.07681051741832148, "kl": 0.00358463906875986, "entropy": 1.575740674942259, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 273.0, "episode_reward_min": -167.0, "episode_reward_mean": 20.71, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -372.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -12.72, "predator_policy": 23.075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.0, 20.0, -36.0, 36.0, 49.0, 17.0, 68.0, -1.0, 71.0, 112.0, 113.0, -37.0, 70.0, 70.0, 41.0, 123.0, 132.0, 48.0, 36.0, 30.0, -117.0, -1.0, 37.0, -153.0, -107.0, 55.0, 109.0, 28.0, -57.0, -38.0, 36.0, 40.0, 50.0, -12.0, -16.0, 0.0, 3.0, 104.0, 83.0, -39.0, -65.0, -54.0, -132.0, 2.0, -16.0, 174.0, -23.0, -91.0, 25.0, 14.0, -65.0, -62.0, -10.0, -167.0, -24.0, 52.0, -35.0, -13.0, -35.0, 44.0, 273.0, 45.0, 24.0, 43.0, 34.0, 5.0, -46.0, 74.0, 65.0, 16.0, 63.0, 125.0, -10.0, 50.0, -50.0, -76.0, 0.0, -3.0, 70.0, 127.0, -5.0, 224.0, 32.0, -27.0, 84.0, 47.0, 36.0, -40.0, 27.0, 0.0, 40.0, 11.0, 23.0, 66.0, 137.0, 0.0, 21.0, -4.0, 17.0, 105.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-56.0, -45.0, 11.0, 9.0, -37.0, -32.0, -2.0, 27.0, 23.0, 26.0, 8.0, 9.0, 64.0, -18.0, -45.0, 16.0, 67.0, 4.0, 33.0, 50.0, 64.0, 41.0, 19.0, -112.0, 0.0, 70.0, 1.0, 60.0, 41.0, 0.0, 58.0, 65.0, -18.0, 130.0, 12.0, 36.0, 0.0, 34.0, 0.0, 25.0, 30.0, -372.0, -75.0, 25.0, 37.0, 0.0, -368.0, 16.0, -211.0, -10.0, 28.0, 22.0, 0.0, 109.0, -18.0, 3.0, -90.0, -54.0, -202.0, 11.0, 43.0, -85.0, -15.0, 27.0, 50.0, 0.0, -23.0, -12.0, -64.0, -31.0, -32.0, 8.0, -56.0, 23.0, 90.0, 0.0, 19.0, 63.0, -73.0, -37.0, -34.0, -146.0, -15.0, -334.0, -235.0, -56.0, -104.0, 6.0, -38.0, 3.0, 25.0, 145.0, -134.0, 11.0, -75.0, -156.0, 2.0, 17.0, -31.0, 19.0, -131.0, 0.0, -134.0, -59.0, -2.0, -18.0, -200.0, -144.0, 47.0, -250.0, 43.0, 0.0, 11.0, -158.0, -27.0, -18.0, -159.0, 31.0, 62.0, -49.0, 184.0, 69.0, 45.0, 0.0, -98.0, 34.0, 0.0, 39.0, -30.0, 0.0, 3.0, 2.0, -51.0, -53.0, 74.0, 0.0, 65.0, 0.0, 5.0, -8.0, -6.0, 66.0, 3.0, 103.0, -170.0, 13.0, 20.0, -18.0, -107.0, -51.0, 1.0, -166.0, 0.0, 0.0, -3.0, -92.0, 50.0, 1.0, 48.0, -42.0, -10.0, 0.0, 103.0, 117.0, 0.0, 8.0, -46.0, -8.0, 54.0, -44.0, -50.0, 72.0, -1.0, 0.0, -18.0, -62.0, -21.0, 0.0, 0.0, 0.0, 4.0, 0.0, -46.0, -10.0, 3.0, 19.0, -4.0, 68.0, 135.0, 2.0, 0.0, 0.0, 0.0, 21.0, -8.0, 0.0, 16.0, 1.0, 64.0, 38.0], "policy_predator_policy_reward": [53.0, 10.0, 0.0, 0.0, 19.0, 14.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 9.0, 13.0, 0.0, 28.0, 0.0, 0.0, 0.0, 29.0, 0.0, 8.0, 0.0, 56.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 2.0, 0.0, 0.0, 5.0, 142.0, 83.0, 1.0, 48.0, 0.0, 0.0, 0.0, 199.0, 86.0, 28.0, 5.0, 0.0, 0.0, 0.0, 30.0, 13.0, 72.0, 15.0, 44.0, 109.0, 28.0, 50.0, 11.0, 17.0, 0.0, 0.0, 6.0, 17.0, 0.0, 79.0, 0.0, 24.0, 36.0, 0.0, 11.0, 3.0, 0.0, 1.0, 0.0, 71.0, 95.0, 20.0, 148.0, 147.0, 125.0, 34.0, 32.0, 68.0, 19.0, 0.0, 4.0, 0.0, 30.0, 70.0, 57.0, 83.0, 6.0, 0.0, 25.0, 1.0, 0.0, 66.0, 121.0, 10.0, 9.0, 1.0, 72.0, 105.0, 62.0, 117.0, 0.0, 9.0, 32.0, 80.0, 32.0, 0.0, 28.0, 65.0, 2.0, 29.0, 14.0, 6.0, 0.0, 0.0, 49.0, 39.0, 4.0, 0.0, 30.0, 34.0, 0.0, 0.0, 26.0, 32.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 3.0, 19.0, 0.0, 49.0, 98.0, 15.0, 33.0, 25.0, 83.0, 83.0, 6.0, 0.0, 0.0, 90.0, 2.0, 7.0, 12.0, 29.0, 92.0, 5.0, 0.0, 0.0, 4.0, 24.0, 0.0, 9.0, 18.0, 58.0, 16.0, 0.0, 25.0, 0.0, 37.0, 40.0, 0.0, 45.0, 3.0, 0.0, 0.0, 32.0, 4.0, 36.0, 31.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9339549466054493, "mean_inference_ms": 2.8995107322135345, "mean_action_processing_ms": 0.3746102533291302, "mean_env_wait_ms": 0.3290657294509438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005419254302978516, "StateBufferConnector_ms": 0.004240512847900391, "ViewRequirementAgentConnector_ms": 0.14552748203277588}, "num_episodes": 18, "episode_return_max": 273.0, "episode_return_min": -167.0, "episode_return_mean": 20.71, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 126.97098594800364, "num_env_steps_trained_throughput_per_sec": 126.97098594800364, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 96341.1, "restore_workers_time_ms": 0.017, "training_step_time_ms": 96341.048, "sample_time_ms": 2029.914, "learn_time_ms": 94288.132, "learn_throughput": 42.423, "synch_weights_time_ms": 19.688}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "e1352_00002", "date": "2024-08-13_19-21-11", "timestamp": 1723591271, "time_this_iter_s": 31.5405170917511, "time_total_s": 1165.55073928833, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bbbee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1165.55073928833, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 74.09565217391305, "ram_util_percent": 83.98260869565217}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3655893424594844, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 2.4265598599242155, "policy_loss": -0.00537346487608615, "vf_loss": 2.431272154005747, "vf_explained_var": 0.004327812775102242, "kl": 0.013223225692525643, "entropy": 1.5311393813481406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.302735885626898, "cur_kl_coeff": 0.00625, "cur_lr": 0.00010000000000000003, "total_loss": 5.207526776904151, "policy_loss": -0.0012285798561399576, "vf_loss": 5.208717569724593, "vf_explained_var": 0.058560682888384216, "kl": 0.0060473176435798135, "entropy": 1.5375648048819688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 273.0, "episode_reward_min": -167.0, "episode_reward_mean": 13.94, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -372.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -19.61, "predator_policy": 26.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.0, 30.0, -117.0, -1.0, 37.0, -153.0, -107.0, 55.0, 109.0, 28.0, -57.0, -38.0, 36.0, 40.0, 50.0, -12.0, -16.0, 0.0, 3.0, 104.0, 83.0, -39.0, -65.0, -54.0, -132.0, 2.0, -16.0, 174.0, -23.0, -91.0, 25.0, 14.0, -65.0, -62.0, -10.0, -167.0, -24.0, 52.0, -35.0, -13.0, -35.0, 44.0, 273.0, 45.0, 24.0, 43.0, 34.0, 5.0, -46.0, 74.0, 65.0, 16.0, 63.0, 125.0, -10.0, 50.0, -50.0, -76.0, 0.0, -3.0, 70.0, 127.0, -5.0, 224.0, 32.0, -27.0, 84.0, 47.0, 36.0, -40.0, 27.0, 0.0, 40.0, 11.0, 23.0, 66.0, 137.0, 0.0, 21.0, -4.0, 17.0, 105.0, -166.0, -10.0, 29.0, 45.0, 118.0, -45.0, 1.0, 201.0, -30.0, 74.0, -5.0, -73.0, 14.0, -37.0, 28.0, 142.0, 35.0, -140.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 34.0, 0.0, 25.0, 30.0, -372.0, -75.0, 25.0, 37.0, 0.0, -368.0, 16.0, -211.0, -10.0, 28.0, 22.0, 0.0, 109.0, -18.0, 3.0, -90.0, -54.0, -202.0, 11.0, 43.0, -85.0, -15.0, 27.0, 50.0, 0.0, -23.0, -12.0, -64.0, -31.0, -32.0, 8.0, -56.0, 23.0, 90.0, 0.0, 19.0, 63.0, -73.0, -37.0, -34.0, -146.0, -15.0, -334.0, -235.0, -56.0, -104.0, 6.0, -38.0, 3.0, 25.0, 145.0, -134.0, 11.0, -75.0, -156.0, 2.0, 17.0, -31.0, 19.0, -131.0, 0.0, -134.0, -59.0, -2.0, -18.0, -200.0, -144.0, 47.0, -250.0, 43.0, 0.0, 11.0, -158.0, -27.0, -18.0, -159.0, 31.0, 62.0, -49.0, 184.0, 69.0, 45.0, 0.0, -98.0, 34.0, 0.0, 39.0, -30.0, 0.0, 3.0, 2.0, -51.0, -53.0, 74.0, 0.0, 65.0, 0.0, 5.0, -8.0, -6.0, 66.0, 3.0, 103.0, -170.0, 13.0, 20.0, -18.0, -107.0, -51.0, 1.0, -166.0, 0.0, 0.0, -3.0, -92.0, 50.0, 1.0, 48.0, -42.0, -10.0, 0.0, 103.0, 117.0, 0.0, 8.0, -46.0, -8.0, 54.0, -44.0, -50.0, 72.0, -1.0, 0.0, -18.0, -62.0, -21.0, 0.0, 0.0, 0.0, 4.0, 0.0, -46.0, -10.0, 3.0, 19.0, -4.0, 68.0, 135.0, 2.0, 0.0, 0.0, 0.0, 21.0, -8.0, 0.0, 16.0, 1.0, 64.0, 38.0, -168.0, -86.0, 45.0, -302.0, -52.0, 22.0, -96.0, 83.0, 27.0, 73.0, -38.0, -52.0, 1.0, 0.0, 6.0, 193.0, -60.0, 0.0, 18.0, 0.0, -2.0, -8.0, -135.0, -20.0, -112.0, 70.0, -38.0, -38.0, 28.0, 0.0, 168.0, -58.0, 0.0, 10.0, -172.0, -106.0], "policy_predator_policy_reward": [2.0, 0.0, 0.0, 5.0, 142.0, 83.0, 1.0, 48.0, 0.0, 0.0, 0.0, 199.0, 86.0, 28.0, 5.0, 0.0, 0.0, 0.0, 30.0, 13.0, 72.0, 15.0, 44.0, 109.0, 28.0, 50.0, 11.0, 17.0, 0.0, 0.0, 6.0, 17.0, 0.0, 79.0, 0.0, 24.0, 36.0, 0.0, 11.0, 3.0, 0.0, 1.0, 0.0, 71.0, 95.0, 20.0, 148.0, 147.0, 125.0, 34.0, 32.0, 68.0, 19.0, 0.0, 4.0, 0.0, 30.0, 70.0, 57.0, 83.0, 6.0, 0.0, 25.0, 1.0, 0.0, 66.0, 121.0, 10.0, 9.0, 1.0, 72.0, 105.0, 62.0, 117.0, 0.0, 9.0, 32.0, 80.0, 32.0, 0.0, 28.0, 65.0, 2.0, 29.0, 14.0, 6.0, 0.0, 0.0, 49.0, 39.0, 4.0, 0.0, 30.0, 34.0, 0.0, 0.0, 26.0, 32.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 3.0, 19.0, 0.0, 49.0, 98.0, 15.0, 33.0, 25.0, 83.0, 83.0, 6.0, 0.0, 0.0, 90.0, 2.0, 7.0, 12.0, 29.0, 92.0, 5.0, 0.0, 0.0, 4.0, 24.0, 0.0, 9.0, 18.0, 58.0, 16.0, 0.0, 25.0, 0.0, 37.0, 40.0, 0.0, 45.0, 3.0, 0.0, 0.0, 32.0, 4.0, 36.0, 31.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 3.0, 0.0, 88.0, 0.0, 165.0, 82.0, 46.0, 13.0, 21.0, 37.0, 17.0, 1.0, 19.0, 26.0, 0.0, 0.0, 0.0, 2.0, 14.0, 16.0, 46.0, 10.0, 4.0, 1.0, 82.0, 0.0, 0.0, 56.0, 13.0, 26.0, 0.0, 0.0, 0.0, 32.0, 0.0, 25.0, 19.0, 119.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9321529886769174, "mean_inference_ms": 2.892717138701167, "mean_action_processing_ms": 0.3740858068932102, "mean_env_wait_ms": 0.3290568419562219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005334377288818359, "StateBufferConnector_ms": 0.004121661186218262, "ViewRequirementAgentConnector_ms": 0.14536702632904053}, "num_episodes": 18, "episode_return_max": 273.0, "episode_return_min": -167.0, "episode_return_mean": 13.94, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.48740304674794, "num_env_steps_trained_throughput_per_sec": 333.48740304674794, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 96407.179, "restore_workers_time_ms": 0.017, "training_step_time_ms": 96407.127, "sample_time_ms": 2100.86, "learn_time_ms": 94283.33, "learn_throughput": 42.425, "synch_weights_time_ms": 19.632}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "e1352_00002", "date": "2024-08-13_19-21-23", "timestamp": 1723591283, "time_this_iter_s": 12.044506072998047, "time_total_s": 1177.5952453613281, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32d6bfaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1177.5952453613281, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 59.95294117647058, "ram_util_percent": 82.0764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.25839674585553074, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 2.54492253197564, "policy_loss": -0.002690864855019504, "vf_loss": 2.5471117574071127, "vf_explained_var": 0.002538568096816855, "kl": 0.01003268645933032, "entropy": 1.5557504035808423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2203401706166686, "cur_kl_coeff": 0.00625, "cur_lr": 0.00010000000000000003, "total_loss": 4.75781924283063, "policy_loss": -0.004156782757737255, "vf_loss": 4.76193039164972, "vf_explained_var": 0.045936636224625606, "kl": 0.00730276013774185, "entropy": 1.5759349245873708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 358.0, "episode_reward_min": -167.0, "episode_reward_mean": 27.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -302.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 165.0}, "policy_reward_mean": {"prey_policy": -9.135, "predator_policy": 23.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.0, -23.0, -91.0, 25.0, 14.0, -65.0, -62.0, -10.0, -167.0, -24.0, 52.0, -35.0, -13.0, -35.0, 44.0, 273.0, 45.0, 24.0, 43.0, 34.0, 5.0, -46.0, 74.0, 65.0, 16.0, 63.0, 125.0, -10.0, 50.0, -50.0, -76.0, 0.0, -3.0, 70.0, 127.0, -5.0, 224.0, 32.0, -27.0, 84.0, 47.0, 36.0, -40.0, 27.0, 0.0, 40.0, 11.0, 23.0, 66.0, 137.0, 0.0, 21.0, -4.0, 17.0, 105.0, -166.0, -10.0, 29.0, 45.0, 118.0, -45.0, 1.0, 201.0, -30.0, 74.0, -5.0, -73.0, 14.0, -37.0, 28.0, 142.0, 35.0, -140.0, -41.0, -41.0, 84.0, 47.0, 182.0, 0.0, 189.0, 62.0, 12.0, 29.0, 43.0, -32.0, 189.0, 106.0, -65.0, 149.0, 0.0, -88.0, 14.0, -120.0, -44.0, 16.0, 79.0, -16.0, 358.0, 89.0, -3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.0, 145.0, -134.0, 11.0, -75.0, -156.0, 2.0, 17.0, -31.0, 19.0, -131.0, 0.0, -134.0, -59.0, -2.0, -18.0, -200.0, -144.0, 47.0, -250.0, 43.0, 0.0, 11.0, -158.0, -27.0, -18.0, -159.0, 31.0, 62.0, -49.0, 184.0, 69.0, 45.0, 0.0, -98.0, 34.0, 0.0, 39.0, -30.0, 0.0, 3.0, 2.0, -51.0, -53.0, 74.0, 0.0, 65.0, 0.0, 5.0, -8.0, -6.0, 66.0, 3.0, 103.0, -170.0, 13.0, 20.0, -18.0, -107.0, -51.0, 1.0, -166.0, 0.0, 0.0, -3.0, -92.0, 50.0, 1.0, 48.0, -42.0, -10.0, 0.0, 103.0, 117.0, 0.0, 8.0, -46.0, -8.0, 54.0, -44.0, -50.0, 72.0, -1.0, 0.0, -18.0, -62.0, -21.0, 0.0, 0.0, 0.0, 4.0, 0.0, -46.0, -10.0, 3.0, 19.0, -4.0, 68.0, 135.0, 2.0, 0.0, 0.0, 0.0, 21.0, -8.0, 0.0, 16.0, 1.0, 64.0, 38.0, -168.0, -86.0, 45.0, -302.0, -52.0, 22.0, -96.0, 83.0, 27.0, 73.0, -38.0, -52.0, 1.0, 0.0, 6.0, 193.0, -60.0, 0.0, 18.0, 0.0, -2.0, -8.0, -135.0, -20.0, -112.0, 70.0, -38.0, -38.0, 28.0, 0.0, 168.0, -58.0, 0.0, 10.0, -172.0, -106.0, -140.0, -3.0, -82.0, 0.0, 54.0, 17.0, 24.0, -73.0, 161.0, 9.0, 0.0, 0.0, 120.0, 69.0, 97.0, -266.0, 2.0, -54.0, -11.0, 8.0, 33.0, 10.0, -2.0, -62.0, 172.0, 10.0, 64.0, 0.0, -184.0, 27.0, 86.0, -32.0, 0.0, 0.0, -82.0, -68.0, 0.0, 14.0, -122.0, -128.0, -232.0, 70.0, -22.0, 27.0, -23.0, 86.0, -32.0, 0.0, 158.0, 200.0, 89.0, 0.0, 6.0, -18.0], "policy_predator_policy_reward": [4.0, 0.0, 30.0, 70.0, 57.0, 83.0, 6.0, 0.0, 25.0, 1.0, 0.0, 66.0, 121.0, 10.0, 9.0, 1.0, 72.0, 105.0, 62.0, 117.0, 0.0, 9.0, 32.0, 80.0, 32.0, 0.0, 28.0, 65.0, 2.0, 29.0, 14.0, 6.0, 0.0, 0.0, 49.0, 39.0, 4.0, 0.0, 30.0, 34.0, 0.0, 0.0, 26.0, 32.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 3.0, 19.0, 0.0, 49.0, 98.0, 15.0, 33.0, 25.0, 83.0, 83.0, 6.0, 0.0, 0.0, 90.0, 2.0, 7.0, 12.0, 29.0, 92.0, 5.0, 0.0, 0.0, 4.0, 24.0, 0.0, 9.0, 18.0, 58.0, 16.0, 0.0, 25.0, 0.0, 37.0, 40.0, 0.0, 45.0, 3.0, 0.0, 0.0, 32.0, 4.0, 36.0, 31.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 3.0, 0.0, 88.0, 0.0, 165.0, 82.0, 46.0, 13.0, 21.0, 37.0, 17.0, 1.0, 19.0, 26.0, 0.0, 0.0, 0.0, 2.0, 14.0, 16.0, 46.0, 10.0, 4.0, 1.0, 82.0, 0.0, 0.0, 56.0, 13.0, 26.0, 0.0, 0.0, 0.0, 32.0, 0.0, 25.0, 19.0, 119.0, 41.0, 61.0, 0.0, 41.0, 0.0, 13.0, 46.0, 50.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 146.0, 85.0, 0.0, 64.0, 4.0, 28.0, 0.0, 0.0, 31.0, 1.0, 7.0, 0.0, 20.0, 22.0, 92.0, 0.0, 41.0, 54.0, 0.0, 0.0, 58.0, 4.0, 0.0, 0.0, 65.0, 65.0, 2.0, 116.0, 11.0, 0.0, 0.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9233365025259063, "mean_inference_ms": 2.870826713123134, "mean_action_processing_ms": 0.36953270232914576, "mean_env_wait_ms": 0.3266995524483324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004637360572814941, "StateBufferConnector_ms": 0.003997206687927246, "ViewRequirementAgentConnector_ms": 0.1244276762008667}, "num_episodes": 27, "episode_return_max": 358.0, "episode_return_min": -167.0, "episode_return_mean": 27.86, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.1211576586456, "num_env_steps_trained_throughput_per_sec": 334.1211576586456, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 96468.789, "restore_workers_time_ms": 0.017, "training_step_time_ms": 96468.737, "sample_time_ms": 2106.705, "learn_time_ms": 94339.637, "learn_throughput": 42.4, "synch_weights_time_ms": 18.724}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "e1352_00002", "date": "2024-08-13_19-21-35", "timestamp": 1723591295, "time_this_iter_s": 12.016136884689331, "time_total_s": 1189.6113822460175, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb59d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1189.6113822460175, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 52.69411764705882, "ram_util_percent": 82.11176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.36799616141924785, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 3.902432099978129, "policy_loss": -0.005831428653457099, "vf_loss": 3.9072536658988426, "vf_explained_var": 0.005003475165240979, "kl": 0.02019716618065028, "entropy": 1.5111874114899408, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.243664260015444, "cur_kl_coeff": 0.00625, "cur_lr": 0.00010000000000000003, "total_loss": 6.203963140457396, "policy_loss": -0.0030382891092572617, "vf_loss": 6.206971337050988, "vf_explained_var": 0.029028286221166138, "kl": 0.004812784223983014, "entropy": 1.5453332188268187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 358.0, "episode_reward_min": -166.0, "episode_reward_mean": 27.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -302.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 165.0}, "policy_reward_mean": {"prey_policy": -8.33, "predator_policy": 22.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 34.0, 5.0, -46.0, 74.0, 65.0, 16.0, 63.0, 125.0, -10.0, 50.0, -50.0, -76.0, 0.0, -3.0, 70.0, 127.0, -5.0, 224.0, 32.0, -27.0, 84.0, 47.0, 36.0, -40.0, 27.0, 0.0, 40.0, 11.0, 23.0, 66.0, 137.0, 0.0, 21.0, -4.0, 17.0, 105.0, -166.0, -10.0, 29.0, 45.0, 118.0, -45.0, 1.0, 201.0, -30.0, 74.0, -5.0, -73.0, 14.0, -37.0, 28.0, 142.0, 35.0, -140.0, -41.0, -41.0, 84.0, 47.0, 182.0, 0.0, 189.0, 62.0, 12.0, 29.0, 43.0, -32.0, 189.0, 106.0, -65.0, 149.0, 0.0, -88.0, 14.0, -120.0, -44.0, 16.0, 79.0, -16.0, 358.0, 89.0, -3.0, -14.0, 54.0, -21.0, 13.0, 110.0, 96.0, 225.0, -22.0, -145.0, -45.0, 76.0, -146.0, -106.0, -43.0, 43.0, -11.0, -3.0, 33.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 39.0, -30.0, 0.0, 3.0, 2.0, -51.0, -53.0, 74.0, 0.0, 65.0, 0.0, 5.0, -8.0, -6.0, 66.0, 3.0, 103.0, -170.0, 13.0, 20.0, -18.0, -107.0, -51.0, 1.0, -166.0, 0.0, 0.0, -3.0, -92.0, 50.0, 1.0, 48.0, -42.0, -10.0, 0.0, 103.0, 117.0, 0.0, 8.0, -46.0, -8.0, 54.0, -44.0, -50.0, 72.0, -1.0, 0.0, -18.0, -62.0, -21.0, 0.0, 0.0, 0.0, 4.0, 0.0, -46.0, -10.0, 3.0, 19.0, -4.0, 68.0, 135.0, 2.0, 0.0, 0.0, 0.0, 21.0, -8.0, 0.0, 16.0, 1.0, 64.0, 38.0, -168.0, -86.0, 45.0, -302.0, -52.0, 22.0, -96.0, 83.0, 27.0, 73.0, -38.0, -52.0, 1.0, 0.0, 6.0, 193.0, -60.0, 0.0, 18.0, 0.0, -2.0, -8.0, -135.0, -20.0, -112.0, 70.0, -38.0, -38.0, 28.0, 0.0, 168.0, -58.0, 0.0, 10.0, -172.0, -106.0, -140.0, -3.0, -82.0, 0.0, 54.0, 17.0, 24.0, -73.0, 161.0, 9.0, 0.0, 0.0, 120.0, 69.0, 97.0, -266.0, 2.0, -54.0, -11.0, 8.0, 33.0, 10.0, -2.0, -62.0, 172.0, 10.0, 64.0, 0.0, -184.0, 27.0, 86.0, -32.0, 0.0, 0.0, -82.0, -68.0, 0.0, 14.0, -122.0, -128.0, -232.0, 70.0, -22.0, 27.0, -23.0, 86.0, -32.0, 0.0, 158.0, 200.0, 89.0, 0.0, 6.0, -18.0, -192.0, 82.0, -17.0, 16.0, 0.0, -44.0, 0.0, 13.0, 4.0, 80.0, -14.0, 75.0, 122.0, 103.0, -173.0, 51.0, -134.0, -114.0, -82.0, -8.0, 38.0, 14.0, -127.0, -157.0, 0.0, -228.0, -108.0, 0.0, 10.0, -9.0, 4.0, -82.0, 3.0, -33.0, -26.0, -4.0], "policy_predator_policy_reward": [4.0, 0.0, 30.0, 34.0, 0.0, 0.0, 26.0, 32.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 3.0, 19.0, 0.0, 49.0, 98.0, 15.0, 33.0, 25.0, 83.0, 83.0, 6.0, 0.0, 0.0, 90.0, 2.0, 7.0, 12.0, 29.0, 92.0, 5.0, 0.0, 0.0, 4.0, 24.0, 0.0, 9.0, 18.0, 58.0, 16.0, 0.0, 25.0, 0.0, 37.0, 40.0, 0.0, 45.0, 3.0, 0.0, 0.0, 32.0, 4.0, 36.0, 31.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 3.0, 0.0, 88.0, 0.0, 165.0, 82.0, 46.0, 13.0, 21.0, 37.0, 17.0, 1.0, 19.0, 26.0, 0.0, 0.0, 0.0, 2.0, 14.0, 16.0, 46.0, 10.0, 4.0, 1.0, 82.0, 0.0, 0.0, 56.0, 13.0, 26.0, 0.0, 0.0, 0.0, 32.0, 0.0, 25.0, 19.0, 119.0, 41.0, 61.0, 0.0, 41.0, 0.0, 13.0, 46.0, 50.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 146.0, 85.0, 0.0, 64.0, 4.0, 28.0, 0.0, 0.0, 31.0, 1.0, 7.0, 0.0, 20.0, 22.0, 92.0, 0.0, 41.0, 54.0, 0.0, 0.0, 58.0, 4.0, 0.0, 0.0, 65.0, 65.0, 2.0, 116.0, 11.0, 0.0, 0.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 8.0, 85.0, 11.0, 35.0, 20.0, 23.0, 0.0, 0.0, 0.0, 26.0, 0.0, 35.0, 0.0, 0.0, 0.0, 44.0, 56.0, 44.0, 59.0, 43.0, 2.0, 3.0, 21.0, 46.0, 92.0, 121.0, 1.0, 0.0, 65.0, 0.0, 42.0, 34.0, 33.0, 0.0, 27.0, 36.0, 27.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9108421723420386, "mean_inference_ms": 2.832562591947093, "mean_action_processing_ms": 0.36463733599609677, "mean_env_wait_ms": 0.3212843252660685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003960609436035156, "StateBufferConnector_ms": 0.003398895263671875, "ViewRequirementAgentConnector_ms": 0.11547982692718506}, "num_episodes": 18, "episode_return_max": 358.0, "episode_return_min": -166.0, "episode_return_mean": 27.54, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.4565623389202, "num_env_steps_trained_throughput_per_sec": 329.4565623389202, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 96516.985, "restore_workers_time_ms": 0.017, "training_step_time_ms": 96516.933, "sample_time_ms": 2059.73, "learn_time_ms": 94434.111, "learn_throughput": 42.358, "synch_weights_time_ms": 19.353}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "e1352_00002", "date": "2024-08-13_19-21-48", "timestamp": 1723591308, "time_this_iter_s": 12.199725866317749, "time_total_s": 1201.8111081123352, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb5a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1201.8111081123352, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 58.66470588235295, "ram_util_percent": 83.22941176470587}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3960090740588765, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 3.773191225087201, "policy_loss": -0.004976053767167426, "vf_loss": 3.7772741720159217, "vf_explained_var": 0.002658479995828457, "kl": 0.011907997081611804, "entropy": 1.4563329744591285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.918543703428337, "cur_kl_coeff": 0.003125, "cur_lr": 0.00010000000000000003, "total_loss": 6.178059595350235, "policy_loss": -0.0013036771293079097, "vf_loss": 6.179343988529589, "vf_explained_var": 0.04929835216078178, "kl": 0.006164992125163687, "entropy": 1.532569136379888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 358.0, "episode_reward_min": -166.0, "episode_reward_mean": 22.63, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -302.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 165.0}, "policy_reward_mean": {"prey_policy": -13.585, "predator_policy": 24.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [224.0, 32.0, -27.0, 84.0, 47.0, 36.0, -40.0, 27.0, 0.0, 40.0, 11.0, 23.0, 66.0, 137.0, 0.0, 21.0, -4.0, 17.0, 105.0, -166.0, -10.0, 29.0, 45.0, 118.0, -45.0, 1.0, 201.0, -30.0, 74.0, -5.0, -73.0, 14.0, -37.0, 28.0, 142.0, 35.0, -140.0, -41.0, -41.0, 84.0, 47.0, 182.0, 0.0, 189.0, 62.0, 12.0, 29.0, 43.0, -32.0, 189.0, 106.0, -65.0, 149.0, 0.0, -88.0, 14.0, -120.0, -44.0, 16.0, 79.0, -16.0, 358.0, 89.0, -3.0, -14.0, 54.0, -21.0, 13.0, 110.0, 96.0, 225.0, -22.0, -145.0, -45.0, 76.0, -146.0, -106.0, -43.0, 43.0, -11.0, -3.0, 33.0, 42.0, 140.0, 100.0, -121.0, 71.0, -77.0, -13.0, -119.0, -129.0, -109.0, -10.0, 30.0, -146.0, 160.0, -86.0, 125.0, -16.0, 149.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [103.0, 117.0, 0.0, 8.0, -46.0, -8.0, 54.0, -44.0, -50.0, 72.0, -1.0, 0.0, -18.0, -62.0, -21.0, 0.0, 0.0, 0.0, 4.0, 0.0, -46.0, -10.0, 3.0, 19.0, -4.0, 68.0, 135.0, 2.0, 0.0, 0.0, 0.0, 21.0, -8.0, 0.0, 16.0, 1.0, 64.0, 38.0, -168.0, -86.0, 45.0, -302.0, -52.0, 22.0, -96.0, 83.0, 27.0, 73.0, -38.0, -52.0, 1.0, 0.0, 6.0, 193.0, -60.0, 0.0, 18.0, 0.0, -2.0, -8.0, -135.0, -20.0, -112.0, 70.0, -38.0, -38.0, 28.0, 0.0, 168.0, -58.0, 0.0, 10.0, -172.0, -106.0, -140.0, -3.0, -82.0, 0.0, 54.0, 17.0, 24.0, -73.0, 161.0, 9.0, 0.0, 0.0, 120.0, 69.0, 97.0, -266.0, 2.0, -54.0, -11.0, 8.0, 33.0, 10.0, -2.0, -62.0, 172.0, 10.0, 64.0, 0.0, -184.0, 27.0, 86.0, -32.0, 0.0, 0.0, -82.0, -68.0, 0.0, 14.0, -122.0, -128.0, -232.0, 70.0, -22.0, 27.0, -23.0, 86.0, -32.0, 0.0, 158.0, 200.0, 89.0, 0.0, 6.0, -18.0, -192.0, 82.0, -17.0, 16.0, 0.0, -44.0, 0.0, 13.0, 4.0, 80.0, -14.0, 75.0, 122.0, 103.0, -173.0, 51.0, -134.0, -114.0, -82.0, -8.0, 38.0, 14.0, -127.0, -157.0, 0.0, -228.0, -108.0, 0.0, 10.0, -9.0, 4.0, -82.0, 3.0, -33.0, -26.0, -4.0, 37.0, -27.0, 28.0, 92.0, 92.0, 0.0, 5.0, -270.0, 37.0, -1.0, 0.0, -164.0, -156.0, 65.0, 20.0, -278.0, -66.0, -150.0, -82.0, -184.0, -68.0, -2.0, 32.0, -86.0, -219.0, -84.0, 87.0, 54.0, -177.0, 0.0, 20.0, 43.0, 21.0, -108.0, 87.0, 37.0], "policy_predator_policy_reward": [0.0, 4.0, 24.0, 0.0, 9.0, 18.0, 58.0, 16.0, 0.0, 25.0, 0.0, 37.0, 40.0, 0.0, 45.0, 3.0, 0.0, 0.0, 32.0, 4.0, 36.0, 31.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 3.0, 0.0, 88.0, 0.0, 165.0, 82.0, 46.0, 13.0, 21.0, 37.0, 17.0, 1.0, 19.0, 26.0, 0.0, 0.0, 0.0, 2.0, 14.0, 16.0, 46.0, 10.0, 4.0, 1.0, 82.0, 0.0, 0.0, 56.0, 13.0, 26.0, 0.0, 0.0, 0.0, 32.0, 0.0, 25.0, 19.0, 119.0, 41.0, 61.0, 0.0, 41.0, 0.0, 13.0, 46.0, 50.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 146.0, 85.0, 0.0, 64.0, 4.0, 28.0, 0.0, 0.0, 31.0, 1.0, 7.0, 0.0, 20.0, 22.0, 92.0, 0.0, 41.0, 54.0, 0.0, 0.0, 58.0, 4.0, 0.0, 0.0, 65.0, 65.0, 2.0, 116.0, 11.0, 0.0, 0.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 8.0, 85.0, 11.0, 35.0, 20.0, 23.0, 0.0, 0.0, 0.0, 26.0, 0.0, 35.0, 0.0, 0.0, 0.0, 44.0, 56.0, 44.0, 59.0, 43.0, 2.0, 3.0, 21.0, 46.0, 92.0, 121.0, 1.0, 0.0, 65.0, 0.0, 42.0, 34.0, 33.0, 0.0, 27.0, 36.0, 27.0, 14.0, 18.0, 0.0, 20.0, 8.0, 0.0, 0.0, 144.0, 35.0, 0.0, 84.0, 3.0, 0.0, 78.0, 139.0, 0.0, 75.0, 12.0, 0.0, 157.0, 60.0, 0.0, 25.0, 59.0, 42.0, 115.0, 3.0, 16.0, 0.0, 91.0, 13.0, 49.0, 10.0, 61.0, 25.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8993799173990115, "mean_inference_ms": 2.802493653209067, "mean_action_processing_ms": 0.35996826527572706, "mean_env_wait_ms": 0.31729683142993936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003875255584716797, "StateBufferConnector_ms": 0.003489255905151367, "ViewRequirementAgentConnector_ms": 0.10931897163391113}, "num_episodes": 18, "episode_return_max": 358.0, "episode_return_min": -166.0, "episode_return_mean": 22.63, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 338.46434668890225, "num_env_steps_trained_throughput_per_sec": 338.46434668890225, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 19826.451, "restore_workers_time_ms": 0.017, "training_step_time_ms": 19826.402, "sample_time_ms": 2073.281, "learn_time_ms": 17731.948, "learn_throughput": 225.582, "synch_weights_time_ms": 18.075}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "e1352_00002", "date": "2024-08-13_19-22-00", "timestamp": 1723591320, "time_this_iter_s": 11.870332956314087, "time_total_s": 1213.6814410686493, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32d6bfa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1213.6814410686493, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 57.12941176470587, "ram_util_percent": 83.31764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3809342211989499, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 4.4676725342160175, "policy_loss": -0.0035015459879542943, "vf_loss": 4.4702235142389934, "vf_explained_var": 0.003744326571308116, "kl": 0.012674285581273665, "entropy": 1.4780315418092032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.31532769579263, "cur_kl_coeff": 0.003125, "cur_lr": 0.00010000000000000003, "total_loss": 5.427406833285377, "policy_loss": -0.002259021521688848, "vf_loss": 5.429655469283856, "vf_explained_var": 0.030524443507825256, "kl": 0.003323650391680843, "entropy": 1.5661921625414854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 358.0, "episode_reward_min": -279.0, "episode_reward_mean": 10.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -302.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 165.0}, "policy_reward_mean": {"prey_policy": -23.075, "predator_policy": 28.415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [105.0, -166.0, -10.0, 29.0, 45.0, 118.0, -45.0, 1.0, 201.0, -30.0, 74.0, -5.0, -73.0, 14.0, -37.0, 28.0, 142.0, 35.0, -140.0, -41.0, -41.0, 84.0, 47.0, 182.0, 0.0, 189.0, 62.0, 12.0, 29.0, 43.0, -32.0, 189.0, 106.0, -65.0, 149.0, 0.0, -88.0, 14.0, -120.0, -44.0, 16.0, 79.0, -16.0, 358.0, 89.0, -3.0, -14.0, 54.0, -21.0, 13.0, 110.0, 96.0, 225.0, -22.0, -145.0, -45.0, 76.0, -146.0, -106.0, -43.0, 43.0, -11.0, -3.0, 33.0, 42.0, 140.0, 100.0, -121.0, 71.0, -77.0, -13.0, -119.0, -129.0, -109.0, -10.0, 30.0, -146.0, 160.0, -86.0, 125.0, -16.0, 149.0, 24.0, -4.0, 2.0, -165.0, -23.0, -93.0, -279.0, -25.0, 31.0, -13.0, 9.0, 62.0, 129.0, -96.0, 1.0, -148.0, -4.0, 91.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [64.0, 38.0, -168.0, -86.0, 45.0, -302.0, -52.0, 22.0, -96.0, 83.0, 27.0, 73.0, -38.0, -52.0, 1.0, 0.0, 6.0, 193.0, -60.0, 0.0, 18.0, 0.0, -2.0, -8.0, -135.0, -20.0, -112.0, 70.0, -38.0, -38.0, 28.0, 0.0, 168.0, -58.0, 0.0, 10.0, -172.0, -106.0, -140.0, -3.0, -82.0, 0.0, 54.0, 17.0, 24.0, -73.0, 161.0, 9.0, 0.0, 0.0, 120.0, 69.0, 97.0, -266.0, 2.0, -54.0, -11.0, 8.0, 33.0, 10.0, -2.0, -62.0, 172.0, 10.0, 64.0, 0.0, -184.0, 27.0, 86.0, -32.0, 0.0, 0.0, -82.0, -68.0, 0.0, 14.0, -122.0, -128.0, -232.0, 70.0, -22.0, 27.0, -23.0, 86.0, -32.0, 0.0, 158.0, 200.0, 89.0, 0.0, 6.0, -18.0, -192.0, 82.0, -17.0, 16.0, 0.0, -44.0, 0.0, 13.0, 4.0, 80.0, -14.0, 75.0, 122.0, 103.0, -173.0, 51.0, -134.0, -114.0, -82.0, -8.0, 38.0, 14.0, -127.0, -157.0, 0.0, -228.0, -108.0, 0.0, 10.0, -9.0, 4.0, -82.0, 3.0, -33.0, -26.0, -4.0, 37.0, -27.0, 28.0, 92.0, 92.0, 0.0, 5.0, -270.0, 37.0, -1.0, 0.0, -164.0, -156.0, 65.0, 20.0, -278.0, -66.0, -150.0, -82.0, -184.0, -68.0, -2.0, 32.0, -86.0, -219.0, -84.0, 87.0, 54.0, -177.0, 0.0, 20.0, 43.0, 21.0, -108.0, 87.0, 37.0, 13.0, 5.0, -11.0, 0.0, 2.0, 0.0, -132.0, -180.0, -42.0, -4.0, 1.0, -199.0, -152.0, -284.0, -4.0, -54.0, -37.0, 2.0, 0.0, -26.0, -142.0, 33.0, 59.0, 1.0, 109.0, 19.0, -56.0, -136.0, 0.0, 1.0, -270.0, -122.0, 0.0, -35.0, 66.0, -18.0], "policy_predator_policy_reward": [3.0, 0.0, 88.0, 0.0, 165.0, 82.0, 46.0, 13.0, 21.0, 37.0, 17.0, 1.0, 19.0, 26.0, 0.0, 0.0, 0.0, 2.0, 14.0, 16.0, 46.0, 10.0, 4.0, 1.0, 82.0, 0.0, 0.0, 56.0, 13.0, 26.0, 0.0, 0.0, 0.0, 32.0, 0.0, 25.0, 19.0, 119.0, 41.0, 61.0, 0.0, 41.0, 0.0, 13.0, 46.0, 50.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 146.0, 85.0, 0.0, 64.0, 4.0, 28.0, 0.0, 0.0, 31.0, 1.0, 7.0, 0.0, 20.0, 22.0, 92.0, 0.0, 41.0, 54.0, 0.0, 0.0, 58.0, 4.0, 0.0, 0.0, 65.0, 65.0, 2.0, 116.0, 11.0, 0.0, 0.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 8.0, 85.0, 11.0, 35.0, 20.0, 23.0, 0.0, 0.0, 0.0, 26.0, 0.0, 35.0, 0.0, 0.0, 0.0, 44.0, 56.0, 44.0, 59.0, 43.0, 2.0, 3.0, 21.0, 46.0, 92.0, 121.0, 1.0, 0.0, 65.0, 0.0, 42.0, 34.0, 33.0, 0.0, 27.0, 36.0, 27.0, 14.0, 18.0, 0.0, 20.0, 8.0, 0.0, 0.0, 144.0, 35.0, 0.0, 84.0, 3.0, 0.0, 78.0, 139.0, 0.0, 75.0, 12.0, 0.0, 157.0, 60.0, 0.0, 25.0, 59.0, 42.0, 115.0, 3.0, 16.0, 0.0, 91.0, 13.0, 49.0, 10.0, 61.0, 25.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 0.0, 61.0, 86.0, 21.0, 2.0, 47.0, 58.0, 156.0, 1.0, 0.0, 33.0, 65.0, 1.0, 13.0, 0.0, 64.0, 54.0, 0.0, 2.0, 0.0, 1.0, 96.0, 0.0, 0.0, 0.0, 80.0, 164.0, 0.0, 31.0, 42.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8910160234910416, "mean_inference_ms": 2.7810699734037057, "mean_action_processing_ms": 0.35659701900269186, "mean_env_wait_ms": 0.3145063066184395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038442611694335938, "StateBufferConnector_ms": 0.003453969955444336, "ViewRequirementAgentConnector_ms": 0.11541581153869629}, "num_episodes": 18, "episode_return_max": 358.0, "episode_return_min": -279.0, "episode_return_mean": 10.68, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.41376737662983, "num_env_steps_trained_throughput_per_sec": 334.41376737662983, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 19126.454, "restore_workers_time_ms": 0.017, "training_step_time_ms": 19126.389, "sample_time_ms": 1870.454, "learn_time_ms": 17234.381, "learn_throughput": 232.094, "synch_weights_time_ms": 18.087}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "e1352_00002", "date": "2024-08-13_19-22-12", "timestamp": 1723591332, "time_this_iter_s": 12.006262063980103, "time_total_s": 1225.6877031326294, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb5c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1225.6877031326294, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 56.14117647058823, "ram_util_percent": 83.52941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4348528181887651, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 3.2209024966709197, "policy_loss": -0.005560387795909293, "vf_loss": 3.225071039969328, "vf_explained_var": 0.0021709970380894093, "kl": 0.018557897061699424, "entropy": 1.4292072255144674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7512320739488123, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 5.3514478052734695, "policy_loss": -0.004049057898693102, "vf_loss": 5.355484754446322, "vf_explained_var": 0.060680741954732824, "kl": 0.0077674754091009894, "entropy": 1.5090305349814197, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 358.0, "episode_reward_min": -279.0, "episode_reward_mean": 13.77, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -284.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 164.0}, "policy_reward_mean": {"prey_policy": -22.005, "predator_policy": 28.89}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.0, 182.0, 0.0, 189.0, 62.0, 12.0, 29.0, 43.0, -32.0, 189.0, 106.0, -65.0, 149.0, 0.0, -88.0, 14.0, -120.0, -44.0, 16.0, 79.0, -16.0, 358.0, 89.0, -3.0, -14.0, 54.0, -21.0, 13.0, 110.0, 96.0, 225.0, -22.0, -145.0, -45.0, 76.0, -146.0, -106.0, -43.0, 43.0, -11.0, -3.0, 33.0, 42.0, 140.0, 100.0, -121.0, 71.0, -77.0, -13.0, -119.0, -129.0, -109.0, -10.0, 30.0, -146.0, 160.0, -86.0, 125.0, -16.0, 149.0, 24.0, -4.0, 2.0, -165.0, -23.0, -93.0, -279.0, -25.0, 31.0, -13.0, 9.0, 62.0, 129.0, -96.0, 1.0, -148.0, -4.0, 91.0, -20.0, 37.0, 123.0, 136.0, 238.0, 3.0, -154.0, 195.0, 134.0, 136.0, -236.0, 6.0, -253.0, -3.0, 53.0, -61.0, 40.0, 0.0, -33.0, 6.0, -106.0, 356.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [24.0, -73.0, 161.0, 9.0, 0.0, 0.0, 120.0, 69.0, 97.0, -266.0, 2.0, -54.0, -11.0, 8.0, 33.0, 10.0, -2.0, -62.0, 172.0, 10.0, 64.0, 0.0, -184.0, 27.0, 86.0, -32.0, 0.0, 0.0, -82.0, -68.0, 0.0, 14.0, -122.0, -128.0, -232.0, 70.0, -22.0, 27.0, -23.0, 86.0, -32.0, 0.0, 158.0, 200.0, 89.0, 0.0, 6.0, -18.0, -192.0, 82.0, -17.0, 16.0, 0.0, -44.0, 0.0, 13.0, 4.0, 80.0, -14.0, 75.0, 122.0, 103.0, -173.0, 51.0, -134.0, -114.0, -82.0, -8.0, 38.0, 14.0, -127.0, -157.0, 0.0, -228.0, -108.0, 0.0, 10.0, -9.0, 4.0, -82.0, 3.0, -33.0, -26.0, -4.0, 37.0, -27.0, 28.0, 92.0, 92.0, 0.0, 5.0, -270.0, 37.0, -1.0, 0.0, -164.0, -156.0, 65.0, 20.0, -278.0, -66.0, -150.0, -82.0, -184.0, -68.0, -2.0, 32.0, -86.0, -219.0, -84.0, 87.0, 54.0, -177.0, 0.0, 20.0, 43.0, 21.0, -108.0, 87.0, 37.0, 13.0, 5.0, -11.0, 0.0, 2.0, 0.0, -132.0, -180.0, -42.0, -4.0, 1.0, -199.0, -152.0, -284.0, -4.0, -54.0, -37.0, 2.0, 0.0, -26.0, -142.0, 33.0, 59.0, 1.0, 109.0, 19.0, -56.0, -136.0, 0.0, 1.0, -270.0, -122.0, 0.0, -35.0, 66.0, -18.0, -139.0, -38.0, 35.0, -4.0, 109.0, -20.0, 0.0, 136.0, 130.0, 99.0, 0.0, 3.0, -212.0, -108.0, 137.0, 36.0, 23.0, 99.0, 113.0, 0.0, -132.0, -282.0, 0.0, 6.0, -218.0, -226.0, -32.0, 0.0, -59.0, 66.0, -82.0, -128.0, -33.0, 42.0, 0.0, 0.0, -66.0, 0.0, 0.0, 3.0, -47.0, -194.0, 194.0, 152.0], "policy_predator_policy_reward": [46.0, 50.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 146.0, 85.0, 0.0, 64.0, 4.0, 28.0, 0.0, 0.0, 31.0, 1.0, 7.0, 0.0, 20.0, 22.0, 92.0, 0.0, 41.0, 54.0, 0.0, 0.0, 58.0, 4.0, 0.0, 0.0, 65.0, 65.0, 2.0, 116.0, 11.0, 0.0, 0.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 8.0, 85.0, 11.0, 35.0, 20.0, 23.0, 0.0, 0.0, 0.0, 26.0, 0.0, 35.0, 0.0, 0.0, 0.0, 44.0, 56.0, 44.0, 59.0, 43.0, 2.0, 3.0, 21.0, 46.0, 92.0, 121.0, 1.0, 0.0, 65.0, 0.0, 42.0, 34.0, 33.0, 0.0, 27.0, 36.0, 27.0, 14.0, 18.0, 0.0, 20.0, 8.0, 0.0, 0.0, 144.0, 35.0, 0.0, 84.0, 3.0, 0.0, 78.0, 139.0, 0.0, 75.0, 12.0, 0.0, 157.0, 60.0, 0.0, 25.0, 59.0, 42.0, 115.0, 3.0, 16.0, 0.0, 91.0, 13.0, 49.0, 10.0, 61.0, 25.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 0.0, 61.0, 86.0, 21.0, 2.0, 47.0, 58.0, 156.0, 1.0, 0.0, 33.0, 65.0, 1.0, 13.0, 0.0, 64.0, 54.0, 0.0, 2.0, 0.0, 1.0, 96.0, 0.0, 0.0, 0.0, 80.0, 164.0, 0.0, 31.0, 42.0, 1.0, 90.0, 67.0, 0.0, 6.0, 20.0, 14.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 128.0, 38.0, 5.0, 17.0, 10.0, 2.0, 13.0, 10.0, 97.0, 81.0, 0.0, 0.0, 127.0, 64.0, 29.0, 0.0, 2.0, 44.0, 50.0, 99.0, 31.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, 3.0, 0.0, 135.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.879641057377127, "mean_inference_ms": 2.742947587319602, "mean_action_processing_ms": 0.3519911422052779, "mean_env_wait_ms": 0.30953654643619805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003847479820251465, "StateBufferConnector_ms": 0.003489255905151367, "ViewRequirementAgentConnector_ms": 0.11307394504547119}, "num_episodes": 22, "episode_return_max": 358.0, "episode_return_min": -279.0, "episode_return_mean": 13.77, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.34339474243217, "num_env_steps_trained_throughput_per_sec": 328.34339474243217, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 13845.726, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13845.661, "sample_time_ms": 1856.185, "learn_time_ms": 11971.668, "learn_throughput": 334.122, "synch_weights_time_ms": 14.797}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "e1352_00002", "date": "2024-08-13_19-22-24", "timestamp": 1723591344, "time_this_iter_s": 12.221426248550415, "time_total_s": 1237.9091293811798, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb7dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1237.9091293811798, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 56.53529411764706, "ram_util_percent": 83.54117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3599131395439149, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 4.2248519074979916, "policy_loss": 0.00018855480196338796, "vf_loss": 4.224360394982434, "vf_explained_var": -0.0005021426412794325, "kl": 0.004039441701188619, "entropy": 1.418105829897381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9934282097433296, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 6.561793158798621, "policy_loss": -0.0022796128625198015, "vf_loss": 6.564065906988881, "vf_explained_var": 0.02911140865119046, "kl": 0.00439281611116359, "entropy": 1.5313299438940784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 356.0, "episode_reward_min": -279.0, "episode_reward_mean": 5.92, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -364.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 182.0}, "policy_reward_mean": {"prey_policy": -31.27, "predator_policy": 34.23}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -14.0, 54.0, -21.0, 13.0, 110.0, 96.0, 225.0, -22.0, -145.0, -45.0, 76.0, -146.0, -106.0, -43.0, 43.0, -11.0, -3.0, 33.0, 42.0, 140.0, 100.0, -121.0, 71.0, -77.0, -13.0, -119.0, -129.0, -109.0, -10.0, 30.0, -146.0, 160.0, -86.0, 125.0, -16.0, 149.0, 24.0, -4.0, 2.0, -165.0, -23.0, -93.0, -279.0, -25.0, 31.0, -13.0, 9.0, 62.0, 129.0, -96.0, 1.0, -148.0, -4.0, 91.0, -20.0, 37.0, 123.0, 136.0, 238.0, 3.0, -154.0, 195.0, 134.0, 136.0, -236.0, 6.0, -253.0, -3.0, 53.0, -61.0, 40.0, 0.0, -33.0, 6.0, -106.0, 356.0, 103.0, -65.0, -13.0, -78.0, -19.0, -5.0, -110.0, -130.0, 133.0, 124.0, 6.0, 215.0, 32.0, 166.0, 24.0, 88.0, 51.0, 16.0, -15.0, -15.0, 53.0, -92.0, -55.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6.0, -18.0, -192.0, 82.0, -17.0, 16.0, 0.0, -44.0, 0.0, 13.0, 4.0, 80.0, -14.0, 75.0, 122.0, 103.0, -173.0, 51.0, -134.0, -114.0, -82.0, -8.0, 38.0, 14.0, -127.0, -157.0, 0.0, -228.0, -108.0, 0.0, 10.0, -9.0, 4.0, -82.0, 3.0, -33.0, -26.0, -4.0, 37.0, -27.0, 28.0, 92.0, 92.0, 0.0, 5.0, -270.0, 37.0, -1.0, 0.0, -164.0, -156.0, 65.0, 20.0, -278.0, -66.0, -150.0, -82.0, -184.0, -68.0, -2.0, 32.0, -86.0, -219.0, -84.0, 87.0, 54.0, -177.0, 0.0, 20.0, 43.0, 21.0, -108.0, 87.0, 37.0, 13.0, 5.0, -11.0, 0.0, 2.0, 0.0, -132.0, -180.0, -42.0, -4.0, 1.0, -199.0, -152.0, -284.0, -4.0, -54.0, -37.0, 2.0, 0.0, -26.0, -142.0, 33.0, 59.0, 1.0, 109.0, 19.0, -56.0, -136.0, 0.0, 1.0, -270.0, -122.0, 0.0, -35.0, 66.0, -18.0, -139.0, -38.0, 35.0, -4.0, 109.0, -20.0, 0.0, 136.0, 130.0, 99.0, 0.0, 3.0, -212.0, -108.0, 137.0, 36.0, 23.0, 99.0, 113.0, 0.0, -132.0, -282.0, 0.0, 6.0, -218.0, -226.0, -32.0, 0.0, -59.0, 66.0, -82.0, -128.0, -33.0, 42.0, 0.0, 0.0, -66.0, 0.0, 0.0, 3.0, -47.0, -194.0, 194.0, 152.0, 103.0, 0.0, -2.0, -126.0, -306.0, 83.0, -364.0, 0.0, -69.0, 0.0, -230.0, 95.0, -162.0, -60.0, -296.0, 18.0, 1.0, 89.0, 67.0, 57.0, -139.0, 42.0, 66.0, 144.0, 12.0, -143.0, 96.0, -33.0, -31.0, -77.0, -8.0, 92.0, 49.0, 0.0, 119.0, -206.0, -26.0, -4.0, 85.0, -248.0, 19.0, -15.0, -178.0, -54.0, -80.0, -90.0], "policy_predator_policy_reward": [1.0, 8.0, 85.0, 11.0, 35.0, 20.0, 23.0, 0.0, 0.0, 0.0, 26.0, 0.0, 35.0, 0.0, 0.0, 0.0, 44.0, 56.0, 44.0, 59.0, 43.0, 2.0, 3.0, 21.0, 46.0, 92.0, 121.0, 1.0, 0.0, 65.0, 0.0, 42.0, 34.0, 33.0, 0.0, 27.0, 36.0, 27.0, 14.0, 18.0, 0.0, 20.0, 8.0, 0.0, 0.0, 144.0, 35.0, 0.0, 84.0, 3.0, 0.0, 78.0, 139.0, 0.0, 75.0, 12.0, 0.0, 157.0, 60.0, 0.0, 25.0, 59.0, 42.0, 115.0, 3.0, 16.0, 0.0, 91.0, 13.0, 49.0, 10.0, 61.0, 25.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 0.0, 61.0, 86.0, 21.0, 2.0, 47.0, 58.0, 156.0, 1.0, 0.0, 33.0, 65.0, 1.0, 13.0, 0.0, 64.0, 54.0, 0.0, 2.0, 0.0, 1.0, 96.0, 0.0, 0.0, 0.0, 80.0, 164.0, 0.0, 31.0, 42.0, 1.0, 90.0, 67.0, 0.0, 6.0, 20.0, 14.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 128.0, 38.0, 5.0, 17.0, 10.0, 2.0, 13.0, 10.0, 97.0, 81.0, 0.0, 0.0, 127.0, 64.0, 29.0, 0.0, 2.0, 44.0, 50.0, 99.0, 31.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, 3.0, 0.0, 135.0, 0.0, 10.0, 0.0, 0.0, 0.0, 63.0, 92.0, 118.0, 182.0, 104.0, 47.0, 3.0, 123.0, 7.0, 112.0, 0.0, 148.0, 0.0, 0.0, 43.0, 0.0, 0.0, 103.0, 0.0, 4.0, 1.0, 64.0, 99.0, 45.0, 58.0, 27.0, 105.0, 0.0, 4.0, 0.0, 2.0, 103.0, 0.0, 15.0, 0.0, 148.0, 0.0, 8.0, 41.0, 84.0, 56.0, 115.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8669108388807927, "mean_inference_ms": 2.7110266584098577, "mean_action_processing_ms": 0.34725993487523377, "mean_env_wait_ms": 0.30632204909622035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004426479339599609, "StateBufferConnector_ms": 0.0038896799087524414, "ViewRequirementAgentConnector_ms": 0.1231762170791626}, "num_episodes": 23, "episode_return_max": 356.0, "episode_return_min": -279.0, "episode_return_mean": 5.92, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.0239139932574, "num_env_steps_trained_throughput_per_sec": 321.0239139932574, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 13889.388, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13889.324, "sample_time_ms": 1813.322, "learn_time_ms": 12057.751, "learn_throughput": 331.737, "synch_weights_time_ms": 15.003}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "e1352_00002", "date": "2024-08-13_19-22-36", "timestamp": 1723591356, "time_this_iter_s": 12.501116037368774, "time_total_s": 1250.4102454185486, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb74c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1250.4102454185486, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 68.03888888888889, "ram_util_percent": 83.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3374468571905579, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 0.00010000000000000003, "total_loss": 2.3103109281529823, "policy_loss": -0.000954967212774569, "vf_loss": 2.3108653418601506, "vf_explained_var": 0.0010739338145684943, "kl": 0.010681335636252965, "entropy": 1.397495925048041, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.09963201740116, "cur_kl_coeff": 0.00078125, "cur_lr": 0.00010000000000000003, "total_loss": 5.596625474899534, "policy_loss": -0.002776607216912366, "vf_loss": 5.599397224093241, "vf_explained_var": 0.07260350342150088, "kl": 0.006214388116501575, "entropy": 1.5157999791796246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 356.0, "episode_reward_min": -279.0, "episode_reward_mean": 11.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -364.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 182.0}, "policy_reward_mean": {"prey_policy": -27.25, "predator_policy": 33.155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.0, 42.0, 140.0, 100.0, -121.0, 71.0, -77.0, -13.0, -119.0, -129.0, -109.0, -10.0, 30.0, -146.0, 160.0, -86.0, 125.0, -16.0, 149.0, 24.0, -4.0, 2.0, -165.0, -23.0, -93.0, -279.0, -25.0, 31.0, -13.0, 9.0, 62.0, 129.0, -96.0, 1.0, -148.0, -4.0, 91.0, -20.0, 37.0, 123.0, 136.0, 238.0, 3.0, -154.0, 195.0, 134.0, 136.0, -236.0, 6.0, -253.0, -3.0, 53.0, -61.0, 40.0, 0.0, -33.0, 6.0, -106.0, 356.0, 103.0, -65.0, -13.0, -78.0, -19.0, -5.0, -110.0, -130.0, 133.0, 124.0, 6.0, 215.0, 32.0, 166.0, 24.0, 88.0, 51.0, 16.0, -15.0, -15.0, 53.0, -92.0, -55.0, 6.0, -5.0, 83.0, -2.0, -23.0, 120.0, -25.0, 151.0, 0.0, 37.0, -48.0, 83.0, -150.0, 213.0, -173.0, 151.0, 105.0, 124.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.0, -4.0, 37.0, -27.0, 28.0, 92.0, 92.0, 0.0, 5.0, -270.0, 37.0, -1.0, 0.0, -164.0, -156.0, 65.0, 20.0, -278.0, -66.0, -150.0, -82.0, -184.0, -68.0, -2.0, 32.0, -86.0, -219.0, -84.0, 87.0, 54.0, -177.0, 0.0, 20.0, 43.0, 21.0, -108.0, 87.0, 37.0, 13.0, 5.0, -11.0, 0.0, 2.0, 0.0, -132.0, -180.0, -42.0, -4.0, 1.0, -199.0, -152.0, -284.0, -4.0, -54.0, -37.0, 2.0, 0.0, -26.0, -142.0, 33.0, 59.0, 1.0, 109.0, 19.0, -56.0, -136.0, 0.0, 1.0, -270.0, -122.0, 0.0, -35.0, 66.0, -18.0, -139.0, -38.0, 35.0, -4.0, 109.0, -20.0, 0.0, 136.0, 130.0, 99.0, 0.0, 3.0, -212.0, -108.0, 137.0, 36.0, 23.0, 99.0, 113.0, 0.0, -132.0, -282.0, 0.0, 6.0, -218.0, -226.0, -32.0, 0.0, -59.0, 66.0, -82.0, -128.0, -33.0, 42.0, 0.0, 0.0, -66.0, 0.0, 0.0, 3.0, -47.0, -194.0, 194.0, 152.0, 103.0, 0.0, -2.0, -126.0, -306.0, 83.0, -364.0, 0.0, -69.0, 0.0, -230.0, 95.0, -162.0, -60.0, -296.0, 18.0, 1.0, 89.0, 67.0, 57.0, -139.0, 42.0, 66.0, 144.0, 12.0, -143.0, 96.0, -33.0, -31.0, -77.0, -8.0, 92.0, 49.0, 0.0, 119.0, -206.0, -26.0, -4.0, 85.0, -248.0, 19.0, -15.0, -178.0, -54.0, -80.0, -90.0, -65.0, 0.0, 11.0, -46.0, 78.0, 5.0, -101.0, -15.0, 5.0, -56.0, 153.0, -73.0, -54.0, 0.0, 83.0, 56.0, 0.0, 0.0, -6.0, 40.0, -174.0, 0.0, 86.0, -6.0, -184.0, -69.0, 104.0, 103.0, -128.0, -192.0, 95.0, 29.0, -46.0, 128.0, 62.0, 62.0], "policy_predator_policy_reward": [36.0, 27.0, 14.0, 18.0, 0.0, 20.0, 8.0, 0.0, 0.0, 144.0, 35.0, 0.0, 84.0, 3.0, 0.0, 78.0, 139.0, 0.0, 75.0, 12.0, 0.0, 157.0, 60.0, 0.0, 25.0, 59.0, 42.0, 115.0, 3.0, 16.0, 0.0, 91.0, 13.0, 49.0, 10.0, 61.0, 25.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 0.0, 61.0, 86.0, 21.0, 2.0, 47.0, 58.0, 156.0, 1.0, 0.0, 33.0, 65.0, 1.0, 13.0, 0.0, 64.0, 54.0, 0.0, 2.0, 0.0, 1.0, 96.0, 0.0, 0.0, 0.0, 80.0, 164.0, 0.0, 31.0, 42.0, 1.0, 90.0, 67.0, 0.0, 6.0, 20.0, 14.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 128.0, 38.0, 5.0, 17.0, 10.0, 2.0, 13.0, 10.0, 97.0, 81.0, 0.0, 0.0, 127.0, 64.0, 29.0, 0.0, 2.0, 44.0, 50.0, 99.0, 31.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, 3.0, 0.0, 135.0, 0.0, 10.0, 0.0, 0.0, 0.0, 63.0, 92.0, 118.0, 182.0, 104.0, 47.0, 3.0, 123.0, 7.0, 112.0, 0.0, 148.0, 0.0, 0.0, 43.0, 0.0, 0.0, 103.0, 0.0, 4.0, 1.0, 64.0, 99.0, 45.0, 58.0, 27.0, 105.0, 0.0, 4.0, 0.0, 2.0, 103.0, 0.0, 15.0, 0.0, 148.0, 0.0, 8.0, 41.0, 84.0, 56.0, 115.0, 0.0, 40.0, 31.0, 25.0, 5.0, 0.0, 0.0, 78.0, 36.0, 0.0, 28.0, 17.0, 23.0, 1.0, 28.0, 12.0, 0.0, 0.0, 0.0, 3.0, 0.0, 72.0, 54.0, 0.0, 3.0, 103.0, 0.0, 6.0, 0.0, 48.0, 99.0, 1.0, 26.0, 23.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8599828624641924, "mean_inference_ms": 2.6909599750392186, "mean_action_processing_ms": 0.3445997204004256, "mean_env_wait_ms": 0.30396636749092365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005029559135437012, "StateBufferConnector_ms": 0.003995180130004883, "ViewRequirementAgentConnector_ms": 0.13422036170959473}, "num_episodes": 18, "episode_return_max": 356.0, "episode_return_min": -279.0, "episode_return_mean": 11.81, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.2001769654429, "num_env_steps_trained_throughput_per_sec": 341.2001769654429, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 13896.601, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13896.542, "sample_time_ms": 1720.145, "learn_time_ms": 12154.189, "learn_throughput": 329.105, "synch_weights_time_ms": 18.919}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "e1352_00002", "date": "2024-08-13_19-22-48", "timestamp": 1723591368, "time_this_iter_s": 11.791565895080566, "time_total_s": 1262.2018113136292, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d203a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1262.2018113136292, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 56.27647058823529, "ram_util_percent": 83.42941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.47825696688717007, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 0.00010000000000000003, "total_loss": 2.8032408985511337, "policy_loss": -0.011628486772890759, "vf_loss": 2.8139128142563754, "vf_explained_var": 0.012887749438563353, "kl": 0.02550859921122138, "entropy": 1.389057132491359, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.911280597363988, "cur_kl_coeff": 0.00078125, "cur_lr": 0.00010000000000000003, "total_loss": 5.762307909304503, "policy_loss": -0.0013711279322191205, "vf_loss": 5.763672484039629, "vf_explained_var": 0.06877125826462235, "kl": 0.008413644155066772, "entropy": 1.5039092416485782, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 356.0, "episode_reward_min": -279.0, "episode_reward_mean": 19.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -364.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 182.0}, "policy_reward_mean": {"prey_policy": -20.805, "predator_policy": 30.485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [149.0, 24.0, -4.0, 2.0, -165.0, -23.0, -93.0, -279.0, -25.0, 31.0, -13.0, 9.0, 62.0, 129.0, -96.0, 1.0, -148.0, -4.0, 91.0, -20.0, 37.0, 123.0, 136.0, 238.0, 3.0, -154.0, 195.0, 134.0, 136.0, -236.0, 6.0, -253.0, -3.0, 53.0, -61.0, 40.0, 0.0, -33.0, 6.0, -106.0, 356.0, 103.0, -65.0, -13.0, -78.0, -19.0, -5.0, -110.0, -130.0, 133.0, 124.0, 6.0, 215.0, 32.0, 166.0, 24.0, 88.0, 51.0, 16.0, -15.0, -15.0, 53.0, -92.0, -55.0, 6.0, -5.0, 83.0, -2.0, -23.0, 120.0, -25.0, 151.0, 0.0, 37.0, -48.0, 83.0, -150.0, 213.0, -173.0, 151.0, 105.0, 124.0, 145.0, 160.0, -34.0, -156.0, 5.0, -5.0, 138.0, 94.0, -73.0, 19.0, -12.0, 8.0, 78.0, 71.0, -54.0, 32.0, 59.0, 155.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [87.0, 37.0, 13.0, 5.0, -11.0, 0.0, 2.0, 0.0, -132.0, -180.0, -42.0, -4.0, 1.0, -199.0, -152.0, -284.0, -4.0, -54.0, -37.0, 2.0, 0.0, -26.0, -142.0, 33.0, 59.0, 1.0, 109.0, 19.0, -56.0, -136.0, 0.0, 1.0, -270.0, -122.0, 0.0, -35.0, 66.0, -18.0, -139.0, -38.0, 35.0, -4.0, 109.0, -20.0, 0.0, 136.0, 130.0, 99.0, 0.0, 3.0, -212.0, -108.0, 137.0, 36.0, 23.0, 99.0, 113.0, 0.0, -132.0, -282.0, 0.0, 6.0, -218.0, -226.0, -32.0, 0.0, -59.0, 66.0, -82.0, -128.0, -33.0, 42.0, 0.0, 0.0, -66.0, 0.0, 0.0, 3.0, -47.0, -194.0, 194.0, 152.0, 103.0, 0.0, -2.0, -126.0, -306.0, 83.0, -364.0, 0.0, -69.0, 0.0, -230.0, 95.0, -162.0, -60.0, -296.0, 18.0, 1.0, 89.0, 67.0, 57.0, -139.0, 42.0, 66.0, 144.0, 12.0, -143.0, 96.0, -33.0, -31.0, -77.0, -8.0, 92.0, 49.0, 0.0, 119.0, -206.0, -26.0, -4.0, 85.0, -248.0, 19.0, -15.0, -178.0, -54.0, -80.0, -90.0, -65.0, 0.0, 11.0, -46.0, 78.0, 5.0, -101.0, -15.0, 5.0, -56.0, 153.0, -73.0, -54.0, 0.0, 83.0, 56.0, 0.0, 0.0, -6.0, 40.0, -174.0, 0.0, 86.0, -6.0, -184.0, -69.0, 104.0, 103.0, -128.0, -192.0, 95.0, 29.0, -46.0, 128.0, 62.0, 62.0, 145.0, 0.0, 110.0, 50.0, -68.0, 0.0, -84.0, -148.0, -107.0, 42.0, -122.0, 56.0, 173.0, -76.0, -48.0, 56.0, -48.0, -160.0, -42.0, 0.0, 0.0, -41.0, -34.0, 0.0, 0.0, 78.0, 57.0, -14.0, 0.0, -117.0, 6.0, 0.0, 29.0, -42.0, 101.0, 18.0], "policy_predator_policy_reward": [25.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 0.0, 61.0, 86.0, 21.0, 2.0, 47.0, 58.0, 156.0, 1.0, 0.0, 33.0, 65.0, 1.0, 13.0, 0.0, 64.0, 54.0, 0.0, 2.0, 0.0, 1.0, 96.0, 0.0, 0.0, 0.0, 80.0, 164.0, 0.0, 31.0, 42.0, 1.0, 90.0, 67.0, 0.0, 6.0, 20.0, 14.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 128.0, 38.0, 5.0, 17.0, 10.0, 2.0, 13.0, 10.0, 97.0, 81.0, 0.0, 0.0, 127.0, 64.0, 29.0, 0.0, 2.0, 44.0, 50.0, 99.0, 31.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, 3.0, 0.0, 135.0, 0.0, 10.0, 0.0, 0.0, 0.0, 63.0, 92.0, 118.0, 182.0, 104.0, 47.0, 3.0, 123.0, 7.0, 112.0, 0.0, 148.0, 0.0, 0.0, 43.0, 0.0, 0.0, 103.0, 0.0, 4.0, 1.0, 64.0, 99.0, 45.0, 58.0, 27.0, 105.0, 0.0, 4.0, 0.0, 2.0, 103.0, 0.0, 15.0, 0.0, 148.0, 0.0, 8.0, 41.0, 84.0, 56.0, 115.0, 0.0, 40.0, 31.0, 25.0, 5.0, 0.0, 0.0, 78.0, 36.0, 0.0, 28.0, 17.0, 23.0, 1.0, 28.0, 12.0, 0.0, 0.0, 0.0, 3.0, 0.0, 72.0, 54.0, 0.0, 3.0, 103.0, 0.0, 6.0, 0.0, 48.0, 99.0, 1.0, 26.0, 23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 10.0, 0.0, 76.0, 56.0, 14.0, 0.0, 61.0, 12.0, 29.0, 15.0, 71.0, 20.0, 115.0, 61.0, 0.0, 5.0, 24.0, 5.0, 37.0, 0.0, 0.0, 13.0, 15.0, 0.0, 63.0, 20.0, 6.0, 21.0, 51.0, 22.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8544890575521628, "mean_inference_ms": 2.6747318978875745, "mean_action_processing_ms": 0.34222405097107367, "mean_env_wait_ms": 0.3020648805474794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049591064453125, "StateBufferConnector_ms": 0.0038979053497314453, "ViewRequirementAgentConnector_ms": 0.15523362159729004}, "num_episodes": 18, "episode_return_max": 356.0, "episode_return_min": -279.0, "episode_return_mean": 19.36, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 242.49200814330203, "num_env_steps_trained_throughput_per_sec": 242.49200814330203, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 14425.139, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14425.067, "sample_time_ms": 1734.791, "learn_time_ms": 12665.599, "learn_throughput": 315.816, "synch_weights_time_ms": 21.057}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "e1352_00002", "date": "2024-08-13_19-23-05", "timestamp": 1723591385, "time_this_iter_s": 16.6107919216156, "time_total_s": 1278.8126032352448, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2cdc820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1278.8126032352448, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 74.14347826086956, "ram_util_percent": 83.93478260869566}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8654899823090071, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 3.6099732082356852, "policy_loss": -0.0008915235384530018, "vf_loss": 3.610060550422265, "vf_explained_var": 0.011500141765705492, "kl": 0.014296537595266771, "entropy": 1.3681998620588314, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.557380778630259, "cur_kl_coeff": 0.00078125, "cur_lr": 0.00010000000000000003, "total_loss": 5.86762818810801, "policy_loss": -6.602088324528523e-05, "vf_loss": 5.867688092731294, "vf_explained_var": 0.02893569343304508, "kl": 0.007828111759781846, "entropy": 1.4731809998315477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 356.0, "episode_reward_min": -253.0, "episode_reward_mean": 31.31, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -364.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 182.0}, "policy_reward_mean": {"prey_policy": -13.725, "predator_policy": 29.38}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.0, -20.0, 37.0, 123.0, 136.0, 238.0, 3.0, -154.0, 195.0, 134.0, 136.0, -236.0, 6.0, -253.0, -3.0, 53.0, -61.0, 40.0, 0.0, -33.0, 6.0, -106.0, 356.0, 103.0, -65.0, -13.0, -78.0, -19.0, -5.0, -110.0, -130.0, 133.0, 124.0, 6.0, 215.0, 32.0, 166.0, 24.0, 88.0, 51.0, 16.0, -15.0, -15.0, 53.0, -92.0, -55.0, 6.0, -5.0, 83.0, -2.0, -23.0, 120.0, -25.0, 151.0, 0.0, 37.0, -48.0, 83.0, -150.0, 213.0, -173.0, 151.0, 105.0, 124.0, 145.0, 160.0, -34.0, -156.0, 5.0, -5.0, 138.0, 94.0, -73.0, 19.0, -12.0, 8.0, 78.0, 71.0, -54.0, 32.0, 59.0, 155.0, 32.0, 41.0, 105.0, -42.0, -17.0, 7.0, -15.0, -14.0, 242.0, -40.0, 112.0, 9.0, 83.0, 20.0, -4.0, 163.0, 101.0, -31.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [66.0, -18.0, -139.0, -38.0, 35.0, -4.0, 109.0, -20.0, 0.0, 136.0, 130.0, 99.0, 0.0, 3.0, -212.0, -108.0, 137.0, 36.0, 23.0, 99.0, 113.0, 0.0, -132.0, -282.0, 0.0, 6.0, -218.0, -226.0, -32.0, 0.0, -59.0, 66.0, -82.0, -128.0, -33.0, 42.0, 0.0, 0.0, -66.0, 0.0, 0.0, 3.0, -47.0, -194.0, 194.0, 152.0, 103.0, 0.0, -2.0, -126.0, -306.0, 83.0, -364.0, 0.0, -69.0, 0.0, -230.0, 95.0, -162.0, -60.0, -296.0, 18.0, 1.0, 89.0, 67.0, 57.0, -139.0, 42.0, 66.0, 144.0, 12.0, -143.0, 96.0, -33.0, -31.0, -77.0, -8.0, 92.0, 49.0, 0.0, 119.0, -206.0, -26.0, -4.0, 85.0, -248.0, 19.0, -15.0, -178.0, -54.0, -80.0, -90.0, -65.0, 0.0, 11.0, -46.0, 78.0, 5.0, -101.0, -15.0, 5.0, -56.0, 153.0, -73.0, -54.0, 0.0, 83.0, 56.0, 0.0, 0.0, -6.0, 40.0, -174.0, 0.0, 86.0, -6.0, -184.0, -69.0, 104.0, 103.0, -128.0, -192.0, 95.0, 29.0, -46.0, 128.0, 62.0, 62.0, 145.0, 0.0, 110.0, 50.0, -68.0, 0.0, -84.0, -148.0, -107.0, 42.0, -122.0, 56.0, 173.0, -76.0, -48.0, 56.0, -48.0, -160.0, -42.0, 0.0, 0.0, -41.0, -34.0, 0.0, 0.0, 78.0, 57.0, -14.0, 0.0, -117.0, 6.0, 0.0, 29.0, -42.0, 101.0, 18.0, 3.0, -8.0, 2.0, -9.0, 23.0, 77.0, -72.0, -108.0, -50.0, 0.0, 2.0, -3.0, -130.0, 43.0, -3.0, -46.0, 98.0, 139.0, -134.0, -17.0, 69.0, 14.0, -27.0, 11.0, 5.0, 36.0, -54.0, 33.0, -14.0, -41.0, 118.0, 45.0, 115.0, -120.0, 0.0, -98.0], "policy_predator_policy_reward": [42.0, 1.0, 90.0, 67.0, 0.0, 6.0, 20.0, 14.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 128.0, 38.0, 5.0, 17.0, 10.0, 2.0, 13.0, 10.0, 97.0, 81.0, 0.0, 0.0, 127.0, 64.0, 29.0, 0.0, 2.0, 44.0, 50.0, 99.0, 31.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, 3.0, 0.0, 135.0, 0.0, 10.0, 0.0, 0.0, 0.0, 63.0, 92.0, 118.0, 182.0, 104.0, 47.0, 3.0, 123.0, 7.0, 112.0, 0.0, 148.0, 0.0, 0.0, 43.0, 0.0, 0.0, 103.0, 0.0, 4.0, 1.0, 64.0, 99.0, 45.0, 58.0, 27.0, 105.0, 0.0, 4.0, 0.0, 2.0, 103.0, 0.0, 15.0, 0.0, 148.0, 0.0, 8.0, 41.0, 84.0, 56.0, 115.0, 0.0, 40.0, 31.0, 25.0, 5.0, 0.0, 0.0, 78.0, 36.0, 0.0, 28.0, 17.0, 23.0, 1.0, 28.0, 12.0, 0.0, 0.0, 0.0, 3.0, 0.0, 72.0, 54.0, 0.0, 3.0, 103.0, 0.0, 6.0, 0.0, 48.0, 99.0, 1.0, 26.0, 23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 10.0, 0.0, 76.0, 56.0, 14.0, 0.0, 61.0, 12.0, 29.0, 15.0, 71.0, 20.0, 115.0, 61.0, 0.0, 5.0, 24.0, 5.0, 37.0, 0.0, 0.0, 13.0, 15.0, 0.0, 63.0, 20.0, 6.0, 21.0, 51.0, 22.0, 14.0, 37.0, 0.0, 0.0, 48.0, 1.0, 4.0, 81.0, 57.0, 6.0, 27.0, 0.0, 8.0, 70.0, 2.0, 5.0, 30.0, 4.0, 1.0, 97.0, 14.0, 0.0, 29.0, 0.0, 25.0, 0.0, 42.0, 5.0, 36.0, 3.0, 48.0, 0.0, 0.0, 30.0, 76.0, 49.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8614345400783101, "mean_inference_ms": 2.702995253367269, "mean_action_processing_ms": 0.3458583907850926, "mean_env_wait_ms": 0.3060307575649186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005119919776916504, "StateBufferConnector_ms": 0.004055023193359375, "ViewRequirementAgentConnector_ms": 0.1706838607788086}, "num_episodes": 18, "episode_return_max": 356.0, "episode_return_min": -253.0, "episode_return_mean": 31.31, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.46099275853692, "num_env_steps_trained_throughput_per_sec": 234.46099275853692, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 12980.854, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12980.776, "sample_time_ms": 2142.751, "learn_time_ms": 10813.075, "learn_throughput": 369.923, "synch_weights_time_ms": 21.017}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "e1352_00002", "date": "2024-08-13_19-23-22", "timestamp": 1723591402, "time_this_iter_s": 17.1282901763916, "time_total_s": 1295.9408934116364, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d20e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1295.9408934116364, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 77.64166666666667, "ram_util_percent": 83.89583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9612324330305296, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 4.801230058972798, "policy_loss": -0.0043019916241367655, "vf_loss": 4.80459555557796, "vf_explained_var": 0.018300283018243376, "kl": 0.016648779383183984, "entropy": 1.317153117644093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.289176855413687, "cur_kl_coeff": 0.00078125, "cur_lr": 0.00010000000000000003, "total_loss": 7.103210375296376, "policy_loss": -0.0010889108441819353, "vf_loss": 7.10429091226487, "vf_explained_var": 0.02003337617904421, "kl": 0.01073400057818093, "entropy": 1.4125236337147062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 312.0, "episode_reward_min": -173.0, "episode_reward_mean": 36.64, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -296.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 173.0, "predator_policy": 152.0}, "policy_reward_mean": {"prey_policy": -12.615, "predator_policy": 30.935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.0, -5.0, -110.0, -130.0, 133.0, 124.0, 6.0, 215.0, 32.0, 166.0, 24.0, 88.0, 51.0, 16.0, -15.0, -15.0, 53.0, -92.0, -55.0, 6.0, -5.0, 83.0, -2.0, -23.0, 120.0, -25.0, 151.0, 0.0, 37.0, -48.0, 83.0, -150.0, 213.0, -173.0, 151.0, 105.0, 124.0, 145.0, 160.0, -34.0, -156.0, 5.0, -5.0, 138.0, 94.0, -73.0, 19.0, -12.0, 8.0, 78.0, 71.0, -54.0, 32.0, 59.0, 155.0, 32.0, 41.0, 105.0, -42.0, -17.0, 7.0, -15.0, -14.0, 242.0, -40.0, 112.0, 9.0, 83.0, 20.0, -4.0, 163.0, 101.0, -31.0, 129.0, 42.0, 111.0, -22.0, 23.0, 0.0, 61.0, 31.0, 68.0, -1.0, -115.0, 186.0, -95.0, 3.0, 99.0, -22.0, 44.0, 312.0, -56.0, 55.0, -24.0, 137.0, 91.0, 33.0, 65.0, 147.0, -134.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-69.0, 0.0, -230.0, 95.0, -162.0, -60.0, -296.0, 18.0, 1.0, 89.0, 67.0, 57.0, -139.0, 42.0, 66.0, 144.0, 12.0, -143.0, 96.0, -33.0, -31.0, -77.0, -8.0, 92.0, 49.0, 0.0, 119.0, -206.0, -26.0, -4.0, 85.0, -248.0, 19.0, -15.0, -178.0, -54.0, -80.0, -90.0, -65.0, 0.0, 11.0, -46.0, 78.0, 5.0, -101.0, -15.0, 5.0, -56.0, 153.0, -73.0, -54.0, 0.0, 83.0, 56.0, 0.0, 0.0, -6.0, 40.0, -174.0, 0.0, 86.0, -6.0, -184.0, -69.0, 104.0, 103.0, -128.0, -192.0, 95.0, 29.0, -46.0, 128.0, 62.0, 62.0, 145.0, 0.0, 110.0, 50.0, -68.0, 0.0, -84.0, -148.0, -107.0, 42.0, -122.0, 56.0, 173.0, -76.0, -48.0, 56.0, -48.0, -160.0, -42.0, 0.0, 0.0, -41.0, -34.0, 0.0, 0.0, 78.0, 57.0, -14.0, 0.0, -117.0, 6.0, 0.0, 29.0, -42.0, 101.0, 18.0, 3.0, -8.0, 2.0, -9.0, 23.0, 77.0, -72.0, -108.0, -50.0, 0.0, 2.0, -3.0, -130.0, 43.0, -3.0, -46.0, 98.0, 139.0, -134.0, -17.0, 69.0, 14.0, -27.0, 11.0, 5.0, 36.0, -54.0, 33.0, -14.0, -41.0, 118.0, 45.0, 115.0, -120.0, 0.0, -98.0, 27.0, 41.0, 94.0, -136.0, 0.0, 73.0, -54.0, -56.0, -33.0, -16.0, -1.0, 0.0, 79.0, -129.0, -27.0, -21.0, 51.0, -52.0, 9.0, -72.0, -271.0, -62.0, 153.0, -14.0, -275.0, 0.0, 0.0, 3.0, 0.0, 53.0, -15.0, -101.0, 48.0, -98.0, 138.0, 143.0, -111.0, -68.0, 1.0, 14.0, 76.0, -272.0, 9.0, 110.0, 101.0, -75.0, -91.0, 25.0, 28.0, -14.0, -36.0, 96.0, -77.0, -174.0], "policy_predator_policy_reward": [47.0, 3.0, 123.0, 7.0, 112.0, 0.0, 148.0, 0.0, 0.0, 43.0, 0.0, 0.0, 103.0, 0.0, 4.0, 1.0, 64.0, 99.0, 45.0, 58.0, 27.0, 105.0, 0.0, 4.0, 0.0, 2.0, 103.0, 0.0, 15.0, 0.0, 148.0, 0.0, 8.0, 41.0, 84.0, 56.0, 115.0, 0.0, 40.0, 31.0, 25.0, 5.0, 0.0, 0.0, 78.0, 36.0, 0.0, 28.0, 17.0, 23.0, 1.0, 28.0, 12.0, 0.0, 0.0, 0.0, 3.0, 0.0, 72.0, 54.0, 0.0, 3.0, 103.0, 0.0, 6.0, 0.0, 48.0, 99.0, 1.0, 26.0, 23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 10.0, 0.0, 76.0, 56.0, 14.0, 0.0, 61.0, 12.0, 29.0, 15.0, 71.0, 20.0, 115.0, 61.0, 0.0, 5.0, 24.0, 5.0, 37.0, 0.0, 0.0, 13.0, 15.0, 0.0, 63.0, 20.0, 6.0, 21.0, 51.0, 22.0, 14.0, 37.0, 0.0, 0.0, 48.0, 1.0, 4.0, 81.0, 57.0, 6.0, 27.0, 0.0, 8.0, 70.0, 2.0, 5.0, 30.0, 4.0, 1.0, 97.0, 14.0, 0.0, 29.0, 0.0, 25.0, 0.0, 42.0, 5.0, 36.0, 3.0, 48.0, 0.0, 0.0, 30.0, 76.0, 49.0, 18.0, 31.0, 30.0, 84.0, 0.0, 0.0, 38.0, 52.0, 36.0, 39.0, 33.0, 1.0, 0.0, 111.0, 0.0, 66.0, 13.0, 67.0, 2.0, 46.0, 16.0, 152.0, 66.0, 16.0, 31.0, 71.0, 109.0, 0.0, 0.0, 8.0, 38.0, 94.0, 0.0, 94.0, 0.0, 14.0, 17.0, 39.0, 84.0, 6.0, 34.0, 136.0, 36.0, 18.0, 0.0, 1.0, 64.0, 99.0, 0.0, 23.0, 28.0, 16.0, 71.0, 0.0, 117.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733054836223377, "mean_inference_ms": 2.7563758703235193, "mean_action_processing_ms": 0.35183970005710136, "mean_env_wait_ms": 0.3131462248283313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00784146785736084, "StateBufferConnector_ms": 0.004193663597106934, "ViewRequirementAgentConnector_ms": 0.18847060203552246}, "num_episodes": 27, "episode_return_max": 312.0, "episode_return_min": -173.0, "episode_return_mean": 36.64, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.61042544056755, "num_env_steps_trained_throughput_per_sec": 314.61042544056755, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 13052.822, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13052.744, "sample_time_ms": 2122.23, "learn_time_ms": 10905.403, "learn_throughput": 366.791, "synch_weights_time_ms": 21.12}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "e1352_00002", "date": "2024-08-13_19-23-35", "timestamp": 1723591415, "time_this_iter_s": 12.777400970458984, "time_total_s": 1308.7182943820953, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb34c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1308.7182943820953, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 65.79444444444444, "ram_util_percent": 83.72777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8150469685751925, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 3.5206489786269173, "policy_loss": -0.006097838400848328, "vf_loss": 3.525475469594279, "vf_explained_var": 0.025863829460093583, "kl": 0.02260168734270099, "entropy": 1.3549330163885045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.116225571346977, "cur_kl_coeff": 0.00078125, "cur_lr": 0.00010000000000000003, "total_loss": 6.126972284014263, "policy_loss": -0.0028814076356067464, "vf_loss": 6.129844811101439, "vf_explained_var": 0.03266096950838805, "kl": 0.011358478014743573, "entropy": 1.3971663785359216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 312.0, "episode_reward_min": -173.0, "episode_reward_mean": 43.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -275.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 173.0, "predator_policy": 152.0}, "policy_reward_mean": {"prey_policy": -7.29, "predator_policy": 28.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-55.0, 6.0, -5.0, 83.0, -2.0, -23.0, 120.0, -25.0, 151.0, 0.0, 37.0, -48.0, 83.0, -150.0, 213.0, -173.0, 151.0, 105.0, 124.0, 145.0, 160.0, -34.0, -156.0, 5.0, -5.0, 138.0, 94.0, -73.0, 19.0, -12.0, 8.0, 78.0, 71.0, -54.0, 32.0, 59.0, 155.0, 32.0, 41.0, 105.0, -42.0, -17.0, 7.0, -15.0, -14.0, 242.0, -40.0, 112.0, 9.0, 83.0, 20.0, -4.0, 163.0, 101.0, -31.0, 129.0, 42.0, 111.0, -22.0, 23.0, 0.0, 61.0, 31.0, 68.0, -1.0, -115.0, 186.0, -95.0, 3.0, 99.0, -22.0, 44.0, 312.0, -56.0, 55.0, -24.0, 137.0, 91.0, 33.0, 65.0, 147.0, -134.0, -54.0, -3.0, 109.0, 210.0, 56.0, 97.0, 96.0, 244.0, 114.0, -16.0, 65.0, 26.0, 130.0, 86.0, -96.0, 154.0, -52.0, 24.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-80.0, -90.0, -65.0, 0.0, 11.0, -46.0, 78.0, 5.0, -101.0, -15.0, 5.0, -56.0, 153.0, -73.0, -54.0, 0.0, 83.0, 56.0, 0.0, 0.0, -6.0, 40.0, -174.0, 0.0, 86.0, -6.0, -184.0, -69.0, 104.0, 103.0, -128.0, -192.0, 95.0, 29.0, -46.0, 128.0, 62.0, 62.0, 145.0, 0.0, 110.0, 50.0, -68.0, 0.0, -84.0, -148.0, -107.0, 42.0, -122.0, 56.0, 173.0, -76.0, -48.0, 56.0, -48.0, -160.0, -42.0, 0.0, 0.0, -41.0, -34.0, 0.0, 0.0, 78.0, 57.0, -14.0, 0.0, -117.0, 6.0, 0.0, 29.0, -42.0, 101.0, 18.0, 3.0, -8.0, 2.0, -9.0, 23.0, 77.0, -72.0, -108.0, -50.0, 0.0, 2.0, -3.0, -130.0, 43.0, -3.0, -46.0, 98.0, 139.0, -134.0, -17.0, 69.0, 14.0, -27.0, 11.0, 5.0, 36.0, -54.0, 33.0, -14.0, -41.0, 118.0, 45.0, 115.0, -120.0, 0.0, -98.0, 27.0, 41.0, 94.0, -136.0, 0.0, 73.0, -54.0, -56.0, -33.0, -16.0, -1.0, 0.0, 79.0, -129.0, -27.0, -21.0, 51.0, -52.0, 9.0, -72.0, -271.0, -62.0, 153.0, -14.0, -275.0, 0.0, 0.0, 3.0, 0.0, 53.0, -15.0, -101.0, 48.0, -98.0, 138.0, 143.0, -111.0, -68.0, 1.0, 14.0, 76.0, -272.0, 9.0, 110.0, 101.0, -75.0, -91.0, 25.0, 28.0, -14.0, -36.0, 96.0, -77.0, -174.0, 8.0, -200.0, 56.0, -226.0, 0.0, 109.0, 171.0, 4.0, -4.0, -70.0, -38.0, 91.0, 166.0, -181.0, 128.0, 92.0, 95.0, 0.0, 0.0, -67.0, -24.0, 42.0, -4.0, 0.0, -7.0, 70.0, 65.0, 21.0, -58.0, -140.0, 134.0, 12.0, 0.0, -132.0, 24.0, 0.0], "policy_predator_policy_reward": [115.0, 0.0, 40.0, 31.0, 25.0, 5.0, 0.0, 0.0, 78.0, 36.0, 0.0, 28.0, 17.0, 23.0, 1.0, 28.0, 12.0, 0.0, 0.0, 0.0, 3.0, 0.0, 72.0, 54.0, 0.0, 3.0, 103.0, 0.0, 6.0, 0.0, 48.0, 99.0, 1.0, 26.0, 23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 10.0, 0.0, 76.0, 56.0, 14.0, 0.0, 61.0, 12.0, 29.0, 15.0, 71.0, 20.0, 115.0, 61.0, 0.0, 5.0, 24.0, 5.0, 37.0, 0.0, 0.0, 13.0, 15.0, 0.0, 63.0, 20.0, 6.0, 21.0, 51.0, 22.0, 14.0, 37.0, 0.0, 0.0, 48.0, 1.0, 4.0, 81.0, 57.0, 6.0, 27.0, 0.0, 8.0, 70.0, 2.0, 5.0, 30.0, 4.0, 1.0, 97.0, 14.0, 0.0, 29.0, 0.0, 25.0, 0.0, 42.0, 5.0, 36.0, 3.0, 48.0, 0.0, 0.0, 30.0, 76.0, 49.0, 18.0, 31.0, 30.0, 84.0, 0.0, 0.0, 38.0, 52.0, 36.0, 39.0, 33.0, 1.0, 0.0, 111.0, 0.0, 66.0, 13.0, 67.0, 2.0, 46.0, 16.0, 152.0, 66.0, 16.0, 31.0, 71.0, 109.0, 0.0, 0.0, 8.0, 38.0, 94.0, 0.0, 94.0, 0.0, 14.0, 17.0, 39.0, 84.0, 6.0, 34.0, 136.0, 36.0, 18.0, 0.0, 1.0, 64.0, 99.0, 0.0, 23.0, 28.0, 16.0, 71.0, 0.0, 117.0, 26.0, 112.0, 134.0, 33.0, 0.0, 0.0, 23.0, 12.0, 90.0, 40.0, 33.0, 11.0, 0.0, 111.0, 24.0, 0.0, 19.0, 0.0, 19.0, 32.0, 12.0, 35.0, 0.0, 30.0, 50.0, 17.0, 0.0, 0.0, 102.0, 0.0, 8.0, 0.0, 69.0, 11.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8846697073486358, "mean_inference_ms": 2.790794872078678, "mean_action_processing_ms": 0.35679480596573643, "mean_env_wait_ms": 0.31817911328414916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007760882377624512, "StateBufferConnector_ms": 0.004304051399230957, "ViewRequirementAgentConnector_ms": 0.18830537796020508}, "num_episodes": 18, "episode_return_max": 312.0, "episode_return_min": -173.0, "episode_return_mean": 43.32, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.25529273643664, "num_env_steps_trained_throughput_per_sec": 215.25529273643664, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 13713.911, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13713.832, "sample_time_ms": 2171.917, "learn_time_ms": 11516.832, "learn_throughput": 347.318, "synch_weights_time_ms": 21.019}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "e1352_00002", "date": "2024-08-13_19-23-54", "timestamp": 1723591434, "time_this_iter_s": 18.62193989753723, "time_total_s": 1327.3402342796326, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32d6bfb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1327.3402342796326, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 90.18076923076923, "ram_util_percent": 83.9076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6539289024338205, "cur_kl_coeff": 0.084375, "cur_lr": 0.00010000000000000003, "total_loss": 5.061857711701166, "policy_loss": -0.008818827764372582, "vf_loss": 5.068656686121825, "vf_explained_var": 0.006069017718077967, "kl": 0.023938906403926798, "entropy": 1.2942721038268357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6225105667871143, "cur_kl_coeff": 0.00078125, "cur_lr": 0.00010000000000000003, "total_loss": 6.3093354411856835, "policy_loss": -0.0006440851645218948, "vf_loss": 6.309976049958083, "vf_explained_var": 0.013909849035676825, "kl": 0.004464614509206789, "entropy": 1.449213479687928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 312.0, "episode_reward_min": -160.0, "episode_reward_mean": 44.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -275.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 152.0}, "policy_reward_mean": {"prey_policy": -9.49, "predator_policy": 31.915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [124.0, 145.0, 160.0, -34.0, -156.0, 5.0, -5.0, 138.0, 94.0, -73.0, 19.0, -12.0, 8.0, 78.0, 71.0, -54.0, 32.0, 59.0, 155.0, 32.0, 41.0, 105.0, -42.0, -17.0, 7.0, -15.0, -14.0, 242.0, -40.0, 112.0, 9.0, 83.0, 20.0, -4.0, 163.0, 101.0, -31.0, 129.0, 42.0, 111.0, -22.0, 23.0, 0.0, 61.0, 31.0, 68.0, -1.0, -115.0, 186.0, -95.0, 3.0, 99.0, -22.0, 44.0, 312.0, -56.0, 55.0, -24.0, 137.0, 91.0, 33.0, 65.0, 147.0, -134.0, -54.0, -3.0, 109.0, 210.0, 56.0, 97.0, 96.0, 244.0, 114.0, -16.0, 65.0, 26.0, 130.0, 86.0, -96.0, 154.0, -52.0, 24.0, 27.0, -65.0, 118.0, 12.0, -3.0, -160.0, 44.0, -92.0, 118.0, 8.0, -123.0, 98.0, 111.0, -55.0, 174.0, 209.0, 66.0, 134.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [62.0, 62.0, 145.0, 0.0, 110.0, 50.0, -68.0, 0.0, -84.0, -148.0, -107.0, 42.0, -122.0, 56.0, 173.0, -76.0, -48.0, 56.0, -48.0, -160.0, -42.0, 0.0, 0.0, -41.0, -34.0, 0.0, 0.0, 78.0, 57.0, -14.0, 0.0, -117.0, 6.0, 0.0, 29.0, -42.0, 101.0, 18.0, 3.0, -8.0, 2.0, -9.0, 23.0, 77.0, -72.0, -108.0, -50.0, 0.0, 2.0, -3.0, -130.0, 43.0, -3.0, -46.0, 98.0, 139.0, -134.0, -17.0, 69.0, 14.0, -27.0, 11.0, 5.0, 36.0, -54.0, 33.0, -14.0, -41.0, 118.0, 45.0, 115.0, -120.0, 0.0, -98.0, 27.0, 41.0, 94.0, -136.0, 0.0, 73.0, -54.0, -56.0, -33.0, -16.0, -1.0, 0.0, 79.0, -129.0, -27.0, -21.0, 51.0, -52.0, 9.0, -72.0, -271.0, -62.0, 153.0, -14.0, -275.0, 0.0, 0.0, 3.0, 0.0, 53.0, -15.0, -101.0, 48.0, -98.0, 138.0, 143.0, -111.0, -68.0, 1.0, 14.0, 76.0, -272.0, 9.0, 110.0, 101.0, -75.0, -91.0, 25.0, 28.0, -14.0, -36.0, 96.0, -77.0, -174.0, 8.0, -200.0, 56.0, -226.0, 0.0, 109.0, 171.0, 4.0, -4.0, -70.0, -38.0, 91.0, 166.0, -181.0, 128.0, 92.0, 95.0, 0.0, 0.0, -67.0, -24.0, 42.0, -4.0, 0.0, -7.0, 70.0, 65.0, 21.0, -58.0, -140.0, 134.0, 12.0, 0.0, -132.0, 24.0, 0.0, 0.0, -76.0, -24.0, -106.0, 83.0, 35.0, 0.0, -103.0, -34.0, 14.0, -90.0, -247.0, 0.0, 33.0, -146.0, -148.0, 200.0, -214.0, -79.0, 0.0, -118.0, -187.0, -156.0, 176.0, 0.0, 67.0, -108.0, -2.0, 155.0, -6.0, 87.0, 86.0, -44.0, 44.0, 108.0, -49.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 10.0, 0.0, 76.0, 56.0, 14.0, 0.0, 61.0, 12.0, 29.0, 15.0, 71.0, 20.0, 115.0, 61.0, 0.0, 5.0, 24.0, 5.0, 37.0, 0.0, 0.0, 13.0, 15.0, 0.0, 63.0, 20.0, 6.0, 21.0, 51.0, 22.0, 14.0, 37.0, 0.0, 0.0, 48.0, 1.0, 4.0, 81.0, 57.0, 6.0, 27.0, 0.0, 8.0, 70.0, 2.0, 5.0, 30.0, 4.0, 1.0, 97.0, 14.0, 0.0, 29.0, 0.0, 25.0, 0.0, 42.0, 5.0, 36.0, 3.0, 48.0, 0.0, 0.0, 30.0, 76.0, 49.0, 18.0, 31.0, 30.0, 84.0, 0.0, 0.0, 38.0, 52.0, 36.0, 39.0, 33.0, 1.0, 0.0, 111.0, 0.0, 66.0, 13.0, 67.0, 2.0, 46.0, 16.0, 152.0, 66.0, 16.0, 31.0, 71.0, 109.0, 0.0, 0.0, 8.0, 38.0, 94.0, 0.0, 94.0, 0.0, 14.0, 17.0, 39.0, 84.0, 6.0, 34.0, 136.0, 36.0, 18.0, 0.0, 1.0, 64.0, 99.0, 0.0, 23.0, 28.0, 16.0, 71.0, 0.0, 117.0, 26.0, 112.0, 134.0, 33.0, 0.0, 0.0, 23.0, 12.0, 90.0, 40.0, 33.0, 11.0, 0.0, 111.0, 24.0, 0.0, 19.0, 0.0, 19.0, 32.0, 12.0, 35.0, 0.0, 30.0, 50.0, 17.0, 0.0, 0.0, 102.0, 0.0, 8.0, 0.0, 69.0, 11.0, 0.0, 0.0, 13.0, 90.0, 6.0, 59.0, 0.0, 0.0, 70.0, 45.0, 0.0, 17.0, 45.0, 132.0, 3.0, 8.0, 106.0, 96.0, 132.0, 0.0, 39.0, 48.0, 55.0, 127.0, 0.0, 78.0, 44.0, 0.0, 0.0, 55.0, 0.0, 25.0, 24.0, 12.0, 30.0, 36.0, 75.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8948288705154774, "mean_inference_ms": 2.826517252593286, "mean_action_processing_ms": 0.3938500280110743, "mean_env_wait_ms": 0.32323447680515294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00765228271484375, "StateBufferConnector_ms": 0.004266142845153809, "ViewRequirementAgentConnector_ms": 0.17941486835479736}, "num_episodes": 18, "episode_return_max": 312.0, "episode_return_min": -160.0, "episode_return_mean": 44.85, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.64097224037565, "num_env_steps_trained_throughput_per_sec": 247.64097224037565, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 14115.032, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14114.953, "sample_time_ms": 2414.072, "learn_time_ms": 11675.795, "learn_throughput": 342.589, "synch_weights_time_ms": 20.64}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "e1352_00002", "date": "2024-08-13_19-24-10", "timestamp": 1723591450, "time_this_iter_s": 16.214452981948853, "time_total_s": 1343.5546872615814, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb59d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1343.5546872615814, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 66.07499999999999, "ram_util_percent": 83.60833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4859677514228871, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 0.00010000000000000003, "total_loss": 4.84450270700707, "policy_loss": 0.0006288907483279232, "vf_loss": 4.843516578371562, "vf_explained_var": 0.0037765136471501104, "kl": 0.002822750899651517, "entropy": 1.29249352923146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.320570210292541, "cur_kl_coeff": 0.000390625, "cur_lr": 0.00010000000000000003, "total_loss": 8.60550865016917, "policy_loss": -0.0013994479854960763, "vf_loss": 8.606899872028007, "vf_explained_var": 0.0718811447658236, "kl": 0.021068297974149205, "entropy": 1.3802730138970432, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 312.0, "episode_reward_min": -211.0, "episode_reward_mean": 44.11, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -275.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 152.0}, "policy_reward_mean": {"prey_policy": -13.57, "predator_policy": 35.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.0, 32.0, 41.0, 105.0, -42.0, -17.0, 7.0, -15.0, -14.0, 242.0, -40.0, 112.0, 9.0, 83.0, 20.0, -4.0, 163.0, 101.0, -31.0, 129.0, 42.0, 111.0, -22.0, 23.0, 0.0, 61.0, 31.0, 68.0, -1.0, -115.0, 186.0, -95.0, 3.0, 99.0, -22.0, 44.0, 312.0, -56.0, 55.0, -24.0, 137.0, 91.0, 33.0, 65.0, 147.0, -134.0, -54.0, -3.0, 109.0, 210.0, 56.0, 97.0, 96.0, 244.0, 114.0, -16.0, 65.0, 26.0, 130.0, 86.0, -96.0, 154.0, -52.0, 24.0, 27.0, -65.0, 118.0, 12.0, -3.0, -160.0, 44.0, -92.0, 118.0, 8.0, -123.0, 98.0, 111.0, -55.0, 174.0, 209.0, 66.0, 134.0, 47.0, 198.0, -15.0, -12.0, -183.0, 216.0, -116.0, 88.0, -116.0, 137.0, -81.0, 100.0, 263.0, 172.0, 36.0, -24.0, -211.0, 26.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [101.0, 18.0, 3.0, -8.0, 2.0, -9.0, 23.0, 77.0, -72.0, -108.0, -50.0, 0.0, 2.0, -3.0, -130.0, 43.0, -3.0, -46.0, 98.0, 139.0, -134.0, -17.0, 69.0, 14.0, -27.0, 11.0, 5.0, 36.0, -54.0, 33.0, -14.0, -41.0, 118.0, 45.0, 115.0, -120.0, 0.0, -98.0, 27.0, 41.0, 94.0, -136.0, 0.0, 73.0, -54.0, -56.0, -33.0, -16.0, -1.0, 0.0, 79.0, -129.0, -27.0, -21.0, 51.0, -52.0, 9.0, -72.0, -271.0, -62.0, 153.0, -14.0, -275.0, 0.0, 0.0, 3.0, 0.0, 53.0, -15.0, -101.0, 48.0, -98.0, 138.0, 143.0, -111.0, -68.0, 1.0, 14.0, 76.0, -272.0, 9.0, 110.0, 101.0, -75.0, -91.0, 25.0, 28.0, -14.0, -36.0, 96.0, -77.0, -174.0, 8.0, -200.0, 56.0, -226.0, 0.0, 109.0, 171.0, 4.0, -4.0, -70.0, -38.0, 91.0, 166.0, -181.0, 128.0, 92.0, 95.0, 0.0, 0.0, -67.0, -24.0, 42.0, -4.0, 0.0, -7.0, 70.0, 65.0, 21.0, -58.0, -140.0, 134.0, 12.0, 0.0, -132.0, 24.0, 0.0, 0.0, -76.0, -24.0, -106.0, 83.0, 35.0, 0.0, -103.0, -34.0, 14.0, -90.0, -247.0, 0.0, 33.0, -146.0, -148.0, 200.0, -214.0, -79.0, 0.0, -118.0, -187.0, -156.0, 176.0, 0.0, 67.0, -108.0, -2.0, 155.0, -6.0, 87.0, 86.0, -44.0, 44.0, 108.0, -49.0, -52.0, 64.0, 167.0, -28.0, -11.0, -129.0, 100.0, -245.0, -167.0, -168.0, 142.0, 54.0, -238.0, -44.0, 52.0, -16.0, -112.0, -62.0, 173.0, -82.0, -8.0, -214.0, 121.0, -42.0, 103.0, 122.0, 16.0, 102.0, -37.0, -10.0, 12.0, -229.0, -138.0, -146.0, 143.0, -234.0], "policy_predator_policy_reward": [22.0, 14.0, 37.0, 0.0, 0.0, 48.0, 1.0, 4.0, 81.0, 57.0, 6.0, 27.0, 0.0, 8.0, 70.0, 2.0, 5.0, 30.0, 4.0, 1.0, 97.0, 14.0, 0.0, 29.0, 0.0, 25.0, 0.0, 42.0, 5.0, 36.0, 3.0, 48.0, 0.0, 0.0, 30.0, 76.0, 49.0, 18.0, 31.0, 30.0, 84.0, 0.0, 0.0, 38.0, 52.0, 36.0, 39.0, 33.0, 1.0, 0.0, 111.0, 0.0, 66.0, 13.0, 67.0, 2.0, 46.0, 16.0, 152.0, 66.0, 16.0, 31.0, 71.0, 109.0, 0.0, 0.0, 8.0, 38.0, 94.0, 0.0, 94.0, 0.0, 14.0, 17.0, 39.0, 84.0, 6.0, 34.0, 136.0, 36.0, 18.0, 0.0, 1.0, 64.0, 99.0, 0.0, 23.0, 28.0, 16.0, 71.0, 0.0, 117.0, 26.0, 112.0, 134.0, 33.0, 0.0, 0.0, 23.0, 12.0, 90.0, 40.0, 33.0, 11.0, 0.0, 111.0, 24.0, 0.0, 19.0, 0.0, 19.0, 32.0, 12.0, 35.0, 0.0, 30.0, 50.0, 17.0, 0.0, 0.0, 102.0, 0.0, 8.0, 0.0, 69.0, 11.0, 0.0, 0.0, 13.0, 90.0, 6.0, 59.0, 0.0, 0.0, 70.0, 45.0, 0.0, 17.0, 45.0, 132.0, 3.0, 8.0, 106.0, 96.0, 132.0, 0.0, 39.0, 48.0, 55.0, 127.0, 0.0, 78.0, 44.0, 0.0, 0.0, 55.0, 0.0, 25.0, 24.0, 12.0, 30.0, 36.0, 75.0, 0.0, 26.0, 9.0, 55.0, 4.0, 10.0, 115.0, 21.0, 112.0, 32.0, 120.0, 0.0, 20.0, 50.0, 116.0, 17.0, 35.0, 46.0, 12.0, 44.0, 2.0, 85.0, 56.0, 21.0, 0.0, 2.0, 36.0, 31.0, 23.0, 78.0, 5.0, 95.0, 98.0, 73.0, 0.0, 117.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9045466968029098, "mean_inference_ms": 2.8601852135590504, "mean_action_processing_ms": 0.4296207344786401, "mean_env_wait_ms": 0.3280020498003288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008940696716308594, "StateBufferConnector_ms": 0.0045462846755981445, "ViewRequirementAgentConnector_ms": 0.15639090538024902}, "num_episodes": 18, "episode_return_max": 312.0, "episode_return_min": -211.0, "episode_return_mean": 44.11, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.5895929502268, "num_env_steps_trained_throughput_per_sec": 327.5895929502268, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 14154.263, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14154.184, "sample_time_ms": 2424.846, "learn_time_ms": 11704.427, "learn_throughput": 341.751, "synch_weights_time_ms": 20.539}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "e1352_00002", "date": "2024-08-13_19-24-22", "timestamp": 1723591462, "time_this_iter_s": 12.286274671554565, "time_total_s": 1355.840961933136, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb34c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1355.840961933136, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 62.77058823529411, "ram_util_percent": 83.3235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.41249470977437874, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.00010000000000000003, "total_loss": 2.6064404661693272, "policy_loss": -0.0017442325744827195, "vf_loss": 2.6079472702016275, "vf_explained_var": -0.00016778363752617407, "kl": 0.0037519609632113943, "entropy": 1.2697051135320512, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.982721146625816, "cur_kl_coeff": 0.0005859374999999999, "cur_lr": 0.00010000000000000003, "total_loss": 7.218504963728486, "policy_loss": -0.004119684948418388, "vf_loss": 7.222612539927165, "vf_explained_var": 0.09752092380372304, "kl": 0.020722908988637326, "entropy": 1.3591973999189952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 335.0, "episode_reward_min": -223.0, "episode_reward_mean": 52.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -426.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 259.0}, "policy_reward_mean": {"prey_policy": -13.89, "predator_policy": 40.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.0, 23.0, 0.0, 61.0, 31.0, 68.0, -1.0, -115.0, 186.0, -95.0, 3.0, 99.0, -22.0, 44.0, 312.0, -56.0, 55.0, -24.0, 137.0, 91.0, 33.0, 65.0, 147.0, -134.0, -54.0, -3.0, 109.0, 210.0, 56.0, 97.0, 96.0, 244.0, 114.0, -16.0, 65.0, 26.0, 130.0, 86.0, -96.0, 154.0, -52.0, 24.0, 27.0, -65.0, 118.0, 12.0, -3.0, -160.0, 44.0, -92.0, 118.0, 8.0, -123.0, 98.0, 111.0, -55.0, 174.0, 209.0, 66.0, 134.0, 47.0, 198.0, -15.0, -12.0, -183.0, 216.0, -116.0, 88.0, -116.0, 137.0, -81.0, 100.0, 263.0, 172.0, 36.0, -24.0, -211.0, 26.0, 75.0, 25.0, -73.0, 0.0, 57.0, 217.0, 214.0, 183.0, -223.0, -92.0, 146.0, 277.0, -35.0, 220.0, 335.0, 0.0, 68.0, -33.0, 211.0, 193.0, 86.0, 159.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-54.0, -56.0, -33.0, -16.0, -1.0, 0.0, 79.0, -129.0, -27.0, -21.0, 51.0, -52.0, 9.0, -72.0, -271.0, -62.0, 153.0, -14.0, -275.0, 0.0, 0.0, 3.0, 0.0, 53.0, -15.0, -101.0, 48.0, -98.0, 138.0, 143.0, -111.0, -68.0, 1.0, 14.0, 76.0, -272.0, 9.0, 110.0, 101.0, -75.0, -91.0, 25.0, 28.0, -14.0, -36.0, 96.0, -77.0, -174.0, 8.0, -200.0, 56.0, -226.0, 0.0, 109.0, 171.0, 4.0, -4.0, -70.0, -38.0, 91.0, 166.0, -181.0, 128.0, 92.0, 95.0, 0.0, 0.0, -67.0, -24.0, 42.0, -4.0, 0.0, -7.0, 70.0, 65.0, 21.0, -58.0, -140.0, 134.0, 12.0, 0.0, -132.0, 24.0, 0.0, 0.0, -76.0, -24.0, -106.0, 83.0, 35.0, 0.0, -103.0, -34.0, 14.0, -90.0, -247.0, 0.0, 33.0, -146.0, -148.0, 200.0, -214.0, -79.0, 0.0, -118.0, -187.0, -156.0, 176.0, 0.0, 67.0, -108.0, -2.0, 155.0, -6.0, 87.0, 86.0, -44.0, 44.0, 108.0, -49.0, -52.0, 64.0, 167.0, -28.0, -11.0, -129.0, 100.0, -245.0, -167.0, -168.0, 142.0, 54.0, -238.0, -44.0, 52.0, -16.0, -112.0, -62.0, 173.0, -82.0, -8.0, -214.0, 121.0, -42.0, 103.0, 122.0, 16.0, 102.0, -37.0, -10.0, 12.0, -229.0, -138.0, -146.0, 143.0, -234.0, -58.0, 104.0, 154.0, -258.0, -354.0, 104.0, 0.0, 0.0, 141.0, -180.0, 24.0, 192.0, -95.0, 161.0, 28.0, 155.0, -210.0, -155.0, -261.0, -16.0, 0.0, 122.0, 121.0, 156.0, 112.0, -294.0, 145.0, 75.0, 180.0, 154.0, 0.0, 0.0, 124.0, -300.0, 55.0, -176.0, 123.0, 81.0, 94.0, 48.0, 17.0, -24.0, 190.0, -426.0], "policy_predator_policy_reward": [52.0, 36.0, 39.0, 33.0, 1.0, 0.0, 111.0, 0.0, 66.0, 13.0, 67.0, 2.0, 46.0, 16.0, 152.0, 66.0, 16.0, 31.0, 71.0, 109.0, 0.0, 0.0, 8.0, 38.0, 94.0, 0.0, 94.0, 0.0, 14.0, 17.0, 39.0, 84.0, 6.0, 34.0, 136.0, 36.0, 18.0, 0.0, 1.0, 64.0, 99.0, 0.0, 23.0, 28.0, 16.0, 71.0, 0.0, 117.0, 26.0, 112.0, 134.0, 33.0, 0.0, 0.0, 23.0, 12.0, 90.0, 40.0, 33.0, 11.0, 0.0, 111.0, 24.0, 0.0, 19.0, 0.0, 19.0, 32.0, 12.0, 35.0, 0.0, 30.0, 50.0, 17.0, 0.0, 0.0, 102.0, 0.0, 8.0, 0.0, 69.0, 11.0, 0.0, 0.0, 13.0, 90.0, 6.0, 59.0, 0.0, 0.0, 70.0, 45.0, 0.0, 17.0, 45.0, 132.0, 3.0, 8.0, 106.0, 96.0, 132.0, 0.0, 39.0, 48.0, 55.0, 127.0, 0.0, 78.0, 44.0, 0.0, 0.0, 55.0, 0.0, 25.0, 24.0, 12.0, 30.0, 36.0, 75.0, 0.0, 26.0, 9.0, 55.0, 4.0, 10.0, 115.0, 21.0, 112.0, 32.0, 120.0, 0.0, 20.0, 50.0, 116.0, 17.0, 35.0, 46.0, 12.0, 44.0, 2.0, 85.0, 56.0, 21.0, 0.0, 2.0, 36.0, 31.0, 23.0, 78.0, 5.0, 95.0, 98.0, 73.0, 0.0, 117.0, 0.0, 0.0, 29.0, 105.0, 24.0, 177.0, 0.0, 0.0, 0.0, 90.0, 6.0, 1.0, 0.0, 77.0, 71.0, 0.0, 0.0, 123.0, 19.0, 128.0, 57.0, 11.0, 13.0, 0.0, 0.0, 45.0, 102.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 122.0, 122.0, 1.0, 87.0, 0.0, 7.0, 47.0, 4.0, 1.0, 92.0, 259.0, 136.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9025709906727488, "mean_inference_ms": 2.8483453689263714, "mean_action_processing_ms": 0.4649403130886215, "mean_env_wait_ms": 0.3268909813182584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009711146354675293, "StateBufferConnector_ms": 0.005166888236999512, "ViewRequirementAgentConnector_ms": 0.14240515232086182}, "num_episodes": 22, "episode_return_max": 335.0, "episode_return_min": -223.0, "episode_return_mean": 52.32, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.2062980402888, "num_env_steps_trained_throughput_per_sec": 333.2062980402888, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 14158.583, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14158.518, "sample_time_ms": 2431.351, "learn_time_ms": 11703.052, "learn_throughput": 341.791, "synch_weights_time_ms": 20.179}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "e1352_00002", "date": "2024-08-13_19-24-34", "timestamp": 1723591474, "time_this_iter_s": 12.053610801696777, "time_total_s": 1367.8945727348328, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d008b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1367.8945727348328, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 60.75882352941177, "ram_util_percent": 83.71176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5036281885727057, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 0.00010000000000000003, "total_loss": 2.6650378900230245, "policy_loss": -0.0010351886328497024, "vf_loss": 2.665758337167205, "vf_explained_var": 0.003831736751334377, "kl": 0.009947163258211373, "entropy": 1.2098363535114067, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.4434906259100275, "cur_kl_coeff": 0.0008789062500000002, "cur_lr": 0.00010000000000000003, "total_loss": 8.38637875400523, "policy_loss": -0.0052616780819667005, "vf_loss": 8.391621922437476, "vf_explained_var": 0.1485220989222249, "kl": 0.021045485451460528, "entropy": 1.182277171952384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 370.0, "episode_reward_min": -223.0, "episode_reward_mean": 81.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -426.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 259.0}, "policy_reward_mean": {"prey_policy": 4.395, "predator_policy": 36.275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-134.0, -54.0, -3.0, 109.0, 210.0, 56.0, 97.0, 96.0, 244.0, 114.0, -16.0, 65.0, 26.0, 130.0, 86.0, -96.0, 154.0, -52.0, 24.0, 27.0, -65.0, 118.0, 12.0, -3.0, -160.0, 44.0, -92.0, 118.0, 8.0, -123.0, 98.0, 111.0, -55.0, 174.0, 209.0, 66.0, 134.0, 47.0, 198.0, -15.0, -12.0, -183.0, 216.0, -116.0, 88.0, -116.0, 137.0, -81.0, 100.0, 263.0, 172.0, 36.0, -24.0, -211.0, 26.0, 75.0, 25.0, -73.0, 0.0, 57.0, 217.0, 214.0, 183.0, -223.0, -92.0, 146.0, 277.0, -35.0, 220.0, 335.0, 0.0, 68.0, -33.0, 211.0, 193.0, 86.0, 159.0, -36.0, 169.0, 187.0, 323.0, 194.0, 198.0, 312.0, -4.0, 227.0, 203.0, 319.0, -4.0, 194.0, 370.0, 104.0, 105.0, 265.0, 124.0, 36.0, 146.0, 138.0, 279.0, 73.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-77.0, -174.0, 8.0, -200.0, 56.0, -226.0, 0.0, 109.0, 171.0, 4.0, -4.0, -70.0, -38.0, 91.0, 166.0, -181.0, 128.0, 92.0, 95.0, 0.0, 0.0, -67.0, -24.0, 42.0, -4.0, 0.0, -7.0, 70.0, 65.0, 21.0, -58.0, -140.0, 134.0, 12.0, 0.0, -132.0, 24.0, 0.0, 0.0, -76.0, -24.0, -106.0, 83.0, 35.0, 0.0, -103.0, -34.0, 14.0, -90.0, -247.0, 0.0, 33.0, -146.0, -148.0, 200.0, -214.0, -79.0, 0.0, -118.0, -187.0, -156.0, 176.0, 0.0, 67.0, -108.0, -2.0, 155.0, -6.0, 87.0, 86.0, -44.0, 44.0, 108.0, -49.0, -52.0, 64.0, 167.0, -28.0, -11.0, -129.0, 100.0, -245.0, -167.0, -168.0, 142.0, 54.0, -238.0, -44.0, 52.0, -16.0, -112.0, -62.0, 173.0, -82.0, -8.0, -214.0, 121.0, -42.0, 103.0, 122.0, 16.0, 102.0, -37.0, -10.0, 12.0, -229.0, -138.0, -146.0, 143.0, -234.0, -58.0, 104.0, 154.0, -258.0, -354.0, 104.0, 0.0, 0.0, 141.0, -180.0, 24.0, 192.0, -95.0, 161.0, 28.0, 155.0, -210.0, -155.0, -261.0, -16.0, 0.0, 122.0, 121.0, 156.0, 112.0, -294.0, 145.0, 75.0, 180.0, 154.0, 0.0, 0.0, 124.0, -300.0, 55.0, -176.0, 123.0, 81.0, 94.0, 48.0, 17.0, -24.0, 190.0, -426.0, 22.0, -340.0, 0.0, 167.0, 0.0, 187.0, 123.0, 200.0, 148.0, -8.0, 89.0, 106.0, 185.0, 100.0, 1.0, -32.0, 76.0, 149.0, 101.0, 63.0, 125.0, 194.0, 0.0, -8.0, 170.0, -51.0, 170.0, 198.0, 74.0, 0.0, -88.0, 106.0, 77.0, 166.0, 124.0, 0.0, -34.0, -114.0, 24.0, 83.0, 15.0, 123.0, 154.0, 109.0, 178.0, -302.0], "policy_predator_policy_reward": [0.0, 117.0, 26.0, 112.0, 134.0, 33.0, 0.0, 0.0, 23.0, 12.0, 90.0, 40.0, 33.0, 11.0, 0.0, 111.0, 24.0, 0.0, 19.0, 0.0, 19.0, 32.0, 12.0, 35.0, 0.0, 30.0, 50.0, 17.0, 0.0, 0.0, 102.0, 0.0, 8.0, 0.0, 69.0, 11.0, 0.0, 0.0, 13.0, 90.0, 6.0, 59.0, 0.0, 0.0, 70.0, 45.0, 0.0, 17.0, 45.0, 132.0, 3.0, 8.0, 106.0, 96.0, 132.0, 0.0, 39.0, 48.0, 55.0, 127.0, 0.0, 78.0, 44.0, 0.0, 0.0, 55.0, 0.0, 25.0, 24.0, 12.0, 30.0, 36.0, 75.0, 0.0, 26.0, 9.0, 55.0, 4.0, 10.0, 115.0, 21.0, 112.0, 32.0, 120.0, 0.0, 20.0, 50.0, 116.0, 17.0, 35.0, 46.0, 12.0, 44.0, 2.0, 85.0, 56.0, 21.0, 0.0, 2.0, 36.0, 31.0, 23.0, 78.0, 5.0, 95.0, 98.0, 73.0, 0.0, 117.0, 0.0, 0.0, 29.0, 105.0, 24.0, 177.0, 0.0, 0.0, 0.0, 90.0, 6.0, 1.0, 0.0, 77.0, 71.0, 0.0, 0.0, 123.0, 19.0, 128.0, 57.0, 11.0, 13.0, 0.0, 0.0, 45.0, 102.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 122.0, 122.0, 1.0, 87.0, 0.0, 7.0, 47.0, 4.0, 1.0, 92.0, 259.0, 136.0, 110.0, 172.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 28.0, 26.0, 0.0, 3.0, 27.0, 0.0, 12.0, 15.0, 0.0, 2.0, 30.0, 9.0, 0.0, 0.0, 4.0, 0.0, 47.0, 28.0, 0.0, 2.0, 21.0, 9.0, 11.0, 76.0, 0.0, 22.0, 0.0, 0.0, 81.0, 103.0, 6.0, 33.0, 0.0, 0.0, 0.0, 16.0, 138.0, 59.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8999115417019847, "mean_inference_ms": 2.8351277397579, "mean_action_processing_ms": 0.5005511195234816, "mean_env_wait_ms": 0.3258765418918886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011705994606018066, "StateBufferConnector_ms": 0.005024552345275879, "ViewRequirementAgentConnector_ms": 0.13125503063201904}, "num_episodes": 23, "episode_return_max": 370.0, "episode_return_min": -223.0, "episode_return_mean": 81.34, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.4895006069839, "num_env_steps_trained_throughput_per_sec": 346.4895006069839, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 14094.782, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14094.719, "sample_time_ms": 2448.89, "learn_time_ms": 11621.657, "learn_throughput": 344.185, "synch_weights_time_ms": 20.329}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "e1352_00002", "date": "2024-08-13_19-24-46", "timestamp": 1723591486, "time_this_iter_s": 11.599526166915894, "time_total_s": 1379.4940989017487, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb59d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1379.4940989017487, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 57.82941176470588, "ram_util_percent": 83.82941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.47916245243497313, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 0.00010000000000000003, "total_loss": 0.7754025435163862, "policy_loss": -0.0024324887747526483, "vf_loss": 0.7775700385095896, "vf_explained_var": 0.008995495492188388, "kl": 0.008375154676713237, "entropy": 1.1990022323118947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.257232211143883, "cur_kl_coeff": 0.001318359375, "cur_lr": 0.00010000000000000003, "total_loss": 6.650618005177331, "policy_loss": -0.002443975109234945, "vf_loss": 6.653043892774632, "vf_explained_var": 0.34289831796651166, "kl": 0.013720814874660658, "entropy": 1.0980254982514357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 384.0, "episode_reward_min": -223.0, "episode_reward_mean": 108.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -426.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 259.0}, "policy_reward_mean": {"prey_policy": 20.835, "predator_policy": 33.195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.0, 27.0, -65.0, 118.0, 12.0, -3.0, -160.0, 44.0, -92.0, 118.0, 8.0, -123.0, 98.0, 111.0, -55.0, 174.0, 209.0, 66.0, 134.0, 47.0, 198.0, -15.0, -12.0, -183.0, 216.0, -116.0, 88.0, -116.0, 137.0, -81.0, 100.0, 263.0, 172.0, 36.0, -24.0, -211.0, 26.0, 75.0, 25.0, -73.0, 0.0, 57.0, 217.0, 214.0, 183.0, -223.0, -92.0, 146.0, 277.0, -35.0, 220.0, 335.0, 0.0, 68.0, -33.0, 211.0, 193.0, 86.0, 159.0, -36.0, 169.0, 187.0, 323.0, 194.0, 198.0, 312.0, -4.0, 227.0, 203.0, 319.0, -4.0, 194.0, 370.0, 104.0, 105.0, 265.0, 124.0, 36.0, 146.0, 138.0, 279.0, 73.0, 384.0, 360.0, 246.0, 306.0, -11.0, 142.0, 345.0, 75.0, 209.0, 0.0, 174.0, 14.0, 321.0, 171.0, 319.0, 317.0, 158.0, 174.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [24.0, 0.0, 0.0, -76.0, -24.0, -106.0, 83.0, 35.0, 0.0, -103.0, -34.0, 14.0, -90.0, -247.0, 0.0, 33.0, -146.0, -148.0, 200.0, -214.0, -79.0, 0.0, -118.0, -187.0, -156.0, 176.0, 0.0, 67.0, -108.0, -2.0, 155.0, -6.0, 87.0, 86.0, -44.0, 44.0, 108.0, -49.0, -52.0, 64.0, 167.0, -28.0, -11.0, -129.0, 100.0, -245.0, -167.0, -168.0, 142.0, 54.0, -238.0, -44.0, 52.0, -16.0, -112.0, -62.0, 173.0, -82.0, -8.0, -214.0, 121.0, -42.0, 103.0, 122.0, 16.0, 102.0, -37.0, -10.0, 12.0, -229.0, -138.0, -146.0, 143.0, -234.0, -58.0, 104.0, 154.0, -258.0, -354.0, 104.0, 0.0, 0.0, 141.0, -180.0, 24.0, 192.0, -95.0, 161.0, 28.0, 155.0, -210.0, -155.0, -261.0, -16.0, 0.0, 122.0, 121.0, 156.0, 112.0, -294.0, 145.0, 75.0, 180.0, 154.0, 0.0, 0.0, 124.0, -300.0, 55.0, -176.0, 123.0, 81.0, 94.0, 48.0, 17.0, -24.0, 190.0, -426.0, 22.0, -340.0, 0.0, 167.0, 0.0, 187.0, 123.0, 200.0, 148.0, -8.0, 89.0, 106.0, 185.0, 100.0, 1.0, -32.0, 76.0, 149.0, 101.0, 63.0, 125.0, 194.0, 0.0, -8.0, 170.0, -51.0, 170.0, 198.0, 74.0, 0.0, -88.0, 106.0, 77.0, 166.0, 124.0, 0.0, -34.0, -114.0, 24.0, 83.0, 15.0, 123.0, 154.0, 109.0, 178.0, -302.0, 184.0, 200.0, 157.0, 191.0, 101.0, 86.0, 93.0, 179.0, 0.0, -270.0, 113.0, -4.0, 171.0, 173.0, 0.0, 75.0, 128.0, 53.0, 0.0, 0.0, 174.0, 0.0, 9.0, 0.0, 104.0, 186.0, 167.0, 0.0, 197.0, 63.0, 133.0, 176.0, 0.0, 137.0, 174.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 13.0, 90.0, 6.0, 59.0, 0.0, 0.0, 70.0, 45.0, 0.0, 17.0, 45.0, 132.0, 3.0, 8.0, 106.0, 96.0, 132.0, 0.0, 39.0, 48.0, 55.0, 127.0, 0.0, 78.0, 44.0, 0.0, 0.0, 55.0, 0.0, 25.0, 24.0, 12.0, 30.0, 36.0, 75.0, 0.0, 26.0, 9.0, 55.0, 4.0, 10.0, 115.0, 21.0, 112.0, 32.0, 120.0, 0.0, 20.0, 50.0, 116.0, 17.0, 35.0, 46.0, 12.0, 44.0, 2.0, 85.0, 56.0, 21.0, 0.0, 2.0, 36.0, 31.0, 23.0, 78.0, 5.0, 95.0, 98.0, 73.0, 0.0, 117.0, 0.0, 0.0, 29.0, 105.0, 24.0, 177.0, 0.0, 0.0, 0.0, 90.0, 6.0, 1.0, 0.0, 77.0, 71.0, 0.0, 0.0, 123.0, 19.0, 128.0, 57.0, 11.0, 13.0, 0.0, 0.0, 45.0, 102.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 122.0, 122.0, 1.0, 87.0, 0.0, 7.0, 47.0, 4.0, 1.0, 92.0, 259.0, 136.0, 110.0, 172.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 28.0, 26.0, 0.0, 3.0, 27.0, 0.0, 12.0, 15.0, 0.0, 2.0, 30.0, 9.0, 0.0, 0.0, 4.0, 0.0, 47.0, 28.0, 0.0, 2.0, 21.0, 9.0, 11.0, 76.0, 0.0, 22.0, 0.0, 0.0, 81.0, 103.0, 6.0, 33.0, 0.0, 0.0, 0.0, 16.0, 138.0, 59.0, 0.0, 0.0, 0.0, 12.0, 38.0, 21.0, 34.0, 0.0, 135.0, 124.0, 19.0, 14.0, 0.0, 1.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 14.0, 17.0, 4.0, 0.0, 29.0, 30.0, 0.0, 8.0, 20.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8964880314012325, "mean_inference_ms": 2.824038763475514, "mean_action_processing_ms": 0.5272592508212729, "mean_env_wait_ms": 0.32464270105666765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011345386505126953, "StateBufferConnector_ms": 0.005777478218078613, "ViewRequirementAgentConnector_ms": 0.13033783435821533}, "num_episodes": 18, "episode_return_max": 384.0, "episode_return_min": -223.0, "episode_return_mean": 108.06, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.79740886797833, "num_env_steps_trained_throughput_per_sec": 329.79740886797833, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 14061.635, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14061.571, "sample_time_ms": 2482.734, "learn_time_ms": 11554.511, "learn_throughput": 346.185, "synch_weights_time_ms": 20.725}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "e1352_00002", "date": "2024-08-13_19-24-58", "timestamp": 1723591498, "time_this_iter_s": 12.180699825286865, "time_total_s": 1391.6747987270355, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb58b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1391.6747987270355, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 60.81764705882353, "ram_util_percent": 83.9235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8483270960273566, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 0.00010000000000000003, "total_loss": 1.2026755149717685, "policy_loss": -0.0023261373360005636, "vf_loss": 1.2048976466926948, "vf_explained_var": 0.07376614408518271, "kl": 0.0032869969676244046, "entropy": 1.1913695202933416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.658180367867782, "cur_kl_coeff": 0.001318359375, "cur_lr": 0.00010000000000000003, "total_loss": 6.636309320712216, "policy_loss": -0.00046774843022739763, "vf_loss": 6.636765188893313, "vf_explained_var": 0.38192838512400473, "kl": 0.009009635714329504, "entropy": 1.0672179569327642, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 384.0, "episode_reward_min": -223.0, "episode_reward_mean": 140.91, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -426.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 259.0}, "policy_reward_mean": {"prey_policy": 42.485, "predator_policy": 27.97}, "custom_metrics": {}, "hist_stats": {"episode_reward": [134.0, 47.0, 198.0, -15.0, -12.0, -183.0, 216.0, -116.0, 88.0, -116.0, 137.0, -81.0, 100.0, 263.0, 172.0, 36.0, -24.0, -211.0, 26.0, 75.0, 25.0, -73.0, 0.0, 57.0, 217.0, 214.0, 183.0, -223.0, -92.0, 146.0, 277.0, -35.0, 220.0, 335.0, 0.0, 68.0, -33.0, 211.0, 193.0, 86.0, 159.0, -36.0, 169.0, 187.0, 323.0, 194.0, 198.0, 312.0, -4.0, 227.0, 203.0, 319.0, -4.0, 194.0, 370.0, 104.0, 105.0, 265.0, 124.0, 36.0, 146.0, 138.0, 279.0, 73.0, 384.0, 360.0, 246.0, 306.0, -11.0, 142.0, 345.0, 75.0, 209.0, 0.0, 174.0, 14.0, 321.0, 171.0, 319.0, 317.0, 158.0, 174.0, 308.0, 0.0, 321.0, 227.0, 155.0, 323.0, 283.0, 182.0, 191.0, 81.0, 361.0, 161.0, 128.0, 54.0, 194.0, 347.0, 124.0, 356.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [108.0, -49.0, -52.0, 64.0, 167.0, -28.0, -11.0, -129.0, 100.0, -245.0, -167.0, -168.0, 142.0, 54.0, -238.0, -44.0, 52.0, -16.0, -112.0, -62.0, 173.0, -82.0, -8.0, -214.0, 121.0, -42.0, 103.0, 122.0, 16.0, 102.0, -37.0, -10.0, 12.0, -229.0, -138.0, -146.0, 143.0, -234.0, -58.0, 104.0, 154.0, -258.0, -354.0, 104.0, 0.0, 0.0, 141.0, -180.0, 24.0, 192.0, -95.0, 161.0, 28.0, 155.0, -210.0, -155.0, -261.0, -16.0, 0.0, 122.0, 121.0, 156.0, 112.0, -294.0, 145.0, 75.0, 180.0, 154.0, 0.0, 0.0, 124.0, -300.0, 55.0, -176.0, 123.0, 81.0, 94.0, 48.0, 17.0, -24.0, 190.0, -426.0, 22.0, -340.0, 0.0, 167.0, 0.0, 187.0, 123.0, 200.0, 148.0, -8.0, 89.0, 106.0, 185.0, 100.0, 1.0, -32.0, 76.0, 149.0, 101.0, 63.0, 125.0, 194.0, 0.0, -8.0, 170.0, -51.0, 170.0, 198.0, 74.0, 0.0, -88.0, 106.0, 77.0, 166.0, 124.0, 0.0, -34.0, -114.0, 24.0, 83.0, 15.0, 123.0, 154.0, 109.0, 178.0, -302.0, 184.0, 200.0, 157.0, 191.0, 101.0, 86.0, 93.0, 179.0, 0.0, -270.0, 113.0, -4.0, 171.0, 173.0, 0.0, 75.0, 128.0, 53.0, 0.0, 0.0, 174.0, 0.0, 9.0, 0.0, 104.0, 186.0, 167.0, 0.0, 197.0, 63.0, 133.0, 176.0, 0.0, 137.0, 174.0, 0.0, 155.0, 153.0, 0.0, 0.0, 132.0, 189.0, -31.0, 158.0, 149.0, -6.0, 196.0, 97.0, 197.0, 86.0, 0.0, 176.0, 187.0, 0.0, 23.0, -2.0, 200.0, 156.0, -12.0, 167.0, 0.0, 111.0, 0.0, 0.0, 0.0, 194.0, 169.0, 167.0, 88.0, 0.0, 181.0, 166.0], "policy_predator_policy_reward": [75.0, 0.0, 26.0, 9.0, 55.0, 4.0, 10.0, 115.0, 21.0, 112.0, 32.0, 120.0, 0.0, 20.0, 50.0, 116.0, 17.0, 35.0, 46.0, 12.0, 44.0, 2.0, 85.0, 56.0, 21.0, 0.0, 2.0, 36.0, 31.0, 23.0, 78.0, 5.0, 95.0, 98.0, 73.0, 0.0, 117.0, 0.0, 0.0, 29.0, 105.0, 24.0, 177.0, 0.0, 0.0, 0.0, 90.0, 6.0, 1.0, 0.0, 77.0, 71.0, 0.0, 0.0, 123.0, 19.0, 128.0, 57.0, 11.0, 13.0, 0.0, 0.0, 45.0, 102.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 122.0, 122.0, 1.0, 87.0, 0.0, 7.0, 47.0, 4.0, 1.0, 92.0, 259.0, 136.0, 110.0, 172.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 28.0, 26.0, 0.0, 3.0, 27.0, 0.0, 12.0, 15.0, 0.0, 2.0, 30.0, 9.0, 0.0, 0.0, 4.0, 0.0, 47.0, 28.0, 0.0, 2.0, 21.0, 9.0, 11.0, 76.0, 0.0, 22.0, 0.0, 0.0, 81.0, 103.0, 6.0, 33.0, 0.0, 0.0, 0.0, 16.0, 138.0, 59.0, 0.0, 0.0, 0.0, 12.0, 38.0, 21.0, 34.0, 0.0, 135.0, 124.0, 19.0, 14.0, 0.0, 1.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 14.0, 17.0, 4.0, 0.0, 29.0, 30.0, 0.0, 8.0, 20.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 52.0, 48.0, 9.0, 3.0, 30.0, 0.0, 0.0, 0.0, 6.0, 0.0, 4.0, 0.0, 5.0, 55.0, 5.0, 0.0, 0.0, 6.0, 17.0, 0.0, 12.0, 42.0, 0.0, 0.0, 0.0, 11.0, 36.0, 0.0, 0.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8934070565779308, "mean_inference_ms": 2.814526849569072, "mean_action_processing_ms": 0.5224617420130212, "mean_env_wait_ms": 0.32352999591710785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018758654594421387, "StateBufferConnector_ms": 0.009446501731872559, "ViewRequirementAgentConnector_ms": 0.13229167461395264}, "num_episodes": 18, "episode_return_max": 384.0, "episode_return_min": -223.0, "episode_return_mean": 140.91, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 339.0336475195988, "num_env_steps_trained_throughput_per_sec": 339.0336475195988, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 14069.126, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14069.063, "sample_time_ms": 2488.843, "learn_time_ms": 11559.756, "learn_throughput": 346.028, "synch_weights_time_ms": 16.716}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "e1352_00002", "date": "2024-08-13_19-25-10", "timestamp": 1723591510, "time_this_iter_s": 11.85657811164856, "time_total_s": 1403.531376838684, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb34c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1403.531376838684, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 56.51764705882353, "ram_util_percent": 83.93529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7424090140553379, "cur_kl_coeff": 0.015820312499999996, "cur_lr": 0.00010000000000000003, "total_loss": 1.3494070451884044, "policy_loss": -0.006491619987393576, "vf_loss": 1.35570223390583, "vf_explained_var": 0.005849190868397869, "kl": 0.012416437440257194, "entropy": 1.1743153029648716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.532950738387765, "cur_kl_coeff": 0.001318359375, "cur_lr": 0.00010000000000000003, "total_loss": 5.461166372753325, "policy_loss": -0.0025375517887166804, "vf_loss": 5.463692660811086, "vf_explained_var": 0.47424606346579457, "kl": 0.008540795729960634, "entropy": 1.1747325214128645, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 384.0, "episode_reward_min": -223.0, "episode_reward_mean": 164.94, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -426.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 259.0}, "policy_reward_mean": {"prey_policy": 59.955, "predator_policy": 22.515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.0, 75.0, 25.0, -73.0, 0.0, 57.0, 217.0, 214.0, 183.0, -223.0, -92.0, 146.0, 277.0, -35.0, 220.0, 335.0, 0.0, 68.0, -33.0, 211.0, 193.0, 86.0, 159.0, -36.0, 169.0, 187.0, 323.0, 194.0, 198.0, 312.0, -4.0, 227.0, 203.0, 319.0, -4.0, 194.0, 370.0, 104.0, 105.0, 265.0, 124.0, 36.0, 146.0, 138.0, 279.0, 73.0, 384.0, 360.0, 246.0, 306.0, -11.0, 142.0, 345.0, 75.0, 209.0, 0.0, 174.0, 14.0, 321.0, 171.0, 319.0, 317.0, 158.0, 174.0, 308.0, 0.0, 321.0, 227.0, 155.0, 323.0, 283.0, 182.0, 191.0, 81.0, 361.0, 161.0, 128.0, 54.0, 194.0, 347.0, 124.0, 356.0, 300.0, 138.0, 334.0, 175.0, 88.0, 134.0, 79.0, 22.0, 184.0, -7.0, 196.0, 330.0, 185.0, 365.0, 338.0, 5.0, 170.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [143.0, -234.0, -58.0, 104.0, 154.0, -258.0, -354.0, 104.0, 0.0, 0.0, 141.0, -180.0, 24.0, 192.0, -95.0, 161.0, 28.0, 155.0, -210.0, -155.0, -261.0, -16.0, 0.0, 122.0, 121.0, 156.0, 112.0, -294.0, 145.0, 75.0, 180.0, 154.0, 0.0, 0.0, 124.0, -300.0, 55.0, -176.0, 123.0, 81.0, 94.0, 48.0, 17.0, -24.0, 190.0, -426.0, 22.0, -340.0, 0.0, 167.0, 0.0, 187.0, 123.0, 200.0, 148.0, -8.0, 89.0, 106.0, 185.0, 100.0, 1.0, -32.0, 76.0, 149.0, 101.0, 63.0, 125.0, 194.0, 0.0, -8.0, 170.0, -51.0, 170.0, 198.0, 74.0, 0.0, -88.0, 106.0, 77.0, 166.0, 124.0, 0.0, -34.0, -114.0, 24.0, 83.0, 15.0, 123.0, 154.0, 109.0, 178.0, -302.0, 184.0, 200.0, 157.0, 191.0, 101.0, 86.0, 93.0, 179.0, 0.0, -270.0, 113.0, -4.0, 171.0, 173.0, 0.0, 75.0, 128.0, 53.0, 0.0, 0.0, 174.0, 0.0, 9.0, 0.0, 104.0, 186.0, 167.0, 0.0, 197.0, 63.0, 133.0, 176.0, 0.0, 137.0, 174.0, 0.0, 155.0, 153.0, 0.0, 0.0, 132.0, 189.0, -31.0, 158.0, 149.0, -6.0, 196.0, 97.0, 197.0, 86.0, 0.0, 176.0, 187.0, 0.0, 23.0, -2.0, 200.0, 156.0, -12.0, 167.0, 0.0, 111.0, 0.0, 0.0, 0.0, 194.0, 169.0, 167.0, 88.0, 0.0, 181.0, 166.0, 177.0, 117.0, 101.0, 0.0, 125.0, 189.0, -38.0, 193.0, 37.0, -4.0, 0.0, 124.0, 31.0, 0.0, -23.0, -79.0, 43.0, 98.0, -14.0, 0.0, 196.0, 0.0, 133.0, 180.0, 185.0, 0.0, 188.0, 168.0, 119.0, 200.0, 0.0, 2.0, 155.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [117.0, 0.0, 0.0, 29.0, 105.0, 24.0, 177.0, 0.0, 0.0, 0.0, 90.0, 6.0, 1.0, 0.0, 77.0, 71.0, 0.0, 0.0, 123.0, 19.0, 128.0, 57.0, 11.0, 13.0, 0.0, 0.0, 45.0, 102.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 122.0, 122.0, 1.0, 87.0, 0.0, 7.0, 47.0, 4.0, 1.0, 92.0, 259.0, 136.0, 110.0, 172.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 28.0, 26.0, 0.0, 3.0, 27.0, 0.0, 12.0, 15.0, 0.0, 2.0, 30.0, 9.0, 0.0, 0.0, 4.0, 0.0, 47.0, 28.0, 0.0, 2.0, 21.0, 9.0, 11.0, 76.0, 0.0, 22.0, 0.0, 0.0, 81.0, 103.0, 6.0, 33.0, 0.0, 0.0, 0.0, 16.0, 138.0, 59.0, 0.0, 0.0, 0.0, 12.0, 38.0, 21.0, 34.0, 0.0, 135.0, 124.0, 19.0, 14.0, 0.0, 1.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 14.0, 17.0, 4.0, 0.0, 29.0, 30.0, 0.0, 8.0, 20.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 52.0, 48.0, 9.0, 3.0, 30.0, 0.0, 0.0, 0.0, 6.0, 0.0, 4.0, 0.0, 5.0, 55.0, 5.0, 0.0, 0.0, 6.0, 17.0, 0.0, 12.0, 42.0, 0.0, 0.0, 0.0, 11.0, 36.0, 0.0, 0.0, 9.0, 1.0, 5.0, 33.0, 4.0, 6.0, 14.0, 19.0, 1.0, 0.0, 55.0, 0.0, 10.0, 27.0, 21.0, 68.0, 56.0, 39.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 9.0, 0.0, 0.0, 19.0, 3.0, 0.0, 0.0, 15.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8930769321475726, "mean_inference_ms": 2.813137026165455, "mean_action_processing_ms": 0.5173074609705429, "mean_env_wait_ms": 0.32354467651799346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017597317695617676, "StateBufferConnector_ms": 0.010835647583007812, "ViewRequirementAgentConnector_ms": 0.14150583744049072}, "num_episodes": 18, "episode_return_max": 384.0, "episode_return_min": -223.0, "episode_return_mean": 164.94, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.28623017249794, "num_env_steps_trained_throughput_per_sec": 299.28623017249794, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 13756.099, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13756.049, "sample_time_ms": 2589.849, "learn_time_ms": 11148.263, "learn_throughput": 358.8, "synch_weights_time_ms": 14.626}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "e1352_00002", "date": "2024-08-13_19-25-24", "timestamp": 1723591524, "time_this_iter_s": 13.41770887374878, "time_total_s": 1416.9490857124329, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb59d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1416.9490857124329, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 61.415789473684214, "ram_util_percent": 84.02105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7698780049446714, "cur_kl_coeff": 0.015820312499999996, "cur_lr": 0.00010000000000000003, "total_loss": 2.628095508630944, "policy_loss": -0.0037287418246417054, "vf_loss": 2.6316967661418613, "vf_explained_var": 0.0137581070579549, "kl": 0.008058402224578464, "entropy": 1.1647382796756804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.436335852355867, "cur_kl_coeff": 0.001318359375, "cur_lr": 0.00010000000000000003, "total_loss": 6.714715444726288, "policy_loss": -0.000412405357159004, "vf_loss": 6.715123724306702, "vf_explained_var": 0.11492807310094279, "kl": 0.003130205223450137, "entropy": 1.1173854177591032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 384.0, "episode_reward_min": -104.0, "episode_reward_mean": 169.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -343.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 157.0}, "policy_reward_mean": {"prey_policy": 67.57, "predator_policy": 16.935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [194.0, 198.0, 312.0, -4.0, 227.0, 203.0, 319.0, -4.0, 194.0, 370.0, 104.0, 105.0, 265.0, 124.0, 36.0, 146.0, 138.0, 279.0, 73.0, 384.0, 360.0, 246.0, 306.0, -11.0, 142.0, 345.0, 75.0, 209.0, 0.0, 174.0, 14.0, 321.0, 171.0, 319.0, 317.0, 158.0, 174.0, 308.0, 0.0, 321.0, 227.0, 155.0, 323.0, 283.0, 182.0, 191.0, 81.0, 361.0, 161.0, 128.0, 54.0, 194.0, 347.0, 124.0, 356.0, 300.0, 138.0, 334.0, 175.0, 88.0, 134.0, 79.0, 22.0, 184.0, -7.0, 196.0, 330.0, 185.0, 365.0, 338.0, 5.0, 170.0, 0.0, 277.0, 63.0, 167.0, 191.0, 164.0, -25.0, 0.0, 189.0, -104.0, 213.0, 264.0, -12.0, 77.0, 102.0, 293.0, 117.0, 197.0, 203.0, -55.0, 19.0, 90.0, 216.0, 0.0, -57.0, 0.0, 309.0, 188.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [148.0, -8.0, 89.0, 106.0, 185.0, 100.0, 1.0, -32.0, 76.0, 149.0, 101.0, 63.0, 125.0, 194.0, 0.0, -8.0, 170.0, -51.0, 170.0, 198.0, 74.0, 0.0, -88.0, 106.0, 77.0, 166.0, 124.0, 0.0, -34.0, -114.0, 24.0, 83.0, 15.0, 123.0, 154.0, 109.0, 178.0, -302.0, 184.0, 200.0, 157.0, 191.0, 101.0, 86.0, 93.0, 179.0, 0.0, -270.0, 113.0, -4.0, 171.0, 173.0, 0.0, 75.0, 128.0, 53.0, 0.0, 0.0, 174.0, 0.0, 9.0, 0.0, 104.0, 186.0, 167.0, 0.0, 197.0, 63.0, 133.0, 176.0, 0.0, 137.0, 174.0, 0.0, 155.0, 153.0, 0.0, 0.0, 132.0, 189.0, -31.0, 158.0, 149.0, -6.0, 196.0, 97.0, 197.0, 86.0, 0.0, 176.0, 187.0, 0.0, 23.0, -2.0, 200.0, 156.0, -12.0, 167.0, 0.0, 111.0, 0.0, 0.0, 0.0, 194.0, 169.0, 167.0, 88.0, 0.0, 181.0, 166.0, 177.0, 117.0, 101.0, 0.0, 125.0, 189.0, -38.0, 193.0, 37.0, -4.0, 0.0, 124.0, 31.0, 0.0, -23.0, -79.0, 43.0, 98.0, -14.0, 0.0, 196.0, 0.0, 133.0, 180.0, 185.0, 0.0, 188.0, 168.0, 119.0, 200.0, 0.0, 2.0, 155.0, 0.0, 0.0, 0.0, 173.0, 52.0, 0.0, 61.0, 151.0, 0.0, -8.0, 188.0, 157.0, -48.0, 0.0, -50.0, 0.0, 0.0, 189.0, 0.0, -343.0, -7.0, 13.0, 200.0, 112.0, 92.0, -86.0, -38.0, -22.0, 47.0, -2.0, 98.0, 150.0, 143.0, -127.0, 173.0, 200.0, -6.0, 6.0, 151.0, -62.0, -24.0, -2.0, -69.0, -38.0, 8.0, -1.0, 129.0, 0.0, 0.0, -123.0, -79.0, 0.0, 0.0, 119.0, 186.0, -14.0, 195.0], "policy_predator_policy_reward": [28.0, 26.0, 0.0, 3.0, 27.0, 0.0, 12.0, 15.0, 0.0, 2.0, 30.0, 9.0, 0.0, 0.0, 4.0, 0.0, 47.0, 28.0, 0.0, 2.0, 21.0, 9.0, 11.0, 76.0, 0.0, 22.0, 0.0, 0.0, 81.0, 103.0, 6.0, 33.0, 0.0, 0.0, 0.0, 16.0, 138.0, 59.0, 0.0, 0.0, 0.0, 12.0, 38.0, 21.0, 34.0, 0.0, 135.0, 124.0, 19.0, 14.0, 0.0, 1.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 14.0, 17.0, 4.0, 0.0, 29.0, 30.0, 0.0, 8.0, 20.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 52.0, 48.0, 9.0, 3.0, 30.0, 0.0, 0.0, 0.0, 6.0, 0.0, 4.0, 0.0, 5.0, 55.0, 5.0, 0.0, 0.0, 6.0, 17.0, 0.0, 12.0, 42.0, 0.0, 0.0, 0.0, 11.0, 36.0, 0.0, 0.0, 9.0, 1.0, 5.0, 33.0, 4.0, 6.0, 14.0, 19.0, 1.0, 0.0, 55.0, 0.0, 10.0, 27.0, 21.0, 68.0, 56.0, 39.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 9.0, 0.0, 0.0, 19.0, 3.0, 0.0, 0.0, 15.0, 0.0, 0.0, 52.0, 0.0, 2.0, 0.0, 1.0, 15.0, 7.0, 4.0, 55.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 157.0, 89.0, 0.0, 0.0, 0.0, 60.0, 112.0, 0.0, 36.0, 16.0, 1.0, 5.0, 0.0, 0.0, 71.0, 0.0, 3.0, 0.0, 12.0, 34.0, 0.0, 31.0, 0.0, 90.0, 48.0, 72.0, 56.0, 32.0, 0.0, 0.0, 1.0, 144.0, 0.0, 0.0, 0.0, 4.0, 0.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8931011569207373, "mean_inference_ms": 2.8143529116062593, "mean_action_processing_ms": 0.5115639771196525, "mean_env_wait_ms": 0.32417387267316966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019200444221496582, "StateBufferConnector_ms": 0.020696163177490234, "ViewRequirementAgentConnector_ms": 0.14359724521636963}, "num_episodes": 27, "episode_return_max": 384.0, "episode_return_min": -104.0, "episode_return_mean": 169.01, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.0452719492819, "num_env_steps_trained_throughput_per_sec": 318.0452719492819, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 13307.741, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13307.697, "sample_time_ms": 2217.435, "learn_time_ms": 11072.997, "learn_throughput": 361.239, "synch_weights_time_ms": 14.288}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "e1352_00002", "date": "2024-08-13_19-25-36", "timestamp": 1723591536, "time_this_iter_s": 12.626714706420898, "time_total_s": 1429.5758004188538, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d000d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1429.5758004188538, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 59.83888888888888, "ram_util_percent": 83.85000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0591461621106617, "cur_kl_coeff": 0.015820312499999996, "cur_lr": 0.00010000000000000003, "total_loss": 3.322535378970797, "policy_loss": -0.005839005503655663, "vf_loss": 3.328023001882765, "vf_explained_var": 0.0649078609451415, "kl": 0.022210118029950238, "entropy": 1.2570428160763292, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.085333349654285, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 7.8846448184321165, "policy_loss": -0.0021372278336750923, "vf_loss": 7.886773491662646, "vf_explained_var": 0.0004946643082553117, "kl": 0.012990108328746081, "entropy": 1.0131042418971894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -104.0, "episode_reward_mean": 160.64, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -343.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 175.0}, "policy_reward_mean": {"prey_policy": 61.165, "predator_policy": 19.155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.0, 384.0, 360.0, 246.0, 306.0, -11.0, 142.0, 345.0, 75.0, 209.0, 0.0, 174.0, 14.0, 321.0, 171.0, 319.0, 317.0, 158.0, 174.0, 308.0, 0.0, 321.0, 227.0, 155.0, 323.0, 283.0, 182.0, 191.0, 81.0, 361.0, 161.0, 128.0, 54.0, 194.0, 347.0, 124.0, 356.0, 300.0, 138.0, 334.0, 175.0, 88.0, 134.0, 79.0, 22.0, 184.0, -7.0, 196.0, 330.0, 185.0, 365.0, 338.0, 5.0, 170.0, 0.0, 277.0, 63.0, 167.0, 191.0, 164.0, -25.0, 0.0, 189.0, -104.0, 213.0, 264.0, -12.0, 77.0, 102.0, 293.0, 117.0, 197.0, 203.0, -55.0, 19.0, 90.0, 216.0, 0.0, -57.0, 0.0, 309.0, 188.0, 32.0, 188.0, -66.0, 242.0, -7.0, 266.0, 86.0, -52.0, 287.0, 150.0, 391.0, -98.0, 180.0, 44.0, 211.0, 357.0, 194.0, -36.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [178.0, -302.0, 184.0, 200.0, 157.0, 191.0, 101.0, 86.0, 93.0, 179.0, 0.0, -270.0, 113.0, -4.0, 171.0, 173.0, 0.0, 75.0, 128.0, 53.0, 0.0, 0.0, 174.0, 0.0, 9.0, 0.0, 104.0, 186.0, 167.0, 0.0, 197.0, 63.0, 133.0, 176.0, 0.0, 137.0, 174.0, 0.0, 155.0, 153.0, 0.0, 0.0, 132.0, 189.0, -31.0, 158.0, 149.0, -6.0, 196.0, 97.0, 197.0, 86.0, 0.0, 176.0, 187.0, 0.0, 23.0, -2.0, 200.0, 156.0, -12.0, 167.0, 0.0, 111.0, 0.0, 0.0, 0.0, 194.0, 169.0, 167.0, 88.0, 0.0, 181.0, 166.0, 177.0, 117.0, 101.0, 0.0, 125.0, 189.0, -38.0, 193.0, 37.0, -4.0, 0.0, 124.0, 31.0, 0.0, -23.0, -79.0, 43.0, 98.0, -14.0, 0.0, 196.0, 0.0, 133.0, 180.0, 185.0, 0.0, 188.0, 168.0, 119.0, 200.0, 0.0, 2.0, 155.0, 0.0, 0.0, 0.0, 173.0, 52.0, 0.0, 61.0, 151.0, 0.0, -8.0, 188.0, 157.0, -48.0, 0.0, -50.0, 0.0, 0.0, 189.0, 0.0, -343.0, -7.0, 13.0, 200.0, 112.0, 92.0, -86.0, -38.0, -22.0, 47.0, -2.0, 98.0, 150.0, 143.0, -127.0, 173.0, 200.0, -6.0, 6.0, 151.0, -62.0, -24.0, -2.0, -69.0, -38.0, 8.0, -1.0, 129.0, 0.0, 0.0, -123.0, -79.0, 0.0, 0.0, 119.0, 186.0, -14.0, 195.0, -44.0, -10.0, 38.0, 112.0, -241.0, -4.0, 115.0, 115.0, -22.0, -91.0, 88.0, 155.0, -49.0, 65.0, -178.0, 0.0, 87.0, 170.0, 101.0, 21.0, 199.0, 192.0, -93.0, -110.0, 187.0, -16.0, -325.0, 194.0, 179.0, 32.0, 190.0, 167.0, 199.0, -10.0, -99.0, 0.0], "policy_predator_policy_reward": [138.0, 59.0, 0.0, 0.0, 0.0, 12.0, 38.0, 21.0, 34.0, 0.0, 135.0, 124.0, 19.0, 14.0, 0.0, 1.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 14.0, 17.0, 4.0, 0.0, 29.0, 30.0, 0.0, 8.0, 20.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 52.0, 48.0, 9.0, 3.0, 30.0, 0.0, 0.0, 0.0, 6.0, 0.0, 4.0, 0.0, 5.0, 55.0, 5.0, 0.0, 0.0, 6.0, 17.0, 0.0, 12.0, 42.0, 0.0, 0.0, 0.0, 11.0, 36.0, 0.0, 0.0, 9.0, 1.0, 5.0, 33.0, 4.0, 6.0, 14.0, 19.0, 1.0, 0.0, 55.0, 0.0, 10.0, 27.0, 21.0, 68.0, 56.0, 39.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 9.0, 0.0, 0.0, 19.0, 3.0, 0.0, 0.0, 15.0, 0.0, 0.0, 52.0, 0.0, 2.0, 0.0, 1.0, 15.0, 7.0, 4.0, 55.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 157.0, 89.0, 0.0, 0.0, 0.0, 60.0, 112.0, 0.0, 36.0, 16.0, 1.0, 5.0, 0.0, 0.0, 71.0, 0.0, 3.0, 0.0, 12.0, 34.0, 0.0, 31.0, 0.0, 90.0, 48.0, 72.0, 56.0, 32.0, 0.0, 0.0, 1.0, 144.0, 0.0, 0.0, 0.0, 4.0, 0.0, 7.0, 5.0, 81.0, 2.0, 36.0, 122.0, 57.0, 0.0, 12.0, 97.0, 9.0, 3.0, 20.0, 5.0, 65.0, 2.0, 124.0, 30.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 105.0, 9.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 63.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8933932231985665, "mean_inference_ms": 2.814971113187981, "mean_action_processing_ms": 0.5062787116706211, "mean_env_wait_ms": 0.32399018839660215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014674186706542969, "StateBufferConnector_ms": 0.020574212074279785, "ViewRequirementAgentConnector_ms": 0.13795912265777588}, "num_episodes": 18, "episode_return_max": 391.0, "episode_return_min": -104.0, "episode_return_mean": 160.64, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.448723822685, "num_env_steps_trained_throughput_per_sec": 335.448723822685, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 13228.76, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13228.717, "sample_time_ms": 2207.101, "learn_time_ms": 11004.794, "learn_throughput": 363.478, "synch_weights_time_ms": 14.15}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "e1352_00002", "date": "2024-08-13_19-25-48", "timestamp": 1723591548, "time_this_iter_s": 11.943128824234009, "time_total_s": 1441.5189292430878, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d00a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1441.5189292430878, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 58.99999999999999, "ram_util_percent": 80.61764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6158592223372095, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 0.00010000000000000003, "total_loss": 3.82950536838915, "policy_loss": -0.003307438598546599, "vf_loss": 3.8325133747524687, "vf_explained_var": 0.07492189284354922, "kl": 0.012618222602446237, "entropy": 1.2120095551329315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.553910775238244, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 7.97493253258801, "policy_loss": -0.0008780740580900952, "vf_loss": 7.975806120211486, "vf_explained_var": -0.039009890669868104, "kl": 0.00676725704336703, "entropy": 1.017564205013255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -223.0, "episode_reward_mean": 134.14, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -343.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 175.0}, "policy_reward_mean": {"prey_policy": 43.725, "predator_policy": 23.345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.0, 308.0, 0.0, 321.0, 227.0, 155.0, 323.0, 283.0, 182.0, 191.0, 81.0, 361.0, 161.0, 128.0, 54.0, 194.0, 347.0, 124.0, 356.0, 300.0, 138.0, 334.0, 175.0, 88.0, 134.0, 79.0, 22.0, 184.0, -7.0, 196.0, 330.0, 185.0, 365.0, 338.0, 5.0, 170.0, 0.0, 277.0, 63.0, 167.0, 191.0, 164.0, -25.0, 0.0, 189.0, -104.0, 213.0, 264.0, -12.0, 77.0, 102.0, 293.0, 117.0, 197.0, 203.0, -55.0, 19.0, 90.0, 216.0, 0.0, -57.0, 0.0, 309.0, 188.0, 32.0, 188.0, -66.0, 242.0, -7.0, 266.0, 86.0, -52.0, 287.0, 150.0, 391.0, -98.0, 180.0, 44.0, 211.0, 357.0, 194.0, -36.0, 301.0, 67.0, 140.0, -223.0, -129.0, 278.0, 161.0, 140.0, 178.0, -156.0, -181.0, 191.0, 191.0, -96.0, -158.0, 163.0, -43.0, 129.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [174.0, 0.0, 155.0, 153.0, 0.0, 0.0, 132.0, 189.0, -31.0, 158.0, 149.0, -6.0, 196.0, 97.0, 197.0, 86.0, 0.0, 176.0, 187.0, 0.0, 23.0, -2.0, 200.0, 156.0, -12.0, 167.0, 0.0, 111.0, 0.0, 0.0, 0.0, 194.0, 169.0, 167.0, 88.0, 0.0, 181.0, 166.0, 177.0, 117.0, 101.0, 0.0, 125.0, 189.0, -38.0, 193.0, 37.0, -4.0, 0.0, 124.0, 31.0, 0.0, -23.0, -79.0, 43.0, 98.0, -14.0, 0.0, 196.0, 0.0, 133.0, 180.0, 185.0, 0.0, 188.0, 168.0, 119.0, 200.0, 0.0, 2.0, 155.0, 0.0, 0.0, 0.0, 173.0, 52.0, 0.0, 61.0, 151.0, 0.0, -8.0, 188.0, 157.0, -48.0, 0.0, -50.0, 0.0, 0.0, 189.0, 0.0, -343.0, -7.0, 13.0, 200.0, 112.0, 92.0, -86.0, -38.0, -22.0, 47.0, -2.0, 98.0, 150.0, 143.0, -127.0, 173.0, 200.0, -6.0, 6.0, 151.0, -62.0, -24.0, -2.0, -69.0, -38.0, 8.0, -1.0, 129.0, 0.0, 0.0, -123.0, -79.0, 0.0, 0.0, 119.0, 186.0, -14.0, 195.0, -44.0, -10.0, 38.0, 112.0, -241.0, -4.0, 115.0, 115.0, -22.0, -91.0, 88.0, 155.0, -49.0, 65.0, -178.0, 0.0, 87.0, 170.0, 101.0, 21.0, 199.0, 192.0, -93.0, -110.0, 187.0, -16.0, -325.0, 194.0, 179.0, 32.0, 190.0, 167.0, 199.0, -10.0, -99.0, 0.0, 198.0, 89.0, -28.0, 0.0, -3.0, 51.0, -229.0, -153.0, -139.0, -141.0, 196.0, 82.0, 33.0, 53.0, 128.0, -82.0, -1.0, 108.0, -128.0, -173.0, -211.0, -167.0, 0.0, 191.0, 191.0, 0.0, -229.0, -14.0, -11.0, -319.0, 54.0, 59.0, 0.0, -150.0, -40.0, 149.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 52.0, 48.0, 9.0, 3.0, 30.0, 0.0, 0.0, 0.0, 6.0, 0.0, 4.0, 0.0, 5.0, 55.0, 5.0, 0.0, 0.0, 6.0, 17.0, 0.0, 12.0, 42.0, 0.0, 0.0, 0.0, 11.0, 36.0, 0.0, 0.0, 9.0, 1.0, 5.0, 33.0, 4.0, 6.0, 14.0, 19.0, 1.0, 0.0, 55.0, 0.0, 10.0, 27.0, 21.0, 68.0, 56.0, 39.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 9.0, 0.0, 0.0, 19.0, 3.0, 0.0, 0.0, 15.0, 0.0, 0.0, 52.0, 0.0, 2.0, 0.0, 1.0, 15.0, 7.0, 4.0, 55.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 157.0, 89.0, 0.0, 0.0, 0.0, 60.0, 112.0, 0.0, 36.0, 16.0, 1.0, 5.0, 0.0, 0.0, 71.0, 0.0, 3.0, 0.0, 12.0, 34.0, 0.0, 31.0, 0.0, 90.0, 48.0, 72.0, 56.0, 32.0, 0.0, 0.0, 1.0, 144.0, 0.0, 0.0, 0.0, 4.0, 0.0, 7.0, 5.0, 81.0, 2.0, 36.0, 122.0, 57.0, 0.0, 12.0, 97.0, 9.0, 3.0, 20.0, 5.0, 65.0, 2.0, 124.0, 30.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 105.0, 9.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 63.0, 13.0, 1.0, 51.0, 44.0, 92.0, 0.0, 158.0, 1.0, 15.0, 136.0, 0.0, 0.0, 30.0, 45.0, 0.0, 94.0, 71.0, 0.0, 145.0, 0.0, 37.0, 160.0, 0.0, 0.0, 0.0, 0.0, 7.0, 140.0, 172.0, 0.0, 50.0, 0.0, 107.0, 0.0, 6.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.892496985640185, "mean_inference_ms": 2.8132632216526416, "mean_action_processing_ms": 0.5018636614176155, "mean_env_wait_ms": 0.3237011259680705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014661073684692383, "StateBufferConnector_ms": 0.019344687461853027, "ViewRequirementAgentConnector_ms": 0.13388144969940186}, "num_episodes": 18, "episode_return_max": 391.0, "episode_return_min": -223.0, "episode_return_mean": 134.14, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 349.08000905677955, "num_env_steps_trained_throughput_per_sec": 349.08000905677955, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 12516.37, "restore_workers_time_ms": 0.013, "training_step_time_ms": 12516.328, "sample_time_ms": 2141.856, "learn_time_ms": 10358.094, "learn_throughput": 386.171, "synch_weights_time_ms": 14.258}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "e1352_00002", "date": "2024-08-13_19-26-00", "timestamp": 1723591560, "time_this_iter_s": 11.464735984802246, "time_total_s": 1452.98366522789, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d20280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1452.98366522789, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 54.54375, "ram_util_percent": 76.80625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7435834040796316, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 0.00010000000000000003, "total_loss": 3.554458185478493, "policy_loss": -0.0028654231682478906, "vf_loss": 3.557069287098274, "vf_explained_var": 0.10182245247578495, "kl": 0.010717183798334562, "entropy": 1.1835429933336046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.82849082781209, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 7.984354224028411, "policy_loss": -0.001967179107051047, "vf_loss": 7.9863180670157945, "vf_explained_var": 0.008967433278522794, "kl": 0.005088259715181208, "entropy": 1.0303104563049539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -314.0, "episode_reward_mean": 112.12, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -355.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 186.0}, "policy_reward_mean": {"prey_policy": 26.82, "predator_policy": 29.24}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 300.0, 138.0, 334.0, 175.0, 88.0, 134.0, 79.0, 22.0, 184.0, -7.0, 196.0, 330.0, 185.0, 365.0, 338.0, 5.0, 170.0, 0.0, 277.0, 63.0, 167.0, 191.0, 164.0, -25.0, 0.0, 189.0, -104.0, 213.0, 264.0, -12.0, 77.0, 102.0, 293.0, 117.0, 197.0, 203.0, -55.0, 19.0, 90.0, 216.0, 0.0, -57.0, 0.0, 309.0, 188.0, 32.0, 188.0, -66.0, 242.0, -7.0, 266.0, 86.0, -52.0, 287.0, 150.0, 391.0, -98.0, 180.0, 44.0, 211.0, 357.0, 194.0, -36.0, 301.0, 67.0, 140.0, -223.0, -129.0, 278.0, 161.0, 140.0, 178.0, -156.0, -181.0, 191.0, 191.0, -96.0, -158.0, 163.0, -43.0, 129.0, 188.0, 261.0, 177.0, -208.0, 291.0, 138.0, -143.0, 389.0, -69.0, 51.0, 107.0, -232.0, -314.0, 36.0, 248.0, 151.0, 295.0, 46.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [181.0, 166.0, 177.0, 117.0, 101.0, 0.0, 125.0, 189.0, -38.0, 193.0, 37.0, -4.0, 0.0, 124.0, 31.0, 0.0, -23.0, -79.0, 43.0, 98.0, -14.0, 0.0, 196.0, 0.0, 133.0, 180.0, 185.0, 0.0, 188.0, 168.0, 119.0, 200.0, 0.0, 2.0, 155.0, 0.0, 0.0, 0.0, 173.0, 52.0, 0.0, 61.0, 151.0, 0.0, -8.0, 188.0, 157.0, -48.0, 0.0, -50.0, 0.0, 0.0, 189.0, 0.0, -343.0, -7.0, 13.0, 200.0, 112.0, 92.0, -86.0, -38.0, -22.0, 47.0, -2.0, 98.0, 150.0, 143.0, -127.0, 173.0, 200.0, -6.0, 6.0, 151.0, -62.0, -24.0, -2.0, -69.0, -38.0, 8.0, -1.0, 129.0, 0.0, 0.0, -123.0, -79.0, 0.0, 0.0, 119.0, 186.0, -14.0, 195.0, -44.0, -10.0, 38.0, 112.0, -241.0, -4.0, 115.0, 115.0, -22.0, -91.0, 88.0, 155.0, -49.0, 65.0, -178.0, 0.0, 87.0, 170.0, 101.0, 21.0, 199.0, 192.0, -93.0, -110.0, 187.0, -16.0, -325.0, 194.0, 179.0, 32.0, 190.0, 167.0, 199.0, -10.0, -99.0, 0.0, 198.0, 89.0, -28.0, 0.0, -3.0, 51.0, -229.0, -153.0, -139.0, -141.0, 196.0, 82.0, 33.0, 53.0, 128.0, -82.0, -1.0, 108.0, -128.0, -173.0, -211.0, -167.0, 0.0, 191.0, 191.0, 0.0, -229.0, -14.0, -11.0, -319.0, 54.0, 59.0, 0.0, -150.0, -40.0, 149.0, -10.0, 193.0, 89.0, 172.0, 1.0, 152.0, -337.0, -57.0, 116.0, 175.0, -24.0, 125.0, -131.0, -161.0, 191.0, 198.0, 3.0, -216.0, -242.0, 145.0, 68.0, -58.0, -181.0, -355.0, -271.0, -247.0, -30.0, 0.0, 77.0, 138.0, 133.0, 0.0, 148.0, 115.0, 0.0, -27.0], "policy_predator_policy_reward": [0.0, 9.0, 1.0, 5.0, 33.0, 4.0, 6.0, 14.0, 19.0, 1.0, 0.0, 55.0, 0.0, 10.0, 27.0, 21.0, 68.0, 56.0, 39.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 9.0, 0.0, 0.0, 19.0, 3.0, 0.0, 0.0, 15.0, 0.0, 0.0, 52.0, 0.0, 2.0, 0.0, 1.0, 15.0, 7.0, 4.0, 55.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 157.0, 89.0, 0.0, 0.0, 0.0, 60.0, 112.0, 0.0, 36.0, 16.0, 1.0, 5.0, 0.0, 0.0, 71.0, 0.0, 3.0, 0.0, 12.0, 34.0, 0.0, 31.0, 0.0, 90.0, 48.0, 72.0, 56.0, 32.0, 0.0, 0.0, 1.0, 144.0, 0.0, 0.0, 0.0, 4.0, 0.0, 7.0, 5.0, 81.0, 2.0, 36.0, 122.0, 57.0, 0.0, 12.0, 97.0, 9.0, 3.0, 20.0, 5.0, 65.0, 2.0, 124.0, 30.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 105.0, 9.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 63.0, 13.0, 1.0, 51.0, 44.0, 92.0, 0.0, 158.0, 1.0, 15.0, 136.0, 0.0, 0.0, 30.0, 45.0, 0.0, 94.0, 71.0, 0.0, 145.0, 0.0, 37.0, 160.0, 0.0, 0.0, 0.0, 0.0, 7.0, 140.0, 172.0, 0.0, 50.0, 0.0, 107.0, 0.0, 6.0, 14.0, 0.0, 5.0, 0.0, 0.0, 8.0, 16.0, 186.0, 0.0, 0.0, 0.0, 0.0, 37.0, 0.0, 149.0, 0.0, 0.0, 11.0, 133.0, 147.0, 1.0, 0.0, 97.0, 137.0, 167.0, 55.0, 149.0, 21.0, 45.0, 5.0, 28.0, 0.0, 18.0, 0.0, 32.0, 8.0, 65.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8914264599433959, "mean_inference_ms": 2.809471491121416, "mean_action_processing_ms": 0.497430760101119, "mean_env_wait_ms": 0.3230474702018425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006795406341552734, "StateBufferConnector_ms": 0.01923549175262451, "ViewRequirementAgentConnector_ms": 0.13163363933563232}, "num_episodes": 18, "episode_return_max": 391.0, "episode_return_min": -314.0, "episode_return_mean": 112.12, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 357.25819439386765, "num_env_steps_trained_throughput_per_sec": 357.25819439386765, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 12020.767, "restore_workers_time_ms": 0.013, "training_step_time_ms": 12020.725, "sample_time_ms": 1901.434, "learn_time_ms": 10103.557, "learn_throughput": 395.9, "synch_weights_time_ms": 14.058}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "e1352_00002", "date": "2024-08-13_19-26-11", "timestamp": 1723591571, "time_this_iter_s": 11.201253890991211, "time_total_s": 1464.1849191188812, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d20430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1464.1849191188812, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 51.5125, "ram_util_percent": 76.45625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.225615306277439, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 0.00010000000000000003, "total_loss": 3.4128529398529617, "policy_loss": -0.0026090593722762254, "vf_loss": 3.4153041554506496, "vf_explained_var": 0.05314754673412868, "kl": 0.006651805127328551, "entropy": 1.169453722774667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.481934087207076, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 7.020653169874161, "policy_loss": -0.0008218177354022387, "vf_loss": 7.02147107830754, "vf_explained_var": 0.045947718935668784, "kl": 0.005945737192692473, "entropy": 1.0852405649959727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -314.0, "episode_reward_mean": 96.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -355.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 186.0}, "policy_reward_mean": {"prey_policy": 14.74, "predator_policy": 33.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [191.0, 164.0, -25.0, 0.0, 189.0, -104.0, 213.0, 264.0, -12.0, 77.0, 102.0, 293.0, 117.0, 197.0, 203.0, -55.0, 19.0, 90.0, 216.0, 0.0, -57.0, 0.0, 309.0, 188.0, 32.0, 188.0, -66.0, 242.0, -7.0, 266.0, 86.0, -52.0, 287.0, 150.0, 391.0, -98.0, 180.0, 44.0, 211.0, 357.0, 194.0, -36.0, 301.0, 67.0, 140.0, -223.0, -129.0, 278.0, 161.0, 140.0, 178.0, -156.0, -181.0, 191.0, 191.0, -96.0, -158.0, 163.0, -43.0, 129.0, 188.0, 261.0, 177.0, -208.0, 291.0, 138.0, -143.0, 389.0, -69.0, 51.0, 107.0, -232.0, -314.0, 36.0, 248.0, 151.0, 295.0, 46.0, -49.0, -2.0, 76.0, 274.0, 196.0, 122.0, 361.0, 169.0, -308.0, 190.0, 75.0, 194.0, 68.0, 292.0, 263.0, -147.0, 7.0, 150.0, -29.0, -39.0, 371.0, 54.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.0, 188.0, 157.0, -48.0, 0.0, -50.0, 0.0, 0.0, 189.0, 0.0, -343.0, -7.0, 13.0, 200.0, 112.0, 92.0, -86.0, -38.0, -22.0, 47.0, -2.0, 98.0, 150.0, 143.0, -127.0, 173.0, 200.0, -6.0, 6.0, 151.0, -62.0, -24.0, -2.0, -69.0, -38.0, 8.0, -1.0, 129.0, 0.0, 0.0, -123.0, -79.0, 0.0, 0.0, 119.0, 186.0, -14.0, 195.0, -44.0, -10.0, 38.0, 112.0, -241.0, -4.0, 115.0, 115.0, -22.0, -91.0, 88.0, 155.0, -49.0, 65.0, -178.0, 0.0, 87.0, 170.0, 101.0, 21.0, 199.0, 192.0, -93.0, -110.0, 187.0, -16.0, -325.0, 194.0, 179.0, 32.0, 190.0, 167.0, 199.0, -10.0, -99.0, 0.0, 198.0, 89.0, -28.0, 0.0, -3.0, 51.0, -229.0, -153.0, -139.0, -141.0, 196.0, 82.0, 33.0, 53.0, 128.0, -82.0, -1.0, 108.0, -128.0, -173.0, -211.0, -167.0, 0.0, 191.0, 191.0, 0.0, -229.0, -14.0, -11.0, -319.0, 54.0, 59.0, 0.0, -150.0, -40.0, 149.0, -10.0, 193.0, 89.0, 172.0, 1.0, 152.0, -337.0, -57.0, 116.0, 175.0, -24.0, 125.0, -131.0, -161.0, 191.0, 198.0, 3.0, -216.0, -242.0, 145.0, 68.0, -58.0, -181.0, -355.0, -271.0, -247.0, -30.0, 0.0, 77.0, 138.0, 133.0, 0.0, 148.0, 115.0, 0.0, -27.0, -131.0, 0.0, 0.0, -101.0, 34.0, 0.0, 42.0, 192.0, 0.0, 196.0, 101.0, -14.0, 172.0, 189.0, 156.0, -14.0, -311.0, -194.0, 44.0, 92.0, 0.0, 18.0, 194.0, 0.0, -13.0, 5.0, 142.0, 124.0, 109.0, 126.0, 0.0, -306.0, -236.0, 96.0, 142.0, -90.0, -4.0, -54.0, -154.0, -2.0, 176.0, 193.0, 52.0, 0.0], "policy_predator_policy_reward": [7.0, 4.0, 55.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 157.0, 89.0, 0.0, 0.0, 0.0, 60.0, 112.0, 0.0, 36.0, 16.0, 1.0, 5.0, 0.0, 0.0, 71.0, 0.0, 3.0, 0.0, 12.0, 34.0, 0.0, 31.0, 0.0, 90.0, 48.0, 72.0, 56.0, 32.0, 0.0, 0.0, 1.0, 144.0, 0.0, 0.0, 0.0, 4.0, 0.0, 7.0, 5.0, 81.0, 2.0, 36.0, 122.0, 57.0, 0.0, 12.0, 97.0, 9.0, 3.0, 20.0, 5.0, 65.0, 2.0, 124.0, 30.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 105.0, 9.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 63.0, 13.0, 1.0, 51.0, 44.0, 92.0, 0.0, 158.0, 1.0, 15.0, 136.0, 0.0, 0.0, 30.0, 45.0, 0.0, 94.0, 71.0, 0.0, 145.0, 0.0, 37.0, 160.0, 0.0, 0.0, 0.0, 0.0, 7.0, 140.0, 172.0, 0.0, 50.0, 0.0, 107.0, 0.0, 6.0, 14.0, 0.0, 5.0, 0.0, 0.0, 8.0, 16.0, 186.0, 0.0, 0.0, 0.0, 0.0, 37.0, 0.0, 149.0, 0.0, 0.0, 11.0, 133.0, 147.0, 1.0, 0.0, 97.0, 137.0, 167.0, 55.0, 149.0, 21.0, 45.0, 5.0, 28.0, 0.0, 18.0, 0.0, 32.0, 8.0, 65.0, 82.0, 0.0, 0.0, 99.0, 42.0, 0.0, 40.0, 0.0, 0.0, 0.0, 28.0, 7.0, 0.0, 0.0, 16.0, 11.0, 19.0, 178.0, 54.0, 0.0, 57.0, 0.0, 0.0, 0.0, 43.0, 33.0, 13.0, 13.0, 28.0, 0.0, 0.0, 159.0, 9.0, 138.0, 11.0, 87.0, 24.0, 5.0, 5.0, 112.0, 0.0, 2.0, 2.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8861029430087083, "mean_inference_ms": 2.7908111025954794, "mean_action_processing_ms": 0.49092276695210996, "mean_env_wait_ms": 0.3203782203907854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007034420967102051, "StateBufferConnector_ms": 0.013830304145812988, "ViewRequirementAgentConnector_ms": 0.11430370807647705}, "num_episodes": 22, "episode_return_max": 391.0, "episode_return_min": -314.0, "episode_return_mean": 96.01, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.96003511536685, "num_env_steps_trained_throughput_per_sec": 347.96003511536685, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 11949.284, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11949.239, "sample_time_ms": 1865.317, "learn_time_ms": 10067.778, "learn_throughput": 397.307, "synch_weights_time_ms": 14.544}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "e1352_00002", "date": "2024-08-13_19-26-22", "timestamp": 1723591582, "time_this_iter_s": 11.503257036209106, "time_total_s": 1475.6881761550903, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d00a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1475.6881761550903, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 50.2375, "ram_util_percent": 76.88125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9267327389862172, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 0.00010000000000000003, "total_loss": 3.913899923758532, "policy_loss": -0.007466496212319249, "vf_loss": 3.920789254279364, "vf_explained_var": 0.07124278207935353, "kl": 0.024322036189236555, "entropy": 1.1658816747564487, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.85277719183889, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 7.47872780643443, "policy_loss": -0.0019284093461773067, "vf_loss": 7.480649714999728, "vf_explained_var": -0.06692490325402961, "kl": 0.009867903860296665, "entropy": 1.060682105071961, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -314.0, "episode_reward_mean": 94.79, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -379.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": 11.42, "predator_policy": 35.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [188.0, 32.0, 188.0, -66.0, 242.0, -7.0, 266.0, 86.0, -52.0, 287.0, 150.0, 391.0, -98.0, 180.0, 44.0, 211.0, 357.0, 194.0, -36.0, 301.0, 67.0, 140.0, -223.0, -129.0, 278.0, 161.0, 140.0, 178.0, -156.0, -181.0, 191.0, 191.0, -96.0, -158.0, 163.0, -43.0, 129.0, 188.0, 261.0, 177.0, -208.0, 291.0, 138.0, -143.0, 389.0, -69.0, 51.0, 107.0, -232.0, -314.0, 36.0, 248.0, 151.0, 295.0, 46.0, -49.0, -2.0, 76.0, 274.0, 196.0, 122.0, 361.0, 169.0, -308.0, 190.0, 75.0, 194.0, 68.0, 292.0, 263.0, -147.0, 7.0, 150.0, -29.0, -39.0, 371.0, 54.0, 199.0, 129.0, -200.0, -31.0, -79.0, -72.0, 112.0, 72.0, 244.0, 370.0, -55.0, 117.0, 144.0, 184.0, -101.0, 187.0, 134.0, 241.0, -24.0, 385.0, 110.0, 180.0, 23.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.0, 195.0, -44.0, -10.0, 38.0, 112.0, -241.0, -4.0, 115.0, 115.0, -22.0, -91.0, 88.0, 155.0, -49.0, 65.0, -178.0, 0.0, 87.0, 170.0, 101.0, 21.0, 199.0, 192.0, -93.0, -110.0, 187.0, -16.0, -325.0, 194.0, 179.0, 32.0, 190.0, 167.0, 199.0, -10.0, -99.0, 0.0, 198.0, 89.0, -28.0, 0.0, -3.0, 51.0, -229.0, -153.0, -139.0, -141.0, 196.0, 82.0, 33.0, 53.0, 128.0, -82.0, -1.0, 108.0, -128.0, -173.0, -211.0, -167.0, 0.0, 191.0, 191.0, 0.0, -229.0, -14.0, -11.0, -319.0, 54.0, 59.0, 0.0, -150.0, -40.0, 149.0, -10.0, 193.0, 89.0, 172.0, 1.0, 152.0, -337.0, -57.0, 116.0, 175.0, -24.0, 125.0, -131.0, -161.0, 191.0, 198.0, 3.0, -216.0, -242.0, 145.0, 68.0, -58.0, -181.0, -355.0, -271.0, -247.0, -30.0, 0.0, 77.0, 138.0, 133.0, 0.0, 148.0, 115.0, 0.0, -27.0, -131.0, 0.0, 0.0, -101.0, 34.0, 0.0, 42.0, 192.0, 0.0, 196.0, 101.0, -14.0, 172.0, 189.0, 156.0, -14.0, -311.0, -194.0, 44.0, 92.0, 0.0, 18.0, 194.0, 0.0, -13.0, 5.0, 142.0, 124.0, 109.0, 126.0, 0.0, -306.0, -236.0, 96.0, 142.0, -90.0, -4.0, -54.0, -154.0, -2.0, 176.0, 193.0, 52.0, 0.0, 0.0, 199.0, -2.0, 104.0, -130.0, -264.0, 0.0, -158.0, 0.0, -192.0, 106.0, -379.0, 0.0, 112.0, 20.0, -4.0, 116.0, 107.0, 200.0, 155.0, 67.0, -362.0, 0.0, 89.0, 50.0, 72.0, 14.0, 110.0, -153.0, -85.0, 187.0, 0.0, -115.0, 132.0, 156.0, 11.0, -81.0, -59.0, 193.0, 192.0, -26.0, 64.0, 0.0, 180.0, -64.0, 0.0], "policy_predator_policy_reward": [0.0, 7.0, 5.0, 81.0, 2.0, 36.0, 122.0, 57.0, 0.0, 12.0, 97.0, 9.0, 3.0, 20.0, 5.0, 65.0, 2.0, 124.0, 30.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 105.0, 9.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 63.0, 13.0, 1.0, 51.0, 44.0, 92.0, 0.0, 158.0, 1.0, 15.0, 136.0, 0.0, 0.0, 30.0, 45.0, 0.0, 94.0, 71.0, 0.0, 145.0, 0.0, 37.0, 160.0, 0.0, 0.0, 0.0, 0.0, 7.0, 140.0, 172.0, 0.0, 50.0, 0.0, 107.0, 0.0, 6.0, 14.0, 0.0, 5.0, 0.0, 0.0, 8.0, 16.0, 186.0, 0.0, 0.0, 0.0, 0.0, 37.0, 0.0, 149.0, 0.0, 0.0, 11.0, 133.0, 147.0, 1.0, 0.0, 97.0, 137.0, 167.0, 55.0, 149.0, 21.0, 45.0, 5.0, 28.0, 0.0, 18.0, 0.0, 32.0, 8.0, 65.0, 82.0, 0.0, 0.0, 99.0, 42.0, 0.0, 40.0, 0.0, 0.0, 0.0, 28.0, 7.0, 0.0, 0.0, 16.0, 11.0, 19.0, 178.0, 54.0, 0.0, 57.0, 0.0, 0.0, 0.0, 43.0, 33.0, 13.0, 13.0, 28.0, 0.0, 0.0, 159.0, 9.0, 138.0, 11.0, 87.0, 24.0, 5.0, 5.0, 112.0, 0.0, 2.0, 2.0, 0.0, 0.0, 0.0, 1.0, 26.0, 2.0, 192.0, 17.0, 110.0, 0.0, 113.0, 5.0, 196.0, 0.0, 0.0, 13.0, 43.0, 0.0, 21.0, 0.0, 15.0, 193.0, 47.0, 28.0, 0.0, 22.0, 0.0, 0.0, 60.0, 106.0, 31.0, 0.0, 0.0, 0.0, 117.0, 63.0, 11.0, 20.0, 96.0, 0.0, 0.0, 0.0, 72.0, 0.0, 0.0, 87.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.879708815839549, "mean_inference_ms": 2.774371389652178, "mean_action_processing_ms": 0.48361073460761567, "mean_env_wait_ms": 0.3177069958632748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004513144493103027, "StateBufferConnector_ms": 0.0033730268478393555, "ViewRequirementAgentConnector_ms": 0.11471354961395264}, "num_episodes": 23, "episode_return_max": 391.0, "episode_return_min": -314.0, "episode_return_mean": 94.79, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.89630739765613, "num_env_steps_trained_throughput_per_sec": 346.89630739765613, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 11901.909, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11901.863, "sample_time_ms": 1838.973, "learn_time_ms": 10046.107, "learn_throughput": 398.164, "synch_weights_time_ms": 15.052}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "e1352_00002", "date": "2024-08-13_19-26-34", "timestamp": 1723591594, "time_this_iter_s": 11.582118034362793, "time_total_s": 1487.2702941894531, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb34c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1487.2702941894531, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 51.11176470588236, "ram_util_percent": 79.61176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9102136341115785, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 3.3399710050966376, "policy_loss": -0.0023196529434432113, "vf_loss": 3.3419420339443064, "vf_explained_var": 0.09012554508668405, "kl": 0.009793997860761346, "entropy": 1.2415223110920537, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.650626410315276, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 8.419246124590515, "policy_loss": -0.0013628751454658058, "vf_loss": 8.420601584671667, "vf_explained_var": 0.05342808201830223, "kl": 0.011234832367367331, "entropy": 0.9399519355839523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": -314.0, "episode_reward_mean": 99.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -379.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": 13.03, "predator_policy": 36.655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-36.0, 301.0, 67.0, 140.0, -223.0, -129.0, 278.0, 161.0, 140.0, 178.0, -156.0, -181.0, 191.0, 191.0, -96.0, -158.0, 163.0, -43.0, 129.0, 188.0, 261.0, 177.0, -208.0, 291.0, 138.0, -143.0, 389.0, -69.0, 51.0, 107.0, -232.0, -314.0, 36.0, 248.0, 151.0, 295.0, 46.0, -49.0, -2.0, 76.0, 274.0, 196.0, 122.0, 361.0, 169.0, -308.0, 190.0, 75.0, 194.0, 68.0, 292.0, 263.0, -147.0, 7.0, 150.0, -29.0, -39.0, 371.0, 54.0, 199.0, 129.0, -200.0, -31.0, -79.0, -72.0, 112.0, 72.0, 244.0, 370.0, -55.0, 117.0, 144.0, 184.0, -101.0, 187.0, 134.0, 241.0, -24.0, 385.0, 110.0, 180.0, 23.0, 371.0, 133.0, 225.0, 388.0, 140.0, 310.0, -26.0, 142.0, 93.0, 206.0, 162.0, 245.0, 108.0, 309.0, 159.0, 190.0, -243.0, 139.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-99.0, 0.0, 198.0, 89.0, -28.0, 0.0, -3.0, 51.0, -229.0, -153.0, -139.0, -141.0, 196.0, 82.0, 33.0, 53.0, 128.0, -82.0, -1.0, 108.0, -128.0, -173.0, -211.0, -167.0, 0.0, 191.0, 191.0, 0.0, -229.0, -14.0, -11.0, -319.0, 54.0, 59.0, 0.0, -150.0, -40.0, 149.0, -10.0, 193.0, 89.0, 172.0, 1.0, 152.0, -337.0, -57.0, 116.0, 175.0, -24.0, 125.0, -131.0, -161.0, 191.0, 198.0, 3.0, -216.0, -242.0, 145.0, 68.0, -58.0, -181.0, -355.0, -271.0, -247.0, -30.0, 0.0, 77.0, 138.0, 133.0, 0.0, 148.0, 115.0, 0.0, -27.0, -131.0, 0.0, 0.0, -101.0, 34.0, 0.0, 42.0, 192.0, 0.0, 196.0, 101.0, -14.0, 172.0, 189.0, 156.0, -14.0, -311.0, -194.0, 44.0, 92.0, 0.0, 18.0, 194.0, 0.0, -13.0, 5.0, 142.0, 124.0, 109.0, 126.0, 0.0, -306.0, -236.0, 96.0, 142.0, -90.0, -4.0, -54.0, -154.0, -2.0, 176.0, 193.0, 52.0, 0.0, 0.0, 199.0, -2.0, 104.0, -130.0, -264.0, 0.0, -158.0, 0.0, -192.0, 106.0, -379.0, 0.0, 112.0, 20.0, -4.0, 116.0, 107.0, 200.0, 155.0, 67.0, -362.0, 0.0, 89.0, 50.0, 72.0, 14.0, 110.0, -153.0, -85.0, 187.0, 0.0, -115.0, 132.0, 156.0, 11.0, -81.0, -59.0, 193.0, 192.0, -26.0, 64.0, 0.0, 180.0, -64.0, 0.0, 199.0, 172.0, 160.0, -132.0, 105.0, 97.0, 200.0, 188.0, -55.0, 110.0, 184.0, 94.0, -214.0, 50.0, 175.0, -128.0, 40.0, 0.0, 63.0, 78.0, 162.0, 0.0, 27.0, 175.0, 94.0, -70.0, 121.0, 152.0, 162.0, -26.0, 119.0, 71.0, -249.0, -343.0, 135.0, 0.0], "policy_predator_policy_reward": [0.0, 63.0, 13.0, 1.0, 51.0, 44.0, 92.0, 0.0, 158.0, 1.0, 15.0, 136.0, 0.0, 0.0, 30.0, 45.0, 0.0, 94.0, 71.0, 0.0, 145.0, 0.0, 37.0, 160.0, 0.0, 0.0, 0.0, 0.0, 7.0, 140.0, 172.0, 0.0, 50.0, 0.0, 107.0, 0.0, 6.0, 14.0, 0.0, 5.0, 0.0, 0.0, 8.0, 16.0, 186.0, 0.0, 0.0, 0.0, 0.0, 37.0, 0.0, 149.0, 0.0, 0.0, 11.0, 133.0, 147.0, 1.0, 0.0, 97.0, 137.0, 167.0, 55.0, 149.0, 21.0, 45.0, 5.0, 28.0, 0.0, 18.0, 0.0, 32.0, 8.0, 65.0, 82.0, 0.0, 0.0, 99.0, 42.0, 0.0, 40.0, 0.0, 0.0, 0.0, 28.0, 7.0, 0.0, 0.0, 16.0, 11.0, 19.0, 178.0, 54.0, 0.0, 57.0, 0.0, 0.0, 0.0, 43.0, 33.0, 13.0, 13.0, 28.0, 0.0, 0.0, 159.0, 9.0, 138.0, 11.0, 87.0, 24.0, 5.0, 5.0, 112.0, 0.0, 2.0, 2.0, 0.0, 0.0, 0.0, 1.0, 26.0, 2.0, 192.0, 17.0, 110.0, 0.0, 113.0, 5.0, 196.0, 0.0, 0.0, 13.0, 43.0, 0.0, 21.0, 0.0, 15.0, 193.0, 47.0, 28.0, 0.0, 22.0, 0.0, 0.0, 60.0, 106.0, 31.0, 0.0, 0.0, 0.0, 117.0, 63.0, 11.0, 20.0, 96.0, 0.0, 0.0, 0.0, 72.0, 0.0, 0.0, 87.0, 0.0, 0.0, 0.0, 14.0, 91.0, 0.0, 23.0, 0.0, 0.0, 85.0, 0.0, 0.0, 32.0, 1.0, 137.0, 18.0, 77.0, 53.0, 0.0, 55.0, 10.0, 0.0, 0.0, 1.0, 42.0, 84.0, 0.0, 0.0, 36.0, 10.0, 13.0, 0.0, 0.0, 179.0, 170.0, 0.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8741507678822709, "mean_inference_ms": 2.7566518006715706, "mean_action_processing_ms": 0.47803818105124085, "mean_env_wait_ms": 0.3152193743741603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004485726356506348, "StateBufferConnector_ms": 0.0033701658248901367, "ViewRequirementAgentConnector_ms": 0.11456084251403809}, "num_episodes": 18, "episode_return_max": 389.0, "episode_return_min": -314.0, "episode_return_mean": 99.37, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 338.56958824155714, "num_env_steps_trained_throughput_per_sec": 338.56958824155714, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 11928.914, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11928.868, "sample_time_ms": 1812.608, "learn_time_ms": 10098.63, "learn_throughput": 396.093, "synch_weights_time_ms": 15.737}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "e1352_00002", "date": "2024-08-13_19-26-46", "timestamp": 1723591606, "time_this_iter_s": 11.907110214233398, "time_total_s": 1499.1774044036865, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d62670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1499.1774044036865, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 50.25882352941176, "ram_util_percent": 81.07058823529411}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.258101441478603, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 3.3785299293578617, "policy_loss": -0.002487109817327961, "vf_loss": 3.3803792525851537, "vf_explained_var": 0.0990759326036645, "kl": 0.017917592179009064, "entropy": 1.2079641503631753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.094139042496682, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 7.265491218920107, "policy_loss": -0.0005988847796938249, "vf_loss": 7.266082643327259, "vf_explained_var": 0.11055686726141228, "kl": 0.01135261049386123, "entropy": 1.0042761233748583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": -314.0, "episode_reward_mean": 115.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -379.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": 23.825, "predator_policy": 33.835}, "custom_metrics": {}, "hist_stats": {"episode_reward": [129.0, 188.0, 261.0, 177.0, -208.0, 291.0, 138.0, -143.0, 389.0, -69.0, 51.0, 107.0, -232.0, -314.0, 36.0, 248.0, 151.0, 295.0, 46.0, -49.0, -2.0, 76.0, 274.0, 196.0, 122.0, 361.0, 169.0, -308.0, 190.0, 75.0, 194.0, 68.0, 292.0, 263.0, -147.0, 7.0, 150.0, -29.0, -39.0, 371.0, 54.0, 199.0, 129.0, -200.0, -31.0, -79.0, -72.0, 112.0, 72.0, 244.0, 370.0, -55.0, 117.0, 144.0, 184.0, -101.0, 187.0, 134.0, 241.0, -24.0, 385.0, 110.0, 180.0, 23.0, 371.0, 133.0, 225.0, 388.0, 140.0, 310.0, -26.0, 142.0, 93.0, 206.0, 162.0, 245.0, 108.0, 309.0, 159.0, 190.0, -243.0, 139.0, -179.0, 335.0, 314.0, 158.0, 318.0, -22.0, -107.0, 54.0, 132.0, 58.0, 264.0, 199.0, 161.0, 263.0, 255.0, 92.0, -192.0, 280.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-40.0, 149.0, -10.0, 193.0, 89.0, 172.0, 1.0, 152.0, -337.0, -57.0, 116.0, 175.0, -24.0, 125.0, -131.0, -161.0, 191.0, 198.0, 3.0, -216.0, -242.0, 145.0, 68.0, -58.0, -181.0, -355.0, -271.0, -247.0, -30.0, 0.0, 77.0, 138.0, 133.0, 0.0, 148.0, 115.0, 0.0, -27.0, -131.0, 0.0, 0.0, -101.0, 34.0, 0.0, 42.0, 192.0, 0.0, 196.0, 101.0, -14.0, 172.0, 189.0, 156.0, -14.0, -311.0, -194.0, 44.0, 92.0, 0.0, 18.0, 194.0, 0.0, -13.0, 5.0, 142.0, 124.0, 109.0, 126.0, 0.0, -306.0, -236.0, 96.0, 142.0, -90.0, -4.0, -54.0, -154.0, -2.0, 176.0, 193.0, 52.0, 0.0, 0.0, 199.0, -2.0, 104.0, -130.0, -264.0, 0.0, -158.0, 0.0, -192.0, 106.0, -379.0, 0.0, 112.0, 20.0, -4.0, 116.0, 107.0, 200.0, 155.0, 67.0, -362.0, 0.0, 89.0, 50.0, 72.0, 14.0, 110.0, -153.0, -85.0, 187.0, 0.0, -115.0, 132.0, 156.0, 11.0, -81.0, -59.0, 193.0, 192.0, -26.0, 64.0, 0.0, 180.0, -64.0, 0.0, 199.0, 172.0, 160.0, -132.0, 105.0, 97.0, 200.0, 188.0, -55.0, 110.0, 184.0, 94.0, -214.0, 50.0, 175.0, -128.0, 40.0, 0.0, 63.0, 78.0, 162.0, 0.0, 27.0, 175.0, 94.0, -70.0, 121.0, 152.0, 162.0, -26.0, 119.0, 71.0, -249.0, -343.0, 135.0, 0.0, -138.0, -225.0, 179.0, 134.0, 110.0, 165.0, 139.0, 0.0, 200.0, 118.0, -44.0, 0.0, -102.0, -180.0, -19.0, 0.0, 0.0, 123.0, 0.0, 0.0, 78.0, 179.0, 187.0, 12.0, 0.0, 142.0, 121.0, 113.0, 157.0, 47.0, -140.0, 162.0, -355.0, -82.0, 68.0, 166.0], "policy_predator_policy_reward": [6.0, 14.0, 0.0, 5.0, 0.0, 0.0, 8.0, 16.0, 186.0, 0.0, 0.0, 0.0, 0.0, 37.0, 0.0, 149.0, 0.0, 0.0, 11.0, 133.0, 147.0, 1.0, 0.0, 97.0, 137.0, 167.0, 55.0, 149.0, 21.0, 45.0, 5.0, 28.0, 0.0, 18.0, 0.0, 32.0, 8.0, 65.0, 82.0, 0.0, 0.0, 99.0, 42.0, 0.0, 40.0, 0.0, 0.0, 0.0, 28.0, 7.0, 0.0, 0.0, 16.0, 11.0, 19.0, 178.0, 54.0, 0.0, 57.0, 0.0, 0.0, 0.0, 43.0, 33.0, 13.0, 13.0, 28.0, 0.0, 0.0, 159.0, 9.0, 138.0, 11.0, 87.0, 24.0, 5.0, 5.0, 112.0, 0.0, 2.0, 2.0, 0.0, 0.0, 0.0, 1.0, 26.0, 2.0, 192.0, 17.0, 110.0, 0.0, 113.0, 5.0, 196.0, 0.0, 0.0, 13.0, 43.0, 0.0, 21.0, 0.0, 15.0, 193.0, 47.0, 28.0, 0.0, 22.0, 0.0, 0.0, 60.0, 106.0, 31.0, 0.0, 0.0, 0.0, 117.0, 63.0, 11.0, 20.0, 96.0, 0.0, 0.0, 0.0, 72.0, 0.0, 0.0, 87.0, 0.0, 0.0, 0.0, 14.0, 91.0, 0.0, 23.0, 0.0, 0.0, 85.0, 0.0, 0.0, 32.0, 1.0, 137.0, 18.0, 77.0, 53.0, 0.0, 55.0, 10.0, 0.0, 0.0, 1.0, 42.0, 84.0, 0.0, 0.0, 36.0, 10.0, 13.0, 0.0, 0.0, 179.0, 170.0, 0.0, 4.0, 63.0, 121.0, 22.0, 0.0, 31.0, 8.0, 7.0, 12.0, 0.0, 0.0, 0.0, 22.0, 36.0, 139.0, 0.0, 73.0, 1.0, 8.0, 0.0, 58.0, 0.0, 7.0, 0.0, 0.0, 6.0, 13.0, 0.0, 29.0, 0.0, 51.0, 70.0, 0.0, 193.0, 52.0, 46.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8701297475518903, "mean_inference_ms": 2.7456960626158433, "mean_action_processing_ms": 0.47343757391609853, "mean_env_wait_ms": 0.3137148583675435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00480961799621582, "StateBufferConnector_ms": 0.003406047821044922, "ViewRequirementAgentConnector_ms": 0.11556732654571533}, "num_episodes": 18, "episode_return_max": 389.0, "episode_return_min": -314.0, "episode_return_mean": 115.32, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.54353805076227, "num_env_steps_trained_throughput_per_sec": 278.54353805076227, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 12152.089, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12152.04, "sample_time_ms": 1846.367, "learn_time_ms": 10288.469, "learn_throughput": 388.785, "synch_weights_time_ms": 14.857}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "e1352_00002", "date": "2024-08-13_19-27-00", "timestamp": 1723591620, "time_this_iter_s": 14.413019895553589, "time_total_s": 1513.59042429924, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d628b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1513.59042429924, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 66.82000000000001, "ram_util_percent": 83.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4437829436685043, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 4.365152885800316, "policy_loss": -0.002377941527418674, "vf_loss": 4.367069002307912, "vf_explained_var": 0.09006165707552874, "kl": 0.012973793066856656, "entropy": 1.1311682792567703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.688661138926232, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 7.85566269380075, "policy_loss": -0.0002323949062782857, "vf_loss": 7.855889771476624, "vf_explained_var": -0.13736392578119955, "kl": 0.008071512460804139, "entropy": 0.9646273152222709, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 388.0, "episode_reward_min": -318.0, "episode_reward_mean": 121.42, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -379.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": 28.005, "predator_policy": 32.705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [274.0, 196.0, 122.0, 361.0, 169.0, -308.0, 190.0, 75.0, 194.0, 68.0, 292.0, 263.0, -147.0, 7.0, 150.0, -29.0, -39.0, 371.0, 54.0, 199.0, 129.0, -200.0, -31.0, -79.0, -72.0, 112.0, 72.0, 244.0, 370.0, -55.0, 117.0, 144.0, 184.0, -101.0, 187.0, 134.0, 241.0, -24.0, 385.0, 110.0, 180.0, 23.0, 371.0, 133.0, 225.0, 388.0, 140.0, 310.0, -26.0, 142.0, 93.0, 206.0, 162.0, 245.0, 108.0, 309.0, 159.0, 190.0, -243.0, 139.0, -179.0, 335.0, 314.0, 158.0, 318.0, -22.0, -107.0, 54.0, 132.0, 58.0, 264.0, 199.0, 161.0, 263.0, 255.0, 92.0, -192.0, 280.0, 270.0, 59.0, 255.0, -318.0, -8.0, 158.0, 344.0, 257.0, 81.0, 193.0, -111.0, 75.0, 221.0, 35.0, 19.0, -21.0, 298.0, 131.0, 46.0, 67.0, 123.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [42.0, 192.0, 0.0, 196.0, 101.0, -14.0, 172.0, 189.0, 156.0, -14.0, -311.0, -194.0, 44.0, 92.0, 0.0, 18.0, 194.0, 0.0, -13.0, 5.0, 142.0, 124.0, 109.0, 126.0, 0.0, -306.0, -236.0, 96.0, 142.0, -90.0, -4.0, -54.0, -154.0, -2.0, 176.0, 193.0, 52.0, 0.0, 0.0, 199.0, -2.0, 104.0, -130.0, -264.0, 0.0, -158.0, 0.0, -192.0, 106.0, -379.0, 0.0, 112.0, 20.0, -4.0, 116.0, 107.0, 200.0, 155.0, 67.0, -362.0, 0.0, 89.0, 50.0, 72.0, 14.0, 110.0, -153.0, -85.0, 187.0, 0.0, -115.0, 132.0, 156.0, 11.0, -81.0, -59.0, 193.0, 192.0, -26.0, 64.0, 0.0, 180.0, -64.0, 0.0, 199.0, 172.0, 160.0, -132.0, 105.0, 97.0, 200.0, 188.0, -55.0, 110.0, 184.0, 94.0, -214.0, 50.0, 175.0, -128.0, 40.0, 0.0, 63.0, 78.0, 162.0, 0.0, 27.0, 175.0, 94.0, -70.0, 121.0, 152.0, 162.0, -26.0, 119.0, 71.0, -249.0, -343.0, 135.0, 0.0, -138.0, -225.0, 179.0, 134.0, 110.0, 165.0, 139.0, 0.0, 200.0, 118.0, -44.0, 0.0, -102.0, -180.0, -19.0, 0.0, 0.0, 123.0, 0.0, 0.0, 78.0, 179.0, 187.0, 12.0, 0.0, 142.0, 121.0, 113.0, 157.0, 47.0, -140.0, 162.0, -355.0, -82.0, 68.0, 166.0, 115.0, 126.0, -180.0, 101.0, 164.0, 43.0, -367.0, -145.0, -103.0, -26.0, 107.0, -28.0, 145.0, 199.0, 118.0, 97.0, 44.0, -12.0, 135.0, 36.0, -324.0, 41.0, 48.0, 0.0, 143.0, 14.0, -241.0, 125.0, -84.0, 0.0, -104.0, 9.0, 139.0, 134.0, 37.0, 25.0, 0.0, -7.0, 2.0, 33.0, 0.0, 103.0, -23.0, 0.0], "policy_predator_policy_reward": [40.0, 0.0, 0.0, 0.0, 28.0, 7.0, 0.0, 0.0, 16.0, 11.0, 19.0, 178.0, 54.0, 0.0, 57.0, 0.0, 0.0, 0.0, 43.0, 33.0, 13.0, 13.0, 28.0, 0.0, 0.0, 159.0, 9.0, 138.0, 11.0, 87.0, 24.0, 5.0, 5.0, 112.0, 0.0, 2.0, 2.0, 0.0, 0.0, 0.0, 1.0, 26.0, 2.0, 192.0, 17.0, 110.0, 0.0, 113.0, 5.0, 196.0, 0.0, 0.0, 13.0, 43.0, 0.0, 21.0, 0.0, 15.0, 193.0, 47.0, 28.0, 0.0, 22.0, 0.0, 0.0, 60.0, 106.0, 31.0, 0.0, 0.0, 0.0, 117.0, 63.0, 11.0, 20.0, 96.0, 0.0, 0.0, 0.0, 72.0, 0.0, 0.0, 87.0, 0.0, 0.0, 0.0, 14.0, 91.0, 0.0, 23.0, 0.0, 0.0, 85.0, 0.0, 0.0, 32.0, 1.0, 137.0, 18.0, 77.0, 53.0, 0.0, 55.0, 10.0, 0.0, 0.0, 1.0, 42.0, 84.0, 0.0, 0.0, 36.0, 10.0, 13.0, 0.0, 0.0, 179.0, 170.0, 0.0, 4.0, 63.0, 121.0, 22.0, 0.0, 31.0, 8.0, 7.0, 12.0, 0.0, 0.0, 0.0, 22.0, 36.0, 139.0, 0.0, 73.0, 1.0, 8.0, 0.0, 58.0, 0.0, 7.0, 0.0, 0.0, 6.0, 13.0, 0.0, 29.0, 0.0, 51.0, 70.0, 0.0, 193.0, 52.0, 46.0, 0.0, 25.0, 4.0, 138.0, 0.0, 7.0, 41.0, 0.0, 194.0, 121.0, 0.0, 65.0, 14.0, 0.0, 0.0, 0.0, 42.0, 6.0, 43.0, 18.0, 4.0, 172.0, 0.0, 0.0, 27.0, 0.0, 64.0, 4.0, 147.0, 9.0, 94.0, 74.0, 0.0, 0.0, 25.0, 0.0, 69.0, 0.0, 53.0, 32.0, 0.0, 6.0, 14.0, 0.0, 25.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8657574577515966, "mean_inference_ms": 2.73341072353351, "mean_action_processing_ms": 0.4687065776622655, "mean_env_wait_ms": 0.3122426008923334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004994750022888184, "StateBufferConnector_ms": 0.008098721504211426, "ViewRequirementAgentConnector_ms": 0.1212693452835083}, "num_episodes": 22, "episode_return_max": 388.0, "episode_return_min": -318.0, "episode_return_mean": 121.42, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 349.2181087022026, "num_env_steps_trained_throughput_per_sec": 349.2181087022026, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 12117.681, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12117.632, "sample_time_ms": 1837.514, "learn_time_ms": 10261.341, "learn_throughput": 389.813, "synch_weights_time_ms": 16.54}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "e1352_00002", "date": "2024-08-13_19-27-12", "timestamp": 1723591632, "time_this_iter_s": 11.61387300491333, "time_total_s": 1525.2042973041534, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2cdcdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1525.2042973041534, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 49.15882352941177, "ram_util_percent": 81.51764705882351}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.709431518448724, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 5.263352288140191, "policy_loss": -0.003909443753707425, "vf_loss": 5.266724226083705, "vf_explained_var": 0.06660263462672159, "kl": 0.01510023626573626, "entropy": 1.1110708021613025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.146952336017417, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 8.698728084059619, "policy_loss": -0.0009517672978016355, "vf_loss": 8.699674042696675, "vf_explained_var": -0.0766886212207653, "kl": 0.008744302578564197, "entropy": 0.940209441620206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 388.0, "episode_reward_min": -346.0, "episode_reward_mean": 120.44, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -379.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": 23.785, "predator_policy": 36.435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-79.0, -72.0, 112.0, 72.0, 244.0, 370.0, -55.0, 117.0, 144.0, 184.0, -101.0, 187.0, 134.0, 241.0, -24.0, 385.0, 110.0, 180.0, 23.0, 371.0, 133.0, 225.0, 388.0, 140.0, 310.0, -26.0, 142.0, 93.0, 206.0, 162.0, 245.0, 108.0, 309.0, 159.0, 190.0, -243.0, 139.0, -179.0, 335.0, 314.0, 158.0, 318.0, -22.0, -107.0, 54.0, 132.0, 58.0, 264.0, 199.0, 161.0, 263.0, 255.0, 92.0, -192.0, 280.0, 270.0, 59.0, 255.0, -318.0, -8.0, 158.0, 344.0, 257.0, 81.0, 193.0, -111.0, 75.0, 221.0, 35.0, 19.0, -21.0, 298.0, 131.0, 46.0, 67.0, 123.0, 2.0, -50.0, 229.0, -43.0, 202.0, 218.0, -346.0, 200.0, -15.0, -49.0, 7.0, 3.0, -33.0, 382.0, -1.0, 200.0, 335.0, 237.0, 138.0, 286.0, 157.0, 289.0, -43.0, -41.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -192.0, 106.0, -379.0, 0.0, 112.0, 20.0, -4.0, 116.0, 107.0, 200.0, 155.0, 67.0, -362.0, 0.0, 89.0, 50.0, 72.0, 14.0, 110.0, -153.0, -85.0, 187.0, 0.0, -115.0, 132.0, 156.0, 11.0, -81.0, -59.0, 193.0, 192.0, -26.0, 64.0, 0.0, 180.0, -64.0, 0.0, 199.0, 172.0, 160.0, -132.0, 105.0, 97.0, 200.0, 188.0, -55.0, 110.0, 184.0, 94.0, -214.0, 50.0, 175.0, -128.0, 40.0, 0.0, 63.0, 78.0, 162.0, 0.0, 27.0, 175.0, 94.0, -70.0, 121.0, 152.0, 162.0, -26.0, 119.0, 71.0, -249.0, -343.0, 135.0, 0.0, -138.0, -225.0, 179.0, 134.0, 110.0, 165.0, 139.0, 0.0, 200.0, 118.0, -44.0, 0.0, -102.0, -180.0, -19.0, 0.0, 0.0, 123.0, 0.0, 0.0, 78.0, 179.0, 187.0, 12.0, 0.0, 142.0, 121.0, 113.0, 157.0, 47.0, -140.0, 162.0, -355.0, -82.0, 68.0, 166.0, 115.0, 126.0, -180.0, 101.0, 164.0, 43.0, -367.0, -145.0, -103.0, -26.0, 107.0, -28.0, 145.0, 199.0, 118.0, 97.0, 44.0, -12.0, 135.0, 36.0, -324.0, 41.0, 48.0, 0.0, 143.0, 14.0, -241.0, 125.0, -84.0, 0.0, -104.0, 9.0, 139.0, 134.0, 37.0, 25.0, 0.0, -7.0, 2.0, 33.0, 0.0, 103.0, -23.0, 0.0, -14.0, -347.0, 108.0, 46.0, -18.0, -106.0, -11.0, 176.0, 145.0, 23.0, -365.0, -356.0, 87.0, 103.0, -4.0, -160.0, 43.0, -236.0, 0.0, -44.0, -85.0, -31.0, -69.0, -121.0, 200.0, 173.0, 0.0, -100.0, 0.0, 200.0, 162.0, 157.0, 89.0, 139.0, 112.0, 17.0, 93.0, 157.0, 107.0, -28.0, 100.0, 162.0, -70.0, -125.0, -254.0, 19.0], "policy_predator_policy_reward": [0.0, 113.0, 5.0, 196.0, 0.0, 0.0, 13.0, 43.0, 0.0, 21.0, 0.0, 15.0, 193.0, 47.0, 28.0, 0.0, 22.0, 0.0, 0.0, 60.0, 106.0, 31.0, 0.0, 0.0, 0.0, 117.0, 63.0, 11.0, 20.0, 96.0, 0.0, 0.0, 0.0, 72.0, 0.0, 0.0, 87.0, 0.0, 0.0, 0.0, 14.0, 91.0, 0.0, 23.0, 0.0, 0.0, 85.0, 0.0, 0.0, 32.0, 1.0, 137.0, 18.0, 77.0, 53.0, 0.0, 55.0, 10.0, 0.0, 0.0, 1.0, 42.0, 84.0, 0.0, 0.0, 36.0, 10.0, 13.0, 0.0, 0.0, 179.0, 170.0, 0.0, 4.0, 63.0, 121.0, 22.0, 0.0, 31.0, 8.0, 7.0, 12.0, 0.0, 0.0, 0.0, 22.0, 36.0, 139.0, 0.0, 73.0, 1.0, 8.0, 0.0, 58.0, 0.0, 7.0, 0.0, 0.0, 6.0, 13.0, 0.0, 29.0, 0.0, 51.0, 70.0, 0.0, 193.0, 52.0, 46.0, 0.0, 25.0, 4.0, 138.0, 0.0, 7.0, 41.0, 0.0, 194.0, 121.0, 0.0, 65.0, 14.0, 0.0, 0.0, 0.0, 42.0, 6.0, 43.0, 18.0, 4.0, 172.0, 0.0, 0.0, 27.0, 0.0, 64.0, 4.0, 147.0, 9.0, 94.0, 74.0, 0.0, 0.0, 25.0, 0.0, 69.0, 0.0, 53.0, 32.0, 0.0, 6.0, 14.0, 0.0, 25.0, 137.0, 174.0, 75.0, 0.0, 0.0, 81.0, 22.0, 15.0, 42.0, 8.0, 192.0, 183.0, 10.0, 0.0, 69.0, 80.0, 144.0, 0.0, 46.0, 5.0, 119.0, 0.0, 52.0, 105.0, 2.0, 7.0, 11.0, 88.0, 0.0, 0.0, 15.0, 1.0, 9.0, 0.0, 7.0, 2.0, 29.0, 7.0, 53.0, 25.0, 27.0, 0.0, 0.0, 152.0, 130.0, 64.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8655920129512592, "mean_inference_ms": 2.7430766637203927, "mean_action_processing_ms": 0.4668667808806767, "mean_env_wait_ms": 0.3136210331882566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005009055137634277, "StateBufferConnector_ms": 0.010664939880371094, "ViewRequirementAgentConnector_ms": 0.1509990692138672}, "num_episodes": 23, "episode_return_max": 388.0, "episode_return_min": -346.0, "episode_return_mean": 120.44, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.8101239295936, "num_env_steps_trained_throughput_per_sec": 300.8101239295936, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 12110.91, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12110.861, "sample_time_ms": 1875.756, "learn_time_ms": 10216.652, "learn_throughput": 391.518, "synch_weights_time_ms": 16.379}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "e1352_00002", "date": "2024-08-13_19-27-25", "timestamp": 1723591645, "time_this_iter_s": 13.340625286102295, "time_total_s": 1538.5449225902557, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb5d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1538.5449225902557, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 56.373684210526314, "ram_util_percent": 82.47894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.41546161101451, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 3.671934123518606, "policy_loss": -0.0021739453185724202, "vf_loss": 3.673795805154023, "vf_explained_var": 0.037338302217463336, "kl": 0.008772351325189042, "entropy": 1.1246460645917862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.73854212123881, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 7.8691297137548055, "policy_loss": -0.003053562230031405, "vf_loss": 7.872172368771185, "vf_explained_var": 0.1690066968953168, "kl": 0.016516982791470576, "entropy": 1.045919053832059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 388.0, "episode_reward_min": -346.0, "episode_reward_mean": 122.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -367.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": 26.635, "predator_policy": 34.77}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.0, 371.0, 133.0, 225.0, 388.0, 140.0, 310.0, -26.0, 142.0, 93.0, 206.0, 162.0, 245.0, 108.0, 309.0, 159.0, 190.0, -243.0, 139.0, -179.0, 335.0, 314.0, 158.0, 318.0, -22.0, -107.0, 54.0, 132.0, 58.0, 264.0, 199.0, 161.0, 263.0, 255.0, 92.0, -192.0, 280.0, 270.0, 59.0, 255.0, -318.0, -8.0, 158.0, 344.0, 257.0, 81.0, 193.0, -111.0, 75.0, 221.0, 35.0, 19.0, -21.0, 298.0, 131.0, 46.0, 67.0, 123.0, 2.0, -50.0, 229.0, -43.0, 202.0, 218.0, -346.0, 200.0, -15.0, -49.0, 7.0, 3.0, -33.0, 382.0, -1.0, 200.0, 335.0, 237.0, 138.0, 286.0, 157.0, 289.0, -43.0, -41.0, 107.0, 126.0, -117.0, 188.0, 112.0, 0.0, 85.0, 245.0, -13.0, 44.0, 37.0, 281.0, -53.0, 249.0, 333.0, 141.0, 286.0, 335.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-64.0, 0.0, 199.0, 172.0, 160.0, -132.0, 105.0, 97.0, 200.0, 188.0, -55.0, 110.0, 184.0, 94.0, -214.0, 50.0, 175.0, -128.0, 40.0, 0.0, 63.0, 78.0, 162.0, 0.0, 27.0, 175.0, 94.0, -70.0, 121.0, 152.0, 162.0, -26.0, 119.0, 71.0, -249.0, -343.0, 135.0, 0.0, -138.0, -225.0, 179.0, 134.0, 110.0, 165.0, 139.0, 0.0, 200.0, 118.0, -44.0, 0.0, -102.0, -180.0, -19.0, 0.0, 0.0, 123.0, 0.0, 0.0, 78.0, 179.0, 187.0, 12.0, 0.0, 142.0, 121.0, 113.0, 157.0, 47.0, -140.0, 162.0, -355.0, -82.0, 68.0, 166.0, 115.0, 126.0, -180.0, 101.0, 164.0, 43.0, -367.0, -145.0, -103.0, -26.0, 107.0, -28.0, 145.0, 199.0, 118.0, 97.0, 44.0, -12.0, 135.0, 36.0, -324.0, 41.0, 48.0, 0.0, 143.0, 14.0, -241.0, 125.0, -84.0, 0.0, -104.0, 9.0, 139.0, 134.0, 37.0, 25.0, 0.0, -7.0, 2.0, 33.0, 0.0, 103.0, -23.0, 0.0, -14.0, -347.0, 108.0, 46.0, -18.0, -106.0, -11.0, 176.0, 145.0, 23.0, -365.0, -356.0, 87.0, 103.0, -4.0, -160.0, 43.0, -236.0, 0.0, -44.0, -85.0, -31.0, -69.0, -121.0, 200.0, 173.0, 0.0, -100.0, 0.0, 200.0, 162.0, 157.0, 89.0, 139.0, 112.0, 17.0, 93.0, 157.0, 107.0, -28.0, 100.0, 162.0, -70.0, -125.0, -254.0, 19.0, 89.0, 0.0, -98.0, 121.0, -218.0, -74.0, 123.0, -4.0, 0.0, 108.0, 0.0, 0.0, 0.0, 68.0, 176.0, 68.0, -179.0, 32.0, 3.0, 41.0, -160.0, 57.0, 149.0, 94.0, 48.0, -222.0, 135.0, 71.0, 140.0, 172.0, 0.0, 114.0, 116.0, 170.0, 188.0, 119.0], "policy_predator_policy_reward": [87.0, 0.0, 0.0, 0.0, 14.0, 91.0, 0.0, 23.0, 0.0, 0.0, 85.0, 0.0, 0.0, 32.0, 1.0, 137.0, 18.0, 77.0, 53.0, 0.0, 55.0, 10.0, 0.0, 0.0, 1.0, 42.0, 84.0, 0.0, 0.0, 36.0, 10.0, 13.0, 0.0, 0.0, 179.0, 170.0, 0.0, 4.0, 63.0, 121.0, 22.0, 0.0, 31.0, 8.0, 7.0, 12.0, 0.0, 0.0, 0.0, 22.0, 36.0, 139.0, 0.0, 73.0, 1.0, 8.0, 0.0, 58.0, 0.0, 7.0, 0.0, 0.0, 6.0, 13.0, 0.0, 29.0, 0.0, 51.0, 70.0, 0.0, 193.0, 52.0, 46.0, 0.0, 25.0, 4.0, 138.0, 0.0, 7.0, 41.0, 0.0, 194.0, 121.0, 0.0, 65.0, 14.0, 0.0, 0.0, 0.0, 42.0, 6.0, 43.0, 18.0, 4.0, 172.0, 0.0, 0.0, 27.0, 0.0, 64.0, 4.0, 147.0, 9.0, 94.0, 74.0, 0.0, 0.0, 25.0, 0.0, 69.0, 0.0, 53.0, 32.0, 0.0, 6.0, 14.0, 0.0, 25.0, 137.0, 174.0, 75.0, 0.0, 0.0, 81.0, 22.0, 15.0, 42.0, 8.0, 192.0, 183.0, 10.0, 0.0, 69.0, 80.0, 144.0, 0.0, 46.0, 5.0, 119.0, 0.0, 52.0, 105.0, 2.0, 7.0, 11.0, 88.0, 0.0, 0.0, 15.0, 1.0, 9.0, 0.0, 7.0, 2.0, 29.0, 7.0, 53.0, 25.0, 27.0, 0.0, 0.0, 152.0, 130.0, 64.0, 0.0, 18.0, 81.0, 22.0, 37.0, 138.0, 8.0, 61.0, 4.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 1.0, 134.0, 0.0, 0.0, 0.0, 20.0, 120.0, 38.0, 0.0, 111.0, 10.0, 0.0, 43.0, 21.0, 0.0, 0.0, 27.0, 0.0, 0.0, 0.0, 28.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8674929761472379, "mean_inference_ms": 2.748395879065706, "mean_action_processing_ms": 0.4651547165947364, "mean_env_wait_ms": 0.31483526934733946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00615847110748291, "StateBufferConnector_ms": 0.010532259941101074, "ViewRequirementAgentConnector_ms": 0.1528630256652832}, "num_episodes": 18, "episode_return_max": 388.0, "episode_return_min": -346.0, "episode_return_mean": 122.81, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.38167802652265, "num_env_steps_trained_throughput_per_sec": 319.38167802652265, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 12105.648, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12105.595, "sample_time_ms": 1929.152, "learn_time_ms": 10157.142, "learn_throughput": 393.812, "synch_weights_time_ms": 16.628}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "e1352_00002", "date": "2024-08-13_19-27-38", "timestamp": 1723591658, "time_this_iter_s": 12.55257272720337, "time_total_s": 1551.097495317459, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb3430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1551.097495317459, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 54.05, "ram_util_percent": 82.23888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1719763353703514, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 4.000257625024785, "policy_loss": -0.0008427397875243394, "vf_loss": 4.000674589979585, "vf_explained_var": 0.05484277019425044, "kl": 0.011961302949356389, "entropy": 1.1412736620852557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.973743974169096, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 8.645676761203342, "policy_loss": -0.0013808566510243707, "vf_loss": 8.647051957549241, "vf_explained_var": -0.14497482208978563, "kl": 0.008580016390398668, "entropy": 0.9482291061096091, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 382.0, "episode_reward_min": -417.0, "episode_reward_mean": 109.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -371.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": 18.745, "predator_policy": 35.785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.0, -179.0, 335.0, 314.0, 158.0, 318.0, -22.0, -107.0, 54.0, 132.0, 58.0, 264.0, 199.0, 161.0, 263.0, 255.0, 92.0, -192.0, 280.0, 270.0, 59.0, 255.0, -318.0, -8.0, 158.0, 344.0, 257.0, 81.0, 193.0, -111.0, 75.0, 221.0, 35.0, 19.0, -21.0, 298.0, 131.0, 46.0, 67.0, 123.0, 2.0, -50.0, 229.0, -43.0, 202.0, 218.0, -346.0, 200.0, -15.0, -49.0, 7.0, 3.0, -33.0, 382.0, -1.0, 200.0, 335.0, 237.0, 138.0, 286.0, 157.0, 289.0, -43.0, -41.0, 107.0, 126.0, -117.0, 188.0, 112.0, 0.0, 85.0, 245.0, -13.0, 44.0, 37.0, 281.0, -53.0, 249.0, 333.0, 141.0, 286.0, 335.0, 108.0, 247.0, 87.0, 194.0, 144.0, 378.0, 298.0, 59.0, 293.0, 313.0, 76.0, 175.0, -58.0, -417.0, 31.0, -134.0, 80.0, -314.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [135.0, 0.0, -138.0, -225.0, 179.0, 134.0, 110.0, 165.0, 139.0, 0.0, 200.0, 118.0, -44.0, 0.0, -102.0, -180.0, -19.0, 0.0, 0.0, 123.0, 0.0, 0.0, 78.0, 179.0, 187.0, 12.0, 0.0, 142.0, 121.0, 113.0, 157.0, 47.0, -140.0, 162.0, -355.0, -82.0, 68.0, 166.0, 115.0, 126.0, -180.0, 101.0, 164.0, 43.0, -367.0, -145.0, -103.0, -26.0, 107.0, -28.0, 145.0, 199.0, 118.0, 97.0, 44.0, -12.0, 135.0, 36.0, -324.0, 41.0, 48.0, 0.0, 143.0, 14.0, -241.0, 125.0, -84.0, 0.0, -104.0, 9.0, 139.0, 134.0, 37.0, 25.0, 0.0, -7.0, 2.0, 33.0, 0.0, 103.0, -23.0, 0.0, -14.0, -347.0, 108.0, 46.0, -18.0, -106.0, -11.0, 176.0, 145.0, 23.0, -365.0, -356.0, 87.0, 103.0, -4.0, -160.0, 43.0, -236.0, 0.0, -44.0, -85.0, -31.0, -69.0, -121.0, 200.0, 173.0, 0.0, -100.0, 0.0, 200.0, 162.0, 157.0, 89.0, 139.0, 112.0, 17.0, 93.0, 157.0, 107.0, -28.0, 100.0, 162.0, -70.0, -125.0, -254.0, 19.0, 89.0, 0.0, -98.0, 121.0, -218.0, -74.0, 123.0, -4.0, 0.0, 108.0, 0.0, 0.0, 0.0, 68.0, 176.0, 68.0, -179.0, 32.0, 3.0, 41.0, -160.0, 57.0, 149.0, 94.0, 48.0, -222.0, 135.0, 71.0, 140.0, 172.0, 0.0, 114.0, 116.0, 170.0, 188.0, 119.0, 56.0, -28.0, 139.0, 108.0, 0.0, 62.0, -12.0, 200.0, 7.0, 69.0, 180.0, 198.0, 156.0, 121.0, 7.0, 10.0, 137.0, 146.0, 113.0, 168.0, 0.0, 14.0, 131.0, 10.0, -89.0, -111.0, -371.0, -334.0, 121.0, -262.0, -83.0, -254.0, 30.0, 0.0, -256.0, -244.0], "policy_predator_policy_reward": [0.0, 4.0, 63.0, 121.0, 22.0, 0.0, 31.0, 8.0, 7.0, 12.0, 0.0, 0.0, 0.0, 22.0, 36.0, 139.0, 0.0, 73.0, 1.0, 8.0, 0.0, 58.0, 0.0, 7.0, 0.0, 0.0, 6.0, 13.0, 0.0, 29.0, 0.0, 51.0, 70.0, 0.0, 193.0, 52.0, 46.0, 0.0, 25.0, 4.0, 138.0, 0.0, 7.0, 41.0, 0.0, 194.0, 121.0, 0.0, 65.0, 14.0, 0.0, 0.0, 0.0, 42.0, 6.0, 43.0, 18.0, 4.0, 172.0, 0.0, 0.0, 27.0, 0.0, 64.0, 4.0, 147.0, 9.0, 94.0, 74.0, 0.0, 0.0, 25.0, 0.0, 69.0, 0.0, 53.0, 32.0, 0.0, 6.0, 14.0, 0.0, 25.0, 137.0, 174.0, 75.0, 0.0, 0.0, 81.0, 22.0, 15.0, 42.0, 8.0, 192.0, 183.0, 10.0, 0.0, 69.0, 80.0, 144.0, 0.0, 46.0, 5.0, 119.0, 0.0, 52.0, 105.0, 2.0, 7.0, 11.0, 88.0, 0.0, 0.0, 15.0, 1.0, 9.0, 0.0, 7.0, 2.0, 29.0, 7.0, 53.0, 25.0, 27.0, 0.0, 0.0, 152.0, 130.0, 64.0, 0.0, 18.0, 81.0, 22.0, 37.0, 138.0, 8.0, 61.0, 4.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 1.0, 134.0, 0.0, 0.0, 0.0, 20.0, 120.0, 38.0, 0.0, 111.0, 10.0, 0.0, 43.0, 21.0, 0.0, 0.0, 27.0, 0.0, 0.0, 0.0, 28.0, 0.0, 80.0, 0.0, 0.0, 25.0, 0.0, 6.0, 0.0, 18.0, 50.0, 0.0, 0.0, 9.0, 12.0, 40.0, 2.0, 10.0, 0.0, 24.0, 8.0, 41.0, 21.0, 34.0, 0.0, 142.0, 0.0, 116.0, 172.0, 158.0, 14.0, 162.0, 41.0, 43.0, 7.0, 0.0, 186.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8703303840848677, "mean_inference_ms": 2.7577319238707076, "mean_action_processing_ms": 0.46462231179863595, "mean_env_wait_ms": 0.31653832375992097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00634157657623291, "StateBufferConnector_ms": 0.0105743408203125, "ViewRequirementAgentConnector_ms": 0.17033231258392334}, "num_episodes": 18, "episode_return_max": 382.0, "episode_return_min": -417.0, "episode_return_mean": 109.06, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 206.28778517840178, "num_env_steps_trained_throughput_per_sec": 206.28778517840178, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 12852.254, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12852.201, "sample_time_ms": 1934.196, "learn_time_ms": 10898.392, "learn_throughput": 367.027, "synch_weights_time_ms": 16.827}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "e1352_00002", "date": "2024-08-13_19-27-58", "timestamp": 1723591678, "time_this_iter_s": 19.447241067886353, "time_total_s": 1570.5447363853455, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d00ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1570.5447363853455, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 88.75185185185185, "ram_util_percent": 83.46666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0762646005424874, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 5.117654723086685, "policy_loss": -0.004360938312426683, "vf_loss": 5.121566213375677, "vf_explained_var": 0.03379849353164592, "kl": 0.01262635342527232, "entropy": 1.1406541549339497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.54283288786651, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 8.08542608912029, "policy_loss": -0.00332745131716211, "vf_loss": 8.088743654382291, "vf_explained_var": -0.07062014650415491, "kl": 0.015027269540263918, "entropy": 0.9947852496432249, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": -417.0, "episode_reward_mean": 105.63, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": 13.335, "predator_policy": 39.48}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.0, 270.0, 59.0, 255.0, -318.0, -8.0, 158.0, 344.0, 257.0, 81.0, 193.0, -111.0, 75.0, 221.0, 35.0, 19.0, -21.0, 298.0, 131.0, 46.0, 67.0, 123.0, 2.0, -50.0, 229.0, -43.0, 202.0, 218.0, -346.0, 200.0, -15.0, -49.0, 7.0, 3.0, -33.0, 382.0, -1.0, 200.0, 335.0, 237.0, 138.0, 286.0, 157.0, 289.0, -43.0, -41.0, 107.0, 126.0, -117.0, 188.0, 112.0, 0.0, 85.0, 245.0, -13.0, 44.0, 37.0, 281.0, -53.0, 249.0, 333.0, 141.0, 286.0, 335.0, 108.0, 247.0, 87.0, 194.0, 144.0, 378.0, 298.0, 59.0, 293.0, 313.0, 76.0, 175.0, -58.0, -417.0, 31.0, -134.0, 80.0, -314.0, 297.0, 162.0, 132.0, 157.0, -95.0, 84.0, -58.0, 13.0, 393.0, 163.0, 304.0, 188.0, -15.0, 36.0, 81.0, -73.0, 130.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [68.0, 166.0, 115.0, 126.0, -180.0, 101.0, 164.0, 43.0, -367.0, -145.0, -103.0, -26.0, 107.0, -28.0, 145.0, 199.0, 118.0, 97.0, 44.0, -12.0, 135.0, 36.0, -324.0, 41.0, 48.0, 0.0, 143.0, 14.0, -241.0, 125.0, -84.0, 0.0, -104.0, 9.0, 139.0, 134.0, 37.0, 25.0, 0.0, -7.0, 2.0, 33.0, 0.0, 103.0, -23.0, 0.0, -14.0, -347.0, 108.0, 46.0, -18.0, -106.0, -11.0, 176.0, 145.0, 23.0, -365.0, -356.0, 87.0, 103.0, -4.0, -160.0, 43.0, -236.0, 0.0, -44.0, -85.0, -31.0, -69.0, -121.0, 200.0, 173.0, 0.0, -100.0, 0.0, 200.0, 162.0, 157.0, 89.0, 139.0, 112.0, 17.0, 93.0, 157.0, 107.0, -28.0, 100.0, 162.0, -70.0, -125.0, -254.0, 19.0, 89.0, 0.0, -98.0, 121.0, -218.0, -74.0, 123.0, -4.0, 0.0, 108.0, 0.0, 0.0, 0.0, 68.0, 176.0, 68.0, -179.0, 32.0, 3.0, 41.0, -160.0, 57.0, 149.0, 94.0, 48.0, -222.0, 135.0, 71.0, 140.0, 172.0, 0.0, 114.0, 116.0, 170.0, 188.0, 119.0, 56.0, -28.0, 139.0, 108.0, 0.0, 62.0, -12.0, 200.0, 7.0, 69.0, 180.0, 198.0, 156.0, 121.0, 7.0, 10.0, 137.0, 146.0, 113.0, 168.0, 0.0, 14.0, 131.0, 10.0, -89.0, -111.0, -371.0, -334.0, 121.0, -262.0, -83.0, -254.0, 30.0, 0.0, -256.0, -244.0, 144.0, 153.0, 64.0, -4.0, 97.0, -7.0, 197.0, -152.0, -161.0, -129.0, -172.0, 129.0, -82.0, -107.0, 0.0, -28.0, 195.0, 197.0, 97.0, 65.0, 144.0, 160.0, -12.0, 124.0, -102.0, -48.0, -166.0, 55.0, -334.0, 116.0, -394.0, 0.0, 95.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [46.0, 0.0, 25.0, 4.0, 138.0, 0.0, 7.0, 41.0, 0.0, 194.0, 121.0, 0.0, 65.0, 14.0, 0.0, 0.0, 0.0, 42.0, 6.0, 43.0, 18.0, 4.0, 172.0, 0.0, 0.0, 27.0, 0.0, 64.0, 4.0, 147.0, 9.0, 94.0, 74.0, 0.0, 0.0, 25.0, 0.0, 69.0, 0.0, 53.0, 32.0, 0.0, 6.0, 14.0, 0.0, 25.0, 137.0, 174.0, 75.0, 0.0, 0.0, 81.0, 22.0, 15.0, 42.0, 8.0, 192.0, 183.0, 10.0, 0.0, 69.0, 80.0, 144.0, 0.0, 46.0, 5.0, 119.0, 0.0, 52.0, 105.0, 2.0, 7.0, 11.0, 88.0, 0.0, 0.0, 15.0, 1.0, 9.0, 0.0, 7.0, 2.0, 29.0, 7.0, 53.0, 25.0, 27.0, 0.0, 0.0, 152.0, 130.0, 64.0, 0.0, 18.0, 81.0, 22.0, 37.0, 138.0, 8.0, 61.0, 4.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 1.0, 134.0, 0.0, 0.0, 0.0, 20.0, 120.0, 38.0, 0.0, 111.0, 10.0, 0.0, 43.0, 21.0, 0.0, 0.0, 27.0, 0.0, 0.0, 0.0, 28.0, 0.0, 80.0, 0.0, 0.0, 25.0, 0.0, 6.0, 0.0, 18.0, 50.0, 0.0, 0.0, 9.0, 12.0, 40.0, 2.0, 10.0, 0.0, 24.0, 8.0, 41.0, 21.0, 34.0, 0.0, 142.0, 0.0, 116.0, 172.0, 158.0, 14.0, 162.0, 41.0, 43.0, 7.0, 0.0, 186.0, 0.0, 0.0, 65.0, 37.0, 0.0, 42.0, 112.0, 0.0, 71.0, 124.0, 127.0, 0.0, 119.0, 12.0, 21.0, 20.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 38.0, 38.0, 45.0, 90.0, 74.0, 73.0, 134.0, 165.0, 179.0, 142.0, 35.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733061020885142, "mean_inference_ms": 2.766350068640014, "mean_action_processing_ms": 0.46420998375890465, "mean_env_wait_ms": 0.31798592322683367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010003209114074707, "StateBufferConnector_ms": 0.010644793510437012, "ViewRequirementAgentConnector_ms": 0.1758732795715332}, "num_episodes": 18, "episode_return_max": 393.0, "episode_return_min": -417.0, "episode_return_mean": 105.63, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.8003370114825, "num_env_steps_trained_throughput_per_sec": 299.8003370114825, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 13040.607, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13040.55, "sample_time_ms": 2016.82, "learn_time_ms": 11004.149, "learn_throughput": 363.499, "synch_weights_time_ms": 16.514}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "e1352_00002", "date": "2024-08-13_19-28-11", "timestamp": 1723591691, "time_this_iter_s": 13.388627290725708, "time_total_s": 1583.9333636760712, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d008b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1583.9333636760712, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 66.5578947368421, "ram_util_percent": 84.08421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0093544071707776, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 2.988477550360261, "policy_loss": -0.003277837158865714, "vf_loss": 2.99138131677789, "vf_explained_var": 0.02202490454628354, "kl": 0.010508890869643081, "entropy": 1.1846337457182545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.78071917793738, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 7.171988382289019, "policy_loss": -0.001162606020576306, "vf_loss": 7.173144645034951, "vf_explained_var": 0.23480310900501472, "kl": 0.009637607212279664, "entropy": 1.1426914186073989, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": -417.0, "episode_reward_mean": 96.83, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 7.89, "predator_policy": 40.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, -50.0, 229.0, -43.0, 202.0, 218.0, -346.0, 200.0, -15.0, -49.0, 7.0, 3.0, -33.0, 382.0, -1.0, 200.0, 335.0, 237.0, 138.0, 286.0, 157.0, 289.0, -43.0, -41.0, 107.0, 126.0, -117.0, 188.0, 112.0, 0.0, 85.0, 245.0, -13.0, 44.0, 37.0, 281.0, -53.0, 249.0, 333.0, 141.0, 286.0, 335.0, 108.0, 247.0, 87.0, 194.0, 144.0, 378.0, 298.0, 59.0, 293.0, 313.0, 76.0, 175.0, -58.0, -417.0, 31.0, -134.0, 80.0, -314.0, 297.0, 162.0, 132.0, 157.0, -95.0, 84.0, -58.0, 13.0, 393.0, 163.0, 304.0, 188.0, -15.0, 36.0, 81.0, -73.0, 130.0, 0.0, 236.0, -123.0, 0.0, 72.0, 156.0, 26.0, 83.0, -35.0, 9.0, 80.0, 240.0, 302.0, 100.0, 112.0, 104.0, 99.0, 120.0, 15.0, 94.0, -130.0, 14.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-23.0, 0.0, -14.0, -347.0, 108.0, 46.0, -18.0, -106.0, -11.0, 176.0, 145.0, 23.0, -365.0, -356.0, 87.0, 103.0, -4.0, -160.0, 43.0, -236.0, 0.0, -44.0, -85.0, -31.0, -69.0, -121.0, 200.0, 173.0, 0.0, -100.0, 0.0, 200.0, 162.0, 157.0, 89.0, 139.0, 112.0, 17.0, 93.0, 157.0, 107.0, -28.0, 100.0, 162.0, -70.0, -125.0, -254.0, 19.0, 89.0, 0.0, -98.0, 121.0, -218.0, -74.0, 123.0, -4.0, 0.0, 108.0, 0.0, 0.0, 0.0, 68.0, 176.0, 68.0, -179.0, 32.0, 3.0, 41.0, -160.0, 57.0, 149.0, 94.0, 48.0, -222.0, 135.0, 71.0, 140.0, 172.0, 0.0, 114.0, 116.0, 170.0, 188.0, 119.0, 56.0, -28.0, 139.0, 108.0, 0.0, 62.0, -12.0, 200.0, 7.0, 69.0, 180.0, 198.0, 156.0, 121.0, 7.0, 10.0, 137.0, 146.0, 113.0, 168.0, 0.0, 14.0, 131.0, 10.0, -89.0, -111.0, -371.0, -334.0, 121.0, -262.0, -83.0, -254.0, 30.0, 0.0, -256.0, -244.0, 144.0, 153.0, 64.0, -4.0, 97.0, -7.0, 197.0, -152.0, -161.0, -129.0, -172.0, 129.0, -82.0, -107.0, 0.0, -28.0, 195.0, 197.0, 97.0, 65.0, 144.0, 160.0, -12.0, 124.0, -102.0, -48.0, -166.0, 55.0, -334.0, 116.0, -394.0, 0.0, 95.0, 0.0, 0.0, 0.0, 56.0, 171.0, -22.0, -255.0, 0.0, 0.0, -56.0, -5.0, 0.0, 139.0, 0.0, -48.0, 0.0, 80.0, 0.0, -113.0, -121.0, -18.0, 60.0, -63.0, 196.0, -18.0, 118.0, 172.0, -400.0, 117.0, 0.0, 68.0, -64.0, 85.0, 97.0, 0.0, 0.0, 75.0, 23.0, -112.0, 122.0, -62.0, -35.0, -316.0, 92.0, -156.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 25.0, 137.0, 174.0, 75.0, 0.0, 0.0, 81.0, 22.0, 15.0, 42.0, 8.0, 192.0, 183.0, 10.0, 0.0, 69.0, 80.0, 144.0, 0.0, 46.0, 5.0, 119.0, 0.0, 52.0, 105.0, 2.0, 7.0, 11.0, 88.0, 0.0, 0.0, 15.0, 1.0, 9.0, 0.0, 7.0, 2.0, 29.0, 7.0, 53.0, 25.0, 27.0, 0.0, 0.0, 152.0, 130.0, 64.0, 0.0, 18.0, 81.0, 22.0, 37.0, 138.0, 8.0, 61.0, 4.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 1.0, 134.0, 0.0, 0.0, 0.0, 20.0, 120.0, 38.0, 0.0, 111.0, 10.0, 0.0, 43.0, 21.0, 0.0, 0.0, 27.0, 0.0, 0.0, 0.0, 28.0, 0.0, 80.0, 0.0, 0.0, 25.0, 0.0, 6.0, 0.0, 18.0, 50.0, 0.0, 0.0, 9.0, 12.0, 40.0, 2.0, 10.0, 0.0, 24.0, 8.0, 41.0, 21.0, 34.0, 0.0, 142.0, 0.0, 116.0, 172.0, 158.0, 14.0, 162.0, 41.0, 43.0, 7.0, 0.0, 186.0, 0.0, 0.0, 65.0, 37.0, 0.0, 42.0, 112.0, 0.0, 71.0, 124.0, 127.0, 0.0, 119.0, 12.0, 21.0, 20.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 38.0, 38.0, 45.0, 90.0, 74.0, 73.0, 134.0, 165.0, 179.0, 142.0, 35.0, 0.0, 0.0, 0.0, 9.0, 0.0, 119.0, 35.0, 0.0, 0.0, 0.0, 133.0, 16.0, 1.0, 41.0, 33.0, 3.0, 0.0, 75.0, 3.0, 16.0, 132.0, 83.0, 0.0, 62.0, 0.0, 0.0, 12.0, 183.0, 200.0, 3.0, 41.0, 38.0, 45.0, 2.0, 0.0, 30.0, 15.0, 103.0, 1.0, 3.0, 31.0, 168.0, 53.0, 78.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8776731606511098, "mean_inference_ms": 2.7781368786292058, "mean_action_processing_ms": 0.46402507917456903, "mean_env_wait_ms": 0.31978882951156185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010597944259643555, "StateBufferConnector_ms": 0.007020711898803711, "ViewRequirementAgentConnector_ms": 0.16984808444976807}, "num_episodes": 22, "episode_return_max": 393.0, "episode_return_min": -417.0, "episode_return_mean": 96.83, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.98297139822506, "num_env_steps_trained_throughput_per_sec": 324.98297139822506, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 13151.802, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13151.746, "sample_time_ms": 2065.194, "learn_time_ms": 11066.909, "learn_throughput": 361.438, "synch_weights_time_ms": 16.531}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "e1352_00002", "date": "2024-08-13_19-28-23", "timestamp": 1723591703, "time_this_iter_s": 12.373318195343018, "time_total_s": 1596.3066818714142, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb3430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1596.3066818714142, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 66.14444444444445, "ram_util_percent": 84.05555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7770420807063896, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 4.1318048522585915, "policy_loss": -0.0016717734576631633, "vf_loss": 4.133078031438999, "vf_explained_var": 0.03488503962597519, "kl": 0.011197722121001905, "entropy": 1.1408786178896666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.40856411627361, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 8.069199547187361, "policy_loss": -0.0021625277238883195, "vf_loss": 8.071352744733215, "vf_explained_var": -0.05853008094918791, "kl": 0.014180718920372986, "entropy": 0.9516244816401648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": -417.0, "episode_reward_mean": 98.6, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 12.16, "predator_policy": 37.14}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.0, 107.0, 126.0, -117.0, 188.0, 112.0, 0.0, 85.0, 245.0, -13.0, 44.0, 37.0, 281.0, -53.0, 249.0, 333.0, 141.0, 286.0, 335.0, 108.0, 247.0, 87.0, 194.0, 144.0, 378.0, 298.0, 59.0, 293.0, 313.0, 76.0, 175.0, -58.0, -417.0, 31.0, -134.0, 80.0, -314.0, 297.0, 162.0, 132.0, 157.0, -95.0, 84.0, -58.0, 13.0, 393.0, 163.0, 304.0, 188.0, -15.0, 36.0, 81.0, -73.0, 130.0, 0.0, 236.0, -123.0, 0.0, 72.0, 156.0, 26.0, 83.0, -35.0, 9.0, 80.0, 240.0, 302.0, 100.0, 112.0, 104.0, 99.0, 120.0, 15.0, 94.0, -130.0, 14.0, 0.0, 339.0, 211.0, 190.0, 304.0, -4.0, 81.0, 40.0, 275.0, 367.0, -300.0, 205.0, 132.0, -93.0, 63.0, 103.0, 169.0, 27.0, 121.0, -335.0, 165.0, 85.0, 146.0, 191.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-254.0, 19.0, 89.0, 0.0, -98.0, 121.0, -218.0, -74.0, 123.0, -4.0, 0.0, 108.0, 0.0, 0.0, 0.0, 68.0, 176.0, 68.0, -179.0, 32.0, 3.0, 41.0, -160.0, 57.0, 149.0, 94.0, 48.0, -222.0, 135.0, 71.0, 140.0, 172.0, 0.0, 114.0, 116.0, 170.0, 188.0, 119.0, 56.0, -28.0, 139.0, 108.0, 0.0, 62.0, -12.0, 200.0, 7.0, 69.0, 180.0, 198.0, 156.0, 121.0, 7.0, 10.0, 137.0, 146.0, 113.0, 168.0, 0.0, 14.0, 131.0, 10.0, -89.0, -111.0, -371.0, -334.0, 121.0, -262.0, -83.0, -254.0, 30.0, 0.0, -256.0, -244.0, 144.0, 153.0, 64.0, -4.0, 97.0, -7.0, 197.0, -152.0, -161.0, -129.0, -172.0, 129.0, -82.0, -107.0, 0.0, -28.0, 195.0, 197.0, 97.0, 65.0, 144.0, 160.0, -12.0, 124.0, -102.0, -48.0, -166.0, 55.0, -334.0, 116.0, -394.0, 0.0, 95.0, 0.0, 0.0, 0.0, 56.0, 171.0, -22.0, -255.0, 0.0, 0.0, -56.0, -5.0, 0.0, 139.0, 0.0, -48.0, 0.0, 80.0, 0.0, -113.0, -121.0, -18.0, 60.0, -63.0, 196.0, -18.0, 118.0, 172.0, -400.0, 117.0, 0.0, 68.0, -64.0, 85.0, 97.0, 0.0, 0.0, 75.0, 23.0, -112.0, 122.0, -62.0, -35.0, -316.0, 92.0, -156.0, 0.0, 0.0, 140.0, 199.0, 60.0, 136.0, 102.0, 88.0, 139.0, 140.0, -48.0, -31.0, -19.0, -28.0, -7.0, -7.0, 174.0, 72.0, 198.0, 169.0, -147.0, -385.0, 180.0, 25.0, 113.0, 19.0, -221.0, -56.0, 42.0, 0.0, -49.0, 55.0, 66.0, 69.0, 0.0, -53.0, 0.0, 121.0, -337.0, -239.0, 67.0, 61.0, 85.0, 0.0, 22.0, 38.0, 193.0, -6.0], "policy_predator_policy_reward": [130.0, 64.0, 0.0, 18.0, 81.0, 22.0, 37.0, 138.0, 8.0, 61.0, 4.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 1.0, 134.0, 0.0, 0.0, 0.0, 20.0, 120.0, 38.0, 0.0, 111.0, 10.0, 0.0, 43.0, 21.0, 0.0, 0.0, 27.0, 0.0, 0.0, 0.0, 28.0, 0.0, 80.0, 0.0, 0.0, 25.0, 0.0, 6.0, 0.0, 18.0, 50.0, 0.0, 0.0, 9.0, 12.0, 40.0, 2.0, 10.0, 0.0, 24.0, 8.0, 41.0, 21.0, 34.0, 0.0, 142.0, 0.0, 116.0, 172.0, 158.0, 14.0, 162.0, 41.0, 43.0, 7.0, 0.0, 186.0, 0.0, 0.0, 65.0, 37.0, 0.0, 42.0, 112.0, 0.0, 71.0, 124.0, 127.0, 0.0, 119.0, 12.0, 21.0, 20.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 38.0, 38.0, 45.0, 90.0, 74.0, 73.0, 134.0, 165.0, 179.0, 142.0, 35.0, 0.0, 0.0, 0.0, 9.0, 0.0, 119.0, 35.0, 0.0, 0.0, 0.0, 133.0, 16.0, 1.0, 41.0, 33.0, 3.0, 0.0, 75.0, 3.0, 16.0, 132.0, 83.0, 0.0, 62.0, 0.0, 0.0, 12.0, 183.0, 200.0, 3.0, 41.0, 38.0, 45.0, 2.0, 0.0, 30.0, 15.0, 103.0, 1.0, 3.0, 31.0, 168.0, 53.0, 78.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 17.0, 8.0, 27.0, 48.0, 0.0, 128.0, 49.0, 5.0, 29.0, 0.0, 0.0, 0.0, 54.0, 178.0, 0.0, 0.0, 0.0, 0.0, 91.0, 93.0, 21.0, 0.0, 78.0, 19.0, 28.0, 6.0, 0.0, 80.0, 0.0, 0.0, 61.0, 180.0, 26.0, 11.0, 0.0, 0.0, 19.0, 67.0, 4.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8792952439599913, "mean_inference_ms": 2.779445219027208, "mean_action_processing_ms": 0.46220649993996754, "mean_env_wait_ms": 0.3200628780060603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013389110565185547, "StateBufferConnector_ms": 0.004518747329711914, "ViewRequirementAgentConnector_ms": 0.1459214687347412}, "num_episodes": 23, "episode_return_max": 393.0, "episode_return_min": -417.0, "episode_return_mean": 98.6, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.02373041110036, "num_env_steps_trained_throughput_per_sec": 334.02373041110036, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 13199.764, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13199.711, "sample_time_ms": 2104.54, "learn_time_ms": 11075.907, "learn_throughput": 361.144, "synch_weights_time_ms": 16.03}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "e1352_00002", "date": "2024-08-13_19-28-35", "timestamp": 1723591715, "time_this_iter_s": 12.023632049560547, "time_total_s": 1608.3303139209747, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d00940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1608.3303139209747, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 67.01764705882354, "ram_util_percent": 83.65882352941176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7983674947389219, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 6.285280363143436, "policy_loss": -0.0024038064825747693, "vf_loss": 6.287395661722416, "vf_explained_var": 0.037438749667828675, "kl": 0.008105203840607781, "entropy": 1.075930628448567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.102539401458053, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 9.11081231536058, "policy_loss": -0.0020676472037045096, "vf_loss": 9.112871707431854, "vf_explained_var": -0.10493794534572218, "kl": 0.0125590114716383, "entropy": 0.9416294107046077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": -417.0, "episode_reward_mean": 85.65, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -0.385, "predator_policy": 43.21}, "custom_metrics": {}, "hist_stats": {"episode_reward": [335.0, 108.0, 247.0, 87.0, 194.0, 144.0, 378.0, 298.0, 59.0, 293.0, 313.0, 76.0, 175.0, -58.0, -417.0, 31.0, -134.0, 80.0, -314.0, 297.0, 162.0, 132.0, 157.0, -95.0, 84.0, -58.0, 13.0, 393.0, 163.0, 304.0, 188.0, -15.0, 36.0, 81.0, -73.0, 130.0, 0.0, 236.0, -123.0, 0.0, 72.0, 156.0, 26.0, 83.0, -35.0, 9.0, 80.0, 240.0, 302.0, 100.0, 112.0, 104.0, 99.0, 120.0, 15.0, 94.0, -130.0, 14.0, 0.0, 339.0, 211.0, 190.0, 304.0, -4.0, 81.0, 40.0, 275.0, 367.0, -300.0, 205.0, 132.0, -93.0, 63.0, 103.0, 169.0, 27.0, 121.0, -335.0, 165.0, 85.0, 146.0, 191.0, -31.0, 32.0, -50.0, 260.0, 70.0, -338.0, 171.0, -108.0, 210.0, 23.0, 139.0, -93.0, 109.0, 14.0, 61.0, -16.0, 12.0, 250.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [188.0, 119.0, 56.0, -28.0, 139.0, 108.0, 0.0, 62.0, -12.0, 200.0, 7.0, 69.0, 180.0, 198.0, 156.0, 121.0, 7.0, 10.0, 137.0, 146.0, 113.0, 168.0, 0.0, 14.0, 131.0, 10.0, -89.0, -111.0, -371.0, -334.0, 121.0, -262.0, -83.0, -254.0, 30.0, 0.0, -256.0, -244.0, 144.0, 153.0, 64.0, -4.0, 97.0, -7.0, 197.0, -152.0, -161.0, -129.0, -172.0, 129.0, -82.0, -107.0, 0.0, -28.0, 195.0, 197.0, 97.0, 65.0, 144.0, 160.0, -12.0, 124.0, -102.0, -48.0, -166.0, 55.0, -334.0, 116.0, -394.0, 0.0, 95.0, 0.0, 0.0, 0.0, 56.0, 171.0, -22.0, -255.0, 0.0, 0.0, -56.0, -5.0, 0.0, 139.0, 0.0, -48.0, 0.0, 80.0, 0.0, -113.0, -121.0, -18.0, 60.0, -63.0, 196.0, -18.0, 118.0, 172.0, -400.0, 117.0, 0.0, 68.0, -64.0, 85.0, 97.0, 0.0, 0.0, 75.0, 23.0, -112.0, 122.0, -62.0, -35.0, -316.0, 92.0, -156.0, 0.0, 0.0, 140.0, 199.0, 60.0, 136.0, 102.0, 88.0, 139.0, 140.0, -48.0, -31.0, -19.0, -28.0, -7.0, -7.0, 174.0, 72.0, 198.0, 169.0, -147.0, -385.0, 180.0, 25.0, 113.0, 19.0, -221.0, -56.0, 42.0, 0.0, -49.0, 55.0, 66.0, 69.0, 0.0, -53.0, 0.0, 121.0, -337.0, -239.0, 67.0, 61.0, 85.0, 0.0, 22.0, 38.0, 193.0, -6.0, -251.0, 70.0, -36.0, -156.0, -8.0, -162.0, 183.0, 77.0, 26.0, -123.0, -315.0, -200.0, 20.0, 121.0, -268.0, -87.0, 75.0, 55.0, -43.0, -50.0, -199.0, 139.0, -104.0, -244.0, 0.0, 87.0, -116.0, 19.0, -112.0, 62.0, -116.0, 0.0, -102.0, -89.0, 186.0, 57.0], "policy_predator_policy_reward": [0.0, 28.0, 0.0, 80.0, 0.0, 0.0, 25.0, 0.0, 6.0, 0.0, 18.0, 50.0, 0.0, 0.0, 9.0, 12.0, 40.0, 2.0, 10.0, 0.0, 24.0, 8.0, 41.0, 21.0, 34.0, 0.0, 142.0, 0.0, 116.0, 172.0, 158.0, 14.0, 162.0, 41.0, 43.0, 7.0, 0.0, 186.0, 0.0, 0.0, 65.0, 37.0, 0.0, 42.0, 112.0, 0.0, 71.0, 124.0, 127.0, 0.0, 119.0, 12.0, 21.0, 20.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 38.0, 38.0, 45.0, 90.0, 74.0, 73.0, 134.0, 165.0, 179.0, 142.0, 35.0, 0.0, 0.0, 0.0, 9.0, 0.0, 119.0, 35.0, 0.0, 0.0, 0.0, 133.0, 16.0, 1.0, 41.0, 33.0, 3.0, 0.0, 75.0, 3.0, 16.0, 132.0, 83.0, 0.0, 62.0, 0.0, 0.0, 12.0, 183.0, 200.0, 3.0, 41.0, 38.0, 45.0, 2.0, 0.0, 30.0, 15.0, 103.0, 1.0, 3.0, 31.0, 168.0, 53.0, 78.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 17.0, 8.0, 27.0, 48.0, 0.0, 128.0, 49.0, 5.0, 29.0, 0.0, 0.0, 0.0, 54.0, 178.0, 0.0, 0.0, 0.0, 0.0, 91.0, 93.0, 21.0, 0.0, 78.0, 19.0, 28.0, 6.0, 0.0, 80.0, 0.0, 0.0, 61.0, 180.0, 26.0, 11.0, 0.0, 0.0, 19.0, 67.0, 4.0, 0.0, 150.0, 0.0, 112.0, 112.0, 0.0, 120.0, 0.0, 0.0, 86.0, 81.0, 177.0, 0.0, 0.0, 30.0, 106.0, 141.0, 1.0, 79.0, 66.0, 50.0, 76.0, 123.0, 127.0, 128.0, 22.0, 0.0, 0.0, 111.0, 68.0, 43.0, 45.0, 55.0, 92.0, 111.0, 1.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8799371777280435, "mean_inference_ms": 2.7789968026826206, "mean_action_processing_ms": 0.46045788265415977, "mean_env_wait_ms": 0.3201361359884385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012903571128845215, "StateBufferConnector_ms": 0.004919886589050293, "ViewRequirementAgentConnector_ms": 0.15630614757537842}, "num_episodes": 18, "episode_return_max": 393.0, "episode_return_min": -417.0, "episode_return_mean": 85.65, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.22679201515416, "num_env_steps_trained_throughput_per_sec": 331.22679201515416, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 13254.314, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13254.262, "sample_time_ms": 2153.738, "learn_time_ms": 11081.905, "learn_throughput": 360.949, "synch_weights_time_ms": 15.586}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "e1352_00002", "date": "2024-08-13_19-28-48", "timestamp": 1723591728, "time_this_iter_s": 12.122168779373169, "time_total_s": 1620.452482700348, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bbb280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1620.452482700348, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 65.54705882352941, "ram_util_percent": 83.45294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9718694029267503, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 5.174970536004929, "policy_loss": -0.0014234348620342278, "vf_loss": 5.176128699665978, "vf_explained_var": 0.01630975219307753, "kl": 0.0074522607646273055, "entropy": 1.0881160797265472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.5715589477587, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 8.179797806815495, "policy_loss": -0.004770221250752608, "vf_loss": 8.184556553855774, "vf_explained_var": -0.060897090163811174, "kl": 0.017400246379086236, "entropy": 0.9586674828062612, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": -373.0, "episode_reward_mean": 69.08, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -468.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 294.0}, "policy_reward_mean": {"prey_policy": -13.265, "predator_policy": 47.805}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-314.0, 297.0, 162.0, 132.0, 157.0, -95.0, 84.0, -58.0, 13.0, 393.0, 163.0, 304.0, 188.0, -15.0, 36.0, 81.0, -73.0, 130.0, 0.0, 236.0, -123.0, 0.0, 72.0, 156.0, 26.0, 83.0, -35.0, 9.0, 80.0, 240.0, 302.0, 100.0, 112.0, 104.0, 99.0, 120.0, 15.0, 94.0, -130.0, 14.0, 0.0, 339.0, 211.0, 190.0, 304.0, -4.0, 81.0, 40.0, 275.0, 367.0, -300.0, 205.0, 132.0, -93.0, 63.0, 103.0, 169.0, 27.0, 121.0, -335.0, 165.0, 85.0, 146.0, 191.0, -31.0, 32.0, -50.0, 260.0, 70.0, -338.0, 171.0, -108.0, 210.0, 23.0, 139.0, -93.0, 109.0, 14.0, 61.0, -16.0, 12.0, 250.0, 212.0, 21.0, -373.0, 132.0, 187.0, 140.0, 53.0, -85.0, -227.0, 160.0, 52.0, 61.0, 166.0, -4.0, -30.0, 28.0, 37.0, 22.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-256.0, -244.0, 144.0, 153.0, 64.0, -4.0, 97.0, -7.0, 197.0, -152.0, -161.0, -129.0, -172.0, 129.0, -82.0, -107.0, 0.0, -28.0, 195.0, 197.0, 97.0, 65.0, 144.0, 160.0, -12.0, 124.0, -102.0, -48.0, -166.0, 55.0, -334.0, 116.0, -394.0, 0.0, 95.0, 0.0, 0.0, 0.0, 56.0, 171.0, -22.0, -255.0, 0.0, 0.0, -56.0, -5.0, 0.0, 139.0, 0.0, -48.0, 0.0, 80.0, 0.0, -113.0, -121.0, -18.0, 60.0, -63.0, 196.0, -18.0, 118.0, 172.0, -400.0, 117.0, 0.0, 68.0, -64.0, 85.0, 97.0, 0.0, 0.0, 75.0, 23.0, -112.0, 122.0, -62.0, -35.0, -316.0, 92.0, -156.0, 0.0, 0.0, 140.0, 199.0, 60.0, 136.0, 102.0, 88.0, 139.0, 140.0, -48.0, -31.0, -19.0, -28.0, -7.0, -7.0, 174.0, 72.0, 198.0, 169.0, -147.0, -385.0, 180.0, 25.0, 113.0, 19.0, -221.0, -56.0, 42.0, 0.0, -49.0, 55.0, 66.0, 69.0, 0.0, -53.0, 0.0, 121.0, -337.0, -239.0, 67.0, 61.0, 85.0, 0.0, 22.0, 38.0, 193.0, -6.0, -251.0, 70.0, -36.0, -156.0, -8.0, -162.0, 183.0, 77.0, 26.0, -123.0, -315.0, -200.0, 20.0, 121.0, -268.0, -87.0, 75.0, 55.0, -43.0, -50.0, -199.0, 139.0, -104.0, -244.0, 0.0, 87.0, -116.0, 19.0, -112.0, 62.0, -116.0, 0.0, -102.0, -89.0, 186.0, 57.0, 184.0, -20.0, 142.0, -273.0, -334.0, -238.0, 98.0, -84.0, 176.0, 0.0, 98.0, -61.0, -266.0, 117.0, -468.0, 87.0, -301.0, -112.0, 158.0, 0.0, -43.0, 14.0, -107.0, 98.0, 31.0, 105.0, -160.0, 0.0, -60.0, -111.0, -39.0, 5.0, -35.0, -62.0, 58.0, -227.0], "policy_predator_policy_reward": [0.0, 186.0, 0.0, 0.0, 65.0, 37.0, 0.0, 42.0, 112.0, 0.0, 71.0, 124.0, 127.0, 0.0, 119.0, 12.0, 21.0, 20.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 38.0, 38.0, 45.0, 90.0, 74.0, 73.0, 134.0, 165.0, 179.0, 142.0, 35.0, 0.0, 0.0, 0.0, 9.0, 0.0, 119.0, 35.0, 0.0, 0.0, 0.0, 133.0, 16.0, 1.0, 41.0, 33.0, 3.0, 0.0, 75.0, 3.0, 16.0, 132.0, 83.0, 0.0, 62.0, 0.0, 0.0, 12.0, 183.0, 200.0, 3.0, 41.0, 38.0, 45.0, 2.0, 0.0, 30.0, 15.0, 103.0, 1.0, 3.0, 31.0, 168.0, 53.0, 78.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 17.0, 8.0, 27.0, 48.0, 0.0, 128.0, 49.0, 5.0, 29.0, 0.0, 0.0, 0.0, 54.0, 178.0, 0.0, 0.0, 0.0, 0.0, 91.0, 93.0, 21.0, 0.0, 78.0, 19.0, 28.0, 6.0, 0.0, 80.0, 0.0, 0.0, 61.0, 180.0, 26.0, 11.0, 0.0, 0.0, 19.0, 67.0, 4.0, 0.0, 150.0, 0.0, 112.0, 112.0, 0.0, 120.0, 0.0, 0.0, 86.0, 81.0, 177.0, 0.0, 0.0, 30.0, 106.0, 141.0, 1.0, 79.0, 66.0, 50.0, 76.0, 123.0, 127.0, 128.0, 22.0, 0.0, 0.0, 111.0, 68.0, 43.0, 45.0, 55.0, 92.0, 111.0, 1.0, 6.0, 19.0, 29.0, 0.0, 152.0, 191.0, 8.0, 92.0, 26.0, 6.0, 5.0, 88.0, 15.0, 134.0, 68.0, 2.0, 294.0, 18.0, 168.0, 2.0, 0.0, 0.0, 81.0, 52.0, 18.0, 30.0, 0.0, 80.0, 76.0, 39.0, 102.0, 42.0, 20.0, 125.0, 9.0, 89.0, 102.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8799690493614309, "mean_inference_ms": 2.77880134207067, "mean_action_processing_ms": 0.45854010244111115, "mean_env_wait_ms": 0.32016725639054605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013264179229736328, "StateBufferConnector_ms": 0.005295515060424805, "ViewRequirementAgentConnector_ms": 0.14153432846069336}, "num_episodes": 18, "episode_return_max": 393.0, "episode_return_min": -373.0, "episode_return_mean": 69.08, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.92065573264233, "num_env_steps_trained_throughput_per_sec": 315.92065573264233, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 13339.014, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13338.961, "sample_time_ms": 2192.769, "learn_time_ms": 11128.174, "learn_throughput": 359.448, "synch_weights_time_ms": 15.037}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "e1352_00002", "date": "2024-08-13_19-29-00", "timestamp": 1723591740, "time_this_iter_s": 12.702776193618774, "time_total_s": 1633.1552588939667, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32d6bf940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1633.1552588939667, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 64.56666666666666, "ram_util_percent": 82.48333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6873371416771854, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 4.493126728295018, "policy_loss": -0.0020936492148037784, "vf_loss": 4.4947896418748075, "vf_explained_var": 0.029265017641915216, "kl": 0.012100856066787031, "entropy": 1.102545986036775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.61841211924477, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 7.893317497344244, "policy_loss": -0.00020690661702285368, "vf_loss": 7.8935218700025445, "vf_explained_var": -0.0530991895488961, "kl": 0.0038660400943309283, "entropy": 0.9268512283683454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 380.0, "episode_reward_min": -389.0, "episode_reward_mean": 80.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -468.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 294.0}, "policy_reward_mean": {"prey_policy": -5.83, "predator_policy": 45.945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.0, 156.0, 26.0, 83.0, -35.0, 9.0, 80.0, 240.0, 302.0, 100.0, 112.0, 104.0, 99.0, 120.0, 15.0, 94.0, -130.0, 14.0, 0.0, 339.0, 211.0, 190.0, 304.0, -4.0, 81.0, 40.0, 275.0, 367.0, -300.0, 205.0, 132.0, -93.0, 63.0, 103.0, 169.0, 27.0, 121.0, -335.0, 165.0, 85.0, 146.0, 191.0, -31.0, 32.0, -50.0, 260.0, 70.0, -338.0, 171.0, -108.0, 210.0, 23.0, 139.0, -93.0, 109.0, 14.0, 61.0, -16.0, 12.0, 250.0, 212.0, 21.0, -373.0, 132.0, 187.0, 140.0, 53.0, -85.0, -227.0, 160.0, 52.0, 61.0, 166.0, -4.0, -30.0, 28.0, 37.0, 22.0, -389.0, 176.0, 279.0, 42.0, 40.0, 189.0, 81.0, 18.0, 0.0, 49.0, 350.0, 215.0, 376.0, 326.0, 380.0, 139.0, 156.0, -130.0, 122.0, 92.0, -35.0, 337.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-56.0, -5.0, 0.0, 139.0, 0.0, -48.0, 0.0, 80.0, 0.0, -113.0, -121.0, -18.0, 60.0, -63.0, 196.0, -18.0, 118.0, 172.0, -400.0, 117.0, 0.0, 68.0, -64.0, 85.0, 97.0, 0.0, 0.0, 75.0, 23.0, -112.0, 122.0, -62.0, -35.0, -316.0, 92.0, -156.0, 0.0, 0.0, 140.0, 199.0, 60.0, 136.0, 102.0, 88.0, 139.0, 140.0, -48.0, -31.0, -19.0, -28.0, -7.0, -7.0, 174.0, 72.0, 198.0, 169.0, -147.0, -385.0, 180.0, 25.0, 113.0, 19.0, -221.0, -56.0, 42.0, 0.0, -49.0, 55.0, 66.0, 69.0, 0.0, -53.0, 0.0, 121.0, -337.0, -239.0, 67.0, 61.0, 85.0, 0.0, 22.0, 38.0, 193.0, -6.0, -251.0, 70.0, -36.0, -156.0, -8.0, -162.0, 183.0, 77.0, 26.0, -123.0, -315.0, -200.0, 20.0, 121.0, -268.0, -87.0, 75.0, 55.0, -43.0, -50.0, -199.0, 139.0, -104.0, -244.0, 0.0, 87.0, -116.0, 19.0, -112.0, 62.0, -116.0, 0.0, -102.0, -89.0, 186.0, 57.0, 184.0, -20.0, 142.0, -273.0, -334.0, -238.0, 98.0, -84.0, 176.0, 0.0, 98.0, -61.0, -266.0, 117.0, -468.0, 87.0, -301.0, -112.0, 158.0, 0.0, -43.0, 14.0, -107.0, 98.0, 31.0, 105.0, -160.0, 0.0, -60.0, -111.0, -39.0, 5.0, -35.0, -62.0, 58.0, -227.0, -346.0, -280.0, 105.0, 51.0, 64.0, 166.0, 99.0, -190.0, -301.0, 82.0, 19.0, 170.0, 57.0, -51.0, 18.0, 0.0, 0.0, 0.0, 65.0, -52.0, 155.0, 195.0, 96.0, 71.0, 199.0, 166.0, 99.0, 164.0, 190.0, 188.0, 111.0, -61.0, 20.0, 100.0, -147.0, -207.0, 121.0, -12.0, 140.0, -232.0, -68.0, -201.0, 167.0, 141.0], "policy_predator_policy_reward": [0.0, 133.0, 16.0, 1.0, 41.0, 33.0, 3.0, 0.0, 75.0, 3.0, 16.0, 132.0, 83.0, 0.0, 62.0, 0.0, 0.0, 12.0, 183.0, 200.0, 3.0, 41.0, 38.0, 45.0, 2.0, 0.0, 30.0, 15.0, 103.0, 1.0, 3.0, 31.0, 168.0, 53.0, 78.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 17.0, 8.0, 27.0, 48.0, 0.0, 128.0, 49.0, 5.0, 29.0, 0.0, 0.0, 0.0, 54.0, 178.0, 0.0, 0.0, 0.0, 0.0, 91.0, 93.0, 21.0, 0.0, 78.0, 19.0, 28.0, 6.0, 0.0, 80.0, 0.0, 0.0, 61.0, 180.0, 26.0, 11.0, 0.0, 0.0, 19.0, 67.0, 4.0, 0.0, 150.0, 0.0, 112.0, 112.0, 0.0, 120.0, 0.0, 0.0, 86.0, 81.0, 177.0, 0.0, 0.0, 30.0, 106.0, 141.0, 1.0, 79.0, 66.0, 50.0, 76.0, 123.0, 127.0, 128.0, 22.0, 0.0, 0.0, 111.0, 68.0, 43.0, 45.0, 55.0, 92.0, 111.0, 1.0, 6.0, 19.0, 29.0, 0.0, 152.0, 191.0, 8.0, 92.0, 26.0, 6.0, 5.0, 88.0, 15.0, 134.0, 68.0, 2.0, 294.0, 18.0, 168.0, 2.0, 0.0, 0.0, 81.0, 52.0, 18.0, 30.0, 0.0, 80.0, 76.0, 39.0, 102.0, 42.0, 20.0, 125.0, 9.0, 89.0, 102.0, 127.0, 110.0, 1.0, 19.0, 44.0, 5.0, 12.0, 121.0, 163.0, 96.0, 0.0, 0.0, 0.0, 75.0, 0.0, 0.0, 0.0, 0.0, 26.0, 10.0, 0.0, 0.0, 19.0, 29.0, 0.0, 11.0, 31.0, 32.0, 2.0, 0.0, 48.0, 41.0, 36.0, 0.0, 92.0, 132.0, 7.0, 6.0, 144.0, 40.0, 78.0, 156.0, 29.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8802047695706403, "mean_inference_ms": 2.776394699634795, "mean_action_processing_ms": 0.4566188358506718, "mean_env_wait_ms": 0.3204867716726647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011065125465393066, "StateBufferConnector_ms": 0.00536501407623291, "ViewRequirementAgentConnector_ms": 0.1392606496810913}, "num_episodes": 22, "episode_return_max": 380.0, "episode_return_min": -389.0, "episode_return_mean": 80.23, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.50487416791117, "num_env_steps_trained_throughput_per_sec": 317.50487416791117, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 13162.795, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13162.748, "sample_time_ms": 2199.83, "learn_time_ms": 10943.569, "learn_throughput": 365.511, "synch_weights_time_ms": 16.489}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "e1352_00002", "date": "2024-08-13_19-29-13", "timestamp": 1723591753, "time_this_iter_s": 12.641398668289185, "time_total_s": 1645.7966575622559, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d00940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1645.7966575622559, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 59.905555555555566, "ram_util_percent": 83.32222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1287584011832243, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 5.351703136434, "policy_loss": -0.003790555979376511, "vf_loss": 5.354644873154857, "vf_explained_var": 0.08624833506881875, "kl": 0.023846277272608407, "entropy": 1.170523177757465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.996302068296565, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 7.83647291698153, "policy_loss": 0.00016308070084070244, "vf_loss": 7.836306914324483, "vf_explained_var": -0.1810068562863365, "kl": 0.008848458475205202, "entropy": 0.9339425071206673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 380.0, "episode_reward_min": -389.0, "episode_reward_mean": 72.19, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -468.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 294.0}, "policy_reward_mean": {"prey_policy": -15.035, "predator_policy": 51.13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, 81.0, 40.0, 275.0, 367.0, -300.0, 205.0, 132.0, -93.0, 63.0, 103.0, 169.0, 27.0, 121.0, -335.0, 165.0, 85.0, 146.0, 191.0, -31.0, 32.0, -50.0, 260.0, 70.0, -338.0, 171.0, -108.0, 210.0, 23.0, 139.0, -93.0, 109.0, 14.0, 61.0, -16.0, 12.0, 250.0, 212.0, 21.0, -373.0, 132.0, 187.0, 140.0, 53.0, -85.0, -227.0, 160.0, 52.0, 61.0, 166.0, -4.0, -30.0, 28.0, 37.0, 22.0, -389.0, 176.0, 279.0, 42.0, 40.0, 189.0, 81.0, 18.0, 0.0, 49.0, 350.0, 215.0, 376.0, 326.0, 380.0, 139.0, 156.0, -130.0, 122.0, 92.0, -35.0, 337.0, -145.0, 298.0, -127.0, 35.0, 96.0, 52.0, 149.0, 193.0, 230.0, 166.0, -348.0, -43.0, 214.0, 248.0, -96.0, 102.0, -4.0, 335.0, 3.0, -132.0, 200.0, 201.0, 74.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-48.0, -31.0, -19.0, -28.0, -7.0, -7.0, 174.0, 72.0, 198.0, 169.0, -147.0, -385.0, 180.0, 25.0, 113.0, 19.0, -221.0, -56.0, 42.0, 0.0, -49.0, 55.0, 66.0, 69.0, 0.0, -53.0, 0.0, 121.0, -337.0, -239.0, 67.0, 61.0, 85.0, 0.0, 22.0, 38.0, 193.0, -6.0, -251.0, 70.0, -36.0, -156.0, -8.0, -162.0, 183.0, 77.0, 26.0, -123.0, -315.0, -200.0, 20.0, 121.0, -268.0, -87.0, 75.0, 55.0, -43.0, -50.0, -199.0, 139.0, -104.0, -244.0, 0.0, 87.0, -116.0, 19.0, -112.0, 62.0, -116.0, 0.0, -102.0, -89.0, 186.0, 57.0, 184.0, -20.0, 142.0, -273.0, -334.0, -238.0, 98.0, -84.0, 176.0, 0.0, 98.0, -61.0, -266.0, 117.0, -468.0, 87.0, -301.0, -112.0, 158.0, 0.0, -43.0, 14.0, -107.0, 98.0, 31.0, 105.0, -160.0, 0.0, -60.0, -111.0, -39.0, 5.0, -35.0, -62.0, 58.0, -227.0, -346.0, -280.0, 105.0, 51.0, 64.0, 166.0, 99.0, -190.0, -301.0, 82.0, 19.0, 170.0, 57.0, -51.0, 18.0, 0.0, 0.0, 0.0, 65.0, -52.0, 155.0, 195.0, 96.0, 71.0, 199.0, 166.0, 99.0, 164.0, 190.0, 188.0, 111.0, -61.0, 20.0, 100.0, -147.0, -207.0, 121.0, -12.0, 140.0, -232.0, -68.0, -201.0, 167.0, 141.0, -280.0, -115.0, 147.0, 117.0, -53.0, -304.0, -247.0, 130.0, -118.0, 67.0, -12.0, 0.0, 130.0, 0.0, 0.0, 190.0, 95.0, 130.0, -53.0, 118.0, -232.0, -307.0, -373.0, 25.0, 129.0, 8.0, 140.0, 76.0, -223.0, -180.0, -209.0, 168.0, -90.0, -13.0, 172.0, 156.0, -224.0, 0.0, -298.0, 0.0, 200.0, 0.0, 22.0, 141.0, 26.0, -36.0], "policy_predator_policy_reward": [27.0, 48.0, 0.0, 128.0, 49.0, 5.0, 29.0, 0.0, 0.0, 0.0, 54.0, 178.0, 0.0, 0.0, 0.0, 0.0, 91.0, 93.0, 21.0, 0.0, 78.0, 19.0, 28.0, 6.0, 0.0, 80.0, 0.0, 0.0, 61.0, 180.0, 26.0, 11.0, 0.0, 0.0, 19.0, 67.0, 4.0, 0.0, 150.0, 0.0, 112.0, 112.0, 0.0, 120.0, 0.0, 0.0, 86.0, 81.0, 177.0, 0.0, 0.0, 30.0, 106.0, 141.0, 1.0, 79.0, 66.0, 50.0, 76.0, 123.0, 127.0, 128.0, 22.0, 0.0, 0.0, 111.0, 68.0, 43.0, 45.0, 55.0, 92.0, 111.0, 1.0, 6.0, 19.0, 29.0, 0.0, 152.0, 191.0, 8.0, 92.0, 26.0, 6.0, 5.0, 88.0, 15.0, 134.0, 68.0, 2.0, 294.0, 18.0, 168.0, 2.0, 0.0, 0.0, 81.0, 52.0, 18.0, 30.0, 0.0, 80.0, 76.0, 39.0, 102.0, 42.0, 20.0, 125.0, 9.0, 89.0, 102.0, 127.0, 110.0, 1.0, 19.0, 44.0, 5.0, 12.0, 121.0, 163.0, 96.0, 0.0, 0.0, 0.0, 75.0, 0.0, 0.0, 0.0, 0.0, 26.0, 10.0, 0.0, 0.0, 19.0, 29.0, 0.0, 11.0, 31.0, 32.0, 2.0, 0.0, 48.0, 41.0, 36.0, 0.0, 92.0, 132.0, 7.0, 6.0, 144.0, 40.0, 78.0, 156.0, 29.0, 0.0, 92.0, 158.0, 34.0, 0.0, 74.0, 156.0, 0.0, 152.0, 84.0, 63.0, 64.0, 0.0, 19.0, 0.0, 3.0, 0.0, 0.0, 5.0, 101.0, 0.0, 17.0, 174.0, 163.0, 142.0, 77.0, 0.0, 27.0, 5.0, 150.0, 157.0, 143.0, 0.0, 99.0, 0.0, 5.0, 2.0, 140.0, 87.0, 0.0, 166.0, 0.0, 0.0, 0.0, 38.0, 84.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8832349278310656, "mean_inference_ms": 2.7904207532693595, "mean_action_processing_ms": 0.4558568359946388, "mean_env_wait_ms": 0.32171151208981746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010123014450073242, "StateBufferConnector_ms": 0.0044248104095458984, "ViewRequirementAgentConnector_ms": 0.16822147369384766}, "num_episodes": 23, "episode_return_max": 380.0, "episode_return_min": -389.0, "episode_return_mean": 72.19, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.17387236354875, "num_env_steps_trained_throughput_per_sec": 288.17387236354875, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 13405.431, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13405.379, "sample_time_ms": 2362.891, "learn_time_ms": 11024.78, "learn_throughput": 362.819, "synch_weights_time_ms": 14.912}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "e1352_00002", "date": "2024-08-13_19-29-27", "timestamp": 1723591767, "time_this_iter_s": 13.901051998138428, "time_total_s": 1659.6977095603943, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db85e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1659.6977095603943, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 62.19500000000001, "ram_util_percent": 75.76500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.312484098679174, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 0.00010000000000000003, "total_loss": 5.771536771330253, "policy_loss": -0.005587425724499755, "vf_loss": 5.776286511698728, "vf_explained_var": 0.07984123952174313, "kl": 0.01568881958377792, "entropy": 1.0926429437581824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.770748354707447, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.733732495484528, "policy_loss": -0.0019757463937999787, "vf_loss": 8.735703409790363, "vf_explained_var": -0.13906070583711858, "kl": 0.014610401576300249, "entropy": 0.8190032538282808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 380.0, "episode_reward_min": -389.0, "episode_reward_mean": 76.98, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -468.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 294.0}, "policy_reward_mean": {"prey_policy": -17.78, "predator_policy": 56.27}, "custom_metrics": {}, "hist_stats": {"episode_reward": [191.0, -31.0, 32.0, -50.0, 260.0, 70.0, -338.0, 171.0, -108.0, 210.0, 23.0, 139.0, -93.0, 109.0, 14.0, 61.0, -16.0, 12.0, 250.0, 212.0, 21.0, -373.0, 132.0, 187.0, 140.0, 53.0, -85.0, -227.0, 160.0, 52.0, 61.0, 166.0, -4.0, -30.0, 28.0, 37.0, 22.0, -389.0, 176.0, 279.0, 42.0, 40.0, 189.0, 81.0, 18.0, 0.0, 49.0, 350.0, 215.0, 376.0, 326.0, 380.0, 139.0, 156.0, -130.0, 122.0, 92.0, -35.0, 337.0, -145.0, 298.0, -127.0, 35.0, 96.0, 52.0, 149.0, 193.0, 230.0, 166.0, -348.0, -43.0, 214.0, 248.0, -96.0, 102.0, -4.0, 335.0, 3.0, -132.0, 200.0, 201.0, 74.0, 117.0, -46.0, 88.0, 148.0, 296.0, 243.0, 11.0, -281.0, 132.0, 104.0, 347.0, -58.0, 8.0, 18.0, 230.0, 181.0, 76.0, 112.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [193.0, -6.0, -251.0, 70.0, -36.0, -156.0, -8.0, -162.0, 183.0, 77.0, 26.0, -123.0, -315.0, -200.0, 20.0, 121.0, -268.0, -87.0, 75.0, 55.0, -43.0, -50.0, -199.0, 139.0, -104.0, -244.0, 0.0, 87.0, -116.0, 19.0, -112.0, 62.0, -116.0, 0.0, -102.0, -89.0, 186.0, 57.0, 184.0, -20.0, 142.0, -273.0, -334.0, -238.0, 98.0, -84.0, 176.0, 0.0, 98.0, -61.0, -266.0, 117.0, -468.0, 87.0, -301.0, -112.0, 158.0, 0.0, -43.0, 14.0, -107.0, 98.0, 31.0, 105.0, -160.0, 0.0, -60.0, -111.0, -39.0, 5.0, -35.0, -62.0, 58.0, -227.0, -346.0, -280.0, 105.0, 51.0, 64.0, 166.0, 99.0, -190.0, -301.0, 82.0, 19.0, 170.0, 57.0, -51.0, 18.0, 0.0, 0.0, 0.0, 65.0, -52.0, 155.0, 195.0, 96.0, 71.0, 199.0, 166.0, 99.0, 164.0, 190.0, 188.0, 111.0, -61.0, 20.0, 100.0, -147.0, -207.0, 121.0, -12.0, 140.0, -232.0, -68.0, -201.0, 167.0, 141.0, -280.0, -115.0, 147.0, 117.0, -53.0, -304.0, -247.0, 130.0, -118.0, 67.0, -12.0, 0.0, 130.0, 0.0, 0.0, 190.0, 95.0, 130.0, -53.0, 118.0, -232.0, -307.0, -373.0, 25.0, 129.0, 8.0, 140.0, 76.0, -223.0, -180.0, -209.0, 168.0, -90.0, -13.0, 172.0, 156.0, -224.0, 0.0, -298.0, 0.0, 200.0, 0.0, 22.0, 141.0, 26.0, -36.0, -113.0, 135.0, -259.0, -112.0, 67.0, -124.0, 0.0, 144.0, 67.0, 177.0, 39.0, 136.0, -70.0, -10.0, -298.0, -170.0, 157.0, -141.0, -200.0, 91.0, 156.0, 189.0, -10.0, -152.0, -322.0, 53.0, -145.0, 17.0, 123.0, 10.0, -66.0, 143.0, -42.0, 30.0, -54.0, -46.0], "policy_predator_policy_reward": [4.0, 0.0, 150.0, 0.0, 112.0, 112.0, 0.0, 120.0, 0.0, 0.0, 86.0, 81.0, 177.0, 0.0, 0.0, 30.0, 106.0, 141.0, 1.0, 79.0, 66.0, 50.0, 76.0, 123.0, 127.0, 128.0, 22.0, 0.0, 0.0, 111.0, 68.0, 43.0, 45.0, 55.0, 92.0, 111.0, 1.0, 6.0, 19.0, 29.0, 0.0, 152.0, 191.0, 8.0, 92.0, 26.0, 6.0, 5.0, 88.0, 15.0, 134.0, 68.0, 2.0, 294.0, 18.0, 168.0, 2.0, 0.0, 0.0, 81.0, 52.0, 18.0, 30.0, 0.0, 80.0, 76.0, 39.0, 102.0, 42.0, 20.0, 125.0, 9.0, 89.0, 102.0, 127.0, 110.0, 1.0, 19.0, 44.0, 5.0, 12.0, 121.0, 163.0, 96.0, 0.0, 0.0, 0.0, 75.0, 0.0, 0.0, 0.0, 0.0, 26.0, 10.0, 0.0, 0.0, 19.0, 29.0, 0.0, 11.0, 31.0, 32.0, 2.0, 0.0, 48.0, 41.0, 36.0, 0.0, 92.0, 132.0, 7.0, 6.0, 144.0, 40.0, 78.0, 156.0, 29.0, 0.0, 92.0, 158.0, 34.0, 0.0, 74.0, 156.0, 0.0, 152.0, 84.0, 63.0, 64.0, 0.0, 19.0, 0.0, 3.0, 0.0, 0.0, 5.0, 101.0, 0.0, 17.0, 174.0, 163.0, 142.0, 77.0, 0.0, 27.0, 5.0, 150.0, 157.0, 143.0, 0.0, 99.0, 0.0, 5.0, 2.0, 140.0, 87.0, 0.0, 166.0, 0.0, 0.0, 0.0, 38.0, 84.0, 0.0, 95.0, 0.0, 155.0, 170.0, 145.0, 0.0, 0.0, 4.0, 10.0, 42.0, 13.0, 55.0, 91.0, 0.0, 0.0, 187.0, 112.0, 4.0, 97.0, 116.0, 0.0, 2.0, 0.0, 104.0, 172.0, 105.0, 113.0, 33.0, 63.0, 34.0, 94.0, 10.0, 0.0, 88.0, 98.0, 114.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8880558169039429, "mean_inference_ms": 2.8012745767136478, "mean_action_processing_ms": 0.45579976139592643, "mean_env_wait_ms": 0.3228154855649274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00813746452331543, "StateBufferConnector_ms": 0.0047986507415771484, "ViewRequirementAgentConnector_ms": 0.18776893615722656}, "num_episodes": 18, "episode_return_max": 380.0, "episode_return_min": -389.0, "episode_return_mean": 76.98, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.25852741691043, "num_env_steps_trained_throughput_per_sec": 217.25852741691043, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 13916.813, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13916.759, "sample_time_ms": 2345.536, "learn_time_ms": 11552.216, "learn_throughput": 346.254, "synch_weights_time_ms": 15.777}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "e1352_00002", "date": "2024-08-13_19-29-46", "timestamp": 1723591786, "time_this_iter_s": 18.485755920410156, "time_total_s": 1678.1834654808044, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1678.1834654808044, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 86.96538461538461, "ram_util_percent": 81.63846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.518785017452858, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 0.00010000000000000003, "total_loss": 5.093400248396334, "policy_loss": -0.0054147768179299656, "vf_loss": 5.0974199843785115, "vf_explained_var": 0.05234293811535709, "kl": 0.02612757469551053, "entropy": 1.091532540132129, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.070500898266594, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.103649594039513, "policy_loss": -0.0004929984413412591, "vf_loss": 8.104139827798914, "vf_explained_var": -0.14849224497401525, "kl": 0.008315980875232238, "entropy": 0.8462360465021991, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 380.0, "episode_reward_min": -389.0, "episode_reward_mean": 91.83, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -468.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 294.0}, "policy_reward_mean": {"prey_policy": -7.4, "predator_policy": 53.315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [250.0, 212.0, 21.0, -373.0, 132.0, 187.0, 140.0, 53.0, -85.0, -227.0, 160.0, 52.0, 61.0, 166.0, -4.0, -30.0, 28.0, 37.0, 22.0, -389.0, 176.0, 279.0, 42.0, 40.0, 189.0, 81.0, 18.0, 0.0, 49.0, 350.0, 215.0, 376.0, 326.0, 380.0, 139.0, 156.0, -130.0, 122.0, 92.0, -35.0, 337.0, -145.0, 298.0, -127.0, 35.0, 96.0, 52.0, 149.0, 193.0, 230.0, 166.0, -348.0, -43.0, 214.0, 248.0, -96.0, 102.0, -4.0, 335.0, 3.0, -132.0, 200.0, 201.0, 74.0, 117.0, -46.0, 88.0, 148.0, 296.0, 243.0, 11.0, -281.0, 132.0, 104.0, 347.0, -58.0, 8.0, 18.0, 230.0, 181.0, 76.0, 112.0, 39.0, 120.0, 71.0, -61.0, 264.0, -92.0, 120.0, 195.0, 228.0, 194.0, 253.0, 68.0, 86.0, 162.0, 339.0, -121.0, 66.0, 210.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [186.0, 57.0, 184.0, -20.0, 142.0, -273.0, -334.0, -238.0, 98.0, -84.0, 176.0, 0.0, 98.0, -61.0, -266.0, 117.0, -468.0, 87.0, -301.0, -112.0, 158.0, 0.0, -43.0, 14.0, -107.0, 98.0, 31.0, 105.0, -160.0, 0.0, -60.0, -111.0, -39.0, 5.0, -35.0, -62.0, 58.0, -227.0, -346.0, -280.0, 105.0, 51.0, 64.0, 166.0, 99.0, -190.0, -301.0, 82.0, 19.0, 170.0, 57.0, -51.0, 18.0, 0.0, 0.0, 0.0, 65.0, -52.0, 155.0, 195.0, 96.0, 71.0, 199.0, 166.0, 99.0, 164.0, 190.0, 188.0, 111.0, -61.0, 20.0, 100.0, -147.0, -207.0, 121.0, -12.0, 140.0, -232.0, -68.0, -201.0, 167.0, 141.0, -280.0, -115.0, 147.0, 117.0, -53.0, -304.0, -247.0, 130.0, -118.0, 67.0, -12.0, 0.0, 130.0, 0.0, 0.0, 190.0, 95.0, 130.0, -53.0, 118.0, -232.0, -307.0, -373.0, 25.0, 129.0, 8.0, 140.0, 76.0, -223.0, -180.0, -209.0, 168.0, -90.0, -13.0, 172.0, 156.0, -224.0, 0.0, -298.0, 0.0, 200.0, 0.0, 22.0, 141.0, 26.0, -36.0, -113.0, 135.0, -259.0, -112.0, 67.0, -124.0, 0.0, 144.0, 67.0, 177.0, 39.0, 136.0, -70.0, -10.0, -298.0, -170.0, 157.0, -141.0, -200.0, 91.0, 156.0, 189.0, -10.0, -152.0, -322.0, 53.0, -145.0, 17.0, 123.0, 10.0, -66.0, 143.0, -42.0, 30.0, -54.0, -46.0, 128.0, -245.0, 0.0, 116.0, 114.0, -176.0, -191.0, 0.0, 105.0, 135.0, -319.0, -116.0, 105.0, -118.0, 0.0, 195.0, 127.0, 71.0, -9.0, 120.0, 149.0, 89.0, 61.0, -129.0, -36.0, 104.0, -139.0, 191.0, 182.0, 147.0, -390.0, -18.0, -34.0, 23.0, 85.0, 89.0], "policy_predator_policy_reward": [1.0, 6.0, 19.0, 29.0, 0.0, 152.0, 191.0, 8.0, 92.0, 26.0, 6.0, 5.0, 88.0, 15.0, 134.0, 68.0, 2.0, 294.0, 18.0, 168.0, 2.0, 0.0, 0.0, 81.0, 52.0, 18.0, 30.0, 0.0, 80.0, 76.0, 39.0, 102.0, 42.0, 20.0, 125.0, 9.0, 89.0, 102.0, 127.0, 110.0, 1.0, 19.0, 44.0, 5.0, 12.0, 121.0, 163.0, 96.0, 0.0, 0.0, 0.0, 75.0, 0.0, 0.0, 0.0, 0.0, 26.0, 10.0, 0.0, 0.0, 19.0, 29.0, 0.0, 11.0, 31.0, 32.0, 2.0, 0.0, 48.0, 41.0, 36.0, 0.0, 92.0, 132.0, 7.0, 6.0, 144.0, 40.0, 78.0, 156.0, 29.0, 0.0, 92.0, 158.0, 34.0, 0.0, 74.0, 156.0, 0.0, 152.0, 84.0, 63.0, 64.0, 0.0, 19.0, 0.0, 3.0, 0.0, 0.0, 5.0, 101.0, 0.0, 17.0, 174.0, 163.0, 142.0, 77.0, 0.0, 27.0, 5.0, 150.0, 157.0, 143.0, 0.0, 99.0, 0.0, 5.0, 2.0, 140.0, 87.0, 0.0, 166.0, 0.0, 0.0, 0.0, 38.0, 84.0, 0.0, 95.0, 0.0, 155.0, 170.0, 145.0, 0.0, 0.0, 4.0, 10.0, 42.0, 13.0, 55.0, 91.0, 0.0, 0.0, 187.0, 112.0, 4.0, 97.0, 116.0, 0.0, 2.0, 0.0, 104.0, 172.0, 105.0, 113.0, 33.0, 63.0, 34.0, 94.0, 10.0, 0.0, 88.0, 98.0, 114.0, 153.0, 3.0, 4.0, 0.0, 83.0, 50.0, 0.0, 130.0, 0.0, 24.0, 159.0, 184.0, 0.0, 133.0, 0.0, 0.0, 7.0, 23.0, 83.0, 0.0, 15.0, 0.0, 135.0, 1.0, 18.0, 0.0, 15.0, 95.0, 2.0, 8.0, 91.0, 196.0, 29.0, 48.0, 35.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8938999366619447, "mean_inference_ms": 2.8193317228947836, "mean_action_processing_ms": 0.4566735047781464, "mean_env_wait_ms": 0.3247031383807903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008098602294921875, "StateBufferConnector_ms": 0.004841804504394531, "ViewRequirementAgentConnector_ms": 0.18870234489440918}, "num_episodes": 18, "episode_return_max": 380.0, "episode_return_min": -389.0, "episode_return_mean": 91.83, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.2508866480446, "num_env_steps_trained_throughput_per_sec": 294.2508866480446, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 14023.777, "restore_workers_time_ms": 0.019, "training_step_time_ms": 14023.726, "sample_time_ms": 2427.959, "learn_time_ms": 11577.754, "learn_throughput": 345.49, "synch_weights_time_ms": 15.398}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "e1352_00002", "date": "2024-08-13_19-29-59", "timestamp": 1723591799, "time_this_iter_s": 13.60247802734375, "time_total_s": 1691.7859435081482, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1691.7859435081482, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 57.931578947368415, "ram_util_percent": 77.5421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.564994019679922, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 5.94547119191084, "policy_loss": -0.0015313872495892817, "vf_loss": 5.94616898153194, "vf_explained_var": 0.003149792693910145, "kl": 0.010408154786081841, "entropy": 0.9847789237738918, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 67.03139821401349, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 7.3039532383913714, "policy_loss": -0.0003932596228661991, "vf_loss": 7.304342671803066, "vf_explained_var": -0.25798245283661697, "kl": 0.011589572344619055, "entropy": 1.0133430704237922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 380.0, "episode_reward_min": -389.0, "episode_reward_mean": 95.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -390.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": -5.98, "predator_policy": 53.665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.0, -389.0, 176.0, 279.0, 42.0, 40.0, 189.0, 81.0, 18.0, 0.0, 49.0, 350.0, 215.0, 376.0, 326.0, 380.0, 139.0, 156.0, -130.0, 122.0, 92.0, -35.0, 337.0, -145.0, 298.0, -127.0, 35.0, 96.0, 52.0, 149.0, 193.0, 230.0, 166.0, -348.0, -43.0, 214.0, 248.0, -96.0, 102.0, -4.0, 335.0, 3.0, -132.0, 200.0, 201.0, 74.0, 117.0, -46.0, 88.0, 148.0, 296.0, 243.0, 11.0, -281.0, 132.0, 104.0, 347.0, -58.0, 8.0, 18.0, 230.0, 181.0, 76.0, 112.0, 39.0, 120.0, 71.0, -61.0, 264.0, -92.0, 120.0, 195.0, 228.0, 194.0, 253.0, 68.0, 86.0, 162.0, 339.0, -121.0, 66.0, 210.0, 81.0, 108.0, 182.0, 126.0, -45.0, 121.0, 289.0, 134.0, -172.0, 12.0, 162.0, 0.0, 37.0, 39.0, -100.0, -58.0, -2.0, 220.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [58.0, -227.0, -346.0, -280.0, 105.0, 51.0, 64.0, 166.0, 99.0, -190.0, -301.0, 82.0, 19.0, 170.0, 57.0, -51.0, 18.0, 0.0, 0.0, 0.0, 65.0, -52.0, 155.0, 195.0, 96.0, 71.0, 199.0, 166.0, 99.0, 164.0, 190.0, 188.0, 111.0, -61.0, 20.0, 100.0, -147.0, -207.0, 121.0, -12.0, 140.0, -232.0, -68.0, -201.0, 167.0, 141.0, -280.0, -115.0, 147.0, 117.0, -53.0, -304.0, -247.0, 130.0, -118.0, 67.0, -12.0, 0.0, 130.0, 0.0, 0.0, 190.0, 95.0, 130.0, -53.0, 118.0, -232.0, -307.0, -373.0, 25.0, 129.0, 8.0, 140.0, 76.0, -223.0, -180.0, -209.0, 168.0, -90.0, -13.0, 172.0, 156.0, -224.0, 0.0, -298.0, 0.0, 200.0, 0.0, 22.0, 141.0, 26.0, -36.0, -113.0, 135.0, -259.0, -112.0, 67.0, -124.0, 0.0, 144.0, 67.0, 177.0, 39.0, 136.0, -70.0, -10.0, -298.0, -170.0, 157.0, -141.0, -200.0, 91.0, 156.0, 189.0, -10.0, -152.0, -322.0, 53.0, -145.0, 17.0, 123.0, 10.0, -66.0, 143.0, -42.0, 30.0, -54.0, -46.0, 128.0, -245.0, 0.0, 116.0, 114.0, -176.0, -191.0, 0.0, 105.0, 135.0, -319.0, -116.0, 105.0, -118.0, 0.0, 195.0, 127.0, 71.0, -9.0, 120.0, 149.0, 89.0, 61.0, -129.0, -36.0, 104.0, -139.0, 191.0, 182.0, 147.0, -390.0, -18.0, -34.0, 23.0, 85.0, 89.0, -220.0, 102.0, 0.0, 108.0, -155.0, 176.0, 0.0, 97.0, -292.0, 65.0, 24.0, 47.0, 110.0, 179.0, -46.0, 107.0, -214.0, -158.0, -18.0, -44.0, -131.0, 151.0, 0.0, 0.0, -17.0, -42.0, 116.0, -280.0, -311.0, -34.0, -337.0, 71.0, 61.0, -245.0, 164.0, 32.0], "policy_predator_policy_reward": [89.0, 102.0, 127.0, 110.0, 1.0, 19.0, 44.0, 5.0, 12.0, 121.0, 163.0, 96.0, 0.0, 0.0, 0.0, 75.0, 0.0, 0.0, 0.0, 0.0, 26.0, 10.0, 0.0, 0.0, 19.0, 29.0, 0.0, 11.0, 31.0, 32.0, 2.0, 0.0, 48.0, 41.0, 36.0, 0.0, 92.0, 132.0, 7.0, 6.0, 144.0, 40.0, 78.0, 156.0, 29.0, 0.0, 92.0, 158.0, 34.0, 0.0, 74.0, 156.0, 0.0, 152.0, 84.0, 63.0, 64.0, 0.0, 19.0, 0.0, 3.0, 0.0, 0.0, 5.0, 101.0, 0.0, 17.0, 174.0, 163.0, 142.0, 77.0, 0.0, 27.0, 5.0, 150.0, 157.0, 143.0, 0.0, 99.0, 0.0, 5.0, 2.0, 140.0, 87.0, 0.0, 166.0, 0.0, 0.0, 0.0, 38.0, 84.0, 0.0, 95.0, 0.0, 155.0, 170.0, 145.0, 0.0, 0.0, 4.0, 10.0, 42.0, 13.0, 55.0, 91.0, 0.0, 0.0, 187.0, 112.0, 4.0, 97.0, 116.0, 0.0, 2.0, 0.0, 104.0, 172.0, 105.0, 113.0, 33.0, 63.0, 34.0, 94.0, 10.0, 0.0, 88.0, 98.0, 114.0, 153.0, 3.0, 4.0, 0.0, 83.0, 50.0, 0.0, 130.0, 0.0, 24.0, 159.0, 184.0, 0.0, 133.0, 0.0, 0.0, 7.0, 23.0, 83.0, 0.0, 15.0, 0.0, 135.0, 1.0, 18.0, 0.0, 15.0, 95.0, 2.0, 8.0, 91.0, 196.0, 29.0, 48.0, 35.0, 1.0, 60.0, 139.0, 0.0, 0.0, 44.0, 117.0, 26.0, 3.0, 0.0, 182.0, 15.0, 35.0, 0.0, 0.0, 37.0, 36.0, 168.0, 32.0, 9.0, 65.0, 81.0, 61.0, 0.0, 0.0, 59.0, 37.0, 100.0, 103.0, 82.0, 163.0, 35.0, 173.0, 75.0, 107.0, 22.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9022688472770577, "mean_inference_ms": 2.8435045581886764, "mean_action_processing_ms": 0.4583203738096712, "mean_env_wait_ms": 0.32711459591835707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010002493858337402, "StateBufferConnector_ms": 0.004907727241516113, "ViewRequirementAgentConnector_ms": 0.20854127407073975}, "num_episodes": 18, "episode_return_max": 380.0, "episode_return_min": -389.0, "episode_return_mean": 95.37, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 256.93661346466206, "num_env_steps_trained_throughput_per_sec": 256.93661346466206, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 13641.542, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13641.492, "sample_time_ms": 2559.138, "learn_time_ms": 11064.344, "learn_throughput": 361.522, "synch_weights_time_ms": 15.416}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "e1352_00002", "date": "2024-08-13_19-30-15", "timestamp": 1723591815, "time_this_iter_s": 15.611905097961426, "time_total_s": 1707.3978486061096, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1707.3978486061096, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 65.36363636363637, "ram_util_percent": 76.22727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.466123281230056, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 5.337950469198681, "policy_loss": -0.004074200098131779, "vf_loss": 5.340947282503522, "vf_explained_var": 0.007561156358668413, "kl": 0.013452137471090673, "entropy": 1.0184010627723876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 57.10047388937738, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 7.916431227184478, "policy_loss": -0.0019924248561322216, "vf_loss": 7.918419524601528, "vf_explained_var": -0.39857160493179605, "kl": 0.012502818258948396, "entropy": 0.984081947866571, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 347.0, "episode_reward_min": -348.0, "episode_reward_mean": 80.39, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -390.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": -13.135, "predator_policy": 53.33}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.0, -145.0, 298.0, -127.0, 35.0, 96.0, 52.0, 149.0, 193.0, 230.0, 166.0, -348.0, -43.0, 214.0, 248.0, -96.0, 102.0, -4.0, 335.0, 3.0, -132.0, 200.0, 201.0, 74.0, 117.0, -46.0, 88.0, 148.0, 296.0, 243.0, 11.0, -281.0, 132.0, 104.0, 347.0, -58.0, 8.0, 18.0, 230.0, 181.0, 76.0, 112.0, 39.0, 120.0, 71.0, -61.0, 264.0, -92.0, 120.0, 195.0, 228.0, 194.0, 253.0, 68.0, 86.0, 162.0, 339.0, -121.0, 66.0, 210.0, 81.0, 108.0, 182.0, 126.0, -45.0, 121.0, 289.0, 134.0, -172.0, 12.0, 162.0, 0.0, 37.0, 39.0, -100.0, -58.0, -2.0, 220.0, 75.0, 209.0, 21.0, 12.0, 72.0, 133.0, 41.0, 154.0, -7.0, 96.0, -11.0, 207.0, 11.0, 169.0, -110.0, -215.0, 45.0, 93.0, 7.0, -49.0, 10.0, 37.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [167.0, 141.0, -280.0, -115.0, 147.0, 117.0, -53.0, -304.0, -247.0, 130.0, -118.0, 67.0, -12.0, 0.0, 130.0, 0.0, 0.0, 190.0, 95.0, 130.0, -53.0, 118.0, -232.0, -307.0, -373.0, 25.0, 129.0, 8.0, 140.0, 76.0, -223.0, -180.0, -209.0, 168.0, -90.0, -13.0, 172.0, 156.0, -224.0, 0.0, -298.0, 0.0, 200.0, 0.0, 22.0, 141.0, 26.0, -36.0, -113.0, 135.0, -259.0, -112.0, 67.0, -124.0, 0.0, 144.0, 67.0, 177.0, 39.0, 136.0, -70.0, -10.0, -298.0, -170.0, 157.0, -141.0, -200.0, 91.0, 156.0, 189.0, -10.0, -152.0, -322.0, 53.0, -145.0, 17.0, 123.0, 10.0, -66.0, 143.0, -42.0, 30.0, -54.0, -46.0, 128.0, -245.0, 0.0, 116.0, 114.0, -176.0, -191.0, 0.0, 105.0, 135.0, -319.0, -116.0, 105.0, -118.0, 0.0, 195.0, 127.0, 71.0, -9.0, 120.0, 149.0, 89.0, 61.0, -129.0, -36.0, 104.0, -139.0, 191.0, 182.0, 147.0, -390.0, -18.0, -34.0, 23.0, 85.0, 89.0, -220.0, 102.0, 0.0, 108.0, -155.0, 176.0, 0.0, 97.0, -292.0, 65.0, 24.0, 47.0, 110.0, 179.0, -46.0, 107.0, -214.0, -158.0, -18.0, -44.0, -131.0, 151.0, 0.0, 0.0, -17.0, -42.0, 116.0, -280.0, -311.0, -34.0, -337.0, 71.0, 61.0, -245.0, 164.0, 32.0, 20.0, -61.0, 86.0, 63.0, 147.0, -285.0, -92.0, 0.0, 24.0, 30.0, 100.0, 0.0, -52.0, 0.0, 128.0, 26.0, -175.0, 29.0, 91.0, 0.0, -187.0, 29.0, 127.0, 40.0, 11.0, 0.0, 5.0, 99.0, -265.0, -2.0, -54.0, -349.0, -11.0, 37.0, 89.0, -2.0, -151.0, 8.0, 0.0, -167.0, 93.0, -224.0, -2.0, -40.0], "policy_predator_policy_reward": [29.0, 0.0, 92.0, 158.0, 34.0, 0.0, 74.0, 156.0, 0.0, 152.0, 84.0, 63.0, 64.0, 0.0, 19.0, 0.0, 3.0, 0.0, 0.0, 5.0, 101.0, 0.0, 17.0, 174.0, 163.0, 142.0, 77.0, 0.0, 27.0, 5.0, 150.0, 157.0, 143.0, 0.0, 99.0, 0.0, 5.0, 2.0, 140.0, 87.0, 0.0, 166.0, 0.0, 0.0, 0.0, 38.0, 84.0, 0.0, 95.0, 0.0, 155.0, 170.0, 145.0, 0.0, 0.0, 4.0, 10.0, 42.0, 13.0, 55.0, 91.0, 0.0, 0.0, 187.0, 112.0, 4.0, 97.0, 116.0, 0.0, 2.0, 0.0, 104.0, 172.0, 105.0, 113.0, 33.0, 63.0, 34.0, 94.0, 10.0, 0.0, 88.0, 98.0, 114.0, 153.0, 3.0, 4.0, 0.0, 83.0, 50.0, 0.0, 130.0, 0.0, 24.0, 159.0, 184.0, 0.0, 133.0, 0.0, 0.0, 7.0, 23.0, 83.0, 0.0, 15.0, 0.0, 135.0, 1.0, 18.0, 0.0, 15.0, 95.0, 2.0, 8.0, 91.0, 196.0, 29.0, 48.0, 35.0, 1.0, 60.0, 139.0, 0.0, 0.0, 44.0, 117.0, 26.0, 3.0, 0.0, 182.0, 15.0, 35.0, 0.0, 0.0, 37.0, 36.0, 168.0, 32.0, 9.0, 65.0, 81.0, 61.0, 0.0, 0.0, 59.0, 37.0, 100.0, 103.0, 82.0, 163.0, 35.0, 173.0, 75.0, 107.0, 22.0, 2.0, 83.0, 33.0, 6.0, 54.0, 156.0, 3.0, 28.0, 76.0, 0.0, 18.0, 0.0, 33.0, 38.0, 55.0, 0.0, 0.0, 56.0, 83.0, 4.0, 1.0, 147.0, 0.0, 29.0, 11.0, 0.0, 0.0, 64.0, 1.0, 3.0, 154.0, 10.0, 178.0, 8.0, 11.0, 5.0, 1.0, 83.0, 67.0, 1.0, 117.0, 119.0, 22.0, 22.0, 57.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9194631435974169, "mean_inference_ms": 2.89035473684988, "mean_action_processing_ms": 0.46253558108443615, "mean_env_wait_ms": 0.33305962306820625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008625268936157227, "StateBufferConnector_ms": 0.005997776985168457, "ViewRequirementAgentConnector_ms": 0.3536198139190674}, "num_episodes": 22, "episode_return_max": 347.0, "episode_return_min": -348.0, "episode_return_mean": 80.39, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 226.93979728694848, "num_env_steps_trained_throughput_per_sec": 226.93979728694848, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 14069.903, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14069.853, "sample_time_ms": 2927.146, "learn_time_ms": 11124.102, "learn_throughput": 359.58, "synch_weights_time_ms": 15.789}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "e1352_00002", "date": "2024-08-13_19-30-33", "timestamp": 1723591833, "time_this_iter_s": 17.664931058883667, "time_total_s": 1725.0627796649933, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d205e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1725.0627796649933, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 70.584, "ram_util_percent": 82.84}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.009900332191003, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 8.160125682972096, "policy_loss": -0.0008761521261283961, "vf_loss": 8.159885184222428, "vf_explained_var": 0.013378367852912378, "kl": 0.013942160815769399, "entropy": 0.9896902189999031, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.27426818274947, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 9.114265604120083, "policy_loss": -0.003899637382063601, "vf_loss": 9.118159798718004, "vf_explained_var": -0.4239520788823486, "kl": 0.01657115461957777, "entropy": 0.9086400156614011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 347.0, "episode_reward_min": -409.0, "episode_reward_mean": 61.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -390.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": -26.365, "predator_policy": 56.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.0, 117.0, -46.0, 88.0, 148.0, 296.0, 243.0, 11.0, -281.0, 132.0, 104.0, 347.0, -58.0, 8.0, 18.0, 230.0, 181.0, 76.0, 112.0, 39.0, 120.0, 71.0, -61.0, 264.0, -92.0, 120.0, 195.0, 228.0, 194.0, 253.0, 68.0, 86.0, 162.0, 339.0, -121.0, 66.0, 210.0, 81.0, 108.0, 182.0, 126.0, -45.0, 121.0, 289.0, 134.0, -172.0, 12.0, 162.0, 0.0, 37.0, 39.0, -100.0, -58.0, -2.0, 220.0, 75.0, 209.0, 21.0, 12.0, 72.0, 133.0, 41.0, 154.0, -7.0, 96.0, -11.0, 207.0, 11.0, 169.0, -110.0, -215.0, 45.0, 93.0, 7.0, -49.0, 10.0, 37.0, 56.0, -116.0, -80.0, 15.0, 25.0, -236.0, 50.0, -409.0, 134.0, 255.0, -82.0, 293.0, -112.0, 11.0, -117.0, 107.0, 51.0, 138.0, 55.0, 87.0, 53.0, -107.0, -39.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [26.0, -36.0, -113.0, 135.0, -259.0, -112.0, 67.0, -124.0, 0.0, 144.0, 67.0, 177.0, 39.0, 136.0, -70.0, -10.0, -298.0, -170.0, 157.0, -141.0, -200.0, 91.0, 156.0, 189.0, -10.0, -152.0, -322.0, 53.0, -145.0, 17.0, 123.0, 10.0, -66.0, 143.0, -42.0, 30.0, -54.0, -46.0, 128.0, -245.0, 0.0, 116.0, 114.0, -176.0, -191.0, 0.0, 105.0, 135.0, -319.0, -116.0, 105.0, -118.0, 0.0, 195.0, 127.0, 71.0, -9.0, 120.0, 149.0, 89.0, 61.0, -129.0, -36.0, 104.0, -139.0, 191.0, 182.0, 147.0, -390.0, -18.0, -34.0, 23.0, 85.0, 89.0, -220.0, 102.0, 0.0, 108.0, -155.0, 176.0, 0.0, 97.0, -292.0, 65.0, 24.0, 47.0, 110.0, 179.0, -46.0, 107.0, -214.0, -158.0, -18.0, -44.0, -131.0, 151.0, 0.0, 0.0, -17.0, -42.0, 116.0, -280.0, -311.0, -34.0, -337.0, 71.0, 61.0, -245.0, 164.0, 32.0, 20.0, -61.0, 86.0, 63.0, 147.0, -285.0, -92.0, 0.0, 24.0, 30.0, 100.0, 0.0, -52.0, 0.0, 128.0, 26.0, -175.0, 29.0, 91.0, 0.0, -187.0, 29.0, 127.0, 40.0, 11.0, 0.0, 5.0, 99.0, -265.0, -2.0, -54.0, -349.0, -11.0, 37.0, 89.0, -2.0, -151.0, 8.0, 0.0, -167.0, 93.0, -224.0, -2.0, -40.0, 4.0, -164.0, -195.0, -116.0, -111.0, -78.0, 26.0, -33.0, -106.0, -49.0, -349.0, -193.0, -58.0, -31.0, -382.0, -253.0, -9.0, 97.0, 18.0, 164.0, -6.0, -302.0, 129.0, 97.0, -317.0, 2.0, -305.0, 59.0, -88.0, -216.0, -19.0, 55.0, 47.0, -136.0, -19.0, 35.0, -4.0, 28.0, 18.0, 1.0, 0.0, 24.0, -175.0, -155.0, -265.0, 22.0], "policy_predator_policy_reward": [84.0, 0.0, 95.0, 0.0, 155.0, 170.0, 145.0, 0.0, 0.0, 4.0, 10.0, 42.0, 13.0, 55.0, 91.0, 0.0, 0.0, 187.0, 112.0, 4.0, 97.0, 116.0, 0.0, 2.0, 0.0, 104.0, 172.0, 105.0, 113.0, 33.0, 63.0, 34.0, 94.0, 10.0, 0.0, 88.0, 98.0, 114.0, 153.0, 3.0, 4.0, 0.0, 83.0, 50.0, 0.0, 130.0, 0.0, 24.0, 159.0, 184.0, 0.0, 133.0, 0.0, 0.0, 7.0, 23.0, 83.0, 0.0, 15.0, 0.0, 135.0, 1.0, 18.0, 0.0, 15.0, 95.0, 2.0, 8.0, 91.0, 196.0, 29.0, 48.0, 35.0, 1.0, 60.0, 139.0, 0.0, 0.0, 44.0, 117.0, 26.0, 3.0, 0.0, 182.0, 15.0, 35.0, 0.0, 0.0, 37.0, 36.0, 168.0, 32.0, 9.0, 65.0, 81.0, 61.0, 0.0, 0.0, 59.0, 37.0, 100.0, 103.0, 82.0, 163.0, 35.0, 173.0, 75.0, 107.0, 22.0, 2.0, 83.0, 33.0, 6.0, 54.0, 156.0, 3.0, 28.0, 76.0, 0.0, 18.0, 0.0, 33.0, 38.0, 55.0, 0.0, 0.0, 56.0, 83.0, 4.0, 1.0, 147.0, 0.0, 29.0, 11.0, 0.0, 0.0, 64.0, 1.0, 3.0, 154.0, 10.0, 178.0, 8.0, 11.0, 5.0, 1.0, 83.0, 67.0, 1.0, 117.0, 119.0, 22.0, 22.0, 57.0, 91.0, 125.0, 163.0, 32.0, 66.0, 43.0, 6.0, 16.0, 66.0, 114.0, 135.0, 171.0, 56.0, 83.0, 190.0, 36.0, 8.0, 38.0, 46.0, 27.0, 83.0, 143.0, 24.0, 43.0, 27.0, 176.0, 100.0, 157.0, 0.0, 187.0, 33.0, 38.0, 103.0, 37.0, 95.0, 27.0, 24.0, 7.0, 20.0, 48.0, 29.0, 0.0, 119.0, 104.0, 65.0, 139.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.93262635611088, "mean_inference_ms": 2.9289667468035883, "mean_action_processing_ms": 0.4656253545660292, "mean_env_wait_ms": 0.33813411658656095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007759690284729004, "StateBufferConnector_ms": 0.005976438522338867, "ViewRequirementAgentConnector_ms": 0.3293572664260864}, "num_episodes": 23, "episode_return_max": 347.0, "episode_return_min": -409.0, "episode_return_mean": 61.07, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.17006349590076, "num_env_steps_trained_throughput_per_sec": 316.17006349590076, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 14104.211, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14104.161, "sample_time_ms": 2888.814, "learn_time_ms": 11196.706, "learn_throughput": 357.248, "synch_weights_time_ms": 15.855}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "e1352_00002", "date": "2024-08-13_19-30-45", "timestamp": 1723591845, "time_this_iter_s": 12.708206176757812, "time_total_s": 1737.770985841751, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1737.770985841751, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 58.79999999999999, "ram_util_percent": 82.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2184235897959854, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 6.449671348440584, "policy_loss": -0.0017427193982743475, "vf_loss": 6.450754514320818, "vf_explained_var": 0.032573615716247964, "kl": 0.0082349811743731, "entropy": 1.04347454624832, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50.76758995822498, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.266118316297177, "policy_loss": -0.0015412772537539245, "vf_loss": 8.267655728355287, "vf_explained_var": -0.1942588147032198, "kl": 0.011759757727158256, "entropy": 0.9330283666098559, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 339.0, "episode_reward_min": -409.0, "episode_reward_mean": 51.4, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -390.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": -30.335, "predator_policy": 56.035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [112.0, 39.0, 120.0, 71.0, -61.0, 264.0, -92.0, 120.0, 195.0, 228.0, 194.0, 253.0, 68.0, 86.0, 162.0, 339.0, -121.0, 66.0, 210.0, 81.0, 108.0, 182.0, 126.0, -45.0, 121.0, 289.0, 134.0, -172.0, 12.0, 162.0, 0.0, 37.0, 39.0, -100.0, -58.0, -2.0, 220.0, 75.0, 209.0, 21.0, 12.0, 72.0, 133.0, 41.0, 154.0, -7.0, 96.0, -11.0, 207.0, 11.0, 169.0, -110.0, -215.0, 45.0, 93.0, 7.0, -49.0, 10.0, 37.0, 56.0, -116.0, -80.0, 15.0, 25.0, -236.0, 50.0, -409.0, 134.0, 255.0, -82.0, 293.0, -112.0, 11.0, -117.0, 107.0, 51.0, 138.0, 55.0, 87.0, 53.0, -107.0, -39.0, 301.0, 220.0, 62.0, -246.0, 78.0, -206.0, -118.0, 175.0, -10.0, -8.0, 163.0, 82.0, 269.0, 43.0, -269.0, 126.0, 119.0, -60.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-54.0, -46.0, 128.0, -245.0, 0.0, 116.0, 114.0, -176.0, -191.0, 0.0, 105.0, 135.0, -319.0, -116.0, 105.0, -118.0, 0.0, 195.0, 127.0, 71.0, -9.0, 120.0, 149.0, 89.0, 61.0, -129.0, -36.0, 104.0, -139.0, 191.0, 182.0, 147.0, -390.0, -18.0, -34.0, 23.0, 85.0, 89.0, -220.0, 102.0, 0.0, 108.0, -155.0, 176.0, 0.0, 97.0, -292.0, 65.0, 24.0, 47.0, 110.0, 179.0, -46.0, 107.0, -214.0, -158.0, -18.0, -44.0, -131.0, 151.0, 0.0, 0.0, -17.0, -42.0, 116.0, -280.0, -311.0, -34.0, -337.0, 71.0, 61.0, -245.0, 164.0, 32.0, 20.0, -61.0, 86.0, 63.0, 147.0, -285.0, -92.0, 0.0, 24.0, 30.0, 100.0, 0.0, -52.0, 0.0, 128.0, 26.0, -175.0, 29.0, 91.0, 0.0, -187.0, 29.0, 127.0, 40.0, 11.0, 0.0, 5.0, 99.0, -265.0, -2.0, -54.0, -349.0, -11.0, 37.0, 89.0, -2.0, -151.0, 8.0, 0.0, -167.0, 93.0, -224.0, -2.0, -40.0, 4.0, -164.0, -195.0, -116.0, -111.0, -78.0, 26.0, -33.0, -106.0, -49.0, -349.0, -193.0, -58.0, -31.0, -382.0, -253.0, -9.0, 97.0, 18.0, 164.0, -6.0, -302.0, 129.0, 97.0, -317.0, 2.0, -305.0, 59.0, -88.0, -216.0, -19.0, 55.0, 47.0, -136.0, -19.0, 35.0, -4.0, 28.0, 18.0, 1.0, 0.0, 24.0, -175.0, -155.0, -265.0, 22.0, 77.0, 185.0, -32.0, 180.0, 23.0, -22.0, -95.0, -329.0, 0.0, 38.0, -114.0, -348.0, -376.0, -52.0, 41.0, 0.0, -128.0, 0.0, 34.0, -172.0, 56.0, 56.0, 35.0, 0.0, 160.0, -2.0, -37.0, -4.0, -264.0, -241.0, 96.0, 0.0, 1.0, 56.0, 0.0, -126.0], "policy_predator_policy_reward": [98.0, 114.0, 153.0, 3.0, 4.0, 0.0, 83.0, 50.0, 0.0, 130.0, 0.0, 24.0, 159.0, 184.0, 0.0, 133.0, 0.0, 0.0, 7.0, 23.0, 83.0, 0.0, 15.0, 0.0, 135.0, 1.0, 18.0, 0.0, 15.0, 95.0, 2.0, 8.0, 91.0, 196.0, 29.0, 48.0, 35.0, 1.0, 60.0, 139.0, 0.0, 0.0, 44.0, 117.0, 26.0, 3.0, 0.0, 182.0, 15.0, 35.0, 0.0, 0.0, 37.0, 36.0, 168.0, 32.0, 9.0, 65.0, 81.0, 61.0, 0.0, 0.0, 59.0, 37.0, 100.0, 103.0, 82.0, 163.0, 35.0, 173.0, 75.0, 107.0, 22.0, 2.0, 83.0, 33.0, 6.0, 54.0, 156.0, 3.0, 28.0, 76.0, 0.0, 18.0, 0.0, 33.0, 38.0, 55.0, 0.0, 0.0, 56.0, 83.0, 4.0, 1.0, 147.0, 0.0, 29.0, 11.0, 0.0, 0.0, 64.0, 1.0, 3.0, 154.0, 10.0, 178.0, 8.0, 11.0, 5.0, 1.0, 83.0, 67.0, 1.0, 117.0, 119.0, 22.0, 22.0, 57.0, 91.0, 125.0, 163.0, 32.0, 66.0, 43.0, 6.0, 16.0, 66.0, 114.0, 135.0, 171.0, 56.0, 83.0, 190.0, 36.0, 8.0, 38.0, 46.0, 27.0, 83.0, 143.0, 24.0, 43.0, 27.0, 176.0, 100.0, 157.0, 0.0, 187.0, 33.0, 38.0, 103.0, 37.0, 95.0, 27.0, 24.0, 7.0, 20.0, 48.0, 29.0, 0.0, 119.0, 104.0, 65.0, 139.0, 27.0, 12.0, 6.0, 66.0, 57.0, 4.0, 176.0, 2.0, 0.0, 40.0, 116.0, 140.0, 127.0, 183.0, 78.0, 56.0, 104.0, 14.0, 119.0, 11.0, 4.0, 47.0, 14.0, 33.0, 56.0, 55.0, 73.0, 11.0, 149.0, 87.0, 30.0, 0.0, 61.0, 1.0, 21.0, 45.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9411805871676424, "mean_inference_ms": 2.951869655645064, "mean_action_processing_ms": 0.466907880334435, "mean_env_wait_ms": 0.34123963761667125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007768988609313965, "StateBufferConnector_ms": 0.005687355995178223, "ViewRequirementAgentConnector_ms": 0.3114023208618164}, "num_episodes": 18, "episode_return_max": 339.0, "episode_return_min": -409.0, "episode_return_mean": 51.4, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.4823255199263, "num_env_steps_trained_throughput_per_sec": 290.4823255199263, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 14283.711, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14283.662, "sample_time_ms": 2879.598, "learn_time_ms": 11383.744, "learn_throughput": 351.378, "synch_weights_time_ms": 16.737}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "e1352_00002", "date": "2024-08-13_19-30-59", "timestamp": 1723591859, "time_this_iter_s": 13.907940864562988, "time_total_s": 1751.678926706314, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2cf53a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1751.678926706314, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 63.32500000000001, "ram_util_percent": 82.545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.095470619643176, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 5.275034329374001, "policy_loss": -0.0018447720709320887, "vf_loss": 5.2761630086041, "vf_explained_var": 0.04968275594963598, "kl": 0.008941061018757076, "entropy": 1.0470394728360353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.98130931220357, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.318439846694785, "policy_loss": -0.0008644549256170948, "vf_loss": 8.319301825225669, "vf_explained_var": -0.18266337460311002, "kl": 0.007492502838456415, "entropy": 0.9762342170432762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -409.0, "episode_reward_mean": 46.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": -31.535, "predator_policy": 54.78}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.0, 81.0, 108.0, 182.0, 126.0, -45.0, 121.0, 289.0, 134.0, -172.0, 12.0, 162.0, 0.0, 37.0, 39.0, -100.0, -58.0, -2.0, 220.0, 75.0, 209.0, 21.0, 12.0, 72.0, 133.0, 41.0, 154.0, -7.0, 96.0, -11.0, 207.0, 11.0, 169.0, -110.0, -215.0, 45.0, 93.0, 7.0, -49.0, 10.0, 37.0, 56.0, -116.0, -80.0, 15.0, 25.0, -236.0, 50.0, -409.0, 134.0, 255.0, -82.0, 293.0, -112.0, 11.0, -117.0, 107.0, 51.0, 138.0, 55.0, 87.0, 53.0, -107.0, -39.0, 301.0, 220.0, 62.0, -246.0, 78.0, -206.0, -118.0, 175.0, -10.0, -8.0, 163.0, 82.0, 269.0, 43.0, -269.0, 126.0, 119.0, -60.0, 343.0, 149.0, 37.0, 56.0, -54.0, -276.0, 283.0, 224.0, -165.0, 328.0, -15.0, 189.0, -33.0, -63.0, 292.0, 32.0, 367.0, -142.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [85.0, 89.0, -220.0, 102.0, 0.0, 108.0, -155.0, 176.0, 0.0, 97.0, -292.0, 65.0, 24.0, 47.0, 110.0, 179.0, -46.0, 107.0, -214.0, -158.0, -18.0, -44.0, -131.0, 151.0, 0.0, 0.0, -17.0, -42.0, 116.0, -280.0, -311.0, -34.0, -337.0, 71.0, 61.0, -245.0, 164.0, 32.0, 20.0, -61.0, 86.0, 63.0, 147.0, -285.0, -92.0, 0.0, 24.0, 30.0, 100.0, 0.0, -52.0, 0.0, 128.0, 26.0, -175.0, 29.0, 91.0, 0.0, -187.0, 29.0, 127.0, 40.0, 11.0, 0.0, 5.0, 99.0, -265.0, -2.0, -54.0, -349.0, -11.0, 37.0, 89.0, -2.0, -151.0, 8.0, 0.0, -167.0, 93.0, -224.0, -2.0, -40.0, 4.0, -164.0, -195.0, -116.0, -111.0, -78.0, 26.0, -33.0, -106.0, -49.0, -349.0, -193.0, -58.0, -31.0, -382.0, -253.0, -9.0, 97.0, 18.0, 164.0, -6.0, -302.0, 129.0, 97.0, -317.0, 2.0, -305.0, 59.0, -88.0, -216.0, -19.0, 55.0, 47.0, -136.0, -19.0, 35.0, -4.0, 28.0, 18.0, 1.0, 0.0, 24.0, -175.0, -155.0, -265.0, 22.0, 77.0, 185.0, -32.0, 180.0, 23.0, -22.0, -95.0, -329.0, 0.0, 38.0, -114.0, -348.0, -376.0, -52.0, 41.0, 0.0, -128.0, 0.0, 34.0, -172.0, 56.0, 56.0, 35.0, 0.0, 160.0, -2.0, -37.0, -4.0, -264.0, -241.0, 96.0, 0.0, 1.0, 56.0, 0.0, -126.0, 195.0, 115.0, 14.0, 111.0, -29.0, -89.0, 56.0, 0.0, -183.0, -27.0, -108.0, -365.0, 143.0, 118.0, 25.0, 195.0, 0.0, -349.0, 185.0, 139.0, 151.0, -369.0, 159.0, 8.0, 0.0, -89.0, 0.0, -206.0, 65.0, 169.0, 123.0, -274.0, 168.0, 189.0, -338.0, 0.0], "policy_predator_policy_reward": [35.0, 1.0, 60.0, 139.0, 0.0, 0.0, 44.0, 117.0, 26.0, 3.0, 0.0, 182.0, 15.0, 35.0, 0.0, 0.0, 37.0, 36.0, 168.0, 32.0, 9.0, 65.0, 81.0, 61.0, 0.0, 0.0, 59.0, 37.0, 100.0, 103.0, 82.0, 163.0, 35.0, 173.0, 75.0, 107.0, 22.0, 2.0, 83.0, 33.0, 6.0, 54.0, 156.0, 3.0, 28.0, 76.0, 0.0, 18.0, 0.0, 33.0, 38.0, 55.0, 0.0, 0.0, 56.0, 83.0, 4.0, 1.0, 147.0, 0.0, 29.0, 11.0, 0.0, 0.0, 64.0, 1.0, 3.0, 154.0, 10.0, 178.0, 8.0, 11.0, 5.0, 1.0, 83.0, 67.0, 1.0, 117.0, 119.0, 22.0, 22.0, 57.0, 91.0, 125.0, 163.0, 32.0, 66.0, 43.0, 6.0, 16.0, 66.0, 114.0, 135.0, 171.0, 56.0, 83.0, 190.0, 36.0, 8.0, 38.0, 46.0, 27.0, 83.0, 143.0, 24.0, 43.0, 27.0, 176.0, 100.0, 157.0, 0.0, 187.0, 33.0, 38.0, 103.0, 37.0, 95.0, 27.0, 24.0, 7.0, 20.0, 48.0, 29.0, 0.0, 119.0, 104.0, 65.0, 139.0, 27.0, 12.0, 6.0, 66.0, 57.0, 4.0, 176.0, 2.0, 0.0, 40.0, 116.0, 140.0, 127.0, 183.0, 78.0, 56.0, 104.0, 14.0, 119.0, 11.0, 4.0, 47.0, 14.0, 33.0, 56.0, 55.0, 73.0, 11.0, 149.0, 87.0, 30.0, 0.0, 61.0, 1.0, 21.0, 45.0, 7.0, 26.0, 8.0, 16.0, 67.0, 88.0, 0.0, 0.0, 25.0, 131.0, 16.0, 181.0, 13.0, 9.0, 4.0, 0.0, 16.0, 168.0, 0.0, 4.0, 197.0, 6.0, 0.0, 22.0, 0.0, 56.0, 33.0, 110.0, 30.0, 28.0, 59.0, 124.0, 9.0, 1.0, 18.0, 178.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9490858375829814, "mean_inference_ms": 2.97201979299791, "mean_action_processing_ms": 0.46768538397263193, "mean_env_wait_ms": 0.3444585071260042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008310198783874512, "StateBufferConnector_ms": 0.006985664367675781, "ViewRequirementAgentConnector_ms": 0.3484848737716675}, "num_episodes": 18, "episode_return_max": 367.0, "episode_return_min": -409.0, "episode_return_mean": 46.49, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 252.42480870757936, "num_env_steps_trained_throughput_per_sec": 252.42480870757936, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 14660.71, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14660.656, "sample_time_ms": 2944.525, "learn_time_ms": 11691.336, "learn_throughput": 342.134, "synch_weights_time_ms": 19.956}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "e1352_00002", "date": "2024-08-13_19-31-15", "timestamp": 1723591875, "time_this_iter_s": 16.05944585800171, "time_total_s": 1767.7383725643158, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d205e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1767.7383725643158, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 78.43636363636365, "ram_util_percent": 83.83181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9408054072863212, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 6.266116203328289, "policy_loss": -0.00272005084488127, "vf_loss": 6.267812288627423, "vf_explained_var": 0.025145338830493746, "kl": 0.012785186243704309, "entropy": 1.0103871438553724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.223867226230404, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 9.065296783144511, "policy_loss": -0.002329557491515679, "vf_loss": 9.067620878875571, "vf_explained_var": -0.2158993871439071, "kl": 0.016528658510883233, "entropy": 0.8586984294432181, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -409.0, "episode_reward_mean": 44.79, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": -32.65, "predator_policy": 55.045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 72.0, 133.0, 41.0, 154.0, -7.0, 96.0, -11.0, 207.0, 11.0, 169.0, -110.0, -215.0, 45.0, 93.0, 7.0, -49.0, 10.0, 37.0, 56.0, -116.0, -80.0, 15.0, 25.0, -236.0, 50.0, -409.0, 134.0, 255.0, -82.0, 293.0, -112.0, 11.0, -117.0, 107.0, 51.0, 138.0, 55.0, 87.0, 53.0, -107.0, -39.0, 301.0, 220.0, 62.0, -246.0, 78.0, -206.0, -118.0, 175.0, -10.0, -8.0, 163.0, 82.0, 269.0, 43.0, -269.0, 126.0, 119.0, -60.0, 343.0, 149.0, 37.0, 56.0, -54.0, -276.0, 283.0, 224.0, -165.0, 328.0, -15.0, 189.0, -33.0, -63.0, 292.0, 32.0, 367.0, -142.0, -16.0, -191.0, 143.0, 136.0, 309.0, 175.0, -82.0, -143.0, 217.0, 35.0, -61.0, -11.0, 301.0, -3.0, 149.0, 309.0, 59.0, 167.0, -78.0, -161.0, 62.0, 163.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-92.0, 0.0, 24.0, 30.0, 100.0, 0.0, -52.0, 0.0, 128.0, 26.0, -175.0, 29.0, 91.0, 0.0, -187.0, 29.0, 127.0, 40.0, 11.0, 0.0, 5.0, 99.0, -265.0, -2.0, -54.0, -349.0, -11.0, 37.0, 89.0, -2.0, -151.0, 8.0, 0.0, -167.0, 93.0, -224.0, -2.0, -40.0, 4.0, -164.0, -195.0, -116.0, -111.0, -78.0, 26.0, -33.0, -106.0, -49.0, -349.0, -193.0, -58.0, -31.0, -382.0, -253.0, -9.0, 97.0, 18.0, 164.0, -6.0, -302.0, 129.0, 97.0, -317.0, 2.0, -305.0, 59.0, -88.0, -216.0, -19.0, 55.0, 47.0, -136.0, -19.0, 35.0, -4.0, 28.0, 18.0, 1.0, 0.0, 24.0, -175.0, -155.0, -265.0, 22.0, 77.0, 185.0, -32.0, 180.0, 23.0, -22.0, -95.0, -329.0, 0.0, 38.0, -114.0, -348.0, -376.0, -52.0, 41.0, 0.0, -128.0, 0.0, 34.0, -172.0, 56.0, 56.0, 35.0, 0.0, 160.0, -2.0, -37.0, -4.0, -264.0, -241.0, 96.0, 0.0, 1.0, 56.0, 0.0, -126.0, 195.0, 115.0, 14.0, 111.0, -29.0, -89.0, 56.0, 0.0, -183.0, -27.0, -108.0, -365.0, 143.0, 118.0, 25.0, 195.0, 0.0, -349.0, 185.0, 139.0, 151.0, -369.0, 159.0, 8.0, 0.0, -89.0, 0.0, -206.0, 65.0, 169.0, 123.0, -274.0, 168.0, 189.0, -338.0, 0.0, 0.0, -32.0, -162.0, -310.0, 107.0, 5.0, -71.0, 133.0, 150.0, 116.0, 144.0, 20.0, -347.0, -64.0, -16.0, -298.0, 68.0, 97.0, 29.0, 0.0, -153.0, -53.0, -4.0, -24.0, 90.0, 122.0, -235.0, 27.0, 173.0, -324.0, 156.0, 122.0, -80.0, 32.0, 10.0, 141.0, -84.0, -152.0, -346.0, -27.0, -104.0, -13.0, 143.0, 1.0], "policy_predator_policy_reward": [28.0, 76.0, 0.0, 18.0, 0.0, 33.0, 38.0, 55.0, 0.0, 0.0, 56.0, 83.0, 4.0, 1.0, 147.0, 0.0, 29.0, 11.0, 0.0, 0.0, 64.0, 1.0, 3.0, 154.0, 10.0, 178.0, 8.0, 11.0, 5.0, 1.0, 83.0, 67.0, 1.0, 117.0, 119.0, 22.0, 22.0, 57.0, 91.0, 125.0, 163.0, 32.0, 66.0, 43.0, 6.0, 16.0, 66.0, 114.0, 135.0, 171.0, 56.0, 83.0, 190.0, 36.0, 8.0, 38.0, 46.0, 27.0, 83.0, 143.0, 24.0, 43.0, 27.0, 176.0, 100.0, 157.0, 0.0, 187.0, 33.0, 38.0, 103.0, 37.0, 95.0, 27.0, 24.0, 7.0, 20.0, 48.0, 29.0, 0.0, 119.0, 104.0, 65.0, 139.0, 27.0, 12.0, 6.0, 66.0, 57.0, 4.0, 176.0, 2.0, 0.0, 40.0, 116.0, 140.0, 127.0, 183.0, 78.0, 56.0, 104.0, 14.0, 119.0, 11.0, 4.0, 47.0, 14.0, 33.0, 56.0, 55.0, 73.0, 11.0, 149.0, 87.0, 30.0, 0.0, 61.0, 1.0, 21.0, 45.0, 7.0, 26.0, 8.0, 16.0, 67.0, 88.0, 0.0, 0.0, 25.0, 131.0, 16.0, 181.0, 13.0, 9.0, 4.0, 0.0, 16.0, 168.0, 0.0, 4.0, 197.0, 6.0, 0.0, 22.0, 0.0, 56.0, 33.0, 110.0, 30.0, 28.0, 59.0, 124.0, 9.0, 1.0, 18.0, 178.0, 0.0, 16.0, 141.0, 140.0, 31.0, 0.0, 53.0, 21.0, 16.0, 27.0, 9.0, 2.0, 143.0, 186.0, 144.0, 27.0, 15.0, 37.0, 6.0, 0.0, 0.0, 145.0, 16.0, 1.0, 54.0, 35.0, 133.0, 72.0, 146.0, 154.0, 18.0, 13.0, 2.0, 105.0, 14.0, 2.0, 124.0, 34.0, 190.0, 22.0, 104.0, 75.0, 0.0, 19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9583011841985396, "mean_inference_ms": 2.9943199906072278, "mean_action_processing_ms": 0.46910253823935977, "mean_env_wait_ms": 0.3488947394570566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005897164344787598, "StateBufferConnector_ms": 0.006587982177734375, "ViewRequirementAgentConnector_ms": 0.37582337856292725}, "num_episodes": 22, "episode_return_max": 367.0, "episode_return_min": -409.0, "episode_return_mean": 44.79, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 221.77648649602554, "num_env_steps_trained_throughput_per_sec": 221.77648649602554, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 15198.188, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15198.13, "sample_time_ms": 3167.202, "learn_time_ms": 12004.551, "learn_throughput": 333.207, "synch_weights_time_ms": 20.903}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "e1352_00002", "date": "2024-08-13_19-31-34", "timestamp": 1723591894, "time_this_iter_s": 18.122509956359863, "time_total_s": 1785.8608825206757, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d00c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1785.8608825206757, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 85.69999999999997, "ram_util_percent": 83.84230769230768}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5463801562155366, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 7.360209653491066, "policy_loss": -0.003385165933194378, "vf_loss": 7.362450004759289, "vf_explained_var": 0.01934862770731487, "kl": 0.014294206649313248, "entropy": 1.0123090567727568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.348054932318036, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.523668520034306, "policy_loss": -0.0019320002894986559, "vf_loss": 8.525595377361963, "vf_explained_var": -0.13546625744728816, "kl": 0.015534821209438159, "entropy": 0.9047486964987699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -409.0, "episode_reward_mean": 44.12, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": -35.775, "predator_policy": 57.835}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.0, 56.0, -116.0, -80.0, 15.0, 25.0, -236.0, 50.0, -409.0, 134.0, 255.0, -82.0, 293.0, -112.0, 11.0, -117.0, 107.0, 51.0, 138.0, 55.0, 87.0, 53.0, -107.0, -39.0, 301.0, 220.0, 62.0, -246.0, 78.0, -206.0, -118.0, 175.0, -10.0, -8.0, 163.0, 82.0, 269.0, 43.0, -269.0, 126.0, 119.0, -60.0, 343.0, 149.0, 37.0, 56.0, -54.0, -276.0, 283.0, 224.0, -165.0, 328.0, -15.0, 189.0, -33.0, -63.0, 292.0, 32.0, 367.0, -142.0, -16.0, -191.0, 143.0, 136.0, 309.0, 175.0, -82.0, -143.0, 217.0, 35.0, -61.0, -11.0, 301.0, -3.0, 149.0, 309.0, 59.0, 167.0, -78.0, -161.0, 62.0, 163.0, 209.0, 40.0, 205.0, -199.0, 116.0, 116.0, 79.0, 186.0, 0.0, 116.0, 36.0, -23.0, 108.0, 2.0, 20.0, -380.0, -179.0, 139.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, -40.0, 4.0, -164.0, -195.0, -116.0, -111.0, -78.0, 26.0, -33.0, -106.0, -49.0, -349.0, -193.0, -58.0, -31.0, -382.0, -253.0, -9.0, 97.0, 18.0, 164.0, -6.0, -302.0, 129.0, 97.0, -317.0, 2.0, -305.0, 59.0, -88.0, -216.0, -19.0, 55.0, 47.0, -136.0, -19.0, 35.0, -4.0, 28.0, 18.0, 1.0, 0.0, 24.0, -175.0, -155.0, -265.0, 22.0, 77.0, 185.0, -32.0, 180.0, 23.0, -22.0, -95.0, -329.0, 0.0, 38.0, -114.0, -348.0, -376.0, -52.0, 41.0, 0.0, -128.0, 0.0, 34.0, -172.0, 56.0, 56.0, 35.0, 0.0, 160.0, -2.0, -37.0, -4.0, -264.0, -241.0, 96.0, 0.0, 1.0, 56.0, 0.0, -126.0, 195.0, 115.0, 14.0, 111.0, -29.0, -89.0, 56.0, 0.0, -183.0, -27.0, -108.0, -365.0, 143.0, 118.0, 25.0, 195.0, 0.0, -349.0, 185.0, 139.0, 151.0, -369.0, 159.0, 8.0, 0.0, -89.0, 0.0, -206.0, 65.0, 169.0, 123.0, -274.0, 168.0, 189.0, -338.0, 0.0, 0.0, -32.0, -162.0, -310.0, 107.0, 5.0, -71.0, 133.0, 150.0, 116.0, 144.0, 20.0, -347.0, -64.0, -16.0, -298.0, 68.0, 97.0, 29.0, 0.0, -153.0, -53.0, -4.0, -24.0, 90.0, 122.0, -235.0, 27.0, 173.0, -324.0, 156.0, 122.0, -80.0, 32.0, 10.0, 141.0, -84.0, -152.0, -346.0, -27.0, -104.0, -13.0, 143.0, 1.0, 89.0, 74.0, -250.0, 129.0, 38.0, 111.0, -103.0, -248.0, 113.0, -77.0, 7.0, 11.0, -62.0, -8.0, 144.0, 22.0, 0.0, 0.0, 58.0, -43.0, 37.0, -175.0, 0.0, -49.0, 147.0, -182.0, 0.0, -96.0, 72.0, -181.0, -287.0, -362.0, -59.0, -329.0, 59.0, 10.0], "policy_predator_policy_reward": [22.0, 57.0, 91.0, 125.0, 163.0, 32.0, 66.0, 43.0, 6.0, 16.0, 66.0, 114.0, 135.0, 171.0, 56.0, 83.0, 190.0, 36.0, 8.0, 38.0, 46.0, 27.0, 83.0, 143.0, 24.0, 43.0, 27.0, 176.0, 100.0, 157.0, 0.0, 187.0, 33.0, 38.0, 103.0, 37.0, 95.0, 27.0, 24.0, 7.0, 20.0, 48.0, 29.0, 0.0, 119.0, 104.0, 65.0, 139.0, 27.0, 12.0, 6.0, 66.0, 57.0, 4.0, 176.0, 2.0, 0.0, 40.0, 116.0, 140.0, 127.0, 183.0, 78.0, 56.0, 104.0, 14.0, 119.0, 11.0, 4.0, 47.0, 14.0, 33.0, 56.0, 55.0, 73.0, 11.0, 149.0, 87.0, 30.0, 0.0, 61.0, 1.0, 21.0, 45.0, 7.0, 26.0, 8.0, 16.0, 67.0, 88.0, 0.0, 0.0, 25.0, 131.0, 16.0, 181.0, 13.0, 9.0, 4.0, 0.0, 16.0, 168.0, 0.0, 4.0, 197.0, 6.0, 0.0, 22.0, 0.0, 56.0, 33.0, 110.0, 30.0, 28.0, 59.0, 124.0, 9.0, 1.0, 18.0, 178.0, 0.0, 16.0, 141.0, 140.0, 31.0, 0.0, 53.0, 21.0, 16.0, 27.0, 9.0, 2.0, 143.0, 186.0, 144.0, 27.0, 15.0, 37.0, 6.0, 0.0, 0.0, 145.0, 16.0, 1.0, 54.0, 35.0, 133.0, 72.0, 146.0, 154.0, 18.0, 13.0, 2.0, 105.0, 14.0, 2.0, 124.0, 34.0, 190.0, 22.0, 104.0, 75.0, 0.0, 19.0, 18.0, 28.0, 11.0, 150.0, 21.0, 35.0, 111.0, 41.0, 21.0, 59.0, 32.0, 66.0, 67.0, 82.0, 11.0, 9.0, 0.0, 0.0, 57.0, 44.0, 165.0, 9.0, 0.0, 26.0, 118.0, 25.0, 70.0, 28.0, 124.0, 5.0, 191.0, 78.0, 185.0, 24.0, 41.0, 29.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9618285031464211, "mean_inference_ms": 3.00568729308463, "mean_action_processing_ms": 0.4688372654102338, "mean_env_wait_ms": 0.34999655929883566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00612485408782959, "StateBufferConnector_ms": 0.005876421928405762, "ViewRequirementAgentConnector_ms": 0.30089831352233887}, "num_episodes": 18, "episode_return_max": 367.0, "episode_return_min": -409.0, "episode_return_mean": 44.12, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.56710145021367, "num_env_steps_trained_throughput_per_sec": 293.56710145021367, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 15300.916, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15300.857, "sample_time_ms": 3209.262, "learn_time_ms": 12067.19, "learn_throughput": 331.477, "synch_weights_time_ms": 19.364}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "e1352_00002", "date": "2024-08-13_19-31-47", "timestamp": 1723591907, "time_this_iter_s": 13.668597221374512, "time_total_s": 1799.5294797420502, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d62700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1799.5294797420502, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 68.74736842105263, "ram_util_percent": 81.27368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.48213575547019, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 6.450202139344795, "policy_loss": -0.0010494461191926526, "vf_loss": 6.449975419675232, "vf_explained_var": 0.060463965853686054, "kl": 0.01593419289398551, "entropy": 1.0175682169419749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 44.08529315401638, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.761236642655872, "policy_loss": 3.253879966756339e-05, "vf_loss": 8.76120109583335, "vf_explained_var": -0.364703562650731, "kl": 0.009167873518431357, "entropy": 0.903226001079751, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -380.0, "episode_reward_mean": 52.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -376.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": -29.465, "predator_policy": 55.5}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.0, 301.0, 220.0, 62.0, -246.0, 78.0, -206.0, -118.0, 175.0, -10.0, -8.0, 163.0, 82.0, 269.0, 43.0, -269.0, 126.0, 119.0, -60.0, 343.0, 149.0, 37.0, 56.0, -54.0, -276.0, 283.0, 224.0, -165.0, 328.0, -15.0, 189.0, -33.0, -63.0, 292.0, 32.0, 367.0, -142.0, -16.0, -191.0, 143.0, 136.0, 309.0, 175.0, -82.0, -143.0, 217.0, 35.0, -61.0, -11.0, 301.0, -3.0, 149.0, 309.0, 59.0, 167.0, -78.0, -161.0, 62.0, 163.0, 209.0, 40.0, 205.0, -199.0, 116.0, 116.0, 79.0, 186.0, 0.0, 116.0, 36.0, -23.0, 108.0, 2.0, 20.0, -380.0, -179.0, 139.0, 73.0, 73.0, 10.0, 10.0, -63.0, -69.0, 88.0, -36.0, 123.0, 94.0, -8.0, 101.0, 23.0, 307.0, -9.0, 106.0, -130.0, 43.0, 64.0, -43.0, -40.0, 233.0, -47.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-265.0, 22.0, 77.0, 185.0, -32.0, 180.0, 23.0, -22.0, -95.0, -329.0, 0.0, 38.0, -114.0, -348.0, -376.0, -52.0, 41.0, 0.0, -128.0, 0.0, 34.0, -172.0, 56.0, 56.0, 35.0, 0.0, 160.0, -2.0, -37.0, -4.0, -264.0, -241.0, 96.0, 0.0, 1.0, 56.0, 0.0, -126.0, 195.0, 115.0, 14.0, 111.0, -29.0, -89.0, 56.0, 0.0, -183.0, -27.0, -108.0, -365.0, 143.0, 118.0, 25.0, 195.0, 0.0, -349.0, 185.0, 139.0, 151.0, -369.0, 159.0, 8.0, 0.0, -89.0, 0.0, -206.0, 65.0, 169.0, 123.0, -274.0, 168.0, 189.0, -338.0, 0.0, 0.0, -32.0, -162.0, -310.0, 107.0, 5.0, -71.0, 133.0, 150.0, 116.0, 144.0, 20.0, -347.0, -64.0, -16.0, -298.0, 68.0, 97.0, 29.0, 0.0, -153.0, -53.0, -4.0, -24.0, 90.0, 122.0, -235.0, 27.0, 173.0, -324.0, 156.0, 122.0, -80.0, 32.0, 10.0, 141.0, -84.0, -152.0, -346.0, -27.0, -104.0, -13.0, 143.0, 1.0, 89.0, 74.0, -250.0, 129.0, 38.0, 111.0, -103.0, -248.0, 113.0, -77.0, 7.0, 11.0, -62.0, -8.0, 144.0, 22.0, 0.0, 0.0, 58.0, -43.0, 37.0, -175.0, 0.0, -49.0, 147.0, -182.0, 0.0, -96.0, 72.0, -181.0, -287.0, -362.0, -59.0, -329.0, 59.0, 10.0, -153.0, 107.0, -2.0, 61.0, -61.0, -88.0, -22.0, 8.0, -6.0, -292.0, -109.0, -133.0, -136.0, 130.0, 52.0, -297.0, 30.0, -17.0, -40.0, 74.0, -150.0, 50.0, 0.0, 53.0, -55.0, -131.0, 138.0, 146.0, -22.0, -142.0, -155.0, 130.0, -247.0, -54.0, -28.0, -18.0, 104.0, -178.0, -211.0, 0.0, 0.0, -80.0, -28.0, 181.0, -346.0, 92.0], "policy_predator_policy_reward": [65.0, 139.0, 27.0, 12.0, 6.0, 66.0, 57.0, 4.0, 176.0, 2.0, 0.0, 40.0, 116.0, 140.0, 127.0, 183.0, 78.0, 56.0, 104.0, 14.0, 119.0, 11.0, 4.0, 47.0, 14.0, 33.0, 56.0, 55.0, 73.0, 11.0, 149.0, 87.0, 30.0, 0.0, 61.0, 1.0, 21.0, 45.0, 7.0, 26.0, 8.0, 16.0, 67.0, 88.0, 0.0, 0.0, 25.0, 131.0, 16.0, 181.0, 13.0, 9.0, 4.0, 0.0, 16.0, 168.0, 0.0, 4.0, 197.0, 6.0, 0.0, 22.0, 0.0, 56.0, 33.0, 110.0, 30.0, 28.0, 59.0, 124.0, 9.0, 1.0, 18.0, 178.0, 0.0, 16.0, 141.0, 140.0, 31.0, 0.0, 53.0, 21.0, 16.0, 27.0, 9.0, 2.0, 143.0, 186.0, 144.0, 27.0, 15.0, 37.0, 6.0, 0.0, 0.0, 145.0, 16.0, 1.0, 54.0, 35.0, 133.0, 72.0, 146.0, 154.0, 18.0, 13.0, 2.0, 105.0, 14.0, 2.0, 124.0, 34.0, 190.0, 22.0, 104.0, 75.0, 0.0, 19.0, 18.0, 28.0, 11.0, 150.0, 21.0, 35.0, 111.0, 41.0, 21.0, 59.0, 32.0, 66.0, 67.0, 82.0, 11.0, 9.0, 0.0, 0.0, 57.0, 44.0, 165.0, 9.0, 0.0, 26.0, 118.0, 25.0, 70.0, 28.0, 124.0, 5.0, 191.0, 78.0, 185.0, 24.0, 41.0, 29.0, 118.0, 1.0, 8.0, 6.0, 22.0, 137.0, 16.0, 8.0, 98.0, 137.0, 165.0, 8.0, 32.0, 62.0, 102.0, 107.0, 51.0, 59.0, 40.0, 20.0, 87.0, 5.0, 4.0, 44.0, 81.0, 128.0, 21.0, 2.0, 11.0, 144.0, 75.0, 56.0, 65.0, 106.0, 44.0, 45.0, 45.0, 93.0, 95.0, 73.0, 0.0, 40.0, 0.0, 80.0, 181.0, 26.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9675323612227062, "mean_inference_ms": 3.0202619251392373, "mean_action_processing_ms": 0.4690669911500116, "mean_env_wait_ms": 0.3519820219492489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069735050201416016, "StateBufferConnector_ms": 0.006125807762145996, "ViewRequirementAgentConnector_ms": 0.34777259826660156}, "num_episodes": 23, "episode_return_max": 367.0, "episode_return_min": -380.0, "episode_return_mean": 52.07, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.7379103831908, "num_env_steps_trained_throughput_per_sec": 315.7379103831908, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 15179.737, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15179.683, "sample_time_ms": 3100.944, "learn_time_ms": 12054.009, "learn_throughput": 331.84, "synch_weights_time_ms": 19.335}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "e1352_00002", "date": "2024-08-13_19-32-00", "timestamp": 1723591920, "time_this_iter_s": 12.719864845275879, "time_total_s": 1812.249344587326, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d62160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1812.249344587326, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 64.09444444444445, "ram_util_percent": 78.80555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.534394659015237, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 6.358068616301925, "policy_loss": -0.00319369937312942, "vf_loss": 6.360411211044069, "vf_explained_var": 0.011459073156276077, "kl": 0.010626474144240252, "entropy": 0.9462956030848165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.223926629559706, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.39428333655867, "policy_loss": -0.0021112862654109163, "vf_loss": 8.396389083256798, "vf_explained_var": -0.18525760176951292, "kl": 0.01685000282221192, "entropy": 0.8623328046823936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -380.0, "episode_reward_mean": 45.33, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -369.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": -32.14, "predator_policy": 54.805}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.0, 343.0, 149.0, 37.0, 56.0, -54.0, -276.0, 283.0, 224.0, -165.0, 328.0, -15.0, 189.0, -33.0, -63.0, 292.0, 32.0, 367.0, -142.0, -16.0, -191.0, 143.0, 136.0, 309.0, 175.0, -82.0, -143.0, 217.0, 35.0, -61.0, -11.0, 301.0, -3.0, 149.0, 309.0, 59.0, 167.0, -78.0, -161.0, 62.0, 163.0, 209.0, 40.0, 205.0, -199.0, 116.0, 116.0, 79.0, 186.0, 0.0, 116.0, 36.0, -23.0, 108.0, 2.0, 20.0, -380.0, -179.0, 139.0, 73.0, 73.0, 10.0, 10.0, -63.0, -69.0, 88.0, -36.0, 123.0, 94.0, -8.0, 101.0, 23.0, 307.0, -9.0, 106.0, -130.0, 43.0, 64.0, -43.0, -40.0, 233.0, -47.0, -88.0, 345.0, -5.0, -25.0, 133.0, -57.0, -29.0, 202.0, -47.0, -291.0, -224.0, -106.0, 126.0, 78.0, 48.0, 42.0, -18.0, -16.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -126.0, 195.0, 115.0, 14.0, 111.0, -29.0, -89.0, 56.0, 0.0, -183.0, -27.0, -108.0, -365.0, 143.0, 118.0, 25.0, 195.0, 0.0, -349.0, 185.0, 139.0, 151.0, -369.0, 159.0, 8.0, 0.0, -89.0, 0.0, -206.0, 65.0, 169.0, 123.0, -274.0, 168.0, 189.0, -338.0, 0.0, 0.0, -32.0, -162.0, -310.0, 107.0, 5.0, -71.0, 133.0, 150.0, 116.0, 144.0, 20.0, -347.0, -64.0, -16.0, -298.0, 68.0, 97.0, 29.0, 0.0, -153.0, -53.0, -4.0, -24.0, 90.0, 122.0, -235.0, 27.0, 173.0, -324.0, 156.0, 122.0, -80.0, 32.0, 10.0, 141.0, -84.0, -152.0, -346.0, -27.0, -104.0, -13.0, 143.0, 1.0, 89.0, 74.0, -250.0, 129.0, 38.0, 111.0, -103.0, -248.0, 113.0, -77.0, 7.0, 11.0, -62.0, -8.0, 144.0, 22.0, 0.0, 0.0, 58.0, -43.0, 37.0, -175.0, 0.0, -49.0, 147.0, -182.0, 0.0, -96.0, 72.0, -181.0, -287.0, -362.0, -59.0, -329.0, 59.0, 10.0, -153.0, 107.0, -2.0, 61.0, -61.0, -88.0, -22.0, 8.0, -6.0, -292.0, -109.0, -133.0, -136.0, 130.0, 52.0, -297.0, 30.0, -17.0, -40.0, 74.0, -150.0, 50.0, 0.0, 53.0, -55.0, -131.0, 138.0, 146.0, -22.0, -142.0, -155.0, 130.0, -247.0, -54.0, -28.0, -18.0, 104.0, -178.0, -211.0, 0.0, 0.0, -80.0, -28.0, 181.0, -346.0, 92.0, -2.0, -179.0, 136.0, 191.0, 0.0, -10.0, -76.0, -52.0, 135.0, -10.0, -166.0, -28.0, -47.0, -175.0, 60.0, 137.0, -273.0, 66.0, -313.0, -208.0, -317.0, -158.0, -91.0, -173.0, 192.0, -136.0, 70.0, -70.0, -112.0, 76.0, -48.0, 0.0, -267.0, 81.0, -38.0, -151.0], "policy_predator_policy_reward": [21.0, 45.0, 7.0, 26.0, 8.0, 16.0, 67.0, 88.0, 0.0, 0.0, 25.0, 131.0, 16.0, 181.0, 13.0, 9.0, 4.0, 0.0, 16.0, 168.0, 0.0, 4.0, 197.0, 6.0, 0.0, 22.0, 0.0, 56.0, 33.0, 110.0, 30.0, 28.0, 59.0, 124.0, 9.0, 1.0, 18.0, 178.0, 0.0, 16.0, 141.0, 140.0, 31.0, 0.0, 53.0, 21.0, 16.0, 27.0, 9.0, 2.0, 143.0, 186.0, 144.0, 27.0, 15.0, 37.0, 6.0, 0.0, 0.0, 145.0, 16.0, 1.0, 54.0, 35.0, 133.0, 72.0, 146.0, 154.0, 18.0, 13.0, 2.0, 105.0, 14.0, 2.0, 124.0, 34.0, 190.0, 22.0, 104.0, 75.0, 0.0, 19.0, 18.0, 28.0, 11.0, 150.0, 21.0, 35.0, 111.0, 41.0, 21.0, 59.0, 32.0, 66.0, 67.0, 82.0, 11.0, 9.0, 0.0, 0.0, 57.0, 44.0, 165.0, 9.0, 0.0, 26.0, 118.0, 25.0, 70.0, 28.0, 124.0, 5.0, 191.0, 78.0, 185.0, 24.0, 41.0, 29.0, 118.0, 1.0, 8.0, 6.0, 22.0, 137.0, 16.0, 8.0, 98.0, 137.0, 165.0, 8.0, 32.0, 62.0, 102.0, 107.0, 51.0, 59.0, 40.0, 20.0, 87.0, 5.0, 4.0, 44.0, 81.0, 128.0, 21.0, 2.0, 11.0, 144.0, 75.0, 56.0, 65.0, 106.0, 44.0, 45.0, 45.0, 93.0, 95.0, 73.0, 0.0, 40.0, 0.0, 80.0, 181.0, 26.0, 1.0, 92.0, 18.0, 0.0, 0.0, 5.0, 3.0, 100.0, 3.0, 5.0, 51.0, 86.0, 97.0, 96.0, 0.0, 5.0, 58.0, 102.0, 66.0, 164.0, 161.0, 90.0, 34.0, 124.0, 69.0, 1.0, 1.0, 77.0, 55.0, 29.0, 80.0, 10.0, 160.0, 8.0, 116.0, 57.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9720977337854267, "mean_inference_ms": 3.0333896056659237, "mean_action_processing_ms": 0.46932672069478515, "mean_env_wait_ms": 0.3537377960490629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006895184516906738, "StateBufferConnector_ms": 0.00592350959777832, "ViewRequirementAgentConnector_ms": 0.34628474712371826}, "num_episodes": 18, "episode_return_max": 367.0, "episode_return_min": -380.0, "episode_return_mean": 45.33, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.4653247381674, "num_env_steps_trained_throughput_per_sec": 287.4653247381674, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 14730.085, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14730.033, "sample_time_ms": 2996.938, "learn_time_ms": 11709.438, "learn_throughput": 341.605, "synch_weights_time_ms": 18.422}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "e1352_00002", "date": "2024-08-13_19-32-14", "timestamp": 1723591934, "time_this_iter_s": 13.983306169509888, "time_total_s": 1826.232650756836, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d00c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1826.232650756836, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 65.535, "ram_util_percent": 81.705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.591793049927111, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 4.606985528759225, "policy_loss": -0.002531441944902615, "vf_loss": 4.6084606463316256, "vf_explained_var": 0.00027510211581275576, "kl": 0.013189101952636865, "entropy": 0.8922230226652963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50.974982648614855, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.40782703899202, "policy_loss": -0.0027081768215688135, "vf_loss": 8.410530700128545, "vf_explained_var": -0.307761940312764, "kl": 0.01366752566469258, "entropy": 0.9498954881120611, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 346.0, "episode_reward_min": -380.0, "episode_reward_mean": 47.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -362.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 191.0}, "policy_reward_mean": {"prey_policy": -31.815, "predator_policy": 55.315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142.0, -16.0, -191.0, 143.0, 136.0, 309.0, 175.0, -82.0, -143.0, 217.0, 35.0, -61.0, -11.0, 301.0, -3.0, 149.0, 309.0, 59.0, 167.0, -78.0, -161.0, 62.0, 163.0, 209.0, 40.0, 205.0, -199.0, 116.0, 116.0, 79.0, 186.0, 0.0, 116.0, 36.0, -23.0, 108.0, 2.0, 20.0, -380.0, -179.0, 139.0, 73.0, 73.0, 10.0, 10.0, -63.0, -69.0, 88.0, -36.0, 123.0, 94.0, -8.0, 101.0, 23.0, 307.0, -9.0, 106.0, -130.0, 43.0, 64.0, -43.0, -40.0, 233.0, -47.0, -88.0, 345.0, -5.0, -25.0, 133.0, -57.0, -29.0, 202.0, -47.0, -291.0, -224.0, -106.0, 126.0, 78.0, 48.0, 42.0, -18.0, -16.0, 70.0, 167.0, 127.0, 44.0, 261.0, 230.0, 346.0, -13.0, 12.0, -193.0, 9.0, 240.0, -13.0, -26.0, 214.0, 159.0, 171.0, -4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-338.0, 0.0, 0.0, -32.0, -162.0, -310.0, 107.0, 5.0, -71.0, 133.0, 150.0, 116.0, 144.0, 20.0, -347.0, -64.0, -16.0, -298.0, 68.0, 97.0, 29.0, 0.0, -153.0, -53.0, -4.0, -24.0, 90.0, 122.0, -235.0, 27.0, 173.0, -324.0, 156.0, 122.0, -80.0, 32.0, 10.0, 141.0, -84.0, -152.0, -346.0, -27.0, -104.0, -13.0, 143.0, 1.0, 89.0, 74.0, -250.0, 129.0, 38.0, 111.0, -103.0, -248.0, 113.0, -77.0, 7.0, 11.0, -62.0, -8.0, 144.0, 22.0, 0.0, 0.0, 58.0, -43.0, 37.0, -175.0, 0.0, -49.0, 147.0, -182.0, 0.0, -96.0, 72.0, -181.0, -287.0, -362.0, -59.0, -329.0, 59.0, 10.0, -153.0, 107.0, -2.0, 61.0, -61.0, -88.0, -22.0, 8.0, -6.0, -292.0, -109.0, -133.0, -136.0, 130.0, 52.0, -297.0, 30.0, -17.0, -40.0, 74.0, -150.0, 50.0, 0.0, 53.0, -55.0, -131.0, 138.0, 146.0, -22.0, -142.0, -155.0, 130.0, -247.0, -54.0, -28.0, -18.0, 104.0, -178.0, -211.0, 0.0, 0.0, -80.0, -28.0, 181.0, -346.0, 92.0, -2.0, -179.0, 136.0, 191.0, 0.0, -10.0, -76.0, -52.0, 135.0, -10.0, -166.0, -28.0, -47.0, -175.0, 60.0, 137.0, -273.0, 66.0, -313.0, -208.0, -317.0, -158.0, -91.0, -173.0, 192.0, -136.0, 70.0, -70.0, -112.0, 76.0, -48.0, 0.0, -267.0, 81.0, -38.0, -151.0, 90.0, -130.0, 0.0, 149.0, 9.0, 77.0, 0.0, 42.0, 45.0, 157.0, 14.0, 118.0, 193.0, 131.0, -53.0, -196.0, -36.0, -55.0, -80.0, -318.0, -190.0, 28.0, 122.0, 90.0, -108.0, 0.0, 0.0, -135.0, 40.0, 110.0, 25.0, 117.0, 67.0, 18.0, -132.0, -30.0], "policy_predator_policy_reward": [18.0, 178.0, 0.0, 16.0, 141.0, 140.0, 31.0, 0.0, 53.0, 21.0, 16.0, 27.0, 9.0, 2.0, 143.0, 186.0, 144.0, 27.0, 15.0, 37.0, 6.0, 0.0, 0.0, 145.0, 16.0, 1.0, 54.0, 35.0, 133.0, 72.0, 146.0, 154.0, 18.0, 13.0, 2.0, 105.0, 14.0, 2.0, 124.0, 34.0, 190.0, 22.0, 104.0, 75.0, 0.0, 19.0, 18.0, 28.0, 11.0, 150.0, 21.0, 35.0, 111.0, 41.0, 21.0, 59.0, 32.0, 66.0, 67.0, 82.0, 11.0, 9.0, 0.0, 0.0, 57.0, 44.0, 165.0, 9.0, 0.0, 26.0, 118.0, 25.0, 70.0, 28.0, 124.0, 5.0, 191.0, 78.0, 185.0, 24.0, 41.0, 29.0, 118.0, 1.0, 8.0, 6.0, 22.0, 137.0, 16.0, 8.0, 98.0, 137.0, 165.0, 8.0, 32.0, 62.0, 102.0, 107.0, 51.0, 59.0, 40.0, 20.0, 87.0, 5.0, 4.0, 44.0, 81.0, 128.0, 21.0, 2.0, 11.0, 144.0, 75.0, 56.0, 65.0, 106.0, 44.0, 45.0, 45.0, 93.0, 95.0, 73.0, 0.0, 40.0, 0.0, 80.0, 181.0, 26.0, 1.0, 92.0, 18.0, 0.0, 0.0, 5.0, 3.0, 100.0, 3.0, 5.0, 51.0, 86.0, 97.0, 96.0, 0.0, 5.0, 58.0, 102.0, 66.0, 164.0, 161.0, 90.0, 34.0, 124.0, 69.0, 1.0, 1.0, 77.0, 55.0, 29.0, 80.0, 10.0, 160.0, 8.0, 116.0, 57.0, 9.0, 101.0, 3.0, 15.0, 0.0, 41.0, 0.0, 2.0, 23.0, 36.0, 48.0, 50.0, 22.0, 0.0, 162.0, 74.0, 9.0, 94.0, 50.0, 155.0, 11.0, 160.0, 12.0, 16.0, 0.0, 95.0, 108.0, 1.0, 45.0, 19.0, 0.0, 17.0, 54.0, 32.0, 66.0, 92.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9750725704139239, "mean_inference_ms": 3.042768222726295, "mean_action_processing_ms": 0.4693194986702027, "mean_env_wait_ms": 0.35473502767983617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005685687065124512, "StateBufferConnector_ms": 0.0043839216232299805, "ViewRequirementAgentConnector_ms": 0.29303884506225586}, "num_episodes": 18, "episode_return_max": 346.0, "episode_return_min": -380.0, "episode_return_mean": 47.0, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.0979359906825, "num_env_steps_trained_throughput_per_sec": 348.0979359906825, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 14519.803, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14519.751, "sample_time_ms": 2851.66, "learn_time_ms": 11644.135, "learn_throughput": 343.521, "synch_weights_time_ms": 18.639}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "e1352_00002", "date": "2024-08-13_19-32-26", "timestamp": 1723591946, "time_this_iter_s": 11.54401159286499, "time_total_s": 1837.776662349701, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1837.776662349701, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 57.34117647058823, "ram_util_percent": 82.4764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.203546986480554, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 7.6518309623476055, "policy_loss": -0.002061077875513879, "vf_loss": 7.653425704108344, "vf_explained_var": -0.00675342597027935, "kl": 0.005822934704482617, "entropy": 0.8867821857096657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.955154256467466, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.75280929646164, "policy_loss": -0.0013840122404631483, "vf_loss": 8.754189259413058, "vf_explained_var": -0.2861998330348383, "kl": 0.012306299615283744, "entropy": 0.8729636114741128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 346.0, "episode_reward_min": -380.0, "episode_reward_mean": 32.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -362.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 191.0}, "policy_reward_mean": {"prey_policy": -40.86, "predator_policy": 57.09}, "custom_metrics": {}, "hist_stats": {"episode_reward": [163.0, 209.0, 40.0, 205.0, -199.0, 116.0, 116.0, 79.0, 186.0, 0.0, 116.0, 36.0, -23.0, 108.0, 2.0, 20.0, -380.0, -179.0, 139.0, 73.0, 73.0, 10.0, 10.0, -63.0, -69.0, 88.0, -36.0, 123.0, 94.0, -8.0, 101.0, 23.0, 307.0, -9.0, 106.0, -130.0, 43.0, 64.0, -43.0, -40.0, 233.0, -47.0, -88.0, 345.0, -5.0, -25.0, 133.0, -57.0, -29.0, 202.0, -47.0, -291.0, -224.0, -106.0, 126.0, 78.0, 48.0, 42.0, -18.0, -16.0, 70.0, 167.0, 127.0, 44.0, 261.0, 230.0, 346.0, -13.0, 12.0, -193.0, 9.0, 240.0, -13.0, -26.0, 214.0, 159.0, 171.0, -4.0, -51.0, 232.0, -22.0, 173.0, -154.0, -49.0, 58.0, 100.0, -54.0, -109.0, -175.0, 94.0, 152.0, 130.0, -97.0, -46.0, -27.0, -54.0, -33.0, -55.0, -112.0, -181.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [143.0, 1.0, 89.0, 74.0, -250.0, 129.0, 38.0, 111.0, -103.0, -248.0, 113.0, -77.0, 7.0, 11.0, -62.0, -8.0, 144.0, 22.0, 0.0, 0.0, 58.0, -43.0, 37.0, -175.0, 0.0, -49.0, 147.0, -182.0, 0.0, -96.0, 72.0, -181.0, -287.0, -362.0, -59.0, -329.0, 59.0, 10.0, -153.0, 107.0, -2.0, 61.0, -61.0, -88.0, -22.0, 8.0, -6.0, -292.0, -109.0, -133.0, -136.0, 130.0, 52.0, -297.0, 30.0, -17.0, -40.0, 74.0, -150.0, 50.0, 0.0, 53.0, -55.0, -131.0, 138.0, 146.0, -22.0, -142.0, -155.0, 130.0, -247.0, -54.0, -28.0, -18.0, 104.0, -178.0, -211.0, 0.0, 0.0, -80.0, -28.0, 181.0, -346.0, 92.0, -2.0, -179.0, 136.0, 191.0, 0.0, -10.0, -76.0, -52.0, 135.0, -10.0, -166.0, -28.0, -47.0, -175.0, 60.0, 137.0, -273.0, 66.0, -313.0, -208.0, -317.0, -158.0, -91.0, -173.0, 192.0, -136.0, 70.0, -70.0, -112.0, 76.0, -48.0, 0.0, -267.0, 81.0, -38.0, -151.0, 90.0, -130.0, 0.0, 149.0, 9.0, 77.0, 0.0, 42.0, 45.0, 157.0, 14.0, 118.0, 193.0, 131.0, -53.0, -196.0, -36.0, -55.0, -80.0, -318.0, -190.0, 28.0, 122.0, 90.0, -108.0, 0.0, 0.0, -135.0, 40.0, 110.0, 25.0, 117.0, 67.0, 18.0, -132.0, -30.0, -152.0, -3.0, 82.0, 110.0, -224.0, -5.0, 133.0, 40.0, -85.0, -231.0, -311.0, 0.0, -93.0, 79.0, 95.0, 0.0, -91.0, -28.0, -119.0, -123.0, -149.0, -323.0, -79.0, 65.0, 17.0, 133.0, 161.0, -203.0, -154.0, -91.0, -193.0, -10.0, -168.0, -44.0, -34.0, -349.0, 12.0, -151.0, -118.0, -57.0, -206.0, -83.0, -264.0, -90.0], "policy_predator_policy_reward": [0.0, 19.0, 18.0, 28.0, 11.0, 150.0, 21.0, 35.0, 111.0, 41.0, 21.0, 59.0, 32.0, 66.0, 67.0, 82.0, 11.0, 9.0, 0.0, 0.0, 57.0, 44.0, 165.0, 9.0, 0.0, 26.0, 118.0, 25.0, 70.0, 28.0, 124.0, 5.0, 191.0, 78.0, 185.0, 24.0, 41.0, 29.0, 118.0, 1.0, 8.0, 6.0, 22.0, 137.0, 16.0, 8.0, 98.0, 137.0, 165.0, 8.0, 32.0, 62.0, 102.0, 107.0, 51.0, 59.0, 40.0, 20.0, 87.0, 5.0, 4.0, 44.0, 81.0, 128.0, 21.0, 2.0, 11.0, 144.0, 75.0, 56.0, 65.0, 106.0, 44.0, 45.0, 45.0, 93.0, 95.0, 73.0, 0.0, 40.0, 0.0, 80.0, 181.0, 26.0, 1.0, 92.0, 18.0, 0.0, 0.0, 5.0, 3.0, 100.0, 3.0, 5.0, 51.0, 86.0, 97.0, 96.0, 0.0, 5.0, 58.0, 102.0, 66.0, 164.0, 161.0, 90.0, 34.0, 124.0, 69.0, 1.0, 1.0, 77.0, 55.0, 29.0, 80.0, 10.0, 160.0, 8.0, 116.0, 57.0, 9.0, 101.0, 3.0, 15.0, 0.0, 41.0, 0.0, 2.0, 23.0, 36.0, 48.0, 50.0, 22.0, 0.0, 162.0, 74.0, 9.0, 94.0, 50.0, 155.0, 11.0, 160.0, 12.0, 16.0, 0.0, 95.0, 108.0, 1.0, 45.0, 19.0, 0.0, 17.0, 54.0, 32.0, 66.0, 92.0, 0.0, 104.0, 18.0, 22.0, 93.0, 114.0, 0.0, 0.0, 34.0, 128.0, 158.0, 104.0, 0.0, 72.0, 0.0, 5.0, 11.0, 54.0, 119.0, 14.0, 183.0, 114.0, 6.0, 102.0, 0.0, 2.0, 88.0, 84.0, 19.0, 129.0, 86.0, 71.0, 52.0, 133.0, 152.0, 177.0, 0.0, 106.0, 38.0, 82.0, 32.0, 145.0, 20.0, 153.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9753760038225444, "mean_inference_ms": 3.043665368379259, "mean_action_processing_ms": 0.46781233853078347, "mean_env_wait_ms": 0.3546595666478956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008862853050231934, "StateBufferConnector_ms": 0.006265997886657715, "ViewRequirementAgentConnector_ms": 0.28598928451538086}, "num_episodes": 22, "episode_return_max": 346.0, "episode_return_min": -380.0, "episode_return_mean": 32.46, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.851391089829, "num_env_steps_trained_throughput_per_sec": 318.851391089829, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 14217.501, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14217.449, "sample_time_ms": 2728.975, "learn_time_ms": 11464.766, "learn_throughput": 348.895, "synch_weights_time_ms": 18.451}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "e1352_00002", "date": "2024-08-13_19-32-38", "timestamp": 1723591958, "time_this_iter_s": 12.610205888748169, "time_total_s": 1850.386868238449, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d41ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1850.386868238449, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 62.294444444444444, "ram_util_percent": 82.8888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.833464541353246, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 4.99134850993989, "policy_loss": -0.0016200432648744295, "vf_loss": 4.992130762180954, "vf_explained_var": -0.004286002765887629, "kl": 0.010460511704086642, "entropy": 0.88409767109881, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48.97608895349124, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.210132660941472, "policy_loss": -0.0009257420967702591, "vf_loss": 8.21105423352075, "vf_explained_var": -0.19074912178453315, "kl": 0.01264349830871268, "entropy": 0.9121579346833406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 346.0, "episode_reward_min": -291.0, "episode_reward_mean": 44.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -350.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 183.0}, "policy_reward_mean": {"prey_policy": -37.11, "predator_policy": 59.29}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-63.0, -69.0, 88.0, -36.0, 123.0, 94.0, -8.0, 101.0, 23.0, 307.0, -9.0, 106.0, -130.0, 43.0, 64.0, -43.0, -40.0, 233.0, -47.0, -88.0, 345.0, -5.0, -25.0, 133.0, -57.0, -29.0, 202.0, -47.0, -291.0, -224.0, -106.0, 126.0, 78.0, 48.0, 42.0, -18.0, -16.0, 70.0, 167.0, 127.0, 44.0, 261.0, 230.0, 346.0, -13.0, 12.0, -193.0, 9.0, 240.0, -13.0, -26.0, 214.0, 159.0, 171.0, -4.0, -51.0, 232.0, -22.0, 173.0, -154.0, -49.0, 58.0, 100.0, -54.0, -109.0, -175.0, 94.0, 152.0, 130.0, -97.0, -46.0, -27.0, -54.0, -33.0, -55.0, -112.0, -181.0, 186.0, 166.0, 144.0, 213.0, -55.0, 228.0, 176.0, 90.0, -6.0, 72.0, 72.0, 39.0, -93.0, -153.0, 262.0, 0.0, 280.0, 116.0, -82.0, 143.0, 167.0, -71.0, 216.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, -292.0, -109.0, -133.0, -136.0, 130.0, 52.0, -297.0, 30.0, -17.0, -40.0, 74.0, -150.0, 50.0, 0.0, 53.0, -55.0, -131.0, 138.0, 146.0, -22.0, -142.0, -155.0, 130.0, -247.0, -54.0, -28.0, -18.0, 104.0, -178.0, -211.0, 0.0, 0.0, -80.0, -28.0, 181.0, -346.0, 92.0, -2.0, -179.0, 136.0, 191.0, 0.0, -10.0, -76.0, -52.0, 135.0, -10.0, -166.0, -28.0, -47.0, -175.0, 60.0, 137.0, -273.0, 66.0, -313.0, -208.0, -317.0, -158.0, -91.0, -173.0, 192.0, -136.0, 70.0, -70.0, -112.0, 76.0, -48.0, 0.0, -267.0, 81.0, -38.0, -151.0, 90.0, -130.0, 0.0, 149.0, 9.0, 77.0, 0.0, 42.0, 45.0, 157.0, 14.0, 118.0, 193.0, 131.0, -53.0, -196.0, -36.0, -55.0, -80.0, -318.0, -190.0, 28.0, 122.0, 90.0, -108.0, 0.0, 0.0, -135.0, 40.0, 110.0, 25.0, 117.0, 67.0, 18.0, -132.0, -30.0, -152.0, -3.0, 82.0, 110.0, -224.0, -5.0, 133.0, 40.0, -85.0, -231.0, -311.0, 0.0, -93.0, 79.0, 95.0, 0.0, -91.0, -28.0, -119.0, -123.0, -149.0, -323.0, -79.0, 65.0, 17.0, 133.0, 161.0, -203.0, -154.0, -91.0, -193.0, -10.0, -168.0, -44.0, -34.0, -349.0, 12.0, -151.0, -118.0, -57.0, -206.0, -83.0, -264.0, -90.0, 77.0, 21.0, 97.0, 21.0, 2.0, 111.0, 86.0, 124.0, -175.0, 0.0, 136.0, 17.0, -15.0, 100.0, -331.0, 81.0, -275.0, 102.0, 0.0, 56.0, 38.0, 8.0, -65.0, -12.0, -64.0, -235.0, 10.0, -350.0, 185.0, -39.0, -282.0, 126.0, 123.0, 129.0, 119.0, -174.0, -215.0, 8.0, 160.0, -125.0, -181.0, 150.0, -347.0, -48.0, 107.0, 93.0], "policy_predator_policy_reward": [98.0, 137.0, 165.0, 8.0, 32.0, 62.0, 102.0, 107.0, 51.0, 59.0, 40.0, 20.0, 87.0, 5.0, 4.0, 44.0, 81.0, 128.0, 21.0, 2.0, 11.0, 144.0, 75.0, 56.0, 65.0, 106.0, 44.0, 45.0, 45.0, 93.0, 95.0, 73.0, 0.0, 40.0, 0.0, 80.0, 181.0, 26.0, 1.0, 92.0, 18.0, 0.0, 0.0, 5.0, 3.0, 100.0, 3.0, 5.0, 51.0, 86.0, 97.0, 96.0, 0.0, 5.0, 58.0, 102.0, 66.0, 164.0, 161.0, 90.0, 34.0, 124.0, 69.0, 1.0, 1.0, 77.0, 55.0, 29.0, 80.0, 10.0, 160.0, 8.0, 116.0, 57.0, 9.0, 101.0, 3.0, 15.0, 0.0, 41.0, 0.0, 2.0, 23.0, 36.0, 48.0, 50.0, 22.0, 0.0, 162.0, 74.0, 9.0, 94.0, 50.0, 155.0, 11.0, 160.0, 12.0, 16.0, 0.0, 95.0, 108.0, 1.0, 45.0, 19.0, 0.0, 17.0, 54.0, 32.0, 66.0, 92.0, 0.0, 104.0, 18.0, 22.0, 93.0, 114.0, 0.0, 0.0, 34.0, 128.0, 158.0, 104.0, 0.0, 72.0, 0.0, 5.0, 11.0, 54.0, 119.0, 14.0, 183.0, 114.0, 6.0, 102.0, 0.0, 2.0, 88.0, 84.0, 19.0, 129.0, 86.0, 71.0, 52.0, 133.0, 152.0, 177.0, 0.0, 106.0, 38.0, 82.0, 32.0, 145.0, 20.0, 153.0, 41.0, 47.0, 21.0, 27.0, 31.0, 0.0, 3.0, 0.0, 0.0, 120.0, 40.0, 35.0, 17.0, 74.0, 177.0, 163.0, 11.0, 156.0, 8.0, 8.0, 19.0, 7.0, 56.0, 60.0, 124.0, 82.0, 167.0, 20.0, 59.0, 57.0, 150.0, 6.0, 2.0, 26.0, 88.0, 83.0, 0.0, 125.0, 4.0, 104.0, 104.0, 94.0, 145.0, 179.0, 5.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9733545860694887, "mean_inference_ms": 3.0449522247325223, "mean_action_processing_ms": 0.46642669863691466, "mean_env_wait_ms": 0.3545857307334503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009256601333618164, "StateBufferConnector_ms": 0.005859255790710449, "ViewRequirementAgentConnector_ms": 0.2644556760787964}, "num_episodes": 23, "episode_return_max": 346.0, "episode_return_min": -291.0, "episode_return_mean": 44.36, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.34816217764876, "num_env_steps_trained_throughput_per_sec": 261.34816217764876, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 13985.445, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13985.393, "sample_time_ms": 2380.764, "learn_time_ms": 11577.928, "learn_throughput": 345.485, "synch_weights_time_ms": 21.311}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "e1352_00002", "date": "2024-08-13_19-32-54", "timestamp": 1723591974, "time_this_iter_s": 15.431123971939087, "time_total_s": 1865.8179922103882, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1865.8179922103882, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 72.7818181818182, "ram_util_percent": 83.38636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8229102059489204, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 3.9554510165774635, "policy_loss": -0.0014906536561077235, "vf_loss": 3.956277081827638, "vf_explained_var": -0.0027035388996992163, "kl": 0.008297967762858538, "entropy": 0.8753371109407415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 70.34857218508367, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 7.593598353168952, "policy_loss": -0.0026706907342597054, "vf_loss": 7.596264961030748, "vf_explained_var": -0.5508289153613741, "kl": 0.012379851064764249, "entropy": 1.1072464694737127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 346.0, "episode_reward_min": -291.0, "episode_reward_mean": 36.16, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -350.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 186.0}, "policy_reward_mean": {"prey_policy": -37.71, "predator_policy": 55.79}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-47.0, -88.0, 345.0, -5.0, -25.0, 133.0, -57.0, -29.0, 202.0, -47.0, -291.0, -224.0, -106.0, 126.0, 78.0, 48.0, 42.0, -18.0, -16.0, 70.0, 167.0, 127.0, 44.0, 261.0, 230.0, 346.0, -13.0, 12.0, -193.0, 9.0, 240.0, -13.0, -26.0, 214.0, 159.0, 171.0, -4.0, -51.0, 232.0, -22.0, 173.0, -154.0, -49.0, 58.0, 100.0, -54.0, -109.0, -175.0, 94.0, 152.0, 130.0, -97.0, -46.0, -27.0, -54.0, -33.0, -55.0, -112.0, -181.0, 186.0, 166.0, 144.0, 213.0, -55.0, 228.0, 176.0, 90.0, -6.0, 72.0, 72.0, 39.0, -93.0, -153.0, 262.0, 0.0, 280.0, 116.0, -82.0, 143.0, 167.0, -71.0, 216.0, -48.0, 1.0, 116.0, -183.0, 0.0, -3.0, 11.0, -3.0, 13.0, -1.0, 132.0, -181.0, -17.0, 36.0, 121.0, 2.0, -3.0, -29.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-346.0, 92.0, -2.0, -179.0, 136.0, 191.0, 0.0, -10.0, -76.0, -52.0, 135.0, -10.0, -166.0, -28.0, -47.0, -175.0, 60.0, 137.0, -273.0, 66.0, -313.0, -208.0, -317.0, -158.0, -91.0, -173.0, 192.0, -136.0, 70.0, -70.0, -112.0, 76.0, -48.0, 0.0, -267.0, 81.0, -38.0, -151.0, 90.0, -130.0, 0.0, 149.0, 9.0, 77.0, 0.0, 42.0, 45.0, 157.0, 14.0, 118.0, 193.0, 131.0, -53.0, -196.0, -36.0, -55.0, -80.0, -318.0, -190.0, 28.0, 122.0, 90.0, -108.0, 0.0, 0.0, -135.0, 40.0, 110.0, 25.0, 117.0, 67.0, 18.0, -132.0, -30.0, -152.0, -3.0, 82.0, 110.0, -224.0, -5.0, 133.0, 40.0, -85.0, -231.0, -311.0, 0.0, -93.0, 79.0, 95.0, 0.0, -91.0, -28.0, -119.0, -123.0, -149.0, -323.0, -79.0, 65.0, 17.0, 133.0, 161.0, -203.0, -154.0, -91.0, -193.0, -10.0, -168.0, -44.0, -34.0, -349.0, 12.0, -151.0, -118.0, -57.0, -206.0, -83.0, -264.0, -90.0, 77.0, 21.0, 97.0, 21.0, 2.0, 111.0, 86.0, 124.0, -175.0, 0.0, 136.0, 17.0, -15.0, 100.0, -331.0, 81.0, -275.0, 102.0, 0.0, 56.0, 38.0, 8.0, -65.0, -12.0, -64.0, -235.0, 10.0, -350.0, 185.0, -39.0, -282.0, 126.0, 123.0, 129.0, 119.0, -174.0, -215.0, 8.0, 160.0, -125.0, -181.0, 150.0, -347.0, -48.0, 107.0, 93.0, -79.0, -97.0, 0.0, -11.0, 0.0, 115.0, -178.0, -173.0, 0.0, 0.0, -68.0, -220.0, 0.0, -11.0, -167.0, 48.0, 0.0, 8.0, -12.0, 0.0, 0.0, 132.0, -259.0, -286.0, -74.0, -35.0, -17.0, 1.0, 59.0, 55.0, 0.0, 2.0, -64.0, -60.0, -217.0, 47.0], "policy_predator_policy_reward": [181.0, 26.0, 1.0, 92.0, 18.0, 0.0, 0.0, 5.0, 3.0, 100.0, 3.0, 5.0, 51.0, 86.0, 97.0, 96.0, 0.0, 5.0, 58.0, 102.0, 66.0, 164.0, 161.0, 90.0, 34.0, 124.0, 69.0, 1.0, 1.0, 77.0, 55.0, 29.0, 80.0, 10.0, 160.0, 8.0, 116.0, 57.0, 9.0, 101.0, 3.0, 15.0, 0.0, 41.0, 0.0, 2.0, 23.0, 36.0, 48.0, 50.0, 22.0, 0.0, 162.0, 74.0, 9.0, 94.0, 50.0, 155.0, 11.0, 160.0, 12.0, 16.0, 0.0, 95.0, 108.0, 1.0, 45.0, 19.0, 0.0, 17.0, 54.0, 32.0, 66.0, 92.0, 0.0, 104.0, 18.0, 22.0, 93.0, 114.0, 0.0, 0.0, 34.0, 128.0, 158.0, 104.0, 0.0, 72.0, 0.0, 5.0, 11.0, 54.0, 119.0, 14.0, 183.0, 114.0, 6.0, 102.0, 0.0, 2.0, 88.0, 84.0, 19.0, 129.0, 86.0, 71.0, 52.0, 133.0, 152.0, 177.0, 0.0, 106.0, 38.0, 82.0, 32.0, 145.0, 20.0, 153.0, 41.0, 47.0, 21.0, 27.0, 31.0, 0.0, 3.0, 0.0, 0.0, 120.0, 40.0, 35.0, 17.0, 74.0, 177.0, 163.0, 11.0, 156.0, 8.0, 8.0, 19.0, 7.0, 56.0, 60.0, 124.0, 82.0, 167.0, 20.0, 59.0, 57.0, 150.0, 6.0, 2.0, 26.0, 88.0, 83.0, 0.0, 125.0, 4.0, 104.0, 104.0, 94.0, 145.0, 179.0, 5.0, 11.0, 121.0, 7.0, 0.0, 12.0, 1.0, 0.0, 156.0, 12.0, 0.0, 0.0, 141.0, 144.0, 1.0, 21.0, 0.0, 116.0, 5.0, 0.0, 11.0, 0.0, 0.0, 0.0, 186.0, 178.0, 92.0, 0.0, 0.0, 52.0, 3.0, 4.0, 0.0, 0.0, 91.0, 30.0, 141.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9814346627375968, "mean_inference_ms": 3.060150168610077, "mean_action_processing_ms": 0.46663847931470165, "mean_env_wait_ms": 0.3559602370827629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008524656295776367, "StateBufferConnector_ms": 0.005756497383117676, "ViewRequirementAgentConnector_ms": 0.29975879192352295}, "num_episodes": 18, "episode_return_max": 346.0, "episode_return_min": -291.0, "episode_return_mean": 36.16, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 174.90324514995595, "num_env_steps_trained_throughput_per_sec": 174.90324514995595, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 15007.283, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15007.226, "sample_time_ms": 2995.914, "learn_time_ms": 11983.078, "learn_throughput": 333.804, "synch_weights_time_ms": 22.673}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "e1352_00002", "date": "2024-08-13_19-33-17", "timestamp": 1723591997, "time_this_iter_s": 22.948580741882324, "time_total_s": 1888.7665729522705, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb30d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1888.7665729522705, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 89.353125, "ram_util_percent": 83.61874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.565729622534974, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 3.772575230825515, "policy_loss": -0.0030625222773764224, "vf_loss": 3.775073317623643, "vf_explained_var": 0.015060164657219377, "kl": 0.007047356502776715, "entropy": 0.8739505373611652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 63.75357162608672, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 6.428453674013652, "policy_loss": -0.002397789677269954, "vf_loss": 6.430849252176032, "vf_explained_var": -0.13242899693509258, "kl": 0.006780810615563417, "entropy": 1.0794009508279265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 346.0, "episode_reward_min": -193.0, "episode_reward_mean": 50.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -383.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 186.0}, "policy_reward_mean": {"prey_policy": -25.86, "predator_policy": 51.12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.0, 70.0, 167.0, 127.0, 44.0, 261.0, 230.0, 346.0, -13.0, 12.0, -193.0, 9.0, 240.0, -13.0, -26.0, 214.0, 159.0, 171.0, -4.0, -51.0, 232.0, -22.0, 173.0, -154.0, -49.0, 58.0, 100.0, -54.0, -109.0, -175.0, 94.0, 152.0, 130.0, -97.0, -46.0, -27.0, -54.0, -33.0, -55.0, -112.0, -181.0, 186.0, 166.0, 144.0, 213.0, -55.0, 228.0, 176.0, 90.0, -6.0, 72.0, 72.0, 39.0, -93.0, -153.0, 262.0, 0.0, 280.0, 116.0, -82.0, 143.0, 167.0, -71.0, 216.0, -48.0, 1.0, 116.0, -183.0, 0.0, -3.0, 11.0, -3.0, 13.0, -1.0, 132.0, -181.0, -17.0, 36.0, 121.0, 2.0, -3.0, -29.0, 94.0, -24.0, 25.0, 120.0, 221.0, 121.0, 17.0, 123.0, 20.0, 85.0, -13.0, -27.0, 9.0, 125.0, 90.0, 22.0, 310.0, 155.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-38.0, -151.0, 90.0, -130.0, 0.0, 149.0, 9.0, 77.0, 0.0, 42.0, 45.0, 157.0, 14.0, 118.0, 193.0, 131.0, -53.0, -196.0, -36.0, -55.0, -80.0, -318.0, -190.0, 28.0, 122.0, 90.0, -108.0, 0.0, 0.0, -135.0, 40.0, 110.0, 25.0, 117.0, 67.0, 18.0, -132.0, -30.0, -152.0, -3.0, 82.0, 110.0, -224.0, -5.0, 133.0, 40.0, -85.0, -231.0, -311.0, 0.0, -93.0, 79.0, 95.0, 0.0, -91.0, -28.0, -119.0, -123.0, -149.0, -323.0, -79.0, 65.0, 17.0, 133.0, 161.0, -203.0, -154.0, -91.0, -193.0, -10.0, -168.0, -44.0, -34.0, -349.0, 12.0, -151.0, -118.0, -57.0, -206.0, -83.0, -264.0, -90.0, 77.0, 21.0, 97.0, 21.0, 2.0, 111.0, 86.0, 124.0, -175.0, 0.0, 136.0, 17.0, -15.0, 100.0, -331.0, 81.0, -275.0, 102.0, 0.0, 56.0, 38.0, 8.0, -65.0, -12.0, -64.0, -235.0, 10.0, -350.0, 185.0, -39.0, -282.0, 126.0, 123.0, 129.0, 119.0, -174.0, -215.0, 8.0, 160.0, -125.0, -181.0, 150.0, -347.0, -48.0, 107.0, 93.0, -79.0, -97.0, 0.0, -11.0, 0.0, 115.0, -178.0, -173.0, 0.0, 0.0, -68.0, -220.0, 0.0, -11.0, -167.0, 48.0, 0.0, 8.0, -12.0, 0.0, 0.0, 132.0, -259.0, -286.0, -74.0, -35.0, -17.0, 1.0, 59.0, 55.0, 0.0, 2.0, -64.0, -60.0, -217.0, 47.0, 0.0, 73.0, -135.0, 10.0, -13.0, 18.0, 55.0, 30.0, 79.0, 92.0, 0.0, 100.0, 139.0, -320.0, 0.0, 117.0, 0.0, 11.0, -8.0, 55.0, -113.0, -8.0, -383.0, 91.0, -244.0, 56.0, 121.0, 0.0, 58.0, 0.0, 0.0, 16.0, 133.0, 170.0, 149.0, 0.0], "policy_predator_policy_reward": [116.0, 57.0, 9.0, 101.0, 3.0, 15.0, 0.0, 41.0, 0.0, 2.0, 23.0, 36.0, 48.0, 50.0, 22.0, 0.0, 162.0, 74.0, 9.0, 94.0, 50.0, 155.0, 11.0, 160.0, 12.0, 16.0, 0.0, 95.0, 108.0, 1.0, 45.0, 19.0, 0.0, 17.0, 54.0, 32.0, 66.0, 92.0, 0.0, 104.0, 18.0, 22.0, 93.0, 114.0, 0.0, 0.0, 34.0, 128.0, 158.0, 104.0, 0.0, 72.0, 0.0, 5.0, 11.0, 54.0, 119.0, 14.0, 183.0, 114.0, 6.0, 102.0, 0.0, 2.0, 88.0, 84.0, 19.0, 129.0, 86.0, 71.0, 52.0, 133.0, 152.0, 177.0, 0.0, 106.0, 38.0, 82.0, 32.0, 145.0, 20.0, 153.0, 41.0, 47.0, 21.0, 27.0, 31.0, 0.0, 3.0, 0.0, 0.0, 120.0, 40.0, 35.0, 17.0, 74.0, 177.0, 163.0, 11.0, 156.0, 8.0, 8.0, 19.0, 7.0, 56.0, 60.0, 124.0, 82.0, 167.0, 20.0, 59.0, 57.0, 150.0, 6.0, 2.0, 26.0, 88.0, 83.0, 0.0, 125.0, 4.0, 104.0, 104.0, 94.0, 145.0, 179.0, 5.0, 11.0, 121.0, 7.0, 0.0, 12.0, 1.0, 0.0, 156.0, 12.0, 0.0, 0.0, 141.0, 144.0, 1.0, 21.0, 0.0, 116.0, 5.0, 0.0, 11.0, 0.0, 0.0, 0.0, 186.0, 178.0, 92.0, 0.0, 0.0, 52.0, 3.0, 4.0, 0.0, 0.0, 91.0, 30.0, 141.0, 0.0, 18.0, 3.0, 0.0, 101.0, 7.0, 13.0, 3.0, 32.0, 37.0, 13.0, 1.0, 20.0, 33.0, 165.0, 6.0, 0.0, 9.0, 0.0, 22.0, 16.0, 108.0, 0.0, 177.0, 88.0, 68.0, 129.0, 0.0, 4.0, 18.0, 14.0, 0.0, 6.0, 0.0, 7.0, 1.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.990781084785491, "mean_inference_ms": 3.0881790079944254, "mean_action_processing_ms": 0.4687376453751206, "mean_env_wait_ms": 0.35863441911409233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009293079376220703, "StateBufferConnector_ms": 0.006053805351257324, "ViewRequirementAgentConnector_ms": 0.3638947010040283}, "num_episodes": 18, "episode_return_max": 346.0, "episode_return_min": -193.0, "episode_return_mean": 50.52, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.15576982697573, "num_env_steps_trained_throughput_per_sec": 208.15576982697573, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 15551.901, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15551.844, "sample_time_ms": 3295.431, "learn_time_ms": 12225.288, "learn_throughput": 327.191, "synch_weights_time_ms": 25.776}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "e1352_00002", "date": "2024-08-13_19-33-36", "timestamp": 1723592016, "time_this_iter_s": 19.48508906364441, "time_total_s": 1908.251662015915, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1908.251662015915, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 83.46296296296298, "ram_util_percent": 82.53703703703704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.642260679405518, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 5.851062442638256, "policy_loss": -0.0030943513467227893, "vf_loss": 5.853485890040322, "vf_explained_var": 0.02583216422449344, "kl": 0.008376947489206261, "entropy": 0.820440590854675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 47.61853611417233, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.017879870581249, "policy_loss": -0.00038168342961441903, "vf_loss": 8.018259318165047, "vf_explained_var": -0.40720569645916976, "kl": 0.006821666563000069, "entropy": 0.938342241067735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 310.0, "episode_reward_min": -499.0, "episode_reward_mean": 20.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -44.685, "predator_policy": 54.955}, "custom_metrics": {}, "hist_stats": {"episode_reward": [173.0, -154.0, -49.0, 58.0, 100.0, -54.0, -109.0, -175.0, 94.0, 152.0, 130.0, -97.0, -46.0, -27.0, -54.0, -33.0, -55.0, -112.0, -181.0, 186.0, 166.0, 144.0, 213.0, -55.0, 228.0, 176.0, 90.0, -6.0, 72.0, 72.0, 39.0, -93.0, -153.0, 262.0, 0.0, 280.0, 116.0, -82.0, 143.0, 167.0, -71.0, 216.0, -48.0, 1.0, 116.0, -183.0, 0.0, -3.0, 11.0, -3.0, 13.0, -1.0, 132.0, -181.0, -17.0, 36.0, 121.0, 2.0, -3.0, -29.0, 94.0, -24.0, 25.0, 120.0, 221.0, 121.0, 17.0, 123.0, 20.0, 85.0, -13.0, -27.0, 9.0, 125.0, 90.0, 22.0, 310.0, 155.0, 131.0, -273.0, -308.0, -396.0, 4.0, 25.0, 244.0, 5.0, -42.0, 13.0, -71.0, -499.0, 154.0, 99.0, 120.0, -38.0, 144.0, 28.0, -154.0, -177.0, -14.0, -49.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [133.0, 40.0, -85.0, -231.0, -311.0, 0.0, -93.0, 79.0, 95.0, 0.0, -91.0, -28.0, -119.0, -123.0, -149.0, -323.0, -79.0, 65.0, 17.0, 133.0, 161.0, -203.0, -154.0, -91.0, -193.0, -10.0, -168.0, -44.0, -34.0, -349.0, 12.0, -151.0, -118.0, -57.0, -206.0, -83.0, -264.0, -90.0, 77.0, 21.0, 97.0, 21.0, 2.0, 111.0, 86.0, 124.0, -175.0, 0.0, 136.0, 17.0, -15.0, 100.0, -331.0, 81.0, -275.0, 102.0, 0.0, 56.0, 38.0, 8.0, -65.0, -12.0, -64.0, -235.0, 10.0, -350.0, 185.0, -39.0, -282.0, 126.0, 123.0, 129.0, 119.0, -174.0, -215.0, 8.0, 160.0, -125.0, -181.0, 150.0, -347.0, -48.0, 107.0, 93.0, -79.0, -97.0, 0.0, -11.0, 0.0, 115.0, -178.0, -173.0, 0.0, 0.0, -68.0, -220.0, 0.0, -11.0, -167.0, 48.0, 0.0, 8.0, -12.0, 0.0, 0.0, 132.0, -259.0, -286.0, -74.0, -35.0, -17.0, 1.0, 59.0, 55.0, 0.0, 2.0, -64.0, -60.0, -217.0, 47.0, 0.0, 73.0, -135.0, 10.0, -13.0, 18.0, 55.0, 30.0, 79.0, 92.0, 0.0, 100.0, 139.0, -320.0, 0.0, 117.0, 0.0, 11.0, -8.0, 55.0, -113.0, -8.0, -383.0, 91.0, -244.0, 56.0, 121.0, 0.0, 58.0, 0.0, 0.0, 16.0, 133.0, 170.0, 149.0, 0.0, 115.0, -24.0, -385.0, -238.0, -234.0, -391.0, -354.0, -319.0, -26.0, 0.0, -23.0, -6.0, 90.0, 154.0, -60.0, 12.0, -165.0, -9.0, 44.0, -85.0, -67.0, -296.0, -355.0, -341.0, 113.0, -4.0, -2.0, 40.0, 17.0, 84.0, -227.0, 0.0, 0.0, 128.0, 0.0, -90.0, 0.0, -331.0, -46.0, -311.0, -25.0, -137.0, -298.0, 85.0], "policy_predator_policy_reward": [0.0, 0.0, 34.0, 128.0, 158.0, 104.0, 0.0, 72.0, 0.0, 5.0, 11.0, 54.0, 119.0, 14.0, 183.0, 114.0, 6.0, 102.0, 0.0, 2.0, 88.0, 84.0, 19.0, 129.0, 86.0, 71.0, 52.0, 133.0, 152.0, 177.0, 0.0, 106.0, 38.0, 82.0, 32.0, 145.0, 20.0, 153.0, 41.0, 47.0, 21.0, 27.0, 31.0, 0.0, 3.0, 0.0, 0.0, 120.0, 40.0, 35.0, 17.0, 74.0, 177.0, 163.0, 11.0, 156.0, 8.0, 8.0, 19.0, 7.0, 56.0, 60.0, 124.0, 82.0, 167.0, 20.0, 59.0, 57.0, 150.0, 6.0, 2.0, 26.0, 88.0, 83.0, 0.0, 125.0, 4.0, 104.0, 104.0, 94.0, 145.0, 179.0, 5.0, 11.0, 121.0, 7.0, 0.0, 12.0, 1.0, 0.0, 156.0, 12.0, 0.0, 0.0, 141.0, 144.0, 1.0, 21.0, 0.0, 116.0, 5.0, 0.0, 11.0, 0.0, 0.0, 0.0, 186.0, 178.0, 92.0, 0.0, 0.0, 52.0, 3.0, 4.0, 0.0, 0.0, 91.0, 30.0, 141.0, 0.0, 18.0, 3.0, 0.0, 101.0, 7.0, 13.0, 3.0, 32.0, 37.0, 13.0, 1.0, 20.0, 33.0, 165.0, 6.0, 0.0, 9.0, 0.0, 22.0, 16.0, 108.0, 0.0, 177.0, 88.0, 68.0, 129.0, 0.0, 4.0, 18.0, 14.0, 0.0, 6.0, 0.0, 7.0, 1.0, 5.0, 18.0, 22.0, 200.0, 150.0, 197.0, 120.0, 92.0, 185.0, 25.0, 5.0, 51.0, 3.0, 0.0, 0.0, 2.0, 51.0, 94.0, 38.0, 6.0, 48.0, 164.0, 128.0, 2.0, 195.0, 0.0, 45.0, 1.0, 60.0, 6.0, 13.0, 74.0, 115.0, 3.0, 13.0, 55.0, 63.0, 177.0, 0.0, 178.0, 2.0, 28.0, 120.0, 3.0, 161.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0064314270291284, "mean_inference_ms": 3.1365972014821737, "mean_action_processing_ms": 0.47371767294287964, "mean_env_wait_ms": 0.3639297215233262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009954214096069336, "StateBufferConnector_ms": 0.006334066390991211, "ViewRequirementAgentConnector_ms": 0.541236162185669}, "num_episodes": 22, "episode_return_max": 310.0, "episode_return_min": -499.0, "episode_return_mean": 20.54, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.43566364762404, "num_env_steps_trained_throughput_per_sec": 217.43566364762404, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 15806.896, "restore_workers_time_ms": 0.02, "training_step_time_ms": 15806.839, "sample_time_ms": 3559.94, "learn_time_ms": 12219.404, "learn_throughput": 327.348, "synch_weights_time_ms": 23.28}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "e1352_00002", "date": "2024-08-13_19-33-55", "timestamp": 1723592035, "time_this_iter_s": 18.51758885383606, "time_total_s": 1926.769250869751, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d138b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1926.769250869751, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 75.0111111111111, "ram_util_percent": 83.91481481481482}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.329612841058976, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 4.9497672951410685, "policy_loss": -0.0038557217219874025, "vf_loss": 4.95261695687733, "vf_explained_var": 0.015375038713374466, "kl": 0.012561503910846742, "entropy": 0.8871074357676128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 71.4608460292299, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 7.310221200771433, "policy_loss": -0.005967431143911742, "vf_loss": 7.316183449225451, "vf_explained_var": -0.2659317234836558, "kl": 0.01573759923113458, "entropy": 1.0668700190448257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 310.0, "episode_reward_min": -499.0, "episode_reward_mean": 32.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -32.74, "predator_policy": 48.97}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.0, 186.0, 166.0, 144.0, 213.0, -55.0, 228.0, 176.0, 90.0, -6.0, 72.0, 72.0, 39.0, -93.0, -153.0, 262.0, 0.0, 280.0, 116.0, -82.0, 143.0, 167.0, -71.0, 216.0, -48.0, 1.0, 116.0, -183.0, 0.0, -3.0, 11.0, -3.0, 13.0, -1.0, 132.0, -181.0, -17.0, 36.0, 121.0, 2.0, -3.0, -29.0, 94.0, -24.0, 25.0, 120.0, 221.0, 121.0, 17.0, 123.0, 20.0, 85.0, -13.0, -27.0, 9.0, 125.0, 90.0, 22.0, 310.0, 155.0, 131.0, -273.0, -308.0, -396.0, 4.0, 25.0, 244.0, 5.0, -42.0, 13.0, -71.0, -499.0, 154.0, 99.0, 120.0, -38.0, 144.0, 28.0, -154.0, -177.0, -14.0, -49.0, 172.0, 81.0, 99.0, 32.0, -73.0, 23.0, 131.0, 48.0, 37.0, -100.0, 94.0, 19.0, 142.0, 41.0, 89.0, 62.0, 151.0, -114.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-264.0, -90.0, 77.0, 21.0, 97.0, 21.0, 2.0, 111.0, 86.0, 124.0, -175.0, 0.0, 136.0, 17.0, -15.0, 100.0, -331.0, 81.0, -275.0, 102.0, 0.0, 56.0, 38.0, 8.0, -65.0, -12.0, -64.0, -235.0, 10.0, -350.0, 185.0, -39.0, -282.0, 126.0, 123.0, 129.0, 119.0, -174.0, -215.0, 8.0, 160.0, -125.0, -181.0, 150.0, -347.0, -48.0, 107.0, 93.0, -79.0, -97.0, 0.0, -11.0, 0.0, 115.0, -178.0, -173.0, 0.0, 0.0, -68.0, -220.0, 0.0, -11.0, -167.0, 48.0, 0.0, 8.0, -12.0, 0.0, 0.0, 132.0, -259.0, -286.0, -74.0, -35.0, -17.0, 1.0, 59.0, 55.0, 0.0, 2.0, -64.0, -60.0, -217.0, 47.0, 0.0, 73.0, -135.0, 10.0, -13.0, 18.0, 55.0, 30.0, 79.0, 92.0, 0.0, 100.0, 139.0, -320.0, 0.0, 117.0, 0.0, 11.0, -8.0, 55.0, -113.0, -8.0, -383.0, 91.0, -244.0, 56.0, 121.0, 0.0, 58.0, 0.0, 0.0, 16.0, 133.0, 170.0, 149.0, 0.0, 115.0, -24.0, -385.0, -238.0, -234.0, -391.0, -354.0, -319.0, -26.0, 0.0, -23.0, -6.0, 90.0, 154.0, -60.0, 12.0, -165.0, -9.0, 44.0, -85.0, -67.0, -296.0, -355.0, -341.0, 113.0, -4.0, -2.0, 40.0, 17.0, 84.0, -227.0, 0.0, 0.0, 128.0, 0.0, -90.0, 0.0, -331.0, -46.0, -311.0, -25.0, -137.0, -298.0, 85.0, 170.0, 0.0, -82.0, 36.0, -3.0, 31.0, 29.0, -32.0, -120.0, -52.0, 0.0, -30.0, 10.0, 36.0, 48.0, 0.0, -35.0, -3.0, -191.0, -104.0, 120.0, -120.0, -69.0, 0.0, 60.0, 42.0, -21.0, 19.0, 83.0, -63.0, -18.0, 65.0, -10.0, 149.0, -117.0, -197.0], "policy_predator_policy_reward": [20.0, 153.0, 41.0, 47.0, 21.0, 27.0, 31.0, 0.0, 3.0, 0.0, 0.0, 120.0, 40.0, 35.0, 17.0, 74.0, 177.0, 163.0, 11.0, 156.0, 8.0, 8.0, 19.0, 7.0, 56.0, 60.0, 124.0, 82.0, 167.0, 20.0, 59.0, 57.0, 150.0, 6.0, 2.0, 26.0, 88.0, 83.0, 0.0, 125.0, 4.0, 104.0, 104.0, 94.0, 145.0, 179.0, 5.0, 11.0, 121.0, 7.0, 0.0, 12.0, 1.0, 0.0, 156.0, 12.0, 0.0, 0.0, 141.0, 144.0, 1.0, 21.0, 0.0, 116.0, 5.0, 0.0, 11.0, 0.0, 0.0, 0.0, 186.0, 178.0, 92.0, 0.0, 0.0, 52.0, 3.0, 4.0, 0.0, 0.0, 91.0, 30.0, 141.0, 0.0, 18.0, 3.0, 0.0, 101.0, 7.0, 13.0, 3.0, 32.0, 37.0, 13.0, 1.0, 20.0, 33.0, 165.0, 6.0, 0.0, 9.0, 0.0, 22.0, 16.0, 108.0, 0.0, 177.0, 88.0, 68.0, 129.0, 0.0, 4.0, 18.0, 14.0, 0.0, 6.0, 0.0, 7.0, 1.0, 5.0, 18.0, 22.0, 200.0, 150.0, 197.0, 120.0, 92.0, 185.0, 25.0, 5.0, 51.0, 3.0, 0.0, 0.0, 2.0, 51.0, 94.0, 38.0, 6.0, 48.0, 164.0, 128.0, 2.0, 195.0, 0.0, 45.0, 1.0, 60.0, 6.0, 13.0, 74.0, 115.0, 3.0, 13.0, 55.0, 63.0, 177.0, 0.0, 178.0, 2.0, 28.0, 120.0, 3.0, 161.0, 0.0, 2.0, 54.0, 73.0, 22.0, 49.0, 35.0, 0.0, 0.0, 99.0, 46.0, 7.0, 82.0, 3.0, 0.0, 0.0, 9.0, 66.0, 125.0, 70.0, 1.0, 93.0, 82.0, 6.0, 40.0, 0.0, 2.0, 41.0, 8.0, 61.0, 3.0, 12.0, 12.0, 0.0, 142.0, 58.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0220104563088257, "mean_inference_ms": 3.191671120893559, "mean_action_processing_ms": 0.4788889439913895, "mean_env_wait_ms": 0.3689595669982487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007009625434875488, "StateBufferConnector_ms": 0.00474393367767334, "ViewRequirementAgentConnector_ms": 0.5087707042694092}, "num_episodes": 18, "episode_return_max": 310.0, "episode_return_min": -499.0, "episode_return_mean": 32.46, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.64549144835954, "num_env_steps_trained_throughput_per_sec": 215.64549144835954, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 15858.177, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15858.118, "sample_time_ms": 3625.262, "learn_time_ms": 12207.044, "learn_throughput": 327.68, "synch_weights_time_ms": 22.127}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "e1352_00002", "date": "2024-08-13_19-34-14", "timestamp": 1723592054, "time_this_iter_s": 18.58482789993286, "time_total_s": 1945.3540787696838, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d5b1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1945.3540787696838, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 81.82692307692308, "ram_util_percent": 83.2346153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.782902041779309, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 5.538801650143174, "policy_loss": -0.003138661153722929, "vf_loss": 5.541205540409795, "vf_explained_var": 0.004354900594741579, "kl": 0.009174265632368447, "entropy": 0.8789932448397237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 63.6591612583115, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 7.689777052844012, "policy_loss": -0.0011713017666436455, "vf_loss": 7.69094642886409, "vf_explained_var": -0.3924156282944654, "kl": 0.005853342808215345, "entropy": 1.0617011795598994, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 310.0, "episode_reward_min": -499.0, "episode_reward_mean": 18.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -37.215, "predator_policy": 46.465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [216.0, -48.0, 1.0, 116.0, -183.0, 0.0, -3.0, 11.0, -3.0, 13.0, -1.0, 132.0, -181.0, -17.0, 36.0, 121.0, 2.0, -3.0, -29.0, 94.0, -24.0, 25.0, 120.0, 221.0, 121.0, 17.0, 123.0, 20.0, 85.0, -13.0, -27.0, 9.0, 125.0, 90.0, 22.0, 310.0, 155.0, 131.0, -273.0, -308.0, -396.0, 4.0, 25.0, 244.0, 5.0, -42.0, 13.0, -71.0, -499.0, 154.0, 99.0, 120.0, -38.0, 144.0, 28.0, -154.0, -177.0, -14.0, -49.0, 172.0, 81.0, 99.0, 32.0, -73.0, 23.0, 131.0, 48.0, 37.0, -100.0, 94.0, 19.0, 142.0, 41.0, 89.0, 62.0, 151.0, -114.0, -40.0, -14.0, -156.0, 90.0, 79.0, 40.0, -154.0, 127.0, -36.0, -85.0, 60.0, 120.0, -26.0, 97.0, -64.0, 58.0, -153.0, 245.0, 208.0, 18.0, 208.0, -216.0, -89.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [107.0, 93.0, -79.0, -97.0, 0.0, -11.0, 0.0, 115.0, -178.0, -173.0, 0.0, 0.0, -68.0, -220.0, 0.0, -11.0, -167.0, 48.0, 0.0, 8.0, -12.0, 0.0, 0.0, 132.0, -259.0, -286.0, -74.0, -35.0, -17.0, 1.0, 59.0, 55.0, 0.0, 2.0, -64.0, -60.0, -217.0, 47.0, 0.0, 73.0, -135.0, 10.0, -13.0, 18.0, 55.0, 30.0, 79.0, 92.0, 0.0, 100.0, 139.0, -320.0, 0.0, 117.0, 0.0, 11.0, -8.0, 55.0, -113.0, -8.0, -383.0, 91.0, -244.0, 56.0, 121.0, 0.0, 58.0, 0.0, 0.0, 16.0, 133.0, 170.0, 149.0, 0.0, 115.0, -24.0, -385.0, -238.0, -234.0, -391.0, -354.0, -319.0, -26.0, 0.0, -23.0, -6.0, 90.0, 154.0, -60.0, 12.0, -165.0, -9.0, 44.0, -85.0, -67.0, -296.0, -355.0, -341.0, 113.0, -4.0, -2.0, 40.0, 17.0, 84.0, -227.0, 0.0, 0.0, 128.0, 0.0, -90.0, 0.0, -331.0, -46.0, -311.0, -25.0, -137.0, -298.0, 85.0, 170.0, 0.0, -82.0, 36.0, -3.0, 31.0, 29.0, -32.0, -120.0, -52.0, 0.0, -30.0, 10.0, 36.0, 48.0, 0.0, -35.0, -3.0, -191.0, -104.0, 120.0, -120.0, -69.0, 0.0, 60.0, 42.0, -21.0, 19.0, 83.0, -63.0, -18.0, 65.0, -10.0, 149.0, -117.0, -197.0, -317.0, 3.0, 0.0, -78.0, -185.0, -126.0, 66.0, -67.0, 7.0, 21.0, -18.0, 0.0, -180.0, -152.0, 45.0, 5.0, -180.0, -46.0, 0.0, -196.0, -38.0, 50.0, 88.0, 28.0, -20.0, -18.0, 94.0, 0.0, -376.0, -13.0, 28.0, -55.0, -118.0, -328.0, 147.0, 74.0, 24.0, 184.0, -2.0, 19.0, 126.0, 73.0, -369.0, -57.0, -238.0, 0.0], "policy_predator_policy_reward": [5.0, 11.0, 121.0, 7.0, 0.0, 12.0, 1.0, 0.0, 156.0, 12.0, 0.0, 0.0, 141.0, 144.0, 1.0, 21.0, 0.0, 116.0, 5.0, 0.0, 11.0, 0.0, 0.0, 0.0, 186.0, 178.0, 92.0, 0.0, 0.0, 52.0, 3.0, 4.0, 0.0, 0.0, 91.0, 30.0, 141.0, 0.0, 18.0, 3.0, 0.0, 101.0, 7.0, 13.0, 3.0, 32.0, 37.0, 13.0, 1.0, 20.0, 33.0, 165.0, 6.0, 0.0, 9.0, 0.0, 22.0, 16.0, 108.0, 0.0, 177.0, 88.0, 68.0, 129.0, 0.0, 4.0, 18.0, 14.0, 0.0, 6.0, 0.0, 7.0, 1.0, 5.0, 18.0, 22.0, 200.0, 150.0, 197.0, 120.0, 92.0, 185.0, 25.0, 5.0, 51.0, 3.0, 0.0, 0.0, 2.0, 51.0, 94.0, 38.0, 6.0, 48.0, 164.0, 128.0, 2.0, 195.0, 0.0, 45.0, 1.0, 60.0, 6.0, 13.0, 74.0, 115.0, 3.0, 13.0, 55.0, 63.0, 177.0, 0.0, 178.0, 2.0, 28.0, 120.0, 3.0, 161.0, 0.0, 2.0, 54.0, 73.0, 22.0, 49.0, 35.0, 0.0, 0.0, 99.0, 46.0, 7.0, 82.0, 3.0, 0.0, 0.0, 9.0, 66.0, 125.0, 70.0, 1.0, 93.0, 82.0, 6.0, 40.0, 0.0, 2.0, 41.0, 8.0, 61.0, 3.0, 12.0, 12.0, 0.0, 142.0, 58.0, 135.0, 139.0, 4.0, 60.0, 62.0, 93.0, 75.0, 16.0, 44.0, 7.0, 0.0, 58.0, 100.0, 78.0, 8.0, 69.0, 87.0, 103.0, 106.0, 5.0, 0.0, 48.0, 1.0, 3.0, 10.0, 2.0, 1.0, 2.0, 187.0, 138.0, 80.0, 5.0, 170.0, 123.0, 0.0, 24.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 189.0, 21.0, 142.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0408490561602326, "mean_inference_ms": 3.2561608331219185, "mean_action_processing_ms": 0.4851781107249185, "mean_env_wait_ms": 0.3752560379871973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010454177856445312, "StateBufferConnector_ms": 0.004991888999938965, "ViewRequirementAgentConnector_ms": 0.5078274011611938}, "num_episodes": 23, "episode_return_max": 310.0, "episode_return_min": -499.0, "episode_return_mean": 18.5, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.61731119535585, "num_env_steps_trained_throughput_per_sec": 327.61731119535585, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 15716.563, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15716.504, "sample_time_ms": 3549.017, "learn_time_ms": 12140.668, "learn_throughput": 329.471, "synch_weights_time_ms": 22.5}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "e1352_00002", "date": "2024-08-13_19-34-26", "timestamp": 1723592066, "time_this_iter_s": 12.266775846481323, "time_total_s": 1957.6208546161652, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d41040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1957.6208546161652, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 62.10000000000001, "ram_util_percent": 80.07222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.839578068216957, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 6.764849839387117, "policy_loss": -0.002444676295533855, "vf_loss": 6.766452652310568, "vf_explained_var": -0.0016054287789359926, "kl": 0.010511345334492588, "entropy": 0.8317220965075114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.11215416637678, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.5110445749192, "policy_loss": -0.004011462852802305, "vf_loss": 8.51504992934131, "vf_explained_var": -0.2702022566997185, "kl": 0.018559024352886207, "entropy": 0.8671183884774566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 311.0, "episode_reward_min": -499.0, "episode_reward_mean": 13.45, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 188.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -47.185, "predator_policy": 53.91}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.0, 94.0, -24.0, 25.0, 120.0, 221.0, 121.0, 17.0, 123.0, 20.0, 85.0, -13.0, -27.0, 9.0, 125.0, 90.0, 22.0, 310.0, 155.0, 131.0, -273.0, -308.0, -396.0, 4.0, 25.0, 244.0, 5.0, -42.0, 13.0, -71.0, -499.0, 154.0, 99.0, 120.0, -38.0, 144.0, 28.0, -154.0, -177.0, -14.0, -49.0, 172.0, 81.0, 99.0, 32.0, -73.0, 23.0, 131.0, 48.0, 37.0, -100.0, 94.0, 19.0, 142.0, 41.0, 89.0, 62.0, 151.0, -114.0, -40.0, -14.0, -156.0, 90.0, 79.0, 40.0, -154.0, 127.0, -36.0, -85.0, 60.0, 120.0, -26.0, 97.0, -64.0, 58.0, -153.0, 245.0, 208.0, 18.0, 208.0, -216.0, -89.0, -379.0, 79.0, 50.0, 233.0, 135.0, 104.0, 311.0, -227.0, -143.0, -398.0, 33.0, 292.0, 94.0, -158.0, -183.0, 1.0, -282.0, 142.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-217.0, 47.0, 0.0, 73.0, -135.0, 10.0, -13.0, 18.0, 55.0, 30.0, 79.0, 92.0, 0.0, 100.0, 139.0, -320.0, 0.0, 117.0, 0.0, 11.0, -8.0, 55.0, -113.0, -8.0, -383.0, 91.0, -244.0, 56.0, 121.0, 0.0, 58.0, 0.0, 0.0, 16.0, 133.0, 170.0, 149.0, 0.0, 115.0, -24.0, -385.0, -238.0, -234.0, -391.0, -354.0, -319.0, -26.0, 0.0, -23.0, -6.0, 90.0, 154.0, -60.0, 12.0, -165.0, -9.0, 44.0, -85.0, -67.0, -296.0, -355.0, -341.0, 113.0, -4.0, -2.0, 40.0, 17.0, 84.0, -227.0, 0.0, 0.0, 128.0, 0.0, -90.0, 0.0, -331.0, -46.0, -311.0, -25.0, -137.0, -298.0, 85.0, 170.0, 0.0, -82.0, 36.0, -3.0, 31.0, 29.0, -32.0, -120.0, -52.0, 0.0, -30.0, 10.0, 36.0, 48.0, 0.0, -35.0, -3.0, -191.0, -104.0, 120.0, -120.0, -69.0, 0.0, 60.0, 42.0, -21.0, 19.0, 83.0, -63.0, -18.0, 65.0, -10.0, 149.0, -117.0, -197.0, -317.0, 3.0, 0.0, -78.0, -185.0, -126.0, 66.0, -67.0, 7.0, 21.0, -18.0, 0.0, -180.0, -152.0, 45.0, 5.0, -180.0, -46.0, 0.0, -196.0, -38.0, 50.0, 88.0, 28.0, -20.0, -18.0, 94.0, 0.0, -376.0, -13.0, 28.0, -55.0, -118.0, -328.0, 147.0, 74.0, 24.0, 184.0, -2.0, 19.0, 126.0, 73.0, -369.0, -57.0, -238.0, 0.0, -379.0, -388.0, 79.0, -75.0, 41.0, -79.0, 47.0, 179.0, -81.0, 171.0, -132.0, 129.0, 187.0, 124.0, -201.0, -370.0, -331.0, -4.0, -382.0, -373.0, 75.0, -265.0, 100.0, 188.0, 66.0, 0.0, -35.0, -308.0, -347.0, -132.0, -116.0, -5.0, -322.0, -305.0, 49.0, 10.0], "policy_predator_policy_reward": [141.0, 0.0, 18.0, 3.0, 0.0, 101.0, 7.0, 13.0, 3.0, 32.0, 37.0, 13.0, 1.0, 20.0, 33.0, 165.0, 6.0, 0.0, 9.0, 0.0, 22.0, 16.0, 108.0, 0.0, 177.0, 88.0, 68.0, 129.0, 0.0, 4.0, 18.0, 14.0, 0.0, 6.0, 0.0, 7.0, 1.0, 5.0, 18.0, 22.0, 200.0, 150.0, 197.0, 120.0, 92.0, 185.0, 25.0, 5.0, 51.0, 3.0, 0.0, 0.0, 2.0, 51.0, 94.0, 38.0, 6.0, 48.0, 164.0, 128.0, 2.0, 195.0, 0.0, 45.0, 1.0, 60.0, 6.0, 13.0, 74.0, 115.0, 3.0, 13.0, 55.0, 63.0, 177.0, 0.0, 178.0, 2.0, 28.0, 120.0, 3.0, 161.0, 0.0, 2.0, 54.0, 73.0, 22.0, 49.0, 35.0, 0.0, 0.0, 99.0, 46.0, 7.0, 82.0, 3.0, 0.0, 0.0, 9.0, 66.0, 125.0, 70.0, 1.0, 93.0, 82.0, 6.0, 40.0, 0.0, 2.0, 41.0, 8.0, 61.0, 3.0, 12.0, 12.0, 0.0, 142.0, 58.0, 135.0, 139.0, 4.0, 60.0, 62.0, 93.0, 75.0, 16.0, 44.0, 7.0, 0.0, 58.0, 100.0, 78.0, 8.0, 69.0, 87.0, 103.0, 106.0, 5.0, 0.0, 48.0, 1.0, 3.0, 10.0, 2.0, 1.0, 2.0, 187.0, 138.0, 80.0, 5.0, 170.0, 123.0, 0.0, 24.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 189.0, 21.0, 142.0, 7.0, 199.0, 189.0, 53.0, 22.0, 66.0, 22.0, 7.0, 0.0, 0.0, 45.0, 103.0, 4.0, 0.0, 0.0, 184.0, 160.0, 174.0, 18.0, 163.0, 194.0, 112.0, 111.0, 4.0, 0.0, 12.0, 16.0, 163.0, 22.0, 171.0, 125.0, 1.0, 121.0, 193.0, 152.0, 80.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0482939198837709, "mean_inference_ms": 3.284303253365624, "mean_action_processing_ms": 0.487661115512191, "mean_env_wait_ms": 0.3780695347622154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01074671745300293, "StateBufferConnector_ms": 0.004942059516906738, "ViewRequirementAgentConnector_ms": 0.4176034927368164}, "num_episodes": 18, "episode_return_max": 311.0, "episode_return_min": -499.0, "episode_return_mean": 13.45, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.96364726276, "num_env_steps_trained_throughput_per_sec": 348.96364726276, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 15595.941, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15595.882, "sample_time_ms": 3495.277, "learn_time_ms": 12074.267, "learn_throughput": 331.283, "synch_weights_time_ms": 22.294}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "e1352_00002", "date": "2024-08-13_19-34-38", "timestamp": 1723592078, "time_this_iter_s": 11.516019105911255, "time_total_s": 1969.1368737220764, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d139d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1969.1368737220764, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 55.9625, "ram_util_percent": 80.21249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.447568840119574, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 6.83657527196975, "policy_loss": -0.00018079129722777497, "vf_loss": 6.836237494907682, "vf_explained_var": 0.009213383834828776, "kl": 0.006474704944005959, "entropy": 0.8765533270974638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.42950990247348, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.486524703262974, "policy_loss": 0.00017423321192384396, "vf_loss": 8.486348850764925, "vf_explained_var": -0.2389242481302332, "kl": 0.004866485501376449, "entropy": 0.8566500454668015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 311.0, "episode_reward_min": -499.0, "episode_reward_mean": 5.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 188.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -58.69, "predator_policy": 61.33}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.0, 131.0, -273.0, -308.0, -396.0, 4.0, 25.0, 244.0, 5.0, -42.0, 13.0, -71.0, -499.0, 154.0, 99.0, 120.0, -38.0, 144.0, 28.0, -154.0, -177.0, -14.0, -49.0, 172.0, 81.0, 99.0, 32.0, -73.0, 23.0, 131.0, 48.0, 37.0, -100.0, 94.0, 19.0, 142.0, 41.0, 89.0, 62.0, 151.0, -114.0, -40.0, -14.0, -156.0, 90.0, 79.0, 40.0, -154.0, 127.0, -36.0, -85.0, 60.0, 120.0, -26.0, 97.0, -64.0, 58.0, -153.0, 245.0, 208.0, 18.0, 208.0, -216.0, -89.0, -379.0, 79.0, 50.0, 233.0, 135.0, 104.0, 311.0, -227.0, -143.0, -398.0, 33.0, 292.0, 94.0, -158.0, -183.0, 1.0, -282.0, 142.0, -126.0, 45.0, 155.0, 283.0, 93.0, 36.0, -183.0, 284.0, -81.0, -139.0, 66.0, -156.0, 153.0, 251.0, -151.0, 52.0, -69.0, -41.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [149.0, 0.0, 115.0, -24.0, -385.0, -238.0, -234.0, -391.0, -354.0, -319.0, -26.0, 0.0, -23.0, -6.0, 90.0, 154.0, -60.0, 12.0, -165.0, -9.0, 44.0, -85.0, -67.0, -296.0, -355.0, -341.0, 113.0, -4.0, -2.0, 40.0, 17.0, 84.0, -227.0, 0.0, 0.0, 128.0, 0.0, -90.0, 0.0, -331.0, -46.0, -311.0, -25.0, -137.0, -298.0, 85.0, 170.0, 0.0, -82.0, 36.0, -3.0, 31.0, 29.0, -32.0, -120.0, -52.0, 0.0, -30.0, 10.0, 36.0, 48.0, 0.0, -35.0, -3.0, -191.0, -104.0, 120.0, -120.0, -69.0, 0.0, 60.0, 42.0, -21.0, 19.0, 83.0, -63.0, -18.0, 65.0, -10.0, 149.0, -117.0, -197.0, -317.0, 3.0, 0.0, -78.0, -185.0, -126.0, 66.0, -67.0, 7.0, 21.0, -18.0, 0.0, -180.0, -152.0, 45.0, 5.0, -180.0, -46.0, 0.0, -196.0, -38.0, 50.0, 88.0, 28.0, -20.0, -18.0, 94.0, 0.0, -376.0, -13.0, 28.0, -55.0, -118.0, -328.0, 147.0, 74.0, 24.0, 184.0, -2.0, 19.0, 126.0, 73.0, -369.0, -57.0, -238.0, 0.0, -379.0, -388.0, 79.0, -75.0, 41.0, -79.0, 47.0, 179.0, -81.0, 171.0, -132.0, 129.0, 187.0, 124.0, -201.0, -370.0, -331.0, -4.0, -382.0, -373.0, 75.0, -265.0, 100.0, 188.0, 66.0, 0.0, -35.0, -308.0, -347.0, -132.0, -116.0, -5.0, -322.0, -305.0, 49.0, 10.0, -334.0, -61.0, -158.0, 33.0, -86.0, 134.0, 79.0, 123.0, 92.0, 0.0, -70.0, -51.0, -136.0, -301.0, 138.0, 101.0, -64.0, -294.0, -85.0, -338.0, -94.0, 50.0, 0.0, -352.0, -40.0, 17.0, 122.0, 91.0, -153.0, -193.0, 62.0, -137.0, 0.0, -205.0, -161.0, 0.0], "policy_predator_policy_reward": [1.0, 5.0, 18.0, 22.0, 200.0, 150.0, 197.0, 120.0, 92.0, 185.0, 25.0, 5.0, 51.0, 3.0, 0.0, 0.0, 2.0, 51.0, 94.0, 38.0, 6.0, 48.0, 164.0, 128.0, 2.0, 195.0, 0.0, 45.0, 1.0, 60.0, 6.0, 13.0, 74.0, 115.0, 3.0, 13.0, 55.0, 63.0, 177.0, 0.0, 178.0, 2.0, 28.0, 120.0, 3.0, 161.0, 0.0, 2.0, 54.0, 73.0, 22.0, 49.0, 35.0, 0.0, 0.0, 99.0, 46.0, 7.0, 82.0, 3.0, 0.0, 0.0, 9.0, 66.0, 125.0, 70.0, 1.0, 93.0, 82.0, 6.0, 40.0, 0.0, 2.0, 41.0, 8.0, 61.0, 3.0, 12.0, 12.0, 0.0, 142.0, 58.0, 135.0, 139.0, 4.0, 60.0, 62.0, 93.0, 75.0, 16.0, 44.0, 7.0, 0.0, 58.0, 100.0, 78.0, 8.0, 69.0, 87.0, 103.0, 106.0, 5.0, 0.0, 48.0, 1.0, 3.0, 10.0, 2.0, 1.0, 2.0, 187.0, 138.0, 80.0, 5.0, 170.0, 123.0, 0.0, 24.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 189.0, 21.0, 142.0, 7.0, 199.0, 189.0, 53.0, 22.0, 66.0, 22.0, 7.0, 0.0, 0.0, 45.0, 103.0, 4.0, 0.0, 0.0, 184.0, 160.0, 174.0, 18.0, 163.0, 194.0, 112.0, 111.0, 4.0, 0.0, 12.0, 16.0, 163.0, 22.0, 171.0, 125.0, 1.0, 121.0, 193.0, 152.0, 80.0, 3.0, 109.0, 160.0, 82.0, 88.0, 53.0, 54.0, 38.0, 43.0, 1.0, 0.0, 110.0, 47.0, 113.0, 141.0, 2.0, 43.0, 125.0, 152.0, 180.0, 104.0, 86.0, 24.0, 92.0, 104.0, 93.0, 83.0, 38.0, 0.0, 125.0, 70.0, 71.0, 56.0, 96.0, 40.0, 0.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.052161592924149, "mean_inference_ms": 3.3010408314982955, "mean_action_processing_ms": 0.48858842204270014, "mean_env_wait_ms": 0.3797702658948103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011760473251342773, "StateBufferConnector_ms": 0.004779934883117676, "ViewRequirementAgentConnector_ms": 0.3515826463699341}, "num_episodes": 18, "episode_return_max": 311.0, "episode_return_min": -499.0, "episode_return_mean": 5.28, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.3992354292854, "num_env_steps_trained_throughput_per_sec": 313.3992354292854, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 15480.796, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15480.737, "sample_time_ms": 3476.124, "learn_time_ms": 11977.045, "learn_throughput": 333.972, "synch_weights_time_ms": 23.629}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "e1352_00002", "date": "2024-08-13_19-34-51", "timestamp": 1723592091, "time_this_iter_s": 12.822508096694946, "time_total_s": 1981.9593818187714, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1981.9593818187714, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 66.77777777777777, "ram_util_percent": 81.21666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.52115680092857, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 7.005091045016334, "policy_loss": -0.0019439285285968, "vf_loss": 7.006170145165983, "vf_explained_var": 0.014180260329019456, "kl": 0.010798146189396054, "entropy": 0.9121335661915875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.491153691464632, "cur_kl_coeff": 0.000164794921875, "cur_lr": 0.00010000000000000003, "total_loss": 8.946779158758739, "policy_loss": -0.0016365086029052104, "vf_loss": 8.948413099561419, "vf_explained_var": -0.17631120713299545, "kl": 0.01545077781310134, "entropy": 0.8208837459327052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 311.0, "episode_reward_min": -398.0, "episode_reward_mean": 32.44, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -388.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -43.905, "predator_policy": 60.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.0, 172.0, 81.0, 99.0, 32.0, -73.0, 23.0, 131.0, 48.0, 37.0, -100.0, 94.0, 19.0, 142.0, 41.0, 89.0, 62.0, 151.0, -114.0, -40.0, -14.0, -156.0, 90.0, 79.0, 40.0, -154.0, 127.0, -36.0, -85.0, 60.0, 120.0, -26.0, 97.0, -64.0, 58.0, -153.0, 245.0, 208.0, 18.0, 208.0, -216.0, -89.0, -379.0, 79.0, 50.0, 233.0, 135.0, 104.0, 311.0, -227.0, -143.0, -398.0, 33.0, 292.0, 94.0, -158.0, -183.0, 1.0, -282.0, 142.0, -126.0, 45.0, 155.0, 283.0, 93.0, 36.0, -183.0, 284.0, -81.0, -139.0, 66.0, -156.0, 153.0, 251.0, -151.0, 52.0, -69.0, -41.0, 215.0, 55.0, -33.0, 27.0, 34.0, 105.0, 225.0, 233.0, 258.0, -20.0, -49.0, -188.0, -117.0, 129.0, 307.0, -41.0, 59.0, 236.0, 231.0, 293.0, -24.0, -69.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-298.0, 85.0, 170.0, 0.0, -82.0, 36.0, -3.0, 31.0, 29.0, -32.0, -120.0, -52.0, 0.0, -30.0, 10.0, 36.0, 48.0, 0.0, -35.0, -3.0, -191.0, -104.0, 120.0, -120.0, -69.0, 0.0, 60.0, 42.0, -21.0, 19.0, 83.0, -63.0, -18.0, 65.0, -10.0, 149.0, -117.0, -197.0, -317.0, 3.0, 0.0, -78.0, -185.0, -126.0, 66.0, -67.0, 7.0, 21.0, -18.0, 0.0, -180.0, -152.0, 45.0, 5.0, -180.0, -46.0, 0.0, -196.0, -38.0, 50.0, 88.0, 28.0, -20.0, -18.0, 94.0, 0.0, -376.0, -13.0, 28.0, -55.0, -118.0, -328.0, 147.0, 74.0, 24.0, 184.0, -2.0, 19.0, 126.0, 73.0, -369.0, -57.0, -238.0, 0.0, -379.0, -388.0, 79.0, -75.0, 41.0, -79.0, 47.0, 179.0, -81.0, 171.0, -132.0, 129.0, 187.0, 124.0, -201.0, -370.0, -331.0, -4.0, -382.0, -373.0, 75.0, -265.0, 100.0, 188.0, 66.0, 0.0, -35.0, -308.0, -347.0, -132.0, -116.0, -5.0, -322.0, -305.0, 49.0, 10.0, -334.0, -61.0, -158.0, 33.0, -86.0, 134.0, 79.0, 123.0, 92.0, 0.0, -70.0, -51.0, -136.0, -301.0, 138.0, 101.0, -64.0, -294.0, -85.0, -338.0, -94.0, 50.0, 0.0, -352.0, -40.0, 17.0, 122.0, 91.0, -153.0, -193.0, 62.0, -137.0, 0.0, -205.0, -161.0, 0.0, 55.0, 46.0, -75.0, 34.0, -346.0, 112.0, -90.0, 38.0, -243.0, 124.0, -216.0, 163.0, 126.0, 74.0, -75.0, 193.0, 139.0, 117.0, 20.0, -227.0, -119.0, -73.0, -93.0, -295.0, -235.0, -75.0, 23.0, 39.0, 188.0, 116.0, -208.0, 31.0, 148.0, -247.0, 104.0, 108.0, 176.0, 55.0, 175.0, 63.0, -125.0, 0.0, -388.0, 15.0], "policy_predator_policy_reward": [3.0, 161.0, 0.0, 2.0, 54.0, 73.0, 22.0, 49.0, 35.0, 0.0, 0.0, 99.0, 46.0, 7.0, 82.0, 3.0, 0.0, 0.0, 9.0, 66.0, 125.0, 70.0, 1.0, 93.0, 82.0, 6.0, 40.0, 0.0, 2.0, 41.0, 8.0, 61.0, 3.0, 12.0, 12.0, 0.0, 142.0, 58.0, 135.0, 139.0, 4.0, 60.0, 62.0, 93.0, 75.0, 16.0, 44.0, 7.0, 0.0, 58.0, 100.0, 78.0, 8.0, 69.0, 87.0, 103.0, 106.0, 5.0, 0.0, 48.0, 1.0, 3.0, 10.0, 2.0, 1.0, 2.0, 187.0, 138.0, 80.0, 5.0, 170.0, 123.0, 0.0, 24.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 189.0, 21.0, 142.0, 7.0, 199.0, 189.0, 53.0, 22.0, 66.0, 22.0, 7.0, 0.0, 0.0, 45.0, 103.0, 4.0, 0.0, 0.0, 184.0, 160.0, 174.0, 18.0, 163.0, 194.0, 112.0, 111.0, 4.0, 0.0, 12.0, 16.0, 163.0, 22.0, 171.0, 125.0, 1.0, 121.0, 193.0, 152.0, 80.0, 3.0, 109.0, 160.0, 82.0, 88.0, 53.0, 54.0, 38.0, 43.0, 1.0, 0.0, 110.0, 47.0, 113.0, 141.0, 2.0, 43.0, 125.0, 152.0, 180.0, 104.0, 86.0, 24.0, 92.0, 104.0, 93.0, 83.0, 38.0, 0.0, 125.0, 70.0, 71.0, 56.0, 96.0, 40.0, 0.0, 120.0, 63.0, 51.0, 0.0, 96.0, 171.0, 30.0, 1.0, 78.0, 142.0, 11.0, 45.0, 113.0, 12.0, 13.0, 72.0, 43.0, 2.0, 0.0, 116.0, 71.0, 80.0, 63.0, 74.0, 126.0, 126.0, 67.0, 2.0, 65.0, 1.0, 2.0, 136.0, 0.0, 14.0, 144.0, 21.0, 3.0, 0.0, 0.0, 25.0, 30.0, 11.0, 90.0, 176.0, 128.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0542893473802935, "mean_inference_ms": 3.3098796476043812, "mean_action_processing_ms": 0.48807396431560696, "mean_env_wait_ms": 0.38068686986199635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014838576316833496, "StateBufferConnector_ms": 0.004595279693603516, "ViewRequirementAgentConnector_ms": 0.20361673831939697}, "num_episodes": 22, "episode_return_max": 311.0, "episode_return_min": -398.0, "episode_return_mean": 32.44, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.89006988018565, "num_env_steps_trained_throughput_per_sec": 263.89006988018565, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 15847.477, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15847.417, "sample_time_ms": 3612.718, "learn_time_ms": 12205.133, "learn_throughput": 327.731, "synch_weights_time_ms": 25.299}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "e1352_00002", "date": "2024-08-13_19-35-06", "timestamp": 1723592106, "time_this_iter_s": 15.22286581993103, "time_total_s": 1997.1822476387024, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2cdcca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1997.1822476387024, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 72.92727272727274, "ram_util_percent": 82.50909090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.537057673465953, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 6.459138711293538, "policy_loss": 0.00015403097766456466, "vf_loss": 6.45856482667267, "vf_explained_var": 0.01635111478901414, "kl": 0.005242254095498528, "entropy": 0.8808227307897396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.50595709410294, "cur_kl_coeff": 0.000164794921875, "cur_lr": 0.00010000000000000003, "total_loss": 8.809454216023601, "policy_loss": -0.0026689313693346564, "vf_loss": 8.812120482782838, "vf_explained_var": -0.2248809813822388, "kl": 0.01638860603946053, "entropy": 0.844210395075026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 321.0, "episode_reward_min": -421.0, "episode_reward_mean": 29.55, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -388.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -54.035, "predator_policy": 68.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.0, 40.0, -154.0, 127.0, -36.0, -85.0, 60.0, 120.0, -26.0, 97.0, -64.0, 58.0, -153.0, 245.0, 208.0, 18.0, 208.0, -216.0, -89.0, -379.0, 79.0, 50.0, 233.0, 135.0, 104.0, 311.0, -227.0, -143.0, -398.0, 33.0, 292.0, 94.0, -158.0, -183.0, 1.0, -282.0, 142.0, -126.0, 45.0, 155.0, 283.0, 93.0, 36.0, -183.0, 284.0, -81.0, -139.0, 66.0, -156.0, 153.0, 251.0, -151.0, 52.0, -69.0, -41.0, 215.0, 55.0, -33.0, 27.0, 34.0, 105.0, 225.0, 233.0, 258.0, -20.0, -49.0, -188.0, -117.0, 129.0, 307.0, -41.0, 59.0, 236.0, 231.0, 293.0, -24.0, -69.0, -313.0, -30.0, 36.0, 260.0, 321.0, 127.0, 93.0, -421.0, 111.0, 35.0, 3.0, 144.0, -27.0, 288.0, -417.0, -97.0, -9.0, 21.0, 119.0, 14.0, 274.0, -241.0, 185.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [7.0, 21.0, -18.0, 0.0, -180.0, -152.0, 45.0, 5.0, -180.0, -46.0, 0.0, -196.0, -38.0, 50.0, 88.0, 28.0, -20.0, -18.0, 94.0, 0.0, -376.0, -13.0, 28.0, -55.0, -118.0, -328.0, 147.0, 74.0, 24.0, 184.0, -2.0, 19.0, 126.0, 73.0, -369.0, -57.0, -238.0, 0.0, -379.0, -388.0, 79.0, -75.0, 41.0, -79.0, 47.0, 179.0, -81.0, 171.0, -132.0, 129.0, 187.0, 124.0, -201.0, -370.0, -331.0, -4.0, -382.0, -373.0, 75.0, -265.0, 100.0, 188.0, 66.0, 0.0, -35.0, -308.0, -347.0, -132.0, -116.0, -5.0, -322.0, -305.0, 49.0, 10.0, -334.0, -61.0, -158.0, 33.0, -86.0, 134.0, 79.0, 123.0, 92.0, 0.0, -70.0, -51.0, -136.0, -301.0, 138.0, 101.0, -64.0, -294.0, -85.0, -338.0, -94.0, 50.0, 0.0, -352.0, -40.0, 17.0, 122.0, 91.0, -153.0, -193.0, 62.0, -137.0, 0.0, -205.0, -161.0, 0.0, 55.0, 46.0, -75.0, 34.0, -346.0, 112.0, -90.0, 38.0, -243.0, 124.0, -216.0, 163.0, 126.0, 74.0, -75.0, 193.0, 139.0, 117.0, 20.0, -227.0, -119.0, -73.0, -93.0, -295.0, -235.0, -75.0, 23.0, 39.0, 188.0, 116.0, -208.0, 31.0, 148.0, -247.0, 104.0, 108.0, 176.0, 55.0, 175.0, 63.0, -125.0, 0.0, -388.0, 15.0, -290.0, -280.0, -358.0, 0.0, -28.0, -24.0, 56.0, 160.0, 137.0, 167.0, 83.0, 0.0, -54.0, 87.0, -352.0, -289.0, -10.0, 26.0, 43.0, -112.0, -320.0, 0.0, -362.0, 134.0, -352.0, 119.0, 150.0, 126.0, -291.0, -383.0, -58.0, -214.0, -194.0, 54.0, -2.0, -208.0, 9.0, 68.0, -346.0, 181.0, -34.0, 171.0, -259.0, -354.0, -86.0, 177.0], "policy_predator_policy_reward": [44.0, 7.0, 0.0, 58.0, 100.0, 78.0, 8.0, 69.0, 87.0, 103.0, 106.0, 5.0, 0.0, 48.0, 1.0, 3.0, 10.0, 2.0, 1.0, 2.0, 187.0, 138.0, 80.0, 5.0, 170.0, 123.0, 0.0, 24.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 189.0, 21.0, 142.0, 7.0, 199.0, 189.0, 53.0, 22.0, 66.0, 22.0, 7.0, 0.0, 0.0, 45.0, 103.0, 4.0, 0.0, 0.0, 184.0, 160.0, 174.0, 18.0, 163.0, 194.0, 112.0, 111.0, 4.0, 0.0, 12.0, 16.0, 163.0, 22.0, 171.0, 125.0, 1.0, 121.0, 193.0, 152.0, 80.0, 3.0, 109.0, 160.0, 82.0, 88.0, 53.0, 54.0, 38.0, 43.0, 1.0, 0.0, 110.0, 47.0, 113.0, 141.0, 2.0, 43.0, 125.0, 152.0, 180.0, 104.0, 86.0, 24.0, 92.0, 104.0, 93.0, 83.0, 38.0, 0.0, 125.0, 70.0, 71.0, 56.0, 96.0, 40.0, 0.0, 120.0, 63.0, 51.0, 0.0, 96.0, 171.0, 30.0, 1.0, 78.0, 142.0, 11.0, 45.0, 113.0, 12.0, 13.0, 72.0, 43.0, 2.0, 0.0, 116.0, 71.0, 80.0, 63.0, 74.0, 126.0, 126.0, 67.0, 2.0, 65.0, 1.0, 2.0, 136.0, 0.0, 14.0, 144.0, 21.0, 3.0, 0.0, 0.0, 25.0, 30.0, 11.0, 90.0, 176.0, 128.0, 85.0, 172.0, 185.0, 143.0, 7.0, 81.0, 12.0, 32.0, 6.0, 11.0, 26.0, 18.0, 27.0, 33.0, 30.0, 190.0, 0.0, 95.0, 0.0, 104.0, 171.0, 152.0, 186.0, 186.0, 184.0, 22.0, 2.0, 10.0, 65.0, 192.0, 127.0, 48.0, 123.0, 8.0, 117.0, 114.0, 42.0, 0.0, 6.0, 173.0, 78.0, 59.0, 182.0, 190.0, 8.0, 86.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0521892393293095, "mean_inference_ms": 3.3128149744707462, "mean_action_processing_ms": 0.4871004982440478, "mean_env_wait_ms": 0.3806596283614945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01746344566345215, "StateBufferConnector_ms": 0.004365205764770508, "ViewRequirementAgentConnector_ms": 0.20442044734954834}, "num_episodes": 23, "episode_return_max": 321.0, "episode_return_min": -421.0, "episode_return_mean": 29.55, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 221.32271898523976, "num_env_steps_trained_throughput_per_sec": 221.32271898523976, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 16400.289, "restore_workers_time_ms": 0.019, "training_step_time_ms": 16400.23, "sample_time_ms": 3693.564, "learn_time_ms": 12677.143, "learn_throughput": 315.529, "synch_weights_time_ms": 25.253}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "e1352_00002", "date": "2024-08-13_19-35-24", "timestamp": 1723592124, "time_this_iter_s": 18.176164865493774, "time_total_s": 2015.3584125041962, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d988b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2015.3584125041962, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 91.88400000000001, "ram_util_percent": 83.836}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5484660377893498, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 4.872006337100236, "policy_loss": -0.0022221876132159086, "vf_loss": 4.873829062653597, "vf_explained_var": 0.004205175682350441, "kl": 0.0049878987036498495, "entropy": 0.8925758627672044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.90856400157409, "cur_kl_coeff": 0.000164794921875, "cur_lr": 0.00010000000000000003, "total_loss": 8.964502554091196, "policy_loss": -0.0002342336182852113, "vf_loss": 8.964734583052378, "vf_explained_var": -0.10795491725679428, "kl": 0.013445204761771471, "entropy": 0.8152499233919477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 385.0, "episode_reward_min": -421.0, "episode_reward_mean": 34.74, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -53.86, "predator_policy": 71.23}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-89.0, -379.0, 79.0, 50.0, 233.0, 135.0, 104.0, 311.0, -227.0, -143.0, -398.0, 33.0, 292.0, 94.0, -158.0, -183.0, 1.0, -282.0, 142.0, -126.0, 45.0, 155.0, 283.0, 93.0, 36.0, -183.0, 284.0, -81.0, -139.0, 66.0, -156.0, 153.0, 251.0, -151.0, 52.0, -69.0, -41.0, 215.0, 55.0, -33.0, 27.0, 34.0, 105.0, 225.0, 233.0, 258.0, -20.0, -49.0, -188.0, -117.0, 129.0, 307.0, -41.0, 59.0, 236.0, 231.0, 293.0, -24.0, -69.0, -313.0, -30.0, 36.0, 260.0, 321.0, 127.0, 93.0, -421.0, 111.0, 35.0, 3.0, 144.0, -27.0, 288.0, -417.0, -97.0, -9.0, 21.0, 119.0, 14.0, 274.0, -241.0, 185.0, 142.0, -152.0, 28.0, -345.0, -153.0, 152.0, 36.0, -2.0, 92.0, 215.0, -167.0, 114.0, 221.0, -169.0, 348.0, -11.0, 311.0, 385.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-238.0, 0.0, -379.0, -388.0, 79.0, -75.0, 41.0, -79.0, 47.0, 179.0, -81.0, 171.0, -132.0, 129.0, 187.0, 124.0, -201.0, -370.0, -331.0, -4.0, -382.0, -373.0, 75.0, -265.0, 100.0, 188.0, 66.0, 0.0, -35.0, -308.0, -347.0, -132.0, -116.0, -5.0, -322.0, -305.0, 49.0, 10.0, -334.0, -61.0, -158.0, 33.0, -86.0, 134.0, 79.0, 123.0, 92.0, 0.0, -70.0, -51.0, -136.0, -301.0, 138.0, 101.0, -64.0, -294.0, -85.0, -338.0, -94.0, 50.0, 0.0, -352.0, -40.0, 17.0, 122.0, 91.0, -153.0, -193.0, 62.0, -137.0, 0.0, -205.0, -161.0, 0.0, 55.0, 46.0, -75.0, 34.0, -346.0, 112.0, -90.0, 38.0, -243.0, 124.0, -216.0, 163.0, 126.0, 74.0, -75.0, 193.0, 139.0, 117.0, 20.0, -227.0, -119.0, -73.0, -93.0, -295.0, -235.0, -75.0, 23.0, 39.0, 188.0, 116.0, -208.0, 31.0, 148.0, -247.0, 104.0, 108.0, 176.0, 55.0, 175.0, 63.0, -125.0, 0.0, -388.0, 15.0, -290.0, -280.0, -358.0, 0.0, -28.0, -24.0, 56.0, 160.0, 137.0, 167.0, 83.0, 0.0, -54.0, 87.0, -352.0, -289.0, -10.0, 26.0, 43.0, -112.0, -320.0, 0.0, -362.0, 134.0, -352.0, 119.0, 150.0, 126.0, -291.0, -383.0, -58.0, -214.0, -194.0, 54.0, -2.0, -208.0, 9.0, 68.0, -346.0, 181.0, -34.0, 171.0, -259.0, -354.0, -86.0, 177.0, 73.0, 51.0, -160.0, -363.0, -154.0, 65.0, -391.0, -345.0, -202.0, -120.0, 53.0, 32.0, 110.0, -241.0, -160.0, -16.0, 132.0, -84.0, 17.0, 185.0, -325.0, -35.0, -134.0, 179.0, 109.0, 78.0, -148.0, -188.0, 190.0, 145.0, -168.0, 13.0, 188.0, 114.0, 191.0, 191.0], "policy_predator_policy_reward": [142.0, 7.0, 199.0, 189.0, 53.0, 22.0, 66.0, 22.0, 7.0, 0.0, 0.0, 45.0, 103.0, 4.0, 0.0, 0.0, 184.0, 160.0, 174.0, 18.0, 163.0, 194.0, 112.0, 111.0, 4.0, 0.0, 12.0, 16.0, 163.0, 22.0, 171.0, 125.0, 1.0, 121.0, 193.0, 152.0, 80.0, 3.0, 109.0, 160.0, 82.0, 88.0, 53.0, 54.0, 38.0, 43.0, 1.0, 0.0, 110.0, 47.0, 113.0, 141.0, 2.0, 43.0, 125.0, 152.0, 180.0, 104.0, 86.0, 24.0, 92.0, 104.0, 93.0, 83.0, 38.0, 0.0, 125.0, 70.0, 71.0, 56.0, 96.0, 40.0, 0.0, 120.0, 63.0, 51.0, 0.0, 96.0, 171.0, 30.0, 1.0, 78.0, 142.0, 11.0, 45.0, 113.0, 12.0, 13.0, 72.0, 43.0, 2.0, 0.0, 116.0, 71.0, 80.0, 63.0, 74.0, 126.0, 126.0, 67.0, 2.0, 65.0, 1.0, 2.0, 136.0, 0.0, 14.0, 144.0, 21.0, 3.0, 0.0, 0.0, 25.0, 30.0, 11.0, 90.0, 176.0, 128.0, 85.0, 172.0, 185.0, 143.0, 7.0, 81.0, 12.0, 32.0, 6.0, 11.0, 26.0, 18.0, 27.0, 33.0, 30.0, 190.0, 0.0, 95.0, 0.0, 104.0, 171.0, 152.0, 186.0, 186.0, 184.0, 22.0, 2.0, 10.0, 65.0, 192.0, 127.0, 48.0, 123.0, 8.0, 117.0, 114.0, 42.0, 0.0, 6.0, 173.0, 78.0, 59.0, 182.0, 190.0, 8.0, 86.0, 0.0, 18.0, 187.0, 184.0, 109.0, 8.0, 193.0, 198.0, 159.0, 10.0, 24.0, 43.0, 167.0, 0.0, 174.0, 0.0, 44.0, 0.0, 0.0, 13.0, 176.0, 17.0, 1.0, 68.0, 29.0, 5.0, 155.0, 12.0, 13.0, 0.0, 139.0, 5.0, 6.0, 3.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.053476446493626, "mean_inference_ms": 3.3077239431554886, "mean_action_processing_ms": 0.486035891397249, "mean_env_wait_ms": 0.3806608643552147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013675212860107422, "StateBufferConnector_ms": 0.004022359848022461, "ViewRequirementAgentConnector_ms": 0.2090367078781128}, "num_episodes": 18, "episode_return_max": 385.0, "episode_return_min": -421.0, "episode_return_mean": 34.74, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.96870903744184, "num_env_steps_trained_throughput_per_sec": 299.96870903744184, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 16203.236, "restore_workers_time_ms": 0.019, "training_step_time_ms": 16203.177, "sample_time_ms": 3670.379, "learn_time_ms": 12506.578, "learn_throughput": 319.832, "synch_weights_time_ms": 22.477}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "e1352_00002", "date": "2024-08-13_19-35-38", "timestamp": 1723592138, "time_this_iter_s": 13.355082988739014, "time_total_s": 2028.7134954929352, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2028.7134954929352, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 67.34210526315789, "ram_util_percent": 80.55263157894738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7346076061801305, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 6.508122291514482, "policy_loss": -0.0037257192678572166, "vf_loss": 6.511273766573144, "vf_explained_var": 0.003700049055947198, "kl": 0.014340118598612549, "entropy": 0.8897811092081525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.22913602366649, "cur_kl_coeff": 0.000164794921875, "cur_lr": 0.00010000000000000003, "total_loss": 8.892421141629496, "policy_loss": -0.0021232060612568623, "vf_loss": 8.894541429590296, "vf_explained_var": -0.14039222500311635, "kl": 0.01774361199994248, "entropy": 0.793027175481988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 385.0, "episode_reward_min": -421.0, "episode_reward_mean": 56.13, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -38.745, "predator_policy": 66.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [142.0, -126.0, 45.0, 155.0, 283.0, 93.0, 36.0, -183.0, 284.0, -81.0, -139.0, 66.0, -156.0, 153.0, 251.0, -151.0, 52.0, -69.0, -41.0, 215.0, 55.0, -33.0, 27.0, 34.0, 105.0, 225.0, 233.0, 258.0, -20.0, -49.0, -188.0, -117.0, 129.0, 307.0, -41.0, 59.0, 236.0, 231.0, 293.0, -24.0, -69.0, -313.0, -30.0, 36.0, 260.0, 321.0, 127.0, 93.0, -421.0, 111.0, 35.0, 3.0, 144.0, -27.0, 288.0, -417.0, -97.0, -9.0, 21.0, 119.0, 14.0, 274.0, -241.0, 185.0, 142.0, -152.0, 28.0, -345.0, -153.0, 152.0, 36.0, -2.0, 92.0, 215.0, -167.0, 114.0, 221.0, -169.0, 348.0, -11.0, 311.0, 385.0, -358.0, -12.0, 199.0, 364.0, 289.0, -24.0, 232.0, 105.0, -5.0, -4.0, 96.0, 18.0, 284.0, 184.0, 24.0, 45.0, 40.0, 135.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [49.0, 10.0, -334.0, -61.0, -158.0, 33.0, -86.0, 134.0, 79.0, 123.0, 92.0, 0.0, -70.0, -51.0, -136.0, -301.0, 138.0, 101.0, -64.0, -294.0, -85.0, -338.0, -94.0, 50.0, 0.0, -352.0, -40.0, 17.0, 122.0, 91.0, -153.0, -193.0, 62.0, -137.0, 0.0, -205.0, -161.0, 0.0, 55.0, 46.0, -75.0, 34.0, -346.0, 112.0, -90.0, 38.0, -243.0, 124.0, -216.0, 163.0, 126.0, 74.0, -75.0, 193.0, 139.0, 117.0, 20.0, -227.0, -119.0, -73.0, -93.0, -295.0, -235.0, -75.0, 23.0, 39.0, 188.0, 116.0, -208.0, 31.0, 148.0, -247.0, 104.0, 108.0, 176.0, 55.0, 175.0, 63.0, -125.0, 0.0, -388.0, 15.0, -290.0, -280.0, -358.0, 0.0, -28.0, -24.0, 56.0, 160.0, 137.0, 167.0, 83.0, 0.0, -54.0, 87.0, -352.0, -289.0, -10.0, 26.0, 43.0, -112.0, -320.0, 0.0, -362.0, 134.0, -352.0, 119.0, 150.0, 126.0, -291.0, -383.0, -58.0, -214.0, -194.0, 54.0, -2.0, -208.0, 9.0, 68.0, -346.0, 181.0, -34.0, 171.0, -259.0, -354.0, -86.0, 177.0, 73.0, 51.0, -160.0, -363.0, -154.0, 65.0, -391.0, -345.0, -202.0, -120.0, 53.0, 32.0, 110.0, -241.0, -160.0, -16.0, 132.0, -84.0, 17.0, 185.0, -325.0, -35.0, -134.0, 179.0, 109.0, 78.0, -148.0, -188.0, 190.0, 145.0, -168.0, 13.0, 188.0, 114.0, 191.0, 191.0, -377.0, -178.0, -315.0, 136.0, 59.0, 107.0, 163.0, 191.0, 67.0, 178.0, -258.0, 68.0, 116.0, 87.0, -171.0, 118.0, -300.0, 133.0, 67.0, -217.0, 58.0, -62.0, 36.0, -118.0, 91.0, 129.0, 142.0, -51.0, 112.0, -382.0, 29.0, -85.0, 98.0, -186.0, -125.0, 181.0], "policy_predator_policy_reward": [80.0, 3.0, 109.0, 160.0, 82.0, 88.0, 53.0, 54.0, 38.0, 43.0, 1.0, 0.0, 110.0, 47.0, 113.0, 141.0, 2.0, 43.0, 125.0, 152.0, 180.0, 104.0, 86.0, 24.0, 92.0, 104.0, 93.0, 83.0, 38.0, 0.0, 125.0, 70.0, 71.0, 56.0, 96.0, 40.0, 0.0, 120.0, 63.0, 51.0, 0.0, 96.0, 171.0, 30.0, 1.0, 78.0, 142.0, 11.0, 45.0, 113.0, 12.0, 13.0, 72.0, 43.0, 2.0, 0.0, 116.0, 71.0, 80.0, 63.0, 74.0, 126.0, 126.0, 67.0, 2.0, 65.0, 1.0, 2.0, 136.0, 0.0, 14.0, 144.0, 21.0, 3.0, 0.0, 0.0, 25.0, 30.0, 11.0, 90.0, 176.0, 128.0, 85.0, 172.0, 185.0, 143.0, 7.0, 81.0, 12.0, 32.0, 6.0, 11.0, 26.0, 18.0, 27.0, 33.0, 30.0, 190.0, 0.0, 95.0, 0.0, 104.0, 171.0, 152.0, 186.0, 186.0, 184.0, 22.0, 2.0, 10.0, 65.0, 192.0, 127.0, 48.0, 123.0, 8.0, 117.0, 114.0, 42.0, 0.0, 6.0, 173.0, 78.0, 59.0, 182.0, 190.0, 8.0, 86.0, 0.0, 18.0, 187.0, 184.0, 109.0, 8.0, 193.0, 198.0, 159.0, 10.0, 24.0, 43.0, 167.0, 0.0, 174.0, 0.0, 44.0, 0.0, 0.0, 13.0, 176.0, 17.0, 1.0, 68.0, 29.0, 5.0, 155.0, 12.0, 13.0, 0.0, 139.0, 5.0, 6.0, 3.0, 3.0, 0.0, 3.0, 194.0, 167.0, 0.0, 30.0, 3.0, 0.0, 10.0, 44.0, 0.0, 149.0, 17.0, 0.0, 29.0, 66.0, 92.0, 13.0, 149.0, 4.0, 142.0, 83.0, 17.0, 10.0, 90.0, 31.0, 33.0, 75.0, 18.0, 134.0, 160.0, 11.0, 90.0, 0.0, 128.0, 68.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0532131316507178, "mean_inference_ms": 3.307237206856844, "mean_action_processing_ms": 0.48522974090524157, "mean_env_wait_ms": 0.3807446361248546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013285398483276367, "StateBufferConnector_ms": 0.0040215253829956055, "ViewRequirementAgentConnector_ms": 0.21224558353424072}, "num_episodes": 18, "episode_return_max": 385.0, "episode_return_min": -421.0, "episode_return_mean": 56.13, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.82605840594977, "num_env_steps_trained_throughput_per_sec": 326.82605840594977, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 15140.149, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15140.096, "sample_time_ms": 3073.378, "learn_time_ms": 12041.984, "learn_throughput": 332.171, "synch_weights_time_ms": 21.229}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "e1352_00002", "date": "2024-08-13_19-35-50", "timestamp": 1723592150, "time_this_iter_s": 12.245903730392456, "time_total_s": 2040.9593992233276, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2cf5d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2040.9593992233276, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 61.45555555555555, "ram_util_percent": 74.34444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.104161035210367, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 6.405583800714482, "policy_loss": -0.002456019404245708, "vf_loss": 6.407731224998595, "vf_explained_var": -0.0005535082526938626, "kl": 0.0077062012960878905, "entropy": 0.9094652555606983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.407834885833125, "cur_kl_coeff": 0.000164794921875, "cur_lr": 0.00010000000000000003, "total_loss": 9.032331670528997, "policy_loss": -0.001042943455835696, "vf_loss": 9.033370978239352, "vf_explained_var": -0.15244177576726076, "kl": 0.022030583840267518, "entropy": 0.8302157962448382, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 385.0, "episode_reward_min": -421.0, "episode_reward_mean": 64.08, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -31.005, "predator_policy": 63.045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, 34.0, 105.0, 225.0, 233.0, 258.0, -20.0, -49.0, -188.0, -117.0, 129.0, 307.0, -41.0, 59.0, 236.0, 231.0, 293.0, -24.0, -69.0, -313.0, -30.0, 36.0, 260.0, 321.0, 127.0, 93.0, -421.0, 111.0, 35.0, 3.0, 144.0, -27.0, 288.0, -417.0, -97.0, -9.0, 21.0, 119.0, 14.0, 274.0, -241.0, 185.0, 142.0, -152.0, 28.0, -345.0, -153.0, 152.0, 36.0, -2.0, 92.0, 215.0, -167.0, 114.0, 221.0, -169.0, 348.0, -11.0, 311.0, 385.0, -358.0, -12.0, 199.0, 364.0, 289.0, -24.0, 232.0, 105.0, -5.0, -4.0, 96.0, 18.0, 284.0, 184.0, 24.0, 45.0, 40.0, 135.0, 154.0, -135.0, 67.0, 95.0, 1.0, -38.0, 32.0, 159.0, 276.0, -323.0, 213.0, -29.0, -105.0, 180.0, 327.0, -154.0, 87.0, 84.0, 235.0, 122.0, 332.0, 66.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-90.0, 38.0, -243.0, 124.0, -216.0, 163.0, 126.0, 74.0, -75.0, 193.0, 139.0, 117.0, 20.0, -227.0, -119.0, -73.0, -93.0, -295.0, -235.0, -75.0, 23.0, 39.0, 188.0, 116.0, -208.0, 31.0, 148.0, -247.0, 104.0, 108.0, 176.0, 55.0, 175.0, 63.0, -125.0, 0.0, -388.0, 15.0, -290.0, -280.0, -358.0, 0.0, -28.0, -24.0, 56.0, 160.0, 137.0, 167.0, 83.0, 0.0, -54.0, 87.0, -352.0, -289.0, -10.0, 26.0, 43.0, -112.0, -320.0, 0.0, -362.0, 134.0, -352.0, 119.0, 150.0, 126.0, -291.0, -383.0, -58.0, -214.0, -194.0, 54.0, -2.0, -208.0, 9.0, 68.0, -346.0, 181.0, -34.0, 171.0, -259.0, -354.0, -86.0, 177.0, 73.0, 51.0, -160.0, -363.0, -154.0, 65.0, -391.0, -345.0, -202.0, -120.0, 53.0, 32.0, 110.0, -241.0, -160.0, -16.0, 132.0, -84.0, 17.0, 185.0, -325.0, -35.0, -134.0, 179.0, 109.0, 78.0, -148.0, -188.0, 190.0, 145.0, -168.0, 13.0, 188.0, 114.0, 191.0, 191.0, -377.0, -178.0, -315.0, 136.0, 59.0, 107.0, 163.0, 191.0, 67.0, 178.0, -258.0, 68.0, 116.0, 87.0, -171.0, 118.0, -300.0, 133.0, 67.0, -217.0, 58.0, -62.0, 36.0, -118.0, 91.0, 129.0, 142.0, -51.0, 112.0, -382.0, 29.0, -85.0, 98.0, -186.0, -125.0, 181.0, -95.0, 194.0, -350.0, 12.0, 30.0, -23.0, 5.0, 33.0, -83.0, 0.0, 45.0, -217.0, -214.0, 76.0, -32.0, 99.0, 92.0, 160.0, -377.0, -199.0, 143.0, 33.0, -250.0, 49.0, -136.0, -198.0, 113.0, -65.0, 179.0, 126.0, -154.0, -177.0, 120.0, -123.0, -127.0, 101.0, 136.0, -46.0, 29.0, 47.0, 167.0, 140.0, -258.0, 157.0], "policy_predator_policy_reward": [1.0, 78.0, 142.0, 11.0, 45.0, 113.0, 12.0, 13.0, 72.0, 43.0, 2.0, 0.0, 116.0, 71.0, 80.0, 63.0, 74.0, 126.0, 126.0, 67.0, 2.0, 65.0, 1.0, 2.0, 136.0, 0.0, 14.0, 144.0, 21.0, 3.0, 0.0, 0.0, 25.0, 30.0, 11.0, 90.0, 176.0, 128.0, 85.0, 172.0, 185.0, 143.0, 7.0, 81.0, 12.0, 32.0, 6.0, 11.0, 26.0, 18.0, 27.0, 33.0, 30.0, 190.0, 0.0, 95.0, 0.0, 104.0, 171.0, 152.0, 186.0, 186.0, 184.0, 22.0, 2.0, 10.0, 65.0, 192.0, 127.0, 48.0, 123.0, 8.0, 117.0, 114.0, 42.0, 0.0, 6.0, 173.0, 78.0, 59.0, 182.0, 190.0, 8.0, 86.0, 0.0, 18.0, 187.0, 184.0, 109.0, 8.0, 193.0, 198.0, 159.0, 10.0, 24.0, 43.0, 167.0, 0.0, 174.0, 0.0, 44.0, 0.0, 0.0, 13.0, 176.0, 17.0, 1.0, 68.0, 29.0, 5.0, 155.0, 12.0, 13.0, 0.0, 139.0, 5.0, 6.0, 3.0, 3.0, 0.0, 3.0, 194.0, 167.0, 0.0, 30.0, 3.0, 0.0, 10.0, 44.0, 0.0, 149.0, 17.0, 0.0, 29.0, 66.0, 92.0, 13.0, 149.0, 4.0, 142.0, 83.0, 17.0, 10.0, 90.0, 31.0, 33.0, 75.0, 18.0, 134.0, 160.0, 11.0, 90.0, 0.0, 128.0, 68.0, 11.0, 7.0, 48.0, 30.0, 173.0, 53.0, 7.0, 57.0, 0.0, 27.0, 57.0, 12.0, 122.0, 34.0, 136.0, 92.0, 0.0, 0.0, 24.0, 68.0, 185.0, 0.0, 37.0, 12.0, 160.0, 64.0, 165.0, 69.0, 63.0, 4.0, 18.0, 38.0, 139.0, 0.0, 90.0, 2.0, 108.0, 81.0, 64.0, 8.0, 38.0, 22.0, 3.0, 115.0, 52.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0526737438906393, "mean_inference_ms": 3.3035751786887446, "mean_action_processing_ms": 0.48422956204216805, "mean_env_wait_ms": 0.38097726586096753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011932134628295898, "StateBufferConnector_ms": 0.004372000694274902, "ViewRequirementAgentConnector_ms": 0.21252930164337158}, "num_episodes": 22, "episode_return_max": 385.0, "episode_return_min": -421.0, "episode_return_mean": 64.08, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.4316195799053, "num_env_steps_trained_throughput_per_sec": 346.4316195799053, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 14373.14, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14373.088, "sample_time_ms": 2775.938, "learn_time_ms": 11576.911, "learn_throughput": 345.515, "synch_weights_time_ms": 17.427}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "e1352_00002", "date": "2024-08-13_19-36-02", "timestamp": 1723592162, "time_this_iter_s": 11.560864925384521, "time_total_s": 2052.520264148712, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2cf5ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2052.520264148712, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 57.787499999999994, "ram_util_percent": 75.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9461784714744206, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 6.87860886306359, "policy_loss": -0.001769776270779037, "vf_loss": 6.880015874287439, "vf_explained_var": 0.00682739533444561, "kl": 0.009058719809264763, "entropy": 0.91431430726455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.58037771557374, "cur_kl_coeff": 0.00024719238281249993, "cur_lr": 0.00010000000000000003, "total_loss": 8.548663148425874, "policy_loss": 0.002630736354107737, "vf_loss": 8.546029590929626, "vf_explained_var": -0.24412556375776018, "kl": 0.011246367355957175, "entropy": 0.8375869779044358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 385.0, "episode_reward_min": -453.0, "episode_reward_mean": 50.67, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -42.25, "predator_policy": 67.585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-69.0, -313.0, -30.0, 36.0, 260.0, 321.0, 127.0, 93.0, -421.0, 111.0, 35.0, 3.0, 144.0, -27.0, 288.0, -417.0, -97.0, -9.0, 21.0, 119.0, 14.0, 274.0, -241.0, 185.0, 142.0, -152.0, 28.0, -345.0, -153.0, 152.0, 36.0, -2.0, 92.0, 215.0, -167.0, 114.0, 221.0, -169.0, 348.0, -11.0, 311.0, 385.0, -358.0, -12.0, 199.0, 364.0, 289.0, -24.0, 232.0, 105.0, -5.0, -4.0, 96.0, 18.0, 284.0, 184.0, 24.0, 45.0, 40.0, 135.0, 154.0, -135.0, 67.0, 95.0, 1.0, -38.0, 32.0, 159.0, 276.0, -323.0, 213.0, -29.0, -105.0, 180.0, 327.0, -154.0, 87.0, 84.0, 235.0, 122.0, 332.0, 66.0, -453.0, -102.0, 48.0, 214.0, 157.0, -119.0, 208.0, 30.0, 143.0, 251.0, 166.0, -305.0, 84.0, 170.0, 80.0, -35.0, 107.0, -287.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-388.0, 15.0, -290.0, -280.0, -358.0, 0.0, -28.0, -24.0, 56.0, 160.0, 137.0, 167.0, 83.0, 0.0, -54.0, 87.0, -352.0, -289.0, -10.0, 26.0, 43.0, -112.0, -320.0, 0.0, -362.0, 134.0, -352.0, 119.0, 150.0, 126.0, -291.0, -383.0, -58.0, -214.0, -194.0, 54.0, -2.0, -208.0, 9.0, 68.0, -346.0, 181.0, -34.0, 171.0, -259.0, -354.0, -86.0, 177.0, 73.0, 51.0, -160.0, -363.0, -154.0, 65.0, -391.0, -345.0, -202.0, -120.0, 53.0, 32.0, 110.0, -241.0, -160.0, -16.0, 132.0, -84.0, 17.0, 185.0, -325.0, -35.0, -134.0, 179.0, 109.0, 78.0, -148.0, -188.0, 190.0, 145.0, -168.0, 13.0, 188.0, 114.0, 191.0, 191.0, -377.0, -178.0, -315.0, 136.0, 59.0, 107.0, 163.0, 191.0, 67.0, 178.0, -258.0, 68.0, 116.0, 87.0, -171.0, 118.0, -300.0, 133.0, 67.0, -217.0, 58.0, -62.0, 36.0, -118.0, 91.0, 129.0, 142.0, -51.0, 112.0, -382.0, 29.0, -85.0, 98.0, -186.0, -125.0, 181.0, -95.0, 194.0, -350.0, 12.0, 30.0, -23.0, 5.0, 33.0, -83.0, 0.0, 45.0, -217.0, -214.0, 76.0, -32.0, 99.0, 92.0, 160.0, -377.0, -199.0, 143.0, 33.0, -250.0, 49.0, -136.0, -198.0, 113.0, -65.0, 179.0, 126.0, -154.0, -177.0, 120.0, -123.0, -127.0, 101.0, 136.0, -46.0, 29.0, 47.0, 167.0, 140.0, -258.0, 157.0, -370.0, -374.0, -40.0, -238.0, 137.0, -243.0, -84.0, 197.0, 156.0, 0.0, -150.0, -174.0, 76.0, 117.0, -337.0, 169.0, 127.0, -91.0, 172.0, -11.0, -5.0, 103.0, -337.0, -268.0, 47.0, -112.0, 35.0, 122.0, 58.0, -202.0, -265.0, 0.0, 26.0, -50.0, -289.0, -252.0], "policy_predator_policy_reward": [176.0, 128.0, 85.0, 172.0, 185.0, 143.0, 7.0, 81.0, 12.0, 32.0, 6.0, 11.0, 26.0, 18.0, 27.0, 33.0, 30.0, 190.0, 0.0, 95.0, 0.0, 104.0, 171.0, 152.0, 186.0, 186.0, 184.0, 22.0, 2.0, 10.0, 65.0, 192.0, 127.0, 48.0, 123.0, 8.0, 117.0, 114.0, 42.0, 0.0, 6.0, 173.0, 78.0, 59.0, 182.0, 190.0, 8.0, 86.0, 0.0, 18.0, 187.0, 184.0, 109.0, 8.0, 193.0, 198.0, 159.0, 10.0, 24.0, 43.0, 167.0, 0.0, 174.0, 0.0, 44.0, 0.0, 0.0, 13.0, 176.0, 17.0, 1.0, 68.0, 29.0, 5.0, 155.0, 12.0, 13.0, 0.0, 139.0, 5.0, 6.0, 3.0, 3.0, 0.0, 3.0, 194.0, 167.0, 0.0, 30.0, 3.0, 0.0, 10.0, 44.0, 0.0, 149.0, 17.0, 0.0, 29.0, 66.0, 92.0, 13.0, 149.0, 4.0, 142.0, 83.0, 17.0, 10.0, 90.0, 31.0, 33.0, 75.0, 18.0, 134.0, 160.0, 11.0, 90.0, 0.0, 128.0, 68.0, 11.0, 7.0, 48.0, 30.0, 173.0, 53.0, 7.0, 57.0, 0.0, 27.0, 57.0, 12.0, 122.0, 34.0, 136.0, 92.0, 0.0, 0.0, 24.0, 68.0, 185.0, 0.0, 37.0, 12.0, 160.0, 64.0, 165.0, 69.0, 63.0, 4.0, 18.0, 38.0, 139.0, 0.0, 90.0, 2.0, 108.0, 81.0, 64.0, 8.0, 38.0, 22.0, 3.0, 115.0, 52.0, 199.0, 92.0, 19.0, 157.0, 126.0, 28.0, 49.0, 52.0, 1.0, 0.0, 95.0, 110.0, 1.0, 14.0, 85.0, 113.0, 96.0, 11.0, 30.0, 60.0, 2.0, 66.0, 164.0, 136.0, 75.0, 74.0, 0.0, 13.0, 85.0, 139.0, 75.0, 155.0, 60.0, 71.0, 85.0, 169.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0510669093086404, "mean_inference_ms": 3.3014892712940225, "mean_action_processing_ms": 0.4832321585781009, "mean_env_wait_ms": 0.3801335572950126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009411096572875977, "StateBufferConnector_ms": 0.004136919975280762, "ViewRequirementAgentConnector_ms": 0.20452940464019775}, "num_episodes": 18, "episode_return_max": 385.0, "episode_return_min": -453.0, "episode_return_mean": 50.67, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 345.0568968400521, "num_env_steps_trained_throughput_per_sec": 345.0568968400521, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 13692.744, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13692.695, "sample_time_ms": 2419.743, "learn_time_ms": 11253.494, "learn_throughput": 355.445, "synch_weights_time_ms": 16.563}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "e1352_00002", "date": "2024-08-13_19-36-13", "timestamp": 1723592173, "time_this_iter_s": 11.638406991958618, "time_total_s": 2064.158671140671, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2064.158671140671, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 57.111764705882344, "ram_util_percent": 77.61176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6885247707051576, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 6.52989932241894, "policy_loss": -0.004084225539019499, "vf_loss": 6.533400807809578, "vf_explained_var": 0.014149486419385073, "kl": 0.014551987165566094, "entropy": 0.9598989020895075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.628628607196784, "cur_kl_coeff": 0.00024719238281249993, "cur_lr": 0.00010000000000000003, "total_loss": 8.701011836591851, "policy_loss": 0.0015505531138774974, "vf_loss": 8.69945135267954, "vf_explained_var": -0.20071604974055415, "kl": 0.04019054911135646, "entropy": 0.7757378892608421, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 385.0, "episode_reward_min": -453.0, "episode_reward_mean": 69.72, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -26.99, "predator_policy": 61.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [185.0, 142.0, -152.0, 28.0, -345.0, -153.0, 152.0, 36.0, -2.0, 92.0, 215.0, -167.0, 114.0, 221.0, -169.0, 348.0, -11.0, 311.0, 385.0, -358.0, -12.0, 199.0, 364.0, 289.0, -24.0, 232.0, 105.0, -5.0, -4.0, 96.0, 18.0, 284.0, 184.0, 24.0, 45.0, 40.0, 135.0, 154.0, -135.0, 67.0, 95.0, 1.0, -38.0, 32.0, 159.0, 276.0, -323.0, 213.0, -29.0, -105.0, 180.0, 327.0, -154.0, 87.0, 84.0, 235.0, 122.0, 332.0, 66.0, -453.0, -102.0, 48.0, 214.0, 157.0, -119.0, 208.0, 30.0, 143.0, 251.0, 166.0, -305.0, 84.0, 170.0, 80.0, -35.0, 107.0, -287.0, -1.0, 131.0, -72.0, 157.0, 141.0, 168.0, 157.0, 284.0, 52.0, 99.0, 221.0, 71.0, 328.0, 125.0, 89.0, -384.0, 39.0, 175.0, 60.0, -143.0, -23.0, 262.0, 191.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-86.0, 177.0, 73.0, 51.0, -160.0, -363.0, -154.0, 65.0, -391.0, -345.0, -202.0, -120.0, 53.0, 32.0, 110.0, -241.0, -160.0, -16.0, 132.0, -84.0, 17.0, 185.0, -325.0, -35.0, -134.0, 179.0, 109.0, 78.0, -148.0, -188.0, 190.0, 145.0, -168.0, 13.0, 188.0, 114.0, 191.0, 191.0, -377.0, -178.0, -315.0, 136.0, 59.0, 107.0, 163.0, 191.0, 67.0, 178.0, -258.0, 68.0, 116.0, 87.0, -171.0, 118.0, -300.0, 133.0, 67.0, -217.0, 58.0, -62.0, 36.0, -118.0, 91.0, 129.0, 142.0, -51.0, 112.0, -382.0, 29.0, -85.0, 98.0, -186.0, -125.0, 181.0, -95.0, 194.0, -350.0, 12.0, 30.0, -23.0, 5.0, 33.0, -83.0, 0.0, 45.0, -217.0, -214.0, 76.0, -32.0, 99.0, 92.0, 160.0, -377.0, -199.0, 143.0, 33.0, -250.0, 49.0, -136.0, -198.0, 113.0, -65.0, 179.0, 126.0, -154.0, -177.0, 120.0, -123.0, -127.0, 101.0, 136.0, -46.0, 29.0, 47.0, 167.0, 140.0, -258.0, 157.0, -370.0, -374.0, -40.0, -238.0, 137.0, -243.0, -84.0, 197.0, 156.0, 0.0, -150.0, -174.0, 76.0, 117.0, -337.0, 169.0, 127.0, -91.0, 172.0, -11.0, -5.0, 103.0, -337.0, -268.0, 47.0, -112.0, 35.0, 122.0, 58.0, -202.0, -265.0, 0.0, 26.0, -50.0, -289.0, -252.0, -242.0, 80.0, -93.0, 120.0, -109.0, -186.0, -70.0, 137.0, -145.0, 186.0, 157.0, -111.0, 67.0, 35.0, 66.0, 186.0, 165.0, -271.0, -372.0, 108.0, 94.0, 127.0, 5.0, -46.0, 156.0, 163.0, -106.0, 129.0, -109.0, 59.0, -394.0, -329.0, 83.0, -175.0, 159.0, 16.0, -201.0, 151.0, -145.0, -303.0, -127.0, 0.0, -19.0, 189.0, 123.0, 68.0], "policy_predator_policy_reward": [8.0, 86.0, 0.0, 18.0, 187.0, 184.0, 109.0, 8.0, 193.0, 198.0, 159.0, 10.0, 24.0, 43.0, 167.0, 0.0, 174.0, 0.0, 44.0, 0.0, 0.0, 13.0, 176.0, 17.0, 1.0, 68.0, 29.0, 5.0, 155.0, 12.0, 13.0, 0.0, 139.0, 5.0, 6.0, 3.0, 3.0, 0.0, 3.0, 194.0, 167.0, 0.0, 30.0, 3.0, 0.0, 10.0, 44.0, 0.0, 149.0, 17.0, 0.0, 29.0, 66.0, 92.0, 13.0, 149.0, 4.0, 142.0, 83.0, 17.0, 10.0, 90.0, 31.0, 33.0, 75.0, 18.0, 134.0, 160.0, 11.0, 90.0, 0.0, 128.0, 68.0, 11.0, 7.0, 48.0, 30.0, 173.0, 53.0, 7.0, 57.0, 0.0, 27.0, 57.0, 12.0, 122.0, 34.0, 136.0, 92.0, 0.0, 0.0, 24.0, 68.0, 185.0, 0.0, 37.0, 12.0, 160.0, 64.0, 165.0, 69.0, 63.0, 4.0, 18.0, 38.0, 139.0, 0.0, 90.0, 2.0, 108.0, 81.0, 64.0, 8.0, 38.0, 22.0, 3.0, 115.0, 52.0, 199.0, 92.0, 19.0, 157.0, 126.0, 28.0, 49.0, 52.0, 1.0, 0.0, 95.0, 110.0, 1.0, 14.0, 85.0, 113.0, 96.0, 11.0, 30.0, 60.0, 2.0, 66.0, 164.0, 136.0, 75.0, 74.0, 0.0, 13.0, 85.0, 139.0, 75.0, 155.0, 60.0, 71.0, 85.0, 169.0, 150.0, 11.0, 95.0, 9.0, 97.0, 126.0, 1.0, 89.0, 14.0, 86.0, 49.0, 73.0, 50.0, 5.0, 2.0, 30.0, 31.0, 127.0, 184.0, 179.0, 0.0, 0.0, 89.0, 23.0, 0.0, 9.0, 98.0, 4.0, 48.0, 91.0, 185.0, 154.0, 111.0, 20.0, 0.0, 0.0, 26.0, 84.0, 143.0, 162.0, 0.0, 104.0, 47.0, 45.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.049650705534866, "mean_inference_ms": 3.295970303150005, "mean_action_processing_ms": 0.48149356576952146, "mean_env_wait_ms": 0.3793112218274296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068552494049072266, "StateBufferConnector_ms": 0.004114866256713867, "ViewRequirementAgentConnector_ms": 0.1659764051437378}, "num_episodes": 23, "episode_return_max": 385.0, "episode_return_min": -453.0, "episode_return_mean": 69.72, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.70177996431823, "num_env_steps_trained_throughput_per_sec": 270.70177996431823, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 13315.484, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13315.442, "sample_time_ms": 2239.762, "learn_time_ms": 11053.437, "learn_throughput": 361.878, "synch_weights_time_ms": 18.989}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "e1352_00002", "date": "2024-08-13_19-36-28", "timestamp": 1723592188, "time_this_iter_s": 14.911602973937988, "time_total_s": 2079.0702741146088, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2cf5d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2079.0702741146088, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 67.54761904761907, "ram_util_percent": 81.65238095238095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.985150432523596, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 6.58368145700485, "policy_loss": -0.0023792466234967666, "vf_loss": 6.585548565375111, "vf_explained_var": -0.011194459912638184, "kl": 0.012789018406687001, "entropy": 0.9409286718204539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.874509476322345, "cur_kl_coeff": 0.0003707885742187501, "cur_lr": 0.00010000000000000003, "total_loss": 8.697372815217921, "policy_loss": 0.00535656650570374, "vf_loss": 8.692005175635929, "vf_explained_var": -0.2749850402118037, "kl": 0.029861829758754944, "entropy": 0.8060869252555585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 385.0, "episode_reward_min": -453.0, "episode_reward_mean": 71.09, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -26.435, "predator_policy": 61.98}, "custom_metrics": {}, "hist_stats": {"episode_reward": [385.0, -358.0, -12.0, 199.0, 364.0, 289.0, -24.0, 232.0, 105.0, -5.0, -4.0, 96.0, 18.0, 284.0, 184.0, 24.0, 45.0, 40.0, 135.0, 154.0, -135.0, 67.0, 95.0, 1.0, -38.0, 32.0, 159.0, 276.0, -323.0, 213.0, -29.0, -105.0, 180.0, 327.0, -154.0, 87.0, 84.0, 235.0, 122.0, 332.0, 66.0, -453.0, -102.0, 48.0, 214.0, 157.0, -119.0, 208.0, 30.0, 143.0, 251.0, 166.0, -305.0, 84.0, 170.0, 80.0, -35.0, 107.0, -287.0, -1.0, 131.0, -72.0, 157.0, 141.0, 168.0, 157.0, 284.0, 52.0, 99.0, 221.0, 71.0, 328.0, 125.0, 89.0, -384.0, 39.0, 175.0, 60.0, -143.0, -23.0, 262.0, 191.0, -4.0, -159.0, 239.0, -108.0, -16.0, -103.0, 130.0, 214.0, 302.0, 204.0, 267.0, 114.0, -48.0, 106.0, -295.0, 140.0, -195.0, 194.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [191.0, 191.0, -377.0, -178.0, -315.0, 136.0, 59.0, 107.0, 163.0, 191.0, 67.0, 178.0, -258.0, 68.0, 116.0, 87.0, -171.0, 118.0, -300.0, 133.0, 67.0, -217.0, 58.0, -62.0, 36.0, -118.0, 91.0, 129.0, 142.0, -51.0, 112.0, -382.0, 29.0, -85.0, 98.0, -186.0, -125.0, 181.0, -95.0, 194.0, -350.0, 12.0, 30.0, -23.0, 5.0, 33.0, -83.0, 0.0, 45.0, -217.0, -214.0, 76.0, -32.0, 99.0, 92.0, 160.0, -377.0, -199.0, 143.0, 33.0, -250.0, 49.0, -136.0, -198.0, 113.0, -65.0, 179.0, 126.0, -154.0, -177.0, 120.0, -123.0, -127.0, 101.0, 136.0, -46.0, 29.0, 47.0, 167.0, 140.0, -258.0, 157.0, -370.0, -374.0, -40.0, -238.0, 137.0, -243.0, -84.0, 197.0, 156.0, 0.0, -150.0, -174.0, 76.0, 117.0, -337.0, 169.0, 127.0, -91.0, 172.0, -11.0, -5.0, 103.0, -337.0, -268.0, 47.0, -112.0, 35.0, 122.0, 58.0, -202.0, -265.0, 0.0, 26.0, -50.0, -289.0, -252.0, -242.0, 80.0, -93.0, 120.0, -109.0, -186.0, -70.0, 137.0, -145.0, 186.0, 157.0, -111.0, 67.0, 35.0, 66.0, 186.0, 165.0, -271.0, -372.0, 108.0, 94.0, 127.0, 5.0, -46.0, 156.0, 163.0, -106.0, 129.0, -109.0, 59.0, -394.0, -329.0, 83.0, -175.0, 159.0, 16.0, -201.0, 151.0, -145.0, -303.0, -127.0, 0.0, -19.0, 189.0, 123.0, 68.0, 68.0, -370.0, -299.0, -36.0, 170.0, 55.0, 0.0, -268.0, -189.0, 16.0, -193.0, -232.0, -12.0, 56.0, 118.0, 87.0, 62.0, 185.0, -84.0, 192.0, 109.0, 95.0, 100.0, 0.0, -59.0, -309.0, 0.0, 92.0, -226.0, -248.0, 111.0, 0.0, -247.0, -187.0, 78.0, 67.0], "policy_predator_policy_reward": [3.0, 0.0, 3.0, 194.0, 167.0, 0.0, 30.0, 3.0, 0.0, 10.0, 44.0, 0.0, 149.0, 17.0, 0.0, 29.0, 66.0, 92.0, 13.0, 149.0, 4.0, 142.0, 83.0, 17.0, 10.0, 90.0, 31.0, 33.0, 75.0, 18.0, 134.0, 160.0, 11.0, 90.0, 0.0, 128.0, 68.0, 11.0, 7.0, 48.0, 30.0, 173.0, 53.0, 7.0, 57.0, 0.0, 27.0, 57.0, 12.0, 122.0, 34.0, 136.0, 92.0, 0.0, 0.0, 24.0, 68.0, 185.0, 0.0, 37.0, 12.0, 160.0, 64.0, 165.0, 69.0, 63.0, 4.0, 18.0, 38.0, 139.0, 0.0, 90.0, 2.0, 108.0, 81.0, 64.0, 8.0, 38.0, 22.0, 3.0, 115.0, 52.0, 199.0, 92.0, 19.0, 157.0, 126.0, 28.0, 49.0, 52.0, 1.0, 0.0, 95.0, 110.0, 1.0, 14.0, 85.0, 113.0, 96.0, 11.0, 30.0, 60.0, 2.0, 66.0, 164.0, 136.0, 75.0, 74.0, 0.0, 13.0, 85.0, 139.0, 75.0, 155.0, 60.0, 71.0, 85.0, 169.0, 150.0, 11.0, 95.0, 9.0, 97.0, 126.0, 1.0, 89.0, 14.0, 86.0, 49.0, 73.0, 50.0, 5.0, 2.0, 30.0, 31.0, 127.0, 184.0, 179.0, 0.0, 0.0, 89.0, 23.0, 0.0, 9.0, 98.0, 4.0, 48.0, 91.0, 185.0, 154.0, 111.0, 20.0, 0.0, 0.0, 26.0, 84.0, 143.0, 162.0, 0.0, 104.0, 47.0, 45.0, 0.0, 0.0, 136.0, 162.0, 135.0, 41.0, 7.0, 7.0, 26.0, 134.0, 101.0, 56.0, 147.0, 175.0, 47.0, 39.0, 0.0, 9.0, 44.0, 11.0, 81.0, 15.0, 26.0, 37.0, 14.0, 0.0, 167.0, 153.0, 7.0, 7.0, 24.0, 155.0, 0.0, 29.0, 175.0, 64.0, 30.0, 19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0496419673088768, "mean_inference_ms": 3.294907060058305, "mean_action_processing_ms": 0.4807684573275441, "mean_env_wait_ms": 0.3789210461070537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006618618965148926, "StateBufferConnector_ms": 0.004140019416809082, "ViewRequirementAgentConnector_ms": 0.16728007793426514}, "num_episodes": 18, "episode_return_max": 385.0, "episode_return_min": -453.0, "episode_return_mean": 71.09, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.36623606993436, "num_env_steps_trained_throughput_per_sec": 283.36623606993436, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 13506.148, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13506.107, "sample_time_ms": 2394.127, "learn_time_ms": 11090.365, "learn_throughput": 360.673, "synch_weights_time_ms": 19.003}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "e1352_00002", "date": "2024-08-13_19-36-43", "timestamp": 1723592203, "time_this_iter_s": 14.137221813201904, "time_total_s": 2093.2074959278107, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e22670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2093.2074959278107, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 68.425, "ram_util_percent": 83.345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.550159266922209, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 6.776584606322031, "policy_loss": -0.0013010982916784033, "vf_loss": 6.777413211550031, "vf_explained_var": -0.005652558866632048, "kl": 0.011798483225062856, "entropy": 0.924848824581772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.24097530942745, "cur_kl_coeff": 0.0005561828613281247, "cur_lr": 0.00010000000000000003, "total_loss": 9.053701056626739, "policy_loss": 0.00434972513996794, "vf_loss": 9.049336786118765, "vf_explained_var": -0.18333229482489288, "kl": 0.026162036260738448, "entropy": 0.7956145118153285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 332.0, "episode_reward_min": -453.0, "episode_reward_mean": 60.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -35.4, "predator_policy": 65.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.0, 1.0, -38.0, 32.0, 159.0, 276.0, -323.0, 213.0, -29.0, -105.0, 180.0, 327.0, -154.0, 87.0, 84.0, 235.0, 122.0, 332.0, 66.0, -453.0, -102.0, 48.0, 214.0, 157.0, -119.0, 208.0, 30.0, 143.0, 251.0, 166.0, -305.0, 84.0, 170.0, 80.0, -35.0, 107.0, -287.0, -1.0, 131.0, -72.0, 157.0, 141.0, 168.0, 157.0, 284.0, 52.0, 99.0, 221.0, 71.0, 328.0, 125.0, 89.0, -384.0, 39.0, 175.0, 60.0, -143.0, -23.0, 262.0, 191.0, -4.0, -159.0, 239.0, -108.0, -16.0, -103.0, 130.0, 214.0, 302.0, 204.0, 267.0, 114.0, -48.0, 106.0, -295.0, 140.0, -195.0, 194.0, 199.0, 77.0, 116.0, -69.0, 157.0, -126.0, 63.0, 37.0, -89.0, 224.0, 91.0, -37.0, 112.0, 135.0, -271.0, 286.0, 3.0, -80.0, 55.0, -223.0, 63.0, 331.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.0, 33.0, -83.0, 0.0, 45.0, -217.0, -214.0, 76.0, -32.0, 99.0, 92.0, 160.0, -377.0, -199.0, 143.0, 33.0, -250.0, 49.0, -136.0, -198.0, 113.0, -65.0, 179.0, 126.0, -154.0, -177.0, 120.0, -123.0, -127.0, 101.0, 136.0, -46.0, 29.0, 47.0, 167.0, 140.0, -258.0, 157.0, -370.0, -374.0, -40.0, -238.0, 137.0, -243.0, -84.0, 197.0, 156.0, 0.0, -150.0, -174.0, 76.0, 117.0, -337.0, 169.0, 127.0, -91.0, 172.0, -11.0, -5.0, 103.0, -337.0, -268.0, 47.0, -112.0, 35.0, 122.0, 58.0, -202.0, -265.0, 0.0, 26.0, -50.0, -289.0, -252.0, -242.0, 80.0, -93.0, 120.0, -109.0, -186.0, -70.0, 137.0, -145.0, 186.0, 157.0, -111.0, 67.0, 35.0, 66.0, 186.0, 165.0, -271.0, -372.0, 108.0, 94.0, 127.0, 5.0, -46.0, 156.0, 163.0, -106.0, 129.0, -109.0, 59.0, -394.0, -329.0, 83.0, -175.0, 159.0, 16.0, -201.0, 151.0, -145.0, -303.0, -127.0, 0.0, -19.0, 189.0, 123.0, 68.0, 68.0, -370.0, -299.0, -36.0, 170.0, 55.0, 0.0, -268.0, -189.0, 16.0, -193.0, -232.0, -12.0, 56.0, 118.0, 87.0, 62.0, 185.0, -84.0, 192.0, 109.0, 95.0, 100.0, 0.0, -59.0, -309.0, 0.0, 92.0, -226.0, -248.0, 111.0, 0.0, -247.0, -187.0, 78.0, 67.0, 165.0, -243.0, -148.0, 118.0, 178.0, -372.0, -302.0, 29.0, 112.0, -104.0, -10.0, -307.0, -46.0, -32.0, 6.0, -11.0, -203.0, -16.0, 70.0, 110.0, -4.0, 21.0, -17.0, -236.0, 106.0, -108.0, 14.0, 121.0, -253.0, -242.0, 127.0, 150.0, -296.0, 108.0, -310.0, -9.0, -4.0, -15.0, -375.0, -110.0, 61.0, -151.0, 144.0, 182.0], "policy_predator_policy_reward": [57.0, 0.0, 27.0, 57.0, 12.0, 122.0, 34.0, 136.0, 92.0, 0.0, 0.0, 24.0, 68.0, 185.0, 0.0, 37.0, 12.0, 160.0, 64.0, 165.0, 69.0, 63.0, 4.0, 18.0, 38.0, 139.0, 0.0, 90.0, 2.0, 108.0, 81.0, 64.0, 8.0, 38.0, 22.0, 3.0, 115.0, 52.0, 199.0, 92.0, 19.0, 157.0, 126.0, 28.0, 49.0, 52.0, 1.0, 0.0, 95.0, 110.0, 1.0, 14.0, 85.0, 113.0, 96.0, 11.0, 30.0, 60.0, 2.0, 66.0, 164.0, 136.0, 75.0, 74.0, 0.0, 13.0, 85.0, 139.0, 75.0, 155.0, 60.0, 71.0, 85.0, 169.0, 150.0, 11.0, 95.0, 9.0, 97.0, 126.0, 1.0, 89.0, 14.0, 86.0, 49.0, 73.0, 50.0, 5.0, 2.0, 30.0, 31.0, 127.0, 184.0, 179.0, 0.0, 0.0, 89.0, 23.0, 0.0, 9.0, 98.0, 4.0, 48.0, 91.0, 185.0, 154.0, 111.0, 20.0, 0.0, 0.0, 26.0, 84.0, 143.0, 162.0, 0.0, 104.0, 47.0, 45.0, 0.0, 0.0, 136.0, 162.0, 135.0, 41.0, 7.0, 7.0, 26.0, 134.0, 101.0, 56.0, 147.0, 175.0, 47.0, 39.0, 0.0, 9.0, 44.0, 11.0, 81.0, 15.0, 26.0, 37.0, 14.0, 0.0, 167.0, 153.0, 7.0, 7.0, 24.0, 155.0, 0.0, 29.0, 175.0, 64.0, 30.0, 19.0, 131.0, 146.0, 52.0, 55.0, 123.0, 187.0, 58.0, 146.0, 76.0, 73.0, 162.0, 29.0, 67.0, 74.0, 0.0, 42.0, 4.0, 126.0, 32.0, 12.0, 74.0, 0.0, 74.0, 142.0, 89.0, 25.0, 0.0, 0.0, 128.0, 96.0, 9.0, 0.0, 85.0, 106.0, 174.0, 65.0, 73.0, 1.0, 138.0, 124.0, 103.0, 50.0, 5.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0497817294531913, "mean_inference_ms": 3.2919089407639173, "mean_action_processing_ms": 0.4800572650963406, "mean_env_wait_ms": 0.3788351762908806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006628632545471191, "StateBufferConnector_ms": 0.0040607452392578125, "ViewRequirementAgentConnector_ms": 0.16640925407409668}, "num_episodes": 22, "episode_return_max": 332.0, "episode_return_min": -453.0, "episode_return_mean": 60.8, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 343.01890781258084, "num_env_steps_trained_throughput_per_sec": 343.01890781258084, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 13526.014, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13525.95, "sample_time_ms": 2411.872, "learn_time_ms": 11091.497, "learn_throughput": 360.637, "synch_weights_time_ms": 19.728}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "e1352_00002", "date": "2024-08-13_19-36-54", "timestamp": 1723592214, "time_this_iter_s": 11.714420795440674, "time_total_s": 2104.9219167232513, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e228b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2104.9219167232513, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 58.12352941176471, "ram_util_percent": 83.24117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5093275230870677, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 6.23542284587073, "policy_loss": -0.002638226016498511, "vf_loss": 6.237440065605931, "vf_explained_var": 6.650831333543889e-05, "kl": 0.0155075343907162, "entropy": 0.979278034507913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.673187656629654, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 0.00010000000000000003, "total_loss": 8.756764745459986, "policy_loss": -0.0002522023681738468, "vf_loss": 8.757005977126026, "vf_explained_var": -0.055588929016123376, "kl": 0.013142279818671141, "entropy": 0.7540288660892103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 344.0, "episode_reward_min": -460.0, "episode_reward_mean": 56.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -40.755, "predator_policy": 68.87}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.0, -453.0, -102.0, 48.0, 214.0, 157.0, -119.0, 208.0, 30.0, 143.0, 251.0, 166.0, -305.0, 84.0, 170.0, 80.0, -35.0, 107.0, -287.0, -1.0, 131.0, -72.0, 157.0, 141.0, 168.0, 157.0, 284.0, 52.0, 99.0, 221.0, 71.0, 328.0, 125.0, 89.0, -384.0, 39.0, 175.0, 60.0, -143.0, -23.0, 262.0, 191.0, -4.0, -159.0, 239.0, -108.0, -16.0, -103.0, 130.0, 214.0, 302.0, 204.0, 267.0, 114.0, -48.0, 106.0, -295.0, 140.0, -195.0, 194.0, 199.0, 77.0, 116.0, -69.0, 157.0, -126.0, 63.0, 37.0, -89.0, 224.0, 91.0, -37.0, 112.0, 135.0, -271.0, 286.0, 3.0, -80.0, 55.0, -223.0, 63.0, 331.0, 229.0, 142.0, -194.0, 344.0, 66.0, -89.0, -120.0, 93.0, 258.0, 37.0, 233.0, 337.0, 72.0, 86.0, -181.0, -460.0, 34.0, 150.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-258.0, 157.0, -370.0, -374.0, -40.0, -238.0, 137.0, -243.0, -84.0, 197.0, 156.0, 0.0, -150.0, -174.0, 76.0, 117.0, -337.0, 169.0, 127.0, -91.0, 172.0, -11.0, -5.0, 103.0, -337.0, -268.0, 47.0, -112.0, 35.0, 122.0, 58.0, -202.0, -265.0, 0.0, 26.0, -50.0, -289.0, -252.0, -242.0, 80.0, -93.0, 120.0, -109.0, -186.0, -70.0, 137.0, -145.0, 186.0, 157.0, -111.0, 67.0, 35.0, 66.0, 186.0, 165.0, -271.0, -372.0, 108.0, 94.0, 127.0, 5.0, -46.0, 156.0, 163.0, -106.0, 129.0, -109.0, 59.0, -394.0, -329.0, 83.0, -175.0, 159.0, 16.0, -201.0, 151.0, -145.0, -303.0, -127.0, 0.0, -19.0, 189.0, 123.0, 68.0, 68.0, -370.0, -299.0, -36.0, 170.0, 55.0, 0.0, -268.0, -189.0, 16.0, -193.0, -232.0, -12.0, 56.0, 118.0, 87.0, 62.0, 185.0, -84.0, 192.0, 109.0, 95.0, 100.0, 0.0, -59.0, -309.0, 0.0, 92.0, -226.0, -248.0, 111.0, 0.0, -247.0, -187.0, 78.0, 67.0, 165.0, -243.0, -148.0, 118.0, 178.0, -372.0, -302.0, 29.0, 112.0, -104.0, -10.0, -307.0, -46.0, -32.0, 6.0, -11.0, -203.0, -16.0, 70.0, 110.0, -4.0, 21.0, -17.0, -236.0, 106.0, -108.0, 14.0, 121.0, -253.0, -242.0, 127.0, 150.0, -296.0, 108.0, -310.0, -9.0, -4.0, -15.0, -375.0, -110.0, 61.0, -151.0, 144.0, 182.0, 80.0, 115.0, -112.0, 95.0, -368.0, -214.0, 163.0, 181.0, -91.0, -2.0, -400.0, 52.0, -27.0, -282.0, -44.0, 65.0, 96.0, 137.0, -318.0, 171.0, 87.0, 93.0, 168.0, 169.0, -174.0, 89.0, 50.0, -136.0, -329.0, -115.0, -365.0, -350.0, -170.0, -12.0, -8.0, 130.0], "policy_predator_policy_reward": [115.0, 52.0, 199.0, 92.0, 19.0, 157.0, 126.0, 28.0, 49.0, 52.0, 1.0, 0.0, 95.0, 110.0, 1.0, 14.0, 85.0, 113.0, 96.0, 11.0, 30.0, 60.0, 2.0, 66.0, 164.0, 136.0, 75.0, 74.0, 0.0, 13.0, 85.0, 139.0, 75.0, 155.0, 60.0, 71.0, 85.0, 169.0, 150.0, 11.0, 95.0, 9.0, 97.0, 126.0, 1.0, 89.0, 14.0, 86.0, 49.0, 73.0, 50.0, 5.0, 2.0, 30.0, 31.0, 127.0, 184.0, 179.0, 0.0, 0.0, 89.0, 23.0, 0.0, 9.0, 98.0, 4.0, 48.0, 91.0, 185.0, 154.0, 111.0, 20.0, 0.0, 0.0, 26.0, 84.0, 143.0, 162.0, 0.0, 104.0, 47.0, 45.0, 0.0, 0.0, 136.0, 162.0, 135.0, 41.0, 7.0, 7.0, 26.0, 134.0, 101.0, 56.0, 147.0, 175.0, 47.0, 39.0, 0.0, 9.0, 44.0, 11.0, 81.0, 15.0, 26.0, 37.0, 14.0, 0.0, 167.0, 153.0, 7.0, 7.0, 24.0, 155.0, 0.0, 29.0, 175.0, 64.0, 30.0, 19.0, 131.0, 146.0, 52.0, 55.0, 123.0, 187.0, 58.0, 146.0, 76.0, 73.0, 162.0, 29.0, 67.0, 74.0, 0.0, 42.0, 4.0, 126.0, 32.0, 12.0, 74.0, 0.0, 74.0, 142.0, 89.0, 25.0, 0.0, 0.0, 128.0, 96.0, 9.0, 0.0, 85.0, 106.0, 174.0, 65.0, 73.0, 1.0, 138.0, 124.0, 103.0, 50.0, 5.0, 0.0, 27.0, 7.0, 126.0, 33.0, 196.0, 192.0, 0.0, 0.0, 74.0, 85.0, 132.0, 127.0, 170.0, 19.0, 0.0, 72.0, 7.0, 18.0, 144.0, 40.0, 24.0, 29.0, 0.0, 0.0, 65.0, 92.0, 95.0, 77.0, 91.0, 172.0, 192.0, 63.0, 100.0, 116.0, 28.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.050234485739129, "mean_inference_ms": 3.2944419764429034, "mean_action_processing_ms": 0.4795110414592979, "mean_env_wait_ms": 0.37829451799171726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006722450256347656, "StateBufferConnector_ms": 0.004139900207519531, "ViewRequirementAgentConnector_ms": 0.16960477828979492}, "num_episodes": 18, "episode_return_max": 344.0, "episode_return_min": -460.0, "episode_return_mean": 56.23, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.6654280864536, "num_env_steps_trained_throughput_per_sec": 335.6654280864536, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 13441.35, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13441.278, "sample_time_ms": 2414.674, "learn_time_ms": 11005.246, "learn_throughput": 363.463, "synch_weights_time_ms": 18.537}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "e1352_00002", "date": "2024-08-13_19-37-06", "timestamp": 1723592226, "time_this_iter_s": 11.951304912567139, "time_total_s": 2116.8732216358185, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e22c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2116.8732216358185, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 57.576470588235296, "ram_util_percent": 83.31764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6456514432001366, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 5.863942258067863, "policy_loss": -0.0015263627915244017, "vf_loss": 5.865099256000821, "vf_explained_var": -0.0010775146030244374, "kl": 0.009223880828280927, "entropy": 0.9451966548722888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.38797569587117, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 0.00010000000000000003, "total_loss": 8.62517971008543, "policy_loss": 0.006443133124608606, "vf_loss": 8.618723137668832, "vf_explained_var": -0.10622125217523525, "kl": 0.01612441871115932, "entropy": 0.8112930303212826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": -460.0, "episode_reward_mean": 60.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": -36.36, "predator_policy": 66.64}, "custom_metrics": {}, "hist_stats": {"episode_reward": [141.0, 168.0, 157.0, 284.0, 52.0, 99.0, 221.0, 71.0, 328.0, 125.0, 89.0, -384.0, 39.0, 175.0, 60.0, -143.0, -23.0, 262.0, 191.0, -4.0, -159.0, 239.0, -108.0, -16.0, -103.0, 130.0, 214.0, 302.0, 204.0, 267.0, 114.0, -48.0, 106.0, -295.0, 140.0, -195.0, 194.0, 199.0, 77.0, 116.0, -69.0, 157.0, -126.0, 63.0, 37.0, -89.0, 224.0, 91.0, -37.0, 112.0, 135.0, -271.0, 286.0, 3.0, -80.0, 55.0, -223.0, 63.0, 331.0, 229.0, 142.0, -194.0, 344.0, 66.0, -89.0, -120.0, 93.0, 258.0, 37.0, 233.0, 337.0, 72.0, 86.0, -181.0, -460.0, 34.0, 150.0, -181.0, -145.0, 179.0, -201.0, -128.0, 113.0, -244.0, 338.0, 232.0, -123.0, -77.0, 9.0, -87.0, -97.0, 101.0, 359.0, 378.0, 166.0, 251.0, 42.0, 33.0, -74.0, 227.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-145.0, 186.0, 157.0, -111.0, 67.0, 35.0, 66.0, 186.0, 165.0, -271.0, -372.0, 108.0, 94.0, 127.0, 5.0, -46.0, 156.0, 163.0, -106.0, 129.0, -109.0, 59.0, -394.0, -329.0, 83.0, -175.0, 159.0, 16.0, -201.0, 151.0, -145.0, -303.0, -127.0, 0.0, -19.0, 189.0, 123.0, 68.0, 68.0, -370.0, -299.0, -36.0, 170.0, 55.0, 0.0, -268.0, -189.0, 16.0, -193.0, -232.0, -12.0, 56.0, 118.0, 87.0, 62.0, 185.0, -84.0, 192.0, 109.0, 95.0, 100.0, 0.0, -59.0, -309.0, 0.0, 92.0, -226.0, -248.0, 111.0, 0.0, -247.0, -187.0, 78.0, 67.0, 165.0, -243.0, -148.0, 118.0, 178.0, -372.0, -302.0, 29.0, 112.0, -104.0, -10.0, -307.0, -46.0, -32.0, 6.0, -11.0, -203.0, -16.0, 70.0, 110.0, -4.0, 21.0, -17.0, -236.0, 106.0, -108.0, 14.0, 121.0, -253.0, -242.0, 127.0, 150.0, -296.0, 108.0, -310.0, -9.0, -4.0, -15.0, -375.0, -110.0, 61.0, -151.0, 144.0, 182.0, 80.0, 115.0, -112.0, 95.0, -368.0, -214.0, 163.0, 181.0, -91.0, -2.0, -400.0, 52.0, -27.0, -282.0, -44.0, 65.0, 96.0, 137.0, -318.0, 171.0, 87.0, 93.0, 168.0, 169.0, -174.0, 89.0, 50.0, -136.0, -329.0, -115.0, -365.0, -350.0, -170.0, -12.0, -8.0, 130.0, -28.0, -344.0, -379.0, 28.0, 113.0, 66.0, -132.0, -247.0, -126.0, -228.0, 0.0, 99.0, -290.0, -231.0, 126.0, 197.0, 188.0, -34.0, -130.0, -170.0, 0.0, -373.0, 177.0, -350.0, -17.0, -253.0, 0.0, -249.0, -154.0, 137.0, 182.0, 177.0, 200.0, 152.0, 180.0, -243.0, 88.0, 163.0, -65.0, 0.0, 62.0, -145.0, -143.0, -136.0, 43.0, 154.0], "policy_predator_policy_reward": [14.0, 86.0, 49.0, 73.0, 50.0, 5.0, 2.0, 30.0, 31.0, 127.0, 184.0, 179.0, 0.0, 0.0, 89.0, 23.0, 0.0, 9.0, 98.0, 4.0, 48.0, 91.0, 185.0, 154.0, 111.0, 20.0, 0.0, 0.0, 26.0, 84.0, 143.0, 162.0, 0.0, 104.0, 47.0, 45.0, 0.0, 0.0, 136.0, 162.0, 135.0, 41.0, 7.0, 7.0, 26.0, 134.0, 101.0, 56.0, 147.0, 175.0, 47.0, 39.0, 0.0, 9.0, 44.0, 11.0, 81.0, 15.0, 26.0, 37.0, 14.0, 0.0, 167.0, 153.0, 7.0, 7.0, 24.0, 155.0, 0.0, 29.0, 175.0, 64.0, 30.0, 19.0, 131.0, 146.0, 52.0, 55.0, 123.0, 187.0, 58.0, 146.0, 76.0, 73.0, 162.0, 29.0, 67.0, 74.0, 0.0, 42.0, 4.0, 126.0, 32.0, 12.0, 74.0, 0.0, 74.0, 142.0, 89.0, 25.0, 0.0, 0.0, 128.0, 96.0, 9.0, 0.0, 85.0, 106.0, 174.0, 65.0, 73.0, 1.0, 138.0, 124.0, 103.0, 50.0, 5.0, 0.0, 27.0, 7.0, 126.0, 33.0, 196.0, 192.0, 0.0, 0.0, 74.0, 85.0, 132.0, 127.0, 170.0, 19.0, 0.0, 72.0, 7.0, 18.0, 144.0, 40.0, 24.0, 29.0, 0.0, 0.0, 65.0, 92.0, 95.0, 77.0, 91.0, 172.0, 192.0, 63.0, 100.0, 116.0, 28.0, 0.0, 14.0, 177.0, 187.0, 19.0, 0.0, 0.0, 169.0, 9.0, 106.0, 120.0, 1.0, 13.0, 126.0, 151.0, 12.0, 3.0, 78.0, 0.0, 158.0, 19.0, 122.0, 174.0, 164.0, 18.0, 183.0, 0.0, 141.0, 11.0, 0.0, 118.0, 0.0, 0.0, 16.0, 10.0, 118.0, 111.0, 0.0, 0.0, 52.0, 55.0, 0.0, 116.0, 111.0, 94.0, 30.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0496040727434037, "mean_inference_ms": 3.2986804415314634, "mean_action_processing_ms": 0.4789084862321767, "mean_env_wait_ms": 0.3780528908015425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005490899085998535, "StateBufferConnector_ms": 0.004099488258361816, "ViewRequirementAgentConnector_ms": 0.16987431049346924}, "num_episodes": 23, "episode_return_max": 378.0, "episode_return_min": -460.0, "episode_return_mean": 60.56, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.8567258686075, "num_env_steps_trained_throughput_per_sec": 323.8567258686075, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 13160.681, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13160.609, "sample_time_ms": 2305.657, "learn_time_ms": 10835.401, "learn_throughput": 369.16, "synch_weights_time_ms": 17.023}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "e1352_00002", "date": "2024-08-13_19-37-19", "timestamp": 1723592239, "time_this_iter_s": 12.411672830581665, "time_total_s": 2129.2848944664, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d41ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2129.2848944664, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 60.98888888888889, "ram_util_percent": 83.60555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1386096626835527, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 5.990587585439127, "policy_loss": -0.0020081633625542205, "vf_loss": 5.99216550166014, "vf_explained_var": 0.0017871911878939027, "kl": 0.010744247452927666, "entropy": 0.9255322374679424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.108276749382576, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 0.00010000000000000003, "total_loss": 8.653789763728147, "policy_loss": 9.861901037828632e-05, "vf_loss": 8.653681577198089, "vf_explained_var": -0.08384728712379617, "kl": 0.011443986904658799, "entropy": 0.7361049157286447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": -460.0, "episode_reward_mean": 54.53, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -41.735, "predator_policy": 69.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [191.0, -4.0, -159.0, 239.0, -108.0, -16.0, -103.0, 130.0, 214.0, 302.0, 204.0, 267.0, 114.0, -48.0, 106.0, -295.0, 140.0, -195.0, 194.0, 199.0, 77.0, 116.0, -69.0, 157.0, -126.0, 63.0, 37.0, -89.0, 224.0, 91.0, -37.0, 112.0, 135.0, -271.0, 286.0, 3.0, -80.0, 55.0, -223.0, 63.0, 331.0, 229.0, 142.0, -194.0, 344.0, 66.0, -89.0, -120.0, 93.0, 258.0, 37.0, 233.0, 337.0, 72.0, 86.0, -181.0, -460.0, 34.0, 150.0, -181.0, -145.0, 179.0, -201.0, -128.0, 113.0, -244.0, 338.0, 232.0, -123.0, -77.0, 9.0, -87.0, -97.0, 101.0, 359.0, 378.0, 166.0, 251.0, 42.0, 33.0, -74.0, 227.0, 145.0, 86.0, -80.0, 185.0, -222.0, 167.0, 54.0, 58.0, 120.0, -27.0, -210.0, 11.0, 271.0, 165.0, -107.0, 204.0, 287.0, 11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [123.0, 68.0, 68.0, -370.0, -299.0, -36.0, 170.0, 55.0, 0.0, -268.0, -189.0, 16.0, -193.0, -232.0, -12.0, 56.0, 118.0, 87.0, 62.0, 185.0, -84.0, 192.0, 109.0, 95.0, 100.0, 0.0, -59.0, -309.0, 0.0, 92.0, -226.0, -248.0, 111.0, 0.0, -247.0, -187.0, 78.0, 67.0, 165.0, -243.0, -148.0, 118.0, 178.0, -372.0, -302.0, 29.0, 112.0, -104.0, -10.0, -307.0, -46.0, -32.0, 6.0, -11.0, -203.0, -16.0, 70.0, 110.0, -4.0, 21.0, -17.0, -236.0, 106.0, -108.0, 14.0, 121.0, -253.0, -242.0, 127.0, 150.0, -296.0, 108.0, -310.0, -9.0, -4.0, -15.0, -375.0, -110.0, 61.0, -151.0, 144.0, 182.0, 80.0, 115.0, -112.0, 95.0, -368.0, -214.0, 163.0, 181.0, -91.0, -2.0, -400.0, 52.0, -27.0, -282.0, -44.0, 65.0, 96.0, 137.0, -318.0, 171.0, 87.0, 93.0, 168.0, 169.0, -174.0, 89.0, 50.0, -136.0, -329.0, -115.0, -365.0, -350.0, -170.0, -12.0, -8.0, 130.0, -28.0, -344.0, -379.0, 28.0, 113.0, 66.0, -132.0, -247.0, -126.0, -228.0, 0.0, 99.0, -290.0, -231.0, 126.0, 197.0, 188.0, -34.0, -130.0, -170.0, 0.0, -373.0, 177.0, -350.0, -17.0, -253.0, 0.0, -249.0, -154.0, 137.0, 182.0, 177.0, 200.0, 152.0, 180.0, -243.0, 88.0, 163.0, -65.0, 0.0, 62.0, -145.0, -143.0, -136.0, 43.0, 154.0, 86.0, -22.0, 85.0, 0.0, -261.0, -1.0, 179.0, -345.0, -151.0, -379.0, 159.0, -2.0, -24.0, 13.0, 98.0, -238.0, -6.0, -25.0, -63.0, -103.0, -397.0, -190.0, 38.0, -334.0, 81.0, 178.0, 1.0, 147.0, -397.0, -52.0, 20.0, 123.0, 198.0, 89.0, 50.0, -182.0], "policy_predator_policy_reward": [0.0, 0.0, 136.0, 162.0, 135.0, 41.0, 7.0, 7.0, 26.0, 134.0, 101.0, 56.0, 147.0, 175.0, 47.0, 39.0, 0.0, 9.0, 44.0, 11.0, 81.0, 15.0, 26.0, 37.0, 14.0, 0.0, 167.0, 153.0, 7.0, 7.0, 24.0, 155.0, 0.0, 29.0, 175.0, 64.0, 30.0, 19.0, 131.0, 146.0, 52.0, 55.0, 123.0, 187.0, 58.0, 146.0, 76.0, 73.0, 162.0, 29.0, 67.0, 74.0, 0.0, 42.0, 4.0, 126.0, 32.0, 12.0, 74.0, 0.0, 74.0, 142.0, 89.0, 25.0, 0.0, 0.0, 128.0, 96.0, 9.0, 0.0, 85.0, 106.0, 174.0, 65.0, 73.0, 1.0, 138.0, 124.0, 103.0, 50.0, 5.0, 0.0, 27.0, 7.0, 126.0, 33.0, 196.0, 192.0, 0.0, 0.0, 74.0, 85.0, 132.0, 127.0, 170.0, 19.0, 0.0, 72.0, 7.0, 18.0, 144.0, 40.0, 24.0, 29.0, 0.0, 0.0, 65.0, 92.0, 95.0, 77.0, 91.0, 172.0, 192.0, 63.0, 100.0, 116.0, 28.0, 0.0, 14.0, 177.0, 187.0, 19.0, 0.0, 0.0, 169.0, 9.0, 106.0, 120.0, 1.0, 13.0, 126.0, 151.0, 12.0, 3.0, 78.0, 0.0, 158.0, 19.0, 122.0, 174.0, 164.0, 18.0, 183.0, 0.0, 141.0, 11.0, 0.0, 118.0, 0.0, 0.0, 16.0, 10.0, 118.0, 111.0, 0.0, 0.0, 52.0, 55.0, 0.0, 116.0, 111.0, 94.0, 30.0, 0.0, 8.0, 73.0, 1.0, 0.0, 124.0, 58.0, 182.0, 169.0, 184.0, 124.0, 2.0, 8.0, 57.0, 8.0, 116.0, 82.0, 60.0, 91.0, 138.0, 1.0, 178.0, 199.0, 153.0, 154.0, 5.0, 7.0, 3.0, 14.0, 142.0, 200.0, 10.0, 51.0, 0.0, 0.0, 5.0, 138.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0499736813126226, "mean_inference_ms": 3.2920353254192194, "mean_action_processing_ms": 0.47801568472836337, "mean_env_wait_ms": 0.3774499701227178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005399465560913086, "StateBufferConnector_ms": 0.004082679748535156, "ViewRequirementAgentConnector_ms": 0.14263010025024414}, "num_episodes": 18, "episode_return_max": 378.0, "episode_return_min": -460.0, "episode_return_mean": 54.53, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.53894755823563, "num_env_steps_trained_throughput_per_sec": 280.53894755823563, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 12779.193, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12779.121, "sample_time_ms": 2198.323, "learn_time_ms": 10560.185, "learn_throughput": 378.781, "synch_weights_time_ms": 18.043}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "e1352_00002", "date": "2024-08-13_19-37-33", "timestamp": 1723592253, "time_this_iter_s": 14.310841083526611, "time_total_s": 2143.5957355499268, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2143.5957355499268, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 74.60999999999999, "ram_util_percent": 83.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7708433033770354, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 5.108422762628585, "policy_loss": -0.004045742522757599, "vf_loss": 5.1119983959450295, "vf_explained_var": 0.0052898013087176775, "kl": 0.011739538644178454, "entropy": 0.9402179195451988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.181586257143625, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 0.00010000000000000003, "total_loss": 8.799516493428952, "policy_loss": 0.0001519235857471666, "vf_loss": 8.799356602613257, "vf_explained_var": 0.018736291751659737, "kl": 0.009548473421934899, "entropy": 0.7617455566686298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": -460.0, "episode_reward_mean": 57.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -38.765, "predator_policy": 67.76}, "custom_metrics": {}, "hist_stats": {"episode_reward": [194.0, 199.0, 77.0, 116.0, -69.0, 157.0, -126.0, 63.0, 37.0, -89.0, 224.0, 91.0, -37.0, 112.0, 135.0, -271.0, 286.0, 3.0, -80.0, 55.0, -223.0, 63.0, 331.0, 229.0, 142.0, -194.0, 344.0, 66.0, -89.0, -120.0, 93.0, 258.0, 37.0, 233.0, 337.0, 72.0, 86.0, -181.0, -460.0, 34.0, 150.0, -181.0, -145.0, 179.0, -201.0, -128.0, 113.0, -244.0, 338.0, 232.0, -123.0, -77.0, 9.0, -87.0, -97.0, 101.0, 359.0, 378.0, 166.0, 251.0, 42.0, 33.0, -74.0, 227.0, 145.0, 86.0, -80.0, 185.0, -222.0, 167.0, 54.0, 58.0, 120.0, -27.0, -210.0, 11.0, 271.0, 165.0, -107.0, 204.0, 287.0, 11.0, 139.0, 299.0, 86.0, 322.0, 263.0, -119.0, 157.0, -76.0, -449.0, 241.0, 176.0, -115.0, -63.0, 107.0, 43.0, 328.0, -261.0, 247.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [78.0, 67.0, 165.0, -243.0, -148.0, 118.0, 178.0, -372.0, -302.0, 29.0, 112.0, -104.0, -10.0, -307.0, -46.0, -32.0, 6.0, -11.0, -203.0, -16.0, 70.0, 110.0, -4.0, 21.0, -17.0, -236.0, 106.0, -108.0, 14.0, 121.0, -253.0, -242.0, 127.0, 150.0, -296.0, 108.0, -310.0, -9.0, -4.0, -15.0, -375.0, -110.0, 61.0, -151.0, 144.0, 182.0, 80.0, 115.0, -112.0, 95.0, -368.0, -214.0, 163.0, 181.0, -91.0, -2.0, -400.0, 52.0, -27.0, -282.0, -44.0, 65.0, 96.0, 137.0, -318.0, 171.0, 87.0, 93.0, 168.0, 169.0, -174.0, 89.0, 50.0, -136.0, -329.0, -115.0, -365.0, -350.0, -170.0, -12.0, -8.0, 130.0, -28.0, -344.0, -379.0, 28.0, 113.0, 66.0, -132.0, -247.0, -126.0, -228.0, 0.0, 99.0, -290.0, -231.0, 126.0, 197.0, 188.0, -34.0, -130.0, -170.0, 0.0, -373.0, 177.0, -350.0, -17.0, -253.0, 0.0, -249.0, -154.0, 137.0, 182.0, 177.0, 200.0, 152.0, 180.0, -243.0, 88.0, 163.0, -65.0, 0.0, 62.0, -145.0, -143.0, -136.0, 43.0, 154.0, 86.0, -22.0, 85.0, 0.0, -261.0, -1.0, 179.0, -345.0, -151.0, -379.0, 159.0, -2.0, -24.0, 13.0, 98.0, -238.0, -6.0, -25.0, -63.0, -103.0, -397.0, -190.0, 38.0, -334.0, 81.0, 178.0, 1.0, 147.0, -397.0, -52.0, 20.0, 123.0, 198.0, 89.0, 50.0, -182.0, -1.0, 35.0, 193.0, 56.0, 0.0, 29.0, 129.0, 192.0, 176.0, 80.0, -76.0, -128.0, 64.0, -37.0, -161.0, -225.0, -299.0, -384.0, 121.0, 80.0, 41.0, 58.0, -93.0, -301.0, -78.0, -136.0, 89.0, -90.0, 200.0, -330.0, 170.0, 140.0, -188.0, -231.0, 62.0, 185.0], "policy_predator_policy_reward": [30.0, 19.0, 131.0, 146.0, 52.0, 55.0, 123.0, 187.0, 58.0, 146.0, 76.0, 73.0, 162.0, 29.0, 67.0, 74.0, 0.0, 42.0, 4.0, 126.0, 32.0, 12.0, 74.0, 0.0, 74.0, 142.0, 89.0, 25.0, 0.0, 0.0, 128.0, 96.0, 9.0, 0.0, 85.0, 106.0, 174.0, 65.0, 73.0, 1.0, 138.0, 124.0, 103.0, 50.0, 5.0, 0.0, 27.0, 7.0, 126.0, 33.0, 196.0, 192.0, 0.0, 0.0, 74.0, 85.0, 132.0, 127.0, 170.0, 19.0, 0.0, 72.0, 7.0, 18.0, 144.0, 40.0, 24.0, 29.0, 0.0, 0.0, 65.0, 92.0, 95.0, 77.0, 91.0, 172.0, 192.0, 63.0, 100.0, 116.0, 28.0, 0.0, 14.0, 177.0, 187.0, 19.0, 0.0, 0.0, 169.0, 9.0, 106.0, 120.0, 1.0, 13.0, 126.0, 151.0, 12.0, 3.0, 78.0, 0.0, 158.0, 19.0, 122.0, 174.0, 164.0, 18.0, 183.0, 0.0, 141.0, 11.0, 0.0, 118.0, 0.0, 0.0, 16.0, 10.0, 118.0, 111.0, 0.0, 0.0, 52.0, 55.0, 0.0, 116.0, 111.0, 94.0, 30.0, 0.0, 8.0, 73.0, 1.0, 0.0, 124.0, 58.0, 182.0, 169.0, 184.0, 124.0, 2.0, 8.0, 57.0, 8.0, 116.0, 82.0, 60.0, 91.0, 138.0, 1.0, 178.0, 199.0, 153.0, 154.0, 5.0, 7.0, 3.0, 14.0, 142.0, 200.0, 10.0, 51.0, 0.0, 0.0, 5.0, 138.0, 0.0, 105.0, 21.0, 29.0, 56.0, 1.0, 1.0, 0.0, 0.0, 7.0, 82.0, 3.0, 39.0, 91.0, 131.0, 179.0, 169.0, 65.0, 40.0, 0.0, 74.0, 3.0, 181.0, 98.0, 120.0, 31.0, 102.0, 6.0, 172.0, 1.0, 18.0, 0.0, 0.0, 158.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0480982802976175, "mean_inference_ms": 3.2868835492937922, "mean_action_processing_ms": 0.47676478191962623, "mean_env_wait_ms": 0.37658011889493326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006853222846984863, "StateBufferConnector_ms": 0.004132866859436035, "ViewRequirementAgentConnector_ms": 0.15053391456604004}, "num_episodes": 18, "episode_return_max": 378.0, "episode_return_min": -460.0, "episode_return_mean": 57.99, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.01687970528474, "num_env_steps_trained_throughput_per_sec": 332.01687970528474, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 12650.478, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12650.394, "sample_time_ms": 2215.631, "learn_time_ms": 10412.768, "learn_throughput": 384.144, "synch_weights_time_ms": 19.133}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "e1352_00002", "date": "2024-08-13_19-37-45", "timestamp": 1723592265, "time_this_iter_s": 12.080504655838013, "time_total_s": 2155.6762402057648, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2cf5c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2155.6762402057648, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 60.15882352941178, "ram_util_percent": 83.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6422323521482882, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 5.361097407719446, "policy_loss": -0.005106195282417709, "vf_loss": 5.36579839994037, "vf_explained_var": 0.0015052351371321099, "kl": 0.010118425232822944, "entropy": 0.9354485822417749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.443231086787726, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 0.00010000000000000003, "total_loss": 8.645325679627677, "policy_loss": 0.002663755579112423, "vf_loss": 8.642643096459606, "vf_explained_var": -0.010756956774090963, "kl": 0.022576459789761597, "entropy": 0.8215225127954332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": -460.0, "episode_reward_mean": 69.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -28.675, "predator_policy": 63.435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [331.0, 229.0, 142.0, -194.0, 344.0, 66.0, -89.0, -120.0, 93.0, 258.0, 37.0, 233.0, 337.0, 72.0, 86.0, -181.0, -460.0, 34.0, 150.0, -181.0, -145.0, 179.0, -201.0, -128.0, 113.0, -244.0, 338.0, 232.0, -123.0, -77.0, 9.0, -87.0, -97.0, 101.0, 359.0, 378.0, 166.0, 251.0, 42.0, 33.0, -74.0, 227.0, 145.0, 86.0, -80.0, 185.0, -222.0, 167.0, 54.0, 58.0, 120.0, -27.0, -210.0, 11.0, 271.0, 165.0, -107.0, 204.0, 287.0, 11.0, 139.0, 299.0, 86.0, 322.0, 263.0, -119.0, 157.0, -76.0, -449.0, 241.0, 176.0, -115.0, -63.0, 107.0, 43.0, 328.0, -261.0, 247.0, -140.0, 121.0, 131.0, -94.0, 287.0, 364.0, 357.0, 32.0, 195.0, 0.0, 12.0, 147.0, 111.0, -12.0, 331.0, 0.0, -167.0, 239.0, -61.0, 125.0, -37.0, 129.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [144.0, 182.0, 80.0, 115.0, -112.0, 95.0, -368.0, -214.0, 163.0, 181.0, -91.0, -2.0, -400.0, 52.0, -27.0, -282.0, -44.0, 65.0, 96.0, 137.0, -318.0, 171.0, 87.0, 93.0, 168.0, 169.0, -174.0, 89.0, 50.0, -136.0, -329.0, -115.0, -365.0, -350.0, -170.0, -12.0, -8.0, 130.0, -28.0, -344.0, -379.0, 28.0, 113.0, 66.0, -132.0, -247.0, -126.0, -228.0, 0.0, 99.0, -290.0, -231.0, 126.0, 197.0, 188.0, -34.0, -130.0, -170.0, 0.0, -373.0, 177.0, -350.0, -17.0, -253.0, 0.0, -249.0, -154.0, 137.0, 182.0, 177.0, 200.0, 152.0, 180.0, -243.0, 88.0, 163.0, -65.0, 0.0, 62.0, -145.0, -143.0, -136.0, 43.0, 154.0, 86.0, -22.0, 85.0, 0.0, -261.0, -1.0, 179.0, -345.0, -151.0, -379.0, 159.0, -2.0, -24.0, 13.0, 98.0, -238.0, -6.0, -25.0, -63.0, -103.0, -397.0, -190.0, 38.0, -334.0, 81.0, 178.0, 1.0, 147.0, -397.0, -52.0, 20.0, 123.0, 198.0, 89.0, 50.0, -182.0, -1.0, 35.0, 193.0, 56.0, 0.0, 29.0, 129.0, 192.0, 176.0, 80.0, -76.0, -128.0, 64.0, -37.0, -161.0, -225.0, -299.0, -384.0, 121.0, 80.0, 41.0, 58.0, -93.0, -301.0, -78.0, -136.0, 89.0, -90.0, 200.0, -330.0, 170.0, 140.0, -188.0, -231.0, 62.0, 185.0, -154.0, -302.0, 133.0, -30.0, 74.0, -4.0, -8.0, -224.0, 161.0, 113.0, 163.0, 189.0, 157.0, 177.0, -50.0, 0.0, 154.0, 21.0, 0.0, 0.0, -380.0, 70.0, 161.0, -58.0, 111.0, 0.0, -50.0, -106.0, 141.0, 184.0, 0.0, 0.0, -2.0, -382.0, 62.0, 166.0, -284.0, -49.0, -176.0, 148.0, -40.0, -182.0, -49.0, -120.0], "policy_predator_policy_reward": [5.0, 0.0, 27.0, 7.0, 126.0, 33.0, 196.0, 192.0, 0.0, 0.0, 74.0, 85.0, 132.0, 127.0, 170.0, 19.0, 0.0, 72.0, 7.0, 18.0, 144.0, 40.0, 24.0, 29.0, 0.0, 0.0, 65.0, 92.0, 95.0, 77.0, 91.0, 172.0, 192.0, 63.0, 100.0, 116.0, 28.0, 0.0, 14.0, 177.0, 187.0, 19.0, 0.0, 0.0, 169.0, 9.0, 106.0, 120.0, 1.0, 13.0, 126.0, 151.0, 12.0, 3.0, 78.0, 0.0, 158.0, 19.0, 122.0, 174.0, 164.0, 18.0, 183.0, 0.0, 141.0, 11.0, 0.0, 118.0, 0.0, 0.0, 16.0, 10.0, 118.0, 111.0, 0.0, 0.0, 52.0, 55.0, 0.0, 116.0, 111.0, 94.0, 30.0, 0.0, 8.0, 73.0, 1.0, 0.0, 124.0, 58.0, 182.0, 169.0, 184.0, 124.0, 2.0, 8.0, 57.0, 8.0, 116.0, 82.0, 60.0, 91.0, 138.0, 1.0, 178.0, 199.0, 153.0, 154.0, 5.0, 7.0, 3.0, 14.0, 142.0, 200.0, 10.0, 51.0, 0.0, 0.0, 5.0, 138.0, 0.0, 105.0, 21.0, 29.0, 56.0, 1.0, 1.0, 0.0, 0.0, 7.0, 82.0, 3.0, 39.0, 91.0, 131.0, 179.0, 169.0, 65.0, 40.0, 0.0, 74.0, 3.0, 181.0, 98.0, 120.0, 31.0, 102.0, 6.0, 172.0, 1.0, 18.0, 0.0, 0.0, 158.0, 0.0, 0.0, 191.0, 125.0, 9.0, 9.0, 12.0, 49.0, 0.0, 138.0, 3.0, 10.0, 0.0, 12.0, 21.0, 2.0, 48.0, 34.0, 10.0, 10.0, 0.0, 0.0, 177.0, 145.0, 2.0, 42.0, 0.0, 0.0, 46.0, 98.0, 2.0, 4.0, 0.0, 0.0, 163.0, 54.0, 0.0, 11.0, 134.0, 138.0, 124.0, 29.0, 80.0, 105.0, 167.0, 131.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0457629322925959, "mean_inference_ms": 3.280397733671387, "mean_action_processing_ms": 0.475197637634799, "mean_env_wait_ms": 0.3754658060334666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069724321365356445, "StateBufferConnector_ms": 0.004856705665588379, "ViewRequirementAgentConnector_ms": 0.15310704708099365}, "num_episodes": 22, "episode_return_max": 378.0, "episode_return_min": -460.0, "episode_return_mean": 69.52, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.36714338378886, "num_env_steps_trained_throughput_per_sec": 286.36714338378886, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 12823.394, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12823.309, "sample_time_ms": 2223.544, "learn_time_ms": 10576.405, "learn_throughput": 378.2, "synch_weights_time_ms": 19.617}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "e1352_00002", "date": "2024-08-13_19-38-00", "timestamp": 1723592280, "time_this_iter_s": 14.187634229660034, "time_total_s": 2169.863874435425, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e68430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2169.863874435425, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 69.75000000000001, "ram_util_percent": 83.31}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.626665529332779, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 5.554525975827818, "policy_loss": -0.0014381515416538432, "vf_loss": 5.555667377527429, "vf_explained_var": -0.0010381148921118843, "kl": 0.00741016226153026, "entropy": 0.9458568293581564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.986730096043736, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 8.691181935456695, "policy_loss": -0.001806244980691681, "vf_loss": 8.692969690302693, "vf_explained_var": -0.12023784584469266, "kl": 0.01475884801310836, "entropy": 0.7808627765960794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": -449.0, "episode_reward_mean": 69.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -398.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -27.5, "predator_policy": 62.48}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, -181.0, -145.0, 179.0, -201.0, -128.0, 113.0, -244.0, 338.0, 232.0, -123.0, -77.0, 9.0, -87.0, -97.0, 101.0, 359.0, 378.0, 166.0, 251.0, 42.0, 33.0, -74.0, 227.0, 145.0, 86.0, -80.0, 185.0, -222.0, 167.0, 54.0, 58.0, 120.0, -27.0, -210.0, 11.0, 271.0, 165.0, -107.0, 204.0, 287.0, 11.0, 139.0, 299.0, 86.0, 322.0, 263.0, -119.0, 157.0, -76.0, -449.0, 241.0, 176.0, -115.0, -63.0, 107.0, 43.0, 328.0, -261.0, 247.0, -140.0, 121.0, 131.0, -94.0, 287.0, 364.0, 357.0, 32.0, 195.0, 0.0, 12.0, 147.0, 111.0, -12.0, 331.0, 0.0, -167.0, 239.0, -61.0, 125.0, -37.0, 129.0, 46.0, -80.0, -50.0, 254.0, 31.0, -32.0, 51.0, 19.0, 196.0, 118.0, 173.0, 87.0, 0.0, 345.0, -23.0, -49.0, 14.0, 162.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.0, 130.0, -28.0, -344.0, -379.0, 28.0, 113.0, 66.0, -132.0, -247.0, -126.0, -228.0, 0.0, 99.0, -290.0, -231.0, 126.0, 197.0, 188.0, -34.0, -130.0, -170.0, 0.0, -373.0, 177.0, -350.0, -17.0, -253.0, 0.0, -249.0, -154.0, 137.0, 182.0, 177.0, 200.0, 152.0, 180.0, -243.0, 88.0, 163.0, -65.0, 0.0, 62.0, -145.0, -143.0, -136.0, 43.0, 154.0, 86.0, -22.0, 85.0, 0.0, -261.0, -1.0, 179.0, -345.0, -151.0, -379.0, 159.0, -2.0, -24.0, 13.0, 98.0, -238.0, -6.0, -25.0, -63.0, -103.0, -397.0, -190.0, 38.0, -334.0, 81.0, 178.0, 1.0, 147.0, -397.0, -52.0, 20.0, 123.0, 198.0, 89.0, 50.0, -182.0, -1.0, 35.0, 193.0, 56.0, 0.0, 29.0, 129.0, 192.0, 176.0, 80.0, -76.0, -128.0, 64.0, -37.0, -161.0, -225.0, -299.0, -384.0, 121.0, 80.0, 41.0, 58.0, -93.0, -301.0, -78.0, -136.0, 89.0, -90.0, 200.0, -330.0, 170.0, 140.0, -188.0, -231.0, 62.0, 185.0, -154.0, -302.0, 133.0, -30.0, 74.0, -4.0, -8.0, -224.0, 161.0, 113.0, 163.0, 189.0, 157.0, 177.0, -50.0, 0.0, 154.0, 21.0, 0.0, 0.0, -380.0, 70.0, 161.0, -58.0, 111.0, 0.0, -50.0, -106.0, 141.0, 184.0, 0.0, 0.0, -2.0, -382.0, 62.0, 166.0, -284.0, -49.0, -176.0, 148.0, -40.0, -182.0, -49.0, -120.0, -155.0, 0.0, -268.0, 6.0, -179.0, -25.0, 117.0, 109.0, -305.0, -20.0, -60.0, -36.0, -220.0, 128.0, -189.0, 34.0, 146.0, -51.0, -26.0, -12.0, 151.0, -103.0, 130.0, -106.0, 0.0, 0.0, 140.0, 169.0, -119.0, 0.0, -264.0, 61.0, 0.0, 14.0, 194.0, -398.0], "policy_predator_policy_reward": [28.0, 0.0, 14.0, 177.0, 187.0, 19.0, 0.0, 0.0, 169.0, 9.0, 106.0, 120.0, 1.0, 13.0, 126.0, 151.0, 12.0, 3.0, 78.0, 0.0, 158.0, 19.0, 122.0, 174.0, 164.0, 18.0, 183.0, 0.0, 141.0, 11.0, 0.0, 118.0, 0.0, 0.0, 16.0, 10.0, 118.0, 111.0, 0.0, 0.0, 52.0, 55.0, 0.0, 116.0, 111.0, 94.0, 30.0, 0.0, 8.0, 73.0, 1.0, 0.0, 124.0, 58.0, 182.0, 169.0, 184.0, 124.0, 2.0, 8.0, 57.0, 8.0, 116.0, 82.0, 60.0, 91.0, 138.0, 1.0, 178.0, 199.0, 153.0, 154.0, 5.0, 7.0, 3.0, 14.0, 142.0, 200.0, 10.0, 51.0, 0.0, 0.0, 5.0, 138.0, 0.0, 105.0, 21.0, 29.0, 56.0, 1.0, 1.0, 0.0, 0.0, 7.0, 82.0, 3.0, 39.0, 91.0, 131.0, 179.0, 169.0, 65.0, 40.0, 0.0, 74.0, 3.0, 181.0, 98.0, 120.0, 31.0, 102.0, 6.0, 172.0, 1.0, 18.0, 0.0, 0.0, 158.0, 0.0, 0.0, 191.0, 125.0, 9.0, 9.0, 12.0, 49.0, 0.0, 138.0, 3.0, 10.0, 0.0, 12.0, 21.0, 2.0, 48.0, 34.0, 10.0, 10.0, 0.0, 0.0, 177.0, 145.0, 2.0, 42.0, 0.0, 0.0, 46.0, 98.0, 2.0, 4.0, 0.0, 0.0, 163.0, 54.0, 0.0, 11.0, 134.0, 138.0, 124.0, 29.0, 80.0, 105.0, 167.0, 131.0, 91.0, 110.0, 151.0, 31.0, 127.0, 27.0, 23.0, 5.0, 163.0, 193.0, 0.0, 64.0, 133.0, 10.0, 2.0, 172.0, 35.0, 66.0, 86.0, 70.0, 18.0, 107.0, 2.0, 61.0, 0.0, 0.0, 17.0, 19.0, 3.0, 93.0, 154.0, 0.0, 0.0, 0.0, 170.0, 196.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0455210438867644, "mean_inference_ms": 3.2793508895057357, "mean_action_processing_ms": 0.47446678779191237, "mean_env_wait_ms": 0.37524100749267225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006852626800537109, "StateBufferConnector_ms": 0.0045174360275268555, "ViewRequirementAgentConnector_ms": 0.16161584854125977}, "num_episodes": 18, "episode_return_max": 378.0, "episode_return_min": -449.0, "episode_return_mean": 69.96, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 250.17510689975762, "num_env_steps_trained_throughput_per_sec": 250.17510689975762, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 13267.645, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13267.559, "sample_time_ms": 2402.765, "learn_time_ms": 10841.487, "learn_throughput": 368.953, "synch_weights_time_ms": 19.459}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "e1352_00002", "date": "2024-08-13_19-38-16", "timestamp": 1723592296, "time_this_iter_s": 16.007541179656982, "time_total_s": 2185.871415615082, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2185.871415615082, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 81.63333333333333, "ram_util_percent": 81.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7661471693840607, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 3.6610026288915565, "policy_loss": -0.0025418222775909476, "vf_loss": 3.6631590107761363, "vf_explained_var": 0.0018805471362260283, "kl": 0.009625312922974581, "entropy": 0.9221271581119961, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 85.67906148774283, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 8.387972569591785, "policy_loss": 7.492424230332728e-05, "vf_loss": 8.387889783849161, "vf_explained_var": -0.26080322003869155, "kl": 0.0062845736071544785, "entropy": 0.9289703425276217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 370.0, "episode_reward_min": -449.0, "episode_reward_mean": 72.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -398.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -21.74, "predator_policy": 57.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [227.0, 145.0, 86.0, -80.0, 185.0, -222.0, 167.0, 54.0, 58.0, 120.0, -27.0, -210.0, 11.0, 271.0, 165.0, -107.0, 204.0, 287.0, 11.0, 139.0, 299.0, 86.0, 322.0, 263.0, -119.0, 157.0, -76.0, -449.0, 241.0, 176.0, -115.0, -63.0, 107.0, 43.0, 328.0, -261.0, 247.0, -140.0, 121.0, 131.0, -94.0, 287.0, 364.0, 357.0, 32.0, 195.0, 0.0, 12.0, 147.0, 111.0, -12.0, 331.0, 0.0, -167.0, 239.0, -61.0, 125.0, -37.0, 129.0, 46.0, -80.0, -50.0, 254.0, 31.0, -32.0, 51.0, 19.0, 196.0, 118.0, 173.0, 87.0, 0.0, 345.0, -23.0, -49.0, 14.0, 162.0, -115.0, -121.0, -25.0, -155.0, 168.0, 337.0, -51.0, 83.0, 15.0, 72.0, -14.0, 292.0, 70.0, -89.0, 370.0, 64.0, 132.0, -24.0, 7.0, 0.0, -9.0, 27.0, 186.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [43.0, 154.0, 86.0, -22.0, 85.0, 0.0, -261.0, -1.0, 179.0, -345.0, -151.0, -379.0, 159.0, -2.0, -24.0, 13.0, 98.0, -238.0, -6.0, -25.0, -63.0, -103.0, -397.0, -190.0, 38.0, -334.0, 81.0, 178.0, 1.0, 147.0, -397.0, -52.0, 20.0, 123.0, 198.0, 89.0, 50.0, -182.0, -1.0, 35.0, 193.0, 56.0, 0.0, 29.0, 129.0, 192.0, 176.0, 80.0, -76.0, -128.0, 64.0, -37.0, -161.0, -225.0, -299.0, -384.0, 121.0, 80.0, 41.0, 58.0, -93.0, -301.0, -78.0, -136.0, 89.0, -90.0, 200.0, -330.0, 170.0, 140.0, -188.0, -231.0, 62.0, 185.0, -154.0, -302.0, 133.0, -30.0, 74.0, -4.0, -8.0, -224.0, 161.0, 113.0, 163.0, 189.0, 157.0, 177.0, -50.0, 0.0, 154.0, 21.0, 0.0, 0.0, -380.0, 70.0, 161.0, -58.0, 111.0, 0.0, -50.0, -106.0, 141.0, 184.0, 0.0, 0.0, -2.0, -382.0, 62.0, 166.0, -284.0, -49.0, -176.0, 148.0, -40.0, -182.0, -49.0, -120.0, -155.0, 0.0, -268.0, 6.0, -179.0, -25.0, 117.0, 109.0, -305.0, -20.0, -60.0, -36.0, -220.0, 128.0, -189.0, 34.0, 146.0, -51.0, -26.0, -12.0, 151.0, -103.0, 130.0, -106.0, 0.0, 0.0, 140.0, 169.0, -119.0, 0.0, -264.0, 61.0, 0.0, 14.0, 194.0, -398.0, 0.0, -272.0, -117.0, -320.0, -32.0, -364.0, -324.0, 0.0, 0.0, 168.0, 184.0, 136.0, -107.0, 0.0, 0.0, 82.0, 0.0, -60.0, -309.0, 116.0, -28.0, 0.0, 108.0, 166.0, 0.0, 68.0, -7.0, -225.0, 177.0, 190.0, -32.0, 80.0, 123.0, -12.0, -87.0, -80.0, 0.0, 0.0, 0.0, 0.0, -277.0, 100.0, 1.0, 0.0, -51.0, 147.0], "policy_predator_policy_reward": [30.0, 0.0, 8.0, 73.0, 1.0, 0.0, 124.0, 58.0, 182.0, 169.0, 184.0, 124.0, 2.0, 8.0, 57.0, 8.0, 116.0, 82.0, 60.0, 91.0, 138.0, 1.0, 178.0, 199.0, 153.0, 154.0, 5.0, 7.0, 3.0, 14.0, 142.0, 200.0, 10.0, 51.0, 0.0, 0.0, 5.0, 138.0, 0.0, 105.0, 21.0, 29.0, 56.0, 1.0, 1.0, 0.0, 0.0, 7.0, 82.0, 3.0, 39.0, 91.0, 131.0, 179.0, 169.0, 65.0, 40.0, 0.0, 74.0, 3.0, 181.0, 98.0, 120.0, 31.0, 102.0, 6.0, 172.0, 1.0, 18.0, 0.0, 0.0, 158.0, 0.0, 0.0, 191.0, 125.0, 9.0, 9.0, 12.0, 49.0, 0.0, 138.0, 3.0, 10.0, 0.0, 12.0, 21.0, 2.0, 48.0, 34.0, 10.0, 10.0, 0.0, 0.0, 177.0, 145.0, 2.0, 42.0, 0.0, 0.0, 46.0, 98.0, 2.0, 4.0, 0.0, 0.0, 163.0, 54.0, 0.0, 11.0, 134.0, 138.0, 124.0, 29.0, 80.0, 105.0, 167.0, 131.0, 91.0, 110.0, 151.0, 31.0, 127.0, 27.0, 23.0, 5.0, 163.0, 193.0, 0.0, 64.0, 133.0, 10.0, 2.0, 172.0, 35.0, 66.0, 86.0, 70.0, 18.0, 107.0, 2.0, 61.0, 0.0, 0.0, 17.0, 19.0, 3.0, 93.0, 154.0, 0.0, 0.0, 0.0, 170.0, 196.0, 156.0, 1.0, 144.0, 172.0, 184.0, 187.0, 0.0, 169.0, 0.0, 0.0, 17.0, 0.0, 0.0, 56.0, 1.0, 0.0, 75.0, 0.0, 133.0, 132.0, 5.0, 9.0, 10.0, 8.0, 2.0, 0.0, 134.0, 9.0, 3.0, 0.0, 16.0, 0.0, 8.0, 13.0, 7.0, 136.0, 3.0, 4.0, 0.0, 0.0, 151.0, 17.0, 14.0, 12.0, 42.0, 48.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0449365084313713, "mean_inference_ms": 3.2773134126696335, "mean_action_processing_ms": 0.47360086221424874, "mean_env_wait_ms": 0.37487110944117596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006453275680541992, "StateBufferConnector_ms": 0.004522442817687988, "ViewRequirementAgentConnector_ms": 0.18719613552093506}, "num_episodes": 23, "episode_return_max": 370.0, "episode_return_min": -449.0, "episode_return_mean": 72.22, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.59837147370956, "num_env_steps_trained_throughput_per_sec": 335.59837147370956, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 13300.317, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13300.231, "sample_time_ms": 2405.677, "learn_time_ms": 10870.042, "learn_throughput": 367.984, "synch_weights_time_ms": 20.733}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "e1352_00002", "date": "2024-08-13_19-38-28", "timestamp": 1723592308, "time_this_iter_s": 11.92698884010315, "time_total_s": 2197.798404455185, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e68670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2197.798404455185, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 57.694117647058825, "ram_util_percent": 76.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9096883616513676, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 4.3964125071883835, "policy_loss": -0.0020921359203322225, "vf_loss": 4.398030020194079, "vf_explained_var": 0.009235766987321238, "kl": 0.011852064366084287, "entropy": 0.952539322237489, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 65.65111115981662, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 8.13739735436818, "policy_loss": -2.041421005275672e-05, "vf_loss": 8.137410262778953, "vf_explained_var": 0.0010192387318484998, "kl": 0.005981884810941265, "entropy": 0.8523415402129845, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 370.0, "episode_reward_min": -449.0, "episode_reward_mean": 76.18, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -398.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": -14.27, "predator_policy": 52.36}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, 139.0, 299.0, 86.0, 322.0, 263.0, -119.0, 157.0, -76.0, -449.0, 241.0, 176.0, -115.0, -63.0, 107.0, 43.0, 328.0, -261.0, 247.0, -140.0, 121.0, 131.0, -94.0, 287.0, 364.0, 357.0, 32.0, 195.0, 0.0, 12.0, 147.0, 111.0, -12.0, 331.0, 0.0, -167.0, 239.0, -61.0, 125.0, -37.0, 129.0, 46.0, -80.0, -50.0, 254.0, 31.0, -32.0, 51.0, 19.0, 196.0, 118.0, 173.0, 87.0, 0.0, 345.0, -23.0, -49.0, 14.0, 162.0, -115.0, -121.0, -25.0, -155.0, 168.0, 337.0, -51.0, 83.0, 15.0, 72.0, -14.0, 292.0, 70.0, -89.0, 370.0, 64.0, 132.0, -24.0, 7.0, 0.0, -9.0, 27.0, 186.0, -155.0, 25.0, 314.0, 217.0, -97.0, 73.0, -85.0, 0.0, 230.0, 154.0, 131.0, 167.0, 0.0, 272.0, -134.0, 265.0, 357.0, -4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [50.0, -182.0, -1.0, 35.0, 193.0, 56.0, 0.0, 29.0, 129.0, 192.0, 176.0, 80.0, -76.0, -128.0, 64.0, -37.0, -161.0, -225.0, -299.0, -384.0, 121.0, 80.0, 41.0, 58.0, -93.0, -301.0, -78.0, -136.0, 89.0, -90.0, 200.0, -330.0, 170.0, 140.0, -188.0, -231.0, 62.0, 185.0, -154.0, -302.0, 133.0, -30.0, 74.0, -4.0, -8.0, -224.0, 161.0, 113.0, 163.0, 189.0, 157.0, 177.0, -50.0, 0.0, 154.0, 21.0, 0.0, 0.0, -380.0, 70.0, 161.0, -58.0, 111.0, 0.0, -50.0, -106.0, 141.0, 184.0, 0.0, 0.0, -2.0, -382.0, 62.0, 166.0, -284.0, -49.0, -176.0, 148.0, -40.0, -182.0, -49.0, -120.0, -155.0, 0.0, -268.0, 6.0, -179.0, -25.0, 117.0, 109.0, -305.0, -20.0, -60.0, -36.0, -220.0, 128.0, -189.0, 34.0, 146.0, -51.0, -26.0, -12.0, 151.0, -103.0, 130.0, -106.0, 0.0, 0.0, 140.0, 169.0, -119.0, 0.0, -264.0, 61.0, 0.0, 14.0, 194.0, -398.0, 0.0, -272.0, -117.0, -320.0, -32.0, -364.0, -324.0, 0.0, 0.0, 168.0, 184.0, 136.0, -107.0, 0.0, 0.0, 82.0, 0.0, -60.0, -309.0, 116.0, -28.0, 0.0, 108.0, 166.0, 0.0, 68.0, -7.0, -225.0, 177.0, 190.0, -32.0, 80.0, 123.0, -12.0, -87.0, -80.0, 0.0, 0.0, 0.0, 0.0, -277.0, 100.0, 1.0, 0.0, -51.0, 147.0, -71.0, -348.0, -292.0, 151.0, 170.0, 125.0, 167.0, -19.0, -66.0, -76.0, 184.0, -286.0, -2.0, -395.0, 0.0, 0.0, 29.0, 120.0, -32.0, 159.0, -66.0, 145.0, 167.0, 0.0, 0.0, 0.0, 108.0, 142.0, -92.0, -98.0, 158.0, 95.0, 180.0, 166.0, -261.0, 34.0], "policy_predator_policy_reward": [5.0, 138.0, 0.0, 105.0, 21.0, 29.0, 56.0, 1.0, 1.0, 0.0, 0.0, 7.0, 82.0, 3.0, 39.0, 91.0, 131.0, 179.0, 169.0, 65.0, 40.0, 0.0, 74.0, 3.0, 181.0, 98.0, 120.0, 31.0, 102.0, 6.0, 172.0, 1.0, 18.0, 0.0, 0.0, 158.0, 0.0, 0.0, 191.0, 125.0, 9.0, 9.0, 12.0, 49.0, 0.0, 138.0, 3.0, 10.0, 0.0, 12.0, 21.0, 2.0, 48.0, 34.0, 10.0, 10.0, 0.0, 0.0, 177.0, 145.0, 2.0, 42.0, 0.0, 0.0, 46.0, 98.0, 2.0, 4.0, 0.0, 0.0, 163.0, 54.0, 0.0, 11.0, 134.0, 138.0, 124.0, 29.0, 80.0, 105.0, 167.0, 131.0, 91.0, 110.0, 151.0, 31.0, 127.0, 27.0, 23.0, 5.0, 163.0, 193.0, 0.0, 64.0, 133.0, 10.0, 2.0, 172.0, 35.0, 66.0, 86.0, 70.0, 18.0, 107.0, 2.0, 61.0, 0.0, 0.0, 17.0, 19.0, 3.0, 93.0, 154.0, 0.0, 0.0, 0.0, 170.0, 196.0, 156.0, 1.0, 144.0, 172.0, 184.0, 187.0, 0.0, 169.0, 0.0, 0.0, 17.0, 0.0, 0.0, 56.0, 1.0, 0.0, 75.0, 0.0, 133.0, 132.0, 5.0, 9.0, 10.0, 8.0, 2.0, 0.0, 134.0, 9.0, 3.0, 0.0, 16.0, 0.0, 8.0, 13.0, 7.0, 136.0, 3.0, 4.0, 0.0, 0.0, 151.0, 17.0, 14.0, 12.0, 42.0, 48.0, 154.0, 110.0, 159.0, 7.0, 16.0, 3.0, 68.0, 1.0, 45.0, 0.0, 128.0, 47.0, 126.0, 186.0, 0.0, 0.0, 54.0, 27.0, 17.0, 10.0, 1.0, 51.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 56.0, 0.0, 0.0, 12.0, 5.0, 6.0, 94.0, 129.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0443911611688879, "mean_inference_ms": 3.2758133088047954, "mean_action_processing_ms": 0.4728500766607069, "mean_env_wait_ms": 0.37463481831392387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006843686103820801, "StateBufferConnector_ms": 0.004538059234619141, "ViewRequirementAgentConnector_ms": 0.1969548463821411}, "num_episodes": 18, "episode_return_max": 370.0, "episode_return_min": -449.0, "episode_return_mean": 76.18, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.3262637903789, "num_env_steps_trained_throughput_per_sec": 317.3262637903789, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 13083.21, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13083.12, "sample_time_ms": 2283.876, "learn_time_ms": 10777.296, "learn_throughput": 371.151, "synch_weights_time_ms": 18.747}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "e1352_00002", "date": "2024-08-13_19-38-40", "timestamp": 1723592320, "time_this_iter_s": 12.624917030334473, "time_total_s": 2210.4233214855194, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2cf5160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2210.4233214855194, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 62.03888888888888, "ram_util_percent": 76.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1220047949010103, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 4.6671356955533305, "policy_loss": -0.007434227992287743, "vf_loss": 4.673386585901654, "vf_explained_var": 0.0031656360500073306, "kl": 0.029550214041286958, "entropy": 0.9710101973127436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 69.21183780122686, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 8.632783784815874, "policy_loss": -0.00038639894248080004, "vf_loss": 8.633163702677166, "vf_explained_var": -0.24198433671678815, "kl": 0.005193247738781298, "entropy": 0.8874054523687515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 370.0, "episode_reward_min": -311.0, "episode_reward_mean": 66.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -398.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": -20.115, "predator_policy": 53.135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-94.0, 287.0, 364.0, 357.0, 32.0, 195.0, 0.0, 12.0, 147.0, 111.0, -12.0, 331.0, 0.0, -167.0, 239.0, -61.0, 125.0, -37.0, 129.0, 46.0, -80.0, -50.0, 254.0, 31.0, -32.0, 51.0, 19.0, 196.0, 118.0, 173.0, 87.0, 0.0, 345.0, -23.0, -49.0, 14.0, 162.0, -115.0, -121.0, -25.0, -155.0, 168.0, 337.0, -51.0, 83.0, 15.0, 72.0, -14.0, 292.0, 70.0, -89.0, 370.0, 64.0, 132.0, -24.0, 7.0, 0.0, -9.0, 27.0, 186.0, -155.0, 25.0, 314.0, 217.0, -97.0, 73.0, -85.0, 0.0, 230.0, 154.0, 131.0, 167.0, 0.0, 272.0, -134.0, 265.0, 357.0, -4.0, -128.0, -41.0, 84.0, 6.0, 198.0, -12.0, 59.0, -272.0, -154.0, 163.0, -34.0, 9.0, 245.0, 190.0, 9.0, 305.0, 164.0, -15.0, -311.0, 14.0, 27.0, -72.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.0, -224.0, 161.0, 113.0, 163.0, 189.0, 157.0, 177.0, -50.0, 0.0, 154.0, 21.0, 0.0, 0.0, -380.0, 70.0, 161.0, -58.0, 111.0, 0.0, -50.0, -106.0, 141.0, 184.0, 0.0, 0.0, -2.0, -382.0, 62.0, 166.0, -284.0, -49.0, -176.0, 148.0, -40.0, -182.0, -49.0, -120.0, -155.0, 0.0, -268.0, 6.0, -179.0, -25.0, 117.0, 109.0, -305.0, -20.0, -60.0, -36.0, -220.0, 128.0, -189.0, 34.0, 146.0, -51.0, -26.0, -12.0, 151.0, -103.0, 130.0, -106.0, 0.0, 0.0, 140.0, 169.0, -119.0, 0.0, -264.0, 61.0, 0.0, 14.0, 194.0, -398.0, 0.0, -272.0, -117.0, -320.0, -32.0, -364.0, -324.0, 0.0, 0.0, 168.0, 184.0, 136.0, -107.0, 0.0, 0.0, 82.0, 0.0, -60.0, -309.0, 116.0, -28.0, 0.0, 108.0, 166.0, 0.0, 68.0, -7.0, -225.0, 177.0, 190.0, -32.0, 80.0, 123.0, -12.0, -87.0, -80.0, 0.0, 0.0, 0.0, 0.0, -277.0, 100.0, 1.0, 0.0, -51.0, 147.0, -71.0, -348.0, -292.0, 151.0, 170.0, 125.0, 167.0, -19.0, -66.0, -76.0, 184.0, -286.0, -2.0, -395.0, 0.0, 0.0, 29.0, 120.0, -32.0, 159.0, -66.0, 145.0, 167.0, 0.0, 0.0, 0.0, 108.0, 142.0, -92.0, -98.0, 158.0, 95.0, 180.0, 166.0, -261.0, 34.0, -52.0, -388.0, -179.0, -21.0, 9.0, 45.0, -179.0, 55.0, 119.0, 49.0, -24.0, 0.0, -392.0, 91.0, -287.0, -337.0, -80.0, -260.0, 153.0, 0.0, -42.0, -14.0, 9.0, 0.0, 140.0, 97.0, 25.0, 165.0, -38.0, -32.0, 176.0, 105.0, 151.0, 0.0, -374.0, 12.0, -328.0, -177.0, 20.0, -79.0, 51.0, -228.0, 20.0, -223.0], "policy_predator_policy_reward": [0.0, 138.0, 3.0, 10.0, 0.0, 12.0, 21.0, 2.0, 48.0, 34.0, 10.0, 10.0, 0.0, 0.0, 177.0, 145.0, 2.0, 42.0, 0.0, 0.0, 46.0, 98.0, 2.0, 4.0, 0.0, 0.0, 163.0, 54.0, 0.0, 11.0, 134.0, 138.0, 124.0, 29.0, 80.0, 105.0, 167.0, 131.0, 91.0, 110.0, 151.0, 31.0, 127.0, 27.0, 23.0, 5.0, 163.0, 193.0, 0.0, 64.0, 133.0, 10.0, 2.0, 172.0, 35.0, 66.0, 86.0, 70.0, 18.0, 107.0, 2.0, 61.0, 0.0, 0.0, 17.0, 19.0, 3.0, 93.0, 154.0, 0.0, 0.0, 0.0, 170.0, 196.0, 156.0, 1.0, 144.0, 172.0, 184.0, 187.0, 0.0, 169.0, 0.0, 0.0, 17.0, 0.0, 0.0, 56.0, 1.0, 0.0, 75.0, 0.0, 133.0, 132.0, 5.0, 9.0, 10.0, 8.0, 2.0, 0.0, 134.0, 9.0, 3.0, 0.0, 16.0, 0.0, 8.0, 13.0, 7.0, 136.0, 3.0, 4.0, 0.0, 0.0, 151.0, 17.0, 14.0, 12.0, 42.0, 48.0, 154.0, 110.0, 159.0, 7.0, 16.0, 3.0, 68.0, 1.0, 45.0, 0.0, 128.0, 47.0, 126.0, 186.0, 0.0, 0.0, 54.0, 27.0, 17.0, 10.0, 1.0, 51.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 56.0, 0.0, 0.0, 12.0, 5.0, 6.0, 94.0, 129.0, 156.0, 156.0, 80.0, 79.0, 1.0, 29.0, 120.0, 10.0, 9.0, 21.0, 0.0, 12.0, 193.0, 167.0, 175.0, 177.0, 177.0, 9.0, 6.0, 4.0, 0.0, 22.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 18.0, 61.0, 9.0, 15.0, 0.0, 13.0, 162.0, 185.0, 179.0, 15.0, 17.0, 56.0, 118.0, 86.0, 131.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0431820018242268, "mean_inference_ms": 3.269726645585209, "mean_action_processing_ms": 0.4717747013769797, "mean_env_wait_ms": 0.3744087816438094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005793571472167969, "StateBufferConnector_ms": 0.006734490394592285, "ViewRequirementAgentConnector_ms": 0.18319451808929443}, "num_episodes": 22, "episode_return_max": 370.0, "episode_return_min": -311.0, "episode_return_mean": 66.04, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.4808365997237, "num_env_steps_trained_throughput_per_sec": 325.4808365997237, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 12900.56, "restore_workers_time_ms": 0.019, "training_step_time_ms": 12900.47, "sample_time_ms": 2103.151, "learn_time_ms": 10775.328, "learn_throughput": 371.218, "synch_weights_time_ms": 18.755}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "e1352_00002", "date": "2024-08-13_19-38-53", "timestamp": 1723592333, "time_this_iter_s": 12.336185216903687, "time_total_s": 2222.759506702423, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2222.759506702423, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 64.35882352941177, "ram_util_percent": 76.97058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2298845680302413, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 5.747108933534571, "policy_loss": -0.0031973091405003316, "vf_loss": 5.749664146685727, "vf_explained_var": -0.006840789412695264, "kl": 0.010689449357486768, "entropy": 0.9904024304851653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 81.00143332295318, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 8.289169282004947, "policy_loss": -0.002016698272662267, "vf_loss": 8.291174008858897, "vf_explained_var": -0.2721521821286943, "kl": 0.009563889899622719, "entropy": 0.8970709695702508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 370.0, "episode_reward_min": -311.0, "episode_reward_mean": 52.27, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": -28.125, "predator_policy": 54.26}, "custom_metrics": {}, "hist_stats": {"episode_reward": [129.0, 46.0, -80.0, -50.0, 254.0, 31.0, -32.0, 51.0, 19.0, 196.0, 118.0, 173.0, 87.0, 0.0, 345.0, -23.0, -49.0, 14.0, 162.0, -115.0, -121.0, -25.0, -155.0, 168.0, 337.0, -51.0, 83.0, 15.0, 72.0, -14.0, 292.0, 70.0, -89.0, 370.0, 64.0, 132.0, -24.0, 7.0, 0.0, -9.0, 27.0, 186.0, -155.0, 25.0, 314.0, 217.0, -97.0, 73.0, -85.0, 0.0, 230.0, 154.0, 131.0, 167.0, 0.0, 272.0, -134.0, 265.0, 357.0, -4.0, -128.0, -41.0, 84.0, 6.0, 198.0, -12.0, 59.0, -272.0, -154.0, 163.0, -34.0, 9.0, 245.0, 190.0, 9.0, 305.0, 164.0, -15.0, -311.0, 14.0, 27.0, -72.0, 94.0, 39.0, 107.0, 181.0, -64.0, -96.0, 148.0, 60.0, -8.0, -24.0, 31.0, 21.0, 4.0, 94.0, -119.0, 81.0, 57.0, -154.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-49.0, -120.0, -155.0, 0.0, -268.0, 6.0, -179.0, -25.0, 117.0, 109.0, -305.0, -20.0, -60.0, -36.0, -220.0, 128.0, -189.0, 34.0, 146.0, -51.0, -26.0, -12.0, 151.0, -103.0, 130.0, -106.0, 0.0, 0.0, 140.0, 169.0, -119.0, 0.0, -264.0, 61.0, 0.0, 14.0, 194.0, -398.0, 0.0, -272.0, -117.0, -320.0, -32.0, -364.0, -324.0, 0.0, 0.0, 168.0, 184.0, 136.0, -107.0, 0.0, 0.0, 82.0, 0.0, -60.0, -309.0, 116.0, -28.0, 0.0, 108.0, 166.0, 0.0, 68.0, -7.0, -225.0, 177.0, 190.0, -32.0, 80.0, 123.0, -12.0, -87.0, -80.0, 0.0, 0.0, 0.0, 0.0, -277.0, 100.0, 1.0, 0.0, -51.0, 147.0, -71.0, -348.0, -292.0, 151.0, 170.0, 125.0, 167.0, -19.0, -66.0, -76.0, 184.0, -286.0, -2.0, -395.0, 0.0, 0.0, 29.0, 120.0, -32.0, 159.0, -66.0, 145.0, 167.0, 0.0, 0.0, 0.0, 108.0, 142.0, -92.0, -98.0, 158.0, 95.0, 180.0, 166.0, -261.0, 34.0, -52.0, -388.0, -179.0, -21.0, 9.0, 45.0, -179.0, 55.0, 119.0, 49.0, -24.0, 0.0, -392.0, 91.0, -287.0, -337.0, -80.0, -260.0, 153.0, 0.0, -42.0, -14.0, 9.0, 0.0, 140.0, 97.0, 25.0, 165.0, -38.0, -32.0, 176.0, 105.0, 151.0, 0.0, -374.0, 12.0, -328.0, -177.0, 20.0, -79.0, 51.0, -228.0, 20.0, -223.0, 48.0, 0.0, 0.0, -6.0, -24.0, 9.0, 33.0, 78.0, -239.0, -41.0, -26.0, -312.0, -14.0, 144.0, 0.0, 43.0, -35.0, 0.0, 6.0, -118.0, -74.0, -26.0, -20.0, -53.0, 0.0, -14.0, -187.0, 123.0, 45.0, -350.0, 40.0, 0.0, 0.0, -11.0, -34.0, -400.0], "policy_predator_policy_reward": [167.0, 131.0, 91.0, 110.0, 151.0, 31.0, 127.0, 27.0, 23.0, 5.0, 163.0, 193.0, 0.0, 64.0, 133.0, 10.0, 2.0, 172.0, 35.0, 66.0, 86.0, 70.0, 18.0, 107.0, 2.0, 61.0, 0.0, 0.0, 17.0, 19.0, 3.0, 93.0, 154.0, 0.0, 0.0, 0.0, 170.0, 196.0, 156.0, 1.0, 144.0, 172.0, 184.0, 187.0, 0.0, 169.0, 0.0, 0.0, 17.0, 0.0, 0.0, 56.0, 1.0, 0.0, 75.0, 0.0, 133.0, 132.0, 5.0, 9.0, 10.0, 8.0, 2.0, 0.0, 134.0, 9.0, 3.0, 0.0, 16.0, 0.0, 8.0, 13.0, 7.0, 136.0, 3.0, 4.0, 0.0, 0.0, 151.0, 17.0, 14.0, 12.0, 42.0, 48.0, 154.0, 110.0, 159.0, 7.0, 16.0, 3.0, 68.0, 1.0, 45.0, 0.0, 128.0, 47.0, 126.0, 186.0, 0.0, 0.0, 54.0, 27.0, 17.0, 10.0, 1.0, 51.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 56.0, 0.0, 0.0, 12.0, 5.0, 6.0, 94.0, 129.0, 156.0, 156.0, 80.0, 79.0, 1.0, 29.0, 120.0, 10.0, 9.0, 21.0, 0.0, 12.0, 193.0, 167.0, 175.0, 177.0, 177.0, 9.0, 6.0, 4.0, 0.0, 22.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 18.0, 61.0, 9.0, 15.0, 0.0, 13.0, 162.0, 185.0, 179.0, 15.0, 17.0, 56.0, 118.0, 86.0, 131.0, 0.0, 31.0, 15.0, 30.0, 15.0, 58.0, 64.0, 15.0, 55.0, 113.0, 103.0, 157.0, 85.0, 7.0, 11.0, 0.0, 17.0, 0.0, 27.0, 88.0, 0.0, 36.0, 95.0, 81.0, 13.0, 0.0, 18.0, 66.0, 92.0, 167.0, 19.0, 36.0, 5.0, 14.0, 54.0, 83.0, 197.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0427205829230313, "mean_inference_ms": 3.2708369383938494, "mean_action_processing_ms": 0.4709494452061053, "mean_env_wait_ms": 0.3739364565451884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006425142288208008, "StateBufferConnector_ms": 0.0069893598556518555, "ViewRequirementAgentConnector_ms": 0.18582308292388916}, "num_episodes": 18, "episode_return_max": 370.0, "episode_return_min": -311.0, "episode_return_mean": 52.27, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.25895067053756, "num_env_steps_trained_throughput_per_sec": 305.25895067053756, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 13044.806, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13044.737, "sample_time_ms": 2150.948, "learn_time_ms": 10872.058, "learn_throughput": 367.916, "synch_weights_time_ms": 18.781}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "e1352_00002", "date": "2024-08-13_19-39-06", "timestamp": 1723592346, "time_this_iter_s": 13.145562887191772, "time_total_s": 2235.905069589615, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d130d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2235.905069589615, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 67.85789473684211, "ram_util_percent": 77.3157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0092456658681233, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 7.542898316105838, "policy_loss": -0.0005530371118790258, "vf_loss": 7.542830472270017, "vf_explained_var": -0.011506031146125188, "kl": 0.010336060527134053, "entropy": 0.8826225477236288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 60.19313325238606, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 8.517241929321692, "policy_loss": -0.0017082715848037017, "vf_loss": 8.518933171317691, "vf_explained_var": -0.501006193829592, "kl": 0.013617997778164288, "entropy": 0.8601687756480363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 370.0, "episode_reward_min": -345.0, "episode_reward_mean": 35.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -34.255, "predator_policy": 52.005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [168.0, 337.0, -51.0, 83.0, 15.0, 72.0, -14.0, 292.0, 70.0, -89.0, 370.0, 64.0, 132.0, -24.0, 7.0, 0.0, -9.0, 27.0, 186.0, -155.0, 25.0, 314.0, 217.0, -97.0, 73.0, -85.0, 0.0, 230.0, 154.0, 131.0, 167.0, 0.0, 272.0, -134.0, 265.0, 357.0, -4.0, -128.0, -41.0, 84.0, 6.0, 198.0, -12.0, 59.0, -272.0, -154.0, 163.0, -34.0, 9.0, 245.0, 190.0, 9.0, 305.0, 164.0, -15.0, -311.0, 14.0, 27.0, -72.0, 94.0, 39.0, 107.0, 181.0, -64.0, -96.0, 148.0, 60.0, -8.0, -24.0, 31.0, 21.0, 4.0, 94.0, -119.0, 81.0, 57.0, -154.0, -5.0, -96.0, -96.0, 60.0, 177.0, -209.0, 31.0, 127.0, -103.0, -237.0, -298.0, 292.0, 103.0, -122.0, 77.0, -138.0, -345.0, -1.0, -30.0, 57.0, 141.0, -69.0, -18.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 168.0, 184.0, 136.0, -107.0, 0.0, 0.0, 82.0, 0.0, -60.0, -309.0, 116.0, -28.0, 0.0, 108.0, 166.0, 0.0, 68.0, -7.0, -225.0, 177.0, 190.0, -32.0, 80.0, 123.0, -12.0, -87.0, -80.0, 0.0, 0.0, 0.0, 0.0, -277.0, 100.0, 1.0, 0.0, -51.0, 147.0, -71.0, -348.0, -292.0, 151.0, 170.0, 125.0, 167.0, -19.0, -66.0, -76.0, 184.0, -286.0, -2.0, -395.0, 0.0, 0.0, 29.0, 120.0, -32.0, 159.0, -66.0, 145.0, 167.0, 0.0, 0.0, 0.0, 108.0, 142.0, -92.0, -98.0, 158.0, 95.0, 180.0, 166.0, -261.0, 34.0, -52.0, -388.0, -179.0, -21.0, 9.0, 45.0, -179.0, 55.0, 119.0, 49.0, -24.0, 0.0, -392.0, 91.0, -287.0, -337.0, -80.0, -260.0, 153.0, 0.0, -42.0, -14.0, 9.0, 0.0, 140.0, 97.0, 25.0, 165.0, -38.0, -32.0, 176.0, 105.0, 151.0, 0.0, -374.0, 12.0, -328.0, -177.0, 20.0, -79.0, 51.0, -228.0, 20.0, -223.0, 48.0, 0.0, 0.0, -6.0, -24.0, 9.0, 33.0, 78.0, -239.0, -41.0, -26.0, -312.0, -14.0, 144.0, 0.0, 43.0, -35.0, 0.0, 6.0, -118.0, -74.0, -26.0, -20.0, -53.0, 0.0, -14.0, -187.0, 123.0, 45.0, -350.0, 40.0, 0.0, 0.0, -11.0, -34.0, -400.0, -15.0, -132.0, 0.0, -246.0, -181.0, -75.0, 0.0, -46.0, -45.0, 89.0, -301.0, -219.0, -158.0, 19.0, 12.0, 105.0, 0.0, -400.0, -233.0, -185.0, -360.0, -229.0, 142.0, 134.0, 51.0, -11.0, 7.0, -376.0, 0.0, 49.0, -321.0, 0.0, -350.0, -269.0, 0.0, -2.0, 0.0, -70.0, -63.0, 17.0, -40.0, 95.0, -63.0, -174.0, -18.0, -99.0], "policy_predator_policy_reward": [0.0, 0.0, 17.0, 0.0, 0.0, 56.0, 1.0, 0.0, 75.0, 0.0, 133.0, 132.0, 5.0, 9.0, 10.0, 8.0, 2.0, 0.0, 134.0, 9.0, 3.0, 0.0, 16.0, 0.0, 8.0, 13.0, 7.0, 136.0, 3.0, 4.0, 0.0, 0.0, 151.0, 17.0, 14.0, 12.0, 42.0, 48.0, 154.0, 110.0, 159.0, 7.0, 16.0, 3.0, 68.0, 1.0, 45.0, 0.0, 128.0, 47.0, 126.0, 186.0, 0.0, 0.0, 54.0, 27.0, 17.0, 10.0, 1.0, 51.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 56.0, 0.0, 0.0, 12.0, 5.0, 6.0, 94.0, 129.0, 156.0, 156.0, 80.0, 79.0, 1.0, 29.0, 120.0, 10.0, 9.0, 21.0, 0.0, 12.0, 193.0, 167.0, 175.0, 177.0, 177.0, 9.0, 6.0, 4.0, 0.0, 22.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 18.0, 61.0, 9.0, 15.0, 0.0, 13.0, 162.0, 185.0, 179.0, 15.0, 17.0, 56.0, 118.0, 86.0, 131.0, 0.0, 31.0, 15.0, 30.0, 15.0, 58.0, 64.0, 15.0, 55.0, 113.0, 103.0, 157.0, 85.0, 7.0, 11.0, 0.0, 17.0, 0.0, 27.0, 88.0, 0.0, 36.0, 95.0, 81.0, 13.0, 0.0, 18.0, 66.0, 92.0, 167.0, 19.0, 36.0, 5.0, 14.0, 54.0, 83.0, 197.0, 124.0, 18.0, 96.0, 54.0, 106.0, 54.0, 57.0, 49.0, 67.0, 66.0, 148.0, 163.0, 56.0, 114.0, 9.0, 1.0, 97.0, 200.0, 13.0, 168.0, 111.0, 180.0, 5.0, 11.0, 48.0, 15.0, 53.0, 194.0, 28.0, 0.0, 167.0, 16.0, 182.0, 92.0, 1.0, 0.0, 13.0, 27.0, 79.0, 24.0, 46.0, 40.0, 75.0, 93.0, 23.0, 76.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0391882212490922, "mean_inference_ms": 3.270222758781279, "mean_action_processing_ms": 0.4696581763163055, "mean_env_wait_ms": 0.37317362171236307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010677933692932129, "StateBufferConnector_ms": 0.00688934326171875, "ViewRequirementAgentConnector_ms": 0.17960405349731445}, "num_episodes": 23, "episode_return_max": 370.0, "episode_return_min": -345.0, "episode_return_mean": 35.5, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.9121928673913, "num_env_steps_trained_throughput_per_sec": 254.9121928673913, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 13422.31, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13422.25, "sample_time_ms": 2201.888, "learn_time_ms": 11198.02, "learn_throughput": 357.206, "synch_weights_time_ms": 18.745}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "e1352_00002", "date": "2024-08-13_19-39-22", "timestamp": 1723592362, "time_this_iter_s": 15.774235010147095, "time_total_s": 2251.679304599762, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e7c550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2251.679304599762, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 90.23636363636363, "ram_util_percent": 82.74090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.177231510590624, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 6.846078627197831, "policy_loss": 6.775918919297438e-05, "vf_loss": 6.845745994678881, "vf_explained_var": -0.005367960847874798, "kl": 0.004409675862431324, "entropy": 0.9429384497738389, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 79.42505250393398, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 7.904281681302994, "policy_loss": 0.0018877376275008948, "vf_loss": 7.902378134500413, "vf_explained_var": -0.6989765607490741, "kl": 0.012634657582626945, "entropy": 0.9717167983925532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 357.0, "episode_reward_min": -352.0, "episode_reward_mean": 5.61, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -59.57, "predator_policy": 62.375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [186.0, -155.0, 25.0, 314.0, 217.0, -97.0, 73.0, -85.0, 0.0, 230.0, 154.0, 131.0, 167.0, 0.0, 272.0, -134.0, 265.0, 357.0, -4.0, -128.0, -41.0, 84.0, 6.0, 198.0, -12.0, 59.0, -272.0, -154.0, 163.0, -34.0, 9.0, 245.0, 190.0, 9.0, 305.0, 164.0, -15.0, -311.0, 14.0, 27.0, -72.0, 94.0, 39.0, 107.0, 181.0, -64.0, -96.0, 148.0, 60.0, -8.0, -24.0, 31.0, 21.0, 4.0, 94.0, -119.0, 81.0, 57.0, -154.0, -5.0, -96.0, -96.0, 60.0, 177.0, -209.0, 31.0, 127.0, -103.0, -237.0, -298.0, 292.0, 103.0, -122.0, 77.0, -138.0, -345.0, -1.0, -30.0, 57.0, 141.0, -69.0, -18.0, 44.0, -268.0, 26.0, -48.0, -54.0, 23.0, -352.0, -66.0, 0.0, -95.0, -57.0, 0.0, -303.0, -238.0, 0.0, -75.0, -134.0, 58.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-51.0, 147.0, -71.0, -348.0, -292.0, 151.0, 170.0, 125.0, 167.0, -19.0, -66.0, -76.0, 184.0, -286.0, -2.0, -395.0, 0.0, 0.0, 29.0, 120.0, -32.0, 159.0, -66.0, 145.0, 167.0, 0.0, 0.0, 0.0, 108.0, 142.0, -92.0, -98.0, 158.0, 95.0, 180.0, 166.0, -261.0, 34.0, -52.0, -388.0, -179.0, -21.0, 9.0, 45.0, -179.0, 55.0, 119.0, 49.0, -24.0, 0.0, -392.0, 91.0, -287.0, -337.0, -80.0, -260.0, 153.0, 0.0, -42.0, -14.0, 9.0, 0.0, 140.0, 97.0, 25.0, 165.0, -38.0, -32.0, 176.0, 105.0, 151.0, 0.0, -374.0, 12.0, -328.0, -177.0, 20.0, -79.0, 51.0, -228.0, 20.0, -223.0, 48.0, 0.0, 0.0, -6.0, -24.0, 9.0, 33.0, 78.0, -239.0, -41.0, -26.0, -312.0, -14.0, 144.0, 0.0, 43.0, -35.0, 0.0, 6.0, -118.0, -74.0, -26.0, -20.0, -53.0, 0.0, -14.0, -187.0, 123.0, 45.0, -350.0, 40.0, 0.0, 0.0, -11.0, -34.0, -400.0, -15.0, -132.0, 0.0, -246.0, -181.0, -75.0, 0.0, -46.0, -45.0, 89.0, -301.0, -219.0, -158.0, 19.0, 12.0, 105.0, 0.0, -400.0, -233.0, -185.0, -360.0, -229.0, 142.0, 134.0, 51.0, -11.0, 7.0, -376.0, 0.0, 49.0, -321.0, 0.0, -350.0, -269.0, 0.0, -2.0, 0.0, -70.0, -63.0, 17.0, -40.0, 95.0, -63.0, -174.0, -18.0, -99.0, 8.0, 0.0, -136.0, -302.0, -72.0, 0.0, 0.0, -395.0, -128.0, -155.0, -178.0, 56.0, -346.0, -373.0, 0.0, -251.0, 0.0, 0.0, -8.0, -332.0, -158.0, -23.0, 0.0, 0.0, -392.0, -180.0, -200.0, -142.0, 0.0, 0.0, -141.0, -109.0, -400.0, -95.0, 0.0, -136.0], "policy_predator_policy_reward": [42.0, 48.0, 154.0, 110.0, 159.0, 7.0, 16.0, 3.0, 68.0, 1.0, 45.0, 0.0, 128.0, 47.0, 126.0, 186.0, 0.0, 0.0, 54.0, 27.0, 17.0, 10.0, 1.0, 51.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 56.0, 0.0, 0.0, 12.0, 5.0, 6.0, 94.0, 129.0, 156.0, 156.0, 80.0, 79.0, 1.0, 29.0, 120.0, 10.0, 9.0, 21.0, 0.0, 12.0, 193.0, 167.0, 175.0, 177.0, 177.0, 9.0, 6.0, 4.0, 0.0, 22.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 18.0, 61.0, 9.0, 15.0, 0.0, 13.0, 162.0, 185.0, 179.0, 15.0, 17.0, 56.0, 118.0, 86.0, 131.0, 0.0, 31.0, 15.0, 30.0, 15.0, 58.0, 64.0, 15.0, 55.0, 113.0, 103.0, 157.0, 85.0, 7.0, 11.0, 0.0, 17.0, 0.0, 27.0, 88.0, 0.0, 36.0, 95.0, 81.0, 13.0, 0.0, 18.0, 66.0, 92.0, 167.0, 19.0, 36.0, 5.0, 14.0, 54.0, 83.0, 197.0, 124.0, 18.0, 96.0, 54.0, 106.0, 54.0, 57.0, 49.0, 67.0, 66.0, 148.0, 163.0, 56.0, 114.0, 9.0, 1.0, 97.0, 200.0, 13.0, 168.0, 111.0, 180.0, 5.0, 11.0, 48.0, 15.0, 53.0, 194.0, 28.0, 0.0, 167.0, 16.0, 182.0, 92.0, 1.0, 0.0, 13.0, 27.0, 79.0, 24.0, 46.0, 40.0, 75.0, 93.0, 23.0, 76.0, 6.0, 30.0, 0.0, 170.0, 30.0, 68.0, 194.0, 153.0, 170.0, 59.0, 107.0, 38.0, 199.0, 168.0, 50.0, 135.0, 0.0, 0.0, 167.0, 78.0, 93.0, 31.0, 0.0, 0.0, 84.0, 185.0, 104.0, 0.0, 0.0, 0.0, 81.0, 94.0, 165.0, 196.0, 83.0, 111.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0401578296598084, "mean_inference_ms": 3.2675263951117226, "mean_action_processing_ms": 0.4688684604715581, "mean_env_wait_ms": 0.3728593300003274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011356830596923828, "StateBufferConnector_ms": 0.008800625801086426, "ViewRequirementAgentConnector_ms": 0.1737685203552246}, "num_episodes": 18, "episode_return_max": 357.0, "episode_return_min": -352.0, "episode_return_mean": 5.61, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.4430379073781, "num_env_steps_trained_throughput_per_sec": 293.4430379073781, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 13550.323, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13550.263, "sample_time_ms": 2355.967, "learn_time_ms": 11172.178, "learn_throughput": 358.032, "synch_weights_time_ms": 18.58}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "e1352_00002", "date": "2024-08-13_19-39-36", "timestamp": 1723592376, "time_this_iter_s": 13.647126913070679, "time_total_s": 2265.3264315128326, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e7ce50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2265.3264315128326, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 62.425, "ram_util_percent": 79.74499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.296621088833405, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 0.00010000000000000003, "total_loss": 7.575393084874229, "policy_loss": -0.0004754133010036731, "vf_loss": 7.575603632699876, "vf_explained_var": -0.0098023220975563, "kl": 0.008818746625171566, "entropy": 0.884290102076909, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 62.88257908351207, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 8.362744626797065, "policy_loss": 0.00013050622006178532, "vf_loss": 8.362604122313241, "vf_explained_var": -0.6216672006107512, "kl": 0.00799053851753074, "entropy": 0.8413794589105738, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 305.0, "episode_reward_min": -352.0, "episode_reward_mean": -22.31, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 176.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -81.885, "predator_policy": 70.73}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -128.0, -41.0, 84.0, 6.0, 198.0, -12.0, 59.0, -272.0, -154.0, 163.0, -34.0, 9.0, 245.0, 190.0, 9.0, 305.0, 164.0, -15.0, -311.0, 14.0, 27.0, -72.0, 94.0, 39.0, 107.0, 181.0, -64.0, -96.0, 148.0, 60.0, -8.0, -24.0, 31.0, 21.0, 4.0, 94.0, -119.0, 81.0, 57.0, -154.0, -5.0, -96.0, -96.0, 60.0, 177.0, -209.0, 31.0, 127.0, -103.0, -237.0, -298.0, 292.0, 103.0, -122.0, 77.0, -138.0, -345.0, -1.0, -30.0, 57.0, 141.0, -69.0, -18.0, 44.0, -268.0, 26.0, -48.0, -54.0, 23.0, -352.0, -66.0, 0.0, -95.0, -57.0, 0.0, -303.0, -238.0, 0.0, -75.0, -134.0, 58.0, -221.0, -270.0, -127.0, -118.0, 1.0, -31.0, 30.0, 30.0, -78.0, 36.0, 55.0, -100.0, -66.0, 111.0, -58.0, -21.0, -182.0, 137.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-261.0, 34.0, -52.0, -388.0, -179.0, -21.0, 9.0, 45.0, -179.0, 55.0, 119.0, 49.0, -24.0, 0.0, -392.0, 91.0, -287.0, -337.0, -80.0, -260.0, 153.0, 0.0, -42.0, -14.0, 9.0, 0.0, 140.0, 97.0, 25.0, 165.0, -38.0, -32.0, 176.0, 105.0, 151.0, 0.0, -374.0, 12.0, -328.0, -177.0, 20.0, -79.0, 51.0, -228.0, 20.0, -223.0, 48.0, 0.0, 0.0, -6.0, -24.0, 9.0, 33.0, 78.0, -239.0, -41.0, -26.0, -312.0, -14.0, 144.0, 0.0, 43.0, -35.0, 0.0, 6.0, -118.0, -74.0, -26.0, -20.0, -53.0, 0.0, -14.0, -187.0, 123.0, 45.0, -350.0, 40.0, 0.0, 0.0, -11.0, -34.0, -400.0, -15.0, -132.0, 0.0, -246.0, -181.0, -75.0, 0.0, -46.0, -45.0, 89.0, -301.0, -219.0, -158.0, 19.0, 12.0, 105.0, 0.0, -400.0, -233.0, -185.0, -360.0, -229.0, 142.0, 134.0, 51.0, -11.0, 7.0, -376.0, 0.0, 49.0, -321.0, 0.0, -350.0, -269.0, 0.0, -2.0, 0.0, -70.0, -63.0, 17.0, -40.0, 95.0, -63.0, -174.0, -18.0, -99.0, 8.0, 0.0, -136.0, -302.0, -72.0, 0.0, 0.0, -395.0, -128.0, -155.0, -178.0, 56.0, -346.0, -373.0, 0.0, -251.0, 0.0, 0.0, -8.0, -332.0, -158.0, -23.0, 0.0, 0.0, -392.0, -180.0, -200.0, -142.0, 0.0, 0.0, -141.0, -109.0, -400.0, -95.0, 0.0, -136.0, -169.0, -364.0, -311.0, -254.0, -373.0, 0.0, -103.0, -198.0, -213.0, 0.0, 0.0, -150.0, -90.0, 41.0, -345.0, 94.0, -6.0, -280.0, 9.0, 0.0, 50.0, 0.0, -142.0, -201.0, -348.0, 0.0, 47.0, 20.0, -138.0, -61.0, 40.0, -169.0, -398.0, 0.0, 52.0, 16.0], "policy_predator_policy_reward": [94.0, 129.0, 156.0, 156.0, 80.0, 79.0, 1.0, 29.0, 120.0, 10.0, 9.0, 21.0, 0.0, 12.0, 193.0, 167.0, 175.0, 177.0, 177.0, 9.0, 6.0, 4.0, 0.0, 22.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 18.0, 61.0, 9.0, 15.0, 0.0, 13.0, 162.0, 185.0, 179.0, 15.0, 17.0, 56.0, 118.0, 86.0, 131.0, 0.0, 31.0, 15.0, 30.0, 15.0, 58.0, 64.0, 15.0, 55.0, 113.0, 103.0, 157.0, 85.0, 7.0, 11.0, 0.0, 17.0, 0.0, 27.0, 88.0, 0.0, 36.0, 95.0, 81.0, 13.0, 0.0, 18.0, 66.0, 92.0, 167.0, 19.0, 36.0, 5.0, 14.0, 54.0, 83.0, 197.0, 124.0, 18.0, 96.0, 54.0, 106.0, 54.0, 57.0, 49.0, 67.0, 66.0, 148.0, 163.0, 56.0, 114.0, 9.0, 1.0, 97.0, 200.0, 13.0, 168.0, 111.0, 180.0, 5.0, 11.0, 48.0, 15.0, 53.0, 194.0, 28.0, 0.0, 167.0, 16.0, 182.0, 92.0, 1.0, 0.0, 13.0, 27.0, 79.0, 24.0, 46.0, 40.0, 75.0, 93.0, 23.0, 76.0, 6.0, 30.0, 0.0, 170.0, 30.0, 68.0, 194.0, 153.0, 170.0, 59.0, 107.0, 38.0, 199.0, 168.0, 50.0, 135.0, 0.0, 0.0, 167.0, 78.0, 93.0, 31.0, 0.0, 0.0, 84.0, 185.0, 104.0, 0.0, 0.0, 0.0, 81.0, 94.0, 165.0, 196.0, 83.0, 111.0, 124.0, 188.0, 145.0, 150.0, 129.0, 117.0, 112.0, 71.0, 83.0, 131.0, 108.0, 11.0, 4.0, 75.0, 178.0, 103.0, 112.0, 96.0, 11.0, 16.0, 5.0, 0.0, 154.0, 89.0, 116.0, 166.0, 38.0, 6.0, 111.0, 30.0, 6.0, 102.0, 17.0, 199.0, 51.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0396658390007298, "mean_inference_ms": 3.2675757752159353, "mean_action_processing_ms": 0.46809150611290334, "mean_env_wait_ms": 0.3725507189149119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010770440101623535, "StateBufferConnector_ms": 0.00868678092956543, "ViewRequirementAgentConnector_ms": 0.15643370151519775}, "num_episodes": 18, "episode_return_max": 305.0, "episode_return_min": -352.0, "episode_return_mean": -22.31, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.10062497305313, "num_env_steps_trained_throughput_per_sec": 325.10062497305313, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 13354.884, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13354.824, "sample_time_ms": 2317.55, "learn_time_ms": 11014.784, "learn_throughput": 363.148, "synch_weights_time_ms": 18.764}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "e1352_00002", "date": "2024-08-13_19-39-48", "timestamp": 1723592388, "time_this_iter_s": 12.354337215423584, "time_total_s": 2277.680768728256, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e7c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2277.680768728256, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 63.74117647058823, "ram_util_percent": 74.78823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2128101801194213, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 0.00010000000000000003, "total_loss": 7.951010661150413, "policy_loss": -0.003792855234954644, "vf_loss": 7.954556444208458, "vf_explained_var": 0.0010722226882107044, "kl": 0.008226870040293146, "entropy": 0.9165842817889319, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.79847927916617, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 8.684718220322221, "policy_loss": -0.0025565373859116956, "vf_loss": 8.687256525180958, "vf_explained_var": -0.488545209137851, "kl": 0.014580244475580519, "entropy": 0.7918388737887933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 292.0, "episode_reward_min": -352.0, "episode_reward_mean": -41.51, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 144.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -101.335, "predator_policy": 80.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72.0, 94.0, 39.0, 107.0, 181.0, -64.0, -96.0, 148.0, 60.0, -8.0, -24.0, 31.0, 21.0, 4.0, 94.0, -119.0, 81.0, 57.0, -154.0, -5.0, -96.0, -96.0, 60.0, 177.0, -209.0, 31.0, 127.0, -103.0, -237.0, -298.0, 292.0, 103.0, -122.0, 77.0, -138.0, -345.0, -1.0, -30.0, 57.0, 141.0, -69.0, -18.0, 44.0, -268.0, 26.0, -48.0, -54.0, 23.0, -352.0, -66.0, 0.0, -95.0, -57.0, 0.0, -303.0, -238.0, 0.0, -75.0, -134.0, 58.0, -221.0, -270.0, -127.0, -118.0, 1.0, -31.0, 30.0, 30.0, -78.0, 36.0, 55.0, -100.0, -66.0, 111.0, -58.0, -21.0, -182.0, 137.0, 49.0, 61.0, -64.0, -219.0, -149.0, 19.0, -192.0, -344.0, 71.0, -92.0, 47.0, 79.0, 0.0, 27.0, 103.0, -92.0, -275.0, -214.0, -346.0, 41.0, -11.0, 83.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [20.0, -223.0, 48.0, 0.0, 0.0, -6.0, -24.0, 9.0, 33.0, 78.0, -239.0, -41.0, -26.0, -312.0, -14.0, 144.0, 0.0, 43.0, -35.0, 0.0, 6.0, -118.0, -74.0, -26.0, -20.0, -53.0, 0.0, -14.0, -187.0, 123.0, 45.0, -350.0, 40.0, 0.0, 0.0, -11.0, -34.0, -400.0, -15.0, -132.0, 0.0, -246.0, -181.0, -75.0, 0.0, -46.0, -45.0, 89.0, -301.0, -219.0, -158.0, 19.0, 12.0, 105.0, 0.0, -400.0, -233.0, -185.0, -360.0, -229.0, 142.0, 134.0, 51.0, -11.0, 7.0, -376.0, 0.0, 49.0, -321.0, 0.0, -350.0, -269.0, 0.0, -2.0, 0.0, -70.0, -63.0, 17.0, -40.0, 95.0, -63.0, -174.0, -18.0, -99.0, 8.0, 0.0, -136.0, -302.0, -72.0, 0.0, 0.0, -395.0, -128.0, -155.0, -178.0, 56.0, -346.0, -373.0, 0.0, -251.0, 0.0, 0.0, -8.0, -332.0, -158.0, -23.0, 0.0, 0.0, -392.0, -180.0, -200.0, -142.0, 0.0, 0.0, -141.0, -109.0, -400.0, -95.0, 0.0, -136.0, -169.0, -364.0, -311.0, -254.0, -373.0, 0.0, -103.0, -198.0, -213.0, 0.0, 0.0, -150.0, -90.0, 41.0, -345.0, 94.0, -6.0, -280.0, 9.0, 0.0, 50.0, 0.0, -142.0, -201.0, -348.0, 0.0, 47.0, 20.0, -138.0, -61.0, 40.0, -169.0, -398.0, 0.0, 52.0, 16.0, 49.0, 0.0, 69.0, -50.0, -360.0, 33.0, -182.0, -337.0, -123.0, -281.0, -185.0, 57.0, -95.0, -328.0, -321.0, -286.0, 21.0, -112.0, -289.0, -114.0, 120.0, -309.0, 0.0, 32.0, -206.0, 0.0, 49.0, -215.0, 44.0, -99.0, -386.0, -66.0, -362.0, -167.0, -188.0, -280.0, -376.0, -353.0, -332.0, 85.0, -6.0, -216.0, -113.0, 22.0], "policy_predator_policy_reward": [131.0, 0.0, 31.0, 15.0, 30.0, 15.0, 58.0, 64.0, 15.0, 55.0, 113.0, 103.0, 157.0, 85.0, 7.0, 11.0, 0.0, 17.0, 0.0, 27.0, 88.0, 0.0, 36.0, 95.0, 81.0, 13.0, 0.0, 18.0, 66.0, 92.0, 167.0, 19.0, 36.0, 5.0, 14.0, 54.0, 83.0, 197.0, 124.0, 18.0, 96.0, 54.0, 106.0, 54.0, 57.0, 49.0, 67.0, 66.0, 148.0, 163.0, 56.0, 114.0, 9.0, 1.0, 97.0, 200.0, 13.0, 168.0, 111.0, 180.0, 5.0, 11.0, 48.0, 15.0, 53.0, 194.0, 28.0, 0.0, 167.0, 16.0, 182.0, 92.0, 1.0, 0.0, 13.0, 27.0, 79.0, 24.0, 46.0, 40.0, 75.0, 93.0, 23.0, 76.0, 6.0, 30.0, 0.0, 170.0, 30.0, 68.0, 194.0, 153.0, 170.0, 59.0, 107.0, 38.0, 199.0, 168.0, 50.0, 135.0, 0.0, 0.0, 167.0, 78.0, 93.0, 31.0, 0.0, 0.0, 84.0, 185.0, 104.0, 0.0, 0.0, 0.0, 81.0, 94.0, 165.0, 196.0, 83.0, 111.0, 124.0, 188.0, 145.0, 150.0, 129.0, 117.0, 112.0, 71.0, 83.0, 131.0, 108.0, 11.0, 4.0, 75.0, 178.0, 103.0, 112.0, 96.0, 11.0, 16.0, 5.0, 0.0, 154.0, 89.0, 116.0, 166.0, 38.0, 6.0, 111.0, 30.0, 6.0, 102.0, 17.0, 199.0, 51.0, 18.0, 0.0, 0.0, 0.0, 42.0, 81.0, 182.0, 115.0, 185.0, 156.0, 99.0, 118.0, 29.0, 149.0, 82.0, 121.0, 142.0, 92.0, 70.0, 149.0, 162.0, 109.0, 127.0, 13.0, 34.0, 131.0, 75.0, 90.0, 103.0, 89.0, 69.0, 169.0, 191.0, 184.0, 70.0, 139.0, 115.0, 192.0, 191.0, 110.0, 178.0, 125.0, 86.0, 111.0, 63.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.03932378367576, "mean_inference_ms": 3.268168685830415, "mean_action_processing_ms": 0.4671721188103453, "mean_env_wait_ms": 0.3722344713125535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014965534210205078, "StateBufferConnector_ms": 0.007291913032531738, "ViewRequirementAgentConnector_ms": 0.16337907314300537}, "num_episodes": 22, "episode_return_max": 292.0, "episode_return_min": -352.0, "episode_return_mean": -41.51, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.74919052238334, "num_env_steps_trained_throughput_per_sec": 300.74919052238334, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 13480.138, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13480.09, "sample_time_ms": 2269.073, "learn_time_ms": 11189.946, "learn_throughput": 357.464, "synch_weights_time_ms": 17.735}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "e1352_00002", "date": "2024-08-13_19-40-01", "timestamp": 1723592401, "time_this_iter_s": 13.320577144622803, "time_total_s": 2291.001345872879, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d411f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2291.001345872879, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 62.821052631578944, "ram_util_percent": 78.10526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1793848689113346, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 0.00010000000000000003, "total_loss": 7.818830998738607, "policy_loss": -0.002200430594557137, "vf_loss": 7.820763882127388, "vf_explained_var": -0.012855859565987159, "kl": 0.008907880305778085, "entropy": 0.9424785119200509, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48.757773014824224, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 8.790262649929712, "policy_loss": -0.000503162207899901, "vf_loss": 8.79075398369441, "vf_explained_var": -0.4293181201137563, "kl": 0.00944379209925085, "entropy": 0.7919349842916721, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 292.0, "episode_reward_min": -405.0, "episode_reward_mean": -46.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -109.44, "predator_policy": 86.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154.0, -5.0, -96.0, -96.0, 60.0, 177.0, -209.0, 31.0, 127.0, -103.0, -237.0, -298.0, 292.0, 103.0, -122.0, 77.0, -138.0, -345.0, -1.0, -30.0, 57.0, 141.0, -69.0, -18.0, 44.0, -268.0, 26.0, -48.0, -54.0, 23.0, -352.0, -66.0, 0.0, -95.0, -57.0, 0.0, -303.0, -238.0, 0.0, -75.0, -134.0, 58.0, -221.0, -270.0, -127.0, -118.0, 1.0, -31.0, 30.0, 30.0, -78.0, 36.0, 55.0, -100.0, -66.0, 111.0, -58.0, -21.0, -182.0, 137.0, 49.0, 61.0, -64.0, -219.0, -149.0, 19.0, -192.0, -344.0, 71.0, -92.0, 47.0, 79.0, 0.0, 27.0, 103.0, -92.0, -275.0, -214.0, -346.0, 41.0, -11.0, 83.0, -58.0, 203.0, 238.0, -32.0, -47.0, 114.0, 214.0, -405.0, 0.0, 234.0, 0.0, 31.0, -114.0, 97.0, -40.0, -189.0, 7.0, -191.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-34.0, -400.0, -15.0, -132.0, 0.0, -246.0, -181.0, -75.0, 0.0, -46.0, -45.0, 89.0, -301.0, -219.0, -158.0, 19.0, 12.0, 105.0, 0.0, -400.0, -233.0, -185.0, -360.0, -229.0, 142.0, 134.0, 51.0, -11.0, 7.0, -376.0, 0.0, 49.0, -321.0, 0.0, -350.0, -269.0, 0.0, -2.0, 0.0, -70.0, -63.0, 17.0, -40.0, 95.0, -63.0, -174.0, -18.0, -99.0, 8.0, 0.0, -136.0, -302.0, -72.0, 0.0, 0.0, -395.0, -128.0, -155.0, -178.0, 56.0, -346.0, -373.0, 0.0, -251.0, 0.0, 0.0, -8.0, -332.0, -158.0, -23.0, 0.0, 0.0, -392.0, -180.0, -200.0, -142.0, 0.0, 0.0, -141.0, -109.0, -400.0, -95.0, 0.0, -136.0, -169.0, -364.0, -311.0, -254.0, -373.0, 0.0, -103.0, -198.0, -213.0, 0.0, 0.0, -150.0, -90.0, 41.0, -345.0, 94.0, -6.0, -280.0, 9.0, 0.0, 50.0, 0.0, -142.0, -201.0, -348.0, 0.0, 47.0, 20.0, -138.0, -61.0, 40.0, -169.0, -398.0, 0.0, 52.0, 16.0, 49.0, 0.0, 69.0, -50.0, -360.0, 33.0, -182.0, -337.0, -123.0, -281.0, -185.0, 57.0, -95.0, -328.0, -321.0, -286.0, 21.0, -112.0, -289.0, -114.0, 120.0, -309.0, 0.0, 32.0, -206.0, 0.0, 49.0, -215.0, 44.0, -99.0, -386.0, -66.0, -362.0, -167.0, -188.0, -280.0, -376.0, -353.0, -332.0, 85.0, -6.0, -216.0, -113.0, 22.0, 0.0, -366.0, 137.0, -135.0, 198.0, 33.0, -30.0, -385.0, -218.0, 7.0, -42.0, 128.0, 55.0, 91.0, -379.0, -343.0, 0.0, 0.0, 14.0, 74.0, 0.0, 0.0, -8.0, -148.0, -208.0, -156.0, 2.0, -14.0, -170.0, 3.0, -154.0, -162.0, 99.0, -250.0, -165.0, -313.0], "policy_predator_policy_reward": [83.0, 197.0, 124.0, 18.0, 96.0, 54.0, 106.0, 54.0, 57.0, 49.0, 67.0, 66.0, 148.0, 163.0, 56.0, 114.0, 9.0, 1.0, 97.0, 200.0, 13.0, 168.0, 111.0, 180.0, 5.0, 11.0, 48.0, 15.0, 53.0, 194.0, 28.0, 0.0, 167.0, 16.0, 182.0, 92.0, 1.0, 0.0, 13.0, 27.0, 79.0, 24.0, 46.0, 40.0, 75.0, 93.0, 23.0, 76.0, 6.0, 30.0, 0.0, 170.0, 30.0, 68.0, 194.0, 153.0, 170.0, 59.0, 107.0, 38.0, 199.0, 168.0, 50.0, 135.0, 0.0, 0.0, 167.0, 78.0, 93.0, 31.0, 0.0, 0.0, 84.0, 185.0, 104.0, 0.0, 0.0, 0.0, 81.0, 94.0, 165.0, 196.0, 83.0, 111.0, 124.0, 188.0, 145.0, 150.0, 129.0, 117.0, 112.0, 71.0, 83.0, 131.0, 108.0, 11.0, 4.0, 75.0, 178.0, 103.0, 112.0, 96.0, 11.0, 16.0, 5.0, 0.0, 154.0, 89.0, 116.0, 166.0, 38.0, 6.0, 111.0, 30.0, 6.0, 102.0, 17.0, 199.0, 51.0, 18.0, 0.0, 0.0, 0.0, 42.0, 81.0, 182.0, 115.0, 185.0, 156.0, 99.0, 118.0, 29.0, 149.0, 82.0, 121.0, 142.0, 92.0, 70.0, 149.0, 162.0, 109.0, 127.0, 13.0, 34.0, 131.0, 75.0, 90.0, 103.0, 89.0, 69.0, 169.0, 191.0, 184.0, 70.0, 139.0, 115.0, 192.0, 191.0, 110.0, 178.0, 125.0, 86.0, 111.0, 63.0, 181.0, 127.0, 91.0, 110.0, 0.0, 7.0, 194.0, 189.0, 45.0, 119.0, 7.0, 21.0, 37.0, 31.0, 193.0, 124.0, 0.0, 0.0, 78.0, 68.0, 0.0, 0.0, 118.0, 69.0, 142.0, 108.0, 78.0, 31.0, 97.0, 30.0, 48.0, 79.0, 148.0, 10.0, 116.0, 171.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0384139973978956, "mean_inference_ms": 3.2671791896589673, "mean_action_processing_ms": 0.4663013993551516, "mean_env_wait_ms": 0.3718862051822828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014536619186401367, "StateBufferConnector_ms": 0.0062713623046875, "ViewRequirementAgentConnector_ms": 0.1568131446838379}, "num_episodes": 18, "episode_return_max": 292.0, "episode_return_min": -405.0, "episode_return_mean": -46.23, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.80415394398204, "num_env_steps_trained_throughput_per_sec": 310.80415394398204, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 13370.314, "restore_workers_time_ms": 0.018, "training_step_time_ms": 13370.253, "sample_time_ms": 2263.329, "learn_time_ms": 11086.347, "learn_throughput": 360.804, "synch_weights_time_ms": 18.008}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "e1352_00002", "date": "2024-08-13_19-40-14", "timestamp": 1723592414, "time_this_iter_s": 12.914543867111206, "time_total_s": 2303.9158897399902, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d13160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2303.9158897399902, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 63.15263157894737, "ram_util_percent": 77.33157894736841}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5869762853261022, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 0.00010000000000000003, "total_loss": 7.946607182770179, "policy_loss": -0.002892316244887533, "vf_loss": 7.949209155733623, "vf_explained_var": -0.002381674196354296, "kl": 0.009666943027544235, "entropy": 0.847311246615869, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 58.32646384822628, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 8.202222657077527, "policy_loss": -0.0025372818408031313, "vf_loss": 8.20474143179636, "vf_explained_var": -0.5541715525445484, "kl": 0.014781396971993955, "entropy": 0.8302067633974489, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 238.0, "episode_reward_min": -405.0, "episode_reward_mean": -39.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -108.755, "predator_policy": 89.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.0, 44.0, -268.0, 26.0, -48.0, -54.0, 23.0, -352.0, -66.0, 0.0, -95.0, -57.0, 0.0, -303.0, -238.0, 0.0, -75.0, -134.0, 58.0, -221.0, -270.0, -127.0, -118.0, 1.0, -31.0, 30.0, 30.0, -78.0, 36.0, 55.0, -100.0, -66.0, 111.0, -58.0, -21.0, -182.0, 137.0, 49.0, 61.0, -64.0, -219.0, -149.0, 19.0, -192.0, -344.0, 71.0, -92.0, 47.0, 79.0, 0.0, 27.0, 103.0, -92.0, -275.0, -214.0, -346.0, 41.0, -11.0, 83.0, -58.0, 203.0, 238.0, -32.0, -47.0, 114.0, 214.0, -405.0, 0.0, 234.0, 0.0, 31.0, -114.0, 97.0, -40.0, -189.0, 7.0, -191.0, -25.0, 8.0, -125.0, 48.0, 14.0, 14.0, 100.0, 6.0, -205.0, 6.0, 213.0, 27.0, 111.0, 92.0, 0.0, -104.0, -20.0, -33.0, -80.0, -71.0, -30.0, -293.0, 206.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.0, -99.0, 8.0, 0.0, -136.0, -302.0, -72.0, 0.0, 0.0, -395.0, -128.0, -155.0, -178.0, 56.0, -346.0, -373.0, 0.0, -251.0, 0.0, 0.0, -8.0, -332.0, -158.0, -23.0, 0.0, 0.0, -392.0, -180.0, -200.0, -142.0, 0.0, 0.0, -141.0, -109.0, -400.0, -95.0, 0.0, -136.0, -169.0, -364.0, -311.0, -254.0, -373.0, 0.0, -103.0, -198.0, -213.0, 0.0, 0.0, -150.0, -90.0, 41.0, -345.0, 94.0, -6.0, -280.0, 9.0, 0.0, 50.0, 0.0, -142.0, -201.0, -348.0, 0.0, 47.0, 20.0, -138.0, -61.0, 40.0, -169.0, -398.0, 0.0, 52.0, 16.0, 49.0, 0.0, 69.0, -50.0, -360.0, 33.0, -182.0, -337.0, -123.0, -281.0, -185.0, 57.0, -95.0, -328.0, -321.0, -286.0, 21.0, -112.0, -289.0, -114.0, 120.0, -309.0, 0.0, 32.0, -206.0, 0.0, 49.0, -215.0, 44.0, -99.0, -386.0, -66.0, -362.0, -167.0, -188.0, -280.0, -376.0, -353.0, -332.0, 85.0, -6.0, -216.0, -113.0, 22.0, 0.0, -366.0, 137.0, -135.0, 198.0, 33.0, -30.0, -385.0, -218.0, 7.0, -42.0, 128.0, 55.0, 91.0, -379.0, -343.0, 0.0, 0.0, 14.0, 74.0, 0.0, 0.0, -8.0, -148.0, -208.0, -156.0, 2.0, -14.0, -170.0, 3.0, -154.0, -162.0, 99.0, -250.0, -165.0, -313.0, -245.0, 0.0, 4.0, -2.0, -228.0, -180.0, -25.0, -6.0, 11.0, -59.0, -129.0, 0.0, -26.0, 27.0, -229.0, 2.0, -250.0, -110.0, 31.0, -232.0, 72.0, 93.0, -68.0, -36.0, 0.0, 83.0, 43.0, -136.0, -343.0, 121.0, -277.0, 0.0, -397.0, 0.0, -252.0, 0.0, 0.0, -373.0, -38.0, -333.0, -72.0, -185.0, -276.0, -298.0, 109.0, 68.0], "policy_predator_policy_reward": [23.0, 76.0, 6.0, 30.0, 0.0, 170.0, 30.0, 68.0, 194.0, 153.0, 170.0, 59.0, 107.0, 38.0, 199.0, 168.0, 50.0, 135.0, 0.0, 0.0, 167.0, 78.0, 93.0, 31.0, 0.0, 0.0, 84.0, 185.0, 104.0, 0.0, 0.0, 0.0, 81.0, 94.0, 165.0, 196.0, 83.0, 111.0, 124.0, 188.0, 145.0, 150.0, 129.0, 117.0, 112.0, 71.0, 83.0, 131.0, 108.0, 11.0, 4.0, 75.0, 178.0, 103.0, 112.0, 96.0, 11.0, 16.0, 5.0, 0.0, 154.0, 89.0, 116.0, 166.0, 38.0, 6.0, 111.0, 30.0, 6.0, 102.0, 17.0, 199.0, 51.0, 18.0, 0.0, 0.0, 0.0, 42.0, 81.0, 182.0, 115.0, 185.0, 156.0, 99.0, 118.0, 29.0, 149.0, 82.0, 121.0, 142.0, 92.0, 70.0, 149.0, 162.0, 109.0, 127.0, 13.0, 34.0, 131.0, 75.0, 90.0, 103.0, 89.0, 69.0, 169.0, 191.0, 184.0, 70.0, 139.0, 115.0, 192.0, 191.0, 110.0, 178.0, 125.0, 86.0, 111.0, 63.0, 181.0, 127.0, 91.0, 110.0, 0.0, 7.0, 194.0, 189.0, 45.0, 119.0, 7.0, 21.0, 37.0, 31.0, 193.0, 124.0, 0.0, 0.0, 78.0, 68.0, 0.0, 0.0, 118.0, 69.0, 142.0, 108.0, 78.0, 31.0, 97.0, 30.0, 48.0, 79.0, 148.0, 10.0, 116.0, 171.0, 100.0, 120.0, 6.0, 0.0, 172.0, 111.0, 59.0, 20.0, 55.0, 7.0, 106.0, 37.0, 72.0, 27.0, 110.0, 123.0, 130.0, 25.0, 145.0, 62.0, 33.0, 15.0, 122.0, 9.0, 2.0, 26.0, 145.0, 40.0, 181.0, 41.0, 159.0, 14.0, 187.0, 190.0, 122.0, 97.0, 163.0, 130.0, 145.0, 155.0, 125.0, 102.0, 192.0, 89.0, 0.0, 29.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0368922353500027, "mean_inference_ms": 3.2633830579990315, "mean_action_processing_ms": 0.4649908118589412, "mean_env_wait_ms": 0.3712622782789133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010301470756530762, "StateBufferConnector_ms": 0.0066950321197509766, "ViewRequirementAgentConnector_ms": 0.15220820903778076}, "num_episodes": 23, "episode_return_max": 238.0, "episode_return_min": -405.0, "episode_return_mean": -39.26, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 338.95690421595583, "num_env_steps_trained_throughput_per_sec": 338.95690421595583, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 12951.525, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12951.465, "sample_time_ms": 2083.827, "learn_time_ms": 10846.011, "learn_throughput": 368.799, "synch_weights_time_ms": 18.946}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "e1352_00002", "date": "2024-08-13_19-40-26", "timestamp": 1723592426, "time_this_iter_s": 11.863684177398682, "time_total_s": 2315.779573917389, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2cf5550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2315.779573917389, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 60.11875, "ram_util_percent": 79.4875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.758061376765922, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 0.00010000000000000003, "total_loss": 7.605690498705264, "policy_loss": -0.003291686866358514, "vf_loss": 7.60864400787959, "vf_explained_var": -0.008860461074839194, "kl": 0.01125934746896121, "entropy": 0.8814388429046308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 51.14365299668892, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 8.32472718607181, "policy_loss": -0.0019886898391796325, "vf_loss": 8.326697937647502, "vf_explained_var": -0.08578845833344434, "kl": 0.014336731810251193, "entropy": 0.8077722826962749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 238.0, "episode_reward_min": -405.0, "episode_reward_mean": -20.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -398.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -100.785, "predator_policy": 90.29}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.0, -221.0, -270.0, -127.0, -118.0, 1.0, -31.0, 30.0, 30.0, -78.0, 36.0, 55.0, -100.0, -66.0, 111.0, -58.0, -21.0, -182.0, 137.0, 49.0, 61.0, -64.0, -219.0, -149.0, 19.0, -192.0, -344.0, 71.0, -92.0, 47.0, 79.0, 0.0, 27.0, 103.0, -92.0, -275.0, -214.0, -346.0, 41.0, -11.0, 83.0, -58.0, 203.0, 238.0, -32.0, -47.0, 114.0, 214.0, -405.0, 0.0, 234.0, 0.0, 31.0, -114.0, 97.0, -40.0, -189.0, 7.0, -191.0, -25.0, 8.0, -125.0, 48.0, 14.0, 14.0, 100.0, 6.0, -205.0, 6.0, 213.0, 27.0, 111.0, 92.0, 0.0, -104.0, -20.0, -33.0, -80.0, -71.0, -30.0, -293.0, 206.0, 6.0, -55.0, 8.0, -70.0, 13.0, 163.0, 8.0, 20.0, -213.0, 68.0, 86.0, -40.0, 71.0, -117.0, 232.0, -8.0, 136.0, -96.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -136.0, -169.0, -364.0, -311.0, -254.0, -373.0, 0.0, -103.0, -198.0, -213.0, 0.0, 0.0, -150.0, -90.0, 41.0, -345.0, 94.0, -6.0, -280.0, 9.0, 0.0, 50.0, 0.0, -142.0, -201.0, -348.0, 0.0, 47.0, 20.0, -138.0, -61.0, 40.0, -169.0, -398.0, 0.0, 52.0, 16.0, 49.0, 0.0, 69.0, -50.0, -360.0, 33.0, -182.0, -337.0, -123.0, -281.0, -185.0, 57.0, -95.0, -328.0, -321.0, -286.0, 21.0, -112.0, -289.0, -114.0, 120.0, -309.0, 0.0, 32.0, -206.0, 0.0, 49.0, -215.0, 44.0, -99.0, -386.0, -66.0, -362.0, -167.0, -188.0, -280.0, -376.0, -353.0, -332.0, 85.0, -6.0, -216.0, -113.0, 22.0, 0.0, -366.0, 137.0, -135.0, 198.0, 33.0, -30.0, -385.0, -218.0, 7.0, -42.0, 128.0, 55.0, 91.0, -379.0, -343.0, 0.0, 0.0, 14.0, 74.0, 0.0, 0.0, -8.0, -148.0, -208.0, -156.0, 2.0, -14.0, -170.0, 3.0, -154.0, -162.0, 99.0, -250.0, -165.0, -313.0, -245.0, 0.0, 4.0, -2.0, -228.0, -180.0, -25.0, -6.0, 11.0, -59.0, -129.0, 0.0, -26.0, 27.0, -229.0, 2.0, -250.0, -110.0, 31.0, -232.0, 72.0, 93.0, -68.0, -36.0, 0.0, 83.0, 43.0, -136.0, -343.0, 121.0, -277.0, 0.0, -397.0, 0.0, -252.0, 0.0, 0.0, -373.0, -38.0, -333.0, -72.0, -185.0, -276.0, -298.0, 109.0, 68.0, -334.0, -15.0, -13.0, -250.0, 27.0, -271.0, -79.0, -74.0, -80.0, -232.0, 16.0, 65.0, 0.0, -273.0, -10.0, -1.0, -295.0, -250.0, 34.0, 0.0, -66.0, 89.0, 0.0, -259.0, 64.0, -349.0, -154.0, -198.0, 97.0, 67.0, -16.0, 0.0, -48.0, 128.0, -115.0, -180.0], "policy_predator_policy_reward": [83.0, 111.0, 124.0, 188.0, 145.0, 150.0, 129.0, 117.0, 112.0, 71.0, 83.0, 131.0, 108.0, 11.0, 4.0, 75.0, 178.0, 103.0, 112.0, 96.0, 11.0, 16.0, 5.0, 0.0, 154.0, 89.0, 116.0, 166.0, 38.0, 6.0, 111.0, 30.0, 6.0, 102.0, 17.0, 199.0, 51.0, 18.0, 0.0, 0.0, 0.0, 42.0, 81.0, 182.0, 115.0, 185.0, 156.0, 99.0, 118.0, 29.0, 149.0, 82.0, 121.0, 142.0, 92.0, 70.0, 149.0, 162.0, 109.0, 127.0, 13.0, 34.0, 131.0, 75.0, 90.0, 103.0, 89.0, 69.0, 169.0, 191.0, 184.0, 70.0, 139.0, 115.0, 192.0, 191.0, 110.0, 178.0, 125.0, 86.0, 111.0, 63.0, 181.0, 127.0, 91.0, 110.0, 0.0, 7.0, 194.0, 189.0, 45.0, 119.0, 7.0, 21.0, 37.0, 31.0, 193.0, 124.0, 0.0, 0.0, 78.0, 68.0, 0.0, 0.0, 118.0, 69.0, 142.0, 108.0, 78.0, 31.0, 97.0, 30.0, 48.0, 79.0, 148.0, 10.0, 116.0, 171.0, 100.0, 120.0, 6.0, 0.0, 172.0, 111.0, 59.0, 20.0, 55.0, 7.0, 106.0, 37.0, 72.0, 27.0, 110.0, 123.0, 130.0, 25.0, 145.0, 62.0, 33.0, 15.0, 122.0, 9.0, 2.0, 26.0, 145.0, 40.0, 181.0, 41.0, 159.0, 14.0, 187.0, 190.0, 122.0, 97.0, 163.0, 130.0, 145.0, 155.0, 125.0, 102.0, 192.0, 89.0, 0.0, 29.0, 167.0, 188.0, 179.0, 29.0, 142.0, 110.0, 25.0, 58.0, 154.0, 171.0, 27.0, 55.0, 150.0, 131.0, 25.0, 6.0, 173.0, 159.0, 34.0, 0.0, 31.0, 32.0, 136.0, 83.0, 177.0, 179.0, 67.0, 168.0, 31.0, 37.0, 4.0, 4.0, 47.0, 9.0, 155.0, 44.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.034599368439555, "mean_inference_ms": 3.2572041288993216, "mean_action_processing_ms": 0.4636937891094553, "mean_env_wait_ms": 0.3704080764423854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00996696949005127, "StateBufferConnector_ms": 0.004891395568847656, "ViewRequirementAgentConnector_ms": 0.14156055450439453}, "num_episodes": 18, "episode_return_max": 238.0, "episode_return_min": -405.0, "episode_return_mean": -20.99, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.3914519180217, "num_env_steps_trained_throughput_per_sec": 275.3914519180217, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 13212.102, "restore_workers_time_ms": 0.018, "training_step_time_ms": 13212.041, "sample_time_ms": 2129.519, "learn_time_ms": 11060.176, "learn_throughput": 361.658, "synch_weights_time_ms": 19.721}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "e1352_00002", "date": "2024-08-13_19-40-41", "timestamp": 1723592441, "time_this_iter_s": 14.575043678283691, "time_total_s": 2330.3546175956726, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b8c1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2330.3546175956726, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 74.4857142857143, "ram_util_percent": 80.60952380952381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.342371056556071, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 0.00010000000000000003, "total_loss": 5.5720331749588095, "policy_loss": -0.003045910930571457, "vf_loss": 5.574726632032445, "vf_explained_var": 0.00716274721281869, "kl": 0.011734910126104774, "entropy": 0.8974439489463019, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 59.1616291187743, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 7.903900648803307, "policy_loss": -0.00399650787545378, "vf_loss": 7.907875205852367, "vf_explained_var": 0.22216629010659678, "kl": 0.017542771101360644, "entropy": 0.7782559885234429, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 292.0, "episode_reward_min": -405.0, "episode_reward_mean": 8.43, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -397.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": -79.93, "predator_policy": 84.145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-219.0, -149.0, 19.0, -192.0, -344.0, 71.0, -92.0, 47.0, 79.0, 0.0, 27.0, 103.0, -92.0, -275.0, -214.0, -346.0, 41.0, -11.0, 83.0, -58.0, 203.0, 238.0, -32.0, -47.0, 114.0, 214.0, -405.0, 0.0, 234.0, 0.0, 31.0, -114.0, 97.0, -40.0, -189.0, 7.0, -191.0, -25.0, 8.0, -125.0, 48.0, 14.0, 14.0, 100.0, 6.0, -205.0, 6.0, 213.0, 27.0, 111.0, 92.0, 0.0, -104.0, -20.0, -33.0, -80.0, -71.0, -30.0, -293.0, 206.0, 6.0, -55.0, 8.0, -70.0, 13.0, 163.0, 8.0, 20.0, -213.0, 68.0, 86.0, -40.0, 71.0, -117.0, 232.0, -8.0, 136.0, -96.0, 159.0, -50.0, 36.0, 165.0, 96.0, 292.0, 140.0, -39.0, 102.0, 172.0, 98.0, 79.0, -62.0, 15.0, 236.0, 152.0, 170.0, 108.0, 49.0, 40.0, 52.0, 164.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-182.0, -337.0, -123.0, -281.0, -185.0, 57.0, -95.0, -328.0, -321.0, -286.0, 21.0, -112.0, -289.0, -114.0, 120.0, -309.0, 0.0, 32.0, -206.0, 0.0, 49.0, -215.0, 44.0, -99.0, -386.0, -66.0, -362.0, -167.0, -188.0, -280.0, -376.0, -353.0, -332.0, 85.0, -6.0, -216.0, -113.0, 22.0, 0.0, -366.0, 137.0, -135.0, 198.0, 33.0, -30.0, -385.0, -218.0, 7.0, -42.0, 128.0, 55.0, 91.0, -379.0, -343.0, 0.0, 0.0, 14.0, 74.0, 0.0, 0.0, -8.0, -148.0, -208.0, -156.0, 2.0, -14.0, -170.0, 3.0, -154.0, -162.0, 99.0, -250.0, -165.0, -313.0, -245.0, 0.0, 4.0, -2.0, -228.0, -180.0, -25.0, -6.0, 11.0, -59.0, -129.0, 0.0, -26.0, 27.0, -229.0, 2.0, -250.0, -110.0, 31.0, -232.0, 72.0, 93.0, -68.0, -36.0, 0.0, 83.0, 43.0, -136.0, -343.0, 121.0, -277.0, 0.0, -397.0, 0.0, -252.0, 0.0, 0.0, -373.0, -38.0, -333.0, -72.0, -185.0, -276.0, -298.0, 109.0, 68.0, -334.0, -15.0, -13.0, -250.0, 27.0, -271.0, -79.0, -74.0, -80.0, -232.0, 16.0, 65.0, 0.0, -273.0, -10.0, -1.0, -295.0, -250.0, 34.0, 0.0, -66.0, 89.0, 0.0, -259.0, 64.0, -349.0, -154.0, -198.0, 97.0, 67.0, -16.0, 0.0, -48.0, 128.0, -115.0, -180.0, 11.0, 71.0, -151.0, -16.0, 0.0, -44.0, 183.0, -306.0, 66.0, -34.0, 106.0, 140.0, 33.0, 58.0, -10.0, -140.0, 9.0, 0.0, 173.0, -153.0, 82.0, -79.0, -21.0, 36.0, -170.0, -143.0, -52.0, -70.0, 26.0, 146.0, 28.0, 48.0, 78.0, 83.0, -117.0, 38.0, 16.0, -139.0, 53.0, -28.0, -108.0, 59.0, -82.0, 152.0], "policy_predator_policy_reward": [115.0, 185.0, 156.0, 99.0, 118.0, 29.0, 149.0, 82.0, 121.0, 142.0, 92.0, 70.0, 149.0, 162.0, 109.0, 127.0, 13.0, 34.0, 131.0, 75.0, 90.0, 103.0, 89.0, 69.0, 169.0, 191.0, 184.0, 70.0, 139.0, 115.0, 192.0, 191.0, 110.0, 178.0, 125.0, 86.0, 111.0, 63.0, 181.0, 127.0, 91.0, 110.0, 0.0, 7.0, 194.0, 189.0, 45.0, 119.0, 7.0, 21.0, 37.0, 31.0, 193.0, 124.0, 0.0, 0.0, 78.0, 68.0, 0.0, 0.0, 118.0, 69.0, 142.0, 108.0, 78.0, 31.0, 97.0, 30.0, 48.0, 79.0, 148.0, 10.0, 116.0, 171.0, 100.0, 120.0, 6.0, 0.0, 172.0, 111.0, 59.0, 20.0, 55.0, 7.0, 106.0, 37.0, 72.0, 27.0, 110.0, 123.0, 130.0, 25.0, 145.0, 62.0, 33.0, 15.0, 122.0, 9.0, 2.0, 26.0, 145.0, 40.0, 181.0, 41.0, 159.0, 14.0, 187.0, 190.0, 122.0, 97.0, 163.0, 130.0, 145.0, 155.0, 125.0, 102.0, 192.0, 89.0, 0.0, 29.0, 167.0, 188.0, 179.0, 29.0, 142.0, 110.0, 25.0, 58.0, 154.0, 171.0, 27.0, 55.0, 150.0, 131.0, 25.0, 6.0, 173.0, 159.0, 34.0, 0.0, 31.0, 32.0, 136.0, 83.0, 177.0, 179.0, 67.0, 168.0, 31.0, 37.0, 4.0, 4.0, 47.0, 9.0, 155.0, 44.0, 23.0, 54.0, 17.0, 100.0, 0.0, 80.0, 134.0, 154.0, 28.0, 36.0, 20.0, 26.0, 19.0, 30.0, 41.0, 70.0, 52.0, 41.0, 117.0, 35.0, 63.0, 32.0, 63.0, 1.0, 94.0, 157.0, 98.0, 39.0, 64.0, 0.0, 68.0, 8.0, 5.0, 4.0, 97.0, 90.0, 94.0, 78.0, 14.0, 1.0, 20.0, 81.0, 0.0, 94.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0320899020499885, "mean_inference_ms": 3.2489631900216263, "mean_action_processing_ms": 0.46232757508292566, "mean_env_wait_ms": 0.3697402908901409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009328007698059082, "StateBufferConnector_ms": 0.0049741268157958984, "ViewRequirementAgentConnector_ms": 0.14525890350341797}, "num_episodes": 22, "episode_return_max": 292.0, "episode_return_min": -405.0, "episode_return_mean": 8.43, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.3424294627419, "num_env_steps_trained_throughput_per_sec": 326.3424294627419, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 13177.285, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13177.196, "sample_time_ms": 2138.386, "learn_time_ms": 11016.188, "learn_throughput": 363.102, "synch_weights_time_ms": 19.597}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "e1352_00002", "date": "2024-08-13_19-40-53", "timestamp": 1723592453, "time_this_iter_s": 12.314120292663574, "time_total_s": 2342.668737888336, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b8cd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2342.668737888336, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 62.166666666666664, "ram_util_percent": 80.41666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1395419149960158, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 0.00010000000000000003, "total_loss": 4.635654266170723, "policy_loss": -0.0016380013269741856, "vf_loss": 4.6371094904248675, "vf_explained_var": 0.006459932794015875, "kl": 0.006085613798957131, "entropy": 0.8833526858261653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 80.24778891997363, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 8.182447562142023, "policy_loss": -0.0048333622887237835, "vf_loss": 8.187253441886297, "vf_explained_var": 0.2294181541791038, "kl": 0.021968334695085013, "entropy": 0.8171125102610816, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 357.0, "episode_reward_min": -405.0, "episode_reward_mean": 37.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -397.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": -51.675, "predator_policy": 70.195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.0, -58.0, 203.0, 238.0, -32.0, -47.0, 114.0, 214.0, -405.0, 0.0, 234.0, 0.0, 31.0, -114.0, 97.0, -40.0, -189.0, 7.0, -191.0, -25.0, 8.0, -125.0, 48.0, 14.0, 14.0, 100.0, 6.0, -205.0, 6.0, 213.0, 27.0, 111.0, 92.0, 0.0, -104.0, -20.0, -33.0, -80.0, -71.0, -30.0, -293.0, 206.0, 6.0, -55.0, 8.0, -70.0, 13.0, 163.0, 8.0, 20.0, -213.0, 68.0, 86.0, -40.0, 71.0, -117.0, 232.0, -8.0, 136.0, -96.0, 159.0, -50.0, 36.0, 165.0, 96.0, 292.0, 140.0, -39.0, 102.0, 172.0, 98.0, 79.0, -62.0, 15.0, 236.0, 152.0, 170.0, 108.0, 49.0, 40.0, 52.0, 164.0, 75.0, -71.0, 148.0, -40.0, 75.0, -15.0, 123.0, 137.0, 107.0, 126.0, 28.0, 357.0, -81.0, 204.0, 98.0, 21.0, 42.0, -20.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-113.0, 22.0, 0.0, -366.0, 137.0, -135.0, 198.0, 33.0, -30.0, -385.0, -218.0, 7.0, -42.0, 128.0, 55.0, 91.0, -379.0, -343.0, 0.0, 0.0, 14.0, 74.0, 0.0, 0.0, -8.0, -148.0, -208.0, -156.0, 2.0, -14.0, -170.0, 3.0, -154.0, -162.0, 99.0, -250.0, -165.0, -313.0, -245.0, 0.0, 4.0, -2.0, -228.0, -180.0, -25.0, -6.0, 11.0, -59.0, -129.0, 0.0, -26.0, 27.0, -229.0, 2.0, -250.0, -110.0, 31.0, -232.0, 72.0, 93.0, -68.0, -36.0, 0.0, 83.0, 43.0, -136.0, -343.0, 121.0, -277.0, 0.0, -397.0, 0.0, -252.0, 0.0, 0.0, -373.0, -38.0, -333.0, -72.0, -185.0, -276.0, -298.0, 109.0, 68.0, -334.0, -15.0, -13.0, -250.0, 27.0, -271.0, -79.0, -74.0, -80.0, -232.0, 16.0, 65.0, 0.0, -273.0, -10.0, -1.0, -295.0, -250.0, 34.0, 0.0, -66.0, 89.0, 0.0, -259.0, 64.0, -349.0, -154.0, -198.0, 97.0, 67.0, -16.0, 0.0, -48.0, 128.0, -115.0, -180.0, 11.0, 71.0, -151.0, -16.0, 0.0, -44.0, 183.0, -306.0, 66.0, -34.0, 106.0, 140.0, 33.0, 58.0, -10.0, -140.0, 9.0, 0.0, 173.0, -153.0, 82.0, -79.0, -21.0, 36.0, -170.0, -143.0, -52.0, -70.0, 26.0, 146.0, 28.0, 48.0, 78.0, 83.0, -117.0, 38.0, 16.0, -139.0, 53.0, -28.0, -108.0, 59.0, -82.0, 152.0, -16.0, 0.0, -88.0, -32.0, 148.0, 0.0, -4.0, -238.0, -56.0, 97.0, -179.0, 44.0, -132.0, 92.0, 0.0, 101.0, 0.0, 68.0, 18.0, 66.0, -47.0, -154.0, 189.0, 158.0, -27.0, -116.0, 101.0, 68.0, 0.0, 47.0, 62.0, -178.0, -39.0, -5.0, -31.0, -72.0], "policy_predator_policy_reward": [111.0, 63.0, 181.0, 127.0, 91.0, 110.0, 0.0, 7.0, 194.0, 189.0, 45.0, 119.0, 7.0, 21.0, 37.0, 31.0, 193.0, 124.0, 0.0, 0.0, 78.0, 68.0, 0.0, 0.0, 118.0, 69.0, 142.0, 108.0, 78.0, 31.0, 97.0, 30.0, 48.0, 79.0, 148.0, 10.0, 116.0, 171.0, 100.0, 120.0, 6.0, 0.0, 172.0, 111.0, 59.0, 20.0, 55.0, 7.0, 106.0, 37.0, 72.0, 27.0, 110.0, 123.0, 130.0, 25.0, 145.0, 62.0, 33.0, 15.0, 122.0, 9.0, 2.0, 26.0, 145.0, 40.0, 181.0, 41.0, 159.0, 14.0, 187.0, 190.0, 122.0, 97.0, 163.0, 130.0, 145.0, 155.0, 125.0, 102.0, 192.0, 89.0, 0.0, 29.0, 167.0, 188.0, 179.0, 29.0, 142.0, 110.0, 25.0, 58.0, 154.0, 171.0, 27.0, 55.0, 150.0, 131.0, 25.0, 6.0, 173.0, 159.0, 34.0, 0.0, 31.0, 32.0, 136.0, 83.0, 177.0, 179.0, 67.0, 168.0, 31.0, 37.0, 4.0, 4.0, 47.0, 9.0, 155.0, 44.0, 23.0, 54.0, 17.0, 100.0, 0.0, 80.0, 134.0, 154.0, 28.0, 36.0, 20.0, 26.0, 19.0, 30.0, 41.0, 70.0, 52.0, 41.0, 117.0, 35.0, 63.0, 32.0, 63.0, 1.0, 94.0, 157.0, 98.0, 39.0, 64.0, 0.0, 68.0, 8.0, 5.0, 4.0, 97.0, 90.0, 94.0, 78.0, 14.0, 1.0, 20.0, 81.0, 0.0, 94.0, 25.0, 66.0, 45.0, 4.0, 0.0, 0.0, 132.0, 70.0, 12.0, 22.0, 9.0, 111.0, 63.0, 100.0, 33.0, 3.0, 13.0, 26.0, 27.0, 15.0, 105.0, 124.0, 10.0, 0.0, 60.0, 2.0, 33.0, 2.0, 50.0, 1.0, 80.0, 57.0, 12.0, 74.0, 43.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0306815529367745, "mean_inference_ms": 3.24697658480628, "mean_action_processing_ms": 0.46125950983758096, "mean_env_wait_ms": 0.3689333023034185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02626657485961914, "StateBufferConnector_ms": 0.004454135894775391, "ViewRequirementAgentConnector_ms": 0.13920819759368896}, "num_episodes": 18, "episode_return_max": 357.0, "episode_return_min": -405.0, "episode_return_mean": 37.04, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.0262736672117, "num_env_steps_trained_throughput_per_sec": 270.0262736672117, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 13429.672, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13429.581, "sample_time_ms": 2185.079, "learn_time_ms": 11219.889, "learn_throughput": 356.51, "synch_weights_time_ms": 21.207}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "e1352_00002", "date": "2024-08-13_19-41-08", "timestamp": 1723592468, "time_this_iter_s": 14.933330297470093, "time_total_s": 2357.6020681858063, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e68310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2357.6020681858063, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 65.82857142857144, "ram_util_percent": 81.05714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5703750718128746, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 0.00010000000000000003, "total_loss": 3.8835893678917457, "policy_loss": -0.0033965236798086493, "vf_loss": 3.886753565546066, "vf_explained_var": -0.003718295141502663, "kl": 0.007735535510796935, "entropy": 0.8427261034332255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 84.7155331530899, "cur_kl_coeff": 0.0018771171569824214, "cur_lr": 0.00010000000000000003, "total_loss": 7.650373169732473, "policy_loss": -0.0017059437600432565, "vf_loss": 7.6520556459981925, "vf_explained_var": 0.4464260858833474, "kl": 0.012504816582181125, "entropy": 0.8214746560999956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 357.0, "episode_reward_min": -293.0, "episode_reward_mean": 61.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -397.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -27.165, "predator_policy": 57.67}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0, 14.0, 100.0, 6.0, -205.0, 6.0, 213.0, 27.0, 111.0, 92.0, 0.0, -104.0, -20.0, -33.0, -80.0, -71.0, -30.0, -293.0, 206.0, 6.0, -55.0, 8.0, -70.0, 13.0, 163.0, 8.0, 20.0, -213.0, 68.0, 86.0, -40.0, 71.0, -117.0, 232.0, -8.0, 136.0, -96.0, 159.0, -50.0, 36.0, 165.0, 96.0, 292.0, 140.0, -39.0, 102.0, 172.0, 98.0, 79.0, -62.0, 15.0, 236.0, 152.0, 170.0, 108.0, 49.0, 40.0, 52.0, 164.0, 75.0, -71.0, 148.0, -40.0, 75.0, -15.0, 123.0, 137.0, 107.0, 126.0, 28.0, 357.0, -81.0, 204.0, 98.0, 21.0, 42.0, -20.0, -61.0, 150.0, 128.0, -3.0, 112.0, 89.0, 318.0, 98.0, 32.0, 242.0, 248.0, -81.0, 117.0, 35.0, 59.0, 47.0, 192.0, 284.0, 93.0, 60.0, 180.0, 131.0, -22.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [11.0, -59.0, -129.0, 0.0, -26.0, 27.0, -229.0, 2.0, -250.0, -110.0, 31.0, -232.0, 72.0, 93.0, -68.0, -36.0, 0.0, 83.0, 43.0, -136.0, -343.0, 121.0, -277.0, 0.0, -397.0, 0.0, -252.0, 0.0, 0.0, -373.0, -38.0, -333.0, -72.0, -185.0, -276.0, -298.0, 109.0, 68.0, -334.0, -15.0, -13.0, -250.0, 27.0, -271.0, -79.0, -74.0, -80.0, -232.0, 16.0, 65.0, 0.0, -273.0, -10.0, -1.0, -295.0, -250.0, 34.0, 0.0, -66.0, 89.0, 0.0, -259.0, 64.0, -349.0, -154.0, -198.0, 97.0, 67.0, -16.0, 0.0, -48.0, 128.0, -115.0, -180.0, 11.0, 71.0, -151.0, -16.0, 0.0, -44.0, 183.0, -306.0, 66.0, -34.0, 106.0, 140.0, 33.0, 58.0, -10.0, -140.0, 9.0, 0.0, 173.0, -153.0, 82.0, -79.0, -21.0, 36.0, -170.0, -143.0, -52.0, -70.0, 26.0, 146.0, 28.0, 48.0, 78.0, 83.0, -117.0, 38.0, 16.0, -139.0, 53.0, -28.0, -108.0, 59.0, -82.0, 152.0, -16.0, 0.0, -88.0, -32.0, 148.0, 0.0, -4.0, -238.0, -56.0, 97.0, -179.0, 44.0, -132.0, 92.0, 0.0, 101.0, 0.0, 68.0, 18.0, 66.0, -47.0, -154.0, 189.0, 158.0, -27.0, -116.0, 101.0, 68.0, 0.0, 47.0, 62.0, -178.0, -39.0, -5.0, -31.0, -72.0, 0.0, -154.0, 62.0, 55.0, 0.0, 88.0, -6.0, 0.0, -54.0, 116.0, 67.0, -4.0, 122.0, 181.0, 95.0, -6.0, -10.0, 0.0, 136.0, 79.0, 157.0, 84.0, -54.0, -56.0, 102.0, 0.0, -92.0, 81.0, -152.0, 20.0, 59.0, -52.0, 100.0, 62.0, 190.0, 79.0, 52.0, 0.0, -253.0, 136.0, 92.0, 88.0, 25.0, 45.0, -50.0, -106.0], "policy_predator_policy_reward": [55.0, 7.0, 106.0, 37.0, 72.0, 27.0, 110.0, 123.0, 130.0, 25.0, 145.0, 62.0, 33.0, 15.0, 122.0, 9.0, 2.0, 26.0, 145.0, 40.0, 181.0, 41.0, 159.0, 14.0, 187.0, 190.0, 122.0, 97.0, 163.0, 130.0, 145.0, 155.0, 125.0, 102.0, 192.0, 89.0, 0.0, 29.0, 167.0, 188.0, 179.0, 29.0, 142.0, 110.0, 25.0, 58.0, 154.0, 171.0, 27.0, 55.0, 150.0, 131.0, 25.0, 6.0, 173.0, 159.0, 34.0, 0.0, 31.0, 32.0, 136.0, 83.0, 177.0, 179.0, 67.0, 168.0, 31.0, 37.0, 4.0, 4.0, 47.0, 9.0, 155.0, 44.0, 23.0, 54.0, 17.0, 100.0, 0.0, 80.0, 134.0, 154.0, 28.0, 36.0, 20.0, 26.0, 19.0, 30.0, 41.0, 70.0, 52.0, 41.0, 117.0, 35.0, 63.0, 32.0, 63.0, 1.0, 94.0, 157.0, 98.0, 39.0, 64.0, 0.0, 68.0, 8.0, 5.0, 4.0, 97.0, 90.0, 94.0, 78.0, 14.0, 1.0, 20.0, 81.0, 0.0, 94.0, 25.0, 66.0, 45.0, 4.0, 0.0, 0.0, 132.0, 70.0, 12.0, 22.0, 9.0, 111.0, 63.0, 100.0, 33.0, 3.0, 13.0, 26.0, 27.0, 15.0, 105.0, 124.0, 10.0, 0.0, 60.0, 2.0, 33.0, 2.0, 50.0, 1.0, 80.0, 57.0, 12.0, 74.0, 43.0, 40.0, 74.0, 19.0, 33.0, 0.0, 28.0, 12.0, 0.0, 3.0, 41.0, 9.0, 3.0, 23.0, 4.0, 11.0, 9.0, 0.0, 6.0, 36.0, 26.0, 1.0, 7.0, 0.0, 19.0, 10.0, 0.0, 15.0, 12.0, 34.0, 119.0, 72.0, 23.0, 17.0, 7.0, 23.0, 0.0, 15.0, 0.0, 41.0, 46.0, 131.0, 0.0, 0.0, 42.0, 19.0, 100.0, 34.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.028121961159761, "mean_inference_ms": 3.247434944338812, "mean_action_processing_ms": 0.4603173620012628, "mean_env_wait_ms": 0.36846663628857135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025967121124267578, "StateBufferConnector_ms": 0.00541234016418457, "ViewRequirementAgentConnector_ms": 0.14200091361999512}, "num_episodes": 23, "episode_return_max": 357.0, "episode_return_min": -293.0, "episode_return_mean": 61.01, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.7261365115775, "num_env_steps_trained_throughput_per_sec": 301.7261365115775, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 13445.018, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13444.908, "sample_time_ms": 2189.322, "learn_time_ms": 11231.583, "learn_throughput": 356.139, "synch_weights_time_ms": 20.485}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": false, "training_iteration": 100, "trial_id": "e1352_00002", "date": "2024-08-13_19-41-21", "timestamp": 1723592481, "time_this_iter_s": 13.314929246902466, "time_total_s": 2370.9169974327087, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e22790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2370.9169974327087, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 63.4, "ram_util_percent": 83.58947368421052}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1383118367068983, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 0.00010000000000000003, "total_loss": 5.393114758799316, "policy_loss": -0.00396624473096044, "vf_loss": 5.396819977280955, "vf_explained_var": 0.0037199736587584967, "kl": 0.008691176132463528, "entropy": 0.809814739227295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 56.20761142934441, "cur_kl_coeff": 0.0018771171569824214, "cur_lr": 0.00010000000000000003, "total_loss": 7.716391963555068, "policy_loss": -0.000673589687646618, "vf_loss": 7.717035317294812, "vf_explained_var": 0.07661389371074696, "kl": 0.016109006267694494, "entropy": 0.7932772600461566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 1616000}, "env_runners": {"episode_reward_max": 357.0, "episode_reward_min": -466.0, "episode_reward_mean": 69.17, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -349.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": -15.89, "predator_policy": 50.475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [206.0, 6.0, -55.0, 8.0, -70.0, 13.0, 163.0, 8.0, 20.0, -213.0, 68.0, 86.0, -40.0, 71.0, -117.0, 232.0, -8.0, 136.0, -96.0, 159.0, -50.0, 36.0, 165.0, 96.0, 292.0, 140.0, -39.0, 102.0, 172.0, 98.0, 79.0, -62.0, 15.0, 236.0, 152.0, 170.0, 108.0, 49.0, 40.0, 52.0, 164.0, 75.0, -71.0, 148.0, -40.0, 75.0, -15.0, 123.0, 137.0, 107.0, 126.0, 28.0, 357.0, -81.0, 204.0, 98.0, 21.0, 42.0, -20.0, -61.0, 150.0, 128.0, -3.0, 112.0, 89.0, 318.0, 98.0, 32.0, 242.0, 248.0, -81.0, 117.0, 35.0, 59.0, 47.0, 192.0, 284.0, 93.0, 60.0, 180.0, 131.0, -22.0, 171.0, 80.0, 78.0, -18.0, -340.0, -466.0, 100.0, 301.0, -133.0, 75.0, 183.0, -43.0, 153.0, 141.0, 119.0, 61.0, -34.0, 135.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [109.0, 68.0, -334.0, -15.0, -13.0, -250.0, 27.0, -271.0, -79.0, -74.0, -80.0, -232.0, 16.0, 65.0, 0.0, -273.0, -10.0, -1.0, -295.0, -250.0, 34.0, 0.0, -66.0, 89.0, 0.0, -259.0, 64.0, -349.0, -154.0, -198.0, 97.0, 67.0, -16.0, 0.0, -48.0, 128.0, -115.0, -180.0, 11.0, 71.0, -151.0, -16.0, 0.0, -44.0, 183.0, -306.0, 66.0, -34.0, 106.0, 140.0, 33.0, 58.0, -10.0, -140.0, 9.0, 0.0, 173.0, -153.0, 82.0, -79.0, -21.0, 36.0, -170.0, -143.0, -52.0, -70.0, 26.0, 146.0, 28.0, 48.0, 78.0, 83.0, -117.0, 38.0, 16.0, -139.0, 53.0, -28.0, -108.0, 59.0, -82.0, 152.0, -16.0, 0.0, -88.0, -32.0, 148.0, 0.0, -4.0, -238.0, -56.0, 97.0, -179.0, 44.0, -132.0, 92.0, 0.0, 101.0, 0.0, 68.0, 18.0, 66.0, -47.0, -154.0, 189.0, 158.0, -27.0, -116.0, 101.0, 68.0, 0.0, 47.0, 62.0, -178.0, -39.0, -5.0, -31.0, -72.0, 0.0, -154.0, 62.0, 55.0, 0.0, 88.0, -6.0, 0.0, -54.0, 116.0, 67.0, -4.0, 122.0, 181.0, 95.0, -6.0, -10.0, 0.0, 136.0, 79.0, 157.0, 84.0, -54.0, -56.0, 102.0, 0.0, -92.0, 81.0, -152.0, 20.0, 59.0, -52.0, 100.0, 62.0, 190.0, 79.0, 52.0, 0.0, -253.0, 136.0, 92.0, 88.0, 25.0, 45.0, -50.0, -106.0, 69.0, 75.0, 46.0, -232.0, 0.0, 24.0, -36.0, 0.0, -247.0, -277.0, -344.0, -310.0, -66.0, 54.0, 114.0, 185.0, -342.0, 0.0, -24.0, 12.0, 182.0, 0.0, -161.0, 0.0, -122.0, 64.0, -59.0, 93.0, 109.0, 0.0, 18.0, -21.0, -265.0, 17.0, 67.0, -4.0], "policy_predator_policy_reward": [0.0, 29.0, 167.0, 188.0, 179.0, 29.0, 142.0, 110.0, 25.0, 58.0, 154.0, 171.0, 27.0, 55.0, 150.0, 131.0, 25.0, 6.0, 173.0, 159.0, 34.0, 0.0, 31.0, 32.0, 136.0, 83.0, 177.0, 179.0, 67.0, 168.0, 31.0, 37.0, 4.0, 4.0, 47.0, 9.0, 155.0, 44.0, 23.0, 54.0, 17.0, 100.0, 0.0, 80.0, 134.0, 154.0, 28.0, 36.0, 20.0, 26.0, 19.0, 30.0, 41.0, 70.0, 52.0, 41.0, 117.0, 35.0, 63.0, 32.0, 63.0, 1.0, 94.0, 157.0, 98.0, 39.0, 64.0, 0.0, 68.0, 8.0, 5.0, 4.0, 97.0, 90.0, 94.0, 78.0, 14.0, 1.0, 20.0, 81.0, 0.0, 94.0, 25.0, 66.0, 45.0, 4.0, 0.0, 0.0, 132.0, 70.0, 12.0, 22.0, 9.0, 111.0, 63.0, 100.0, 33.0, 3.0, 13.0, 26.0, 27.0, 15.0, 105.0, 124.0, 10.0, 0.0, 60.0, 2.0, 33.0, 2.0, 50.0, 1.0, 80.0, 57.0, 12.0, 74.0, 43.0, 40.0, 74.0, 19.0, 33.0, 0.0, 28.0, 12.0, 0.0, 3.0, 41.0, 9.0, 3.0, 23.0, 4.0, 11.0, 9.0, 0.0, 6.0, 36.0, 26.0, 1.0, 7.0, 0.0, 19.0, 10.0, 0.0, 15.0, 12.0, 34.0, 119.0, 72.0, 23.0, 17.0, 7.0, 23.0, 0.0, 15.0, 0.0, 41.0, 46.0, 131.0, 0.0, 0.0, 42.0, 19.0, 100.0, 34.0, 22.0, 5.0, 148.0, 118.0, 52.0, 2.0, 18.0, 0.0, 180.0, 4.0, 0.0, 188.0, 80.0, 32.0, 0.0, 2.0, 179.0, 30.0, 19.0, 68.0, 0.0, 1.0, 5.0, 113.0, 143.0, 68.0, 107.0, 0.0, 0.0, 10.0, 64.0, 0.0, 127.0, 87.0, 30.0, 42.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0285231851531862, "mean_inference_ms": 3.2408379571368453, "mean_action_processing_ms": 0.45922896869255125, "mean_env_wait_ms": 0.36782299938009816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02589726448059082, "StateBufferConnector_ms": 0.0048476457595825195, "ViewRequirementAgentConnector_ms": 0.13542354106903076}, "num_episodes": 18, "episode_return_max": 357.0, "episode_return_min": -466.0, "episode_return_mean": 69.17, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 1616000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 342.230386072804, "num_env_steps_trained_throughput_per_sec": 342.230386072804, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 1616000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1616000, "timers": {"training_iteration_time_ms": 13044.653, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13044.544, "sample_time_ms": 2118.259, "learn_time_ms": 10902.969, "learn_throughput": 366.873, "synch_weights_time_ms": 20.58}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 1616000}, "done": false, "training_iteration": 101, "trial_id": "e1352_00002", "date": "2024-08-13_19-41-33", "timestamp": 1723592493, "time_this_iter_s": 11.756728887557983, "time_total_s": 2382.6737263202667, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e22b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2382.6737263202667, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 53.03529411764706, "ram_util_percent": 83.40588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6060788713908067, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 0.00010000000000000003, "total_loss": 3.173162196048353, "policy_loss": -0.004365787940425059, "vf_loss": 3.1772794971390375, "vf_explained_var": 0.035533337429087, "kl": 0.008273494923640542, "entropy": 0.7316562223371375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 191835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 88.0138520000473, "cur_kl_coeff": 0.0018771171569824214, "cur_lr": 0.00010000000000000003, "total_loss": 7.643851612484644, "policy_loss": -0.0005762692901833111, "vf_loss": 7.644411762176998, "vf_explained_var": 0.24855133563122422, "kl": 0.008587423433434374, "entropy": 0.7976085148475788, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 191835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "env_runners": {"episode_reward_max": 377.0, "episode_reward_min": -466.0, "episode_reward_mean": 85.4, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -344.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": 1.495, "predator_policy": 41.205}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-96.0, 159.0, -50.0, 36.0, 165.0, 96.0, 292.0, 140.0, -39.0, 102.0, 172.0, 98.0, 79.0, -62.0, 15.0, 236.0, 152.0, 170.0, 108.0, 49.0, 40.0, 52.0, 164.0, 75.0, -71.0, 148.0, -40.0, 75.0, -15.0, 123.0, 137.0, 107.0, 126.0, 28.0, 357.0, -81.0, 204.0, 98.0, 21.0, 42.0, -20.0, -61.0, 150.0, 128.0, -3.0, 112.0, 89.0, 318.0, 98.0, 32.0, 242.0, 248.0, -81.0, 117.0, 35.0, 59.0, 47.0, 192.0, 284.0, 93.0, 60.0, 180.0, 131.0, -22.0, 171.0, 80.0, 78.0, -18.0, -340.0, -466.0, 100.0, 301.0, -133.0, 75.0, 183.0, -43.0, 153.0, 141.0, 119.0, 61.0, -34.0, 135.0, 231.0, 119.0, -86.0, 93.0, -14.0, 45.0, 110.0, 377.0, 282.0, 10.0, -186.0, 171.0, 242.0, 149.0, 160.0, 38.0, 169.0, 227.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-115.0, -180.0, 11.0, 71.0, -151.0, -16.0, 0.0, -44.0, 183.0, -306.0, 66.0, -34.0, 106.0, 140.0, 33.0, 58.0, -10.0, -140.0, 9.0, 0.0, 173.0, -153.0, 82.0, -79.0, -21.0, 36.0, -170.0, -143.0, -52.0, -70.0, 26.0, 146.0, 28.0, 48.0, 78.0, 83.0, -117.0, 38.0, 16.0, -139.0, 53.0, -28.0, -108.0, 59.0, -82.0, 152.0, -16.0, 0.0, -88.0, -32.0, 148.0, 0.0, -4.0, -238.0, -56.0, 97.0, -179.0, 44.0, -132.0, 92.0, 0.0, 101.0, 0.0, 68.0, 18.0, 66.0, -47.0, -154.0, 189.0, 158.0, -27.0, -116.0, 101.0, 68.0, 0.0, 47.0, 62.0, -178.0, -39.0, -5.0, -31.0, -72.0, 0.0, -154.0, 62.0, 55.0, 0.0, 88.0, -6.0, 0.0, -54.0, 116.0, 67.0, -4.0, 122.0, 181.0, 95.0, -6.0, -10.0, 0.0, 136.0, 79.0, 157.0, 84.0, -54.0, -56.0, 102.0, 0.0, -92.0, 81.0, -152.0, 20.0, 59.0, -52.0, 100.0, 62.0, 190.0, 79.0, 52.0, 0.0, -253.0, 136.0, 92.0, 88.0, 25.0, 45.0, -50.0, -106.0, 69.0, 75.0, 46.0, -232.0, 0.0, 24.0, -36.0, 0.0, -247.0, -277.0, -344.0, -310.0, -66.0, 54.0, 114.0, 185.0, -342.0, 0.0, -24.0, 12.0, 182.0, 0.0, -161.0, 0.0, -122.0, 64.0, -59.0, 93.0, 109.0, 0.0, 18.0, -21.0, -265.0, 17.0, 67.0, -4.0, 158.0, -100.0, 119.0, 0.0, 10.0, -314.0, 0.0, 62.0, -55.0, -45.0, 21.0, -56.0, -207.0, 113.0, 181.0, 193.0, 179.0, 98.0, -55.0, -30.0, -231.0, -79.0, 183.0, -28.0, 74.0, 168.0, -36.0, 139.0, 30.0, 80.0, -4.0, 31.0, 157.0, 0.0, 163.0, 55.0], "policy_predator_policy_reward": [155.0, 44.0, 23.0, 54.0, 17.0, 100.0, 0.0, 80.0, 134.0, 154.0, 28.0, 36.0, 20.0, 26.0, 19.0, 30.0, 41.0, 70.0, 52.0, 41.0, 117.0, 35.0, 63.0, 32.0, 63.0, 1.0, 94.0, 157.0, 98.0, 39.0, 64.0, 0.0, 68.0, 8.0, 5.0, 4.0, 97.0, 90.0, 94.0, 78.0, 14.0, 1.0, 20.0, 81.0, 0.0, 94.0, 25.0, 66.0, 45.0, 4.0, 0.0, 0.0, 132.0, 70.0, 12.0, 22.0, 9.0, 111.0, 63.0, 100.0, 33.0, 3.0, 13.0, 26.0, 27.0, 15.0, 105.0, 124.0, 10.0, 0.0, 60.0, 2.0, 33.0, 2.0, 50.0, 1.0, 80.0, 57.0, 12.0, 74.0, 43.0, 40.0, 74.0, 19.0, 33.0, 0.0, 28.0, 12.0, 0.0, 3.0, 41.0, 9.0, 3.0, 23.0, 4.0, 11.0, 9.0, 0.0, 6.0, 36.0, 26.0, 1.0, 7.0, 0.0, 19.0, 10.0, 0.0, 15.0, 12.0, 34.0, 119.0, 72.0, 23.0, 17.0, 7.0, 23.0, 0.0, 15.0, 0.0, 41.0, 46.0, 131.0, 0.0, 0.0, 42.0, 19.0, 100.0, 34.0, 22.0, 5.0, 148.0, 118.0, 52.0, 2.0, 18.0, 0.0, 180.0, 4.0, 0.0, 188.0, 80.0, 32.0, 0.0, 2.0, 179.0, 30.0, 19.0, 68.0, 0.0, 1.0, 5.0, 113.0, 143.0, 68.0, 107.0, 0.0, 0.0, 10.0, 64.0, 0.0, 127.0, 87.0, 30.0, 42.0, 90.0, 83.0, 0.0, 0.0, 110.0, 108.0, 0.0, 31.0, 86.0, 0.0, 80.0, 0.0, 69.0, 135.0, 2.0, 1.0, 5.0, 0.0, 0.0, 95.0, 0.0, 124.0, 1.0, 15.0, 0.0, 0.0, 38.0, 8.0, 49.0, 1.0, 11.0, 0.0, 1.0, 11.0, 7.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.028114609424934, "mean_inference_ms": 3.2392749601561106, "mean_action_processing_ms": 0.4584950021691958, "mean_env_wait_ms": 0.3676467079340249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026100873947143555, "StateBufferConnector_ms": 0.005301952362060547, "ViewRequirementAgentConnector_ms": 0.15410315990447998}, "num_episodes": 18, "episode_return_max": 377.0, "episode_return_min": -466.0, "episode_return_mean": 85.4, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.2697103027121, "num_env_steps_trained_throughput_per_sec": 329.2697103027121, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 1632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1632000, "timers": {"training_iteration_time_ms": 12896.336, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12896.227, "sample_time_ms": 2068.191, "learn_time_ms": 10804.596, "learn_throughput": 370.213, "synch_weights_time_ms": 20.587}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "done": false, "training_iteration": 102, "trial_id": "e1352_00002", "date": "2024-08-13_19-41-45", "timestamp": 1723592505, "time_this_iter_s": 12.177984952926636, "time_total_s": 2394.8517112731934, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e7c790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2394.8517112731934, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 55.44117647058823, "ram_util_percent": 82.76470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.478720233293753, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 0.00010000000000000003, "total_loss": 4.448459415713315, "policy_loss": -0.006033163284882903, "vf_loss": 4.453745796314623, "vf_explained_var": 0.025970917120181694, "kl": 0.024864539376937292, "entropy": 0.8439905136665969, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 193725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 66.79796447034866, "cur_kl_coeff": 0.0018771171569824214, "cur_lr": 0.00010000000000000003, "total_loss": 7.853546692833068, "policy_loss": -0.0009474937730128803, "vf_loss": 7.854471974650388, "vf_explained_var": -0.10384228835030207, "kl": 0.011829704370460485, "entropy": 0.7565811312072491, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 193725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 1648000}, "env_runners": {"episode_reward_max": 377.0, "episode_reward_min": -466.0, "episode_reward_mean": 72.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -344.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": -1.97, "predator_policy": 38.215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [164.0, 75.0, -71.0, 148.0, -40.0, 75.0, -15.0, 123.0, 137.0, 107.0, 126.0, 28.0, 357.0, -81.0, 204.0, 98.0, 21.0, 42.0, -20.0, -61.0, 150.0, 128.0, -3.0, 112.0, 89.0, 318.0, 98.0, 32.0, 242.0, 248.0, -81.0, 117.0, 35.0, 59.0, 47.0, 192.0, 284.0, 93.0, 60.0, 180.0, 131.0, -22.0, 171.0, 80.0, 78.0, -18.0, -340.0, -466.0, 100.0, 301.0, -133.0, 75.0, 183.0, -43.0, 153.0, 141.0, 119.0, 61.0, -34.0, 135.0, 231.0, 119.0, -86.0, 93.0, -14.0, 45.0, 110.0, 377.0, 282.0, 10.0, -186.0, 171.0, 242.0, 149.0, 160.0, 38.0, 169.0, 227.0, 156.0, -14.0, -57.0, 0.0, -71.0, 271.0, 33.0, -227.0, 134.0, -153.0, -84.0, -50.0, 203.0, -1.0, 120.0, 217.0, 58.0, -285.0, 18.0, 63.0, 280.0, 12.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-82.0, 152.0, -16.0, 0.0, -88.0, -32.0, 148.0, 0.0, -4.0, -238.0, -56.0, 97.0, -179.0, 44.0, -132.0, 92.0, 0.0, 101.0, 0.0, 68.0, 18.0, 66.0, -47.0, -154.0, 189.0, 158.0, -27.0, -116.0, 101.0, 68.0, 0.0, 47.0, 62.0, -178.0, -39.0, -5.0, -31.0, -72.0, 0.0, -154.0, 62.0, 55.0, 0.0, 88.0, -6.0, 0.0, -54.0, 116.0, 67.0, -4.0, 122.0, 181.0, 95.0, -6.0, -10.0, 0.0, 136.0, 79.0, 157.0, 84.0, -54.0, -56.0, 102.0, 0.0, -92.0, 81.0, -152.0, 20.0, 59.0, -52.0, 100.0, 62.0, 190.0, 79.0, 52.0, 0.0, -253.0, 136.0, 92.0, 88.0, 25.0, 45.0, -50.0, -106.0, 69.0, 75.0, 46.0, -232.0, 0.0, 24.0, -36.0, 0.0, -247.0, -277.0, -344.0, -310.0, -66.0, 54.0, 114.0, 185.0, -342.0, 0.0, -24.0, 12.0, 182.0, 0.0, -161.0, 0.0, -122.0, 64.0, -59.0, 93.0, 109.0, 0.0, 18.0, -21.0, -265.0, 17.0, 67.0, -4.0, 158.0, -100.0, 119.0, 0.0, 10.0, -314.0, 0.0, 62.0, -55.0, -45.0, 21.0, -56.0, -207.0, 113.0, 181.0, 193.0, 179.0, 98.0, -55.0, -30.0, -231.0, -79.0, 183.0, -28.0, 74.0, 168.0, -36.0, 139.0, 30.0, 80.0, -4.0, 31.0, 157.0, 0.0, 163.0, 55.0, 147.0, -67.0, 63.0, -222.0, -46.0, -284.0, 0.0, 0.0, -62.0, -83.0, 115.0, 156.0, 0.0, -49.0, -256.0, -184.0, 47.0, 87.0, -168.0, -121.0, 0.0, -203.0, 0.0, -137.0, 128.0, 46.0, 9.0, -113.0, -12.0, 60.0, 59.0, 143.0, 10.0, -36.0, -167.0, -304.0, -38.0, 37.0, 0.0, 2.0, 120.0, 128.0, 0.0, -31.0], "policy_predator_policy_reward": [0.0, 94.0, 25.0, 66.0, 45.0, 4.0, 0.0, 0.0, 132.0, 70.0, 12.0, 22.0, 9.0, 111.0, 63.0, 100.0, 33.0, 3.0, 13.0, 26.0, 27.0, 15.0, 105.0, 124.0, 10.0, 0.0, 60.0, 2.0, 33.0, 2.0, 50.0, 1.0, 80.0, 57.0, 12.0, 74.0, 43.0, 40.0, 74.0, 19.0, 33.0, 0.0, 28.0, 12.0, 0.0, 3.0, 41.0, 9.0, 3.0, 23.0, 4.0, 11.0, 9.0, 0.0, 6.0, 36.0, 26.0, 1.0, 7.0, 0.0, 19.0, 10.0, 0.0, 15.0, 12.0, 34.0, 119.0, 72.0, 23.0, 17.0, 7.0, 23.0, 0.0, 15.0, 0.0, 41.0, 46.0, 131.0, 0.0, 0.0, 42.0, 19.0, 100.0, 34.0, 22.0, 5.0, 148.0, 118.0, 52.0, 2.0, 18.0, 0.0, 180.0, 4.0, 0.0, 188.0, 80.0, 32.0, 0.0, 2.0, 179.0, 30.0, 19.0, 68.0, 0.0, 1.0, 5.0, 113.0, 143.0, 68.0, 107.0, 0.0, 0.0, 10.0, 64.0, 0.0, 127.0, 87.0, 30.0, 42.0, 90.0, 83.0, 0.0, 0.0, 110.0, 108.0, 0.0, 31.0, 86.0, 0.0, 80.0, 0.0, 69.0, 135.0, 2.0, 1.0, 5.0, 0.0, 0.0, 95.0, 0.0, 124.0, 1.0, 15.0, 0.0, 0.0, 38.0, 8.0, 49.0, 1.0, 11.0, 0.0, 1.0, 11.0, 7.0, 2.0, 72.0, 4.0, 13.0, 132.0, 112.0, 161.0, 0.0, 0.0, 52.0, 22.0, 0.0, 0.0, 8.0, 74.0, 183.0, 30.0, 0.0, 0.0, 124.0, 12.0, 0.0, 119.0, 13.0, 74.0, 29.0, 0.0, 2.0, 101.0, 0.0, 72.0, 4.0, 11.0, 11.0, 73.0, 0.0, 186.0, 19.0, 0.0, 46.0, 15.0, 0.0, 32.0, 32.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0284747105228738, "mean_inference_ms": 3.2391825968666677, "mean_action_processing_ms": 0.457835248549205, "mean_env_wait_ms": 0.36757395296144507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027953386306762695, "StateBufferConnector_ms": 0.006148815155029297, "ViewRequirementAgentConnector_ms": 0.15997850894927979}, "num_episodes": 22, "episode_return_max": 377.0, "episode_return_min": -466.0, "episode_return_mean": 72.49, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 1648000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.3773351389521, "num_env_steps_trained_throughput_per_sec": 298.3773351389521, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 1648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1648000, "timers": {"training_iteration_time_ms": 13006.533, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13006.423, "sample_time_ms": 2169.976, "learn_time_ms": 10814.345, "learn_throughput": 369.879, "synch_weights_time_ms": 19.469}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 1648000}, "done": false, "training_iteration": 103, "trial_id": "e1352_00002", "date": "2024-08-13_19-41-59", "timestamp": 1723592519, "time_this_iter_s": 13.472029209136963, "time_total_s": 2408.3237404823303, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e22790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2408.3237404823303, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 65.51052631578948, "ram_util_percent": 83.55263157894738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2792682989801047, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 6.197571627803581, "policy_loss": -0.001764048314185212, "vf_loss": 6.198929660534732, "vf_explained_var": 0.011049053530213694, "kl": 0.009012454560990984, "entropy": 0.8542054460162208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 195615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 91.54940205459242, "cur_kl_coeff": 0.0018771171569824214, "cur_lr": 0.00010000000000000003, "total_loss": 7.413131785771204, "policy_loss": -0.000597204914114502, "vf_loss": 7.413712302465288, "vf_explained_var": -0.3518564366789722, "kl": 0.00888501692902994, "entropy": 0.7990130520371533, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 195615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000}, "env_runners": {"episode_reward_max": 377.0, "episode_reward_min": -466.0, "episode_reward_mean": 49.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -390.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 195.0}, "policy_reward_mean": {"prey_policy": -19.155, "predator_policy": 43.885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, -61.0, 150.0, 128.0, -3.0, 112.0, 89.0, 318.0, 98.0, 32.0, 242.0, 248.0, -81.0, 117.0, 35.0, 59.0, 47.0, 192.0, 284.0, 93.0, 60.0, 180.0, 131.0, -22.0, 171.0, 80.0, 78.0, -18.0, -340.0, -466.0, 100.0, 301.0, -133.0, 75.0, 183.0, -43.0, 153.0, 141.0, 119.0, 61.0, -34.0, 135.0, 231.0, 119.0, -86.0, 93.0, -14.0, 45.0, 110.0, 377.0, 282.0, 10.0, -186.0, 171.0, 242.0, 149.0, 160.0, 38.0, 169.0, 227.0, 156.0, -14.0, -57.0, 0.0, -71.0, 271.0, 33.0, -227.0, 134.0, -153.0, -84.0, -50.0, 203.0, -1.0, 120.0, 217.0, 58.0, -285.0, 18.0, 63.0, 280.0, 12.0, -14.0, -367.0, 239.0, -304.0, -79.0, 46.0, 109.0, 0.0, 96.0, -34.0, -77.0, 0.0, 84.0, -89.0, 142.0, -62.0, -57.0, -438.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-31.0, -72.0, 0.0, -154.0, 62.0, 55.0, 0.0, 88.0, -6.0, 0.0, -54.0, 116.0, 67.0, -4.0, 122.0, 181.0, 95.0, -6.0, -10.0, 0.0, 136.0, 79.0, 157.0, 84.0, -54.0, -56.0, 102.0, 0.0, -92.0, 81.0, -152.0, 20.0, 59.0, -52.0, 100.0, 62.0, 190.0, 79.0, 52.0, 0.0, -253.0, 136.0, 92.0, 88.0, 25.0, 45.0, -50.0, -106.0, 69.0, 75.0, 46.0, -232.0, 0.0, 24.0, -36.0, 0.0, -247.0, -277.0, -344.0, -310.0, -66.0, 54.0, 114.0, 185.0, -342.0, 0.0, -24.0, 12.0, 182.0, 0.0, -161.0, 0.0, -122.0, 64.0, -59.0, 93.0, 109.0, 0.0, 18.0, -21.0, -265.0, 17.0, 67.0, -4.0, 158.0, -100.0, 119.0, 0.0, 10.0, -314.0, 0.0, 62.0, -55.0, -45.0, 21.0, -56.0, -207.0, 113.0, 181.0, 193.0, 179.0, 98.0, -55.0, -30.0, -231.0, -79.0, 183.0, -28.0, 74.0, 168.0, -36.0, 139.0, 30.0, 80.0, -4.0, 31.0, 157.0, 0.0, 163.0, 55.0, 147.0, -67.0, 63.0, -222.0, -46.0, -284.0, 0.0, 0.0, -62.0, -83.0, 115.0, 156.0, 0.0, -49.0, -256.0, -184.0, 47.0, 87.0, -168.0, -121.0, 0.0, -203.0, 0.0, -137.0, 128.0, 46.0, 9.0, -113.0, -12.0, 60.0, 59.0, 143.0, 10.0, -36.0, -167.0, -304.0, -38.0, 37.0, 0.0, 2.0, 120.0, 128.0, 0.0, -31.0, -310.0, 0.0, -363.0, -313.0, 62.0, 159.0, -237.0, -377.0, -86.0, -92.0, 177.0, -339.0, -218.0, 165.0, 0.0, 0.0, 118.0, -119.0, -113.0, 0.0, -9.0, -197.0, 0.0, 0.0, 166.0, -218.0, -352.0, -6.0, 116.0, 0.0, -390.0, 103.0, -114.0, 0.0, -293.0, -339.0], "policy_predator_policy_reward": [43.0, 40.0, 74.0, 19.0, 33.0, 0.0, 28.0, 12.0, 0.0, 3.0, 41.0, 9.0, 3.0, 23.0, 4.0, 11.0, 9.0, 0.0, 6.0, 36.0, 26.0, 1.0, 7.0, 0.0, 19.0, 10.0, 0.0, 15.0, 12.0, 34.0, 119.0, 72.0, 23.0, 17.0, 7.0, 23.0, 0.0, 15.0, 0.0, 41.0, 46.0, 131.0, 0.0, 0.0, 42.0, 19.0, 100.0, 34.0, 22.0, 5.0, 148.0, 118.0, 52.0, 2.0, 18.0, 0.0, 180.0, 4.0, 0.0, 188.0, 80.0, 32.0, 0.0, 2.0, 179.0, 30.0, 19.0, 68.0, 0.0, 1.0, 5.0, 113.0, 143.0, 68.0, 107.0, 0.0, 0.0, 10.0, 64.0, 0.0, 127.0, 87.0, 30.0, 42.0, 90.0, 83.0, 0.0, 0.0, 110.0, 108.0, 0.0, 31.0, 86.0, 0.0, 80.0, 0.0, 69.0, 135.0, 2.0, 1.0, 5.0, 0.0, 0.0, 95.0, 0.0, 124.0, 1.0, 15.0, 0.0, 0.0, 38.0, 8.0, 49.0, 1.0, 11.0, 0.0, 1.0, 11.0, 7.0, 2.0, 72.0, 4.0, 13.0, 132.0, 112.0, 161.0, 0.0, 0.0, 52.0, 22.0, 0.0, 0.0, 8.0, 74.0, 183.0, 30.0, 0.0, 0.0, 124.0, 12.0, 0.0, 119.0, 13.0, 74.0, 29.0, 0.0, 2.0, 101.0, 0.0, 72.0, 4.0, 11.0, 11.0, 73.0, 0.0, 186.0, 19.0, 0.0, 46.0, 15.0, 0.0, 32.0, 32.0, 11.0, 155.0, 141.0, 185.0, 124.0, 18.0, 0.0, 182.0, 128.0, 97.0, 2.0, 113.0, 95.0, 53.0, 109.0, 0.0, 0.0, 10.0, 87.0, 76.0, 3.0, 0.0, 129.0, 0.0, 0.0, 136.0, 0.0, 154.0, 115.0, 15.0, 11.0, 195.0, 30.0, 0.0, 57.0, 190.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0286134015885255, "mean_inference_ms": 3.238773520399716, "mean_action_processing_ms": 0.4572004802366608, "mean_env_wait_ms": 0.36754992209485565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007048130035400391, "StateBufferConnector_ms": 0.005871176719665527, "ViewRequirementAgentConnector_ms": 0.1565871238708496}, "num_episodes": 18, "episode_return_max": 377.0, "episode_return_min": -466.0, "episode_return_mean": 49.46, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.9118305921025, "num_env_steps_trained_throughput_per_sec": 295.9118305921025, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 1664000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1664000, "timers": {"training_iteration_time_ms": 13028.275, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13028.164, "sample_time_ms": 2186.473, "learn_time_ms": 10818.49, "learn_throughput": 369.737, "synch_weights_time_ms": 20.053}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000}, "done": false, "training_iteration": 104, "trial_id": "e1352_00002", "date": "2024-08-13_19-42-13", "timestamp": 1723592533, "time_this_iter_s": 13.575668096542358, "time_total_s": 2421.8994085788727, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e5aaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2421.8994085788727, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 65.31052631578946, "ram_util_percent": 83.8578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.634438284175106, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 6.039047337082959, "policy_loss": -0.0007013803988537461, "vf_loss": 6.039433077655772, "vf_explained_var": 0.009382613310738216, "kl": 0.007006359001684452, "entropy": 0.8591842316761219, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 197505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 92.65773883663788, "cur_kl_coeff": 0.0018771171569824214, "cur_lr": 0.00010000000000000003, "total_loss": 6.647897219027161, "policy_loss": -0.012058798419360918, "vf_loss": 6.659874677405786, "vf_explained_var": -0.44436676890131027, "kl": 0.043332172192432045, "entropy": 0.8600621406048063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 197505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": 377.0, "episode_reward_min": -466.0, "episode_reward_mean": 18.97, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -396.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 195.0}, "policy_reward_mean": {"prey_policy": -45.16, "predator_policy": 54.645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.0, 171.0, 80.0, 78.0, -18.0, -340.0, -466.0, 100.0, 301.0, -133.0, 75.0, 183.0, -43.0, 153.0, 141.0, 119.0, 61.0, -34.0, 135.0, 231.0, 119.0, -86.0, 93.0, -14.0, 45.0, 110.0, 377.0, 282.0, 10.0, -186.0, 171.0, 242.0, 149.0, 160.0, 38.0, 169.0, 227.0, 156.0, -14.0, -57.0, 0.0, -71.0, 271.0, 33.0, -227.0, 134.0, -153.0, -84.0, -50.0, 203.0, -1.0, 120.0, 217.0, 58.0, -285.0, 18.0, 63.0, 280.0, 12.0, -14.0, -367.0, 239.0, -304.0, -79.0, 46.0, 109.0, 0.0, 96.0, -34.0, -77.0, 0.0, 84.0, -89.0, 142.0, -62.0, -57.0, -438.0, -64.0, -100.0, -307.0, 241.0, -327.0, 0.0, -104.0, 138.0, -69.0, 147.0, -156.0, 100.0, -137.0, 106.0, 201.0, 160.0, -124.0, -31.0, -79.0, -156.0, -118.0, 0.0, 80.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-50.0, -106.0, 69.0, 75.0, 46.0, -232.0, 0.0, 24.0, -36.0, 0.0, -247.0, -277.0, -344.0, -310.0, -66.0, 54.0, 114.0, 185.0, -342.0, 0.0, -24.0, 12.0, 182.0, 0.0, -161.0, 0.0, -122.0, 64.0, -59.0, 93.0, 109.0, 0.0, 18.0, -21.0, -265.0, 17.0, 67.0, -4.0, 158.0, -100.0, 119.0, 0.0, 10.0, -314.0, 0.0, 62.0, -55.0, -45.0, 21.0, -56.0, -207.0, 113.0, 181.0, 193.0, 179.0, 98.0, -55.0, -30.0, -231.0, -79.0, 183.0, -28.0, 74.0, 168.0, -36.0, 139.0, 30.0, 80.0, -4.0, 31.0, 157.0, 0.0, 163.0, 55.0, 147.0, -67.0, 63.0, -222.0, -46.0, -284.0, 0.0, 0.0, -62.0, -83.0, 115.0, 156.0, 0.0, -49.0, -256.0, -184.0, 47.0, 87.0, -168.0, -121.0, 0.0, -203.0, 0.0, -137.0, 128.0, 46.0, 9.0, -113.0, -12.0, 60.0, 59.0, 143.0, 10.0, -36.0, -167.0, -304.0, -38.0, 37.0, 0.0, 2.0, 120.0, 128.0, 0.0, -31.0, -310.0, 0.0, -363.0, -313.0, 62.0, 159.0, -237.0, -377.0, -86.0, -92.0, 177.0, -339.0, -218.0, 165.0, 0.0, 0.0, 118.0, -119.0, -113.0, 0.0, -9.0, -197.0, 0.0, 0.0, 166.0, -218.0, -352.0, -6.0, 116.0, 0.0, -390.0, 103.0, -114.0, 0.0, -293.0, -339.0, -396.0, -6.0, -252.0, 0.0, -232.0, -231.0, 44.0, 131.0, -365.0, -338.0, 0.0, 0.0, -62.0, -217.0, -103.0, 143.0, -194.0, 0.0, 0.0, 133.0, -338.0, -14.0, 50.0, -33.0, -80.0, -204.0, 106.0, 0.0, 99.0, 58.0, 66.0, 11.0, 0.0, -394.0, -28.0, -123.0, 0.0, -379.0, -352.0, -99.0, 0.0, -282.0, 0.0, 0.0, -2.0, 59.0], "policy_predator_policy_reward": [100.0, 34.0, 22.0, 5.0, 148.0, 118.0, 52.0, 2.0, 18.0, 0.0, 180.0, 4.0, 0.0, 188.0, 80.0, 32.0, 0.0, 2.0, 179.0, 30.0, 19.0, 68.0, 0.0, 1.0, 5.0, 113.0, 143.0, 68.0, 107.0, 0.0, 0.0, 10.0, 64.0, 0.0, 127.0, 87.0, 30.0, 42.0, 90.0, 83.0, 0.0, 0.0, 110.0, 108.0, 0.0, 31.0, 86.0, 0.0, 80.0, 0.0, 69.0, 135.0, 2.0, 1.0, 5.0, 0.0, 0.0, 95.0, 0.0, 124.0, 1.0, 15.0, 0.0, 0.0, 38.0, 8.0, 49.0, 1.0, 11.0, 0.0, 1.0, 11.0, 7.0, 2.0, 72.0, 4.0, 13.0, 132.0, 112.0, 161.0, 0.0, 0.0, 52.0, 22.0, 0.0, 0.0, 8.0, 74.0, 183.0, 30.0, 0.0, 0.0, 124.0, 12.0, 0.0, 119.0, 13.0, 74.0, 29.0, 0.0, 2.0, 101.0, 0.0, 72.0, 4.0, 11.0, 11.0, 73.0, 0.0, 186.0, 19.0, 0.0, 46.0, 15.0, 0.0, 32.0, 32.0, 11.0, 155.0, 141.0, 185.0, 124.0, 18.0, 0.0, 182.0, 128.0, 97.0, 2.0, 113.0, 95.0, 53.0, 109.0, 0.0, 0.0, 10.0, 87.0, 76.0, 3.0, 0.0, 129.0, 0.0, 0.0, 136.0, 0.0, 154.0, 115.0, 15.0, 11.0, 195.0, 30.0, 0.0, 57.0, 190.0, 4.0, 160.0, 178.0, 150.0, 2.0, 152.0, 4.0, 40.0, 26.0, 187.0, 189.0, 0.0, 0.0, 127.0, 48.0, 6.0, 92.0, 121.0, 4.0, 7.0, 7.0, 22.0, 174.0, 5.0, 78.0, 0.0, 147.0, 0.0, 0.0, 0.0, 44.0, 70.0, 13.0, 180.0, 90.0, 96.0, 24.0, 170.0, 130.0, 170.0, 125.0, 141.0, 23.0, 0.0, 0.0, 8.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0290147069628945, "mean_inference_ms": 3.2389325047564945, "mean_action_processing_ms": 0.45649782228038405, "mean_env_wait_ms": 0.36755845276381643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0096360445022583, "StateBufferConnector_ms": 0.005839824676513672, "ViewRequirementAgentConnector_ms": 0.17987942695617676}, "num_episodes": 23, "episode_return_max": 377.0, "episode_return_min": -466.0, "episode_return_mean": 18.97, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.8111303803716, "num_env_steps_trained_throughput_per_sec": 282.8111303803716, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 13155.662, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13155.564, "sample_time_ms": 2268.056, "learn_time_ms": 10865.022, "learn_throughput": 368.154, "synch_weights_time_ms": 19.279}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 105, "trial_id": "e1352_00002", "date": "2024-08-13_19-42-27", "timestamp": 1723592547, "time_this_iter_s": 14.193809986114502, "time_total_s": 2436.093218564987, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e7cca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2436.093218564987, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 68.345, "ram_util_percent": 83.83}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.220888653342371, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 2.0369254650262296, "policy_loss": -0.002214141292546792, "vf_loss": 2.038799826934855, "vf_explained_var": -0.00989209394606333, "kl": 0.007542189414138735, "entropy": 0.8875832703063097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 199395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 145.64896601801195, "cur_kl_coeff": 0.0028156757354736326, "cur_lr": 0.00010000000000000003, "total_loss": 4.500138765415818, "policy_loss": -0.0009118964028342691, "vf_loss": 4.501024698580384, "vf_explained_var": -1.0, "kl": 0.00922369046831294, "entropy": 1.0410020421421717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 199395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000}, "env_runners": {"episode_reward_max": 377.0, "episode_reward_min": -438.0, "episode_reward_mean": 14.95, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -396.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 195.0}, "policy_reward_mean": {"prey_policy": -41.2, "predator_policy": 48.675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.0, 231.0, 119.0, -86.0, 93.0, -14.0, 45.0, 110.0, 377.0, 282.0, 10.0, -186.0, 171.0, 242.0, 149.0, 160.0, 38.0, 169.0, 227.0, 156.0, -14.0, -57.0, 0.0, -71.0, 271.0, 33.0, -227.0, 134.0, -153.0, -84.0, -50.0, 203.0, -1.0, 120.0, 217.0, 58.0, -285.0, 18.0, 63.0, 280.0, 12.0, -14.0, -367.0, 239.0, -304.0, -79.0, 46.0, 109.0, 0.0, 96.0, -34.0, -77.0, 0.0, 84.0, -89.0, 142.0, -62.0, -57.0, -438.0, -64.0, -100.0, -307.0, 241.0, -327.0, 0.0, -104.0, 138.0, -69.0, 147.0, -156.0, 100.0, -137.0, 106.0, 201.0, 160.0, -124.0, -31.0, -79.0, -156.0, -118.0, 0.0, 80.0, -97.0, 62.0, 116.0, -15.0, 0.0, -7.0, -15.0, -2.0, -72.0, -29.0, 6.0, -36.0, -44.0, 26.0, 0.0, 2.0, 34.0, 75.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [67.0, -4.0, 158.0, -100.0, 119.0, 0.0, 10.0, -314.0, 0.0, 62.0, -55.0, -45.0, 21.0, -56.0, -207.0, 113.0, 181.0, 193.0, 179.0, 98.0, -55.0, -30.0, -231.0, -79.0, 183.0, -28.0, 74.0, 168.0, -36.0, 139.0, 30.0, 80.0, -4.0, 31.0, 157.0, 0.0, 163.0, 55.0, 147.0, -67.0, 63.0, -222.0, -46.0, -284.0, 0.0, 0.0, -62.0, -83.0, 115.0, 156.0, 0.0, -49.0, -256.0, -184.0, 47.0, 87.0, -168.0, -121.0, 0.0, -203.0, 0.0, -137.0, 128.0, 46.0, 9.0, -113.0, -12.0, 60.0, 59.0, 143.0, 10.0, -36.0, -167.0, -304.0, -38.0, 37.0, 0.0, 2.0, 120.0, 128.0, 0.0, -31.0, -310.0, 0.0, -363.0, -313.0, 62.0, 159.0, -237.0, -377.0, -86.0, -92.0, 177.0, -339.0, -218.0, 165.0, 0.0, 0.0, 118.0, -119.0, -113.0, 0.0, -9.0, -197.0, 0.0, 0.0, 166.0, -218.0, -352.0, -6.0, 116.0, 0.0, -390.0, 103.0, -114.0, 0.0, -293.0, -339.0, -396.0, -6.0, -252.0, 0.0, -232.0, -231.0, 44.0, 131.0, -365.0, -338.0, 0.0, 0.0, -62.0, -217.0, -103.0, 143.0, -194.0, 0.0, 0.0, 133.0, -338.0, -14.0, 50.0, -33.0, -80.0, -204.0, 106.0, 0.0, 99.0, 58.0, 66.0, 11.0, 0.0, -394.0, -28.0, -123.0, 0.0, -379.0, -352.0, -99.0, 0.0, -282.0, 0.0, 0.0, -2.0, 59.0, 0.0, -244.0, 0.0, 61.0, -20.0, 82.0, -5.0, -34.0, 0.0, 0.0, -56.0, -8.0, -92.0, 0.0, -43.0, 5.0, -79.0, -61.0, -53.0, -31.0, -34.0, -13.0, -60.0, -15.0, -51.0, -61.0, 6.0, -4.0, -22.0, 0.0, -18.0, -24.0, 19.0, 0.0, 7.0, 40.0], "policy_predator_policy_reward": [30.0, 42.0, 90.0, 83.0, 0.0, 0.0, 110.0, 108.0, 0.0, 31.0, 86.0, 0.0, 80.0, 0.0, 69.0, 135.0, 2.0, 1.0, 5.0, 0.0, 0.0, 95.0, 0.0, 124.0, 1.0, 15.0, 0.0, 0.0, 38.0, 8.0, 49.0, 1.0, 11.0, 0.0, 1.0, 11.0, 7.0, 2.0, 72.0, 4.0, 13.0, 132.0, 112.0, 161.0, 0.0, 0.0, 52.0, 22.0, 0.0, 0.0, 8.0, 74.0, 183.0, 30.0, 0.0, 0.0, 124.0, 12.0, 0.0, 119.0, 13.0, 74.0, 29.0, 0.0, 2.0, 101.0, 0.0, 72.0, 4.0, 11.0, 11.0, 73.0, 0.0, 186.0, 19.0, 0.0, 46.0, 15.0, 0.0, 32.0, 32.0, 11.0, 155.0, 141.0, 185.0, 124.0, 18.0, 0.0, 182.0, 128.0, 97.0, 2.0, 113.0, 95.0, 53.0, 109.0, 0.0, 0.0, 10.0, 87.0, 76.0, 3.0, 0.0, 129.0, 0.0, 0.0, 136.0, 0.0, 154.0, 115.0, 15.0, 11.0, 195.0, 30.0, 0.0, 57.0, 190.0, 4.0, 160.0, 178.0, 150.0, 2.0, 152.0, 4.0, 40.0, 26.0, 187.0, 189.0, 0.0, 0.0, 127.0, 48.0, 6.0, 92.0, 121.0, 4.0, 7.0, 7.0, 22.0, 174.0, 5.0, 78.0, 0.0, 147.0, 0.0, 0.0, 0.0, 44.0, 70.0, 13.0, 180.0, 90.0, 96.0, 24.0, 170.0, 130.0, 170.0, 125.0, 141.0, 23.0, 0.0, 0.0, 8.0, 15.0, 20.0, 127.0, 0.0, 1.0, 39.0, 15.0, 12.0, 12.0, 0.0, 0.0, 30.0, 27.0, 25.0, 52.0, 4.0, 32.0, 40.0, 28.0, 22.0, 33.0, 27.0, 26.0, 39.0, 0.0, 56.0, 12.0, 0.0, 24.0, 22.0, 0.0, 25.0, 19.0, 1.0, 14.0, 14.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0293088129307415, "mean_inference_ms": 3.239060310000866, "mean_action_processing_ms": 0.46281291262787055, "mean_env_wait_ms": 0.36757673800082485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00979602336883545, "StateBufferConnector_ms": 0.0059947967529296875, "ViewRequirementAgentConnector_ms": 0.18673396110534668}, "num_episodes": 18, "episode_return_max": 377.0, "episode_return_min": -438.0, "episode_return_mean": 14.95, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.8226279182951, "num_env_steps_trained_throughput_per_sec": 284.8226279182951, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 1696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1696000, "timers": {"training_iteration_time_ms": 13379.954, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13379.855, "sample_time_ms": 2438.713, "learn_time_ms": 10918.659, "learn_throughput": 366.345, "synch_weights_time_ms": 19.242}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000}, "done": false, "training_iteration": 106, "trial_id": "e1352_00002", "date": "2024-08-13_19-42-41", "timestamp": 1723592561, "time_this_iter_s": 14.110033750534058, "time_total_s": 2450.2032523155212, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b8caf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2450.2032523155212, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 61.90999999999999, "ram_util_percent": 83.405}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9679753064793883, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 1.3999865045307804, "policy_loss": -0.0034216432594423177, "vf_loss": 1.4029377310048967, "vf_explained_var": -0.0028744992124971258, "kl": 0.010441896322548796, "entropy": 0.9216606458974264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 201285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 98.98706942960699, "cur_kl_coeff": 0.0028156757354736326, "cur_lr": 0.00010000000000000003, "total_loss": 2.8966296966113743, "policy_loss": -0.0013367088026214372, "vf_loss": 2.897938382940948, "vf_explained_var": -0.9978105152094806, "kl": 0.009952884937401109, "entropy": 1.0584469316497682, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 201285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 1712000}, "env_runners": {"episode_reward_max": 280.0, "episode_reward_min": -438.0, "episode_reward_mean": -8.74, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -396.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 177.0, "predator_policy": 195.0}, "policy_reward_mean": {"prey_policy": -47.375, "predator_policy": 43.005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -71.0, 271.0, 33.0, -227.0, 134.0, -153.0, -84.0, -50.0, 203.0, -1.0, 120.0, 217.0, 58.0, -285.0, 18.0, 63.0, 280.0, 12.0, -14.0, -367.0, 239.0, -304.0, -79.0, 46.0, 109.0, 0.0, 96.0, -34.0, -77.0, 0.0, 84.0, -89.0, 142.0, -62.0, -57.0, -438.0, -64.0, -100.0, -307.0, 241.0, -327.0, 0.0, -104.0, 138.0, -69.0, 147.0, -156.0, 100.0, -137.0, 106.0, 201.0, 160.0, -124.0, -31.0, -79.0, -156.0, -118.0, 0.0, 80.0, -97.0, 62.0, 116.0, -15.0, 0.0, -7.0, -15.0, -2.0, -72.0, -29.0, 6.0, -36.0, -44.0, 26.0, 0.0, 2.0, 34.0, 75.0, -31.0, -60.0, 0.0, -13.0, 2.0, -12.0, 48.0, 0.0, 3.0, -11.0, 56.0, -23.0, 49.0, -8.0, -29.0, -16.0, -19.0, 12.0, 14.0, 25.0, -10.0, 11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -62.0, -83.0, 115.0, 156.0, 0.0, -49.0, -256.0, -184.0, 47.0, 87.0, -168.0, -121.0, 0.0, -203.0, 0.0, -137.0, 128.0, 46.0, 9.0, -113.0, -12.0, 60.0, 59.0, 143.0, 10.0, -36.0, -167.0, -304.0, -38.0, 37.0, 0.0, 2.0, 120.0, 128.0, 0.0, -31.0, -310.0, 0.0, -363.0, -313.0, 62.0, 159.0, -237.0, -377.0, -86.0, -92.0, 177.0, -339.0, -218.0, 165.0, 0.0, 0.0, 118.0, -119.0, -113.0, 0.0, -9.0, -197.0, 0.0, 0.0, 166.0, -218.0, -352.0, -6.0, 116.0, 0.0, -390.0, 103.0, -114.0, 0.0, -293.0, -339.0, -396.0, -6.0, -252.0, 0.0, -232.0, -231.0, 44.0, 131.0, -365.0, -338.0, 0.0, 0.0, -62.0, -217.0, -103.0, 143.0, -194.0, 0.0, 0.0, 133.0, -338.0, -14.0, 50.0, -33.0, -80.0, -204.0, 106.0, 0.0, 99.0, 58.0, 66.0, 11.0, 0.0, -394.0, -28.0, -123.0, 0.0, -379.0, -352.0, -99.0, 0.0, -282.0, 0.0, 0.0, -2.0, 59.0, 0.0, -244.0, 0.0, 61.0, -20.0, 82.0, -5.0, -34.0, 0.0, 0.0, -56.0, -8.0, -92.0, 0.0, -43.0, 5.0, -79.0, -61.0, -53.0, -31.0, -34.0, -13.0, -60.0, -15.0, -51.0, -61.0, 6.0, -4.0, -22.0, 0.0, -18.0, -24.0, 19.0, 0.0, 7.0, 40.0, -18.0, -54.0, -71.0, -42.0, 0.0, 0.0, -73.0, -5.0, -17.0, 0.0, -22.0, -2.0, -27.0, 46.0, 0.0, 0.0, -7.0, -26.0, -16.0, -12.0, 17.0, 13.0, 0.0, -52.0, 0.0, 49.0, -27.0, 0.0, -43.0, -37.0, -52.0, 0.0, -2.0, -40.0, 0.0, -40.0, 2.0, -2.0, -53.0, 28.0, 0.0, -20.0, -24.0, 22.0], "policy_predator_policy_reward": [0.0, 0.0, 52.0, 22.0, 0.0, 0.0, 8.0, 74.0, 183.0, 30.0, 0.0, 0.0, 124.0, 12.0, 0.0, 119.0, 13.0, 74.0, 29.0, 0.0, 2.0, 101.0, 0.0, 72.0, 4.0, 11.0, 11.0, 73.0, 0.0, 186.0, 19.0, 0.0, 46.0, 15.0, 0.0, 32.0, 32.0, 11.0, 155.0, 141.0, 185.0, 124.0, 18.0, 0.0, 182.0, 128.0, 97.0, 2.0, 113.0, 95.0, 53.0, 109.0, 0.0, 0.0, 10.0, 87.0, 76.0, 3.0, 0.0, 129.0, 0.0, 0.0, 136.0, 0.0, 154.0, 115.0, 15.0, 11.0, 195.0, 30.0, 0.0, 57.0, 190.0, 4.0, 160.0, 178.0, 150.0, 2.0, 152.0, 4.0, 40.0, 26.0, 187.0, 189.0, 0.0, 0.0, 127.0, 48.0, 6.0, 92.0, 121.0, 4.0, 7.0, 7.0, 22.0, 174.0, 5.0, 78.0, 0.0, 147.0, 0.0, 0.0, 0.0, 44.0, 70.0, 13.0, 180.0, 90.0, 96.0, 24.0, 170.0, 130.0, 170.0, 125.0, 141.0, 23.0, 0.0, 0.0, 8.0, 15.0, 20.0, 127.0, 0.0, 1.0, 39.0, 15.0, 12.0, 12.0, 0.0, 0.0, 30.0, 27.0, 25.0, 52.0, 4.0, 32.0, 40.0, 28.0, 22.0, 33.0, 27.0, 26.0, 39.0, 0.0, 56.0, 12.0, 0.0, 24.0, 22.0, 0.0, 25.0, 19.0, 1.0, 14.0, 14.0, 14.0, 4.0, 37.0, 39.0, 14.0, 0.0, 0.0, 25.0, 40.0, 4.0, 15.0, 1.0, 11.0, 19.0, 10.0, 0.0, 0.0, 21.0, 15.0, 0.0, 17.0, 11.0, 15.0, 25.0, 4.0, 0.0, 0.0, 16.0, 3.0, 27.0, 24.0, 10.0, 26.0, 9.0, 14.0, 29.0, 23.0, 14.0, 0.0, 6.0, 44.0, 10.0, 0.0, 13.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.028584405106829, "mean_inference_ms": 3.234826555754945, "mean_action_processing_ms": 0.47016314931832154, "mean_env_wait_ms": 0.3673445986153169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00932300090789795, "StateBufferConnector_ms": 0.005448579788208008, "ViewRequirementAgentConnector_ms": 0.16102731227874756}, "num_episodes": 22, "episode_return_max": 280.0, "episode_return_min": -438.0, "episode_return_mean": -8.74, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 1712000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 357.02325305049106, "num_env_steps_trained_throughput_per_sec": 357.02325305049106, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 1712000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1712000, "timers": {"training_iteration_time_ms": 13047.851, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13047.743, "sample_time_ms": 2410.648, "learn_time_ms": 10615.676, "learn_throughput": 376.801, "synch_weights_time_ms": 17.817}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 1712000}, "done": false, "training_iteration": 107, "trial_id": "e1352_00002", "date": "2024-08-13_19-42-52", "timestamp": 1723592572, "time_this_iter_s": 11.25077199935913, "time_total_s": 2461.4540243148804, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d98040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2461.4540243148804, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 55.81875, "ram_util_percent": 83.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0267860018702413, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 1.421938905608717, "policy_loss": -0.0013468567557908871, "vf_loss": 1.4228856776441847, "vf_explained_var": 0.014239070875934822, "kl": 0.00888080118168778, "entropy": 0.9190889063966338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 203175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 60.836291188853124, "cur_kl_coeff": 0.0028156757354736326, "cur_lr": 0.00010000000000000003, "total_loss": 2.7910379824814973, "policy_loss": -0.004177752946547809, "vf_loss": 2.795183534596963, "vf_explained_var": -0.8938143046444686, "kl": 0.011439446811344343, "entropy": 1.0569254110099147, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 203175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "env_runners": {"episode_reward_max": 241.0, "episode_reward_min": -438.0, "episode_reward_mean": -14.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -396.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 177.0, "predator_policy": 195.0}, "policy_reward_mean": {"prey_policy": -46.11, "predator_policy": 38.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, -14.0, -367.0, 239.0, -304.0, -79.0, 46.0, 109.0, 0.0, 96.0, -34.0, -77.0, 0.0, 84.0, -89.0, 142.0, -62.0, -57.0, -438.0, -64.0, -100.0, -307.0, 241.0, -327.0, 0.0, -104.0, 138.0, -69.0, 147.0, -156.0, 100.0, -137.0, 106.0, 201.0, 160.0, -124.0, -31.0, -79.0, -156.0, -118.0, 0.0, 80.0, -97.0, 62.0, 116.0, -15.0, 0.0, -7.0, -15.0, -2.0, -72.0, -29.0, 6.0, -36.0, -44.0, 26.0, 0.0, 2.0, 34.0, 75.0, -31.0, -60.0, 0.0, -13.0, 2.0, -12.0, 48.0, 0.0, 3.0, -11.0, 56.0, -23.0, 49.0, -8.0, -29.0, -16.0, -19.0, 12.0, 14.0, 25.0, -10.0, 11.0, -11.0, 53.0, 6.0, -67.0, 79.0, 11.0, -6.0, -62.0, -10.0, 39.0, 10.0, -13.0, -4.0, 2.0, -6.0, -14.0, -6.0, -33.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -31.0, -310.0, 0.0, -363.0, -313.0, 62.0, 159.0, -237.0, -377.0, -86.0, -92.0, 177.0, -339.0, -218.0, 165.0, 0.0, 0.0, 118.0, -119.0, -113.0, 0.0, -9.0, -197.0, 0.0, 0.0, 166.0, -218.0, -352.0, -6.0, 116.0, 0.0, -390.0, 103.0, -114.0, 0.0, -293.0, -339.0, -396.0, -6.0, -252.0, 0.0, -232.0, -231.0, 44.0, 131.0, -365.0, -338.0, 0.0, 0.0, -62.0, -217.0, -103.0, 143.0, -194.0, 0.0, 0.0, 133.0, -338.0, -14.0, 50.0, -33.0, -80.0, -204.0, 106.0, 0.0, 99.0, 58.0, 66.0, 11.0, 0.0, -394.0, -28.0, -123.0, 0.0, -379.0, -352.0, -99.0, 0.0, -282.0, 0.0, 0.0, -2.0, 59.0, 0.0, -244.0, 0.0, 61.0, -20.0, 82.0, -5.0, -34.0, 0.0, 0.0, -56.0, -8.0, -92.0, 0.0, -43.0, 5.0, -79.0, -61.0, -53.0, -31.0, -34.0, -13.0, -60.0, -15.0, -51.0, -61.0, 6.0, -4.0, -22.0, 0.0, -18.0, -24.0, 19.0, 0.0, 7.0, 40.0, -18.0, -54.0, -71.0, -42.0, 0.0, 0.0, -73.0, -5.0, -17.0, 0.0, -22.0, -2.0, -27.0, 46.0, 0.0, 0.0, -7.0, -26.0, -16.0, -12.0, 17.0, 13.0, 0.0, -52.0, 0.0, 49.0, -27.0, 0.0, -43.0, -37.0, -52.0, 0.0, -2.0, -40.0, 0.0, -40.0, 2.0, -2.0, -53.0, 28.0, 0.0, -20.0, -24.0, 22.0, -19.0, -6.0, -3.0, 39.0, 0.0, -1.0, -43.0, -114.0, 34.0, 42.0, 0.0, -14.0, -2.0, -14.0, -48.0, -105.0, -28.0, 0.0, 0.0, 35.0, -7.0, 13.0, -32.0, -21.0, -11.0, -32.0, 0.0, -1.0, -12.0, 0.0, -32.0, 0.0, -41.0, 0.0, 6.0, -116.0], "policy_predator_policy_reward": [32.0, 11.0, 155.0, 141.0, 185.0, 124.0, 18.0, 0.0, 182.0, 128.0, 97.0, 2.0, 113.0, 95.0, 53.0, 109.0, 0.0, 0.0, 10.0, 87.0, 76.0, 3.0, 0.0, 129.0, 0.0, 0.0, 136.0, 0.0, 154.0, 115.0, 15.0, 11.0, 195.0, 30.0, 0.0, 57.0, 190.0, 4.0, 160.0, 178.0, 150.0, 2.0, 152.0, 4.0, 40.0, 26.0, 187.0, 189.0, 0.0, 0.0, 127.0, 48.0, 6.0, 92.0, 121.0, 4.0, 7.0, 7.0, 22.0, 174.0, 5.0, 78.0, 0.0, 147.0, 0.0, 0.0, 0.0, 44.0, 70.0, 13.0, 180.0, 90.0, 96.0, 24.0, 170.0, 130.0, 170.0, 125.0, 141.0, 23.0, 0.0, 0.0, 8.0, 15.0, 20.0, 127.0, 0.0, 1.0, 39.0, 15.0, 12.0, 12.0, 0.0, 0.0, 30.0, 27.0, 25.0, 52.0, 4.0, 32.0, 40.0, 28.0, 22.0, 33.0, 27.0, 26.0, 39.0, 0.0, 56.0, 12.0, 0.0, 24.0, 22.0, 0.0, 25.0, 19.0, 1.0, 14.0, 14.0, 14.0, 4.0, 37.0, 39.0, 14.0, 0.0, 0.0, 25.0, 40.0, 4.0, 15.0, 1.0, 11.0, 19.0, 10.0, 0.0, 0.0, 21.0, 15.0, 0.0, 17.0, 11.0, 15.0, 25.0, 4.0, 0.0, 0.0, 16.0, 3.0, 27.0, 24.0, 10.0, 26.0, 9.0, 14.0, 29.0, 23.0, 14.0, 0.0, 6.0, 44.0, 10.0, 0.0, 13.0, 0.0, 11.0, 3.0, 1.0, 16.0, 0.0, 7.0, 28.0, 62.0, 3.0, 0.0, 12.0, 13.0, 10.0, 0.0, 53.0, 38.0, 18.0, 0.0, 0.0, 4.0, 0.0, 4.0, 0.0, 40.0, 19.0, 20.0, 3.0, 0.0, 4.0, 2.0, 0.0, 18.0, 25.0, 10.0, 56.0, 21.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0277245476761792, "mean_inference_ms": 3.233475810901035, "mean_action_processing_ms": 0.4758922202676919, "mean_env_wait_ms": 0.36672400490360324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076340436935424805, "StateBufferConnector_ms": 0.004645705223083496, "ViewRequirementAgentConnector_ms": 0.1555638313293457}, "num_episodes": 18, "episode_return_max": 241.0, "episode_return_min": -438.0, "episode_return_mean": -14.32, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 340.29601619850655, "num_env_steps_trained_throughput_per_sec": 340.29601619850655, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 1728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1728000, "timers": {"training_iteration_time_ms": 12997.582, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12997.506, "sample_time_ms": 2411.096, "learn_time_ms": 10565.743, "learn_throughput": 378.582, "synch_weights_time_ms": 17.446}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "done": false, "training_iteration": 108, "trial_id": "e1352_00002", "date": "2024-08-13_19-43-04", "timestamp": 1723592584, "time_this_iter_s": 11.807215213775635, "time_total_s": 2473.261239528656, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e68790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2473.261239528656, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 60.56470588235294, "ram_util_percent": 83.62352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0571495205952375, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 4.2834001667285095, "policy_loss": -0.0036654922624596606, "vf_loss": 4.286607209336821, "vf_explained_var": 0.0026694146413651725, "kl": 0.010176395742474439, "entropy": 0.9016938858246677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 205065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.51456891569511, "cur_kl_coeff": 0.0028156757354736326, "cur_lr": 0.00010000000000000003, "total_loss": 4.514751148854614, "policy_loss": -0.008152692023511956, "vf_loss": 4.52279781765408, "vf_explained_var": -0.38404854495058616, "kl": 0.0376606313240977, "entropy": 0.9005389820330988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 205065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 1744000}, "env_runners": {"episode_reward_max": 252.0, "episode_reward_min": -438.0, "episode_reward_mean": -6.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -396.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 181.0, "predator_policy": 190.0}, "policy_reward_mean": {"prey_policy": -35.215, "predator_policy": 32.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-438.0, -64.0, -100.0, -307.0, 241.0, -327.0, 0.0, -104.0, 138.0, -69.0, 147.0, -156.0, 100.0, -137.0, 106.0, 201.0, 160.0, -124.0, -31.0, -79.0, -156.0, -118.0, 0.0, 80.0, -97.0, 62.0, 116.0, -15.0, 0.0, -7.0, -15.0, -2.0, -72.0, -29.0, 6.0, -36.0, -44.0, 26.0, 0.0, 2.0, 34.0, 75.0, -31.0, -60.0, 0.0, -13.0, 2.0, -12.0, 48.0, 0.0, 3.0, -11.0, 56.0, -23.0, 49.0, -8.0, -29.0, -16.0, -19.0, 12.0, 14.0, 25.0, -10.0, 11.0, -11.0, 53.0, 6.0, -67.0, 79.0, 11.0, -6.0, -62.0, -10.0, 39.0, 10.0, -13.0, -4.0, 2.0, -6.0, -14.0, -6.0, -33.0, 8.0, -103.0, 2.0, 252.0, 135.0, 145.0, -10.0, -29.0, 0.0, 33.0, 50.0, 0.0, 1.0, -58.0, 22.0, -48.0, -7.0, 61.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-293.0, -339.0, -396.0, -6.0, -252.0, 0.0, -232.0, -231.0, 44.0, 131.0, -365.0, -338.0, 0.0, 0.0, -62.0, -217.0, -103.0, 143.0, -194.0, 0.0, 0.0, 133.0, -338.0, -14.0, 50.0, -33.0, -80.0, -204.0, 106.0, 0.0, 99.0, 58.0, 66.0, 11.0, 0.0, -394.0, -28.0, -123.0, 0.0, -379.0, -352.0, -99.0, 0.0, -282.0, 0.0, 0.0, -2.0, 59.0, 0.0, -244.0, 0.0, 61.0, -20.0, 82.0, -5.0, -34.0, 0.0, 0.0, -56.0, -8.0, -92.0, 0.0, -43.0, 5.0, -79.0, -61.0, -53.0, -31.0, -34.0, -13.0, -60.0, -15.0, -51.0, -61.0, 6.0, -4.0, -22.0, 0.0, -18.0, -24.0, 19.0, 0.0, 7.0, 40.0, -18.0, -54.0, -71.0, -42.0, 0.0, 0.0, -73.0, -5.0, -17.0, 0.0, -22.0, -2.0, -27.0, 46.0, 0.0, 0.0, -7.0, -26.0, -16.0, -12.0, 17.0, 13.0, 0.0, -52.0, 0.0, 49.0, -27.0, 0.0, -43.0, -37.0, -52.0, 0.0, -2.0, -40.0, 0.0, -40.0, 2.0, -2.0, -53.0, 28.0, 0.0, -20.0, -24.0, 22.0, -19.0, -6.0, -3.0, 39.0, 0.0, -1.0, -43.0, -114.0, 34.0, 42.0, 0.0, -14.0, -2.0, -14.0, -48.0, -105.0, -28.0, 0.0, 0.0, 35.0, -7.0, 13.0, -32.0, -21.0, -11.0, -32.0, 0.0, -1.0, -12.0, 0.0, -32.0, 0.0, -41.0, 0.0, 6.0, -116.0, -1.0, -6.0, 0.0, -254.0, -26.0, -6.0, 181.0, -94.0, 89.0, -23.0, 3.0, 105.0, -20.0, -4.0, -165.0, -24.0, 0.0, 0.0, 0.0, -38.0, 23.0, 22.0, 0.0, 0.0, -23.0, 4.0, -173.0, -12.0, 12.0, -4.0, -172.0, 0.0, -22.0, 3.0, 17.0, -31.0], "policy_predator_policy_reward": [190.0, 4.0, 160.0, 178.0, 150.0, 2.0, 152.0, 4.0, 40.0, 26.0, 187.0, 189.0, 0.0, 0.0, 127.0, 48.0, 6.0, 92.0, 121.0, 4.0, 7.0, 7.0, 22.0, 174.0, 5.0, 78.0, 0.0, 147.0, 0.0, 0.0, 0.0, 44.0, 70.0, 13.0, 180.0, 90.0, 96.0, 24.0, 170.0, 130.0, 170.0, 125.0, 141.0, 23.0, 0.0, 0.0, 8.0, 15.0, 20.0, 127.0, 0.0, 1.0, 39.0, 15.0, 12.0, 12.0, 0.0, 0.0, 30.0, 27.0, 25.0, 52.0, 4.0, 32.0, 40.0, 28.0, 22.0, 33.0, 27.0, 26.0, 39.0, 0.0, 56.0, 12.0, 0.0, 24.0, 22.0, 0.0, 25.0, 19.0, 1.0, 14.0, 14.0, 14.0, 4.0, 37.0, 39.0, 14.0, 0.0, 0.0, 25.0, 40.0, 4.0, 15.0, 1.0, 11.0, 19.0, 10.0, 0.0, 0.0, 21.0, 15.0, 0.0, 17.0, 11.0, 15.0, 25.0, 4.0, 0.0, 0.0, 16.0, 3.0, 27.0, 24.0, 10.0, 26.0, 9.0, 14.0, 29.0, 23.0, 14.0, 0.0, 6.0, 44.0, 10.0, 0.0, 13.0, 0.0, 11.0, 3.0, 1.0, 16.0, 0.0, 7.0, 28.0, 62.0, 3.0, 0.0, 12.0, 13.0, 10.0, 0.0, 53.0, 38.0, 18.0, 0.0, 0.0, 4.0, 0.0, 4.0, 0.0, 40.0, 19.0, 20.0, 3.0, 0.0, 4.0, 2.0, 0.0, 18.0, 25.0, 10.0, 56.0, 21.0, 15.0, 0.0, 151.0, 0.0, 21.0, 13.0, 87.0, 78.0, 39.0, 30.0, 28.0, 9.0, 14.0, 0.0, 75.0, 85.0, 0.0, 0.0, 0.0, 71.0, 1.0, 4.0, 0.0, 0.0, 5.0, 15.0, 101.0, 26.0, 5.0, 9.0, 124.0, 0.0, 0.0, 12.0, 3.0, 72.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0266037340956948, "mean_inference_ms": 3.2298676135833806, "mean_action_processing_ms": 0.4816618393527607, "mean_env_wait_ms": 0.36622606576003774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007655024528503418, "StateBufferConnector_ms": 0.004721283912658691, "ViewRequirementAgentConnector_ms": 0.1690765619277954}, "num_episodes": 18, "episode_return_max": 252.0, "episode_return_min": -438.0, "episode_return_mean": -6.23, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 1744000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.0984974597292, "num_env_steps_trained_throughput_per_sec": 317.0984974597292, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 1744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1744000, "timers": {"training_iteration_time_ms": 12777.682, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12777.607, "sample_time_ms": 2379.462, "learn_time_ms": 10370.071, "learn_throughput": 385.725, "synch_weights_time_ms": 25.224}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 1744000}, "done": false, "training_iteration": 109, "trial_id": "e1352_00002", "date": "2024-08-13_19-43-17", "timestamp": 1723592597, "time_this_iter_s": 12.718003034591675, "time_total_s": 2485.9792425632477, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e5ae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2485.9792425632477, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 63.70000000000001, "ram_util_percent": 83.69444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0289100071267474, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 4.2343400136503595, "policy_loss": -0.005640239101125016, "vf_loss": 4.23927816209339, "vf_explained_var": 0.002921095033171316, "kl": 0.01558426027315491, "entropy": 0.901030535357339, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 206955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.12878450374439, "cur_kl_coeff": 0.00422351360321045, "cur_lr": 0.00010000000000000003, "total_loss": 5.655020455960874, "policy_loss": -0.0014385690222735758, "vf_loss": 5.65643233899717, "vf_explained_var": -0.2803465400423322, "kl": 0.006321127661241343, "entropy": 0.9008164227639557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 206955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "env_runners": {"episode_reward_max": 252.0, "episode_reward_min": -355.0, "episode_reward_mean": 4.6, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -322.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.0, "predator_policy": 171.0}, "policy_reward_mean": {"prey_policy": -23.44, "predator_policy": 25.74}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.0, -97.0, 62.0, 116.0, -15.0, 0.0, -7.0, -15.0, -2.0, -72.0, -29.0, 6.0, -36.0, -44.0, 26.0, 0.0, 2.0, 34.0, 75.0, -31.0, -60.0, 0.0, -13.0, 2.0, -12.0, 48.0, 0.0, 3.0, -11.0, 56.0, -23.0, 49.0, -8.0, -29.0, -16.0, -19.0, 12.0, 14.0, 25.0, -10.0, 11.0, -11.0, 53.0, 6.0, -67.0, 79.0, 11.0, -6.0, -62.0, -10.0, 39.0, 10.0, -13.0, -4.0, 2.0, -6.0, -14.0, -6.0, -33.0, 8.0, -103.0, 2.0, 252.0, 135.0, 145.0, -10.0, -29.0, 0.0, 33.0, 50.0, 0.0, 1.0, -58.0, 22.0, -48.0, -7.0, 61.0, 0.0, 171.0, 58.0, -304.0, 150.0, 11.0, 0.0, 7.0, -41.0, -112.0, 157.0, -64.0, -28.0, 62.0, 195.0, 58.0, 165.0, 17.0, 81.0, -190.0, -33.0, -39.0, -355.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, 59.0, 0.0, -244.0, 0.0, 61.0, -20.0, 82.0, -5.0, -34.0, 0.0, 0.0, -56.0, -8.0, -92.0, 0.0, -43.0, 5.0, -79.0, -61.0, -53.0, -31.0, -34.0, -13.0, -60.0, -15.0, -51.0, -61.0, 6.0, -4.0, -22.0, 0.0, -18.0, -24.0, 19.0, 0.0, 7.0, 40.0, -18.0, -54.0, -71.0, -42.0, 0.0, 0.0, -73.0, -5.0, -17.0, 0.0, -22.0, -2.0, -27.0, 46.0, 0.0, 0.0, -7.0, -26.0, -16.0, -12.0, 17.0, 13.0, 0.0, -52.0, 0.0, 49.0, -27.0, 0.0, -43.0, -37.0, -52.0, 0.0, -2.0, -40.0, 0.0, -40.0, 2.0, -2.0, -53.0, 28.0, 0.0, -20.0, -24.0, 22.0, -19.0, -6.0, -3.0, 39.0, 0.0, -1.0, -43.0, -114.0, 34.0, 42.0, 0.0, -14.0, -2.0, -14.0, -48.0, -105.0, -28.0, 0.0, 0.0, 35.0, -7.0, 13.0, -32.0, -21.0, -11.0, -32.0, 0.0, -1.0, -12.0, 0.0, -32.0, 0.0, -41.0, 0.0, 6.0, -116.0, -1.0, -6.0, 0.0, -254.0, -26.0, -6.0, 181.0, -94.0, 89.0, -23.0, 3.0, 105.0, -20.0, -4.0, -165.0, -24.0, 0.0, 0.0, 0.0, -38.0, 23.0, 22.0, 0.0, 0.0, -23.0, 4.0, -173.0, -12.0, 12.0, -4.0, -172.0, 0.0, -22.0, 3.0, 17.0, -31.0, 0.0, 0.0, 173.0, -4.0, 40.0, 0.0, -322.0, -317.0, -229.0, 191.0, 0.0, -21.0, 0.0, 0.0, 7.0, 0.0, -28.0, -58.0, -275.0, 0.0, 0.0, 157.0, -162.0, -100.0, 0.0, -140.0, 27.0, 0.0, -161.0, 184.0, -33.0, 0.0, 176.0, -22.0, 5.0, 12.0, -44.0, 66.0, -195.0, -316.0, -91.0, 0.0, 11.0, -166.0, -305.0, -218.0], "policy_predator_policy_reward": [8.0, 15.0, 20.0, 127.0, 0.0, 1.0, 39.0, 15.0, 12.0, 12.0, 0.0, 0.0, 30.0, 27.0, 25.0, 52.0, 4.0, 32.0, 40.0, 28.0, 22.0, 33.0, 27.0, 26.0, 39.0, 0.0, 56.0, 12.0, 0.0, 24.0, 22.0, 0.0, 25.0, 19.0, 1.0, 14.0, 14.0, 14.0, 4.0, 37.0, 39.0, 14.0, 0.0, 0.0, 25.0, 40.0, 4.0, 15.0, 1.0, 11.0, 19.0, 10.0, 0.0, 0.0, 21.0, 15.0, 0.0, 17.0, 11.0, 15.0, 25.0, 4.0, 0.0, 0.0, 16.0, 3.0, 27.0, 24.0, 10.0, 26.0, 9.0, 14.0, 29.0, 23.0, 14.0, 0.0, 6.0, 44.0, 10.0, 0.0, 13.0, 0.0, 11.0, 3.0, 1.0, 16.0, 0.0, 7.0, 28.0, 62.0, 3.0, 0.0, 12.0, 13.0, 10.0, 0.0, 53.0, 38.0, 18.0, 0.0, 0.0, 4.0, 0.0, 4.0, 0.0, 40.0, 19.0, 20.0, 3.0, 0.0, 4.0, 2.0, 0.0, 18.0, 25.0, 10.0, 56.0, 21.0, 15.0, 0.0, 151.0, 0.0, 21.0, 13.0, 87.0, 78.0, 39.0, 30.0, 28.0, 9.0, 14.0, 0.0, 75.0, 85.0, 0.0, 0.0, 0.0, 71.0, 1.0, 4.0, 0.0, 0.0, 5.0, 15.0, 101.0, 26.0, 5.0, 9.0, 124.0, 0.0, 0.0, 12.0, 3.0, 72.0, 0.0, 0.0, 2.0, 0.0, 6.0, 12.0, 164.0, 171.0, 110.0, 78.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 24.0, 139.0, 0.0, 0.0, 71.0, 127.0, 19.0, 93.0, 0.0, 35.0, 73.0, 99.0, 55.0, 36.0, 0.0, 11.0, 0.0, 0.0, 37.0, 22.0, 155.0, 166.0, 58.0, 0.0, 116.0, 0.0, 168.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.025078003027974, "mean_inference_ms": 3.2256298605296267, "mean_action_processing_ms": 0.4891838141252886, "mean_env_wait_ms": 0.3657087609936342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005913376808166504, "StateBufferConnector_ms": 0.0051146745681762695, "ViewRequirementAgentConnector_ms": 0.16258811950683594}, "num_episodes": 23, "episode_return_max": 252.0, "episode_return_min": -355.0, "episode_return_mean": 4.6, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.22221979273104, "num_env_steps_trained_throughput_per_sec": 290.22221979273104, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 1760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1760000, "timers": {"training_iteration_time_ms": 12830.23, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12830.151, "sample_time_ms": 2417.559, "learn_time_ms": 10384.027, "learn_throughput": 385.207, "synch_weights_time_ms": 25.455}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "done": false, "training_iteration": 110, "trial_id": "e1352_00002", "date": "2024-08-13_19-43-31", "timestamp": 1723592611, "time_this_iter_s": 13.847580194473267, "time_total_s": 2499.826822757721, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d98040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2499.826822757721, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 67.13, "ram_util_percent": 83.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.078000979101847, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 4.220815348246741, "policy_loss": -0.003068606785089566, "vf_loss": 4.223440126514939, "vf_explained_var": 0.005107345593669427, "kl": 0.009851894432084663, "entropy": 0.9313689290531098, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 208845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.642319422991818, "cur_kl_coeff": 0.00422351360321045, "cur_lr": 0.00010000000000000003, "total_loss": 6.516085802814948, "policy_loss": -0.0014371551421751814, "vf_loss": 6.517490605197886, "vf_explained_var": -0.0795456762351687, "kl": 0.007659809898570298, "entropy": 0.8260022068465197, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 208845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "env_runners": {"episode_reward_max": 252.0, "episode_reward_min": -534.0, "episode_reward_mean": -0.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -379.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -30.245, "predator_policy": 29.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.0, -31.0, -60.0, 0.0, -13.0, 2.0, -12.0, 48.0, 0.0, 3.0, -11.0, 56.0, -23.0, 49.0, -8.0, -29.0, -16.0, -19.0, 12.0, 14.0, 25.0, -10.0, 11.0, -11.0, 53.0, 6.0, -67.0, 79.0, 11.0, -6.0, -62.0, -10.0, 39.0, 10.0, -13.0, -4.0, 2.0, -6.0, -14.0, -6.0, -33.0, 8.0, -103.0, 2.0, 252.0, 135.0, 145.0, -10.0, -29.0, 0.0, 33.0, 50.0, 0.0, 1.0, -58.0, 22.0, -48.0, -7.0, 61.0, 0.0, 171.0, 58.0, -304.0, 150.0, 11.0, 0.0, 7.0, -41.0, -112.0, 157.0, -64.0, -28.0, 62.0, 195.0, 58.0, 165.0, 17.0, 81.0, -190.0, -33.0, -39.0, -355.0, -324.0, 18.0, 0.0, 150.0, 26.0, -19.0, -181.0, -130.0, 0.0, 113.0, 51.0, 226.0, -473.0, 87.0, 138.0, 112.0, 200.0, -534.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [7.0, 40.0, -18.0, -54.0, -71.0, -42.0, 0.0, 0.0, -73.0, -5.0, -17.0, 0.0, -22.0, -2.0, -27.0, 46.0, 0.0, 0.0, -7.0, -26.0, -16.0, -12.0, 17.0, 13.0, 0.0, -52.0, 0.0, 49.0, -27.0, 0.0, -43.0, -37.0, -52.0, 0.0, -2.0, -40.0, 0.0, -40.0, 2.0, -2.0, -53.0, 28.0, 0.0, -20.0, -24.0, 22.0, -19.0, -6.0, -3.0, 39.0, 0.0, -1.0, -43.0, -114.0, 34.0, 42.0, 0.0, -14.0, -2.0, -14.0, -48.0, -105.0, -28.0, 0.0, 0.0, 35.0, -7.0, 13.0, -32.0, -21.0, -11.0, -32.0, 0.0, -1.0, -12.0, 0.0, -32.0, 0.0, -41.0, 0.0, 6.0, -116.0, -1.0, -6.0, 0.0, -254.0, -26.0, -6.0, 181.0, -94.0, 89.0, -23.0, 3.0, 105.0, -20.0, -4.0, -165.0, -24.0, 0.0, 0.0, 0.0, -38.0, 23.0, 22.0, 0.0, 0.0, -23.0, 4.0, -173.0, -12.0, 12.0, -4.0, -172.0, 0.0, -22.0, 3.0, 17.0, -31.0, 0.0, 0.0, 173.0, -4.0, 40.0, 0.0, -322.0, -317.0, -229.0, 191.0, 0.0, -21.0, 0.0, 0.0, 7.0, 0.0, -28.0, -58.0, -275.0, 0.0, 0.0, 157.0, -162.0, -100.0, 0.0, -140.0, 27.0, 0.0, -161.0, 184.0, -33.0, 0.0, 176.0, -22.0, 5.0, 12.0, -44.0, 66.0, -195.0, -316.0, -91.0, 0.0, 11.0, -166.0, -305.0, -218.0, -210.0, -322.0, -50.0, 0.0, 0.0, 0.0, 150.0, 0.0, 45.0, -99.0, 0.0, -60.0, -347.0, -177.0, 21.0, -340.0, 0.0, 0.0, 113.0, 0.0, -15.0, 0.0, 107.0, 99.0, -317.0, -356.0, 47.0, 0.0, 119.0, -72.0, 80.0, 0.0, 68.0, 90.0, -354.0, -379.0], "policy_predator_policy_reward": [14.0, 14.0, 4.0, 37.0, 39.0, 14.0, 0.0, 0.0, 25.0, 40.0, 4.0, 15.0, 1.0, 11.0, 19.0, 10.0, 0.0, 0.0, 21.0, 15.0, 0.0, 17.0, 11.0, 15.0, 25.0, 4.0, 0.0, 0.0, 16.0, 3.0, 27.0, 24.0, 10.0, 26.0, 9.0, 14.0, 29.0, 23.0, 14.0, 0.0, 6.0, 44.0, 10.0, 0.0, 13.0, 0.0, 11.0, 3.0, 1.0, 16.0, 0.0, 7.0, 28.0, 62.0, 3.0, 0.0, 12.0, 13.0, 10.0, 0.0, 53.0, 38.0, 18.0, 0.0, 0.0, 4.0, 0.0, 4.0, 0.0, 40.0, 19.0, 20.0, 3.0, 0.0, 4.0, 2.0, 0.0, 18.0, 25.0, 10.0, 56.0, 21.0, 15.0, 0.0, 151.0, 0.0, 21.0, 13.0, 87.0, 78.0, 39.0, 30.0, 28.0, 9.0, 14.0, 0.0, 75.0, 85.0, 0.0, 0.0, 0.0, 71.0, 1.0, 4.0, 0.0, 0.0, 5.0, 15.0, 101.0, 26.0, 5.0, 9.0, 124.0, 0.0, 0.0, 12.0, 3.0, 72.0, 0.0, 0.0, 2.0, 0.0, 6.0, 12.0, 164.0, 171.0, 110.0, 78.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 24.0, 139.0, 0.0, 0.0, 71.0, 127.0, 19.0, 93.0, 0.0, 35.0, 73.0, 99.0, 55.0, 36.0, 0.0, 11.0, 0.0, 0.0, 37.0, 22.0, 155.0, 166.0, 58.0, 0.0, 116.0, 0.0, 168.0, 0.0, 31.0, 177.0, 66.0, 2.0, 0.0, 0.0, 0.0, 0.0, 77.0, 3.0, 24.0, 17.0, 169.0, 174.0, 136.0, 53.0, 0.0, 0.0, 0.0, 0.0, 54.0, 12.0, 0.0, 20.0, 187.0, 13.0, 30.0, 10.0, 9.0, 82.0, 19.0, 13.0, 42.0, 0.0, 0.0, 199.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0244847731545301, "mean_inference_ms": 3.2244063646214234, "mean_action_processing_ms": 0.4887411588033128, "mean_env_wait_ms": 0.3654585601843499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005977272987365723, "StateBufferConnector_ms": 0.005137085914611816, "ViewRequirementAgentConnector_ms": 0.1645505428314209}, "num_episodes": 18, "episode_return_max": 252.0, "episode_return_min": -534.0, "episode_return_mean": -0.89, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.41256926899956, "num_env_steps_trained_throughput_per_sec": 308.41256926899956, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 1776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1776000, "timers": {"training_iteration_time_ms": 12958.391, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12958.311, "sample_time_ms": 2507.949, "learn_time_ms": 10420.702, "learn_throughput": 383.851, "synch_weights_time_ms": 26.291}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "done": false, "training_iteration": 111, "trial_id": "e1352_00002", "date": "2024-08-13_19-43-44", "timestamp": 1723592624, "time_this_iter_s": 13.024950981140137, "time_total_s": 2512.851773738861, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e68e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2512.851773738861, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 61.06111111111112, "ram_util_percent": 83.53888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.102724335244093, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 3.8869943771412765, "policy_loss": -0.0030851579135747027, "vf_loss": 3.889449793951852, "vf_explained_var": -0.0014063322670245296, "kl": 0.013978599763598876, "entropy": 0.9062054389368289, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 210735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.57281779932282, "cur_kl_coeff": 0.00422351360321045, "cur_lr": 0.00010000000000000003, "total_loss": 5.45457223256429, "policy_loss": -0.0015962201153376589, "vf_loss": 5.456150441447263, "vf_explained_var": -0.23256015172080388, "kl": 0.0042660375487454105, "entropy": 0.8701232799146541, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 210735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000}, "env_runners": {"episode_reward_max": 293.0, "episode_reward_min": -534.0, "episode_reward_mean": -1.33, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -379.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -39.56, "predator_policy": 38.895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, -11.0, 53.0, 6.0, -67.0, 79.0, 11.0, -6.0, -62.0, -10.0, 39.0, 10.0, -13.0, -4.0, 2.0, -6.0, -14.0, -6.0, -33.0, 8.0, -103.0, 2.0, 252.0, 135.0, 145.0, -10.0, -29.0, 0.0, 33.0, 50.0, 0.0, 1.0, -58.0, 22.0, -48.0, -7.0, 61.0, 0.0, 171.0, 58.0, -304.0, 150.0, 11.0, 0.0, 7.0, -41.0, -112.0, 157.0, -64.0, -28.0, 62.0, 195.0, 58.0, 165.0, 17.0, 81.0, -190.0, -33.0, -39.0, -355.0, -324.0, 18.0, 0.0, 150.0, 26.0, -19.0, -181.0, -130.0, 0.0, 113.0, 51.0, 226.0, -473.0, 87.0, 138.0, 112.0, 200.0, -534.0, 4.0, -40.0, -348.0, 172.0, 1.0, 8.0, -172.0, 143.0, 73.0, 169.0, -252.0, -130.0, -12.0, -2.0, 293.0, 0.0, 154.0, 56.0, 0.0, -102.0, -55.0, 48.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.0, 22.0, -19.0, -6.0, -3.0, 39.0, 0.0, -1.0, -43.0, -114.0, 34.0, 42.0, 0.0, -14.0, -2.0, -14.0, -48.0, -105.0, -28.0, 0.0, 0.0, 35.0, -7.0, 13.0, -32.0, -21.0, -11.0, -32.0, 0.0, -1.0, -12.0, 0.0, -32.0, 0.0, -41.0, 0.0, 6.0, -116.0, -1.0, -6.0, 0.0, -254.0, -26.0, -6.0, 181.0, -94.0, 89.0, -23.0, 3.0, 105.0, -20.0, -4.0, -165.0, -24.0, 0.0, 0.0, 0.0, -38.0, 23.0, 22.0, 0.0, 0.0, -23.0, 4.0, -173.0, -12.0, 12.0, -4.0, -172.0, 0.0, -22.0, 3.0, 17.0, -31.0, 0.0, 0.0, 173.0, -4.0, 40.0, 0.0, -322.0, -317.0, -229.0, 191.0, 0.0, -21.0, 0.0, 0.0, 7.0, 0.0, -28.0, -58.0, -275.0, 0.0, 0.0, 157.0, -162.0, -100.0, 0.0, -140.0, 27.0, 0.0, -161.0, 184.0, -33.0, 0.0, 176.0, -22.0, 5.0, 12.0, -44.0, 66.0, -195.0, -316.0, -91.0, 0.0, 11.0, -166.0, -305.0, -218.0, -210.0, -322.0, -50.0, 0.0, 0.0, 0.0, 150.0, 0.0, 45.0, -99.0, 0.0, -60.0, -347.0, -177.0, 21.0, -340.0, 0.0, 0.0, 113.0, 0.0, -15.0, 0.0, 107.0, 99.0, -317.0, -356.0, 47.0, 0.0, 119.0, -72.0, 80.0, 0.0, 68.0, 90.0, -354.0, -379.0, 1.0, -142.0, -28.0, -30.0, -196.0, -324.0, -70.0, 179.0, 15.0, -42.0, -309.0, 55.0, -162.0, -186.0, 0.0, 120.0, 43.0, -268.0, 0.0, 161.0, -343.0, -267.0, -367.0, -82.0, -46.0, 0.0, -12.0, 0.0, 98.0, 150.0, 0.0, 0.0, -9.0, 138.0, -27.0, 5.0, 0.0, 0.0, -12.0, -230.0, -15.0, -192.0, -1.0, -26.0], "policy_predator_policy_reward": [13.0, 0.0, 11.0, 3.0, 1.0, 16.0, 0.0, 7.0, 28.0, 62.0, 3.0, 0.0, 12.0, 13.0, 10.0, 0.0, 53.0, 38.0, 18.0, 0.0, 0.0, 4.0, 0.0, 4.0, 0.0, 40.0, 19.0, 20.0, 3.0, 0.0, 4.0, 2.0, 0.0, 18.0, 25.0, 10.0, 56.0, 21.0, 15.0, 0.0, 151.0, 0.0, 21.0, 13.0, 87.0, 78.0, 39.0, 30.0, 28.0, 9.0, 14.0, 0.0, 75.0, 85.0, 0.0, 0.0, 0.0, 71.0, 1.0, 4.0, 0.0, 0.0, 5.0, 15.0, 101.0, 26.0, 5.0, 9.0, 124.0, 0.0, 0.0, 12.0, 3.0, 72.0, 0.0, 0.0, 2.0, 0.0, 6.0, 12.0, 164.0, 171.0, 110.0, 78.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 24.0, 139.0, 0.0, 0.0, 71.0, 127.0, 19.0, 93.0, 0.0, 35.0, 73.0, 99.0, 55.0, 36.0, 0.0, 11.0, 0.0, 0.0, 37.0, 22.0, 155.0, 166.0, 58.0, 0.0, 116.0, 0.0, 168.0, 0.0, 31.0, 177.0, 66.0, 2.0, 0.0, 0.0, 0.0, 0.0, 77.0, 3.0, 24.0, 17.0, 169.0, 174.0, 136.0, 53.0, 0.0, 0.0, 0.0, 0.0, 54.0, 12.0, 0.0, 20.0, 187.0, 13.0, 30.0, 10.0, 9.0, 82.0, 19.0, 13.0, 42.0, 0.0, 0.0, 199.0, 95.0, 50.0, 7.0, 11.0, 1.0, 171.0, 40.0, 23.0, 28.0, 0.0, 125.0, 137.0, 0.0, 176.0, 23.0, 0.0, 143.0, 155.0, 0.0, 8.0, 180.0, 178.0, 189.0, 130.0, 34.0, 0.0, 4.0, 6.0, 30.0, 15.0, 0.0, 0.0, 18.0, 7.0, 55.0, 23.0, 0.0, 0.0, 6.0, 134.0, 8.0, 144.0, 60.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.024921696626107, "mean_inference_ms": 3.2257409695175987, "mean_action_processing_ms": 0.48794837739156, "mean_env_wait_ms": 0.36543562564119925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063419342041015625, "StateBufferConnector_ms": 0.011312127113342285, "ViewRequirementAgentConnector_ms": 0.17994070053100586}, "num_episodes": 22, "episode_return_max": 293.0, "episode_return_min": -534.0, "episode_return_mean": -1.33, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 256.11936422335015, "num_env_steps_trained_throughput_per_sec": 256.11936422335015, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 1792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1792000, "timers": {"training_iteration_time_ms": 13305.353, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13305.273, "sample_time_ms": 2502.268, "learn_time_ms": 10771.714, "learn_throughput": 371.343, "synch_weights_time_ms": 27.4}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000}, "done": false, "training_iteration": 112, "trial_id": "e1352_00002", "date": "2024-08-13_19-44-00", "timestamp": 1723592640, "time_this_iter_s": 15.888894081115723, "time_total_s": 2528.740667819977, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e5a040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2528.740667819977, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 83.31739130434785, "ram_util_percent": 83.72173913043481}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1484607677689938, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 4.873040214291326, "policy_loss": -0.0021893178302518747, "vf_loss": 4.874791485039645, "vf_explained_var": 0.002141073015001085, "kl": 0.009723467993646675, "entropy": 0.9201581488526057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 212625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.522253681159523, "cur_kl_coeff": 0.002111756801605225, "cur_lr": 0.00010000000000000003, "total_loss": 5.304203314755959, "policy_loss": -0.002150640908687834, "vf_loss": 5.306337171004563, "vf_explained_var": -0.19780403590076184, "kl": 0.007949376084609149, "entropy": 0.8202738038446538, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 212625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 1808000}, "env_runners": {"episode_reward_max": 293.0, "episode_reward_min": -534.0, "episode_reward_mean": 0.31, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -379.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -44.33, "predator_policy": 44.485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.0, 8.0, -103.0, 2.0, 252.0, 135.0, 145.0, -10.0, -29.0, 0.0, 33.0, 50.0, 0.0, 1.0, -58.0, 22.0, -48.0, -7.0, 61.0, 0.0, 171.0, 58.0, -304.0, 150.0, 11.0, 0.0, 7.0, -41.0, -112.0, 157.0, -64.0, -28.0, 62.0, 195.0, 58.0, 165.0, 17.0, 81.0, -190.0, -33.0, -39.0, -355.0, -324.0, 18.0, 0.0, 150.0, 26.0, -19.0, -181.0, -130.0, 0.0, 113.0, 51.0, 226.0, -473.0, 87.0, 138.0, 112.0, 200.0, -534.0, 4.0, -40.0, -348.0, 172.0, 1.0, 8.0, -172.0, 143.0, 73.0, 169.0, -252.0, -130.0, -12.0, -2.0, 293.0, 0.0, 154.0, 56.0, 0.0, -102.0, -55.0, 48.0, 132.0, -5.0, -2.0, 36.0, -79.0, -32.0, 184.0, 0.0, 8.0, 45.0, 210.0, -156.0, -37.0, 222.0, 34.0, -120.0, -5.0, -259.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6.0, -116.0, -1.0, -6.0, 0.0, -254.0, -26.0, -6.0, 181.0, -94.0, 89.0, -23.0, 3.0, 105.0, -20.0, -4.0, -165.0, -24.0, 0.0, 0.0, 0.0, -38.0, 23.0, 22.0, 0.0, 0.0, -23.0, 4.0, -173.0, -12.0, 12.0, -4.0, -172.0, 0.0, -22.0, 3.0, 17.0, -31.0, 0.0, 0.0, 173.0, -4.0, 40.0, 0.0, -322.0, -317.0, -229.0, 191.0, 0.0, -21.0, 0.0, 0.0, 7.0, 0.0, -28.0, -58.0, -275.0, 0.0, 0.0, 157.0, -162.0, -100.0, 0.0, -140.0, 27.0, 0.0, -161.0, 184.0, -33.0, 0.0, 176.0, -22.0, 5.0, 12.0, -44.0, 66.0, -195.0, -316.0, -91.0, 0.0, 11.0, -166.0, -305.0, -218.0, -210.0, -322.0, -50.0, 0.0, 0.0, 0.0, 150.0, 0.0, 45.0, -99.0, 0.0, -60.0, -347.0, -177.0, 21.0, -340.0, 0.0, 0.0, 113.0, 0.0, -15.0, 0.0, 107.0, 99.0, -317.0, -356.0, 47.0, 0.0, 119.0, -72.0, 80.0, 0.0, 68.0, 90.0, -354.0, -379.0, 1.0, -142.0, -28.0, -30.0, -196.0, -324.0, -70.0, 179.0, 15.0, -42.0, -309.0, 55.0, -162.0, -186.0, 0.0, 120.0, 43.0, -268.0, 0.0, 161.0, -343.0, -267.0, -367.0, -82.0, -46.0, 0.0, -12.0, 0.0, 98.0, 150.0, 0.0, 0.0, -9.0, 138.0, -27.0, 5.0, 0.0, 0.0, -12.0, -230.0, -15.0, -192.0, -1.0, -26.0, 132.0, 0.0, 0.0, -94.0, -44.0, -28.0, -75.0, -10.0, 0.0, -214.0, -176.0, 0.0, 183.0, 0.0, 0.0, 0.0, 17.0, -18.0, -2.0, 38.0, 180.0, 20.0, 0.0, -326.0, -30.0, -128.0, 168.0, -33.0, 0.0, -9.0, 23.0, -342.0, 0.0, -24.0, -352.0, -235.0], "policy_predator_policy_reward": [56.0, 21.0, 15.0, 0.0, 151.0, 0.0, 21.0, 13.0, 87.0, 78.0, 39.0, 30.0, 28.0, 9.0, 14.0, 0.0, 75.0, 85.0, 0.0, 0.0, 0.0, 71.0, 1.0, 4.0, 0.0, 0.0, 5.0, 15.0, 101.0, 26.0, 5.0, 9.0, 124.0, 0.0, 0.0, 12.0, 3.0, 72.0, 0.0, 0.0, 2.0, 0.0, 6.0, 12.0, 164.0, 171.0, 110.0, 78.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 24.0, 139.0, 0.0, 0.0, 71.0, 127.0, 19.0, 93.0, 0.0, 35.0, 73.0, 99.0, 55.0, 36.0, 0.0, 11.0, 0.0, 0.0, 37.0, 22.0, 155.0, 166.0, 58.0, 0.0, 116.0, 0.0, 168.0, 0.0, 31.0, 177.0, 66.0, 2.0, 0.0, 0.0, 0.0, 0.0, 77.0, 3.0, 24.0, 17.0, 169.0, 174.0, 136.0, 53.0, 0.0, 0.0, 0.0, 0.0, 54.0, 12.0, 0.0, 20.0, 187.0, 13.0, 30.0, 10.0, 9.0, 82.0, 19.0, 13.0, 42.0, 0.0, 0.0, 199.0, 95.0, 50.0, 7.0, 11.0, 1.0, 171.0, 40.0, 23.0, 28.0, 0.0, 125.0, 137.0, 0.0, 176.0, 23.0, 0.0, 143.0, 155.0, 0.0, 8.0, 180.0, 178.0, 189.0, 130.0, 34.0, 0.0, 4.0, 6.0, 30.0, 15.0, 0.0, 0.0, 18.0, 7.0, 55.0, 23.0, 0.0, 0.0, 6.0, 134.0, 8.0, 144.0, 60.0, 15.0, 0.0, 0.0, 0.0, 89.0, 50.0, 20.0, 80.0, 41.0, 23.0, 112.0, 39.0, 105.0, 0.0, 1.0, 0.0, 0.0, 0.0, 9.0, 9.0, 0.0, 7.0, 3.0, 0.0, 170.0, 103.0, 18.0, 27.0, 60.0, 0.0, 43.0, 19.0, 180.0, 11.0, 8.0, 161.0, 167.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0326769724893752, "mean_inference_ms": 3.2479749691997073, "mean_action_processing_ms": 0.4903336482231626, "mean_env_wait_ms": 0.36873682230079347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07404088973999023, "StateBufferConnector_ms": 0.01356351375579834, "ViewRequirementAgentConnector_ms": 0.30300915241241455}, "num_episodes": 18, "episode_return_max": 293.0, "episode_return_min": -534.0, "episode_return_mean": 0.31, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 1808000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 142.67025948109563, "num_env_steps_trained_throughput_per_sec": 142.67025948109563, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 1808000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1808000, "timers": {"training_iteration_time_ms": 14768.441, "restore_workers_time_ms": 0.038, "training_step_time_ms": 14768.351, "sample_time_ms": 3517.897, "learn_time_ms": 11218.291, "learn_throughput": 356.561, "synch_weights_time_ms": 28.274}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 1808000}, "done": false, "training_iteration": 113, "trial_id": "e1352_00002", "date": "2024-08-13_19-44-28", "timestamp": 1723592668, "time_this_iter_s": 28.180723905563354, "time_total_s": 2556.92139172554, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b8cd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2556.92139172554, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 96.535, "ram_util_percent": 84.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.215132870174274, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 4.505939578379273, "policy_loss": -0.0033193455065388686, "vf_loss": 4.508821547094477, "vf_explained_var": 0.0045178143751053584, "kl": 0.009708448091446924, "entropy": 0.8722823014019658, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 214515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.20698792732582, "cur_kl_coeff": 0.002111756801605225, "cur_lr": 0.00010000000000000003, "total_loss": 5.220258515221732, "policy_loss": -0.0020134721181685566, "vf_loss": 5.222265185502471, "vf_explained_var": -0.2208357991364898, "kl": 0.003219932872147539, "entropy": 0.8544563774709348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 214515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "env_runners": {"episode_reward_max": 293.0, "episode_reward_min": -534.0, "episode_reward_mean": -5.35, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -383.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -52.0, "predator_policy": 49.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 11.0, 0.0, 7.0, -41.0, -112.0, 157.0, -64.0, -28.0, 62.0, 195.0, 58.0, 165.0, 17.0, 81.0, -190.0, -33.0, -39.0, -355.0, -324.0, 18.0, 0.0, 150.0, 26.0, -19.0, -181.0, -130.0, 0.0, 113.0, 51.0, 226.0, -473.0, 87.0, 138.0, 112.0, 200.0, -534.0, 4.0, -40.0, -348.0, 172.0, 1.0, 8.0, -172.0, 143.0, 73.0, 169.0, -252.0, -130.0, -12.0, -2.0, 293.0, 0.0, 154.0, 56.0, 0.0, -102.0, -55.0, 48.0, 132.0, -5.0, -2.0, 36.0, -79.0, -32.0, 184.0, 0.0, 8.0, 45.0, 210.0, -156.0, -37.0, 222.0, 34.0, -120.0, -5.0, -259.0, -54.0, 69.0, -7.0, 254.0, -47.0, -159.0, 21.0, 0.0, -82.0, -8.0, -28.0, 91.0, 200.0, -252.0, 7.0, -29.0, -6.0, -197.0, -45.0, -52.0, 2.0, -27.0, 129.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-229.0, 191.0, 0.0, -21.0, 0.0, 0.0, 7.0, 0.0, -28.0, -58.0, -275.0, 0.0, 0.0, 157.0, -162.0, -100.0, 0.0, -140.0, 27.0, 0.0, -161.0, 184.0, -33.0, 0.0, 176.0, -22.0, 5.0, 12.0, -44.0, 66.0, -195.0, -316.0, -91.0, 0.0, 11.0, -166.0, -305.0, -218.0, -210.0, -322.0, -50.0, 0.0, 0.0, 0.0, 150.0, 0.0, 45.0, -99.0, 0.0, -60.0, -347.0, -177.0, 21.0, -340.0, 0.0, 0.0, 113.0, 0.0, -15.0, 0.0, 107.0, 99.0, -317.0, -356.0, 47.0, 0.0, 119.0, -72.0, 80.0, 0.0, 68.0, 90.0, -354.0, -379.0, 1.0, -142.0, -28.0, -30.0, -196.0, -324.0, -70.0, 179.0, 15.0, -42.0, -309.0, 55.0, -162.0, -186.0, 0.0, 120.0, 43.0, -268.0, 0.0, 161.0, -343.0, -267.0, -367.0, -82.0, -46.0, 0.0, -12.0, 0.0, 98.0, 150.0, 0.0, 0.0, -9.0, 138.0, -27.0, 5.0, 0.0, 0.0, -12.0, -230.0, -15.0, -192.0, -1.0, -26.0, 132.0, 0.0, 0.0, -94.0, -44.0, -28.0, -75.0, -10.0, 0.0, -214.0, -176.0, 0.0, 183.0, 0.0, 0.0, 0.0, 17.0, -18.0, -2.0, 38.0, 180.0, 20.0, 0.0, -326.0, -30.0, -128.0, 168.0, -33.0, 0.0, -9.0, 23.0, -342.0, 0.0, -24.0, -352.0, -235.0, 54.0, -306.0, 42.0, 0.0, -66.0, 0.0, 128.0, 126.0, -224.0, -4.0, -360.0, 0.0, 63.0, -88.0, 0.0, 0.0, -383.0, 0.0, 0.0, -16.0, 0.0, -126.0, -211.0, 132.0, 150.0, -88.0, -192.0, -201.0, 7.0, 0.0, 0.0, -177.0, -12.0, 0.0, -276.0, -134.0, -290.0, 0.0, 48.0, -309.0, 0.0, 1.0, -102.0, 0.0, 0.0, 101.0], "policy_predator_policy_reward": [110.0, 78.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 24.0, 139.0, 0.0, 0.0, 71.0, 127.0, 19.0, 93.0, 0.0, 35.0, 73.0, 99.0, 55.0, 36.0, 0.0, 11.0, 0.0, 0.0, 37.0, 22.0, 155.0, 166.0, 58.0, 0.0, 116.0, 0.0, 168.0, 0.0, 31.0, 177.0, 66.0, 2.0, 0.0, 0.0, 0.0, 0.0, 77.0, 3.0, 24.0, 17.0, 169.0, 174.0, 136.0, 53.0, 0.0, 0.0, 0.0, 0.0, 54.0, 12.0, 0.0, 20.0, 187.0, 13.0, 30.0, 10.0, 9.0, 82.0, 19.0, 13.0, 42.0, 0.0, 0.0, 199.0, 95.0, 50.0, 7.0, 11.0, 1.0, 171.0, 40.0, 23.0, 28.0, 0.0, 125.0, 137.0, 0.0, 176.0, 23.0, 0.0, 143.0, 155.0, 0.0, 8.0, 180.0, 178.0, 189.0, 130.0, 34.0, 0.0, 4.0, 6.0, 30.0, 15.0, 0.0, 0.0, 18.0, 7.0, 55.0, 23.0, 0.0, 0.0, 6.0, 134.0, 8.0, 144.0, 60.0, 15.0, 0.0, 0.0, 0.0, 89.0, 50.0, 20.0, 80.0, 41.0, 23.0, 112.0, 39.0, 105.0, 0.0, 1.0, 0.0, 0.0, 0.0, 9.0, 9.0, 0.0, 7.0, 3.0, 0.0, 170.0, 103.0, 18.0, 27.0, 60.0, 0.0, 43.0, 19.0, 180.0, 11.0, 8.0, 161.0, 167.0, 26.0, 172.0, 18.0, 9.0, 46.0, 13.0, 0.0, 0.0, 138.0, 43.0, 21.0, 180.0, 0.0, 46.0, 0.0, 0.0, 178.0, 123.0, 0.0, 8.0, 98.0, 0.0, 48.0, 122.0, 59.0, 79.0, 138.0, 3.0, 0.0, 0.0, 31.0, 117.0, 0.0, 6.0, 190.0, 23.0, 146.0, 99.0, 36.0, 173.0, 0.0, 1.0, 75.0, 0.0, 0.0, 28.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0459832118421617, "mean_inference_ms": 3.2896081087695785, "mean_action_processing_ms": 0.49554352190155354, "mean_env_wait_ms": 0.3745952531500877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0821613073348999, "StateBufferConnector_ms": 0.018672704696655273, "ViewRequirementAgentConnector_ms": 0.34692835807800293}, "num_episodes": 23, "episode_return_max": 293.0, "episode_return_min": -534.0, "episode_return_mean": -5.35, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 171.0291711232018, "num_env_steps_trained_throughput_per_sec": 171.0291711232018, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 1824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1824000, "timers": {"training_iteration_time_ms": 15755.469, "restore_workers_time_ms": 0.038, "training_step_time_ms": 15755.38, "sample_time_ms": 3957.043, "learn_time_ms": 11766.46, "learn_throughput": 339.949, "synch_weights_time_ms": 28.428}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "done": false, "training_iteration": 114, "trial_id": "e1352_00002", "date": "2024-08-13_19-44-52", "timestamp": 1723592692, "time_this_iter_s": 23.512326955795288, "time_total_s": 2580.4337186813354, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b8c4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2580.4337186813354, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 93.7060606060606, "ram_util_percent": 84.05454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.368026373499916, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 3.803871156298925, "policy_loss": -0.0021363897826867525, "vf_loss": 3.8055636556060226, "vf_explained_var": 0.004709421957611407, "kl": 0.009853349254697602, "entropy": 0.9106899591350051, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 216405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.563799295665095, "cur_kl_coeff": 0.0010558784008026126, "cur_lr": 0.00010000000000000003, "total_loss": 5.684669434078156, "policy_loss": -0.004918194838267352, "vf_loss": 5.6895766924297995, "vf_explained_var": -0.18567000356300797, "kl": 0.010365817663718652, "entropy": 0.9031496268731577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 216405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "env_runners": {"episode_reward_max": 310.0, "episode_reward_min": -534.0, "episode_reward_mean": -17.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 183.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -59.63, "predator_policy": 50.685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-355.0, -324.0, 18.0, 0.0, 150.0, 26.0, -19.0, -181.0, -130.0, 0.0, 113.0, 51.0, 226.0, -473.0, 87.0, 138.0, 112.0, 200.0, -534.0, 4.0, -40.0, -348.0, 172.0, 1.0, 8.0, -172.0, 143.0, 73.0, 169.0, -252.0, -130.0, -12.0, -2.0, 293.0, 0.0, 154.0, 56.0, 0.0, -102.0, -55.0, 48.0, 132.0, -5.0, -2.0, 36.0, -79.0, -32.0, 184.0, 0.0, 8.0, 45.0, 210.0, -156.0, -37.0, 222.0, 34.0, -120.0, -5.0, -259.0, -54.0, 69.0, -7.0, 254.0, -47.0, -159.0, 21.0, 0.0, -82.0, -8.0, -28.0, 91.0, 200.0, -252.0, 7.0, -29.0, -6.0, -197.0, -45.0, -52.0, 2.0, -27.0, 129.0, 310.0, 0.0, -133.0, -13.0, 0.0, 124.0, -367.0, -197.0, -393.0, 125.0, -353.0, -22.0, 153.0, 51.0, 41.0, 160.0, 40.0, -384.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-305.0, -218.0, -210.0, -322.0, -50.0, 0.0, 0.0, 0.0, 150.0, 0.0, 45.0, -99.0, 0.0, -60.0, -347.0, -177.0, 21.0, -340.0, 0.0, 0.0, 113.0, 0.0, -15.0, 0.0, 107.0, 99.0, -317.0, -356.0, 47.0, 0.0, 119.0, -72.0, 80.0, 0.0, 68.0, 90.0, -354.0, -379.0, 1.0, -142.0, -28.0, -30.0, -196.0, -324.0, -70.0, 179.0, 15.0, -42.0, -309.0, 55.0, -162.0, -186.0, 0.0, 120.0, 43.0, -268.0, 0.0, 161.0, -343.0, -267.0, -367.0, -82.0, -46.0, 0.0, -12.0, 0.0, 98.0, 150.0, 0.0, 0.0, -9.0, 138.0, -27.0, 5.0, 0.0, 0.0, -12.0, -230.0, -15.0, -192.0, -1.0, -26.0, 132.0, 0.0, 0.0, -94.0, -44.0, -28.0, -75.0, -10.0, 0.0, -214.0, -176.0, 0.0, 183.0, 0.0, 0.0, 0.0, 17.0, -18.0, -2.0, 38.0, 180.0, 20.0, 0.0, -326.0, -30.0, -128.0, 168.0, -33.0, 0.0, -9.0, 23.0, -342.0, 0.0, -24.0, -352.0, -235.0, 54.0, -306.0, 42.0, 0.0, -66.0, 0.0, 128.0, 126.0, -224.0, -4.0, -360.0, 0.0, 63.0, -88.0, 0.0, 0.0, -383.0, 0.0, 0.0, -16.0, 0.0, -126.0, -211.0, 132.0, 150.0, -88.0, -192.0, -201.0, 7.0, 0.0, 0.0, -177.0, -12.0, 0.0, -276.0, -134.0, -290.0, 0.0, 48.0, -309.0, 0.0, 1.0, -102.0, 0.0, 0.0, 101.0, 141.0, 157.0, 0.0, 0.0, -236.0, -227.0, -5.0, -17.0, 0.0, 0.0, 0.0, 100.0, -320.0, -323.0, -167.0, -218.0, -392.0, -394.0, 101.0, 0.0, -368.0, -177.0, -26.0, -12.0, -2.0, 143.0, 0.0, 11.0, -49.0, 26.0, -8.0, 160.0, -19.0, -14.0, -369.0, -227.0], "policy_predator_policy_reward": [168.0, 0.0, 31.0, 177.0, 66.0, 2.0, 0.0, 0.0, 0.0, 0.0, 77.0, 3.0, 24.0, 17.0, 169.0, 174.0, 136.0, 53.0, 0.0, 0.0, 0.0, 0.0, 54.0, 12.0, 0.0, 20.0, 187.0, 13.0, 30.0, 10.0, 9.0, 82.0, 19.0, 13.0, 42.0, 0.0, 0.0, 199.0, 95.0, 50.0, 7.0, 11.0, 1.0, 171.0, 40.0, 23.0, 28.0, 0.0, 125.0, 137.0, 0.0, 176.0, 23.0, 0.0, 143.0, 155.0, 0.0, 8.0, 180.0, 178.0, 189.0, 130.0, 34.0, 0.0, 4.0, 6.0, 30.0, 15.0, 0.0, 0.0, 18.0, 7.0, 55.0, 23.0, 0.0, 0.0, 6.0, 134.0, 8.0, 144.0, 60.0, 15.0, 0.0, 0.0, 0.0, 89.0, 50.0, 20.0, 80.0, 41.0, 23.0, 112.0, 39.0, 105.0, 0.0, 1.0, 0.0, 0.0, 0.0, 9.0, 9.0, 0.0, 7.0, 3.0, 0.0, 170.0, 103.0, 18.0, 27.0, 60.0, 0.0, 43.0, 19.0, 180.0, 11.0, 8.0, 161.0, 167.0, 26.0, 172.0, 18.0, 9.0, 46.0, 13.0, 0.0, 0.0, 138.0, 43.0, 21.0, 180.0, 0.0, 46.0, 0.0, 0.0, 178.0, 123.0, 0.0, 8.0, 98.0, 0.0, 48.0, 122.0, 59.0, 79.0, 138.0, 3.0, 0.0, 0.0, 31.0, 117.0, 0.0, 6.0, 190.0, 23.0, 146.0, 99.0, 36.0, 173.0, 0.0, 1.0, 75.0, 0.0, 0.0, 28.0, 1.0, 11.0, 0.0, 0.0, 175.0, 155.0, 9.0, 0.0, 0.0, 0.0, 0.0, 24.0, 149.0, 127.0, 130.0, 58.0, 197.0, 196.0, 1.0, 23.0, 0.0, 192.0, 0.0, 16.0, 0.0, 12.0, 0.0, 40.0, 17.0, 47.0, 0.0, 8.0, 60.0, 13.0, 190.0, 22.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0595579306084613, "mean_inference_ms": 3.317821155561436, "mean_action_processing_ms": 0.49925967341395877, "mean_env_wait_ms": 0.37923740123731586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0823286771774292, "StateBufferConnector_ms": 0.017818927764892578, "ViewRequirementAgentConnector_ms": 0.3397139310836792}, "num_episodes": 18, "episode_return_max": 310.0, "episode_return_min": -534.0, "episode_return_mean": -17.89, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 244.88634286142585, "num_env_steps_trained_throughput_per_sec": 244.88634286142585, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 1840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1840000, "timers": {"training_iteration_time_ms": 15974.508, "restore_workers_time_ms": 0.038, "training_step_time_ms": 15974.42, "sample_time_ms": 4051.131, "learn_time_ms": 11890.724, "learn_throughput": 336.397, "synch_weights_time_ms": 28.596}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "done": false, "training_iteration": 115, "trial_id": "e1352_00002", "date": "2024-08-13_19-45-08", "timestamp": 1723592708, "time_this_iter_s": 16.39992070198059, "time_total_s": 2596.833639383316, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d94d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2596.833639383316, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 81.02608695652175, "ram_util_percent": 83.9086956521739}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2736948396478383, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 4.412330925653851, "policy_loss": -0.002835854496461926, "vf_loss": 4.414777417031545, "vf_explained_var": 0.00030599441477861355, "kl": 0.008642678261895964, "entropy": 0.8447596338375536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 218295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.364861893559258, "cur_kl_coeff": 0.0010558784008026126, "cur_lr": 0.00010000000000000003, "total_loss": 5.73008988193734, "policy_loss": -0.0010540856102668735, "vf_loss": 5.731138943112086, "vf_explained_var": -0.34267714843548164, "kl": 0.004761162757110214, "entropy": 0.9196761880602156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 218295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000}, "env_runners": {"episode_reward_max": 310.0, "episode_reward_min": -405.0, "episode_reward_mean": -13.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 183.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": -60.615, "predator_policy": 53.685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [172.0, 1.0, 8.0, -172.0, 143.0, 73.0, 169.0, -252.0, -130.0, -12.0, -2.0, 293.0, 0.0, 154.0, 56.0, 0.0, -102.0, -55.0, 48.0, 132.0, -5.0, -2.0, 36.0, -79.0, -32.0, 184.0, 0.0, 8.0, 45.0, 210.0, -156.0, -37.0, 222.0, 34.0, -120.0, -5.0, -259.0, -54.0, 69.0, -7.0, 254.0, -47.0, -159.0, 21.0, 0.0, -82.0, -8.0, -28.0, 91.0, 200.0, -252.0, 7.0, -29.0, -6.0, -197.0, -45.0, -52.0, 2.0, -27.0, 129.0, 310.0, 0.0, -133.0, -13.0, 0.0, 124.0, -367.0, -197.0, -393.0, 125.0, -353.0, -22.0, 153.0, 51.0, 41.0, 160.0, 40.0, -384.0, -99.0, -86.0, -10.0, -49.0, -405.0, 0.0, 113.0, 72.0, 71.0, 34.0, -194.0, -51.0, -17.0, -177.0, 139.0, 39.0, 6.0, 27.0, -114.0, -122.0, -20.0, -33.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-70.0, 179.0, 15.0, -42.0, -309.0, 55.0, -162.0, -186.0, 0.0, 120.0, 43.0, -268.0, 0.0, 161.0, -343.0, -267.0, -367.0, -82.0, -46.0, 0.0, -12.0, 0.0, 98.0, 150.0, 0.0, 0.0, -9.0, 138.0, -27.0, 5.0, 0.0, 0.0, -12.0, -230.0, -15.0, -192.0, -1.0, -26.0, 132.0, 0.0, 0.0, -94.0, -44.0, -28.0, -75.0, -10.0, 0.0, -214.0, -176.0, 0.0, 183.0, 0.0, 0.0, 0.0, 17.0, -18.0, -2.0, 38.0, 180.0, 20.0, 0.0, -326.0, -30.0, -128.0, 168.0, -33.0, 0.0, -9.0, 23.0, -342.0, 0.0, -24.0, -352.0, -235.0, 54.0, -306.0, 42.0, 0.0, -66.0, 0.0, 128.0, 126.0, -224.0, -4.0, -360.0, 0.0, 63.0, -88.0, 0.0, 0.0, -383.0, 0.0, 0.0, -16.0, 0.0, -126.0, -211.0, 132.0, 150.0, -88.0, -192.0, -201.0, 7.0, 0.0, 0.0, -177.0, -12.0, 0.0, -276.0, -134.0, -290.0, 0.0, 48.0, -309.0, 0.0, 1.0, -102.0, 0.0, 0.0, 101.0, 141.0, 157.0, 0.0, 0.0, -236.0, -227.0, -5.0, -17.0, 0.0, 0.0, 0.0, 100.0, -320.0, -323.0, -167.0, -218.0, -392.0, -394.0, 101.0, 0.0, -368.0, -177.0, -26.0, -12.0, -2.0, 143.0, 0.0, 11.0, -49.0, 26.0, -8.0, 160.0, -19.0, -14.0, -369.0, -227.0, -111.0, -132.0, -363.0, 0.0, -59.0, -44.0, 44.0, -216.0, -337.0, -257.0, 0.0, 0.0, -42.0, 129.0, 14.0, 35.0, 71.0, -84.0, 0.0, 34.0, -136.0, -300.0, -300.0, 50.0, -12.0, -110.0, -199.0, -134.0, 7.0, 92.0, 2.0, 16.0, -116.0, 31.0, 0.0, 9.0, -52.0, -197.0, -266.0, -4.0, -14.0, -334.0, -32.0, -281.0], "policy_predator_policy_reward": [40.0, 23.0, 28.0, 0.0, 125.0, 137.0, 0.0, 176.0, 23.0, 0.0, 143.0, 155.0, 0.0, 8.0, 180.0, 178.0, 189.0, 130.0, 34.0, 0.0, 4.0, 6.0, 30.0, 15.0, 0.0, 0.0, 18.0, 7.0, 55.0, 23.0, 0.0, 0.0, 6.0, 134.0, 8.0, 144.0, 60.0, 15.0, 0.0, 0.0, 0.0, 89.0, 50.0, 20.0, 80.0, 41.0, 23.0, 112.0, 39.0, 105.0, 0.0, 1.0, 0.0, 0.0, 0.0, 9.0, 9.0, 0.0, 7.0, 3.0, 0.0, 170.0, 103.0, 18.0, 27.0, 60.0, 0.0, 43.0, 19.0, 180.0, 11.0, 8.0, 161.0, 167.0, 26.0, 172.0, 18.0, 9.0, 46.0, 13.0, 0.0, 0.0, 138.0, 43.0, 21.0, 180.0, 0.0, 46.0, 0.0, 0.0, 178.0, 123.0, 0.0, 8.0, 98.0, 0.0, 48.0, 122.0, 59.0, 79.0, 138.0, 3.0, 0.0, 0.0, 31.0, 117.0, 0.0, 6.0, 190.0, 23.0, 146.0, 99.0, 36.0, 173.0, 0.0, 1.0, 75.0, 0.0, 0.0, 28.0, 1.0, 11.0, 0.0, 0.0, 175.0, 155.0, 9.0, 0.0, 0.0, 0.0, 0.0, 24.0, 149.0, 127.0, 130.0, 58.0, 197.0, 196.0, 1.0, 23.0, 0.0, 192.0, 0.0, 16.0, 0.0, 12.0, 0.0, 40.0, 17.0, 47.0, 0.0, 8.0, 60.0, 13.0, 190.0, 22.0, 10.0, 134.0, 119.0, 158.0, 0.0, 93.0, 0.0, 123.0, 172.0, 17.0, 0.0, 0.0, 21.0, 5.0, 23.0, 0.0, 0.0, 84.0, 0.0, 0.0, 60.0, 182.0, 46.0, 153.0, 95.0, 10.0, 144.0, 12.0, 14.0, 26.0, 0.0, 21.0, 87.0, 4.0, 0.0, 18.0, 109.0, 26.0, 2.0, 146.0, 177.0, 151.0, 139.0, 141.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0750955937504345, "mean_inference_ms": 3.3563931426171143, "mean_action_processing_ms": 0.5045641286054405, "mean_env_wait_ms": 0.38547518900673194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0842820405960083, "StateBufferConnector_ms": 0.017995119094848633, "ViewRequirementAgentConnector_ms": 0.3543611764907837}, "num_episodes": 22, "episode_return_max": 310.0, "episode_return_min": -405.0, "episode_return_mean": -13.86, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.2258128488723, "num_env_steps_trained_throughput_per_sec": 263.2258128488723, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 1856000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1856000, "timers": {"training_iteration_time_ms": 16089.733, "restore_workers_time_ms": 0.038, "training_step_time_ms": 16089.645, "sample_time_ms": 4063.205, "learn_time_ms": 11994.168, "learn_throughput": 333.495, "synch_weights_time_ms": 28.282}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000}, "done": false, "training_iteration": 116, "trial_id": "e1352_00002", "date": "2024-08-13_19-45-24", "timestamp": 1723592724, "time_this_iter_s": 15.268480062484741, "time_total_s": 2612.102119445801, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b8c3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2612.102119445801, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 82.33181818181818, "ram_util_percent": 83.94545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3581163406845125, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 4.326771579469953, "policy_loss": -0.0045668006206926685, "vf_loss": 4.3309148861617635, "vf_explained_var": -0.0029420988269583887, "kl": 0.009400831840779304, "entropy": 0.840524659459553, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 220185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.146825734821576, "cur_kl_coeff": 0.0005279392004013063, "cur_lr": 0.00010000000000000003, "total_loss": 4.7540332610014255, "policy_loss": -0.004138912151508506, "vf_loss": 4.758165273338399, "vf_explained_var": -0.3521569397714403, "kl": 0.013076780976735966, "entropy": 0.8891316744385573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 220185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "env_runners": {"episode_reward_max": 310.0, "episode_reward_min": -405.0, "episode_reward_mean": -18.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 183.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": -61.475, "predator_policy": 52.365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.0, 132.0, -5.0, -2.0, 36.0, -79.0, -32.0, 184.0, 0.0, 8.0, 45.0, 210.0, -156.0, -37.0, 222.0, 34.0, -120.0, -5.0, -259.0, -54.0, 69.0, -7.0, 254.0, -47.0, -159.0, 21.0, 0.0, -82.0, -8.0, -28.0, 91.0, 200.0, -252.0, 7.0, -29.0, -6.0, -197.0, -45.0, -52.0, 2.0, -27.0, 129.0, 310.0, 0.0, -133.0, -13.0, 0.0, 124.0, -367.0, -197.0, -393.0, 125.0, -353.0, -22.0, 153.0, 51.0, 41.0, 160.0, 40.0, -384.0, -99.0, -86.0, -10.0, -49.0, -405.0, 0.0, 113.0, 72.0, 71.0, 34.0, -194.0, -51.0, -17.0, -177.0, 139.0, 39.0, 6.0, 27.0, -114.0, -122.0, -20.0, -33.0, -233.0, -7.0, -33.0, 14.0, 29.0, 153.0, 21.0, 15.0, 131.0, 173.0, -6.0, -46.0, -20.0, 1.0, -137.0, -68.0, -44.0, -35.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1.0, -26.0, 132.0, 0.0, 0.0, -94.0, -44.0, -28.0, -75.0, -10.0, 0.0, -214.0, -176.0, 0.0, 183.0, 0.0, 0.0, 0.0, 17.0, -18.0, -2.0, 38.0, 180.0, 20.0, 0.0, -326.0, -30.0, -128.0, 168.0, -33.0, 0.0, -9.0, 23.0, -342.0, 0.0, -24.0, -352.0, -235.0, 54.0, -306.0, 42.0, 0.0, -66.0, 0.0, 128.0, 126.0, -224.0, -4.0, -360.0, 0.0, 63.0, -88.0, 0.0, 0.0, -383.0, 0.0, 0.0, -16.0, 0.0, -126.0, -211.0, 132.0, 150.0, -88.0, -192.0, -201.0, 7.0, 0.0, 0.0, -177.0, -12.0, 0.0, -276.0, -134.0, -290.0, 0.0, 48.0, -309.0, 0.0, 1.0, -102.0, 0.0, 0.0, 101.0, 141.0, 157.0, 0.0, 0.0, -236.0, -227.0, -5.0, -17.0, 0.0, 0.0, 0.0, 100.0, -320.0, -323.0, -167.0, -218.0, -392.0, -394.0, 101.0, 0.0, -368.0, -177.0, -26.0, -12.0, -2.0, 143.0, 0.0, 11.0, -49.0, 26.0, -8.0, 160.0, -19.0, -14.0, -369.0, -227.0, -111.0, -132.0, -363.0, 0.0, -59.0, -44.0, 44.0, -216.0, -337.0, -257.0, 0.0, 0.0, -42.0, 129.0, 14.0, 35.0, 71.0, -84.0, 0.0, 34.0, -136.0, -300.0, -300.0, 50.0, -12.0, -110.0, -199.0, -134.0, 7.0, 92.0, 2.0, 16.0, -116.0, 31.0, 0.0, 9.0, -52.0, -197.0, -266.0, -4.0, -14.0, -334.0, -32.0, -281.0, -219.0, -209.0, -14.0, 0.0, -337.0, 0.0, 3.0, 0.0, 0.0, 29.0, 129.0, 21.0, -26.0, -46.0, -43.0, 1.0, 115.0, -24.0, 147.0, -119.0, 0.0, -14.0, -131.0, -27.0, 0.0, -40.0, 1.0, 0.0, -310.0, -11.0, 9.0, -241.0, 37.0, -210.0, -318.0, 0.0], "policy_predator_policy_reward": [60.0, 15.0, 0.0, 0.0, 0.0, 89.0, 50.0, 20.0, 80.0, 41.0, 23.0, 112.0, 39.0, 105.0, 0.0, 1.0, 0.0, 0.0, 0.0, 9.0, 9.0, 0.0, 7.0, 3.0, 0.0, 170.0, 103.0, 18.0, 27.0, 60.0, 0.0, 43.0, 19.0, 180.0, 11.0, 8.0, 161.0, 167.0, 26.0, 172.0, 18.0, 9.0, 46.0, 13.0, 0.0, 0.0, 138.0, 43.0, 21.0, 180.0, 0.0, 46.0, 0.0, 0.0, 178.0, 123.0, 0.0, 8.0, 98.0, 0.0, 48.0, 122.0, 59.0, 79.0, 138.0, 3.0, 0.0, 0.0, 31.0, 117.0, 0.0, 6.0, 190.0, 23.0, 146.0, 99.0, 36.0, 173.0, 0.0, 1.0, 75.0, 0.0, 0.0, 28.0, 1.0, 11.0, 0.0, 0.0, 175.0, 155.0, 9.0, 0.0, 0.0, 0.0, 0.0, 24.0, 149.0, 127.0, 130.0, 58.0, 197.0, 196.0, 1.0, 23.0, 0.0, 192.0, 0.0, 16.0, 0.0, 12.0, 0.0, 40.0, 17.0, 47.0, 0.0, 8.0, 60.0, 13.0, 190.0, 22.0, 10.0, 134.0, 119.0, 158.0, 0.0, 93.0, 0.0, 123.0, 172.0, 17.0, 0.0, 0.0, 21.0, 5.0, 23.0, 0.0, 0.0, 84.0, 0.0, 0.0, 60.0, 182.0, 46.0, 153.0, 95.0, 10.0, 144.0, 12.0, 14.0, 26.0, 0.0, 21.0, 87.0, 4.0, 0.0, 18.0, 109.0, 26.0, 2.0, 146.0, 177.0, 151.0, 139.0, 141.0, 33.0, 162.0, 7.0, 0.0, 160.0, 144.0, 11.0, 0.0, 0.0, 0.0, 0.0, 3.0, 16.0, 77.0, 26.0, 31.0, 14.0, 26.0, 92.0, 53.0, 2.0, 6.0, 101.0, 11.0, 10.0, 10.0, 0.0, 0.0, 163.0, 21.0, 46.0, 118.0, 129.0, 0.0, 151.0, 132.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0871866901441485, "mean_inference_ms": 3.38964498779222, "mean_action_processing_ms": 0.5087883882777383, "mean_env_wait_ms": 0.3902020859535019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08474934101104736, "StateBufferConnector_ms": 0.011823534965515137, "ViewRequirementAgentConnector_ms": 0.3479231595993042}, "num_episodes": 18, "episode_return_max": 310.0, "episode_return_min": -405.0, "episode_return_mean": -18.22, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.03557150488103, "num_env_steps_trained_throughput_per_sec": 289.03557150488103, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 1872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1872000, "timers": {"training_iteration_time_ms": 16353.271, "restore_workers_time_ms": 0.037, "training_step_time_ms": 16353.193, "sample_time_ms": 4091.252, "learn_time_ms": 12229.59, "learn_throughput": 327.076, "synch_weights_time_ms": 28.082}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "done": false, "training_iteration": 117, "trial_id": "e1352_00002", "date": "2024-08-13_19-45-38", "timestamp": 1723592738, "time_this_iter_s": 13.889694213867188, "time_total_s": 2625.991813659668, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b8cca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2625.991813659668, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 83.77368421052631, "ram_util_percent": 83.7578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.321840761136756, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 4.50276650524644, "policy_loss": -0.0014086871272416183, "vf_loss": 4.503839822042556, "vf_explained_var": -3.548538874066065e-05, "kl": 0.007444447120393167, "entropy": 0.830457558991417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 222075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.085417783575714, "cur_kl_coeff": 0.0005279392004013063, "cur_lr": 0.00010000000000000003, "total_loss": 4.7389673381886155, "policy_loss": -0.002233802106985379, "vf_loss": 4.74119648769419, "vf_explained_var": -0.322728685537974, "kl": 0.00880495960492687, "entropy": 0.9039827246514578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 222075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000}, "env_runners": {"episode_reward_max": 310.0, "episode_reward_min": -405.0, "episode_reward_mean": -30.1, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 160.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": -71.385, "predator_policy": 56.335}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-259.0, -54.0, 69.0, -7.0, 254.0, -47.0, -159.0, 21.0, 0.0, -82.0, -8.0, -28.0, 91.0, 200.0, -252.0, 7.0, -29.0, -6.0, -197.0, -45.0, -52.0, 2.0, -27.0, 129.0, 310.0, 0.0, -133.0, -13.0, 0.0, 124.0, -367.0, -197.0, -393.0, 125.0, -353.0, -22.0, 153.0, 51.0, 41.0, 160.0, 40.0, -384.0, -99.0, -86.0, -10.0, -49.0, -405.0, 0.0, 113.0, 72.0, 71.0, 34.0, -194.0, -51.0, -17.0, -177.0, 139.0, 39.0, 6.0, 27.0, -114.0, -122.0, -20.0, -33.0, -233.0, -7.0, -33.0, 14.0, 29.0, 153.0, 21.0, 15.0, 131.0, 173.0, -6.0, -46.0, -20.0, 1.0, -137.0, -68.0, -44.0, -35.0, 61.0, 1.0, -5.0, -133.0, 25.0, -159.0, 27.0, -87.0, -134.0, 84.0, -154.0, 18.0, -128.0, -262.0, 1.0, 140.0, -32.0, 32.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-352.0, -235.0, 54.0, -306.0, 42.0, 0.0, -66.0, 0.0, 128.0, 126.0, -224.0, -4.0, -360.0, 0.0, 63.0, -88.0, 0.0, 0.0, -383.0, 0.0, 0.0, -16.0, 0.0, -126.0, -211.0, 132.0, 150.0, -88.0, -192.0, -201.0, 7.0, 0.0, 0.0, -177.0, -12.0, 0.0, -276.0, -134.0, -290.0, 0.0, 48.0, -309.0, 0.0, 1.0, -102.0, 0.0, 0.0, 101.0, 141.0, 157.0, 0.0, 0.0, -236.0, -227.0, -5.0, -17.0, 0.0, 0.0, 0.0, 100.0, -320.0, -323.0, -167.0, -218.0, -392.0, -394.0, 101.0, 0.0, -368.0, -177.0, -26.0, -12.0, -2.0, 143.0, 0.0, 11.0, -49.0, 26.0, -8.0, 160.0, -19.0, -14.0, -369.0, -227.0, -111.0, -132.0, -363.0, 0.0, -59.0, -44.0, 44.0, -216.0, -337.0, -257.0, 0.0, 0.0, -42.0, 129.0, 14.0, 35.0, 71.0, -84.0, 0.0, 34.0, -136.0, -300.0, -300.0, 50.0, -12.0, -110.0, -199.0, -134.0, 7.0, 92.0, 2.0, 16.0, -116.0, 31.0, 0.0, 9.0, -52.0, -197.0, -266.0, -4.0, -14.0, -334.0, -32.0, -281.0, -219.0, -209.0, -14.0, 0.0, -337.0, 0.0, 3.0, 0.0, 0.0, 29.0, 129.0, 21.0, -26.0, -46.0, -43.0, 1.0, 115.0, -24.0, 147.0, -119.0, 0.0, -14.0, -131.0, -27.0, 0.0, -40.0, 1.0, 0.0, -310.0, -11.0, 9.0, -241.0, 37.0, -210.0, -318.0, 0.0, -28.0, 75.0, 1.0, 0.0, -25.0, -11.0, -293.0, -2.0, 15.0, -16.0, -283.0, -39.0, -267.0, 1.0, -220.0, 0.0, -285.0, 0.0, 45.0, 35.0, 0.0, -328.0, -20.0, -60.0, 0.0, -349.0, -358.0, -97.0, 81.0, -235.0, 10.0, -19.0, 12.0, -165.0, -8.0, 32.0], "policy_predator_policy_reward": [161.0, 167.0, 26.0, 172.0, 18.0, 9.0, 46.0, 13.0, 0.0, 0.0, 138.0, 43.0, 21.0, 180.0, 0.0, 46.0, 0.0, 0.0, 178.0, 123.0, 0.0, 8.0, 98.0, 0.0, 48.0, 122.0, 59.0, 79.0, 138.0, 3.0, 0.0, 0.0, 31.0, 117.0, 0.0, 6.0, 190.0, 23.0, 146.0, 99.0, 36.0, 173.0, 0.0, 1.0, 75.0, 0.0, 0.0, 28.0, 1.0, 11.0, 0.0, 0.0, 175.0, 155.0, 9.0, 0.0, 0.0, 0.0, 0.0, 24.0, 149.0, 127.0, 130.0, 58.0, 197.0, 196.0, 1.0, 23.0, 0.0, 192.0, 0.0, 16.0, 0.0, 12.0, 0.0, 40.0, 17.0, 47.0, 0.0, 8.0, 60.0, 13.0, 190.0, 22.0, 10.0, 134.0, 119.0, 158.0, 0.0, 93.0, 0.0, 123.0, 172.0, 17.0, 0.0, 0.0, 21.0, 5.0, 23.0, 0.0, 0.0, 84.0, 0.0, 0.0, 60.0, 182.0, 46.0, 153.0, 95.0, 10.0, 144.0, 12.0, 14.0, 26.0, 0.0, 21.0, 87.0, 4.0, 0.0, 18.0, 109.0, 26.0, 2.0, 146.0, 177.0, 151.0, 139.0, 141.0, 33.0, 162.0, 7.0, 0.0, 160.0, 144.0, 11.0, 0.0, 0.0, 0.0, 0.0, 3.0, 16.0, 77.0, 26.0, 31.0, 14.0, 26.0, 92.0, 53.0, 2.0, 6.0, 101.0, 11.0, 10.0, 10.0, 0.0, 0.0, 163.0, 21.0, 46.0, 118.0, 129.0, 0.0, 151.0, 132.0, 0.0, 14.0, 0.0, 0.0, 10.0, 21.0, 162.0, 0.0, 8.0, 18.0, 152.0, 11.0, 156.0, 137.0, 133.0, 0.0, 151.0, 0.0, 1.0, 3.0, 0.0, 174.0, 81.0, 17.0, 159.0, 62.0, 190.0, 3.0, 122.0, 33.0, 57.0, 92.0, 22.0, 99.0, 0.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0924467670110516, "mean_inference_ms": 3.4018005649329903, "mean_action_processing_ms": 0.5103155884165711, "mean_env_wait_ms": 0.39207909084097997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08129775524139404, "StateBufferConnector_ms": 0.009579062461853027, "ViewRequirementAgentConnector_ms": 0.26283109188079834}, "num_episodes": 18, "episode_return_max": 310.0, "episode_return_min": -405.0, "episode_return_mean": -30.1, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.60899703913236, "num_env_steps_trained_throughput_per_sec": 285.60899703913236, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 1888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1888000, "timers": {"training_iteration_time_ms": 16578.339, "restore_workers_time_ms": 0.037, "training_step_time_ms": 16578.262, "sample_time_ms": 4134.592, "learn_time_ms": 12411.31, "learn_throughput": 322.287, "synch_weights_time_ms": 28.108}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000}, "done": false, "training_iteration": 118, "trial_id": "e1352_00002", "date": "2024-08-13_19-45-52", "timestamp": 1723592752, "time_this_iter_s": 14.08809208869934, "time_total_s": 2640.0799057483673, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d13160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2640.0799057483673, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 80.74285714285713, "ram_util_percent": 83.31904761904764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3153420030203447, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 4.486950734178856, "policy_loss": -0.0018234865646316576, "vf_loss": 4.488459463220424, "vf_explained_var": 0.0008299804238415269, "kl": 0.0069865589082915526, "entropy": 0.8141882624891069, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 223965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.130192980327934, "cur_kl_coeff": 0.0005279392004013063, "cur_lr": 0.00010000000000000003, "total_loss": 4.617248444960862, "policy_loss": -0.003371962259287044, "vf_loss": 4.620614254663861, "vf_explained_var": -0.2555545449256897, "kl": 0.011645635151124514, "entropy": 0.9020418911068527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 223965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000}, "env_runners": {"episode_reward_max": 310.0, "episode_reward_min": -405.0, "episode_reward_mean": -27.7, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -71.815, "predator_policy": 57.965}, "custom_metrics": {}, "hist_stats": {"episode_reward": [129.0, 310.0, 0.0, -133.0, -13.0, 0.0, 124.0, -367.0, -197.0, -393.0, 125.0, -353.0, -22.0, 153.0, 51.0, 41.0, 160.0, 40.0, -384.0, -99.0, -86.0, -10.0, -49.0, -405.0, 0.0, 113.0, 72.0, 71.0, 34.0, -194.0, -51.0, -17.0, -177.0, 139.0, 39.0, 6.0, 27.0, -114.0, -122.0, -20.0, -33.0, -233.0, -7.0, -33.0, 14.0, 29.0, 153.0, 21.0, 15.0, 131.0, 173.0, -6.0, -46.0, -20.0, 1.0, -137.0, -68.0, -44.0, -35.0, 61.0, 1.0, -5.0, -133.0, 25.0, -159.0, 27.0, -87.0, -134.0, 84.0, -154.0, 18.0, -128.0, -262.0, 1.0, 140.0, -32.0, 32.0, -28.0, 42.0, -9.0, -245.0, -13.0, -145.0, -117.0, -1.0, -90.0, -43.0, 44.0, -71.0, 48.0, 40.0, 51.0, 0.0, -135.0, -67.0, -17.0, 41.0, 163.0, 214.0, -30.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 101.0, 141.0, 157.0, 0.0, 0.0, -236.0, -227.0, -5.0, -17.0, 0.0, 0.0, 0.0, 100.0, -320.0, -323.0, -167.0, -218.0, -392.0, -394.0, 101.0, 0.0, -368.0, -177.0, -26.0, -12.0, -2.0, 143.0, 0.0, 11.0, -49.0, 26.0, -8.0, 160.0, -19.0, -14.0, -369.0, -227.0, -111.0, -132.0, -363.0, 0.0, -59.0, -44.0, 44.0, -216.0, -337.0, -257.0, 0.0, 0.0, -42.0, 129.0, 14.0, 35.0, 71.0, -84.0, 0.0, 34.0, -136.0, -300.0, -300.0, 50.0, -12.0, -110.0, -199.0, -134.0, 7.0, 92.0, 2.0, 16.0, -116.0, 31.0, 0.0, 9.0, -52.0, -197.0, -266.0, -4.0, -14.0, -334.0, -32.0, -281.0, -219.0, -209.0, -14.0, 0.0, -337.0, 0.0, 3.0, 0.0, 0.0, 29.0, 129.0, 21.0, -26.0, -46.0, -43.0, 1.0, 115.0, -24.0, 147.0, -119.0, 0.0, -14.0, -131.0, -27.0, 0.0, -40.0, 1.0, 0.0, -310.0, -11.0, 9.0, -241.0, 37.0, -210.0, -318.0, 0.0, -28.0, 75.0, 1.0, 0.0, -25.0, -11.0, -293.0, -2.0, 15.0, -16.0, -283.0, -39.0, -267.0, 1.0, -220.0, 0.0, -285.0, 0.0, 45.0, 35.0, 0.0, -328.0, -20.0, -60.0, 0.0, -349.0, -358.0, -97.0, 81.0, -235.0, 10.0, -19.0, 12.0, -165.0, -8.0, 32.0, -56.0, 0.0, -243.0, -11.0, 0.0, -103.0, -307.0, -223.0, -243.0, -10.0, 7.0, -340.0, -64.0, -205.0, 0.0, -2.0, -16.0, -319.0, -42.0, -45.0, -53.0, 32.0, -191.0, 0.0, 48.0, 0.0, -17.0, 0.0, -8.0, -4.0, 0.0, -287.0, -152.0, -162.0, -214.0, 0.0, -352.0, -2.0, -14.0, -2.0, 22.0, 69.0, -28.0, 179.0, 0.0, -129.0], "policy_predator_policy_reward": [0.0, 28.0, 1.0, 11.0, 0.0, 0.0, 175.0, 155.0, 9.0, 0.0, 0.0, 0.0, 0.0, 24.0, 149.0, 127.0, 130.0, 58.0, 197.0, 196.0, 1.0, 23.0, 0.0, 192.0, 0.0, 16.0, 0.0, 12.0, 0.0, 40.0, 17.0, 47.0, 0.0, 8.0, 60.0, 13.0, 190.0, 22.0, 10.0, 134.0, 119.0, 158.0, 0.0, 93.0, 0.0, 123.0, 172.0, 17.0, 0.0, 0.0, 21.0, 5.0, 23.0, 0.0, 0.0, 84.0, 0.0, 0.0, 60.0, 182.0, 46.0, 153.0, 95.0, 10.0, 144.0, 12.0, 14.0, 26.0, 0.0, 21.0, 87.0, 4.0, 0.0, 18.0, 109.0, 26.0, 2.0, 146.0, 177.0, 151.0, 139.0, 141.0, 33.0, 162.0, 7.0, 0.0, 160.0, 144.0, 11.0, 0.0, 0.0, 0.0, 0.0, 3.0, 16.0, 77.0, 26.0, 31.0, 14.0, 26.0, 92.0, 53.0, 2.0, 6.0, 101.0, 11.0, 10.0, 10.0, 0.0, 0.0, 163.0, 21.0, 46.0, 118.0, 129.0, 0.0, 151.0, 132.0, 0.0, 14.0, 0.0, 0.0, 10.0, 21.0, 162.0, 0.0, 8.0, 18.0, 152.0, 11.0, 156.0, 137.0, 133.0, 0.0, 151.0, 0.0, 1.0, 3.0, 0.0, 174.0, 81.0, 17.0, 159.0, 62.0, 190.0, 3.0, 122.0, 33.0, 57.0, 92.0, 22.0, 99.0, 0.0, 8.0, 28.0, 0.0, 156.0, 140.0, 94.0, 0.0, 87.0, 198.0, 103.0, 137.0, 34.0, 154.0, 2.0, 150.0, 1.0, 0.0, 130.0, 115.0, 37.0, 7.0, 14.0, 51.0, 0.0, 120.0, 0.0, 0.0, 45.0, 12.0, 38.0, 25.0, 134.0, 153.0, 153.0, 26.0, 136.0, 11.0, 170.0, 167.0, 30.0, 27.0, 44.0, 28.0, 29.0, 34.0, 74.0, 25.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0942210939032573, "mean_inference_ms": 3.4058153919852363, "mean_action_processing_ms": 0.5103919576986635, "mean_env_wait_ms": 0.3928331218964104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01714789867401123, "StateBufferConnector_ms": 0.005597710609436035, "ViewRequirementAgentConnector_ms": 0.20649802684783936}, "num_episodes": 23, "episode_return_max": 310.0, "episode_return_min": -405.0, "episode_return_mean": -27.7, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.88635260331665, "num_env_steps_trained_throughput_per_sec": 295.88635260331665, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 1904000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1904000, "timers": {"training_iteration_time_ms": 16668.772, "restore_workers_time_ms": 0.037, "training_step_time_ms": 16668.694, "sample_time_ms": 4147.079, "learn_time_ms": 12498.278, "learn_throughput": 320.044, "synch_weights_time_ms": 18.884}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000}, "done": false, "training_iteration": 119, "trial_id": "e1352_00002", "date": "2024-08-13_19-46-05", "timestamp": 1723592765, "time_this_iter_s": 13.595032215118408, "time_total_s": 2653.6749379634857, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e5a940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2653.6749379634857, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 78.87894736842105, "ram_util_percent": 83.58947368421052}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5189439186895335, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 2.5246588205534315, "policy_loss": -0.0030451540484107914, "vf_loss": 2.5272928811254953, "vf_explained_var": -0.00013340071395591453, "kl": 0.009125275524018747, "entropy": 0.8311863395902845, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 225855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.234298063428312, "cur_kl_coeff": 0.0005279392004013063, "cur_lr": 0.00010000000000000003, "total_loss": 2.6922732049195224, "policy_loss": -0.011058536027287128, "vf_loss": 2.703312331974191, "vf_explained_var": -0.29345737128030686, "kl": 0.036785068457590206, "entropy": 1.0283436692580974, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 225855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 214.0, "episode_reward_min": -405.0, "episode_reward_mean": -21.39, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -358.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -64.82, "predator_policy": 54.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.0, -405.0, 0.0, 113.0, 72.0, 71.0, 34.0, -194.0, -51.0, -17.0, -177.0, 139.0, 39.0, 6.0, 27.0, -114.0, -122.0, -20.0, -33.0, -233.0, -7.0, -33.0, 14.0, 29.0, 153.0, 21.0, 15.0, 131.0, 173.0, -6.0, -46.0, -20.0, 1.0, -137.0, -68.0, -44.0, -35.0, 61.0, 1.0, -5.0, -133.0, 25.0, -159.0, 27.0, -87.0, -134.0, 84.0, -154.0, 18.0, -128.0, -262.0, 1.0, 140.0, -32.0, 32.0, -28.0, 42.0, -9.0, -245.0, -13.0, -145.0, -117.0, -1.0, -90.0, -43.0, 44.0, -71.0, 48.0, 40.0, 51.0, 0.0, -135.0, -67.0, -17.0, 41.0, 163.0, 214.0, -30.0, -35.0, 4.0, -1.0, -242.0, -8.0, 75.0, 17.0, -50.0, 0.0, 25.0, 0.0, -93.0, 0.0, -7.0, 16.0, -71.0, 81.0, -6.0, -45.0, 38.0, -8.0, 17.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [44.0, -216.0, -337.0, -257.0, 0.0, 0.0, -42.0, 129.0, 14.0, 35.0, 71.0, -84.0, 0.0, 34.0, -136.0, -300.0, -300.0, 50.0, -12.0, -110.0, -199.0, -134.0, 7.0, 92.0, 2.0, 16.0, -116.0, 31.0, 0.0, 9.0, -52.0, -197.0, -266.0, -4.0, -14.0, -334.0, -32.0, -281.0, -219.0, -209.0, -14.0, 0.0, -337.0, 0.0, 3.0, 0.0, 0.0, 29.0, 129.0, 21.0, -26.0, -46.0, -43.0, 1.0, 115.0, -24.0, 147.0, -119.0, 0.0, -14.0, -131.0, -27.0, 0.0, -40.0, 1.0, 0.0, -310.0, -11.0, 9.0, -241.0, 37.0, -210.0, -318.0, 0.0, -28.0, 75.0, 1.0, 0.0, -25.0, -11.0, -293.0, -2.0, 15.0, -16.0, -283.0, -39.0, -267.0, 1.0, -220.0, 0.0, -285.0, 0.0, 45.0, 35.0, 0.0, -328.0, -20.0, -60.0, 0.0, -349.0, -358.0, -97.0, 81.0, -235.0, 10.0, -19.0, 12.0, -165.0, -8.0, 32.0, -56.0, 0.0, -243.0, -11.0, 0.0, -103.0, -307.0, -223.0, -243.0, -10.0, 7.0, -340.0, -64.0, -205.0, 0.0, -2.0, -16.0, -319.0, -42.0, -45.0, -53.0, 32.0, -191.0, 0.0, 48.0, 0.0, -17.0, 0.0, -8.0, -4.0, 0.0, -287.0, -152.0, -162.0, -214.0, 0.0, -352.0, -2.0, -14.0, -2.0, 22.0, 69.0, -28.0, 179.0, 0.0, -129.0, 0.0, -159.0, 0.0, -162.0, -2.0, 0.0, -206.0, -234.0, 0.0, -33.0, 7.0, 0.0, 0.0, 17.0, 0.0, -305.0, 0.0, 0.0, -76.0, -10.0, 0.0, 0.0, -120.0, -109.0, 0.0, 0.0, -14.0, 0.0, 0.0, 2.0, -23.0, -208.0, 65.0, -20.0, -12.0, 0.0, 0.0, -184.0, -23.0, 0.0, 0.0, -120.0, -1.0, -10.0], "policy_predator_policy_reward": [0.0, 123.0, 172.0, 17.0, 0.0, 0.0, 21.0, 5.0, 23.0, 0.0, 0.0, 84.0, 0.0, 0.0, 60.0, 182.0, 46.0, 153.0, 95.0, 10.0, 144.0, 12.0, 14.0, 26.0, 0.0, 21.0, 87.0, 4.0, 0.0, 18.0, 109.0, 26.0, 2.0, 146.0, 177.0, 151.0, 139.0, 141.0, 33.0, 162.0, 7.0, 0.0, 160.0, 144.0, 11.0, 0.0, 0.0, 0.0, 0.0, 3.0, 16.0, 77.0, 26.0, 31.0, 14.0, 26.0, 92.0, 53.0, 2.0, 6.0, 101.0, 11.0, 10.0, 10.0, 0.0, 0.0, 163.0, 21.0, 46.0, 118.0, 129.0, 0.0, 151.0, 132.0, 0.0, 14.0, 0.0, 0.0, 10.0, 21.0, 162.0, 0.0, 8.0, 18.0, 152.0, 11.0, 156.0, 137.0, 133.0, 0.0, 151.0, 0.0, 1.0, 3.0, 0.0, 174.0, 81.0, 17.0, 159.0, 62.0, 190.0, 3.0, 122.0, 33.0, 57.0, 92.0, 22.0, 99.0, 0.0, 8.0, 28.0, 0.0, 156.0, 140.0, 94.0, 0.0, 87.0, 198.0, 103.0, 137.0, 34.0, 154.0, 2.0, 150.0, 1.0, 0.0, 130.0, 115.0, 37.0, 7.0, 14.0, 51.0, 0.0, 120.0, 0.0, 0.0, 45.0, 12.0, 38.0, 25.0, 134.0, 153.0, 153.0, 26.0, 136.0, 11.0, 170.0, 167.0, 30.0, 27.0, 44.0, 28.0, 29.0, 34.0, 74.0, 25.0, 71.0, 53.0, 89.0, 77.0, 1.0, 0.0, 57.0, 141.0, 0.0, 25.0, 40.0, 28.0, 0.0, 0.0, 133.0, 122.0, 0.0, 0.0, 58.0, 53.0, 0.0, 0.0, 41.0, 95.0, 0.0, 0.0, 0.0, 7.0, 0.0, 14.0, 135.0, 25.0, 20.0, 16.0, 6.0, 0.0, 112.0, 27.0, 0.0, 61.0, 37.0, 75.0, 12.0, 16.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0947077834335392, "mean_inference_ms": 3.4052601219089174, "mean_action_processing_ms": 0.5097054787051953, "mean_env_wait_ms": 0.39287575632817107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01589524745941162, "StateBufferConnector_ms": 0.003979325294494629, "ViewRequirementAgentConnector_ms": 0.20185303688049316}, "num_episodes": 22, "episode_return_max": 214.0, "episode_return_min": -405.0, "episode_return_mean": -21.39, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.41265705883768, "num_env_steps_trained_throughput_per_sec": 153.41265705883768, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 17897.862, "restore_workers_time_ms": 0.018, "training_step_time_ms": 17897.808, "sample_time_ms": 4145.493, "learn_time_ms": 13729.011, "learn_throughput": 291.354, "synch_weights_time_ms": 19.003}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 120, "trial_id": "e1352_00002", "date": "2024-08-13_19-46-32", "timestamp": 1723592792, "time_this_iter_s": 26.164179801940918, "time_total_s": 2679.8391177654266, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e68160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2679.8391177654266, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 93.09459459459458, "ram_util_percent": 85.02432432432433}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6524099999792363, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 2.9585183466553056, "policy_loss": -0.00182943297821102, "vf_loss": 2.9600477781876053, "vf_explained_var": 0.012218491457126758, "kl": 0.006659247756309013, "entropy": 0.8261400263776224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 227745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.879744695828705, "cur_kl_coeff": 0.000791908800601959, "cur_lr": 0.00010000000000000003, "total_loss": 2.92582067055677, "policy_loss": -0.006576001804036202, "vf_loss": 2.932384735188156, "vf_explained_var": -0.3022964290210179, "kl": 0.015072980965365074, "entropy": 1.1021007400341134, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 227745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 1936000}, "env_runners": {"episode_reward_max": 214.0, "episode_reward_min": -262.0, "episode_reward_mean": -15.66, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -358.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -58.5, "predator_policy": 50.67}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.0, -233.0, -7.0, -33.0, 14.0, 29.0, 153.0, 21.0, 15.0, 131.0, 173.0, -6.0, -46.0, -20.0, 1.0, -137.0, -68.0, -44.0, -35.0, 61.0, 1.0, -5.0, -133.0, 25.0, -159.0, 27.0, -87.0, -134.0, 84.0, -154.0, 18.0, -128.0, -262.0, 1.0, 140.0, -32.0, 32.0, -28.0, 42.0, -9.0, -245.0, -13.0, -145.0, -117.0, -1.0, -90.0, -43.0, 44.0, -71.0, 48.0, 40.0, 51.0, 0.0, -135.0, -67.0, -17.0, 41.0, 163.0, 214.0, -30.0, -35.0, 4.0, -1.0, -242.0, -8.0, 75.0, 17.0, -50.0, 0.0, 25.0, 0.0, -93.0, 0.0, -7.0, 16.0, -71.0, 81.0, -6.0, -45.0, 38.0, -8.0, 17.0, 27.0, -33.0, -48.0, 31.0, -16.0, -38.0, -24.0, 12.0, 47.0, 13.0, -31.0, 40.0, 6.0, -41.0, 34.0, -23.0, -31.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-32.0, -281.0, -219.0, -209.0, -14.0, 0.0, -337.0, 0.0, 3.0, 0.0, 0.0, 29.0, 129.0, 21.0, -26.0, -46.0, -43.0, 1.0, 115.0, -24.0, 147.0, -119.0, 0.0, -14.0, -131.0, -27.0, 0.0, -40.0, 1.0, 0.0, -310.0, -11.0, 9.0, -241.0, 37.0, -210.0, -318.0, 0.0, -28.0, 75.0, 1.0, 0.0, -25.0, -11.0, -293.0, -2.0, 15.0, -16.0, -283.0, -39.0, -267.0, 1.0, -220.0, 0.0, -285.0, 0.0, 45.0, 35.0, 0.0, -328.0, -20.0, -60.0, 0.0, -349.0, -358.0, -97.0, 81.0, -235.0, 10.0, -19.0, 12.0, -165.0, -8.0, 32.0, -56.0, 0.0, -243.0, -11.0, 0.0, -103.0, -307.0, -223.0, -243.0, -10.0, 7.0, -340.0, -64.0, -205.0, 0.0, -2.0, -16.0, -319.0, -42.0, -45.0, -53.0, 32.0, -191.0, 0.0, 48.0, 0.0, -17.0, 0.0, -8.0, -4.0, 0.0, -287.0, -152.0, -162.0, -214.0, 0.0, -352.0, -2.0, -14.0, -2.0, 22.0, 69.0, -28.0, 179.0, 0.0, -129.0, 0.0, -159.0, 0.0, -162.0, -2.0, 0.0, -206.0, -234.0, 0.0, -33.0, 7.0, 0.0, 0.0, 17.0, 0.0, -305.0, 0.0, 0.0, -76.0, -10.0, 0.0, 0.0, -120.0, -109.0, 0.0, 0.0, -14.0, 0.0, 0.0, 2.0, -23.0, -208.0, 65.0, -20.0, -12.0, 0.0, 0.0, -184.0, -23.0, 0.0, 0.0, -120.0, -1.0, -10.0, 39.0, -72.0, -47.0, -62.0, 0.0, -148.0, 0.0, -1.0, -74.0, 0.0, -116.0, -53.0, -32.0, -41.0, -76.0, 1.0, -44.0, 7.0, -140.0, 41.0, -108.0, -10.0, -67.0, 27.0, 6.0, 0.0, -34.0, -59.0, -56.0, -26.0, -6.0, -50.0, -18.0, -34.0, 12.0, -71.0], "policy_predator_policy_reward": [139.0, 141.0, 33.0, 162.0, 7.0, 0.0, 160.0, 144.0, 11.0, 0.0, 0.0, 0.0, 0.0, 3.0, 16.0, 77.0, 26.0, 31.0, 14.0, 26.0, 92.0, 53.0, 2.0, 6.0, 101.0, 11.0, 10.0, 10.0, 0.0, 0.0, 163.0, 21.0, 46.0, 118.0, 129.0, 0.0, 151.0, 132.0, 0.0, 14.0, 0.0, 0.0, 10.0, 21.0, 162.0, 0.0, 8.0, 18.0, 152.0, 11.0, 156.0, 137.0, 133.0, 0.0, 151.0, 0.0, 1.0, 3.0, 0.0, 174.0, 81.0, 17.0, 159.0, 62.0, 190.0, 3.0, 122.0, 33.0, 57.0, 92.0, 22.0, 99.0, 0.0, 8.0, 28.0, 0.0, 156.0, 140.0, 94.0, 0.0, 87.0, 198.0, 103.0, 137.0, 34.0, 154.0, 2.0, 150.0, 1.0, 0.0, 130.0, 115.0, 37.0, 7.0, 14.0, 51.0, 0.0, 120.0, 0.0, 0.0, 45.0, 12.0, 38.0, 25.0, 134.0, 153.0, 153.0, 26.0, 136.0, 11.0, 170.0, 167.0, 30.0, 27.0, 44.0, 28.0, 29.0, 34.0, 74.0, 25.0, 71.0, 53.0, 89.0, 77.0, 1.0, 0.0, 57.0, 141.0, 0.0, 25.0, 40.0, 28.0, 0.0, 0.0, 133.0, 122.0, 0.0, 0.0, 58.0, 53.0, 0.0, 0.0, 41.0, 95.0, 0.0, 0.0, 0.0, 7.0, 0.0, 14.0, 135.0, 25.0, 20.0, 16.0, 6.0, 0.0, 112.0, 27.0, 0.0, 61.0, 37.0, 75.0, 12.0, 16.0, 0.0, 60.0, 38.0, 38.0, 27.0, 73.0, 5.0, 27.0, 43.0, 15.0, 71.0, 60.0, 21.0, 28.0, 37.0, 50.0, 67.0, 17.0, 67.0, 45.0, 20.0, 67.0, 50.0, 30.0, 0.0, 0.0, 44.0, 8.0, 62.0, 54.0, 28.0, 5.0, 6.0, 15.0, 16.0, 43.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0941951760127047, "mean_inference_ms": 3.4061623055981216, "mean_action_processing_ms": 0.5091361327729882, "mean_env_wait_ms": 0.392853653870568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014199972152709961, "StateBufferConnector_ms": 0.00375521183013916, "ViewRequirementAgentConnector_ms": 0.18868768215179443}, "num_episodes": 18, "episode_return_max": 214.0, "episode_return_min": -262.0, "episode_return_mean": -15.66, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 1936000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.63167177516556, "num_env_steps_trained_throughput_per_sec": 294.63167177516556, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 1936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1936000, "timers": {"training_iteration_time_ms": 17958.525, "restore_workers_time_ms": 0.018, "training_step_time_ms": 17958.471, "sample_time_ms": 4101.943, "learn_time_ms": 13832.371, "learn_throughput": 289.177, "synch_weights_time_ms": 20.055}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 1936000}, "done": false, "training_iteration": 121, "trial_id": "e1352_00002", "date": "2024-08-13_19-46-45", "timestamp": 1723592805, "time_this_iter_s": 13.642347812652588, "time_total_s": 2693.481465578079, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e68280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2693.481465578079, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 79.0421052631579, "ram_util_percent": 83.9421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5602564854123604, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 1.396631373488714, "policy_loss": -0.0043542015462345075, "vf_loss": 1.4005145388620872, "vf_explained_var": 0.015994398240689878, "kl": 0.010455719387599467, "entropy": 0.7999622556898329, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 229635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.67908188470457, "cur_kl_coeff": 0.000791908800601959, "cur_lr": 0.00010000000000000003, "total_loss": 1.2987774137939725, "policy_loss": -0.003767394723134145, "vf_loss": 1.3025399772578445, "vf_explained_var": -0.16835350889377493, "kl": 0.0061044604157312376, "entropy": 1.092953150045304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 229635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000}, "env_runners": {"episode_reward_max": 214.0, "episode_reward_min": -262.0, "episode_reward_mean": -14.9, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -358.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -52.605, "predator_policy": 45.155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.0, 61.0, 1.0, -5.0, -133.0, 25.0, -159.0, 27.0, -87.0, -134.0, 84.0, -154.0, 18.0, -128.0, -262.0, 1.0, 140.0, -32.0, 32.0, -28.0, 42.0, -9.0, -245.0, -13.0, -145.0, -117.0, -1.0, -90.0, -43.0, 44.0, -71.0, 48.0, 40.0, 51.0, 0.0, -135.0, -67.0, -17.0, 41.0, 163.0, 214.0, -30.0, -35.0, 4.0, -1.0, -242.0, -8.0, 75.0, 17.0, -50.0, 0.0, 25.0, 0.0, -93.0, 0.0, -7.0, 16.0, -71.0, 81.0, -6.0, -45.0, 38.0, -8.0, 17.0, 27.0, -33.0, -48.0, 31.0, -16.0, -38.0, -24.0, 12.0, 47.0, 13.0, -31.0, 40.0, 6.0, -41.0, 34.0, -23.0, -31.0, 0.0, 14.0, -16.0, -43.0, 22.0, 27.0, -26.0, 0.0, 3.0, -2.0, -23.0, 1.0, -9.0, 55.0, -11.0, 53.0, -2.0, -46.0, -11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-318.0, 0.0, -28.0, 75.0, 1.0, 0.0, -25.0, -11.0, -293.0, -2.0, 15.0, -16.0, -283.0, -39.0, -267.0, 1.0, -220.0, 0.0, -285.0, 0.0, 45.0, 35.0, 0.0, -328.0, -20.0, -60.0, 0.0, -349.0, -358.0, -97.0, 81.0, -235.0, 10.0, -19.0, 12.0, -165.0, -8.0, 32.0, -56.0, 0.0, -243.0, -11.0, 0.0, -103.0, -307.0, -223.0, -243.0, -10.0, 7.0, -340.0, -64.0, -205.0, 0.0, -2.0, -16.0, -319.0, -42.0, -45.0, -53.0, 32.0, -191.0, 0.0, 48.0, 0.0, -17.0, 0.0, -8.0, -4.0, 0.0, -287.0, -152.0, -162.0, -214.0, 0.0, -352.0, -2.0, -14.0, -2.0, 22.0, 69.0, -28.0, 179.0, 0.0, -129.0, 0.0, -159.0, 0.0, -162.0, -2.0, 0.0, -206.0, -234.0, 0.0, -33.0, 7.0, 0.0, 0.0, 17.0, 0.0, -305.0, 0.0, 0.0, -76.0, -10.0, 0.0, 0.0, -120.0, -109.0, 0.0, 0.0, -14.0, 0.0, 0.0, 2.0, -23.0, -208.0, 65.0, -20.0, -12.0, 0.0, 0.0, -184.0, -23.0, 0.0, 0.0, -120.0, -1.0, -10.0, 39.0, -72.0, -47.0, -62.0, 0.0, -148.0, 0.0, -1.0, -74.0, 0.0, -116.0, -53.0, -32.0, -41.0, -76.0, 1.0, -44.0, 7.0, -140.0, 41.0, -108.0, -10.0, -67.0, 27.0, 6.0, 0.0, -34.0, -59.0, -56.0, -26.0, -6.0, -50.0, -18.0, -34.0, 12.0, -71.0, 8.0, -12.0, -16.0, -94.0, -121.0, -22.0, 11.0, 0.0, 27.0, 0.0, -18.0, -75.0, -16.0, -8.0, -18.0, 0.0, 0.0, -4.0, -17.0, -71.0, -170.0, 26.0, -18.0, 0.0, 7.0, 44.0, -6.0, -12.0, 15.0, -1.0, 0.0, -14.0, -32.0, -30.0, -22.0, -4.0], "policy_predator_policy_reward": [151.0, 132.0, 0.0, 14.0, 0.0, 0.0, 10.0, 21.0, 162.0, 0.0, 8.0, 18.0, 152.0, 11.0, 156.0, 137.0, 133.0, 0.0, 151.0, 0.0, 1.0, 3.0, 0.0, 174.0, 81.0, 17.0, 159.0, 62.0, 190.0, 3.0, 122.0, 33.0, 57.0, 92.0, 22.0, 99.0, 0.0, 8.0, 28.0, 0.0, 156.0, 140.0, 94.0, 0.0, 87.0, 198.0, 103.0, 137.0, 34.0, 154.0, 2.0, 150.0, 1.0, 0.0, 130.0, 115.0, 37.0, 7.0, 14.0, 51.0, 0.0, 120.0, 0.0, 0.0, 45.0, 12.0, 38.0, 25.0, 134.0, 153.0, 153.0, 26.0, 136.0, 11.0, 170.0, 167.0, 30.0, 27.0, 44.0, 28.0, 29.0, 34.0, 74.0, 25.0, 71.0, 53.0, 89.0, 77.0, 1.0, 0.0, 57.0, 141.0, 0.0, 25.0, 40.0, 28.0, 0.0, 0.0, 133.0, 122.0, 0.0, 0.0, 58.0, 53.0, 0.0, 0.0, 41.0, 95.0, 0.0, 0.0, 0.0, 7.0, 0.0, 14.0, 135.0, 25.0, 20.0, 16.0, 6.0, 0.0, 112.0, 27.0, 0.0, 61.0, 37.0, 75.0, 12.0, 16.0, 0.0, 60.0, 38.0, 38.0, 27.0, 73.0, 5.0, 27.0, 43.0, 15.0, 71.0, 60.0, 21.0, 28.0, 37.0, 50.0, 67.0, 17.0, 67.0, 45.0, 20.0, 67.0, 50.0, 30.0, 0.0, 0.0, 44.0, 8.0, 62.0, 54.0, 28.0, 5.0, 6.0, 15.0, 16.0, 43.0, 2.0, 16.0, 53.0, 41.0, 41.0, 59.0, 10.0, 1.0, 0.0, 0.0, 48.0, 19.0, 24.0, 0.0, 16.0, 5.0, 2.0, 0.0, 32.0, 33.0, 80.0, 65.0, 0.0, 9.0, 4.0, 0.0, 0.0, 7.0, 30.0, 9.0, 9.0, 3.0, 16.0, 0.0, 4.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0944683826007553, "mean_inference_ms": 3.406006299876986, "mean_action_processing_ms": 0.5085167419234637, "mean_env_wait_ms": 0.39283955975167806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013261556625366211, "StateBufferConnector_ms": 0.004443168640136719, "ViewRequirementAgentConnector_ms": 0.1991955041885376}, "num_episodes": 18, "episode_return_max": 214.0, "episode_return_min": -262.0, "episode_return_mean": -14.9, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.5986086833781, "num_env_steps_trained_throughput_per_sec": 274.5986086833781, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 1952000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1952000, "timers": {"training_iteration_time_ms": 17853.425, "restore_workers_time_ms": 0.018, "training_step_time_ms": 17853.371, "sample_time_ms": 4103.151, "learn_time_ms": 13721.159, "learn_throughput": 291.521, "synch_weights_time_ms": 25.362}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000}, "done": false, "training_iteration": 122, "trial_id": "e1352_00002", "date": "2024-08-13_19-47-00", "timestamp": 1723592820, "time_this_iter_s": 14.603514909744263, "time_total_s": 2708.0849804878235, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d94af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2708.0849804878235, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 80.43809523809526, "ram_util_percent": 83.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7432909132784635, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 0.5767712564222396, "policy_loss": -0.003156590799766558, "vf_loss": 0.5794611751609458, "vf_explained_var": 0.05269696807104444, "kl": 0.010358822167978935, "entropy": 0.7769017940160459, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 231525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.71616713394406, "cur_kl_coeff": 0.000791908800601959, "cur_lr": 0.00010000000000000003, "total_loss": 0.8349014592214079, "policy_loss": -0.0016611146809602224, "vf_loss": 0.8365546388758553, "vf_explained_var": -0.04511047456630323, "kl": 0.010021061651258607, "entropy": 1.1183110366422664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 231525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "env_runners": {"episode_reward_max": 214.0, "episode_reward_min": -242.0, "episode_reward_mean": -3.97, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -352.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.0, "predator_policy": 170.0}, "policy_reward_mean": {"prey_policy": -34.22, "predator_policy": 32.235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.0, -145.0, -117.0, -1.0, -90.0, -43.0, 44.0, -71.0, 48.0, 40.0, 51.0, 0.0, -135.0, -67.0, -17.0, 41.0, 163.0, 214.0, -30.0, -35.0, 4.0, -1.0, -242.0, -8.0, 75.0, 17.0, -50.0, 0.0, 25.0, 0.0, -93.0, 0.0, -7.0, 16.0, -71.0, 81.0, -6.0, -45.0, 38.0, -8.0, 17.0, 27.0, -33.0, -48.0, 31.0, -16.0, -38.0, -24.0, 12.0, 47.0, 13.0, -31.0, 40.0, 6.0, -41.0, 34.0, -23.0, -31.0, 0.0, 14.0, -16.0, -43.0, 22.0, 27.0, -26.0, 0.0, 3.0, -2.0, -23.0, 1.0, -9.0, 55.0, -11.0, 53.0, -2.0, -46.0, -11.0, -6.0, 27.0, -5.0, -29.0, 12.0, 14.0, 47.0, -2.0, -17.0, -2.0, 12.0, -9.0, 0.0, -14.0, 9.0, 3.0, 7.0, -3.0, 10.0, 0.0, 5.0, 39.0, 15.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-243.0, -10.0, 7.0, -340.0, -64.0, -205.0, 0.0, -2.0, -16.0, -319.0, -42.0, -45.0, -53.0, 32.0, -191.0, 0.0, 48.0, 0.0, -17.0, 0.0, -8.0, -4.0, 0.0, -287.0, -152.0, -162.0, -214.0, 0.0, -352.0, -2.0, -14.0, -2.0, 22.0, 69.0, -28.0, 179.0, 0.0, -129.0, 0.0, -159.0, 0.0, -162.0, -2.0, 0.0, -206.0, -234.0, 0.0, -33.0, 7.0, 0.0, 0.0, 17.0, 0.0, -305.0, 0.0, 0.0, -76.0, -10.0, 0.0, 0.0, -120.0, -109.0, 0.0, 0.0, -14.0, 0.0, 0.0, 2.0, -23.0, -208.0, 65.0, -20.0, -12.0, 0.0, 0.0, -184.0, -23.0, 0.0, 0.0, -120.0, -1.0, -10.0, 39.0, -72.0, -47.0, -62.0, 0.0, -148.0, 0.0, -1.0, -74.0, 0.0, -116.0, -53.0, -32.0, -41.0, -76.0, 1.0, -44.0, 7.0, -140.0, 41.0, -108.0, -10.0, -67.0, 27.0, 6.0, 0.0, -34.0, -59.0, -56.0, -26.0, -6.0, -50.0, -18.0, -34.0, 12.0, -71.0, 8.0, -12.0, -16.0, -94.0, -121.0, -22.0, 11.0, 0.0, 27.0, 0.0, -18.0, -75.0, -16.0, -8.0, -18.0, 0.0, 0.0, -4.0, -17.0, -71.0, -170.0, 26.0, -18.0, 0.0, 7.0, 44.0, -6.0, -12.0, 15.0, -1.0, 0.0, -14.0, -32.0, -30.0, -22.0, -4.0, -68.0, -14.0, 19.0, 8.0, 4.0, -42.0, -28.0, -72.0, 1.0, -51.0, 0.0, 14.0, 8.0, 39.0, -18.0, -6.0, -45.0, 0.0, -21.0, 0.0, -12.0, 13.0, -60.0, 0.0, 0.0, -12.0, -9.0, -33.0, 0.0, 9.0, 0.0, -1.0, -10.0, 1.0, -5.0, -50.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 14.0, 24.0, 19.0, -12.0], "policy_predator_policy_reward": [103.0, 137.0, 34.0, 154.0, 2.0, 150.0, 1.0, 0.0, 130.0, 115.0, 37.0, 7.0, 14.0, 51.0, 0.0, 120.0, 0.0, 0.0, 45.0, 12.0, 38.0, 25.0, 134.0, 153.0, 153.0, 26.0, 136.0, 11.0, 170.0, 167.0, 30.0, 27.0, 44.0, 28.0, 29.0, 34.0, 74.0, 25.0, 71.0, 53.0, 89.0, 77.0, 1.0, 0.0, 57.0, 141.0, 0.0, 25.0, 40.0, 28.0, 0.0, 0.0, 133.0, 122.0, 0.0, 0.0, 58.0, 53.0, 0.0, 0.0, 41.0, 95.0, 0.0, 0.0, 0.0, 7.0, 0.0, 14.0, 135.0, 25.0, 20.0, 16.0, 6.0, 0.0, 112.0, 27.0, 0.0, 61.0, 37.0, 75.0, 12.0, 16.0, 0.0, 60.0, 38.0, 38.0, 27.0, 73.0, 5.0, 27.0, 43.0, 15.0, 71.0, 60.0, 21.0, 28.0, 37.0, 50.0, 67.0, 17.0, 67.0, 45.0, 20.0, 67.0, 50.0, 30.0, 0.0, 0.0, 44.0, 8.0, 62.0, 54.0, 28.0, 5.0, 6.0, 15.0, 16.0, 43.0, 2.0, 16.0, 53.0, 41.0, 41.0, 59.0, 10.0, 1.0, 0.0, 0.0, 48.0, 19.0, 24.0, 0.0, 16.0, 5.0, 2.0, 0.0, 32.0, 33.0, 80.0, 65.0, 0.0, 9.0, 4.0, 0.0, 0.0, 7.0, 30.0, 9.0, 9.0, 3.0, 16.0, 0.0, 4.0, 11.0, 34.0, 42.0, 0.0, 0.0, 31.0, 2.0, 37.0, 34.0, 26.0, 36.0, 0.0, 0.0, 0.0, 0.0, 3.0, 19.0, 0.0, 28.0, 4.0, 15.0, 2.0, 9.0, 33.0, 18.0, 0.0, 12.0, 23.0, 5.0, 0.0, 0.0, 4.0, 0.0, 6.0, 10.0, 32.0, 20.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 8.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.094347014463183, "mean_inference_ms": 3.4099289782821374, "mean_action_processing_ms": 0.5080195285902276, "mean_env_wait_ms": 0.393048232428613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010593056678771973, "StateBufferConnector_ms": 0.004450559616088867, "ViewRequirementAgentConnector_ms": 0.1855107545852661}, "num_episodes": 23, "episode_return_max": 214.0, "episode_return_min": -242.0, "episode_return_mean": -3.97, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 132.77881460839401, "num_env_steps_trained_throughput_per_sec": 132.77881460839401, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 1968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1968000, "timers": {"training_iteration_time_ms": 18062.282, "restore_workers_time_ms": 0.014, "training_step_time_ms": 18062.236, "sample_time_ms": 3141.579, "learn_time_ms": 14881.847, "learn_throughput": 268.784, "synch_weights_time_ms": 33.771}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "done": false, "training_iteration": 123, "trial_id": "e1352_00002", "date": "2024-08-13_19-47-31", "timestamp": 1723592851, "time_this_iter_s": 31.01284098625183, "time_total_s": 2739.0978214740753, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b8c3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2739.0978214740753, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 87.72666666666667, "ram_util_percent": 84.34}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.404446220058928, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 1.1843722295193446, "policy_loss": -0.0040465454807475446, "vf_loss": 1.1881158201309738, "vf_explained_var": 0.03091931560682872, "kl": 0.00672469373981891, "entropy": 0.8441261766448853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 233415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8080007975694365, "cur_kl_coeff": 0.000791908800601959, "cur_lr": 0.00010000000000000003, "total_loss": 1.1589937850832939, "policy_loss": -0.006203371558397535, "vf_loss": 1.1651901053057776, "vf_explained_var": -0.03287725675673712, "kl": 0.00890203540043895, "entropy": 1.105978372361925, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 233415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000}, "env_runners": {"episode_reward_max": 81.0, "episode_reward_min": -242.0, "episode_reward_mean": -4.4, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -305.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 65.0, "predator_policy": 141.0}, "policy_reward_mean": {"prey_policy": -24.91, "predator_policy": 22.71}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.0, -35.0, 4.0, -1.0, -242.0, -8.0, 75.0, 17.0, -50.0, 0.0, 25.0, 0.0, -93.0, 0.0, -7.0, 16.0, -71.0, 81.0, -6.0, -45.0, 38.0, -8.0, 17.0, 27.0, -33.0, -48.0, 31.0, -16.0, -38.0, -24.0, 12.0, 47.0, 13.0, -31.0, 40.0, 6.0, -41.0, 34.0, -23.0, -31.0, 0.0, 14.0, -16.0, -43.0, 22.0, 27.0, -26.0, 0.0, 3.0, -2.0, -23.0, 1.0, -9.0, 55.0, -11.0, 53.0, -2.0, -46.0, -11.0, -6.0, 27.0, -5.0, -29.0, 12.0, 14.0, 47.0, -2.0, -17.0, -2.0, 12.0, -9.0, 0.0, -14.0, 9.0, 3.0, 7.0, -3.0, 10.0, 0.0, 5.0, 39.0, 15.0, 27.0, -12.0, 18.0, -5.0, -88.0, -28.0, -12.0, -1.0, 7.0, -9.0, -16.0, 1.0, -26.0, 11.0, -5.0, -5.0, 2.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -129.0, 0.0, -159.0, 0.0, -162.0, -2.0, 0.0, -206.0, -234.0, 0.0, -33.0, 7.0, 0.0, 0.0, 17.0, 0.0, -305.0, 0.0, 0.0, -76.0, -10.0, 0.0, 0.0, -120.0, -109.0, 0.0, 0.0, -14.0, 0.0, 0.0, 2.0, -23.0, -208.0, 65.0, -20.0, -12.0, 0.0, 0.0, -184.0, -23.0, 0.0, 0.0, -120.0, -1.0, -10.0, 39.0, -72.0, -47.0, -62.0, 0.0, -148.0, 0.0, -1.0, -74.0, 0.0, -116.0, -53.0, -32.0, -41.0, -76.0, 1.0, -44.0, 7.0, -140.0, 41.0, -108.0, -10.0, -67.0, 27.0, 6.0, 0.0, -34.0, -59.0, -56.0, -26.0, -6.0, -50.0, -18.0, -34.0, 12.0, -71.0, 8.0, -12.0, -16.0, -94.0, -121.0, -22.0, 11.0, 0.0, 27.0, 0.0, -18.0, -75.0, -16.0, -8.0, -18.0, 0.0, 0.0, -4.0, -17.0, -71.0, -170.0, 26.0, -18.0, 0.0, 7.0, 44.0, -6.0, -12.0, 15.0, -1.0, 0.0, -14.0, -32.0, -30.0, -22.0, -4.0, -68.0, -14.0, 19.0, 8.0, 4.0, -42.0, -28.0, -72.0, 1.0, -51.0, 0.0, 14.0, 8.0, 39.0, -18.0, -6.0, -45.0, 0.0, -21.0, 0.0, -12.0, 13.0, -60.0, 0.0, 0.0, -12.0, -9.0, -33.0, 0.0, 9.0, 0.0, -1.0, -10.0, 1.0, -5.0, -50.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 14.0, 24.0, 19.0, -12.0, 27.0, 0.0, -45.0, 5.0, 3.0, 7.0, -14.0, -15.0, -56.0, -64.0, -35.0, -30.0, -24.0, 0.0, 0.0, -17.0, -10.0, -41.0, -26.0, -50.0, -4.0, -30.0, 1.0, 0.0, -30.0, -30.0, -6.0, 6.0, 0.0, -24.0, -3.0, -20.0, 0.0, 2.0, 0.0, -30.0], "policy_predator_policy_reward": [74.0, 25.0, 71.0, 53.0, 89.0, 77.0, 1.0, 0.0, 57.0, 141.0, 0.0, 25.0, 40.0, 28.0, 0.0, 0.0, 133.0, 122.0, 0.0, 0.0, 58.0, 53.0, 0.0, 0.0, 41.0, 95.0, 0.0, 0.0, 0.0, 7.0, 0.0, 14.0, 135.0, 25.0, 20.0, 16.0, 6.0, 0.0, 112.0, 27.0, 0.0, 61.0, 37.0, 75.0, 12.0, 16.0, 0.0, 60.0, 38.0, 38.0, 27.0, 73.0, 5.0, 27.0, 43.0, 15.0, 71.0, 60.0, 21.0, 28.0, 37.0, 50.0, 67.0, 17.0, 67.0, 45.0, 20.0, 67.0, 50.0, 30.0, 0.0, 0.0, 44.0, 8.0, 62.0, 54.0, 28.0, 5.0, 6.0, 15.0, 16.0, 43.0, 2.0, 16.0, 53.0, 41.0, 41.0, 59.0, 10.0, 1.0, 0.0, 0.0, 48.0, 19.0, 24.0, 0.0, 16.0, 5.0, 2.0, 0.0, 32.0, 33.0, 80.0, 65.0, 0.0, 9.0, 4.0, 0.0, 0.0, 7.0, 30.0, 9.0, 9.0, 3.0, 16.0, 0.0, 4.0, 11.0, 34.0, 42.0, 0.0, 0.0, 31.0, 2.0, 37.0, 34.0, 26.0, 36.0, 0.0, 0.0, 0.0, 0.0, 3.0, 19.0, 0.0, 28.0, 4.0, 15.0, 2.0, 9.0, 33.0, 18.0, 0.0, 12.0, 23.0, 5.0, 0.0, 0.0, 4.0, 0.0, 6.0, 10.0, 32.0, 20.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 8.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 8.0, 7.0, 17.0, 32.0, 0.0, 22.0, 15.0, 0.0, 12.0, 16.0, 0.0, 32.0, 26.0, 43.0, 24.0, 15.0, 3.0, 0.0, 0.0, 25.0, 9.0, 10.0, 1.0, 6.0, 13.0, 0.0, 18.0, 0.0, 0.0, 18.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1007176142920805, "mean_inference_ms": 3.4159988743313057, "mean_action_processing_ms": 0.5082318096574514, "mean_env_wait_ms": 0.3944042095141173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010577917098999023, "StateBufferConnector_ms": 0.006692051887512207, "ViewRequirementAgentConnector_ms": 0.18128037452697754}, "num_episodes": 18, "episode_return_max": 81.0, "episode_return_min": -242.0, "episode_return_mean": -4.4, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 120.80948528246611, "num_env_steps_trained_throughput_per_sec": 120.80948528246611, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 1984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1984000, "timers": {"training_iteration_time_ms": 19035.419, "restore_workers_time_ms": 3.947, "training_step_time_ms": 19030.15, "sample_time_ms": 3280.059, "learn_time_ms": 15709.487, "learn_throughput": 254.623, "synch_weights_time_ms": 33.761}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000}, "done": false, "training_iteration": 124, "trial_id": "e1352_00002", "date": "2024-08-13_19-48-06", "timestamp": 1723592886, "time_this_iter_s": 33.42743492126465, "time_total_s": 2772.52525639534, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e7cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2772.52525639534, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 96.37446808510637, "ram_util_percent": 84.34893617021277}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.609514332369522, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 1.2347555628371618, "policy_loss": -0.004653798555216146, "vf_loss": 1.2389812673210467, "vf_explained_var": 0.02901297574320798, "kl": 0.009502462444261018, "entropy": 0.8686874672218605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 235305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.124026927478099, "cur_kl_coeff": 0.000791908800601959, "cur_lr": 0.00010000000000000003, "total_loss": 1.1937259945210326, "policy_loss": -0.009440260986605335, "vf_loss": 1.20315086698879, "vf_explained_var": -0.018799135325446963, "kl": 0.019427089982926936, "entropy": 1.0822995770545232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 235305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "env_runners": {"episode_reward_max": 55.0, "episode_reward_min": -88.0, "episode_reward_mean": -2.29, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -170.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 44.0, "predator_policy": 80.0}, "policy_reward_mean": {"prey_policy": -18.36, "predator_policy": 17.215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.0, 27.0, -33.0, -48.0, 31.0, -16.0, -38.0, -24.0, 12.0, 47.0, 13.0, -31.0, 40.0, 6.0, -41.0, 34.0, -23.0, -31.0, 0.0, 14.0, -16.0, -43.0, 22.0, 27.0, -26.0, 0.0, 3.0, -2.0, -23.0, 1.0, -9.0, 55.0, -11.0, 53.0, -2.0, -46.0, -11.0, -6.0, 27.0, -5.0, -29.0, 12.0, 14.0, 47.0, -2.0, -17.0, -2.0, 12.0, -9.0, 0.0, -14.0, 9.0, 3.0, 7.0, -3.0, 10.0, 0.0, 5.0, 39.0, 15.0, 27.0, -12.0, 18.0, -5.0, -88.0, -28.0, -12.0, -1.0, 7.0, -9.0, -16.0, 1.0, -26.0, 11.0, -5.0, -5.0, 2.0, 0.0, -26.0, -30.0, 14.0, 12.0, 0.0, -19.0, 28.0, -15.0, -13.0, -8.0, 5.0, 21.0, -4.0, -9.0, 13.0, -6.0, -27.0, -5.0, -15.0, -14.0, -2.0, -29.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1.0, -10.0, 39.0, -72.0, -47.0, -62.0, 0.0, -148.0, 0.0, -1.0, -74.0, 0.0, -116.0, -53.0, -32.0, -41.0, -76.0, 1.0, -44.0, 7.0, -140.0, 41.0, -108.0, -10.0, -67.0, 27.0, 6.0, 0.0, -34.0, -59.0, -56.0, -26.0, -6.0, -50.0, -18.0, -34.0, 12.0, -71.0, 8.0, -12.0, -16.0, -94.0, -121.0, -22.0, 11.0, 0.0, 27.0, 0.0, -18.0, -75.0, -16.0, -8.0, -18.0, 0.0, 0.0, -4.0, -17.0, -71.0, -170.0, 26.0, -18.0, 0.0, 7.0, 44.0, -6.0, -12.0, 15.0, -1.0, 0.0, -14.0, -32.0, -30.0, -22.0, -4.0, -68.0, -14.0, 19.0, 8.0, 4.0, -42.0, -28.0, -72.0, 1.0, -51.0, 0.0, 14.0, 8.0, 39.0, -18.0, -6.0, -45.0, 0.0, -21.0, 0.0, -12.0, 13.0, -60.0, 0.0, 0.0, -12.0, -9.0, -33.0, 0.0, 9.0, 0.0, -1.0, -10.0, 1.0, -5.0, -50.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 14.0, 24.0, 19.0, -12.0, 27.0, 0.0, -45.0, 5.0, 3.0, 7.0, -14.0, -15.0, -56.0, -64.0, -35.0, -30.0, -24.0, 0.0, 0.0, -17.0, -10.0, -41.0, -26.0, -50.0, -4.0, -30.0, 1.0, 0.0, -30.0, -30.0, -6.0, 6.0, 0.0, -24.0, -3.0, -20.0, 0.0, 2.0, 0.0, -30.0, -29.0, -49.0, -52.0, -10.0, 0.0, 13.0, 19.0, -16.0, -18.0, -9.0, -46.0, -38.0, -12.0, 18.0, -44.0, -5.0, -50.0, 0.0, -2.0, -30.0, 0.0, 5.0, 21.0, -3.0, -8.0, 0.0, 9.0, -43.0, 8.0, 0.0, -44.0, -37.0, -67.0, -27.0, -6.0, -4.0, -35.0, -30.0, -25.0, -6.0, 0.0, -20.0, -60.0, -16.0], "policy_predator_policy_reward": [12.0, 16.0, 0.0, 60.0, 38.0, 38.0, 27.0, 73.0, 5.0, 27.0, 43.0, 15.0, 71.0, 60.0, 21.0, 28.0, 37.0, 50.0, 67.0, 17.0, 67.0, 45.0, 20.0, 67.0, 50.0, 30.0, 0.0, 0.0, 44.0, 8.0, 62.0, 54.0, 28.0, 5.0, 6.0, 15.0, 16.0, 43.0, 2.0, 16.0, 53.0, 41.0, 41.0, 59.0, 10.0, 1.0, 0.0, 0.0, 48.0, 19.0, 24.0, 0.0, 16.0, 5.0, 2.0, 0.0, 32.0, 33.0, 80.0, 65.0, 0.0, 9.0, 4.0, 0.0, 0.0, 7.0, 30.0, 9.0, 9.0, 3.0, 16.0, 0.0, 4.0, 11.0, 34.0, 42.0, 0.0, 0.0, 31.0, 2.0, 37.0, 34.0, 26.0, 36.0, 0.0, 0.0, 0.0, 0.0, 3.0, 19.0, 0.0, 28.0, 4.0, 15.0, 2.0, 9.0, 33.0, 18.0, 0.0, 12.0, 23.0, 5.0, 0.0, 0.0, 4.0, 0.0, 6.0, 10.0, 32.0, 20.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 8.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 8.0, 7.0, 17.0, 32.0, 0.0, 22.0, 15.0, 0.0, 12.0, 16.0, 0.0, 32.0, 26.0, 43.0, 24.0, 15.0, 3.0, 0.0, 0.0, 25.0, 9.0, 10.0, 1.0, 6.0, 13.0, 0.0, 18.0, 0.0, 0.0, 18.0, 12.0, 28.0, 24.0, 16.0, 16.0, 1.0, 0.0, 9.0, 0.0, 11.0, 16.0, 40.0, 25.0, 14.0, 8.0, 1.0, 33.0, 12.0, 25.0, 24.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 25.0, 5.0, 0.0, 47.0, 28.0, 45.0, 22.0, 3.0, 2.0, 15.0, 35.0, 17.0, 0.0, 6.0, 12.0, 22.0, 25.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1077990217548217, "mean_inference_ms": 3.428658956298628, "mean_action_processing_ms": 0.5091928409946156, "mean_env_wait_ms": 0.3960155667888911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011471748352050781, "StateBufferConnector_ms": 0.0067833662033081055, "ViewRequirementAgentConnector_ms": 0.19361960887908936}, "num_episodes": 22, "episode_return_max": 55.0, "episode_return_min": -88.0, "episode_return_mean": -2.29, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 164.11228535970187, "num_env_steps_trained_throughput_per_sec": 164.11228535970187, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 2000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2000000, "timers": {"training_iteration_time_ms": 19839.366, "restore_workers_time_ms": 3.951, "training_step_time_ms": 19834.09, "sample_time_ms": 3299.352, "learn_time_ms": 16491.912, "learn_throughput": 242.543, "synch_weights_time_ms": 36.497}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "done": false, "training_iteration": 125, "trial_id": "e1352_00002", "date": "2024-08-13_19-48-31", "timestamp": 1723592911, "time_this_iter_s": 24.904268980026245, "time_total_s": 2797.429525375366, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d41160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2797.429525375366, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 95.55882352941177, "ram_util_percent": 84.17647058823528}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6747099366926013, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 0.8518055429770833, "policy_loss": -0.0046554447353753465, "vf_loss": 0.8561248916836958, "vf_explained_var": 0.014136553220647984, "kl": 0.007460333555854267, "entropy": 0.7661582798238784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 237195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0210942266952423, "cur_kl_coeff": 0.000791908800601959, "cur_lr": 0.00010000000000000003, "total_loss": 1.3028161702017305, "policy_loss": -0.0016700012424576377, "vf_loss": 1.3044753260398037, "vf_explained_var": -0.004004514595818898, "kl": 0.013692738247432293, "entropy": 1.0824475041142216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 237195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "env_runners": {"episode_reward_max": 55.0, "episode_reward_min": -88.0, "episode_reward_mean": -2.57, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -170.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 44.0, "predator_policy": 80.0}, "policy_reward_mean": {"prey_policy": -14.1, "predator_policy": 12.815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 14.0, -16.0, -43.0, 22.0, 27.0, -26.0, 0.0, 3.0, -2.0, -23.0, 1.0, -9.0, 55.0, -11.0, 53.0, -2.0, -46.0, -11.0, -6.0, 27.0, -5.0, -29.0, 12.0, 14.0, 47.0, -2.0, -17.0, -2.0, 12.0, -9.0, 0.0, -14.0, 9.0, 3.0, 7.0, -3.0, 10.0, 0.0, 5.0, 39.0, 15.0, 27.0, -12.0, 18.0, -5.0, -88.0, -28.0, -12.0, -1.0, 7.0, -9.0, -16.0, 1.0, -26.0, 11.0, -5.0, -5.0, 2.0, 0.0, -26.0, -30.0, 14.0, 12.0, 0.0, -19.0, 28.0, -15.0, -13.0, -8.0, 5.0, 21.0, -4.0, -9.0, 13.0, -6.0, -27.0, -5.0, -15.0, -14.0, -2.0, -29.0, -7.0, 3.0, -8.0, -7.0, -13.0, 11.0, 27.0, 17.0, -24.0, 6.0, 6.0, -15.0, -13.0, -36.0, -5.0, 2.0, -20.0, -10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [12.0, -71.0, 8.0, -12.0, -16.0, -94.0, -121.0, -22.0, 11.0, 0.0, 27.0, 0.0, -18.0, -75.0, -16.0, -8.0, -18.0, 0.0, 0.0, -4.0, -17.0, -71.0, -170.0, 26.0, -18.0, 0.0, 7.0, 44.0, -6.0, -12.0, 15.0, -1.0, 0.0, -14.0, -32.0, -30.0, -22.0, -4.0, -68.0, -14.0, 19.0, 8.0, 4.0, -42.0, -28.0, -72.0, 1.0, -51.0, 0.0, 14.0, 8.0, 39.0, -18.0, -6.0, -45.0, 0.0, -21.0, 0.0, -12.0, 13.0, -60.0, 0.0, 0.0, -12.0, -9.0, -33.0, 0.0, 9.0, 0.0, -1.0, -10.0, 1.0, -5.0, -50.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 14.0, 24.0, 19.0, -12.0, 27.0, 0.0, -45.0, 5.0, 3.0, 7.0, -14.0, -15.0, -56.0, -64.0, -35.0, -30.0, -24.0, 0.0, 0.0, -17.0, -10.0, -41.0, -26.0, -50.0, -4.0, -30.0, 1.0, 0.0, -30.0, -30.0, -6.0, 6.0, 0.0, -24.0, -3.0, -20.0, 0.0, 2.0, 0.0, -30.0, -29.0, -49.0, -52.0, -10.0, 0.0, 13.0, 19.0, -16.0, -18.0, -9.0, -46.0, -38.0, -12.0, 18.0, -44.0, -5.0, -50.0, 0.0, -2.0, -30.0, 0.0, 5.0, 21.0, -3.0, -8.0, 0.0, 9.0, -43.0, 8.0, 0.0, -44.0, -37.0, -67.0, -27.0, -6.0, -4.0, -35.0, -30.0, -25.0, -6.0, 0.0, -20.0, -60.0, -16.0, -28.0, 0.0, 0.0, 3.0, 0.0, -25.0, 0.0, -16.0, -6.0, -18.0, 4.0, 1.0, -20.0, 26.0, 12.0, 5.0, -35.0, -41.0, 6.0, 0.0, -2.0, -9.0, 0.0, -33.0, -8.0, -14.0, -20.0, -56.0, 5.0, -40.0, -9.0, 4.0, -44.0, -10.0, -44.0, 0.0], "policy_predator_policy_reward": [16.0, 43.0, 2.0, 16.0, 53.0, 41.0, 41.0, 59.0, 10.0, 1.0, 0.0, 0.0, 48.0, 19.0, 24.0, 0.0, 16.0, 5.0, 2.0, 0.0, 32.0, 33.0, 80.0, 65.0, 0.0, 9.0, 4.0, 0.0, 0.0, 7.0, 30.0, 9.0, 9.0, 3.0, 16.0, 0.0, 4.0, 11.0, 34.0, 42.0, 0.0, 0.0, 31.0, 2.0, 37.0, 34.0, 26.0, 36.0, 0.0, 0.0, 0.0, 0.0, 3.0, 19.0, 0.0, 28.0, 4.0, 15.0, 2.0, 9.0, 33.0, 18.0, 0.0, 12.0, 23.0, 5.0, 0.0, 0.0, 4.0, 0.0, 6.0, 10.0, 32.0, 20.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 8.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 8.0, 7.0, 17.0, 32.0, 0.0, 22.0, 15.0, 0.0, 12.0, 16.0, 0.0, 32.0, 26.0, 43.0, 24.0, 15.0, 3.0, 0.0, 0.0, 25.0, 9.0, 10.0, 1.0, 6.0, 13.0, 0.0, 18.0, 0.0, 0.0, 18.0, 12.0, 28.0, 24.0, 16.0, 16.0, 1.0, 0.0, 9.0, 0.0, 11.0, 16.0, 40.0, 25.0, 14.0, 8.0, 1.0, 33.0, 12.0, 25.0, 24.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 25.0, 5.0, 0.0, 47.0, 28.0, 45.0, 22.0, 3.0, 2.0, 15.0, 35.0, 17.0, 0.0, 6.0, 12.0, 22.0, 25.0, 4.0, 17.0, 0.0, 0.0, 5.0, 12.0, 1.0, 8.0, 9.0, 2.0, 0.0, 6.0, 2.0, 19.0, 0.0, 0.0, 36.0, 16.0, 0.0, 0.0, 10.0, 7.0, 5.0, 13.0, 9.0, 0.0, 22.0, 18.0, 19.0, 11.0, 7.0, 0.0, 28.0, 6.0, 23.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1162223862691254, "mean_inference_ms": 3.4464234965452505, "mean_action_processing_ms": 0.5110859886259952, "mean_env_wait_ms": 0.39850659502783925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011712193489074707, "StateBufferConnector_ms": 0.007598161697387695, "ViewRequirementAgentConnector_ms": 0.24155771732330322}, "num_episodes": 18, "episode_return_max": 55.0, "episode_return_min": -88.0, "episode_return_mean": -2.57, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 179.07470918399352, "num_env_steps_trained_throughput_per_sec": 179.07470918399352, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 2016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2016000, "timers": {"training_iteration_time_ms": 20553.524, "restore_workers_time_ms": 4.008, "training_step_time_ms": 20548.117, "sample_time_ms": 3566.251, "learn_time_ms": 16939.206, "learn_throughput": 236.139, "synch_weights_time_ms": 36.553}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "done": false, "training_iteration": 126, "trial_id": "e1352_00002", "date": "2024-08-13_19-48-53", "timestamp": 1723592933, "time_this_iter_s": 22.613293886184692, "time_total_s": 2820.042819261551, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b8c3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2820.042819261551, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 85.98620689655174, "ram_util_percent": 84.14482758620689}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.180235791064444, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 0.9740821848313014, "policy_loss": -0.0015175603327671529, "vf_loss": 0.9752873789302255, "vf_explained_var": 0.008393481263407955, "kl": 0.006933614911827729, "entropy": 0.7643270803191674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 239085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0110502040811946, "cur_kl_coeff": 0.000791908800601959, "cur_lr": 0.00010000000000000003, "total_loss": 1.5997945374281948, "policy_loss": -0.001104041465272309, "vf_loss": 1.6008901146353869, "vf_explained_var": -0.0015051129318418956, "kl": 0.01069319072812081, "entropy": 1.0995017394817694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 239085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 2032000}, "env_runners": {"episode_reward_max": 47.0, "episode_reward_min": -300.0, "episode_reward_mean": -7.75, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -270.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 39.0, "predator_policy": 136.0}, "policy_reward_mean": {"prey_policy": -15.48, "predator_policy": 11.605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.0, -6.0, 27.0, -5.0, -29.0, 12.0, 14.0, 47.0, -2.0, -17.0, -2.0, 12.0, -9.0, 0.0, -14.0, 9.0, 3.0, 7.0, -3.0, 10.0, 0.0, 5.0, 39.0, 15.0, 27.0, -12.0, 18.0, -5.0, -88.0, -28.0, -12.0, -1.0, 7.0, -9.0, -16.0, 1.0, -26.0, 11.0, -5.0, -5.0, 2.0, 0.0, -26.0, -30.0, 14.0, 12.0, 0.0, -19.0, 28.0, -15.0, -13.0, -8.0, 5.0, 21.0, -4.0, -9.0, 13.0, -6.0, -27.0, -5.0, -15.0, -14.0, -2.0, -29.0, -7.0, 3.0, -8.0, -7.0, -13.0, 11.0, 27.0, 17.0, -24.0, 6.0, 6.0, -15.0, -13.0, -36.0, -5.0, 2.0, -20.0, -10.0, 26.0, 2.0, -4.0, 0.0, 5.0, 0.0, -44.0, -20.0, -300.0, 26.0, 1.0, -1.0, 4.0, 5.0, -245.0, 18.0, 6.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.0, -4.0, -68.0, -14.0, 19.0, 8.0, 4.0, -42.0, -28.0, -72.0, 1.0, -51.0, 0.0, 14.0, 8.0, 39.0, -18.0, -6.0, -45.0, 0.0, -21.0, 0.0, -12.0, 13.0, -60.0, 0.0, 0.0, -12.0, -9.0, -33.0, 0.0, 9.0, 0.0, -1.0, -10.0, 1.0, -5.0, -50.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 14.0, 24.0, 19.0, -12.0, 27.0, 0.0, -45.0, 5.0, 3.0, 7.0, -14.0, -15.0, -56.0, -64.0, -35.0, -30.0, -24.0, 0.0, 0.0, -17.0, -10.0, -41.0, -26.0, -50.0, -4.0, -30.0, 1.0, 0.0, -30.0, -30.0, -6.0, 6.0, 0.0, -24.0, -3.0, -20.0, 0.0, 2.0, 0.0, -30.0, -29.0, -49.0, -52.0, -10.0, 0.0, 13.0, 19.0, -16.0, -18.0, -9.0, -46.0, -38.0, -12.0, 18.0, -44.0, -5.0, -50.0, 0.0, -2.0, -30.0, 0.0, 5.0, 21.0, -3.0, -8.0, 0.0, 9.0, -43.0, 8.0, 0.0, -44.0, -37.0, -67.0, -27.0, -6.0, -4.0, -35.0, -30.0, -25.0, -6.0, 0.0, -20.0, -60.0, -16.0, -28.0, 0.0, 0.0, 3.0, 0.0, -25.0, 0.0, -16.0, -6.0, -18.0, 4.0, 1.0, -20.0, 26.0, 12.0, 5.0, -35.0, -41.0, 6.0, 0.0, -2.0, -9.0, 0.0, -33.0, -8.0, -14.0, -20.0, -56.0, 5.0, -40.0, -9.0, 4.0, -44.0, -10.0, -44.0, 0.0, 4.0, 22.0, 11.0, -25.0, -8.0, 0.0, -28.0, 7.0, -14.0, 0.0, 0.0, 0.0, -66.0, -21.0, -14.0, -26.0, -270.0, -166.0, 33.0, -16.0, 0.0, -4.0, -12.0, 0.0, -22.0, 1.0, 11.0, -15.0, -134.0, -235.0, 0.0, 18.0, -10.0, 7.0, 0.0, 0.0], "policy_predator_policy_reward": [4.0, 11.0, 34.0, 42.0, 0.0, 0.0, 31.0, 2.0, 37.0, 34.0, 26.0, 36.0, 0.0, 0.0, 0.0, 0.0, 3.0, 19.0, 0.0, 28.0, 4.0, 15.0, 2.0, 9.0, 33.0, 18.0, 0.0, 12.0, 23.0, 5.0, 0.0, 0.0, 4.0, 0.0, 6.0, 10.0, 32.0, 20.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 1.0, 0.0, 8.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 8.0, 7.0, 17.0, 32.0, 0.0, 22.0, 15.0, 0.0, 12.0, 16.0, 0.0, 32.0, 26.0, 43.0, 24.0, 15.0, 3.0, 0.0, 0.0, 25.0, 9.0, 10.0, 1.0, 6.0, 13.0, 0.0, 18.0, 0.0, 0.0, 18.0, 12.0, 28.0, 24.0, 16.0, 16.0, 1.0, 0.0, 9.0, 0.0, 11.0, 16.0, 40.0, 25.0, 14.0, 8.0, 1.0, 33.0, 12.0, 25.0, 24.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 25.0, 5.0, 0.0, 47.0, 28.0, 45.0, 22.0, 3.0, 2.0, 15.0, 35.0, 17.0, 0.0, 6.0, 12.0, 22.0, 25.0, 4.0, 17.0, 0.0, 0.0, 5.0, 12.0, 1.0, 8.0, 9.0, 2.0, 0.0, 6.0, 2.0, 19.0, 0.0, 0.0, 36.0, 16.0, 0.0, 0.0, 10.0, 7.0, 5.0, 13.0, 9.0, 0.0, 22.0, 18.0, 19.0, 11.0, 7.0, 0.0, 28.0, 6.0, 23.0, 11.0, 0.0, 0.0, 1.0, 15.0, 0.0, 4.0, 0.0, 21.0, 6.0, 13.0, 0.0, 0.0, 23.0, 20.0, 20.0, 0.0, 136.0, 0.0, 9.0, 0.0, 5.0, 0.0, 11.0, 0.0, 25.0, 0.0, 0.0, 9.0, 117.0, 7.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.124390135968891, "mean_inference_ms": 3.4643023187378823, "mean_action_processing_ms": 0.5130030154473395, "mean_env_wait_ms": 0.4009460063284761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011750221252441406, "StateBufferConnector_ms": 0.00687253475189209, "ViewRequirementAgentConnector_ms": 0.23445594310760498}, "num_episodes": 18, "episode_return_max": 47.0, "episode_return_min": -300.0, "episode_return_mean": -7.75, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 2032000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.29586537555895, "num_env_steps_trained_throughput_per_sec": 254.29586537555895, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 2032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2032000, "timers": {"training_iteration_time_ms": 20742.582, "restore_workers_time_ms": 4.009, "training_step_time_ms": 20737.175, "sample_time_ms": 3642.524, "learn_time_ms": 17052.523, "learn_throughput": 234.569, "synch_weights_time_ms": 36.394}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 2032000}, "done": false, "training_iteration": 127, "trial_id": "e1352_00002", "date": "2024-08-13_19-49-09", "timestamp": 1723592949, "time_this_iter_s": 15.809062957763672, "time_total_s": 2835.8518822193146, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e4a3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2835.8518822193146, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 87.84782608695652, "ram_util_percent": 83.97826086956522}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3540864289240546, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 1.4552596499364843, "policy_loss": -0.0070677668194991175, "vf_loss": 1.4617564604080544, "vf_explained_var": 0.004553710279010591, "kl": 0.012673594745667469, "entropy": 0.8138034374310226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 240975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7798655437965873, "cur_kl_coeff": 0.000791908800601959, "cur_lr": 0.00010000000000000003, "total_loss": 1.9794827476380363, "policy_loss": -0.004267491694175141, "vf_loss": 1.9837328094338613, "vf_explained_var": -0.0013706314500677524, "kl": 0.022007835945383466, "entropy": 1.1071605791490544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 240975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -553.0, "episode_reward_mean": -26.45, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -620.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 33.0, "predator_policy": 570.0}, "policy_reward_mean": {"prey_policy": -29.46, "predator_policy": 16.235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 27.0, -12.0, 18.0, -5.0, -88.0, -28.0, -12.0, -1.0, 7.0, -9.0, -16.0, 1.0, -26.0, 11.0, -5.0, -5.0, 2.0, 0.0, -26.0, -30.0, 14.0, 12.0, 0.0, -19.0, 28.0, -15.0, -13.0, -8.0, 5.0, 21.0, -4.0, -9.0, 13.0, -6.0, -27.0, -5.0, -15.0, -14.0, -2.0, -29.0, -7.0, 3.0, -8.0, -7.0, -13.0, 11.0, 27.0, 17.0, -24.0, 6.0, 6.0, -15.0, -13.0, -36.0, -5.0, 2.0, -20.0, -10.0, 26.0, 2.0, -4.0, 0.0, 5.0, 0.0, -44.0, -20.0, -300.0, 26.0, 1.0, -1.0, 4.0, 5.0, -245.0, 18.0, 6.0, 0.0, 14.0, -21.0, -11.0, -530.0, 0.0, -45.0, -7.0, -14.0, -24.0, -13.0, -14.0, -445.0, -15.0, 26.0, -553.0, -6.0, -10.0, -7.0, -33.0, -20.0, -2.0, -36.0, -17.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [19.0, -12.0, 27.0, 0.0, -45.0, 5.0, 3.0, 7.0, -14.0, -15.0, -56.0, -64.0, -35.0, -30.0, -24.0, 0.0, 0.0, -17.0, -10.0, -41.0, -26.0, -50.0, -4.0, -30.0, 1.0, 0.0, -30.0, -30.0, -6.0, 6.0, 0.0, -24.0, -3.0, -20.0, 0.0, 2.0, 0.0, -30.0, -29.0, -49.0, -52.0, -10.0, 0.0, 13.0, 19.0, -16.0, -18.0, -9.0, -46.0, -38.0, -12.0, 18.0, -44.0, -5.0, -50.0, 0.0, -2.0, -30.0, 0.0, 5.0, 21.0, -3.0, -8.0, 0.0, 9.0, -43.0, 8.0, 0.0, -44.0, -37.0, -67.0, -27.0, -6.0, -4.0, -35.0, -30.0, -25.0, -6.0, 0.0, -20.0, -60.0, -16.0, -28.0, 0.0, 0.0, 3.0, 0.0, -25.0, 0.0, -16.0, -6.0, -18.0, 4.0, 1.0, -20.0, 26.0, 12.0, 5.0, -35.0, -41.0, 6.0, 0.0, -2.0, -9.0, 0.0, -33.0, -8.0, -14.0, -20.0, -56.0, 5.0, -40.0, -9.0, 4.0, -44.0, -10.0, -44.0, 0.0, 4.0, 22.0, 11.0, -25.0, -8.0, 0.0, -28.0, 7.0, -14.0, 0.0, 0.0, 0.0, -66.0, -21.0, -14.0, -26.0, -270.0, -166.0, 33.0, -16.0, 0.0, -4.0, -12.0, 0.0, -22.0, 1.0, 11.0, -15.0, -134.0, -235.0, 0.0, 18.0, -10.0, 7.0, 0.0, 0.0, 10.0, 0.0, -50.0, 0.0, -7.0, -17.0, -480.0, -620.0, 0.0, 0.0, -40.0, -52.0, -1.0, -16.0, 4.0, -36.0, -82.0, 0.0, 0.0, -39.0, -4.0, -20.0, -303.0, -306.0, -15.0, -26.0, 8.0, 18.0, -359.0, -398.0, -67.0, 0.0, 0.0, -22.0, 0.0, -14.0, -70.0, 0.0, -24.0, -36.0, -12.0, 0.0, -22.0, -71.0, -39.0, -6.0], "policy_predator_policy_reward": [8.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 8.0, 7.0, 17.0, 32.0, 0.0, 22.0, 15.0, 0.0, 12.0, 16.0, 0.0, 32.0, 26.0, 43.0, 24.0, 15.0, 3.0, 0.0, 0.0, 25.0, 9.0, 10.0, 1.0, 6.0, 13.0, 0.0, 18.0, 0.0, 0.0, 18.0, 12.0, 28.0, 24.0, 16.0, 16.0, 1.0, 0.0, 9.0, 0.0, 11.0, 16.0, 40.0, 25.0, 14.0, 8.0, 1.0, 33.0, 12.0, 25.0, 24.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 25.0, 5.0, 0.0, 47.0, 28.0, 45.0, 22.0, 3.0, 2.0, 15.0, 35.0, 17.0, 0.0, 6.0, 12.0, 22.0, 25.0, 4.0, 17.0, 0.0, 0.0, 5.0, 12.0, 1.0, 8.0, 9.0, 2.0, 0.0, 6.0, 2.0, 19.0, 0.0, 0.0, 36.0, 16.0, 0.0, 0.0, 10.0, 7.0, 5.0, 13.0, 9.0, 0.0, 22.0, 18.0, 19.0, 11.0, 7.0, 0.0, 28.0, 6.0, 23.0, 11.0, 0.0, 0.0, 1.0, 15.0, 0.0, 4.0, 0.0, 21.0, 6.0, 13.0, 0.0, 0.0, 23.0, 20.0, 20.0, 0.0, 136.0, 0.0, 9.0, 0.0, 5.0, 0.0, 11.0, 0.0, 25.0, 0.0, 0.0, 9.0, 117.0, 7.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 29.0, 4.0, 9.0, 570.0, 0.0, 0.0, 0.0, 33.0, 14.0, 0.0, 10.0, 18.0, 0.0, 22.0, 36.0, 26.0, 0.0, 10.0, 0.0, 162.0, 2.0, 7.0, 19.0, 0.0, 0.0, 200.0, 4.0, 30.0, 31.0, 6.0, 6.0, 7.0, 0.0, 33.0, 4.0, 0.0, 40.0, 10.0, 0.0, 0.0, 57.0, 28.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1351859255827625, "mean_inference_ms": 3.4892280279643044, "mean_action_processing_ms": 0.5155712412380645, "mean_env_wait_ms": 0.40430356501864045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007402658462524414, "StateBufferConnector_ms": 0.0068846940994262695, "ViewRequirementAgentConnector_ms": 0.22990238666534424}, "num_episodes": 23, "episode_return_max": 28.0, "episode_return_min": -553.0, "episode_return_mean": -26.45, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 236.55802118837173, "num_env_steps_trained_throughput_per_sec": 236.55802118837173, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 2048000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2048000, "timers": {"training_iteration_time_ms": 21032.983, "restore_workers_time_ms": 4.009, "training_step_time_ms": 21027.576, "sample_time_ms": 3799.545, "learn_time_ms": 17185.433, "learn_throughput": 232.755, "synch_weights_time_ms": 36.802}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000}, "done": false, "training_iteration": 128, "trial_id": "e1352_00002", "date": "2024-08-13_19-49-26", "timestamp": 1723592966, "time_this_iter_s": 16.9775447845459, "time_total_s": 2852.8294270038605, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d44e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2852.8294270038605, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 85.42916666666667, "ram_util_percent": 83.96666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.651143844386257, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 1.326105396268229, "policy_loss": -0.004922739010939877, "vf_loss": 1.3306617803989895, "vf_explained_var": 0.012038671434240996, "kl": 0.008132018439667986, "entropy": 0.8345199131776416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 242865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.767390237117886, "cur_kl_coeff": 0.0011878632009029388, "cur_lr": 0.00010000000000000003, "total_loss": 1.7674229780832926, "policy_loss": -0.00424694967845445, "vf_loss": 1.771643950573351, "vf_explained_var": -0.005808535328617802, "kl": 0.021866530534359968, "entropy": 1.0759034301238086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 242865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "env_runners": {"episode_reward_max": 37.0, "episode_reward_min": -553.0, "episode_reward_mean": -34.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -620.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 33.0, "predator_policy": 570.0}, "policy_reward_mean": {"prey_policy": -34.825, "predator_policy": 17.805}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 0.0, -19.0, 28.0, -15.0, -13.0, -8.0, 5.0, 21.0, -4.0, -9.0, 13.0, -6.0, -27.0, -5.0, -15.0, -14.0, -2.0, -29.0, -7.0, 3.0, -8.0, -7.0, -13.0, 11.0, 27.0, 17.0, -24.0, 6.0, 6.0, -15.0, -13.0, -36.0, -5.0, 2.0, -20.0, -10.0, 26.0, 2.0, -4.0, 0.0, 5.0, 0.0, -44.0, -20.0, -300.0, 26.0, 1.0, -1.0, 4.0, 5.0, -245.0, 18.0, 6.0, 0.0, 14.0, -21.0, -11.0, -530.0, 0.0, -45.0, -7.0, -14.0, -24.0, -13.0, -14.0, -445.0, -15.0, 26.0, -553.0, -6.0, -10.0, -7.0, -33.0, -20.0, -2.0, -36.0, -17.0, -15.0, -15.0, -15.0, 35.0, 0.0, -13.0, -171.0, -11.0, 37.0, 0.0, -26.0, -52.0, 0.0, -328.0, -339.0, -10.0, -16.0, -1.0, 20.0, 6.0, 2.0, -15.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [19.0, -16.0, -18.0, -9.0, -46.0, -38.0, -12.0, 18.0, -44.0, -5.0, -50.0, 0.0, -2.0, -30.0, 0.0, 5.0, 21.0, -3.0, -8.0, 0.0, 9.0, -43.0, 8.0, 0.0, -44.0, -37.0, -67.0, -27.0, -6.0, -4.0, -35.0, -30.0, -25.0, -6.0, 0.0, -20.0, -60.0, -16.0, -28.0, 0.0, 0.0, 3.0, 0.0, -25.0, 0.0, -16.0, -6.0, -18.0, 4.0, 1.0, -20.0, 26.0, 12.0, 5.0, -35.0, -41.0, 6.0, 0.0, -2.0, -9.0, 0.0, -33.0, -8.0, -14.0, -20.0, -56.0, 5.0, -40.0, -9.0, 4.0, -44.0, -10.0, -44.0, 0.0, 4.0, 22.0, 11.0, -25.0, -8.0, 0.0, -28.0, 7.0, -14.0, 0.0, 0.0, 0.0, -66.0, -21.0, -14.0, -26.0, -270.0, -166.0, 33.0, -16.0, 0.0, -4.0, -12.0, 0.0, -22.0, 1.0, 11.0, -15.0, -134.0, -235.0, 0.0, 18.0, -10.0, 7.0, 0.0, 0.0, 10.0, 0.0, -50.0, 0.0, -7.0, -17.0, -480.0, -620.0, 0.0, 0.0, -40.0, -52.0, -1.0, -16.0, 4.0, -36.0, -82.0, 0.0, 0.0, -39.0, -4.0, -20.0, -303.0, -306.0, -15.0, -26.0, 8.0, 18.0, -359.0, -398.0, -67.0, 0.0, 0.0, -22.0, 0.0, -14.0, -70.0, 0.0, -24.0, -36.0, -12.0, 0.0, -22.0, -71.0, -39.0, -6.0, 0.0, -36.0, -2.0, -28.0, -4.0, -44.0, 0.0, 23.0, -45.0, 0.0, 5.0, -46.0, -160.0, -96.0, 0.0, -22.0, 21.0, 16.0, 0.0, 0.0, 0.0, -55.0, -50.0, -61.0, -13.0, -40.0, -237.0, -241.0, -233.0, -275.0, -20.0, -7.0, -1.0, -54.0, 0.0, -2.0, 20.0, 0.0, 6.0, 0.0, 2.0, 0.0, -39.0, -28.0], "policy_predator_policy_reward": [9.0, 0.0, 11.0, 16.0, 40.0, 25.0, 14.0, 8.0, 1.0, 33.0, 12.0, 25.0, 24.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 25.0, 5.0, 0.0, 47.0, 28.0, 45.0, 22.0, 3.0, 2.0, 15.0, 35.0, 17.0, 0.0, 6.0, 12.0, 22.0, 25.0, 4.0, 17.0, 0.0, 0.0, 5.0, 12.0, 1.0, 8.0, 9.0, 2.0, 0.0, 6.0, 2.0, 19.0, 0.0, 0.0, 36.0, 16.0, 0.0, 0.0, 10.0, 7.0, 5.0, 13.0, 9.0, 0.0, 22.0, 18.0, 19.0, 11.0, 7.0, 0.0, 28.0, 6.0, 23.0, 11.0, 0.0, 0.0, 1.0, 15.0, 0.0, 4.0, 0.0, 21.0, 6.0, 13.0, 0.0, 0.0, 23.0, 20.0, 20.0, 0.0, 136.0, 0.0, 9.0, 0.0, 5.0, 0.0, 11.0, 0.0, 25.0, 0.0, 0.0, 9.0, 117.0, 7.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 29.0, 4.0, 9.0, 570.0, 0.0, 0.0, 0.0, 33.0, 14.0, 0.0, 10.0, 18.0, 0.0, 22.0, 36.0, 26.0, 0.0, 10.0, 0.0, 162.0, 2.0, 7.0, 19.0, 0.0, 0.0, 200.0, 4.0, 30.0, 31.0, 6.0, 6.0, 7.0, 0.0, 33.0, 4.0, 0.0, 40.0, 10.0, 0.0, 0.0, 57.0, 28.0, 0.0, 2.0, 19.0, 0.0, 15.0, 19.0, 14.0, 11.0, 1.0, 25.0, 20.0, 25.0, 3.0, 0.0, 85.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 55.0, 4.0, 30.0, 23.0, 10.0, 140.0, 166.0, 3.0, 0.0, 17.0, 27.0, 12.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 31.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1400664907992661, "mean_inference_ms": 3.5031843676573917, "mean_action_processing_ms": 0.517049779351192, "mean_env_wait_ms": 0.4061429847814989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007581233978271484, "StateBufferConnector_ms": 0.004492402076721191, "ViewRequirementAgentConnector_ms": 0.24521708488464355}, "num_episodes": 22, "episode_return_max": 37.0, "episode_return_min": -553.0, "episode_return_mean": -34.04, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.30323206406456, "num_env_steps_trained_throughput_per_sec": 266.30323206406456, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 2064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2064000, "timers": {"training_iteration_time_ms": 21183.16, "restore_workers_time_ms": 4.009, "training_step_time_ms": 21177.753, "sample_time_ms": 3842.86, "learn_time_ms": 17292.844, "learn_throughput": 231.31, "synch_weights_time_ms": 36.415}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "done": false, "training_iteration": 129, "trial_id": "e1352_00002", "date": "2024-08-13_19-49-41", "timestamp": 1723592981, "time_this_iter_s": 15.086755990982056, "time_total_s": 2867.9161829948425, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d441f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2867.9161829948425, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 86.41428571428573, "ram_util_percent": 83.91428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1081270941350825, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 1.697045239916554, "policy_loss": -0.006955053810912268, "vf_loss": 1.7033021336510068, "vf_explained_var": 0.008184446008117111, "kl": 0.01549711679592668, "entropy": 0.7736749076969409, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 244755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.092036202423787, "cur_kl_coeff": 0.0017817948013544088, "cur_lr": 0.00010000000000000003, "total_loss": 2.3207697160029537, "policy_loss": -0.0026623218232844637, "vf_loss": 2.3234015015067246, "vf_explained_var": -0.0044185681002480645, "kl": 0.01713721379850265, "entropy": 1.1029781062136252, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 244755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "env_runners": {"episode_reward_max": 37.0, "episode_reward_min": -553.0, "episode_reward_mean": -41.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -620.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 33.0, "predator_policy": 570.0}, "policy_reward_mean": {"prey_policy": -39.525, "predator_policy": 19.005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.0, -7.0, 3.0, -8.0, -7.0, -13.0, 11.0, 27.0, 17.0, -24.0, 6.0, 6.0, -15.0, -13.0, -36.0, -5.0, 2.0, -20.0, -10.0, 26.0, 2.0, -4.0, 0.0, 5.0, 0.0, -44.0, -20.0, -300.0, 26.0, 1.0, -1.0, 4.0, 5.0, -245.0, 18.0, 6.0, 0.0, 14.0, -21.0, -11.0, -530.0, 0.0, -45.0, -7.0, -14.0, -24.0, -13.0, -14.0, -445.0, -15.0, 26.0, -553.0, -6.0, -10.0, -7.0, -33.0, -20.0, -2.0, -36.0, -17.0, -15.0, -15.0, -15.0, 35.0, 0.0, -13.0, -171.0, -11.0, 37.0, 0.0, -26.0, -52.0, 0.0, -328.0, -339.0, -10.0, -16.0, -1.0, 20.0, 6.0, 2.0, -15.0, 2.0, 0.0, -195.0, -20.0, 2.0, -305.0, 0.0, -4.0, -43.0, -38.0, 6.0, 10.0, -18.0, 3.0, -9.0, 8.0, -38.0, -119.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-60.0, -16.0, -28.0, 0.0, 0.0, 3.0, 0.0, -25.0, 0.0, -16.0, -6.0, -18.0, 4.0, 1.0, -20.0, 26.0, 12.0, 5.0, -35.0, -41.0, 6.0, 0.0, -2.0, -9.0, 0.0, -33.0, -8.0, -14.0, -20.0, -56.0, 5.0, -40.0, -9.0, 4.0, -44.0, -10.0, -44.0, 0.0, 4.0, 22.0, 11.0, -25.0, -8.0, 0.0, -28.0, 7.0, -14.0, 0.0, 0.0, 0.0, -66.0, -21.0, -14.0, -26.0, -270.0, -166.0, 33.0, -16.0, 0.0, -4.0, -12.0, 0.0, -22.0, 1.0, 11.0, -15.0, -134.0, -235.0, 0.0, 18.0, -10.0, 7.0, 0.0, 0.0, 10.0, 0.0, -50.0, 0.0, -7.0, -17.0, -480.0, -620.0, 0.0, 0.0, -40.0, -52.0, -1.0, -16.0, 4.0, -36.0, -82.0, 0.0, 0.0, -39.0, -4.0, -20.0, -303.0, -306.0, -15.0, -26.0, 8.0, 18.0, -359.0, -398.0, -67.0, 0.0, 0.0, -22.0, 0.0, -14.0, -70.0, 0.0, -24.0, -36.0, -12.0, 0.0, -22.0, -71.0, -39.0, -6.0, 0.0, -36.0, -2.0, -28.0, -4.0, -44.0, 0.0, 23.0, -45.0, 0.0, 5.0, -46.0, -160.0, -96.0, 0.0, -22.0, 21.0, 16.0, 0.0, 0.0, 0.0, -55.0, -50.0, -61.0, -13.0, -40.0, -237.0, -241.0, -233.0, -275.0, -20.0, -7.0, -1.0, -54.0, 0.0, -2.0, 20.0, 0.0, 6.0, 0.0, 2.0, 0.0, -39.0, -28.0, 0.0, 2.0, 0.0, 0.0, -8.0, -374.0, 0.0, -40.0, 0.0, 2.0, -250.0, -254.0, 0.0, 0.0, -65.0, 24.0, -66.0, -31.0, -58.0, -28.0, 0.0, 6.0, 0.0, 10.0, -10.0, -31.0, 10.0, -14.0, -18.0, 0.0, -49.0, 6.0, 0.0, -76.0, -69.0, -104.0], "policy_predator_policy_reward": [22.0, 25.0, 4.0, 17.0, 0.0, 0.0, 5.0, 12.0, 1.0, 8.0, 9.0, 2.0, 0.0, 6.0, 2.0, 19.0, 0.0, 0.0, 36.0, 16.0, 0.0, 0.0, 10.0, 7.0, 5.0, 13.0, 9.0, 0.0, 22.0, 18.0, 19.0, 11.0, 7.0, 0.0, 28.0, 6.0, 23.0, 11.0, 0.0, 0.0, 1.0, 15.0, 0.0, 4.0, 0.0, 21.0, 6.0, 13.0, 0.0, 0.0, 23.0, 20.0, 20.0, 0.0, 136.0, 0.0, 9.0, 0.0, 5.0, 0.0, 11.0, 0.0, 25.0, 0.0, 0.0, 9.0, 117.0, 7.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 29.0, 4.0, 9.0, 570.0, 0.0, 0.0, 0.0, 33.0, 14.0, 0.0, 10.0, 18.0, 0.0, 22.0, 36.0, 26.0, 0.0, 10.0, 0.0, 162.0, 2.0, 7.0, 19.0, 0.0, 0.0, 200.0, 4.0, 30.0, 31.0, 6.0, 6.0, 7.0, 0.0, 33.0, 4.0, 0.0, 40.0, 10.0, 0.0, 0.0, 57.0, 28.0, 0.0, 2.0, 19.0, 0.0, 15.0, 19.0, 14.0, 11.0, 1.0, 25.0, 20.0, 25.0, 3.0, 0.0, 85.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 55.0, 4.0, 30.0, 23.0, 10.0, 140.0, 166.0, 3.0, 0.0, 17.0, 27.0, 12.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 31.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 20.0, 0.0, 0.0, 0.0, 17.0, 182.0, 0.0, 0.0, 0.0, 37.0, 31.0, 23.0, 29.0, 19.0, 0.0, 0.0, 0.0, 0.0, 23.0, 0.0, 0.0, 7.0, 9.0, 0.0, 22.0, 29.0, 0.0, 38.0, 2.0, 52.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.143214194223272, "mean_inference_ms": 3.514363232037258, "mean_action_processing_ms": 0.5181956472536055, "mean_env_wait_ms": 0.40772860392706384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00665283203125, "StateBufferConnector_ms": 0.004338860511779785, "ViewRequirementAgentConnector_ms": 0.2378760576248169}, "num_episodes": 18, "episode_return_max": 37.0, "episode_return_min": -553.0, "episode_return_mean": -41.04, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.3191492638525, "num_env_steps_trained_throughput_per_sec": 283.3191492638525, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 2080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2080000, "timers": {"training_iteration_time_ms": 19987.648, "restore_workers_time_ms": 4.008, "training_step_time_ms": 19982.242, "sample_time_ms": 3770.712, "learn_time_ms": 16170.089, "learn_throughput": 247.37, "synch_weights_time_ms": 36.096}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "done": false, "training_iteration": 130, "trial_id": "e1352_00002", "date": "2024-08-13_19-49-56", "timestamp": 1723592996, "time_this_iter_s": 14.202774047851562, "time_total_s": 2882.118957042694, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e4a790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2882.118957042694, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 81.41000000000001, "ram_util_percent": 83.915}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2176449971855003, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 2.4395635121713872, "policy_loss": -0.0008295511435126028, "vf_loss": 2.4400895529323154, "vf_explained_var": 0.007971293901009535, "kl": 0.00673719196508212, "entropy": 0.7448592322844046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 246645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1894442646434067, "cur_kl_coeff": 0.0017817948013544088, "cur_lr": 0.00010000000000000003, "total_loss": 3.371419137369388, "policy_loss": -0.005214346163886447, "vf_loss": 3.3765951275194763, "vf_explained_var": -0.000914606562367192, "kl": 0.021530439643662816, "entropy": 1.092958871586613, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 246645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 2096000}, "env_runners": {"episode_reward_max": 37.0, "episode_reward_min": -553.0, "episode_reward_mean": -51.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -620.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 33.0, "predator_policy": 570.0}, "policy_reward_mean": {"prey_policy": -48.25, "predator_policy": 22.5}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, 26.0, 2.0, -4.0, 0.0, 5.0, 0.0, -44.0, -20.0, -300.0, 26.0, 1.0, -1.0, 4.0, 5.0, -245.0, 18.0, 6.0, 0.0, 14.0, -21.0, -11.0, -530.0, 0.0, -45.0, -7.0, -14.0, -24.0, -13.0, -14.0, -445.0, -15.0, 26.0, -553.0, -6.0, -10.0, -7.0, -33.0, -20.0, -2.0, -36.0, -17.0, -15.0, -15.0, -15.0, 35.0, 0.0, -13.0, -171.0, -11.0, 37.0, 0.0, -26.0, -52.0, 0.0, -328.0, -339.0, -10.0, -16.0, -1.0, 20.0, 6.0, 2.0, -15.0, 2.0, 0.0, -195.0, -20.0, 2.0, -305.0, 0.0, -4.0, -43.0, -38.0, 6.0, 10.0, -18.0, 3.0, -9.0, 8.0, -38.0, -119.0, -8.0, -8.0, -6.0, 7.0, -28.0, 1.0, -127.0, 9.0, 0.0, -120.0, -110.0, 0.0, -338.0, -24.0, -5.0, 10.0, -19.0, -385.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-44.0, 0.0, 4.0, 22.0, 11.0, -25.0, -8.0, 0.0, -28.0, 7.0, -14.0, 0.0, 0.0, 0.0, -66.0, -21.0, -14.0, -26.0, -270.0, -166.0, 33.0, -16.0, 0.0, -4.0, -12.0, 0.0, -22.0, 1.0, 11.0, -15.0, -134.0, -235.0, 0.0, 18.0, -10.0, 7.0, 0.0, 0.0, 10.0, 0.0, -50.0, 0.0, -7.0, -17.0, -480.0, -620.0, 0.0, 0.0, -40.0, -52.0, -1.0, -16.0, 4.0, -36.0, -82.0, 0.0, 0.0, -39.0, -4.0, -20.0, -303.0, -306.0, -15.0, -26.0, 8.0, 18.0, -359.0, -398.0, -67.0, 0.0, 0.0, -22.0, 0.0, -14.0, -70.0, 0.0, -24.0, -36.0, -12.0, 0.0, -22.0, -71.0, -39.0, -6.0, 0.0, -36.0, -2.0, -28.0, -4.0, -44.0, 0.0, 23.0, -45.0, 0.0, 5.0, -46.0, -160.0, -96.0, 0.0, -22.0, 21.0, 16.0, 0.0, 0.0, 0.0, -55.0, -50.0, -61.0, -13.0, -40.0, -237.0, -241.0, -233.0, -275.0, -20.0, -7.0, -1.0, -54.0, 0.0, -2.0, 20.0, 0.0, 6.0, 0.0, 2.0, 0.0, -39.0, -28.0, 0.0, 2.0, 0.0, 0.0, -8.0, -374.0, 0.0, -40.0, 0.0, 2.0, -250.0, -254.0, 0.0, 0.0, -65.0, 24.0, -66.0, -31.0, -58.0, -28.0, 0.0, 6.0, 0.0, 10.0, -10.0, -31.0, 10.0, -14.0, -18.0, 0.0, -49.0, 6.0, 0.0, -76.0, -69.0, -104.0, -13.0, -6.0, 0.0, -26.0, -25.0, 0.0, 4.0, 0.0, -65.0, -23.0, 1.0, 0.0, -184.0, -42.0, 9.0, 0.0, 0.0, -4.0, 29.0, -314.0, -21.0, -224.0, 0.0, 0.0, -268.0, -246.0, 9.0, -90.0, 4.0, -28.0, 14.0, -36.0, -67.0, 0.0, -326.0, -251.0], "policy_predator_policy_reward": [23.0, 11.0, 0.0, 0.0, 1.0, 15.0, 0.0, 4.0, 0.0, 21.0, 6.0, 13.0, 0.0, 0.0, 23.0, 20.0, 20.0, 0.0, 136.0, 0.0, 9.0, 0.0, 5.0, 0.0, 11.0, 0.0, 25.0, 0.0, 0.0, 9.0, 117.0, 7.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 29.0, 4.0, 9.0, 570.0, 0.0, 0.0, 0.0, 33.0, 14.0, 0.0, 10.0, 18.0, 0.0, 22.0, 36.0, 26.0, 0.0, 10.0, 0.0, 162.0, 2.0, 7.0, 19.0, 0.0, 0.0, 200.0, 4.0, 30.0, 31.0, 6.0, 6.0, 7.0, 0.0, 33.0, 4.0, 0.0, 40.0, 10.0, 0.0, 0.0, 57.0, 28.0, 0.0, 2.0, 19.0, 0.0, 15.0, 19.0, 14.0, 11.0, 1.0, 25.0, 20.0, 25.0, 3.0, 0.0, 85.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 55.0, 4.0, 30.0, 23.0, 10.0, 140.0, 166.0, 3.0, 0.0, 17.0, 27.0, 12.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 31.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 20.0, 0.0, 0.0, 0.0, 17.0, 182.0, 0.0, 0.0, 0.0, 37.0, 31.0, 23.0, 29.0, 19.0, 0.0, 0.0, 0.0, 0.0, 23.0, 0.0, 0.0, 7.0, 9.0, 0.0, 22.0, 29.0, 0.0, 38.0, 2.0, 52.0, 0.0, 11.0, 18.0, 0.0, 0.0, 19.0, 2.0, 1.0, 34.0, 26.0, 0.0, 0.0, 19.0, 80.0, 0.0, 0.0, 4.0, 0.0, 13.0, 152.0, 23.0, 112.0, 0.0, 0.0, 176.0, 0.0, 32.0, 25.0, 19.0, 0.0, 32.0, 0.0, 23.0, 25.0, 177.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1440518132046045, "mean_inference_ms": 3.5174910034621667, "mean_action_processing_ms": 0.5180322744874584, "mean_env_wait_ms": 0.4081921543448827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064547061920166016, "StateBufferConnector_ms": 0.0036118030548095703, "ViewRequirementAgentConnector_ms": 0.19259357452392578}, "num_episodes": 18, "episode_return_max": 37.0, "episode_return_min": -553.0, "episode_return_mean": -51.5, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 2096000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.1930297921623, "num_env_steps_trained_throughput_per_sec": 269.1930297921623, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 2096000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2096000, "timers": {"training_iteration_time_ms": 20115.944, "restore_workers_time_ms": 4.009, "training_step_time_ms": 20110.535, "sample_time_ms": 3841.158, "learn_time_ms": 16229.222, "learn_throughput": 246.469, "synch_weights_time_ms": 34.395}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 2096000}, "done": false, "training_iteration": 131, "trial_id": "e1352_00002", "date": "2024-08-13_19-50-11", "timestamp": 1723593011, "time_this_iter_s": 14.90946102142334, "time_total_s": 2897.0284180641174, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d44e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2897.0284180641174, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 83.06363636363636, "ram_util_percent": 83.76363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3311048160548564, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 2.2148206403015784, "policy_loss": -0.00275624301493976, "vf_loss": 2.2170493572477312, "vf_explained_var": 0.0033987999908507817, "kl": 0.011709530817628414, "entropy": 0.8385455651888771, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 248535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6861250245381916, "cur_kl_coeff": 0.002672692202031612, "cur_lr": 0.00010000000000000003, "total_loss": 2.8668651033330845, "policy_loss": -0.0032055264110947964, "vf_loss": 2.8700240672896147, "vf_explained_var": -0.002349257847619435, "kl": 0.017422203590186307, "entropy": 1.0727925764820563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 248535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "env_runners": {"episode_reward_max": 69.0, "episode_reward_min": -553.0, "episode_reward_mean": -55.42, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -398.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 48.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -51.25, "predator_policy": 23.54}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -45.0, -7.0, -14.0, -24.0, -13.0, -14.0, -445.0, -15.0, 26.0, -553.0, -6.0, -10.0, -7.0, -33.0, -20.0, -2.0, -36.0, -17.0, -15.0, -15.0, -15.0, 35.0, 0.0, -13.0, -171.0, -11.0, 37.0, 0.0, -26.0, -52.0, 0.0, -328.0, -339.0, -10.0, -16.0, -1.0, 20.0, 6.0, 2.0, -15.0, 2.0, 0.0, -195.0, -20.0, 2.0, -305.0, 0.0, -4.0, -43.0, -38.0, 6.0, 10.0, -18.0, 3.0, -9.0, 8.0, -38.0, -119.0, -8.0, -8.0, -6.0, 7.0, -28.0, 1.0, -127.0, 9.0, 0.0, -120.0, -110.0, 0.0, -338.0, -24.0, -5.0, 10.0, -19.0, -385.0, 69.0, -254.0, -11.0, -390.0, -36.0, 15.0, 48.0, -23.0, -351.0, 4.0, 0.0, -21.0, -125.0, -18.0, 0.0, 0.0, -38.0, -6.0, 8.0, -20.0, -311.0, 0.0, -11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -40.0, -52.0, -1.0, -16.0, 4.0, -36.0, -82.0, 0.0, 0.0, -39.0, -4.0, -20.0, -303.0, -306.0, -15.0, -26.0, 8.0, 18.0, -359.0, -398.0, -67.0, 0.0, 0.0, -22.0, 0.0, -14.0, -70.0, 0.0, -24.0, -36.0, -12.0, 0.0, -22.0, -71.0, -39.0, -6.0, 0.0, -36.0, -2.0, -28.0, -4.0, -44.0, 0.0, 23.0, -45.0, 0.0, 5.0, -46.0, -160.0, -96.0, 0.0, -22.0, 21.0, 16.0, 0.0, 0.0, 0.0, -55.0, -50.0, -61.0, -13.0, -40.0, -237.0, -241.0, -233.0, -275.0, -20.0, -7.0, -1.0, -54.0, 0.0, -2.0, 20.0, 0.0, 6.0, 0.0, 2.0, 0.0, -39.0, -28.0, 0.0, 2.0, 0.0, 0.0, -8.0, -374.0, 0.0, -40.0, 0.0, 2.0, -250.0, -254.0, 0.0, 0.0, -65.0, 24.0, -66.0, -31.0, -58.0, -28.0, 0.0, 6.0, 0.0, 10.0, -10.0, -31.0, 10.0, -14.0, -18.0, 0.0, -49.0, 6.0, 0.0, -76.0, -69.0, -104.0, -13.0, -6.0, 0.0, -26.0, -25.0, 0.0, 4.0, 0.0, -65.0, -23.0, 1.0, 0.0, -184.0, -42.0, 9.0, 0.0, 0.0, -4.0, 29.0, -314.0, -21.0, -224.0, 0.0, 0.0, -268.0, -246.0, 9.0, -90.0, 4.0, -28.0, 14.0, -36.0, -67.0, 0.0, -326.0, -251.0, 13.0, 30.0, -358.0, -94.0, 0.0, -24.0, -309.0, -282.0, -134.0, 8.0, 5.0, -20.0, 48.0, 0.0, -53.0, 0.0, -258.0, -238.0, 4.0, 0.0, -32.0, -30.0, -12.0, -33.0, -250.0, 0.0, 3.0, -106.0, 0.0, 0.0, 0.0, 0.0, -52.0, -25.0, -25.0, -4.0, -1.0, 0.0, -52.0, 2.0, -185.0, -294.0, 0.0, 0.0, -22.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 33.0, 14.0, 0.0, 10.0, 18.0, 0.0, 22.0, 36.0, 26.0, 0.0, 10.0, 0.0, 162.0, 2.0, 7.0, 19.0, 0.0, 0.0, 200.0, 4.0, 30.0, 31.0, 6.0, 6.0, 7.0, 0.0, 33.0, 4.0, 0.0, 40.0, 10.0, 0.0, 0.0, 57.0, 28.0, 0.0, 2.0, 19.0, 0.0, 15.0, 19.0, 14.0, 11.0, 1.0, 25.0, 20.0, 25.0, 3.0, 0.0, 85.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 55.0, 4.0, 30.0, 23.0, 10.0, 140.0, 166.0, 3.0, 0.0, 17.0, 27.0, 12.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 31.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 20.0, 0.0, 0.0, 0.0, 17.0, 182.0, 0.0, 0.0, 0.0, 37.0, 31.0, 23.0, 29.0, 19.0, 0.0, 0.0, 0.0, 0.0, 23.0, 0.0, 0.0, 7.0, 9.0, 0.0, 22.0, 29.0, 0.0, 38.0, 2.0, 52.0, 0.0, 11.0, 18.0, 0.0, 0.0, 19.0, 2.0, 1.0, 34.0, 26.0, 0.0, 0.0, 19.0, 80.0, 0.0, 0.0, 4.0, 0.0, 13.0, 152.0, 23.0, 112.0, 0.0, 0.0, 176.0, 0.0, 32.0, 25.0, 19.0, 0.0, 32.0, 0.0, 23.0, 25.0, 177.0, 15.0, 15.0, 11.0, 0.0, 198.0, 13.0, 0.0, 40.0, 161.0, 5.0, 85.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 145.0, 0.0, 0.0, 34.0, 28.0, 0.0, 24.0, 125.0, 0.0, 48.0, 37.0, 0.0, 0.0, 0.0, 0.0, 36.0, 3.0, 9.0, 14.0, 9.0, 0.0, 28.0, 2.0, 8.0, 160.0, 0.0, 0.0, 11.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1447099834514047, "mean_inference_ms": 3.5253377589979027, "mean_action_processing_ms": 0.5179179100898529, "mean_env_wait_ms": 0.40924588374161996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006358623504638672, "StateBufferConnector_ms": 0.0036318302154541016, "ViewRequirementAgentConnector_ms": 0.2132892608642578}, "num_episodes": 23, "episode_return_max": 69.0, "episode_return_min": -553.0, "episode_return_mean": -55.42, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.6203823402951, "num_env_steps_trained_throughput_per_sec": 234.6203823402951, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 2112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2112000, "timers": {"training_iteration_time_ms": 20364.154, "restore_workers_time_ms": 4.01, "training_step_time_ms": 20358.745, "sample_time_ms": 3973.335, "learn_time_ms": 16350.545, "learn_throughput": 244.64, "synch_weights_time_ms": 28.117}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "done": false, "training_iteration": 132, "trial_id": "e1352_00002", "date": "2024-08-13_19-50-28", "timestamp": 1723593028, "time_this_iter_s": 17.099628925323486, "time_total_s": 2914.128046989441, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d94e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2914.128046989441, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 87.74166666666666, "ram_util_percent": 83.69166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0698356142750494, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 2.235216295214557, "policy_loss": -0.0023418425005816276, "vf_loss": 2.2372413445402075, "vf_explained_var": 0.0001855197722318942, "kl": 0.00703208338314504, "entropy": 0.6896250681271628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 250425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.136715123183513, "cur_kl_coeff": 0.002672692202031612, "cur_lr": 0.00010000000000000003, "total_loss": 3.03010016887907, "policy_loss": -0.0037961818061020007, "vf_loss": 3.0338455564761286, "vf_explained_var": -0.003448984389582639, "kl": 0.01900567557991356, "entropy": 1.092060955365499, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 250425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000}, "env_runners": {"episode_reward_max": 69.0, "episode_reward_min": -514.0, "episode_reward_mean": -52.61, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -374.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 48.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -51.55, "predator_policy": 25.245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.0, -15.0, -15.0, -15.0, 35.0, 0.0, -13.0, -171.0, -11.0, 37.0, 0.0, -26.0, -52.0, 0.0, -328.0, -339.0, -10.0, -16.0, -1.0, 20.0, 6.0, 2.0, -15.0, 2.0, 0.0, -195.0, -20.0, 2.0, -305.0, 0.0, -4.0, -43.0, -38.0, 6.0, 10.0, -18.0, 3.0, -9.0, 8.0, -38.0, -119.0, -8.0, -8.0, -6.0, 7.0, -28.0, 1.0, -127.0, 9.0, 0.0, -120.0, -110.0, 0.0, -338.0, -24.0, -5.0, 10.0, -19.0, -385.0, 69.0, -254.0, -11.0, -390.0, -36.0, 15.0, 48.0, -23.0, -351.0, 4.0, 0.0, -21.0, -125.0, -18.0, 0.0, 0.0, -38.0, -6.0, 8.0, -20.0, -311.0, 0.0, -11.0, -65.0, -12.0, -7.0, 34.0, -172.0, -29.0, -15.0, -32.0, -40.0, 42.0, 24.0, -514.0, 61.0, -14.0, 12.0, -197.0, 10.0, -23.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-39.0, -6.0, 0.0, -36.0, -2.0, -28.0, -4.0, -44.0, 0.0, 23.0, -45.0, 0.0, 5.0, -46.0, -160.0, -96.0, 0.0, -22.0, 21.0, 16.0, 0.0, 0.0, 0.0, -55.0, -50.0, -61.0, -13.0, -40.0, -237.0, -241.0, -233.0, -275.0, -20.0, -7.0, -1.0, -54.0, 0.0, -2.0, 20.0, 0.0, 6.0, 0.0, 2.0, 0.0, -39.0, -28.0, 0.0, 2.0, 0.0, 0.0, -8.0, -374.0, 0.0, -40.0, 0.0, 2.0, -250.0, -254.0, 0.0, 0.0, -65.0, 24.0, -66.0, -31.0, -58.0, -28.0, 0.0, 6.0, 0.0, 10.0, -10.0, -31.0, 10.0, -14.0, -18.0, 0.0, -49.0, 6.0, 0.0, -76.0, -69.0, -104.0, -13.0, -6.0, 0.0, -26.0, -25.0, 0.0, 4.0, 0.0, -65.0, -23.0, 1.0, 0.0, -184.0, -42.0, 9.0, 0.0, 0.0, -4.0, 29.0, -314.0, -21.0, -224.0, 0.0, 0.0, -268.0, -246.0, 9.0, -90.0, 4.0, -28.0, 14.0, -36.0, -67.0, 0.0, -326.0, -251.0, 13.0, 30.0, -358.0, -94.0, 0.0, -24.0, -309.0, -282.0, -134.0, 8.0, 5.0, -20.0, 48.0, 0.0, -53.0, 0.0, -258.0, -238.0, 4.0, 0.0, -32.0, -30.0, -12.0, -33.0, -250.0, 0.0, 3.0, -106.0, 0.0, 0.0, 0.0, 0.0, -52.0, -25.0, -25.0, -4.0, -1.0, 0.0, -52.0, 2.0, -185.0, -294.0, 0.0, 0.0, -22.0, 0.0, 5.0, -140.0, 5.0, -38.0, -40.0, -5.0, 27.0, 0.0, -138.0, -356.0, 0.0, -73.0, 0.0, -31.0, 0.0, -64.0, -95.0, 3.0, 0.0, 42.0, 0.0, 14.0, -368.0, -334.0, 8.0, 17.0, -117.0, 0.0, 27.0, -40.0, -91.0, -232.0, 0.0, 10.0, -76.0, 15.0], "policy_predator_policy_reward": [28.0, 0.0, 2.0, 19.0, 0.0, 15.0, 19.0, 14.0, 11.0, 1.0, 25.0, 20.0, 25.0, 3.0, 0.0, 85.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 55.0, 4.0, 30.0, 23.0, 10.0, 140.0, 166.0, 3.0, 0.0, 17.0, 27.0, 12.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 31.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 20.0, 0.0, 0.0, 0.0, 17.0, 182.0, 0.0, 0.0, 0.0, 37.0, 31.0, 23.0, 29.0, 19.0, 0.0, 0.0, 0.0, 0.0, 23.0, 0.0, 0.0, 7.0, 9.0, 0.0, 22.0, 29.0, 0.0, 38.0, 2.0, 52.0, 0.0, 11.0, 18.0, 0.0, 0.0, 19.0, 2.0, 1.0, 34.0, 26.0, 0.0, 0.0, 19.0, 80.0, 0.0, 0.0, 4.0, 0.0, 13.0, 152.0, 23.0, 112.0, 0.0, 0.0, 176.0, 0.0, 32.0, 25.0, 19.0, 0.0, 32.0, 0.0, 23.0, 25.0, 177.0, 15.0, 15.0, 11.0, 0.0, 198.0, 13.0, 0.0, 40.0, 161.0, 5.0, 85.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 145.0, 0.0, 0.0, 34.0, 28.0, 0.0, 24.0, 125.0, 0.0, 48.0, 37.0, 0.0, 0.0, 0.0, 0.0, 36.0, 3.0, 9.0, 14.0, 9.0, 0.0, 28.0, 2.0, 8.0, 160.0, 0.0, 0.0, 11.0, 0.0, 0.0, 70.0, 0.0, 21.0, 20.0, 18.0, 0.0, 7.0, 143.0, 179.0, 0.0, 44.0, 16.0, 0.0, 32.0, 0.0, 34.0, 18.0, 0.0, 0.0, 10.0, 0.0, 0.0, 188.0, 36.0, 0.0, 56.0, 47.0, 5.0, 20.0, 124.0, 2.0, 0.0, 0.0, 38.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1463087724689593, "mean_inference_ms": 3.524793840719931, "mean_action_processing_ms": 0.5177626362953837, "mean_env_wait_ms": 0.4094310572136773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046045780181884766, "StateBufferConnector_ms": 0.0036600828170776367, "ViewRequirementAgentConnector_ms": 0.21679198741912842}, "num_episodes": 18, "episode_return_max": 69.0, "episode_return_min": -514.0, "episode_return_mean": -52.61, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.27855424402946, "num_env_steps_trained_throughput_per_sec": 283.27855424402946, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 2128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2128000, "timers": {"training_iteration_time_ms": 18763.663, "restore_workers_time_ms": 4.01, "training_step_time_ms": 18758.255, "sample_time_ms": 3885.481, "learn_time_ms": 14847.77, "learn_throughput": 269.401, "synch_weights_time_ms": 19.434}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000}, "done": false, "training_iteration": 133, "trial_id": "e1352_00002", "date": "2024-08-13_19-50-42", "timestamp": 1723593042, "time_this_iter_s": 14.199321031570435, "time_total_s": 2928.3273680210114, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e4a790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2928.3273680210114, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 84.64500000000001, "ram_util_percent": 83.715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6307047159820007, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 2.300574298636623, "policy_loss": -0.002256537572278705, "vf_loss": 2.3024292329631786, "vf_explained_var": 0.0025167935739749325, "kl": 0.00891443526231568, "entropy": 0.6967955635022864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 252315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4573584294587216, "cur_kl_coeff": 0.002672692202031612, "cur_lr": 0.00010000000000000003, "total_loss": 3.256584652075692, "policy_loss": -0.004288431376874171, "vf_loss": 3.2608195127633515, "vf_explained_var": 1.1053318699831685e-05, "kl": 0.020043286212080857, "entropy": 1.1349505012628263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 252315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000}, "env_runners": {"episode_reward_max": 69.0, "episode_reward_min": -537.0, "episode_reward_mean": -63.47, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -374.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 48.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -59.245, "predator_policy": 27.51}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.0, 2.0, 0.0, -195.0, -20.0, 2.0, -305.0, 0.0, -4.0, -43.0, -38.0, 6.0, 10.0, -18.0, 3.0, -9.0, 8.0, -38.0, -119.0, -8.0, -8.0, -6.0, 7.0, -28.0, 1.0, -127.0, 9.0, 0.0, -120.0, -110.0, 0.0, -338.0, -24.0, -5.0, 10.0, -19.0, -385.0, 69.0, -254.0, -11.0, -390.0, -36.0, 15.0, 48.0, -23.0, -351.0, 4.0, 0.0, -21.0, -125.0, -18.0, 0.0, 0.0, -38.0, -6.0, 8.0, -20.0, -311.0, 0.0, -11.0, -65.0, -12.0, -7.0, 34.0, -172.0, -29.0, -15.0, -32.0, -40.0, 42.0, 24.0, -514.0, 61.0, -14.0, 12.0, -197.0, 10.0, -23.0, 0.0, -16.0, -38.0, -66.0, 0.0, -21.0, -17.0, -8.0, 7.0, -61.0, -537.0, 16.0, 0.0, 20.0, -475.0, 10.0, -7.0, -33.0, -292.0, -529.0, 43.0, -11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-39.0, -28.0, 0.0, 2.0, 0.0, 0.0, -8.0, -374.0, 0.0, -40.0, 0.0, 2.0, -250.0, -254.0, 0.0, 0.0, -65.0, 24.0, -66.0, -31.0, -58.0, -28.0, 0.0, 6.0, 0.0, 10.0, -10.0, -31.0, 10.0, -14.0, -18.0, 0.0, -49.0, 6.0, 0.0, -76.0, -69.0, -104.0, -13.0, -6.0, 0.0, -26.0, -25.0, 0.0, 4.0, 0.0, -65.0, -23.0, 1.0, 0.0, -184.0, -42.0, 9.0, 0.0, 0.0, -4.0, 29.0, -314.0, -21.0, -224.0, 0.0, 0.0, -268.0, -246.0, 9.0, -90.0, 4.0, -28.0, 14.0, -36.0, -67.0, 0.0, -326.0, -251.0, 13.0, 30.0, -358.0, -94.0, 0.0, -24.0, -309.0, -282.0, -134.0, 8.0, 5.0, -20.0, 48.0, 0.0, -53.0, 0.0, -258.0, -238.0, 4.0, 0.0, -32.0, -30.0, -12.0, -33.0, -250.0, 0.0, 3.0, -106.0, 0.0, 0.0, 0.0, 0.0, -52.0, -25.0, -25.0, -4.0, -1.0, 0.0, -52.0, 2.0, -185.0, -294.0, 0.0, 0.0, -22.0, 0.0, 5.0, -140.0, 5.0, -38.0, -40.0, -5.0, 27.0, 0.0, -138.0, -356.0, 0.0, -73.0, 0.0, -31.0, 0.0, -64.0, -95.0, 3.0, 0.0, 42.0, 0.0, 14.0, -368.0, -334.0, 8.0, 17.0, -117.0, 0.0, 27.0, -40.0, -91.0, -232.0, 0.0, 10.0, -76.0, 15.0, 0.0, 0.0, -48.0, 0.0, 0.0, -76.0, -33.0, -95.0, 0.0, 0.0, -55.0, -12.0, -44.0, 2.0, -21.0, 0.0, -22.0, 0.0, -119.0, -8.0, -358.0, -358.0, 0.0, 16.0, 0.0, 0.0, 42.0, -89.0, -314.0, -367.0, 0.0, -2.0, -10.0, -75.0, -4.0, -66.0, -228.0, -184.0, -370.0, -346.0, 41.0, -22.0, 6.0, -44.0], "policy_predator_policy_reward": [21.0, 31.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 20.0, 0.0, 0.0, 0.0, 17.0, 182.0, 0.0, 0.0, 0.0, 37.0, 31.0, 23.0, 29.0, 19.0, 0.0, 0.0, 0.0, 0.0, 23.0, 0.0, 0.0, 7.0, 9.0, 0.0, 22.0, 29.0, 0.0, 38.0, 2.0, 52.0, 0.0, 11.0, 18.0, 0.0, 0.0, 19.0, 2.0, 1.0, 34.0, 26.0, 0.0, 0.0, 19.0, 80.0, 0.0, 0.0, 4.0, 0.0, 13.0, 152.0, 23.0, 112.0, 0.0, 0.0, 176.0, 0.0, 32.0, 25.0, 19.0, 0.0, 32.0, 0.0, 23.0, 25.0, 177.0, 15.0, 15.0, 11.0, 0.0, 198.0, 13.0, 0.0, 40.0, 161.0, 5.0, 85.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 145.0, 0.0, 0.0, 34.0, 28.0, 0.0, 24.0, 125.0, 0.0, 48.0, 37.0, 0.0, 0.0, 0.0, 0.0, 36.0, 3.0, 9.0, 14.0, 9.0, 0.0, 28.0, 2.0, 8.0, 160.0, 0.0, 0.0, 11.0, 0.0, 0.0, 70.0, 0.0, 21.0, 20.0, 18.0, 0.0, 7.0, 143.0, 179.0, 0.0, 44.0, 16.0, 0.0, 32.0, 0.0, 34.0, 18.0, 0.0, 0.0, 10.0, 0.0, 0.0, 188.0, 36.0, 0.0, 56.0, 47.0, 5.0, 20.0, 124.0, 2.0, 0.0, 0.0, 38.0, 0.0, 0.0, 0.0, 8.0, 24.0, 0.0, 38.0, 0.0, 62.0, 0.0, 0.0, 10.0, 36.0, 0.0, 25.0, 0.0, 13.0, 24.0, 5.0, 53.0, 13.0, 179.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 38.0, 22.0, 184.0, 12.0, 0.0, 38.0, 40.0, 19.0, 18.0, 0.0, 120.0, 0.0, 187.0, 22.0, 2.0, 0.0, 27.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1468462224122498, "mean_inference_ms": 3.526042873391577, "mean_action_processing_ms": 0.5172729884788895, "mean_env_wait_ms": 0.40958869072198584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056073665618896484, "StateBufferConnector_ms": 0.0038285255432128906, "ViewRequirementAgentConnector_ms": 0.1860945224761963}, "num_episodes": 22, "episode_return_max": 69.0, "episode_return_min": -537.0, "episode_return_mean": -63.47, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.62303966326175, "num_env_steps_trained_throughput_per_sec": 308.62303966326175, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 2144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2144000, "timers": {"training_iteration_time_ms": 16747.825, "restore_workers_time_ms": 0.079, "training_step_time_ms": 16747.636, "sample_time_ms": 3324.157, "learn_time_ms": 13399.575, "learn_throughput": 298.517, "synch_weights_time_ms": 20.086}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000}, "done": false, "training_iteration": 134, "trial_id": "e1352_00002", "date": "2024-08-13_19-50-55", "timestamp": 1723593055, "time_this_iter_s": 13.034717082977295, "time_total_s": 2941.3620851039886, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16813a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2941.3620851039886, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 75.89999999999999, "ram_util_percent": 83.82222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.932974751948049, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 2.008369943010744, "policy_loss": -0.0012747850296181188, "vf_loss": 2.0092691456199323, "vf_explained_var": 0.0011445065970143314, "kl": 0.008336822537323584, "entropy": 0.68748634479664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 254205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3177079556716813, "cur_kl_coeff": 0.004009038303047419, "cur_lr": 0.00010000000000000003, "total_loss": 2.905843026108212, "policy_loss": -0.004681524099836313, "vf_loss": 2.910446811290014, "vf_explained_var": -0.0041335128917895925, "kl": 0.019390603943409385, "entropy": 1.096450586356814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 254205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": 69.0, "episode_reward_min": -537.0, "episode_reward_mean": -73.16, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 48.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -66.28, "predator_policy": 29.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-119.0, -8.0, -8.0, -6.0, 7.0, -28.0, 1.0, -127.0, 9.0, 0.0, -120.0, -110.0, 0.0, -338.0, -24.0, -5.0, 10.0, -19.0, -385.0, 69.0, -254.0, -11.0, -390.0, -36.0, 15.0, 48.0, -23.0, -351.0, 4.0, 0.0, -21.0, -125.0, -18.0, 0.0, 0.0, -38.0, -6.0, 8.0, -20.0, -311.0, 0.0, -11.0, -65.0, -12.0, -7.0, 34.0, -172.0, -29.0, -15.0, -32.0, -40.0, 42.0, 24.0, -514.0, 61.0, -14.0, 12.0, -197.0, 10.0, -23.0, 0.0, -16.0, -38.0, -66.0, 0.0, -21.0, -17.0, -8.0, 7.0, -61.0, -537.0, 16.0, 0.0, 20.0, -475.0, 10.0, -7.0, -33.0, -292.0, -529.0, 43.0, -11.0, -53.0, -74.0, -12.0, 33.0, -62.0, -30.0, -350.0, 3.0, -1.0, 14.0, -41.0, -364.0, -31.0, -173.0, -497.0, 30.0, -11.0, -4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-69.0, -104.0, -13.0, -6.0, 0.0, -26.0, -25.0, 0.0, 4.0, 0.0, -65.0, -23.0, 1.0, 0.0, -184.0, -42.0, 9.0, 0.0, 0.0, -4.0, 29.0, -314.0, -21.0, -224.0, 0.0, 0.0, -268.0, -246.0, 9.0, -90.0, 4.0, -28.0, 14.0, -36.0, -67.0, 0.0, -326.0, -251.0, 13.0, 30.0, -358.0, -94.0, 0.0, -24.0, -309.0, -282.0, -134.0, 8.0, 5.0, -20.0, 48.0, 0.0, -53.0, 0.0, -258.0, -238.0, 4.0, 0.0, -32.0, -30.0, -12.0, -33.0, -250.0, 0.0, 3.0, -106.0, 0.0, 0.0, 0.0, 0.0, -52.0, -25.0, -25.0, -4.0, -1.0, 0.0, -52.0, 2.0, -185.0, -294.0, 0.0, 0.0, -22.0, 0.0, 5.0, -140.0, 5.0, -38.0, -40.0, -5.0, 27.0, 0.0, -138.0, -356.0, 0.0, -73.0, 0.0, -31.0, 0.0, -64.0, -95.0, 3.0, 0.0, 42.0, 0.0, 14.0, -368.0, -334.0, 8.0, 17.0, -117.0, 0.0, 27.0, -40.0, -91.0, -232.0, 0.0, 10.0, -76.0, 15.0, 0.0, 0.0, -48.0, 0.0, 0.0, -76.0, -33.0, -95.0, 0.0, 0.0, -55.0, -12.0, -44.0, 2.0, -21.0, 0.0, -22.0, 0.0, -119.0, -8.0, -358.0, -358.0, 0.0, 16.0, 0.0, 0.0, 42.0, -89.0, -314.0, -367.0, 0.0, -2.0, -10.0, -75.0, -4.0, -66.0, -228.0, -184.0, -370.0, -346.0, 41.0, -22.0, 6.0, -44.0, -47.0, -31.0, -63.0, -98.0, 0.0, -62.0, 20.0, 11.0, -74.0, -74.0, -91.0, -35.0, -288.0, -223.0, -72.0, 21.0, -2.0, 0.0, 0.0, 12.0, -26.0, -65.0, -285.0, -227.0, -87.0, 0.0, -134.0, -167.0, -297.0, -400.0, 0.0, 28.0, -2.0, -20.0, 0.0, -8.0], "policy_predator_policy_reward": [2.0, 52.0, 0.0, 11.0, 18.0, 0.0, 0.0, 19.0, 2.0, 1.0, 34.0, 26.0, 0.0, 0.0, 19.0, 80.0, 0.0, 0.0, 4.0, 0.0, 13.0, 152.0, 23.0, 112.0, 0.0, 0.0, 176.0, 0.0, 32.0, 25.0, 19.0, 0.0, 32.0, 0.0, 23.0, 25.0, 177.0, 15.0, 15.0, 11.0, 0.0, 198.0, 13.0, 0.0, 40.0, 161.0, 5.0, 85.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 145.0, 0.0, 0.0, 34.0, 28.0, 0.0, 24.0, 125.0, 0.0, 48.0, 37.0, 0.0, 0.0, 0.0, 0.0, 36.0, 3.0, 9.0, 14.0, 9.0, 0.0, 28.0, 2.0, 8.0, 160.0, 0.0, 0.0, 11.0, 0.0, 0.0, 70.0, 0.0, 21.0, 20.0, 18.0, 0.0, 7.0, 143.0, 179.0, 0.0, 44.0, 16.0, 0.0, 32.0, 0.0, 34.0, 18.0, 0.0, 0.0, 10.0, 0.0, 0.0, 188.0, 36.0, 0.0, 56.0, 47.0, 5.0, 20.0, 124.0, 2.0, 0.0, 0.0, 38.0, 0.0, 0.0, 0.0, 8.0, 24.0, 0.0, 38.0, 0.0, 62.0, 0.0, 0.0, 10.0, 36.0, 0.0, 25.0, 0.0, 13.0, 24.0, 5.0, 53.0, 13.0, 179.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 38.0, 22.0, 184.0, 12.0, 0.0, 38.0, 40.0, 19.0, 18.0, 0.0, 120.0, 0.0, 187.0, 22.0, 2.0, 0.0, 27.0, 25.0, 0.0, 70.0, 17.0, 31.0, 19.0, 1.0, 1.0, 49.0, 37.0, 62.0, 34.0, 144.0, 17.0, 28.0, 26.0, 0.0, 1.0, 0.0, 2.0, 1.0, 49.0, 148.0, 0.0, 36.0, 20.0, 113.0, 15.0, 0.0, 200.0, 1.0, 1.0, 11.0, 0.0, 0.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1482154727544298, "mean_inference_ms": 3.529133256182533, "mean_action_processing_ms": 0.5171413628679435, "mean_env_wait_ms": 0.4100457416570553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007316112518310547, "StateBufferConnector_ms": 0.004046201705932617, "ViewRequirementAgentConnector_ms": 0.28572988510131836}, "num_episodes": 18, "episode_return_max": 69.0, "episode_return_min": -537.0, "episode_return_mean": -73.16, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.0116767744623, "num_env_steps_trained_throughput_per_sec": 266.0116767744623, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 15814.161, "restore_workers_time_ms": 0.076, "training_step_time_ms": 15813.976, "sample_time_ms": 3284.729, "learn_time_ms": 12507.893, "learn_throughput": 319.798, "synch_weights_time_ms": 17.479}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 135, "trial_id": "e1352_00002", "date": "2024-08-13_19-51-10", "timestamp": 1723593070, "time_this_iter_s": 15.082085132598877, "time_total_s": 2956.4441702365875, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e42af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2956.4441702365875, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 78.04545454545455, "ram_util_percent": 83.78636363636365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.844758141080223, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 2.5126576721352873, "policy_loss": -0.0005542563037976386, "vf_loss": 2.5128910355467013, "vf_explained_var": 0.0029447237650553387, "kl": 0.007122910397644031, "entropy": 0.634991281436234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 256095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2091293861784003, "cur_kl_coeff": 0.004009038303047419, "cur_lr": 0.00010000000000000003, "total_loss": 3.1645497525179827, "policy_loss": -0.0034826221075106075, "vf_loss": 3.167982457428382, "vf_explained_var": 0.00011218351031106616, "kl": 0.012452940135648943, "entropy": 1.0850406013468585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 256095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000}, "env_runners": {"episode_reward_max": 69.0, "episode_reward_min": -537.0, "episode_reward_mean": -79.21, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 48.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -70.685, "predator_policy": 31.08}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-385.0, 69.0, -254.0, -11.0, -390.0, -36.0, 15.0, 48.0, -23.0, -351.0, 4.0, 0.0, -21.0, -125.0, -18.0, 0.0, 0.0, -38.0, -6.0, 8.0, -20.0, -311.0, 0.0, -11.0, -65.0, -12.0, -7.0, 34.0, -172.0, -29.0, -15.0, -32.0, -40.0, 42.0, 24.0, -514.0, 61.0, -14.0, 12.0, -197.0, 10.0, -23.0, 0.0, -16.0, -38.0, -66.0, 0.0, -21.0, -17.0, -8.0, 7.0, -61.0, -537.0, 16.0, 0.0, 20.0, -475.0, 10.0, -7.0, -33.0, -292.0, -529.0, 43.0, -11.0, -53.0, -74.0, -12.0, 33.0, -62.0, -30.0, -350.0, 3.0, -1.0, 14.0, -41.0, -364.0, -31.0, -173.0, -497.0, 30.0, -11.0, -4.0, 2.0, -435.0, -5.0, -285.0, 29.0, -408.0, 0.0, 3.0, 29.0, -233.0, 0.0, -22.0, 3.0, -147.0, -77.0, 7.0, 50.0, -1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-326.0, -251.0, 13.0, 30.0, -358.0, -94.0, 0.0, -24.0, -309.0, -282.0, -134.0, 8.0, 5.0, -20.0, 48.0, 0.0, -53.0, 0.0, -258.0, -238.0, 4.0, 0.0, -32.0, -30.0, -12.0, -33.0, -250.0, 0.0, 3.0, -106.0, 0.0, 0.0, 0.0, 0.0, -52.0, -25.0, -25.0, -4.0, -1.0, 0.0, -52.0, 2.0, -185.0, -294.0, 0.0, 0.0, -22.0, 0.0, 5.0, -140.0, 5.0, -38.0, -40.0, -5.0, 27.0, 0.0, -138.0, -356.0, 0.0, -73.0, 0.0, -31.0, 0.0, -64.0, -95.0, 3.0, 0.0, 42.0, 0.0, 14.0, -368.0, -334.0, 8.0, 17.0, -117.0, 0.0, 27.0, -40.0, -91.0, -232.0, 0.0, 10.0, -76.0, 15.0, 0.0, 0.0, -48.0, 0.0, 0.0, -76.0, -33.0, -95.0, 0.0, 0.0, -55.0, -12.0, -44.0, 2.0, -21.0, 0.0, -22.0, 0.0, -119.0, -8.0, -358.0, -358.0, 0.0, 16.0, 0.0, 0.0, 42.0, -89.0, -314.0, -367.0, 0.0, -2.0, -10.0, -75.0, -4.0, -66.0, -228.0, -184.0, -370.0, -346.0, 41.0, -22.0, 6.0, -44.0, -47.0, -31.0, -63.0, -98.0, 0.0, -62.0, 20.0, 11.0, -74.0, -74.0, -91.0, -35.0, -288.0, -223.0, -72.0, 21.0, -2.0, 0.0, 0.0, 12.0, -26.0, -65.0, -285.0, -227.0, -87.0, 0.0, -134.0, -167.0, -297.0, -400.0, 0.0, 28.0, -2.0, -20.0, 0.0, -8.0, 0.0, 2.0, -345.0, -264.0, -56.0, 15.0, -309.0, -292.0, -6.0, 32.0, -260.0, -329.0, 0.0, 0.0, 0.0, 3.0, 0.0, 29.0, -171.0, -204.0, 0.0, 0.0, -44.0, 0.0, -27.0, 8.0, -324.0, 0.0, -180.0, 4.0, 10.0, -6.0, 22.0, 28.0, 0.0, -2.0], "policy_predator_policy_reward": [177.0, 15.0, 15.0, 11.0, 0.0, 198.0, 13.0, 0.0, 40.0, 161.0, 5.0, 85.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 145.0, 0.0, 0.0, 34.0, 28.0, 0.0, 24.0, 125.0, 0.0, 48.0, 37.0, 0.0, 0.0, 0.0, 0.0, 36.0, 3.0, 9.0, 14.0, 9.0, 0.0, 28.0, 2.0, 8.0, 160.0, 0.0, 0.0, 11.0, 0.0, 0.0, 70.0, 0.0, 21.0, 20.0, 18.0, 0.0, 7.0, 143.0, 179.0, 0.0, 44.0, 16.0, 0.0, 32.0, 0.0, 34.0, 18.0, 0.0, 0.0, 10.0, 0.0, 0.0, 188.0, 36.0, 0.0, 56.0, 47.0, 5.0, 20.0, 124.0, 2.0, 0.0, 0.0, 38.0, 0.0, 0.0, 0.0, 8.0, 24.0, 0.0, 38.0, 0.0, 62.0, 0.0, 0.0, 10.0, 36.0, 0.0, 25.0, 0.0, 13.0, 24.0, 5.0, 53.0, 13.0, 179.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 38.0, 22.0, 184.0, 12.0, 0.0, 38.0, 40.0, 19.0, 18.0, 0.0, 120.0, 0.0, 187.0, 22.0, 2.0, 0.0, 27.0, 25.0, 0.0, 70.0, 17.0, 31.0, 19.0, 1.0, 1.0, 49.0, 37.0, 62.0, 34.0, 144.0, 17.0, 28.0, 26.0, 0.0, 1.0, 0.0, 2.0, 1.0, 49.0, 148.0, 0.0, 36.0, 20.0, 113.0, 15.0, 0.0, 200.0, 1.0, 1.0, 11.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 174.0, 8.0, 28.0, 160.0, 156.0, 3.0, 0.0, 169.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 142.0, 0.0, 0.0, 0.0, 22.0, 0.0, 0.0, 22.0, 46.0, 131.0, 21.0, 78.0, 3.0, 0.0, 0.0, 0.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1503676054495853, "mean_inference_ms": 3.533944928750153, "mean_action_processing_ms": 0.5172862550296913, "mean_env_wait_ms": 0.41072073019992744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007761836051940918, "StateBufferConnector_ms": 0.004079461097717285, "ViewRequirementAgentConnector_ms": 0.2934650182723999}, "num_episodes": 18, "episode_return_max": 69.0, "episode_return_min": -537.0, "episode_return_mean": -79.21, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 255.6046739235094, "num_env_steps_trained_throughput_per_sec": 255.6046739235094, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 2176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2176000, "timers": {"training_iteration_time_ms": 15145.312, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15145.252, "sample_time_ms": 3028.766, "learn_time_ms": 12095.245, "learn_throughput": 330.708, "synch_weights_time_ms": 17.283}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000}, "done": false, "training_iteration": 136, "trial_id": "e1352_00002", "date": "2024-08-13_19-51-26", "timestamp": 1723593086, "time_this_iter_s": 15.71146011352539, "time_total_s": 2972.155630350113, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e5af70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2972.155630350113, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 81.58636363636363, "ram_util_percent": 83.56363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0223959621850143, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 0.00010000000000000003, "total_loss": 2.9822071310073612, "policy_loss": -0.00473233281755475, "vf_loss": 2.9856931827055715, "vf_explained_var": 0.0064846162127439304, "kl": 0.027664052996797615, "entropy": 0.7144497748720583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 257985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6029747068724305, "cur_kl_coeff": 0.004009038303047419, "cur_lr": 0.00010000000000000003, "total_loss": 4.397040921291977, "policy_loss": -0.002665407691155831, "vf_loss": 4.399635733246172, "vf_explained_var": 0.0008110994699770811, "kl": 0.017607795669915202, "entropy": 1.0452584407316945, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 257985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 2192000}, "env_runners": {"episode_reward_max": 61.0, "episode_reward_min": -537.0, "episode_reward_mean": -78.62, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 42.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -70.045, "predator_policy": 30.735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.0, -65.0, -12.0, -7.0, 34.0, -172.0, -29.0, -15.0, -32.0, -40.0, 42.0, 24.0, -514.0, 61.0, -14.0, 12.0, -197.0, 10.0, -23.0, 0.0, -16.0, -38.0, -66.0, 0.0, -21.0, -17.0, -8.0, 7.0, -61.0, -537.0, 16.0, 0.0, 20.0, -475.0, 10.0, -7.0, -33.0, -292.0, -529.0, 43.0, -11.0, -53.0, -74.0, -12.0, 33.0, -62.0, -30.0, -350.0, 3.0, -1.0, 14.0, -41.0, -364.0, -31.0, -173.0, -497.0, 30.0, -11.0, -4.0, 2.0, -435.0, -5.0, -285.0, 29.0, -408.0, 0.0, 3.0, 29.0, -233.0, 0.0, -22.0, 3.0, -147.0, -77.0, 7.0, 50.0, -1.0, -63.0, -15.0, 28.0, -381.0, -6.0, 37.0, -21.0, -230.0, 16.0, -190.0, -13.0, 21.0, -16.0, -49.0, -23.0, 18.0, 8.0, 0.0, -528.0, -365.0, 34.0, 5.0, -53.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.0, 0.0, 5.0, -140.0, 5.0, -38.0, -40.0, -5.0, 27.0, 0.0, -138.0, -356.0, 0.0, -73.0, 0.0, -31.0, 0.0, -64.0, -95.0, 3.0, 0.0, 42.0, 0.0, 14.0, -368.0, -334.0, 8.0, 17.0, -117.0, 0.0, 27.0, -40.0, -91.0, -232.0, 0.0, 10.0, -76.0, 15.0, 0.0, 0.0, -48.0, 0.0, 0.0, -76.0, -33.0, -95.0, 0.0, 0.0, -55.0, -12.0, -44.0, 2.0, -21.0, 0.0, -22.0, 0.0, -119.0, -8.0, -358.0, -358.0, 0.0, 16.0, 0.0, 0.0, 42.0, -89.0, -314.0, -367.0, 0.0, -2.0, -10.0, -75.0, -4.0, -66.0, -228.0, -184.0, -370.0, -346.0, 41.0, -22.0, 6.0, -44.0, -47.0, -31.0, -63.0, -98.0, 0.0, -62.0, 20.0, 11.0, -74.0, -74.0, -91.0, -35.0, -288.0, -223.0, -72.0, 21.0, -2.0, 0.0, 0.0, 12.0, -26.0, -65.0, -285.0, -227.0, -87.0, 0.0, -134.0, -167.0, -297.0, -400.0, 0.0, 28.0, -2.0, -20.0, 0.0, -8.0, 0.0, 2.0, -345.0, -264.0, -56.0, 15.0, -309.0, -292.0, -6.0, 32.0, -260.0, -329.0, 0.0, 0.0, 0.0, 3.0, 0.0, 29.0, -171.0, -204.0, 0.0, 0.0, -44.0, 0.0, -27.0, 8.0, -324.0, 0.0, -180.0, 4.0, 10.0, -6.0, 22.0, 28.0, 0.0, -2.0, -97.0, -40.0, 9.0, -57.0, 18.0, -16.0, -270.0, -304.0, -12.0, 0.0, 31.0, 0.0, -43.0, -7.0, -110.0, -240.0, 0.0, 16.0, -278.0, -181.0, 0.0, -34.0, 23.0, -4.0, -73.0, -5.0, -78.0, -24.0, -54.0, -4.0, -18.0, 8.0, -16.0, 2.0, 0.0, 0.0, -352.0, -352.0, -366.0, -187.0, -37.0, 30.0, 5.0, 0.0, -59.0, -31.0], "policy_predator_policy_reward": [11.0, 0.0, 0.0, 70.0, 0.0, 21.0, 20.0, 18.0, 0.0, 7.0, 143.0, 179.0, 0.0, 44.0, 16.0, 0.0, 32.0, 0.0, 34.0, 18.0, 0.0, 0.0, 10.0, 0.0, 0.0, 188.0, 36.0, 0.0, 56.0, 47.0, 5.0, 20.0, 124.0, 2.0, 0.0, 0.0, 38.0, 0.0, 0.0, 0.0, 8.0, 24.0, 0.0, 38.0, 0.0, 62.0, 0.0, 0.0, 10.0, 36.0, 0.0, 25.0, 0.0, 13.0, 24.0, 5.0, 53.0, 13.0, 179.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 38.0, 22.0, 184.0, 12.0, 0.0, 38.0, 40.0, 19.0, 18.0, 0.0, 120.0, 0.0, 187.0, 22.0, 2.0, 0.0, 27.0, 25.0, 0.0, 70.0, 17.0, 31.0, 19.0, 1.0, 1.0, 49.0, 37.0, 62.0, 34.0, 144.0, 17.0, 28.0, 26.0, 0.0, 1.0, 0.0, 2.0, 1.0, 49.0, 148.0, 0.0, 36.0, 20.0, 113.0, 15.0, 0.0, 200.0, 1.0, 1.0, 11.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 174.0, 8.0, 28.0, 160.0, 156.0, 3.0, 0.0, 169.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 142.0, 0.0, 0.0, 0.0, 22.0, 0.0, 0.0, 22.0, 46.0, 131.0, 21.0, 78.0, 3.0, 0.0, 0.0, 0.0, 1.0, 0.0, 33.0, 41.0, 33.0, 0.0, 11.0, 15.0, 24.0, 169.0, 0.0, 6.0, 0.0, 6.0, 4.0, 25.0, 0.0, 120.0, 0.0, 0.0, 139.0, 130.0, 0.0, 21.0, 2.0, 0.0, 26.0, 36.0, 21.0, 32.0, 19.0, 16.0, 28.0, 0.0, 18.0, 4.0, 0.0, 0.0, 176.0, 0.0, 5.0, 183.0, 24.0, 17.0, 0.0, 0.0, 0.0, 37.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1512597580733321, "mean_inference_ms": 3.5355592057477776, "mean_action_processing_ms": 0.5168881102908938, "mean_env_wait_ms": 0.41103141186253767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011363744735717773, "StateBufferConnector_ms": 0.005792140960693359, "ViewRequirementAgentConnector_ms": 0.27513957023620605}, "num_episodes": 23, "episode_return_max": 61.0, "episode_return_min": -537.0, "episode_return_mean": -78.62, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 2192000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.4822493901968, "num_env_steps_trained_throughput_per_sec": 280.4822493901968, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 2192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2192000, "timers": {"training_iteration_time_ms": 14998.457, "restore_workers_time_ms": 0.019, "training_step_time_ms": 14998.397, "sample_time_ms": 2942.08, "learn_time_ms": 12034.933, "learn_throughput": 332.366, "synch_weights_time_ms": 17.76}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 2192000}, "done": false, "training_iteration": 137, "trial_id": "e1352_00002", "date": "2024-08-13_19-51-40", "timestamp": 1723593100, "time_this_iter_s": 14.334728956222534, "time_total_s": 2986.4903593063354, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b8c430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2986.4903593063354, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 81.76999999999998, "ram_util_percent": 83.67}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.015974986166866, "cur_kl_coeff": 0.0675762176513672, "cur_lr": 0.00010000000000000003, "total_loss": 3.2310155608666635, "policy_loss": -0.0007972913545374044, "vf_loss": 3.231434848573473, "vf_explained_var": 0.00464466340327389, "kl": 0.0055937252449367696, "entropy": 0.7452268805138018, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 259875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6065949426362756, "cur_kl_coeff": 0.004009038303047419, "cur_lr": 0.00010000000000000003, "total_loss": 4.347284924794757, "policy_loss": -0.0034976237342648564, "vf_loss": 4.350688072361012, "vf_explained_var": -0.0020456387567772435, "kl": 0.0235628523018919, "entropy": 0.9843139258011309, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 259875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "env_runners": {"episode_reward_max": 63.0, "episode_reward_min": -537.0, "episode_reward_mean": -97.93, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 42.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -84.37, "predator_policy": 35.405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-66.0, 0.0, -21.0, -17.0, -8.0, 7.0, -61.0, -537.0, 16.0, 0.0, 20.0, -475.0, 10.0, -7.0, -33.0, -292.0, -529.0, 43.0, -11.0, -53.0, -74.0, -12.0, 33.0, -62.0, -30.0, -350.0, 3.0, -1.0, 14.0, -41.0, -364.0, -31.0, -173.0, -497.0, 30.0, -11.0, -4.0, 2.0, -435.0, -5.0, -285.0, 29.0, -408.0, 0.0, 3.0, 29.0, -233.0, 0.0, -22.0, 3.0, -147.0, -77.0, 7.0, 50.0, -1.0, -63.0, -15.0, 28.0, -381.0, -6.0, 37.0, -21.0, -230.0, 16.0, -190.0, -13.0, 21.0, -16.0, -49.0, -23.0, 18.0, 8.0, 0.0, -528.0, -365.0, 34.0, 5.0, -53.0, -354.0, -76.0, -5.0, 63.0, -15.0, -437.0, -62.0, 18.0, 44.0, 0.0, -18.0, -257.0, -441.0, -10.0, -51.0, 7.0, -310.0, -22.0, -7.0, -526.0, -23.0, -451.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-33.0, -95.0, 0.0, 0.0, -55.0, -12.0, -44.0, 2.0, -21.0, 0.0, -22.0, 0.0, -119.0, -8.0, -358.0, -358.0, 0.0, 16.0, 0.0, 0.0, 42.0, -89.0, -314.0, -367.0, 0.0, -2.0, -10.0, -75.0, -4.0, -66.0, -228.0, -184.0, -370.0, -346.0, 41.0, -22.0, 6.0, -44.0, -47.0, -31.0, -63.0, -98.0, 0.0, -62.0, 20.0, 11.0, -74.0, -74.0, -91.0, -35.0, -288.0, -223.0, -72.0, 21.0, -2.0, 0.0, 0.0, 12.0, -26.0, -65.0, -285.0, -227.0, -87.0, 0.0, -134.0, -167.0, -297.0, -400.0, 0.0, 28.0, -2.0, -20.0, 0.0, -8.0, 0.0, 2.0, -345.0, -264.0, -56.0, 15.0, -309.0, -292.0, -6.0, 32.0, -260.0, -329.0, 0.0, 0.0, 0.0, 3.0, 0.0, 29.0, -171.0, -204.0, 0.0, 0.0, -44.0, 0.0, -27.0, 8.0, -324.0, 0.0, -180.0, 4.0, 10.0, -6.0, 22.0, 28.0, 0.0, -2.0, -97.0, -40.0, 9.0, -57.0, 18.0, -16.0, -270.0, -304.0, -12.0, 0.0, 31.0, 0.0, -43.0, -7.0, -110.0, -240.0, 0.0, 16.0, -278.0, -181.0, 0.0, -34.0, 23.0, -4.0, -73.0, -5.0, -78.0, -24.0, -54.0, -4.0, -18.0, 8.0, -16.0, 2.0, 0.0, 0.0, -352.0, -352.0, -366.0, -187.0, -37.0, 30.0, 5.0, 0.0, -59.0, -31.0, -232.0, -244.0, -145.0, -28.0, -14.0, 2.0, 20.0, 29.0, -3.0, -32.0, -298.0, -295.0, -40.0, -134.0, 5.0, 12.0, 10.0, -234.0, 0.0, 0.0, -56.0, -51.0, -209.0, -217.0, -265.0, -366.0, -57.0, 0.0, -61.0, -51.0, -6.0, 0.0, -338.0, -310.0, -48.0, 2.0, 0.0, -23.0, -348.0, -357.0, -46.0, 0.0, -254.0, -394.0], "policy_predator_policy_reward": [0.0, 62.0, 0.0, 0.0, 10.0, 36.0, 0.0, 25.0, 0.0, 13.0, 24.0, 5.0, 53.0, 13.0, 179.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 38.0, 22.0, 184.0, 12.0, 0.0, 38.0, 40.0, 19.0, 18.0, 0.0, 120.0, 0.0, 187.0, 22.0, 2.0, 0.0, 27.0, 25.0, 0.0, 70.0, 17.0, 31.0, 19.0, 1.0, 1.0, 49.0, 37.0, 62.0, 34.0, 144.0, 17.0, 28.0, 26.0, 0.0, 1.0, 0.0, 2.0, 1.0, 49.0, 148.0, 0.0, 36.0, 20.0, 113.0, 15.0, 0.0, 200.0, 1.0, 1.0, 11.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 174.0, 8.0, 28.0, 160.0, 156.0, 3.0, 0.0, 169.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 142.0, 0.0, 0.0, 0.0, 22.0, 0.0, 0.0, 22.0, 46.0, 131.0, 21.0, 78.0, 3.0, 0.0, 0.0, 0.0, 1.0, 0.0, 33.0, 41.0, 33.0, 0.0, 11.0, 15.0, 24.0, 169.0, 0.0, 6.0, 0.0, 6.0, 4.0, 25.0, 0.0, 120.0, 0.0, 0.0, 139.0, 130.0, 0.0, 21.0, 2.0, 0.0, 26.0, 36.0, 21.0, 32.0, 19.0, 16.0, 28.0, 0.0, 18.0, 4.0, 0.0, 0.0, 176.0, 0.0, 5.0, 183.0, 24.0, 17.0, 0.0, 0.0, 0.0, 37.0, 121.0, 1.0, 83.0, 14.0, 7.0, 0.0, 1.0, 13.0, 16.0, 4.0, 156.0, 0.0, 66.0, 46.0, 1.0, 0.0, 136.0, 132.0, 0.0, 0.0, 28.0, 61.0, 51.0, 118.0, 7.0, 183.0, 24.0, 23.0, 9.0, 52.0, 0.0, 13.0, 169.0, 169.0, 0.0, 24.0, 0.0, 16.0, 0.0, 179.0, 23.0, 0.0, 0.0, 197.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1529403825423659, "mean_inference_ms": 3.537497742999136, "mean_action_processing_ms": 0.5167315617717939, "mean_env_wait_ms": 0.4112840068507161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015497684478759766, "StateBufferConnector_ms": 0.009822964668273926, "ViewRequirementAgentConnector_ms": 0.28925955295562744}, "num_episodes": 22, "episode_return_max": 63.0, "episode_return_min": -537.0, "episode_return_mean": -97.93, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.20576654079224, "num_env_steps_trained_throughput_per_sec": 278.20576654079224, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 2208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2208000, "timers": {"training_iteration_time_ms": 14745.324, "restore_workers_time_ms": 0.019, "training_step_time_ms": 14745.264, "sample_time_ms": 2865.551, "learn_time_ms": 11858.402, "learn_throughput": 337.314, "synch_weights_time_ms": 17.681}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "done": false, "training_iteration": 138, "trial_id": "e1352_00002", "date": "2024-08-13_19-51-55", "timestamp": 1723593115, "time_this_iter_s": 14.45412302017212, "time_total_s": 3000.9444823265076, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1681160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3000.9444823265076, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 82.36666666666667, "ram_util_percent": 83.62380952380951}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9776806296179534, "cur_kl_coeff": 0.0675762176513672, "cur_lr": 0.00010000000000000003, "total_loss": 2.532679853679011, "policy_loss": -0.0011345237148580728, "vf_loss": 2.5333366182746078, "vf_explained_var": 0.0029864937855453087, "kl": 0.007069919829681618, "entropy": 0.8760636679394536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 261765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3280547767089157, "cur_kl_coeff": 0.006013557454571128, "cur_lr": 0.00010000000000000003, "total_loss": 3.800518168343438, "policy_loss": -0.0012792994149975361, "vf_loss": 3.801764830331954, "vf_explained_var": 8.678962944676637e-05, "kl": 0.005427133434800033, "entropy": 0.9576869736272822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 261765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 2224000}, "env_runners": {"episode_reward_max": 63.0, "episode_reward_min": -528.0, "episode_reward_mean": -100.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 46.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -85.69, "predator_policy": 35.655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.0, -53.0, -74.0, -12.0, 33.0, -62.0, -30.0, -350.0, 3.0, -1.0, 14.0, -41.0, -364.0, -31.0, -173.0, -497.0, 30.0, -11.0, -4.0, 2.0, -435.0, -5.0, -285.0, 29.0, -408.0, 0.0, 3.0, 29.0, -233.0, 0.0, -22.0, 3.0, -147.0, -77.0, 7.0, 50.0, -1.0, -63.0, -15.0, 28.0, -381.0, -6.0, 37.0, -21.0, -230.0, 16.0, -190.0, -13.0, 21.0, -16.0, -49.0, -23.0, 18.0, 8.0, 0.0, -528.0, -365.0, 34.0, 5.0, -53.0, -354.0, -76.0, -5.0, 63.0, -15.0, -437.0, -62.0, 18.0, 44.0, 0.0, -18.0, -257.0, -441.0, -10.0, -51.0, 7.0, -310.0, -22.0, -7.0, -526.0, -23.0, -451.0, -55.0, -483.0, -435.0, -336.0, 28.0, 35.0, -2.0, -491.0, -8.0, 9.0, -20.0, -3.0, 28.0, -4.0, -447.0, 19.0, 0.0, 1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6.0, -44.0, -47.0, -31.0, -63.0, -98.0, 0.0, -62.0, 20.0, 11.0, -74.0, -74.0, -91.0, -35.0, -288.0, -223.0, -72.0, 21.0, -2.0, 0.0, 0.0, 12.0, -26.0, -65.0, -285.0, -227.0, -87.0, 0.0, -134.0, -167.0, -297.0, -400.0, 0.0, 28.0, -2.0, -20.0, 0.0, -8.0, 0.0, 2.0, -345.0, -264.0, -56.0, 15.0, -309.0, -292.0, -6.0, 32.0, -260.0, -329.0, 0.0, 0.0, 0.0, 3.0, 0.0, 29.0, -171.0, -204.0, 0.0, 0.0, -44.0, 0.0, -27.0, 8.0, -324.0, 0.0, -180.0, 4.0, 10.0, -6.0, 22.0, 28.0, 0.0, -2.0, -97.0, -40.0, 9.0, -57.0, 18.0, -16.0, -270.0, -304.0, -12.0, 0.0, 31.0, 0.0, -43.0, -7.0, -110.0, -240.0, 0.0, 16.0, -278.0, -181.0, 0.0, -34.0, 23.0, -4.0, -73.0, -5.0, -78.0, -24.0, -54.0, -4.0, -18.0, 8.0, -16.0, 2.0, 0.0, 0.0, -352.0, -352.0, -366.0, -187.0, -37.0, 30.0, 5.0, 0.0, -59.0, -31.0, -232.0, -244.0, -145.0, -28.0, -14.0, 2.0, 20.0, 29.0, -3.0, -32.0, -298.0, -295.0, -40.0, -134.0, 5.0, 12.0, 10.0, -234.0, 0.0, 0.0, -56.0, -51.0, -209.0, -217.0, -265.0, -366.0, -57.0, 0.0, -61.0, -51.0, -6.0, 0.0, -338.0, -310.0, -48.0, 2.0, 0.0, -23.0, -348.0, -357.0, -46.0, 0.0, -254.0, -394.0, -74.0, -36.0, -310.0, -346.0, -273.0, -352.0, -309.0, -210.0, 0.0, 28.0, 34.0, -16.0, -14.0, -15.0, -400.0, -291.0, -68.0, 15.0, -2.0, -17.0, 0.0, -40.0, -6.0, 0.0, 46.0, -46.0, -28.0, 0.0, -301.0, -306.0, 15.0, -10.0, 0.0, 0.0, -28.0, -5.0], "policy_predator_policy_reward": [0.0, 27.0, 25.0, 0.0, 70.0, 17.0, 31.0, 19.0, 1.0, 1.0, 49.0, 37.0, 62.0, 34.0, 144.0, 17.0, 28.0, 26.0, 0.0, 1.0, 0.0, 2.0, 1.0, 49.0, 148.0, 0.0, 36.0, 20.0, 113.0, 15.0, 0.0, 200.0, 1.0, 1.0, 11.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 174.0, 8.0, 28.0, 160.0, 156.0, 3.0, 0.0, 169.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 142.0, 0.0, 0.0, 0.0, 22.0, 0.0, 0.0, 22.0, 46.0, 131.0, 21.0, 78.0, 3.0, 0.0, 0.0, 0.0, 1.0, 0.0, 33.0, 41.0, 33.0, 0.0, 11.0, 15.0, 24.0, 169.0, 0.0, 6.0, 0.0, 6.0, 4.0, 25.0, 0.0, 120.0, 0.0, 0.0, 139.0, 130.0, 0.0, 21.0, 2.0, 0.0, 26.0, 36.0, 21.0, 32.0, 19.0, 16.0, 28.0, 0.0, 18.0, 4.0, 0.0, 0.0, 176.0, 0.0, 5.0, 183.0, 24.0, 17.0, 0.0, 0.0, 0.0, 37.0, 121.0, 1.0, 83.0, 14.0, 7.0, 0.0, 1.0, 13.0, 16.0, 4.0, 156.0, 0.0, 66.0, 46.0, 1.0, 0.0, 136.0, 132.0, 0.0, 0.0, 28.0, 61.0, 51.0, 118.0, 7.0, 183.0, 24.0, 23.0, 9.0, 52.0, 0.0, 13.0, 169.0, 169.0, 0.0, 24.0, 0.0, 16.0, 0.0, 179.0, 23.0, 0.0, 0.0, 197.0, 15.0, 40.0, 0.0, 173.0, 176.0, 14.0, 150.0, 33.0, 0.0, 0.0, 13.0, 4.0, 3.0, 24.0, 200.0, 0.0, 33.0, 12.0, 17.0, 11.0, 0.0, 20.0, 3.0, 0.0, 28.0, 0.0, 11.0, 13.0, 160.0, 0.0, 5.0, 9.0, 0.0, 0.0, 19.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1543702751132918, "mean_inference_ms": 3.541794263397943, "mean_action_processing_ms": 0.5169206173013484, "mean_env_wait_ms": 0.4119747441315639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014487862586975098, "StateBufferConnector_ms": 0.009581565856933594, "ViewRequirementAgentConnector_ms": 0.2921401262283325}, "num_episodes": 18, "episode_return_max": 63.0, "episode_return_min": -528.0, "episode_return_mean": -100.07, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 2224000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.89677360709356, "num_env_steps_trained_throughput_per_sec": 273.89677360709356, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 2224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2224000, "timers": {"training_iteration_time_ms": 14703.681, "restore_workers_time_ms": 0.019, "training_step_time_ms": 14703.621, "sample_time_ms": 2829.038, "learn_time_ms": 11853.158, "learn_throughput": 337.463, "synch_weights_time_ms": 17.845}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 2224000}, "done": false, "training_iteration": 139, "trial_id": "e1352_00002", "date": "2024-08-13_19-52-10", "timestamp": 1723593130, "time_this_iter_s": 14.65102481842041, "time_total_s": 3015.595507144928, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16811f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3015.595507144928, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 79.21904761904761, "ram_util_percent": 83.77142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4713430171132718, "cur_kl_coeff": 0.0675762176513672, "cur_lr": 0.00010000000000000003, "total_loss": 1.5912162981966815, "policy_loss": -0.0013563089927648582, "vf_loss": 1.5920421763229622, "vf_explained_var": 0.000574241523389463, "kl": 0.007849331527974018, "entropy": 0.9052954423364508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 263655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.149646834358967, "cur_kl_coeff": 0.006013557454571128, "cur_lr": 0.00010000000000000003, "total_loss": 2.6671878052136253, "policy_loss": -0.0037772357286441896, "vf_loss": 2.670849817581278, "vf_explained_var": 0.003784455351097874, "kl": 0.019161330752761958, "entropy": 0.938573808739425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 263655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "env_runners": {"episode_reward_max": 63.0, "episode_reward_min": -528.0, "episode_reward_mean": -94.75, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 46.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -80.805, "predator_policy": 33.43}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, 2.0, -435.0, -5.0, -285.0, 29.0, -408.0, 0.0, 3.0, 29.0, -233.0, 0.0, -22.0, 3.0, -147.0, -77.0, 7.0, 50.0, -1.0, -63.0, -15.0, 28.0, -381.0, -6.0, 37.0, -21.0, -230.0, 16.0, -190.0, -13.0, 21.0, -16.0, -49.0, -23.0, 18.0, 8.0, 0.0, -528.0, -365.0, 34.0, 5.0, -53.0, -354.0, -76.0, -5.0, 63.0, -15.0, -437.0, -62.0, 18.0, 44.0, 0.0, -18.0, -257.0, -441.0, -10.0, -51.0, 7.0, -310.0, -22.0, -7.0, -526.0, -23.0, -451.0, -55.0, -483.0, -435.0, -336.0, 28.0, 35.0, -2.0, -491.0, -8.0, 9.0, -20.0, -3.0, 28.0, -4.0, -447.0, 19.0, 0.0, 1.0, -3.0, -325.0, -17.0, 18.0, 10.0, -444.0, 0.0, 34.0, 17.0, -13.0, -21.0, 6.0, -374.0, -4.0, -6.0, 47.0, -25.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -8.0, 0.0, 2.0, -345.0, -264.0, -56.0, 15.0, -309.0, -292.0, -6.0, 32.0, -260.0, -329.0, 0.0, 0.0, 0.0, 3.0, 0.0, 29.0, -171.0, -204.0, 0.0, 0.0, -44.0, 0.0, -27.0, 8.0, -324.0, 0.0, -180.0, 4.0, 10.0, -6.0, 22.0, 28.0, 0.0, -2.0, -97.0, -40.0, 9.0, -57.0, 18.0, -16.0, -270.0, -304.0, -12.0, 0.0, 31.0, 0.0, -43.0, -7.0, -110.0, -240.0, 0.0, 16.0, -278.0, -181.0, 0.0, -34.0, 23.0, -4.0, -73.0, -5.0, -78.0, -24.0, -54.0, -4.0, -18.0, 8.0, -16.0, 2.0, 0.0, 0.0, -352.0, -352.0, -366.0, -187.0, -37.0, 30.0, 5.0, 0.0, -59.0, -31.0, -232.0, -244.0, -145.0, -28.0, -14.0, 2.0, 20.0, 29.0, -3.0, -32.0, -298.0, -295.0, -40.0, -134.0, 5.0, 12.0, 10.0, -234.0, 0.0, 0.0, -56.0, -51.0, -209.0, -217.0, -265.0, -366.0, -57.0, 0.0, -61.0, -51.0, -6.0, 0.0, -338.0, -310.0, -48.0, 2.0, 0.0, -23.0, -348.0, -357.0, -46.0, 0.0, -254.0, -394.0, -74.0, -36.0, -310.0, -346.0, -273.0, -352.0, -309.0, -210.0, 0.0, 28.0, 34.0, -16.0, -14.0, -15.0, -400.0, -291.0, -68.0, 15.0, -2.0, -17.0, 0.0, -40.0, -6.0, 0.0, 46.0, -46.0, -28.0, 0.0, -301.0, -306.0, 15.0, -10.0, 0.0, 0.0, -28.0, -5.0, 0.0, -8.0, -267.0, -204.0, -34.0, 0.0, 6.0, 6.0, 0.0, 10.0, -297.0, -315.0, -8.0, 0.0, -22.0, 21.0, 0.0, 17.0, -32.0, -15.0, -42.0, 0.0, 6.0, 0.0, -316.0, -218.0, -23.0, 0.0, -2.0, -31.0, 45.0, 0.0, 0.0, -68.0, -20.0, -28.0], "policy_predator_policy_reward": [0.0, 4.0, 0.0, 0.0, 0.0, 174.0, 8.0, 28.0, 160.0, 156.0, 3.0, 0.0, 169.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 142.0, 0.0, 0.0, 0.0, 22.0, 0.0, 0.0, 22.0, 46.0, 131.0, 21.0, 78.0, 3.0, 0.0, 0.0, 0.0, 1.0, 0.0, 33.0, 41.0, 33.0, 0.0, 11.0, 15.0, 24.0, 169.0, 0.0, 6.0, 0.0, 6.0, 4.0, 25.0, 0.0, 120.0, 0.0, 0.0, 139.0, 130.0, 0.0, 21.0, 2.0, 0.0, 26.0, 36.0, 21.0, 32.0, 19.0, 16.0, 28.0, 0.0, 18.0, 4.0, 0.0, 0.0, 176.0, 0.0, 5.0, 183.0, 24.0, 17.0, 0.0, 0.0, 0.0, 37.0, 121.0, 1.0, 83.0, 14.0, 7.0, 0.0, 1.0, 13.0, 16.0, 4.0, 156.0, 0.0, 66.0, 46.0, 1.0, 0.0, 136.0, 132.0, 0.0, 0.0, 28.0, 61.0, 51.0, 118.0, 7.0, 183.0, 24.0, 23.0, 9.0, 52.0, 0.0, 13.0, 169.0, 169.0, 0.0, 24.0, 0.0, 16.0, 0.0, 179.0, 23.0, 0.0, 0.0, 197.0, 15.0, 40.0, 0.0, 173.0, 176.0, 14.0, 150.0, 33.0, 0.0, 0.0, 13.0, 4.0, 3.0, 24.0, 200.0, 0.0, 33.0, 12.0, 17.0, 11.0, 0.0, 20.0, 3.0, 0.0, 28.0, 0.0, 11.0, 13.0, 160.0, 0.0, 5.0, 9.0, 0.0, 0.0, 19.0, 15.0, 5.0, 0.0, 141.0, 5.0, 17.0, 0.0, 0.0, 6.0, 0.0, 0.0, 152.0, 16.0, 0.0, 8.0, 23.0, 12.0, 0.0, 0.0, 6.0, 28.0, 0.0, 21.0, 0.0, 0.0, 0.0, 160.0, 19.0, 0.0, 26.0, 1.0, 0.0, 2.0, 25.0, 18.0, 34.0, 16.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1548426716679856, "mean_inference_ms": 3.5428806150563066, "mean_action_processing_ms": 0.5167533406515554, "mean_env_wait_ms": 0.41223246736536984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013417720794677734, "StateBufferConnector_ms": 0.00941932201385498, "ViewRequirementAgentConnector_ms": 0.19384896755218506}, "num_episodes": 18, "episode_return_max": 63.0, "episode_return_min": -528.0, "episode_return_mean": -94.75, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 262.8443158239735, "num_env_steps_trained_throughput_per_sec": 262.8443158239735, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 2240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2240000, "timers": {"training_iteration_time_ms": 14813.659, "restore_workers_time_ms": 0.02, "training_step_time_ms": 14813.596, "sample_time_ms": 2855.22, "learn_time_ms": 11936.827, "learn_throughput": 335.097, "synch_weights_time_ms": 17.786}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "done": false, "training_iteration": 140, "trial_id": "e1352_00002", "date": "2024-08-13_19-52-25", "timestamp": 1723593145, "time_this_iter_s": 15.285237073898315, "time_total_s": 3030.8807442188263, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b8c430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3030.8807442188263, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 86.21363636363638, "ram_util_percent": 83.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7645766523858857, "cur_kl_coeff": 0.0675762176513672, "cur_lr": 0.00010000000000000003, "total_loss": 1.849331360456174, "policy_loss": -0.0009611675811428873, "vf_loss": 1.8499231543805865, "vf_explained_var": 0.005015423373570518, "kl": 0.005466001464303957, "entropy": 0.8585521681914254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 265545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.790814782671197, "cur_kl_coeff": 0.006013557454571128, "cur_lr": 0.00010000000000000003, "total_loss": 3.5378753395938367, "policy_loss": -0.002528064066751136, "vf_loss": 3.540348438232664, "vf_explained_var": 0.0049075556495202285, "kl": 0.009141367140212854, "entropy": 1.0342121454773756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 265545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "env_runners": {"episode_reward_max": 63.0, "episode_reward_min": -528.0, "episode_reward_mean": -82.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 46.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -71.45, "predator_policy": 30.025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0, 37.0, -21.0, -230.0, 16.0, -190.0, -13.0, 21.0, -16.0, -49.0, -23.0, 18.0, 8.0, 0.0, -528.0, -365.0, 34.0, 5.0, -53.0, -354.0, -76.0, -5.0, 63.0, -15.0, -437.0, -62.0, 18.0, 44.0, 0.0, -18.0, -257.0, -441.0, -10.0, -51.0, 7.0, -310.0, -22.0, -7.0, -526.0, -23.0, -451.0, -55.0, -483.0, -435.0, -336.0, 28.0, 35.0, -2.0, -491.0, -8.0, 9.0, -20.0, -3.0, 28.0, -4.0, -447.0, 19.0, 0.0, 1.0, -3.0, -325.0, -17.0, 18.0, 10.0, -444.0, 0.0, 34.0, 17.0, -13.0, -21.0, 6.0, -374.0, -4.0, -6.0, 47.0, -25.0, 2.0, 28.0, 10.0, -36.0, 58.0, 24.0, -11.0, 12.0, 0.0, 35.0, 19.0, -388.0, 13.0, -318.0, 43.0, -10.0, 2.0, -1.0, 22.0, -20.0, -159.0, -2.0, -14.0, -42.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.0, 0.0, 31.0, 0.0, -43.0, -7.0, -110.0, -240.0, 0.0, 16.0, -278.0, -181.0, 0.0, -34.0, 23.0, -4.0, -73.0, -5.0, -78.0, -24.0, -54.0, -4.0, -18.0, 8.0, -16.0, 2.0, 0.0, 0.0, -352.0, -352.0, -366.0, -187.0, -37.0, 30.0, 5.0, 0.0, -59.0, -31.0, -232.0, -244.0, -145.0, -28.0, -14.0, 2.0, 20.0, 29.0, -3.0, -32.0, -298.0, -295.0, -40.0, -134.0, 5.0, 12.0, 10.0, -234.0, 0.0, 0.0, -56.0, -51.0, -209.0, -217.0, -265.0, -366.0, -57.0, 0.0, -61.0, -51.0, -6.0, 0.0, -338.0, -310.0, -48.0, 2.0, 0.0, -23.0, -348.0, -357.0, -46.0, 0.0, -254.0, -394.0, -74.0, -36.0, -310.0, -346.0, -273.0, -352.0, -309.0, -210.0, 0.0, 28.0, 34.0, -16.0, -14.0, -15.0, -400.0, -291.0, -68.0, 15.0, -2.0, -17.0, 0.0, -40.0, -6.0, 0.0, 46.0, -46.0, -28.0, 0.0, -301.0, -306.0, 15.0, -10.0, 0.0, 0.0, -28.0, -5.0, 0.0, -8.0, -267.0, -204.0, -34.0, 0.0, 6.0, 6.0, 0.0, 10.0, -297.0, -315.0, -8.0, 0.0, -22.0, 21.0, 0.0, 17.0, -32.0, -15.0, -42.0, 0.0, 6.0, 0.0, -316.0, -218.0, -23.0, 0.0, -2.0, -31.0, 45.0, 0.0, 0.0, -68.0, -20.0, -28.0, 28.0, 0.0, -5.0, -4.0, -11.0, -78.0, 20.0, 38.0, 31.0, -21.0, -13.0, -13.0, 0.0, 12.0, 0.0, 0.0, 0.0, 35.0, 9.0, 0.0, -274.0, -264.0, 0.0, 4.0, -216.0, -252.0, 21.0, 22.0, 0.0, -36.0, 0.0, -2.0, 2.0, -28.0, -8.0, -5.0, 0.0, -45.0, -396.0, 33.0, 0.0, -4.0, 0.0, -59.0, -39.0, -42.0], "policy_predator_policy_reward": [0.0, 6.0, 0.0, 6.0, 4.0, 25.0, 0.0, 120.0, 0.0, 0.0, 139.0, 130.0, 0.0, 21.0, 2.0, 0.0, 26.0, 36.0, 21.0, 32.0, 19.0, 16.0, 28.0, 0.0, 18.0, 4.0, 0.0, 0.0, 176.0, 0.0, 5.0, 183.0, 24.0, 17.0, 0.0, 0.0, 0.0, 37.0, 121.0, 1.0, 83.0, 14.0, 7.0, 0.0, 1.0, 13.0, 16.0, 4.0, 156.0, 0.0, 66.0, 46.0, 1.0, 0.0, 136.0, 132.0, 0.0, 0.0, 28.0, 61.0, 51.0, 118.0, 7.0, 183.0, 24.0, 23.0, 9.0, 52.0, 0.0, 13.0, 169.0, 169.0, 0.0, 24.0, 0.0, 16.0, 0.0, 179.0, 23.0, 0.0, 0.0, 197.0, 15.0, 40.0, 0.0, 173.0, 176.0, 14.0, 150.0, 33.0, 0.0, 0.0, 13.0, 4.0, 3.0, 24.0, 200.0, 0.0, 33.0, 12.0, 17.0, 11.0, 0.0, 20.0, 3.0, 0.0, 28.0, 0.0, 11.0, 13.0, 160.0, 0.0, 5.0, 9.0, 0.0, 0.0, 19.0, 15.0, 5.0, 0.0, 141.0, 5.0, 17.0, 0.0, 0.0, 6.0, 0.0, 0.0, 152.0, 16.0, 0.0, 8.0, 23.0, 12.0, 0.0, 0.0, 6.0, 28.0, 0.0, 21.0, 0.0, 0.0, 0.0, 160.0, 19.0, 0.0, 26.0, 1.0, 0.0, 2.0, 25.0, 18.0, 34.0, 16.0, 0.0, 0.0, 6.0, 13.0, 53.0, 0.0, 0.0, 0.0, 13.0, 1.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 148.0, 9.0, 0.0, 10.0, 140.0, 0.0, 0.0, 0.0, 26.0, 4.0, 0.0, 11.0, 14.0, 19.0, 16.0, 1.0, 24.0, 198.0, 6.0, 0.0, 2.0, 15.0, 30.0, 0.0, 39.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1526478048690183, "mean_inference_ms": 3.544142570694517, "mean_action_processing_ms": 0.5160885870747053, "mean_env_wait_ms": 0.4124188909928889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012936949729919434, "StateBufferConnector_ms": 0.01035618782043457, "ViewRequirementAgentConnector_ms": 0.19003570079803467}, "num_episodes": 23, "episode_return_max": 63.0, "episode_return_min": -528.0, "episode_return_mean": -82.85, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.3053136996546, "num_env_steps_trained_throughput_per_sec": 292.3053136996546, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 2256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2256000, "timers": {"training_iteration_time_ms": 14696.168, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14696.109, "sample_time_ms": 2800.305, "learn_time_ms": 11874.66, "learn_throughput": 336.852, "synch_weights_time_ms": 17.478}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "done": false, "training_iteration": 141, "trial_id": "e1352_00002", "date": "2024-08-13_19-52-39", "timestamp": 1723593159, "time_this_iter_s": 13.748216152191162, "time_total_s": 3044.6289603710175, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d44ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3044.6289603710175, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 81.24736842105263, "ram_util_percent": 83.5842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.707329327333226, "cur_kl_coeff": 0.0675762176513672, "cur_lr": 0.00010000000000000003, "total_loss": 2.2758563299658436, "policy_loss": -0.004305521392007235, "vf_loss": 2.2795106467746553, "vf_explained_var": 0.013928417869345852, "kl": 0.009636522374040835, "entropy": 0.889783949038339, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 267435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.980951935604766, "cur_kl_coeff": 0.006013557454571128, "cur_lr": 0.00010000000000000003, "total_loss": 5.090132856621313, "policy_loss": -0.007129503916037422, "vf_loss": 5.097127297946385, "vf_explained_var": -0.013436685321192262, "kl": 0.02245986097800372, "entropy": 1.0893977980765086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 267435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000}, "env_runners": {"episode_reward_max": 80.0, "episode_reward_min": -526.0, "episode_reward_mean": -71.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 51.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -64.96, "predator_policy": 29.455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-53.0, -354.0, -76.0, -5.0, 63.0, -15.0, -437.0, -62.0, 18.0, 44.0, 0.0, -18.0, -257.0, -441.0, -10.0, -51.0, 7.0, -310.0, -22.0, -7.0, -526.0, -23.0, -451.0, -55.0, -483.0, -435.0, -336.0, 28.0, 35.0, -2.0, -491.0, -8.0, 9.0, -20.0, -3.0, 28.0, -4.0, -447.0, 19.0, 0.0, 1.0, -3.0, -325.0, -17.0, 18.0, 10.0, -444.0, 0.0, 34.0, 17.0, -13.0, -21.0, 6.0, -374.0, -4.0, -6.0, 47.0, -25.0, 2.0, 28.0, 10.0, -36.0, 58.0, 24.0, -11.0, 12.0, 0.0, 35.0, 19.0, -388.0, 13.0, -318.0, 43.0, -10.0, 2.0, -1.0, 22.0, -20.0, -159.0, -2.0, -14.0, -42.0, -17.0, 11.0, -87.0, 0.0, 57.0, 59.0, 27.0, 16.0, -7.0, 62.0, 25.0, 54.0, 29.0, 4.0, -2.0, -17.0, -412.0, 80.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-59.0, -31.0, -232.0, -244.0, -145.0, -28.0, -14.0, 2.0, 20.0, 29.0, -3.0, -32.0, -298.0, -295.0, -40.0, -134.0, 5.0, 12.0, 10.0, -234.0, 0.0, 0.0, -56.0, -51.0, -209.0, -217.0, -265.0, -366.0, -57.0, 0.0, -61.0, -51.0, -6.0, 0.0, -338.0, -310.0, -48.0, 2.0, 0.0, -23.0, -348.0, -357.0, -46.0, 0.0, -254.0, -394.0, -74.0, -36.0, -310.0, -346.0, -273.0, -352.0, -309.0, -210.0, 0.0, 28.0, 34.0, -16.0, -14.0, -15.0, -400.0, -291.0, -68.0, 15.0, -2.0, -17.0, 0.0, -40.0, -6.0, 0.0, 46.0, -46.0, -28.0, 0.0, -301.0, -306.0, 15.0, -10.0, 0.0, 0.0, -28.0, -5.0, 0.0, -8.0, -267.0, -204.0, -34.0, 0.0, 6.0, 6.0, 0.0, 10.0, -297.0, -315.0, -8.0, 0.0, -22.0, 21.0, 0.0, 17.0, -32.0, -15.0, -42.0, 0.0, 6.0, 0.0, -316.0, -218.0, -23.0, 0.0, -2.0, -31.0, 45.0, 0.0, 0.0, -68.0, -20.0, -28.0, 28.0, 0.0, -5.0, -4.0, -11.0, -78.0, 20.0, 38.0, 31.0, -21.0, -13.0, -13.0, 0.0, 12.0, 0.0, 0.0, 0.0, 35.0, 9.0, 0.0, -274.0, -264.0, 0.0, 4.0, -216.0, -252.0, 21.0, 22.0, 0.0, -36.0, 0.0, -2.0, 2.0, -28.0, -8.0, -5.0, 0.0, -45.0, -396.0, 33.0, 0.0, -4.0, 0.0, -59.0, -39.0, -42.0, -9.0, -61.0, -39.0, -11.0, -121.0, -182.0, 0.0, 0.0, 26.0, 29.0, 46.0, 2.0, 0.0, 27.0, 12.0, -20.0, 10.0, -78.0, 49.0, 2.0, 4.0, -20.0, -50.0, 43.0, 26.0, 3.0, -53.0, 6.0, -4.0, 0.0, 0.0, -142.0, -400.0, -231.0, 23.0, 51.0], "policy_predator_policy_reward": [0.0, 37.0, 121.0, 1.0, 83.0, 14.0, 7.0, 0.0, 1.0, 13.0, 16.0, 4.0, 156.0, 0.0, 66.0, 46.0, 1.0, 0.0, 136.0, 132.0, 0.0, 0.0, 28.0, 61.0, 51.0, 118.0, 7.0, 183.0, 24.0, 23.0, 9.0, 52.0, 0.0, 13.0, 169.0, 169.0, 0.0, 24.0, 0.0, 16.0, 0.0, 179.0, 23.0, 0.0, 0.0, 197.0, 15.0, 40.0, 0.0, 173.0, 176.0, 14.0, 150.0, 33.0, 0.0, 0.0, 13.0, 4.0, 3.0, 24.0, 200.0, 0.0, 33.0, 12.0, 17.0, 11.0, 0.0, 20.0, 3.0, 0.0, 28.0, 0.0, 11.0, 13.0, 160.0, 0.0, 5.0, 9.0, 0.0, 0.0, 19.0, 15.0, 5.0, 0.0, 141.0, 5.0, 17.0, 0.0, 0.0, 6.0, 0.0, 0.0, 152.0, 16.0, 0.0, 8.0, 23.0, 12.0, 0.0, 0.0, 6.0, 28.0, 0.0, 21.0, 0.0, 0.0, 0.0, 160.0, 19.0, 0.0, 26.0, 1.0, 0.0, 2.0, 25.0, 18.0, 34.0, 16.0, 0.0, 0.0, 6.0, 13.0, 53.0, 0.0, 0.0, 0.0, 13.0, 1.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 148.0, 9.0, 0.0, 10.0, 140.0, 0.0, 0.0, 0.0, 26.0, 4.0, 0.0, 11.0, 14.0, 19.0, 16.0, 1.0, 24.0, 198.0, 6.0, 0.0, 2.0, 15.0, 30.0, 0.0, 39.0, 39.0, 14.0, 0.0, 61.0, 114.0, 102.0, 0.0, 0.0, 0.0, 2.0, 11.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 61.0, 9.0, 2.0, 41.0, 0.0, 21.0, 40.0, 0.0, 0.0, 1.0, 50.0, 0.0, 2.0, 69.0, 56.0, 200.0, 19.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.153477525710903, "mean_inference_ms": 3.5404903121197515, "mean_action_processing_ms": 0.5156328993845568, "mean_env_wait_ms": 0.41217993033833866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011990666389465332, "StateBufferConnector_ms": 0.00864112377166748, "ViewRequirementAgentConnector_ms": 0.18678081035614014}, "num_episodes": 18, "episode_return_max": 80.0, "episode_return_min": -526.0, "episode_return_mean": -71.01, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.77320017407703, "num_env_steps_trained_throughput_per_sec": 272.77320017407703, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 2272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2272000, "timers": {"training_iteration_time_ms": 14457.706, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14457.647, "sample_time_ms": 2588.061, "learn_time_ms": 11849.133, "learn_throughput": 337.577, "synch_weights_time_ms": 17.965}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000}, "done": false, "training_iteration": 142, "trial_id": "e1352_00002", "date": "2024-08-13_19-52-54", "timestamp": 1723593174, "time_this_iter_s": 14.754849910736084, "time_total_s": 3059.3838102817535, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1681dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3059.3838102817535, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 82.94761904761904, "ram_util_percent": 83.60952380952381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3678212928078164, "cur_kl_coeff": 0.0675762176513672, "cur_lr": 0.00010000000000000003, "total_loss": 1.9565218407641012, "policy_loss": -0.0025035342640149848, "vf_loss": 1.9585609472617902, "vf_explained_var": 0.029093452956941393, "kl": 0.006872541607060672, "entropy": 0.9375802060283681, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 269325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.339980983497605, "cur_kl_coeff": 0.00902033618185669, "cur_lr": 0.00010000000000000003, "total_loss": 4.781580873645803, "policy_loss": -0.0054646721307469144, "vf_loss": 4.786900243305024, "vf_explained_var": -0.007317998232664886, "kl": 0.016108640253560767, "entropy": 1.0836476340811088, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 269325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 2288000}, "env_runners": {"episode_reward_max": 151.0, "episode_reward_min": -491.0, "episode_reward_mean": -38.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 91.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -42.045, "predator_policy": 22.64}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-451.0, -55.0, -483.0, -435.0, -336.0, 28.0, 35.0, -2.0, -491.0, -8.0, 9.0, -20.0, -3.0, 28.0, -4.0, -447.0, 19.0, 0.0, 1.0, -3.0, -325.0, -17.0, 18.0, 10.0, -444.0, 0.0, 34.0, 17.0, -13.0, -21.0, 6.0, -374.0, -4.0, -6.0, 47.0, -25.0, 2.0, 28.0, 10.0, -36.0, 58.0, 24.0, -11.0, 12.0, 0.0, 35.0, 19.0, -388.0, 13.0, -318.0, 43.0, -10.0, 2.0, -1.0, 22.0, -20.0, -159.0, -2.0, -14.0, -42.0, -17.0, 11.0, -87.0, 0.0, 57.0, 59.0, 27.0, 16.0, -7.0, 62.0, 25.0, 54.0, 29.0, 4.0, -2.0, -17.0, -412.0, 80.0, -38.0, 10.0, -54.0, 44.0, 151.0, 5.0, 68.0, 45.0, 0.0, 0.0, 41.0, 0.0, 85.0, -33.0, 80.0, 84.0, 120.0, 87.0, -1.0, 13.0, -21.0, -1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-254.0, -394.0, -74.0, -36.0, -310.0, -346.0, -273.0, -352.0, -309.0, -210.0, 0.0, 28.0, 34.0, -16.0, -14.0, -15.0, -400.0, -291.0, -68.0, 15.0, -2.0, -17.0, 0.0, -40.0, -6.0, 0.0, 46.0, -46.0, -28.0, 0.0, -301.0, -306.0, 15.0, -10.0, 0.0, 0.0, -28.0, -5.0, 0.0, -8.0, -267.0, -204.0, -34.0, 0.0, 6.0, 6.0, 0.0, 10.0, -297.0, -315.0, -8.0, 0.0, -22.0, 21.0, 0.0, 17.0, -32.0, -15.0, -42.0, 0.0, 6.0, 0.0, -316.0, -218.0, -23.0, 0.0, -2.0, -31.0, 45.0, 0.0, 0.0, -68.0, -20.0, -28.0, 28.0, 0.0, -5.0, -4.0, -11.0, -78.0, 20.0, 38.0, 31.0, -21.0, -13.0, -13.0, 0.0, 12.0, 0.0, 0.0, 0.0, 35.0, 9.0, 0.0, -274.0, -264.0, 0.0, 4.0, -216.0, -252.0, 21.0, 22.0, 0.0, -36.0, 0.0, -2.0, 2.0, -28.0, -8.0, -5.0, 0.0, -45.0, -396.0, 33.0, 0.0, -4.0, 0.0, -59.0, -39.0, -42.0, -9.0, -61.0, -39.0, -11.0, -121.0, -182.0, 0.0, 0.0, 26.0, 29.0, 46.0, 2.0, 0.0, 27.0, 12.0, -20.0, 10.0, -78.0, 49.0, 2.0, 4.0, -20.0, -50.0, 43.0, 26.0, 3.0, -53.0, 6.0, -4.0, 0.0, 0.0, -142.0, -400.0, -231.0, 23.0, 51.0, -93.0, -41.0, 0.0, 2.0, -8.0, -132.0, 44.0, 0.0, 80.0, 69.0, -84.0, 23.0, 26.0, 33.0, 15.0, 13.0, 0.0, 0.0, 0.0, 0.0, 41.0, 0.0, 0.0, 0.0, 59.0, -14.0, -109.0, 0.0, 6.0, 42.0, 0.0, 80.0, 91.0, 28.0, 69.0, -7.0, -37.0, 0.0, -9.0, -32.0, 0.0, -83.0, -12.0, 5.0], "policy_predator_policy_reward": [0.0, 197.0, 15.0, 40.0, 0.0, 173.0, 176.0, 14.0, 150.0, 33.0, 0.0, 0.0, 13.0, 4.0, 3.0, 24.0, 200.0, 0.0, 33.0, 12.0, 17.0, 11.0, 0.0, 20.0, 3.0, 0.0, 28.0, 0.0, 11.0, 13.0, 160.0, 0.0, 5.0, 9.0, 0.0, 0.0, 19.0, 15.0, 5.0, 0.0, 141.0, 5.0, 17.0, 0.0, 0.0, 6.0, 0.0, 0.0, 152.0, 16.0, 0.0, 8.0, 23.0, 12.0, 0.0, 0.0, 6.0, 28.0, 0.0, 21.0, 0.0, 0.0, 0.0, 160.0, 19.0, 0.0, 26.0, 1.0, 0.0, 2.0, 25.0, 18.0, 34.0, 16.0, 0.0, 0.0, 6.0, 13.0, 53.0, 0.0, 0.0, 0.0, 13.0, 1.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 148.0, 9.0, 0.0, 10.0, 140.0, 0.0, 0.0, 0.0, 26.0, 4.0, 0.0, 11.0, 14.0, 19.0, 16.0, 1.0, 24.0, 198.0, 6.0, 0.0, 2.0, 15.0, 30.0, 0.0, 39.0, 39.0, 14.0, 0.0, 61.0, 114.0, 102.0, 0.0, 0.0, 0.0, 2.0, 11.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 61.0, 9.0, 2.0, 41.0, 0.0, 21.0, 40.0, 0.0, 0.0, 1.0, 50.0, 0.0, 2.0, 69.0, 56.0, 200.0, 19.0, 6.0, 0.0, 19.0, 77.0, 5.0, 3.0, 11.0, 75.0, 0.0, 0.0, 0.0, 2.0, 20.0, 46.0, 2.0, 7.0, 13.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 3.0, 15.0, 61.0, 32.0, 0.0, 4.0, 0.0, 0.0, 1.0, 25.0, 0.0, 6.0, 30.0, 54.0, 0.0, 44.0, 18.0, 0.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1521442341941641, "mean_inference_ms": 3.537357202839147, "mean_action_processing_ms": 0.5147856270068359, "mean_env_wait_ms": 0.4119813946991739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008487939834594727, "StateBufferConnector_ms": 0.004705548286437988, "ViewRequirementAgentConnector_ms": 0.16932451725006104}, "num_episodes": 22, "episode_return_max": 151.0, "episode_return_min": -491.0, "episode_return_mean": -38.81, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 2288000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.6987272543303, "num_env_steps_trained_throughput_per_sec": 271.6987272543303, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 2288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2288000, "timers": {"training_iteration_time_ms": 14517.887, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14517.829, "sample_time_ms": 2612.554, "learn_time_ms": 11885.377, "learn_throughput": 336.548, "synch_weights_time_ms": 17.565}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 2288000}, "done": false, "training_iteration": 143, "trial_id": "e1352_00002", "date": "2024-08-13_19-53-09", "timestamp": 1723593189, "time_this_iter_s": 14.78753113746643, "time_total_s": 3074.17134141922, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d94e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3074.17134141922, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 85.33809523809524, "ram_util_percent": 83.86190476190475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7722745336868146, "cur_kl_coeff": 0.0675762176513672, "cur_lr": 0.00010000000000000003, "total_loss": 4.345729228176137, "policy_loss": -0.0049813306143891714, "vf_loss": 4.349981968112724, "vf_explained_var": 0.012530472921946692, "kl": 0.010781750483889822, "entropy": 0.9349376558626771, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 271215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7980590164661407, "cur_kl_coeff": 0.00902033618185669, "cur_lr": 0.00010000000000000003, "total_loss": 5.421998248907624, "policy_loss": -0.0034949954887408584, "vf_loss": 5.425385477177049, "vf_explained_var": -0.016647281407048464, "kl": 0.01194647643770001, "entropy": 1.0160832078999313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 271215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "env_runners": {"episode_reward_max": 151.0, "episode_reward_min": -444.0, "episode_reward_mean": -17.29, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 111.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -31.195, "predator_policy": 22.55}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0, -3.0, -325.0, -17.0, 18.0, 10.0, -444.0, 0.0, 34.0, 17.0, -13.0, -21.0, 6.0, -374.0, -4.0, -6.0, 47.0, -25.0, 2.0, 28.0, 10.0, -36.0, 58.0, 24.0, -11.0, 12.0, 0.0, 35.0, 19.0, -388.0, 13.0, -318.0, 43.0, -10.0, 2.0, -1.0, 22.0, -20.0, -159.0, -2.0, -14.0, -42.0, -17.0, 11.0, -87.0, 0.0, 57.0, 59.0, 27.0, 16.0, -7.0, 62.0, 25.0, 54.0, 29.0, 4.0, -2.0, -17.0, -412.0, 80.0, -38.0, 10.0, -54.0, 44.0, 151.0, 5.0, 68.0, 45.0, 0.0, 0.0, 41.0, 0.0, 85.0, -33.0, 80.0, 84.0, 120.0, 87.0, -1.0, 13.0, -21.0, -1.0, -14.0, -23.0, 24.0, -15.0, 39.0, -154.0, -3.0, 68.0, -34.0, -21.0, -89.0, -46.0, -79.0, -134.0, 150.0, -14.0, -88.0, -31.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-28.0, -5.0, 0.0, -8.0, -267.0, -204.0, -34.0, 0.0, 6.0, 6.0, 0.0, 10.0, -297.0, -315.0, -8.0, 0.0, -22.0, 21.0, 0.0, 17.0, -32.0, -15.0, -42.0, 0.0, 6.0, 0.0, -316.0, -218.0, -23.0, 0.0, -2.0, -31.0, 45.0, 0.0, 0.0, -68.0, -20.0, -28.0, 28.0, 0.0, -5.0, -4.0, -11.0, -78.0, 20.0, 38.0, 31.0, -21.0, -13.0, -13.0, 0.0, 12.0, 0.0, 0.0, 0.0, 35.0, 9.0, 0.0, -274.0, -264.0, 0.0, 4.0, -216.0, -252.0, 21.0, 22.0, 0.0, -36.0, 0.0, -2.0, 2.0, -28.0, -8.0, -5.0, 0.0, -45.0, -396.0, 33.0, 0.0, -4.0, 0.0, -59.0, -39.0, -42.0, -9.0, -61.0, -39.0, -11.0, -121.0, -182.0, 0.0, 0.0, 26.0, 29.0, 46.0, 2.0, 0.0, 27.0, 12.0, -20.0, 10.0, -78.0, 49.0, 2.0, 4.0, -20.0, -50.0, 43.0, 26.0, 3.0, -53.0, 6.0, -4.0, 0.0, 0.0, -142.0, -400.0, -231.0, 23.0, 51.0, -93.0, -41.0, 0.0, 2.0, -8.0, -132.0, 44.0, 0.0, 80.0, 69.0, -84.0, 23.0, 26.0, 33.0, 15.0, 13.0, 0.0, 0.0, 0.0, 0.0, 41.0, 0.0, 0.0, 0.0, 59.0, -14.0, -109.0, 0.0, 6.0, 42.0, 0.0, 80.0, 91.0, 28.0, 69.0, -7.0, -37.0, 0.0, -9.0, -32.0, 0.0, -83.0, -12.0, 5.0, -4.0, -74.0, -7.0, -103.0, -54.0, -6.0, -72.0, 0.0, 0.0, -1.0, -157.0, -109.0, -6.0, 0.0, 0.0, 68.0, -107.0, -46.0, 0.0, -58.0, -220.0, -12.0, -16.0, -100.0, -99.0, -71.0, 51.0, -382.0, 111.0, 25.0, -60.0, -8.0, -53.0, -140.0, -42.0, -58.0], "policy_predator_policy_reward": [19.0, 15.0, 5.0, 0.0, 141.0, 5.0, 17.0, 0.0, 0.0, 6.0, 0.0, 0.0, 152.0, 16.0, 0.0, 8.0, 23.0, 12.0, 0.0, 0.0, 6.0, 28.0, 0.0, 21.0, 0.0, 0.0, 0.0, 160.0, 19.0, 0.0, 26.0, 1.0, 0.0, 2.0, 25.0, 18.0, 34.0, 16.0, 0.0, 0.0, 6.0, 13.0, 53.0, 0.0, 0.0, 0.0, 13.0, 1.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 148.0, 9.0, 0.0, 10.0, 140.0, 0.0, 0.0, 0.0, 26.0, 4.0, 0.0, 11.0, 14.0, 19.0, 16.0, 1.0, 24.0, 198.0, 6.0, 0.0, 2.0, 15.0, 30.0, 0.0, 39.0, 39.0, 14.0, 0.0, 61.0, 114.0, 102.0, 0.0, 0.0, 0.0, 2.0, 11.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 61.0, 9.0, 2.0, 41.0, 0.0, 21.0, 40.0, 0.0, 0.0, 1.0, 50.0, 0.0, 2.0, 69.0, 56.0, 200.0, 19.0, 6.0, 0.0, 19.0, 77.0, 5.0, 3.0, 11.0, 75.0, 0.0, 0.0, 0.0, 2.0, 20.0, 46.0, 2.0, 7.0, 13.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 3.0, 15.0, 61.0, 32.0, 0.0, 4.0, 0.0, 0.0, 1.0, 25.0, 0.0, 6.0, 30.0, 54.0, 0.0, 44.0, 18.0, 0.0, 6.0, 64.0, 0.0, 59.0, 28.0, 44.0, 40.0, 57.0, 0.0, 16.0, 24.0, 14.0, 98.0, 3.0, 0.0, 0.0, 0.0, 38.0, 81.0, 37.0, 0.0, 114.0, 29.0, 0.0, 70.0, 61.0, 30.0, 6.0, 191.0, 0.0, 14.0, 0.0, 54.0, 32.0, 73.0, 69.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.151072211619225, "mean_inference_ms": 3.5347121510203383, "mean_action_processing_ms": 0.5140310949002111, "mean_env_wait_ms": 0.4117765178363693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008028149604797363, "StateBufferConnector_ms": 0.0047321319580078125, "ViewRequirementAgentConnector_ms": 0.1693664789199829}, "num_episodes": 18, "episode_return_max": 151.0, "episode_return_min": -444.0, "episode_return_mean": -17.29, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.6701580877714, "num_env_steps_trained_throughput_per_sec": 299.6701580877714, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 2304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2304000, "timers": {"training_iteration_time_ms": 14556.608, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14556.553, "sample_time_ms": 2598.228, "learn_time_ms": 11938.204, "learn_throughput": 335.059, "synch_weights_time_ms": 17.891}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "done": false, "training_iteration": 144, "trial_id": "e1352_00002", "date": "2024-08-13_19-53-22", "timestamp": 1723593202, "time_this_iter_s": 13.528601884841919, "time_total_s": 3087.699943304062, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e22670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3087.699943304062, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 77.90526315789474, "ram_util_percent": 83.71578947368423}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6411129461473257, "cur_kl_coeff": 0.0675762176513672, "cur_lr": 0.00010000000000000003, "total_loss": 2.59828336629918, "policy_loss": -0.001358290499066392, "vf_loss": 2.5992305474937276, "vf_explained_var": -0.0023336019465532254, "kl": 0.006083598693190206, "entropy": 0.8740304461862675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 273105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9434157001120704, "cur_kl_coeff": 0.00902033618185669, "cur_lr": 0.00010000000000000003, "total_loss": 2.9498949744083265, "policy_loss": -0.005284514735211377, "vf_loss": 2.955066852027146, "vf_explained_var": -0.0063724628516605925, "kl": 0.012488362570359901, "entropy": 1.0949741260715262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 273105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "env_runners": {"episode_reward_max": 151.0, "episode_reward_min": -412.0, "episode_reward_mean": -9.43, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -612.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 111.0, "predator_policy": 466.0}, "policy_reward_mean": {"prey_policy": -30.82, "predator_policy": 26.105}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 28.0, 10.0, -36.0, 58.0, 24.0, -11.0, 12.0, 0.0, 35.0, 19.0, -388.0, 13.0, -318.0, 43.0, -10.0, 2.0, -1.0, 22.0, -20.0, -159.0, -2.0, -14.0, -42.0, -17.0, 11.0, -87.0, 0.0, 57.0, 59.0, 27.0, 16.0, -7.0, 62.0, 25.0, 54.0, 29.0, 4.0, -2.0, -17.0, -412.0, 80.0, -38.0, 10.0, -54.0, 44.0, 151.0, 5.0, 68.0, 45.0, 0.0, 0.0, 41.0, 0.0, 85.0, -33.0, 80.0, 84.0, 120.0, 87.0, -1.0, 13.0, -21.0, -1.0, -14.0, -23.0, 24.0, -15.0, 39.0, -154.0, -3.0, 68.0, -34.0, -21.0, -89.0, -46.0, -79.0, -134.0, 150.0, -14.0, -88.0, -31.0, 0.0, 26.0, 115.0, -178.0, -4.0, 0.0, -38.0, -27.0, 0.0, 15.0, 45.0, -108.0, -19.0, -83.0, -65.0, 0.0, 15.0, -7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.0, -28.0, 28.0, 0.0, -5.0, -4.0, -11.0, -78.0, 20.0, 38.0, 31.0, -21.0, -13.0, -13.0, 0.0, 12.0, 0.0, 0.0, 0.0, 35.0, 9.0, 0.0, -274.0, -264.0, 0.0, 4.0, -216.0, -252.0, 21.0, 22.0, 0.0, -36.0, 0.0, -2.0, 2.0, -28.0, -8.0, -5.0, 0.0, -45.0, -396.0, 33.0, 0.0, -4.0, 0.0, -59.0, -39.0, -42.0, -9.0, -61.0, -39.0, -11.0, -121.0, -182.0, 0.0, 0.0, 26.0, 29.0, 46.0, 2.0, 0.0, 27.0, 12.0, -20.0, 10.0, -78.0, 49.0, 2.0, 4.0, -20.0, -50.0, 43.0, 26.0, 3.0, -53.0, 6.0, -4.0, 0.0, 0.0, -142.0, -400.0, -231.0, 23.0, 51.0, -93.0, -41.0, 0.0, 2.0, -8.0, -132.0, 44.0, 0.0, 80.0, 69.0, -84.0, 23.0, 26.0, 33.0, 15.0, 13.0, 0.0, 0.0, 0.0, 0.0, 41.0, 0.0, 0.0, 0.0, 59.0, -14.0, -109.0, 0.0, 6.0, 42.0, 0.0, 80.0, 91.0, 28.0, 69.0, -7.0, -37.0, 0.0, -9.0, -32.0, 0.0, -83.0, -12.0, 5.0, -4.0, -74.0, -7.0, -103.0, -54.0, -6.0, -72.0, 0.0, 0.0, -1.0, -157.0, -109.0, -6.0, 0.0, 0.0, 68.0, -107.0, -46.0, 0.0, -58.0, -220.0, -12.0, -16.0, -100.0, -99.0, -71.0, 51.0, -382.0, 111.0, 25.0, -60.0, -8.0, -53.0, -140.0, -42.0, -58.0, 0.0, 0.0, 17.0, 0.0, 48.0, 67.0, -356.0, 0.0, -17.0, -39.0, 0.0, 0.0, -29.0, -125.0, -37.0, -24.0, 0.0, 0.0, 6.0, -138.0, 41.0, 0.0, -612.0, 38.0, -108.0, 0.0, -39.0, -193.0, -106.0, -97.0, 0.0, 0.0, 10.0, -31.0, -25.0, 0.0], "policy_predator_policy_reward": [34.0, 16.0, 0.0, 0.0, 6.0, 13.0, 53.0, 0.0, 0.0, 0.0, 13.0, 1.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 148.0, 9.0, 0.0, 10.0, 140.0, 0.0, 0.0, 0.0, 26.0, 4.0, 0.0, 11.0, 14.0, 19.0, 16.0, 1.0, 24.0, 198.0, 6.0, 0.0, 2.0, 15.0, 30.0, 0.0, 39.0, 39.0, 14.0, 0.0, 61.0, 114.0, 102.0, 0.0, 0.0, 0.0, 2.0, 11.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 61.0, 9.0, 2.0, 41.0, 0.0, 21.0, 40.0, 0.0, 0.0, 1.0, 50.0, 0.0, 2.0, 69.0, 56.0, 200.0, 19.0, 6.0, 0.0, 19.0, 77.0, 5.0, 3.0, 11.0, 75.0, 0.0, 0.0, 0.0, 2.0, 20.0, 46.0, 2.0, 7.0, 13.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 3.0, 15.0, 61.0, 32.0, 0.0, 4.0, 0.0, 0.0, 1.0, 25.0, 0.0, 6.0, 30.0, 54.0, 0.0, 44.0, 18.0, 0.0, 6.0, 64.0, 0.0, 59.0, 28.0, 44.0, 40.0, 57.0, 0.0, 16.0, 24.0, 14.0, 98.0, 3.0, 0.0, 0.0, 0.0, 38.0, 81.0, 37.0, 0.0, 114.0, 29.0, 0.0, 70.0, 61.0, 30.0, 6.0, 191.0, 0.0, 14.0, 0.0, 54.0, 32.0, 73.0, 69.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 178.0, 0.0, 31.0, 21.0, 0.0, 0.0, 46.0, 70.0, 13.0, 21.0, 0.0, 0.0, 84.0, 63.0, 0.0, 4.0, 466.0, 0.0, 33.0, 56.0, 123.0, 26.0, 95.0, 43.0, 0.0, 0.0, 23.0, 13.0, 0.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1510449839658372, "mean_inference_ms": 3.5348905085235764, "mean_action_processing_ms": 0.5137236227548105, "mean_env_wait_ms": 0.41191379381519655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013832926750183105, "StateBufferConnector_ms": 0.007786870002746582, "ViewRequirementAgentConnector_ms": 0.2050638198852539}, "num_episodes": 18, "episode_return_max": 151.0, "episode_return_min": -412.0, "episode_return_mean": -9.43, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 222.13323355186282, "num_env_steps_trained_throughput_per_sec": 222.13323355186282, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 2320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2320000, "timers": {"training_iteration_time_ms": 14853.635, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14853.583, "sample_time_ms": 2663.341, "learn_time_ms": 12168.094, "learn_throughput": 328.729, "synch_weights_time_ms": 19.892}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "done": false, "training_iteration": 145, "trial_id": "e1352_00002", "date": "2024-08-13_19-53-40", "timestamp": 1723593220, "time_this_iter_s": 18.12573480606079, "time_total_s": 3105.8256781101227, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f42ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3105.8256781101227, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 85.256, "ram_util_percent": 83.556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3145283441694957, "cur_kl_coeff": 0.0675762176513672, "cur_lr": 0.00010000000000000003, "total_loss": 1.8514531100237812, "policy_loss": -0.0007066004394637371, "vf_loss": 1.8516409966680738, "vf_explained_var": 0.009568429024761948, "kl": 0.007675976936141874, "entropy": 0.8656368479211495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 274995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7158508368822, "cur_kl_coeff": 0.00902033618185669, "cur_lr": 0.00010000000000000003, "total_loss": 1.671756641290806, "policy_loss": -0.0051958387599341455, "vf_loss": 1.676798703588506, "vf_explained_var": -0.017397750054717696, "kl": 0.01704773372693586, "entropy": 1.0835800146615064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 274995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000}, "env_runners": {"episode_reward_max": 151.0, "episode_reward_min": -412.0, "episode_reward_mean": -4.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -612.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 111.0, "predator_policy": 466.0}, "policy_reward_mean": {"prey_policy": -27.575, "predator_policy": 25.465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-42.0, -17.0, 11.0, -87.0, 0.0, 57.0, 59.0, 27.0, 16.0, -7.0, 62.0, 25.0, 54.0, 29.0, 4.0, -2.0, -17.0, -412.0, 80.0, -38.0, 10.0, -54.0, 44.0, 151.0, 5.0, 68.0, 45.0, 0.0, 0.0, 41.0, 0.0, 85.0, -33.0, 80.0, 84.0, 120.0, 87.0, -1.0, 13.0, -21.0, -1.0, -14.0, -23.0, 24.0, -15.0, 39.0, -154.0, -3.0, 68.0, -34.0, -21.0, -89.0, -46.0, -79.0, -134.0, 150.0, -14.0, -88.0, -31.0, 0.0, 26.0, 115.0, -178.0, -4.0, 0.0, -38.0, -27.0, 0.0, 15.0, 45.0, -108.0, -19.0, -83.0, -65.0, 0.0, 15.0, -7.0, -24.0, 7.0, -2.0, -4.0, -7.0, 0.0, -114.0, -24.0, -108.0, -3.0, 0.0, 83.0, 0.0, 0.0, 0.0, -4.0, 20.0, -2.0, -26.0, 27.0, 17.0, -9.0, 3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-39.0, -42.0, -9.0, -61.0, -39.0, -11.0, -121.0, -182.0, 0.0, 0.0, 26.0, 29.0, 46.0, 2.0, 0.0, 27.0, 12.0, -20.0, 10.0, -78.0, 49.0, 2.0, 4.0, -20.0, -50.0, 43.0, 26.0, 3.0, -53.0, 6.0, -4.0, 0.0, 0.0, -142.0, -400.0, -231.0, 23.0, 51.0, -93.0, -41.0, 0.0, 2.0, -8.0, -132.0, 44.0, 0.0, 80.0, 69.0, -84.0, 23.0, 26.0, 33.0, 15.0, 13.0, 0.0, 0.0, 0.0, 0.0, 41.0, 0.0, 0.0, 0.0, 59.0, -14.0, -109.0, 0.0, 6.0, 42.0, 0.0, 80.0, 91.0, 28.0, 69.0, -7.0, -37.0, 0.0, -9.0, -32.0, 0.0, -83.0, -12.0, 5.0, -4.0, -74.0, -7.0, -103.0, -54.0, -6.0, -72.0, 0.0, 0.0, -1.0, -157.0, -109.0, -6.0, 0.0, 0.0, 68.0, -107.0, -46.0, 0.0, -58.0, -220.0, -12.0, -16.0, -100.0, -99.0, -71.0, 51.0, -382.0, 111.0, 25.0, -60.0, -8.0, -53.0, -140.0, -42.0, -58.0, 0.0, 0.0, 17.0, 0.0, 48.0, 67.0, -356.0, 0.0, -17.0, -39.0, 0.0, 0.0, -29.0, -125.0, -37.0, -24.0, 0.0, 0.0, 6.0, -138.0, 41.0, 0.0, -612.0, 38.0, -108.0, 0.0, -39.0, -193.0, -106.0, -97.0, 0.0, 0.0, 10.0, -31.0, -25.0, 0.0, -61.0, 0.0, 17.0, -57.0, -3.0, -2.0, -21.0, 0.0, -14.0, 0.0, 0.0, 0.0, -159.0, -88.0, -24.0, -56.0, -55.0, -205.0, 0.0, -11.0, 0.0, 0.0, 1.0, 78.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -17.0, -8.0, 0.0, 0.0, -131.0, 1.0, -15.0, -10.0, -13.0, 0.0, -18.0, 0.0, 1.0], "policy_predator_policy_reward": [0.0, 39.0, 39.0, 14.0, 0.0, 61.0, 114.0, 102.0, 0.0, 0.0, 0.0, 2.0, 11.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 61.0, 9.0, 2.0, 41.0, 0.0, 21.0, 40.0, 0.0, 0.0, 1.0, 50.0, 0.0, 2.0, 69.0, 56.0, 200.0, 19.0, 6.0, 0.0, 19.0, 77.0, 5.0, 3.0, 11.0, 75.0, 0.0, 0.0, 0.0, 2.0, 20.0, 46.0, 2.0, 7.0, 13.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 3.0, 15.0, 61.0, 32.0, 0.0, 4.0, 0.0, 0.0, 1.0, 25.0, 0.0, 6.0, 30.0, 54.0, 0.0, 44.0, 18.0, 0.0, 6.0, 64.0, 0.0, 59.0, 28.0, 44.0, 40.0, 57.0, 0.0, 16.0, 24.0, 14.0, 98.0, 3.0, 0.0, 0.0, 0.0, 38.0, 81.0, 37.0, 0.0, 114.0, 29.0, 0.0, 70.0, 61.0, 30.0, 6.0, 191.0, 0.0, 14.0, 0.0, 54.0, 32.0, 73.0, 69.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 178.0, 0.0, 31.0, 21.0, 0.0, 0.0, 46.0, 70.0, 13.0, 21.0, 0.0, 0.0, 84.0, 63.0, 0.0, 4.0, 466.0, 0.0, 33.0, 56.0, 123.0, 26.0, 95.0, 43.0, 0.0, 0.0, 23.0, 13.0, 0.0, 18.0, 37.0, 0.0, 32.0, 15.0, 2.0, 1.0, 17.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 133.0, 13.0, 43.0, 152.0, 0.0, 0.0, 8.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 36.0, 1.0, 4.0, 2.0, 70.0, 35.0, 0.0, 41.0, 40.0, 0.0, 0.0, 9.0, 0.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.151662836194596, "mean_inference_ms": 3.536773432740395, "mean_action_processing_ms": 0.5136000435308805, "mean_env_wait_ms": 0.41225274640962345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01531517505645752, "StateBufferConnector_ms": 0.007763385772705078, "ViewRequirementAgentConnector_ms": 0.20842134952545166}, "num_episodes": 23, "episode_return_max": 151.0, "episode_return_min": -412.0, "episode_return_mean": -4.22, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.1429915398139, "num_env_steps_trained_throughput_per_sec": 286.1429915398139, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 2336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2336000, "timers": {"training_iteration_time_ms": 14686.623, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14686.574, "sample_time_ms": 2603.197, "learn_time_ms": 12060.894, "learn_throughput": 331.65, "synch_weights_time_ms": 20.154}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000}, "done": false, "training_iteration": 146, "trial_id": "e1352_00002", "date": "2024-08-13_19-53-55", "timestamp": 1723593235, "time_this_iter_s": 14.025912761688232, "time_total_s": 3119.851590871811, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3119.851590871811, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 78.33, "ram_util_percent": 83.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9496945222691884, "cur_kl_coeff": 0.0675762176513672, "cur_lr": 0.00010000000000000003, "total_loss": 2.5452589531424183, "policy_loss": -0.0008162020359474121, "vf_loss": 2.54568274368054, "vf_explained_var": -0.003312935368724601, "kl": 0.005806955454981169, "entropy": 0.7966200019316698, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 276885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.694811808652979, "cur_kl_coeff": 0.00902033618185669, "cur_lr": 0.00010000000000000003, "total_loss": 2.5842556843681943, "policy_loss": -0.0019747063995550866, "vf_loss": 2.5861476140678246, "vf_explained_var": -0.00030103328997495944, "kl": 0.00917598382800414, "entropy": 0.9895080479049178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 276885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "env_runners": {"episode_reward_max": 151.0, "episode_reward_min": -178.0, "episode_reward_mean": -8.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -612.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 111.0, "predator_policy": 466.0}, "policy_reward_mean": {"prey_policy": -28.93, "predator_policy": 24.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0, 151.0, 5.0, 68.0, 45.0, 0.0, 0.0, 41.0, 0.0, 85.0, -33.0, 80.0, 84.0, 120.0, 87.0, -1.0, 13.0, -21.0, -1.0, -14.0, -23.0, 24.0, -15.0, 39.0, -154.0, -3.0, 68.0, -34.0, -21.0, -89.0, -46.0, -79.0, -134.0, 150.0, -14.0, -88.0, -31.0, 0.0, 26.0, 115.0, -178.0, -4.0, 0.0, -38.0, -27.0, 0.0, 15.0, 45.0, -108.0, -19.0, -83.0, -65.0, 0.0, 15.0, -7.0, -24.0, 7.0, -2.0, -4.0, -7.0, 0.0, -114.0, -24.0, -108.0, -3.0, 0.0, 83.0, 0.0, 0.0, 0.0, -4.0, 20.0, -2.0, -26.0, 27.0, 17.0, -9.0, 3.0, 0.0, 8.0, -36.0, -36.0, 4.0, -160.0, 0.0, -55.0, -5.0, 0.0, -10.0, -148.0, -5.0, 0.0, 22.0, 0.0, -21.0, 28.0, 6.0, -101.0, -111.0, -6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [44.0, 0.0, 80.0, 69.0, -84.0, 23.0, 26.0, 33.0, 15.0, 13.0, 0.0, 0.0, 0.0, 0.0, 41.0, 0.0, 0.0, 0.0, 59.0, -14.0, -109.0, 0.0, 6.0, 42.0, 0.0, 80.0, 91.0, 28.0, 69.0, -7.0, -37.0, 0.0, -9.0, -32.0, 0.0, -83.0, -12.0, 5.0, -4.0, -74.0, -7.0, -103.0, -54.0, -6.0, -72.0, 0.0, 0.0, -1.0, -157.0, -109.0, -6.0, 0.0, 0.0, 68.0, -107.0, -46.0, 0.0, -58.0, -220.0, -12.0, -16.0, -100.0, -99.0, -71.0, 51.0, -382.0, 111.0, 25.0, -60.0, -8.0, -53.0, -140.0, -42.0, -58.0, 0.0, 0.0, 17.0, 0.0, 48.0, 67.0, -356.0, 0.0, -17.0, -39.0, 0.0, 0.0, -29.0, -125.0, -37.0, -24.0, 0.0, 0.0, 6.0, -138.0, 41.0, 0.0, -612.0, 38.0, -108.0, 0.0, -39.0, -193.0, -106.0, -97.0, 0.0, 0.0, 10.0, -31.0, -25.0, 0.0, -61.0, 0.0, 17.0, -57.0, -3.0, -2.0, -21.0, 0.0, -14.0, 0.0, 0.0, 0.0, -159.0, -88.0, -24.0, -56.0, -55.0, -205.0, 0.0, -11.0, 0.0, 0.0, 1.0, 78.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -17.0, -8.0, 0.0, 0.0, -131.0, 1.0, -15.0, -10.0, -13.0, 0.0, -18.0, 0.0, 1.0, 0.0, 0.0, -6.0, -30.0, -77.0, 1.0, -90.0, -4.0, 0.0, 0.0, 16.0, -352.0, 0.0, 0.0, -140.0, -2.0, -10.0, 0.0, 0.0, 0.0, 14.0, -52.0, 0.0, -296.0, 0.0, -10.0, 0.0, 0.0, 20.0, 0.0, -29.0, -9.0, -49.0, 0.0, -4.0, 0.0, -19.0, 0.0, -278.0, 38.0, -242.0, 3.0, -79.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 2.0, 20.0, 46.0, 2.0, 7.0, 13.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 3.0, 15.0, 61.0, 32.0, 0.0, 4.0, 0.0, 0.0, 1.0, 25.0, 0.0, 6.0, 30.0, 54.0, 0.0, 44.0, 18.0, 0.0, 6.0, 64.0, 0.0, 59.0, 28.0, 44.0, 40.0, 57.0, 0.0, 16.0, 24.0, 14.0, 98.0, 3.0, 0.0, 0.0, 0.0, 38.0, 81.0, 37.0, 0.0, 114.0, 29.0, 0.0, 70.0, 61.0, 30.0, 6.0, 191.0, 0.0, 14.0, 0.0, 54.0, 32.0, 73.0, 69.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 178.0, 0.0, 31.0, 21.0, 0.0, 0.0, 46.0, 70.0, 13.0, 21.0, 0.0, 0.0, 84.0, 63.0, 0.0, 4.0, 466.0, 0.0, 33.0, 56.0, 123.0, 26.0, 95.0, 43.0, 0.0, 0.0, 23.0, 13.0, 0.0, 18.0, 37.0, 0.0, 32.0, 15.0, 2.0, 1.0, 17.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 133.0, 13.0, 43.0, 152.0, 0.0, 0.0, 8.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 36.0, 1.0, 4.0, 2.0, 70.0, 35.0, 0.0, 41.0, 40.0, 0.0, 0.0, 9.0, 0.0, 2.0, 0.0, 0.0, 21.0, 23.0, 0.0, 40.0, 51.0, 7.0, 0.0, 4.0, 0.0, 176.0, 0.0, 0.0, 62.0, 25.0, 5.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 148.0, 5.0, 0.0, 0.0, 0.0, 0.0, 2.0, 6.0, 32.0, 20.0, 8.0, 0.0, 32.0, 25.0, 0.0, 0.0, 139.0, 7.0, 121.0, 42.0, 31.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1535405806605785, "mean_inference_ms": 3.541011934211175, "mean_action_processing_ms": 0.5139465790253323, "mean_env_wait_ms": 0.4127115630274767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012861251831054688, "StateBufferConnector_ms": 0.0077893733978271484, "ViewRequirementAgentConnector_ms": 0.22929608821868896}, "num_episodes": 22, "episode_return_max": 151.0, "episode_return_min": -178.0, "episode_return_mean": -8.06, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 220.51786291302437, "num_env_steps_trained_throughput_per_sec": 220.51786291302437, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 2352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2352000, "timers": {"training_iteration_time_ms": 15074.42, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15074.366, "sample_time_ms": 2822.187, "learn_time_ms": 12229.257, "learn_throughput": 327.084, "synch_weights_time_ms": 20.304}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "done": false, "training_iteration": 147, "trial_id": "e1352_00002", "date": "2024-08-13_19-54-13", "timestamp": 1723593253, "time_this_iter_s": 18.218651294708252, "time_total_s": 3138.070242166519, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e421f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3138.070242166519, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 87.00400000000002, "ram_util_percent": 83.78399999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.007573368392451, "cur_kl_coeff": 0.0675762176513672, "cur_lr": 0.00010000000000000003, "total_loss": 1.7573340815526468, "policy_loss": -2.8257186292971254e-05, "vf_loss": 1.7571629967323688, "vf_explained_var": -0.0005471171525420335, "kl": 0.0029499085986970106, "entropy": 0.8650429096802202, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 278775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2136399463765204, "cur_kl_coeff": 0.00902033618185669, "cur_lr": 0.00010000000000000003, "total_loss": 1.9191990713278453, "policy_loss": -0.0023343593531371977, "vf_loss": 1.921433715624784, "vf_explained_var": -0.00040150086085001627, "kl": 0.011054442932509501, "entropy": 0.9730980299137256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 278775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000}, "env_runners": {"episode_reward_max": 150.0, "episode_reward_min": -190.0, "episode_reward_mean": -19.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1434.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 111.0, "predator_policy": 1382.0}, "policy_reward_mean": {"prey_policy": -42.825, "predator_policy": 32.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -14.0, -23.0, 24.0, -15.0, 39.0, -154.0, -3.0, 68.0, -34.0, -21.0, -89.0, -46.0, -79.0, -134.0, 150.0, -14.0, -88.0, -31.0, 0.0, 26.0, 115.0, -178.0, -4.0, 0.0, -38.0, -27.0, 0.0, 15.0, 45.0, -108.0, -19.0, -83.0, -65.0, 0.0, 15.0, -7.0, -24.0, 7.0, -2.0, -4.0, -7.0, 0.0, -114.0, -24.0, -108.0, -3.0, 0.0, 83.0, 0.0, 0.0, 0.0, -4.0, 20.0, -2.0, -26.0, 27.0, 17.0, -9.0, 3.0, 0.0, 8.0, -36.0, -36.0, 4.0, -160.0, 0.0, -55.0, -5.0, 0.0, -10.0, -148.0, -5.0, 0.0, 22.0, 0.0, -21.0, 28.0, 6.0, -101.0, -111.0, -6.0, 1.0, -8.0, -20.0, -35.0, 5.0, 18.0, 3.0, -16.0, 20.0, -45.0, -54.0, 29.0, 17.0, -26.0, 8.0, -190.0, 9.0, -122.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.0, 5.0, -4.0, -74.0, -7.0, -103.0, -54.0, -6.0, -72.0, 0.0, 0.0, -1.0, -157.0, -109.0, -6.0, 0.0, 0.0, 68.0, -107.0, -46.0, 0.0, -58.0, -220.0, -12.0, -16.0, -100.0, -99.0, -71.0, 51.0, -382.0, 111.0, 25.0, -60.0, -8.0, -53.0, -140.0, -42.0, -58.0, 0.0, 0.0, 17.0, 0.0, 48.0, 67.0, -356.0, 0.0, -17.0, -39.0, 0.0, 0.0, -29.0, -125.0, -37.0, -24.0, 0.0, 0.0, 6.0, -138.0, 41.0, 0.0, -612.0, 38.0, -108.0, 0.0, -39.0, -193.0, -106.0, -97.0, 0.0, 0.0, 10.0, -31.0, -25.0, 0.0, -61.0, 0.0, 17.0, -57.0, -3.0, -2.0, -21.0, 0.0, -14.0, 0.0, 0.0, 0.0, -159.0, -88.0, -24.0, -56.0, -55.0, -205.0, 0.0, -11.0, 0.0, 0.0, 1.0, 78.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -17.0, -8.0, 0.0, 0.0, -131.0, 1.0, -15.0, -10.0, -13.0, 0.0, -18.0, 0.0, 1.0, 0.0, 0.0, -6.0, -30.0, -77.0, 1.0, -90.0, -4.0, 0.0, 0.0, 16.0, -352.0, 0.0, 0.0, -140.0, -2.0, -10.0, 0.0, 0.0, 0.0, 14.0, -52.0, 0.0, -296.0, 0.0, -10.0, 0.0, 0.0, 20.0, 0.0, -29.0, -9.0, -49.0, 0.0, -4.0, 0.0, -19.0, 0.0, -278.0, 38.0, -242.0, 3.0, -79.0, 0.0, 1.0, 0.0, -16.0, 0.0, -54.0, 0.0, -25.0, -30.0, 0.0, 5.0, 16.0, 2.0, -9.0, 0.0, -26.0, -6.0, -8.0, 0.0, -129.0, 0.0, -140.0, 0.0, 17.0, 12.0, 8.0, -5.0, 9.0, -1434.0, -10.0, 2.0, -380.0, 0.0, 0.0, 9.0, -244.0, 0.0], "policy_predator_policy_reward": [0.0, 6.0, 64.0, 0.0, 59.0, 28.0, 44.0, 40.0, 57.0, 0.0, 16.0, 24.0, 14.0, 98.0, 3.0, 0.0, 0.0, 0.0, 38.0, 81.0, 37.0, 0.0, 114.0, 29.0, 0.0, 70.0, 61.0, 30.0, 6.0, 191.0, 0.0, 14.0, 0.0, 54.0, 32.0, 73.0, 69.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 178.0, 0.0, 31.0, 21.0, 0.0, 0.0, 46.0, 70.0, 13.0, 21.0, 0.0, 0.0, 84.0, 63.0, 0.0, 4.0, 466.0, 0.0, 33.0, 56.0, 123.0, 26.0, 95.0, 43.0, 0.0, 0.0, 23.0, 13.0, 0.0, 18.0, 37.0, 0.0, 32.0, 15.0, 2.0, 1.0, 17.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 133.0, 13.0, 43.0, 152.0, 0.0, 0.0, 8.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 36.0, 1.0, 4.0, 2.0, 70.0, 35.0, 0.0, 41.0, 40.0, 0.0, 0.0, 9.0, 0.0, 2.0, 0.0, 0.0, 21.0, 23.0, 0.0, 40.0, 51.0, 7.0, 0.0, 4.0, 0.0, 176.0, 0.0, 0.0, 62.0, 25.0, 5.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 148.0, 5.0, 0.0, 0.0, 0.0, 0.0, 2.0, 6.0, 32.0, 20.0, 8.0, 0.0, 32.0, 25.0, 0.0, 0.0, 139.0, 7.0, 121.0, 42.0, 31.0, 0.0, 0.0, 0.0, 8.0, 6.0, 28.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 13.0, 3.0, 13.0, 15.0, 40.0, 44.0, 75.0, 11.0, 0.0, 0.0, 0.0, 14.0, 17.0, 1382.0, 7.0, 9.0, 190.0, 0.0, 0.0, 0.0, 122.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1554408972584407, "mean_inference_ms": 3.546687117463226, "mean_action_processing_ms": 0.5145059022417895, "mean_env_wait_ms": 0.4134625393786881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012214303016662598, "StateBufferConnector_ms": 0.007573962211608887, "ViewRequirementAgentConnector_ms": 0.22382879257202148}, "num_episodes": 18, "episode_return_max": 150.0, "episode_return_min": -190.0, "episode_return_mean": -19.8, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.983121149404, "num_env_steps_trained_throughput_per_sec": 271.983121149404, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 2368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2368000, "timers": {"training_iteration_time_ms": 15107.315, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15107.262, "sample_time_ms": 2737.56, "learn_time_ms": 12346.681, "learn_throughput": 323.974, "synch_weights_time_ms": 20.437}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000}, "done": false, "training_iteration": 148, "trial_id": "e1352_00002", "date": "2024-08-13_19-54-28", "timestamp": 1723593268, "time_this_iter_s": 14.776725053787231, "time_total_s": 3152.8469672203064, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d44820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3152.8469672203064, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 86.20476190476191, "ram_util_percent": 83.88095238095238}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3447152549312227, "cur_kl_coeff": 0.0337881088256836, "cur_lr": 0.00010000000000000003, "total_loss": 1.878502079040285, "policy_loss": -0.002260369073264498, "vf_loss": 1.8804525813413044, "vf_explained_var": -0.0016077380962472743, "kl": 0.00917087480795577, "entropy": 0.8525463479851919, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 280665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.802215875062362, "cur_kl_coeff": 0.00902033618185669, "cur_lr": 0.00010000000000000003, "total_loss": 1.9321411594354287, "policy_loss": -0.0037219847779149415, "vf_loss": 1.935751254691018, "vf_explained_var": -0.009818563606373216, "kl": 0.012404089683468409, "entropy": 0.9863252270158637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 280665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 2384000}, "env_runners": {"episode_reward_max": 115.0, "episode_reward_min": -190.0, "episode_reward_mean": -17.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1434.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 78.0, "predator_policy": 1382.0}, "policy_reward_mean": {"prey_policy": -37.965, "predator_policy": 28.985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.0, 0.0, 26.0, 115.0, -178.0, -4.0, 0.0, -38.0, -27.0, 0.0, 15.0, 45.0, -108.0, -19.0, -83.0, -65.0, 0.0, 15.0, -7.0, -24.0, 7.0, -2.0, -4.0, -7.0, 0.0, -114.0, -24.0, -108.0, -3.0, 0.0, 83.0, 0.0, 0.0, 0.0, -4.0, 20.0, -2.0, -26.0, 27.0, 17.0, -9.0, 3.0, 0.0, 8.0, -36.0, -36.0, 4.0, -160.0, 0.0, -55.0, -5.0, 0.0, -10.0, -148.0, -5.0, 0.0, 22.0, 0.0, -21.0, 28.0, 6.0, -101.0, -111.0, -6.0, 1.0, -8.0, -20.0, -35.0, 5.0, 18.0, 3.0, -16.0, 20.0, -45.0, -54.0, 29.0, 17.0, -26.0, 8.0, -190.0, 9.0, -122.0, 3.0, -6.0, 4.0, 22.0, -13.0, -2.0, 19.0, 3.0, -7.0, -1.0, 0.0, 18.0, -23.0, -12.0, -15.0, -185.0, -53.0, -2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-42.0, -58.0, 0.0, 0.0, 17.0, 0.0, 48.0, 67.0, -356.0, 0.0, -17.0, -39.0, 0.0, 0.0, -29.0, -125.0, -37.0, -24.0, 0.0, 0.0, 6.0, -138.0, 41.0, 0.0, -612.0, 38.0, -108.0, 0.0, -39.0, -193.0, -106.0, -97.0, 0.0, 0.0, 10.0, -31.0, -25.0, 0.0, -61.0, 0.0, 17.0, -57.0, -3.0, -2.0, -21.0, 0.0, -14.0, 0.0, 0.0, 0.0, -159.0, -88.0, -24.0, -56.0, -55.0, -205.0, 0.0, -11.0, 0.0, 0.0, 1.0, 78.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -17.0, -8.0, 0.0, 0.0, -131.0, 1.0, -15.0, -10.0, -13.0, 0.0, -18.0, 0.0, 1.0, 0.0, 0.0, -6.0, -30.0, -77.0, 1.0, -90.0, -4.0, 0.0, 0.0, 16.0, -352.0, 0.0, 0.0, -140.0, -2.0, -10.0, 0.0, 0.0, 0.0, 14.0, -52.0, 0.0, -296.0, 0.0, -10.0, 0.0, 0.0, 20.0, 0.0, -29.0, -9.0, -49.0, 0.0, -4.0, 0.0, -19.0, 0.0, -278.0, 38.0, -242.0, 3.0, -79.0, 0.0, 1.0, 0.0, -16.0, 0.0, -54.0, 0.0, -25.0, -30.0, 0.0, 5.0, 16.0, 2.0, -9.0, 0.0, -26.0, -6.0, -8.0, 0.0, -129.0, 0.0, -140.0, 0.0, 17.0, 12.0, 8.0, -5.0, 9.0, -1434.0, -10.0, 2.0, -380.0, 0.0, 0.0, 9.0, -244.0, 0.0, 0.0, 3.0, -24.0, 6.0, 0.0, 4.0, -37.0, 0.0, -75.0, 15.0, 0.0, -7.0, 10.0, 8.0, -11.0, -26.0, 0.0, -17.0, 0.0, -2.0, 0.0, 0.0, 0.0, 18.0, -39.0, -26.0, 0.0, -111.0, -30.0, 0.0, -118.0, -136.0, 0.0, -140.0, -10.0, 0.0], "policy_predator_policy_reward": [69.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 178.0, 0.0, 31.0, 21.0, 0.0, 0.0, 46.0, 70.0, 13.0, 21.0, 0.0, 0.0, 84.0, 63.0, 0.0, 4.0, 466.0, 0.0, 33.0, 56.0, 123.0, 26.0, 95.0, 43.0, 0.0, 0.0, 23.0, 13.0, 0.0, 18.0, 37.0, 0.0, 32.0, 15.0, 2.0, 1.0, 17.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 133.0, 13.0, 43.0, 152.0, 0.0, 0.0, 8.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 36.0, 1.0, 4.0, 2.0, 70.0, 35.0, 0.0, 41.0, 40.0, 0.0, 0.0, 9.0, 0.0, 2.0, 0.0, 0.0, 21.0, 23.0, 0.0, 40.0, 51.0, 7.0, 0.0, 4.0, 0.0, 176.0, 0.0, 0.0, 62.0, 25.0, 5.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 148.0, 5.0, 0.0, 0.0, 0.0, 0.0, 2.0, 6.0, 32.0, 20.0, 8.0, 0.0, 32.0, 25.0, 0.0, 0.0, 139.0, 7.0, 121.0, 42.0, 31.0, 0.0, 0.0, 0.0, 8.0, 6.0, 28.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 13.0, 3.0, 13.0, 15.0, 40.0, 44.0, 75.0, 11.0, 0.0, 0.0, 0.0, 14.0, 17.0, 1382.0, 7.0, 9.0, 190.0, 0.0, 0.0, 0.0, 122.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 27.0, 32.0, 0.0, 47.0, 5.0, 0.0, 0.0, 1.0, 0.0, 40.0, 0.0, 10.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 42.0, 0.0, 40.0, 59.0, 15.0, 0.0, 69.0, 0.0, 20.0, 67.0, 3.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1572917256733843, "mean_inference_ms": 3.551754683271121, "mean_action_processing_ms": 0.5149934004590607, "mean_env_wait_ms": 0.41402306273448275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015756607055664062, "StateBufferConnector_ms": 0.007999300956726074, "ViewRequirementAgentConnector_ms": 0.22176337242126465}, "num_episodes": 18, "episode_return_max": 115.0, "episode_return_min": -190.0, "episode_return_mean": -17.96, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 2384000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.65065457074, "num_env_steps_trained_throughput_per_sec": 277.65065457074, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 2384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2384000, "timers": {"training_iteration_time_ms": 15087.57, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15087.516, "sample_time_ms": 2786.862, "learn_time_ms": 12277.921, "learn_throughput": 325.788, "synch_weights_time_ms": 20.075}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 2384000}, "done": false, "training_iteration": 149, "trial_id": "e1352_00002", "date": "2024-08-13_19-54-42", "timestamp": 1723593282, "time_this_iter_s": 14.481895208358765, "time_total_s": 3167.328862428665, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d44160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3167.328862428665, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 87.15714285714287, "ram_util_percent": 83.73333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3432276279088997, "cur_kl_coeff": 0.0337881088256836, "cur_lr": 0.00010000000000000003, "total_loss": 0.3415339595426327, "policy_loss": -0.0005720871349146205, "vf_loss": 0.3418307996326663, "vf_explained_var": -0.0027655944937751407, "kl": 0.008146261399456824, "entropy": 0.9182356407718053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 282555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8512329047516225, "cur_kl_coeff": 0.00902033618185669, "cur_lr": 0.00010000000000000003, "total_loss": 0.47681690137488425, "policy_loss": -0.0031973903542926543, "vf_loss": 0.47993088067588074, "vf_explained_var": -0.008115661396551385, "kl": 0.009246903687327718, "entropy": 0.922015410346329, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 282555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 83.0, "episode_reward_min": -191.0, "episode_reward_mean": -18.09, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1434.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 78.0, "predator_policy": 1382.0}, "policy_reward_mean": {"prey_policy": -33.43, "predator_policy": 24.385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.0, 0.0, -114.0, -24.0, -108.0, -3.0, 0.0, 83.0, 0.0, 0.0, 0.0, -4.0, 20.0, -2.0, -26.0, 27.0, 17.0, -9.0, 3.0, 0.0, 8.0, -36.0, -36.0, 4.0, -160.0, 0.0, -55.0, -5.0, 0.0, -10.0, -148.0, -5.0, 0.0, 22.0, 0.0, -21.0, 28.0, 6.0, -101.0, -111.0, -6.0, 1.0, -8.0, -20.0, -35.0, 5.0, 18.0, 3.0, -16.0, 20.0, -45.0, -54.0, 29.0, 17.0, -26.0, 8.0, -190.0, 9.0, -122.0, 3.0, -6.0, 4.0, 22.0, -13.0, -2.0, 19.0, 3.0, -7.0, -1.0, 0.0, 18.0, -23.0, -12.0, -15.0, -185.0, -53.0, -2.0, -14.0, 13.0, 0.0, -5.0, -18.0, 0.0, -191.0, 0.0, 4.0, -1.0, 0.0, 7.0, 21.0, 0.0, -3.0, 5.0, 4.0, -18.0, -16.0, -4.0, -177.0, 1.0, 12.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.0, 0.0, 0.0, 0.0, -159.0, -88.0, -24.0, -56.0, -55.0, -205.0, 0.0, -11.0, 0.0, 0.0, 1.0, 78.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -17.0, -8.0, 0.0, 0.0, -131.0, 1.0, -15.0, -10.0, -13.0, 0.0, -18.0, 0.0, 1.0, 0.0, 0.0, -6.0, -30.0, -77.0, 1.0, -90.0, -4.0, 0.0, 0.0, 16.0, -352.0, 0.0, 0.0, -140.0, -2.0, -10.0, 0.0, 0.0, 0.0, 14.0, -52.0, 0.0, -296.0, 0.0, -10.0, 0.0, 0.0, 20.0, 0.0, -29.0, -9.0, -49.0, 0.0, -4.0, 0.0, -19.0, 0.0, -278.0, 38.0, -242.0, 3.0, -79.0, 0.0, 1.0, 0.0, -16.0, 0.0, -54.0, 0.0, -25.0, -30.0, 0.0, 5.0, 16.0, 2.0, -9.0, 0.0, -26.0, -6.0, -8.0, 0.0, -129.0, 0.0, -140.0, 0.0, 17.0, 12.0, 8.0, -5.0, 9.0, -1434.0, -10.0, 2.0, -380.0, 0.0, 0.0, 9.0, -244.0, 0.0, 0.0, 3.0, -24.0, 6.0, 0.0, 4.0, -37.0, 0.0, -75.0, 15.0, 0.0, -7.0, 10.0, 8.0, -11.0, -26.0, 0.0, -17.0, 0.0, -2.0, 0.0, 0.0, 0.0, 18.0, -39.0, -26.0, 0.0, -111.0, -30.0, 0.0, -118.0, -136.0, 0.0, -140.0, -10.0, 0.0, 0.0, -29.0, 10.0, 2.0, 0.0, 0.0, 0.0, -10.0, 26.0, -115.0, 0.0, 0.0, -382.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, -79.0, 0.0, 4.0, 13.0, 0.0, 0.0, -55.0, 0.0, 0.0, 2.0, -6.0, 7.0, -32.0, -29.0, -34.0, -5.0, 0.0, -8.0, -18.0, -336.0, 0.0, -3.0, 12.0, 0.0], "policy_predator_policy_reward": [7.0, 0.0, 0.0, 0.0, 0.0, 133.0, 13.0, 43.0, 152.0, 0.0, 0.0, 8.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 36.0, 1.0, 4.0, 2.0, 70.0, 35.0, 0.0, 41.0, 40.0, 0.0, 0.0, 9.0, 0.0, 2.0, 0.0, 0.0, 21.0, 23.0, 0.0, 40.0, 51.0, 7.0, 0.0, 4.0, 0.0, 176.0, 0.0, 0.0, 62.0, 25.0, 5.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 148.0, 5.0, 0.0, 0.0, 0.0, 0.0, 2.0, 6.0, 32.0, 20.0, 8.0, 0.0, 32.0, 25.0, 0.0, 0.0, 139.0, 7.0, 121.0, 42.0, 31.0, 0.0, 0.0, 0.0, 8.0, 6.0, 28.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 13.0, 3.0, 13.0, 15.0, 40.0, 44.0, 75.0, 11.0, 0.0, 0.0, 0.0, 14.0, 17.0, 1382.0, 7.0, 9.0, 190.0, 0.0, 0.0, 0.0, 122.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 27.0, 32.0, 0.0, 47.0, 5.0, 0.0, 0.0, 1.0, 0.0, 40.0, 0.0, 10.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 42.0, 0.0, 40.0, 59.0, 15.0, 0.0, 69.0, 0.0, 20.0, 67.0, 3.0, 5.0, 0.0, 15.0, 0.0, 1.0, 0.0, 0.0, 0.0, 5.0, 71.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 0.0, 4.0, 2.0, 1.0, 0.0, 0.0, 40.0, 46.0, 0.0, 4.0, 0.0, 0.0, 27.0, 25.0, 0.0, 3.0, 0.0, 3.0, 0.0, 43.0, 23.0, 0.0, 4.0, 0.0, 9.0, 168.0, 0.0, 4.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1566345963151103, "mean_inference_ms": 3.5567492610293865, "mean_action_processing_ms": 0.5149101905777939, "mean_env_wait_ms": 0.41445731739334013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009393095970153809, "StateBufferConnector_ms": 0.0049353837966918945, "ViewRequirementAgentConnector_ms": 0.18087351322174072}, "num_episodes": 23, "episode_return_max": 83.0, "episode_return_min": -191.0, "episode_return_mean": -18.09, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.9372660557963, "num_env_steps_trained_throughput_per_sec": 297.9372660557963, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 14908.321, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14908.27, "sample_time_ms": 2765.95, "learn_time_ms": 12119.976, "learn_throughput": 330.034, "synch_weights_time_ms": 19.856}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": false, "training_iteration": 150, "trial_id": "e1352_00002", "date": "2024-08-13_19-54-56", "timestamp": 1723593296, "time_this_iter_s": 13.48413610458374, "time_total_s": 3180.812998533249, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1681550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3180.812998533249, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 83.36842105263158, "ram_util_percent": 83.8578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.489099879373634, "cur_kl_coeff": 0.0337881088256836, "cur_lr": 0.00010000000000000003, "total_loss": 0.5736605479288354, "policy_loss": -0.001616683965253215, "vf_loss": 0.5749984508744939, "vf_explained_var": 0.0038402257457612055, "kl": 0.008250834903556674, "entropy": 0.8703044844998253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 284445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2544521535120943, "cur_kl_coeff": 0.00902033618185669, "cur_lr": 0.00010000000000000003, "total_loss": 0.7867544653189181, "policy_loss": -0.002055291269989635, "vf_loss": 0.7887430984191793, "vf_explained_var": -0.02496438146268249, "kl": 0.007389771902132339, "entropy": 0.9430983557902947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 284445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 2416000}, "env_runners": {"episode_reward_max": 44.0, "episode_reward_min": -191.0, "episode_reward_mean": -16.11, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1434.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 44.0, "predator_policy": 1382.0}, "policy_reward_mean": {"prey_policy": -30.765, "predator_policy": 22.71}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, 0.0, 8.0, -36.0, -36.0, 4.0, -160.0, 0.0, -55.0, -5.0, 0.0, -10.0, -148.0, -5.0, 0.0, 22.0, 0.0, -21.0, 28.0, 6.0, -101.0, -111.0, -6.0, 1.0, -8.0, -20.0, -35.0, 5.0, 18.0, 3.0, -16.0, 20.0, -45.0, -54.0, 29.0, 17.0, -26.0, 8.0, -190.0, 9.0, -122.0, 3.0, -6.0, 4.0, 22.0, -13.0, -2.0, 19.0, 3.0, -7.0, -1.0, 0.0, 18.0, -23.0, -12.0, -15.0, -185.0, -53.0, -2.0, -14.0, 13.0, 0.0, -5.0, -18.0, 0.0, -191.0, 0.0, 4.0, -1.0, 0.0, 7.0, 21.0, 0.0, -3.0, 5.0, 4.0, -18.0, -16.0, -4.0, -177.0, 1.0, 12.0, 17.0, 2.0, -36.0, 0.0, -2.0, -4.0, 0.0, 44.0, -26.0, 2.0, 13.0, 0.0, 5.0, 43.0, 7.0, -13.0, -10.0, 6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 1.0, 0.0, 0.0, -6.0, -30.0, -77.0, 1.0, -90.0, -4.0, 0.0, 0.0, 16.0, -352.0, 0.0, 0.0, -140.0, -2.0, -10.0, 0.0, 0.0, 0.0, 14.0, -52.0, 0.0, -296.0, 0.0, -10.0, 0.0, 0.0, 20.0, 0.0, -29.0, -9.0, -49.0, 0.0, -4.0, 0.0, -19.0, 0.0, -278.0, 38.0, -242.0, 3.0, -79.0, 0.0, 1.0, 0.0, -16.0, 0.0, -54.0, 0.0, -25.0, -30.0, 0.0, 5.0, 16.0, 2.0, -9.0, 0.0, -26.0, -6.0, -8.0, 0.0, -129.0, 0.0, -140.0, 0.0, 17.0, 12.0, 8.0, -5.0, 9.0, -1434.0, -10.0, 2.0, -380.0, 0.0, 0.0, 9.0, -244.0, 0.0, 0.0, 3.0, -24.0, 6.0, 0.0, 4.0, -37.0, 0.0, -75.0, 15.0, 0.0, -7.0, 10.0, 8.0, -11.0, -26.0, 0.0, -17.0, 0.0, -2.0, 0.0, 0.0, 0.0, 18.0, -39.0, -26.0, 0.0, -111.0, -30.0, 0.0, -118.0, -136.0, 0.0, -140.0, -10.0, 0.0, 0.0, -29.0, 10.0, 2.0, 0.0, 0.0, 0.0, -10.0, 26.0, -115.0, 0.0, 0.0, -382.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, -79.0, 0.0, 4.0, 13.0, 0.0, 0.0, -55.0, 0.0, 0.0, 2.0, -6.0, 7.0, -32.0, -29.0, -34.0, -5.0, 0.0, -8.0, -18.0, -336.0, 0.0, -3.0, 12.0, 0.0, 17.0, 0.0, 0.0, -8.0, -7.0, -75.0, 0.0, 0.0, 0.0, -5.0, 0.0, -11.0, 0.0, 0.0, 0.0, 44.0, -37.0, -72.0, -53.0, 9.0, 0.0, 13.0, 0.0, 0.0, -29.0, 0.0, 13.0, 30.0, 1.0, -1.0, -34.0, 0.0, 0.0, -20.0, 0.0, 6.0], "policy_predator_policy_reward": [0.0, 2.0, 0.0, 0.0, 21.0, 23.0, 0.0, 40.0, 51.0, 7.0, 0.0, 4.0, 0.0, 176.0, 0.0, 0.0, 62.0, 25.0, 5.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 148.0, 5.0, 0.0, 0.0, 0.0, 0.0, 2.0, 6.0, 32.0, 20.0, 8.0, 0.0, 32.0, 25.0, 0.0, 0.0, 139.0, 7.0, 121.0, 42.0, 31.0, 0.0, 0.0, 0.0, 8.0, 6.0, 28.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 13.0, 3.0, 13.0, 15.0, 40.0, 44.0, 75.0, 11.0, 0.0, 0.0, 0.0, 14.0, 17.0, 1382.0, 7.0, 9.0, 190.0, 0.0, 0.0, 0.0, 122.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 27.0, 32.0, 0.0, 47.0, 5.0, 0.0, 0.0, 1.0, 0.0, 40.0, 0.0, 10.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 42.0, 0.0, 40.0, 59.0, 15.0, 0.0, 69.0, 0.0, 20.0, 67.0, 3.0, 5.0, 0.0, 15.0, 0.0, 1.0, 0.0, 0.0, 0.0, 5.0, 71.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 0.0, 4.0, 2.0, 1.0, 0.0, 0.0, 40.0, 46.0, 0.0, 4.0, 0.0, 0.0, 27.0, 25.0, 0.0, 3.0, 0.0, 3.0, 0.0, 43.0, 23.0, 0.0, 4.0, 0.0, 9.0, 168.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 41.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 41.0, 42.0, 15.0, 31.0, 0.0, 0.0, 0.0, 0.0, 26.0, 8.0, 0.0, 0.0, 0.0, 7.0, 12.0, 9.0, 10.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.158611809763212, "mean_inference_ms": 3.5553890675900903, "mean_action_processing_ms": 0.5149456874479945, "mean_env_wait_ms": 0.4143113391497231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007663130760192871, "StateBufferConnector_ms": 0.0038622617721557617, "ViewRequirementAgentConnector_ms": 0.1840667724609375}, "num_episodes": 18, "episode_return_max": 44.0, "episode_return_min": -191.0, "episode_return_mean": -16.11, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 2416000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 255.12740634342853, "num_env_steps_trained_throughput_per_sec": 255.12740634342853, "timesteps_total": 604000, "num_env_steps_sampled_lifetime": 604000, "num_agent_steps_sampled_lifetime": 2416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2416000, "timers": {"training_iteration_time_ms": 15107.733, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15107.681, "sample_time_ms": 2822.121, "learn_time_ms": 12263.314, "learn_throughput": 326.176, "synch_weights_time_ms": 19.977}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 2416000}, "done": false, "training_iteration": 151, "trial_id": "e1352_00002", "date": "2024-08-13_19-55-11", "timestamp": 1723593311, "time_this_iter_s": 15.732573986053467, "time_total_s": 3196.5455725193024, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b98a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3196.5455725193024, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 87.61363636363637, "ram_util_percent": 83.47272727272728}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7181549222302185, "cur_kl_coeff": 0.0337881088256836, "cur_lr": 0.00010000000000000003, "total_loss": 0.6871246808262729, "policy_loss": -0.0001363601493673823, "vf_loss": 0.68710786524825, "vf_explained_var": 0.000516405843553089, "kl": 0.004533456865287366, "entropy": 0.8700184308662616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 286335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5670359567517327, "cur_kl_coeff": 0.00902033618185669, "cur_lr": 0.00010000000000000003, "total_loss": 0.9178137064413734, "policy_loss": -0.0019881265770111765, "vf_loss": 0.9197244419307306, "vf_explained_var": -0.0005219696375428054, "kl": 0.008579485656561591, "entropy": 0.9036617802879797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 286335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000}, "env_runners": {"episode_reward_max": 44.0, "episode_reward_min": -933.0, "episode_reward_mean": -19.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1434.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 44.0, "predator_policy": 1382.0}, "policy_reward_mean": {"prey_policy": -34.81, "predator_policy": 25.03}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0, 1.0, -8.0, -20.0, -35.0, 5.0, 18.0, 3.0, -16.0, 20.0, -45.0, -54.0, 29.0, 17.0, -26.0, 8.0, -190.0, 9.0, -122.0, 3.0, -6.0, 4.0, 22.0, -13.0, -2.0, 19.0, 3.0, -7.0, -1.0, 0.0, 18.0, -23.0, -12.0, -15.0, -185.0, -53.0, -2.0, -14.0, 13.0, 0.0, -5.0, -18.0, 0.0, -191.0, 0.0, 4.0, -1.0, 0.0, 7.0, 21.0, 0.0, -3.0, 5.0, 4.0, -18.0, -16.0, -4.0, -177.0, 1.0, 12.0, 17.0, 2.0, -36.0, 0.0, -2.0, -4.0, 0.0, 44.0, -26.0, 2.0, 13.0, 0.0, 5.0, 43.0, 7.0, -13.0, -10.0, 6.0, -8.0, 0.0, 0.0, -3.0, -2.0, 1.0, 29.0, 0.0, -5.0, 2.0, 0.0, -39.0, 5.0, 0.0, 14.0, 1.0, -933.0, -8.0, -6.0, 0.0, 12.0, -22.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-79.0, 0.0, 1.0, 0.0, -16.0, 0.0, -54.0, 0.0, -25.0, -30.0, 0.0, 5.0, 16.0, 2.0, -9.0, 0.0, -26.0, -6.0, -8.0, 0.0, -129.0, 0.0, -140.0, 0.0, 17.0, 12.0, 8.0, -5.0, 9.0, -1434.0, -10.0, 2.0, -380.0, 0.0, 0.0, 9.0, -244.0, 0.0, 0.0, 3.0, -24.0, 6.0, 0.0, 4.0, -37.0, 0.0, -75.0, 15.0, 0.0, -7.0, 10.0, 8.0, -11.0, -26.0, 0.0, -17.0, 0.0, -2.0, 0.0, 0.0, 0.0, 18.0, -39.0, -26.0, 0.0, -111.0, -30.0, 0.0, -118.0, -136.0, 0.0, -140.0, -10.0, 0.0, 0.0, -29.0, 10.0, 2.0, 0.0, 0.0, 0.0, -10.0, 26.0, -115.0, 0.0, 0.0, -382.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, -79.0, 0.0, 4.0, 13.0, 0.0, 0.0, -55.0, 0.0, 0.0, 2.0, -6.0, 7.0, -32.0, -29.0, -34.0, -5.0, 0.0, -8.0, -18.0, -336.0, 0.0, -3.0, 12.0, 0.0, 17.0, 0.0, 0.0, -8.0, -7.0, -75.0, 0.0, 0.0, 0.0, -5.0, 0.0, -11.0, 0.0, 0.0, 0.0, 44.0, -37.0, -72.0, -53.0, 9.0, 0.0, 13.0, 0.0, 0.0, -29.0, 0.0, 13.0, 30.0, 1.0, -1.0, -34.0, 0.0, 0.0, -20.0, 0.0, 6.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 4.0, -14.0, 0.0, -10.0, 1.0, 0.0, 0.0, 29.0, 0.0, 0.0, -4.0, -4.0, 2.0, 0.0, 0.0, 0.0, -28.0, -26.0, 0.0, 4.0, 0.0, 0.0, 0.0, 14.0, -34.0, 0.0, -1156.0, -1034.0, 0.0, -61.0, 0.0, -12.0, 0.0, 0.0, -22.0, 2.0, -29.0, -21.0], "policy_predator_policy_reward": [42.0, 31.0, 0.0, 0.0, 0.0, 8.0, 6.0, 28.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 13.0, 3.0, 13.0, 15.0, 40.0, 44.0, 75.0, 11.0, 0.0, 0.0, 0.0, 14.0, 17.0, 1382.0, 7.0, 9.0, 190.0, 0.0, 0.0, 0.0, 122.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 27.0, 32.0, 0.0, 47.0, 5.0, 0.0, 0.0, 1.0, 0.0, 40.0, 0.0, 10.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 42.0, 0.0, 40.0, 59.0, 15.0, 0.0, 69.0, 0.0, 20.0, 67.0, 3.0, 5.0, 0.0, 15.0, 0.0, 1.0, 0.0, 0.0, 0.0, 5.0, 71.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 0.0, 4.0, 2.0, 1.0, 0.0, 0.0, 40.0, 46.0, 0.0, 4.0, 0.0, 0.0, 27.0, 25.0, 0.0, 3.0, 0.0, 3.0, 0.0, 43.0, 23.0, 0.0, 4.0, 0.0, 9.0, 168.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 41.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 41.0, 42.0, 15.0, 31.0, 0.0, 0.0, 0.0, 0.0, 26.0, 8.0, 0.0, 0.0, 0.0, 7.0, 12.0, 9.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 1.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 24.0, 1257.0, 0.0, 21.0, 32.0, 6.0, 0.0, 0.0, 0.0, 32.0, 0.0, 6.0, 22.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1581258083646535, "mean_inference_ms": 3.554780484319591, "mean_action_processing_ms": 0.5145464557491647, "mean_env_wait_ms": 0.41422512007557244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00814354419708252, "StateBufferConnector_ms": 0.005846381187438965, "ViewRequirementAgentConnector_ms": 0.1966613531112671}, "num_episodes": 22, "episode_return_max": 44.0, "episode_return_min": -933.0, "episode_return_mean": -19.56, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.88760879855215, "num_env_steps_trained_throughput_per_sec": 268.88760879855215, "timesteps_total": 608000, "num_env_steps_sampled_lifetime": 608000, "num_agent_steps_sampled_lifetime": 2432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2432000, "timers": {"training_iteration_time_ms": 15128.924, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15128.873, "sample_time_ms": 2888.4, "learn_time_ms": 12219.034, "learn_throughput": 327.358, "synch_weights_time_ms": 19.134}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000}, "done": false, "training_iteration": 152, "trial_id": "e1352_00002", "date": "2024-08-13_19-55-26", "timestamp": 1723593326, "time_this_iter_s": 14.941904783248901, "time_total_s": 3211.4874773025513, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1681c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3211.4874773025513, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 84.33333333333334, "ram_util_percent": 83.83809523809525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8115811751317725, "cur_kl_coeff": 0.0168940544128418, "cur_lr": 0.00010000000000000003, "total_loss": 0.6429830082667568, "policy_loss": -0.0017771681918511315, "vf_loss": 0.6445660852171756, "vf_explained_var": 0.0024641727328931213, "kl": 0.011488730204576407, "entropy": 0.8226450607890174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 288225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3646765206699016, "cur_kl_coeff": 0.00902033618185669, "cur_lr": 0.00010000000000000003, "total_loss": 0.6576837238786674, "policy_loss": -0.003457960068548798, "vf_loss": 0.661078037747315, "vf_explained_var": -0.010797015384391501, "kl": 0.007055784746626159, "entropy": 0.9103665452154855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 288225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000}, "env_runners": {"episode_reward_max": 44.0, "episode_reward_min": -933.0, "episode_reward_mean": -16.82, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1156.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 44.0, "predator_policy": 1257.0}, "policy_reward_mean": {"prey_policy": -24.37, "predator_policy": 15.96}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-122.0, 3.0, -6.0, 4.0, 22.0, -13.0, -2.0, 19.0, 3.0, -7.0, -1.0, 0.0, 18.0, -23.0, -12.0, -15.0, -185.0, -53.0, -2.0, -14.0, 13.0, 0.0, -5.0, -18.0, 0.0, -191.0, 0.0, 4.0, -1.0, 0.0, 7.0, 21.0, 0.0, -3.0, 5.0, 4.0, -18.0, -16.0, -4.0, -177.0, 1.0, 12.0, 17.0, 2.0, -36.0, 0.0, -2.0, -4.0, 0.0, 44.0, -26.0, 2.0, 13.0, 0.0, 5.0, 43.0, 7.0, -13.0, -10.0, 6.0, -8.0, 0.0, 0.0, -3.0, -2.0, 1.0, 29.0, 0.0, -5.0, 2.0, 0.0, -39.0, 5.0, 0.0, 14.0, 1.0, -933.0, -8.0, -6.0, 0.0, 12.0, -22.0, 0.0, 0.0, -5.0, -13.0, 25.0, 19.0, -14.0, 0.0, -18.0, 8.0, 9.0, 0.0, 0.0, -1.0, 0.0, 0.0, 0.0, -26.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-244.0, 0.0, 0.0, 3.0, -24.0, 6.0, 0.0, 4.0, -37.0, 0.0, -75.0, 15.0, 0.0, -7.0, 10.0, 8.0, -11.0, -26.0, 0.0, -17.0, 0.0, -2.0, 0.0, 0.0, 0.0, 18.0, -39.0, -26.0, 0.0, -111.0, -30.0, 0.0, -118.0, -136.0, 0.0, -140.0, -10.0, 0.0, 0.0, -29.0, 10.0, 2.0, 0.0, 0.0, 0.0, -10.0, 26.0, -115.0, 0.0, 0.0, -382.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, -79.0, 0.0, 4.0, 13.0, 0.0, 0.0, -55.0, 0.0, 0.0, 2.0, -6.0, 7.0, -32.0, -29.0, -34.0, -5.0, 0.0, -8.0, -18.0, -336.0, 0.0, -3.0, 12.0, 0.0, 17.0, 0.0, 0.0, -8.0, -7.0, -75.0, 0.0, 0.0, 0.0, -5.0, 0.0, -11.0, 0.0, 0.0, 0.0, 44.0, -37.0, -72.0, -53.0, 9.0, 0.0, 13.0, 0.0, 0.0, -29.0, 0.0, 13.0, 30.0, 1.0, -1.0, -34.0, 0.0, 0.0, -20.0, 0.0, 6.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 4.0, -14.0, 0.0, -10.0, 1.0, 0.0, 0.0, 29.0, 0.0, 0.0, -4.0, -4.0, 2.0, 0.0, 0.0, 0.0, -28.0, -26.0, 0.0, 4.0, 0.0, 0.0, 0.0, 14.0, -34.0, 0.0, -1156.0, -1034.0, 0.0, -61.0, 0.0, -12.0, 0.0, 0.0, -22.0, 2.0, -29.0, -21.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, -21.0, -26.0, 0.0, 25.0, 0.0, 2.0, -30.0, 0.0, 0.0, 0.0, 0.0, -42.0, 1.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -54.0], "policy_predator_policy_reward": [122.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 27.0, 32.0, 0.0, 47.0, 5.0, 0.0, 0.0, 1.0, 0.0, 40.0, 0.0, 10.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 42.0, 0.0, 40.0, 59.0, 15.0, 0.0, 69.0, 0.0, 20.0, 67.0, 3.0, 5.0, 0.0, 15.0, 0.0, 1.0, 0.0, 0.0, 0.0, 5.0, 71.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 0.0, 4.0, 2.0, 1.0, 0.0, 0.0, 40.0, 46.0, 0.0, 4.0, 0.0, 0.0, 27.0, 25.0, 0.0, 3.0, 0.0, 3.0, 0.0, 43.0, 23.0, 0.0, 4.0, 0.0, 9.0, 168.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 41.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 41.0, 42.0, 15.0, 31.0, 0.0, 0.0, 0.0, 0.0, 26.0, 8.0, 0.0, 0.0, 0.0, 7.0, 12.0, 9.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 1.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 24.0, 1257.0, 0.0, 21.0, 32.0, 6.0, 0.0, 0.0, 0.0, 32.0, 0.0, 6.0, 22.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 34.0, 0.0, 0.0, 17.0, 0.0, 1.0, 15.0, 0.0, 0.0, 22.0, 2.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 41.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1576622044748603, "mean_inference_ms": 3.5540683100712296, "mean_action_processing_ms": 0.5142415847154096, "mean_env_wait_ms": 0.4141163054013353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008183121681213379, "StateBufferConnector_ms": 0.006031036376953125, "ViewRequirementAgentConnector_ms": 0.19637835025787354}, "num_episodes": 18, "episode_return_max": 44.0, "episode_return_min": -933.0, "episode_return_mean": -16.82, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.38312552875635, "num_env_steps_trained_throughput_per_sec": 277.38312552875635, "timesteps_total": 612000, "num_env_steps_sampled_lifetime": 612000, "num_agent_steps_sampled_lifetime": 2448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2448000, "timers": {"training_iteration_time_ms": 15098.754, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15098.703, "sample_time_ms": 2877.936, "learn_time_ms": 12199.65, "learn_throughput": 327.878, "synch_weights_time_ms": 18.752}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000}, "done": false, "training_iteration": 153, "trial_id": "e1352_00002", "date": "2024-08-13_19-55-41", "timestamp": 1723593341, "time_this_iter_s": 14.505996227264404, "time_total_s": 3225.9934735298157, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d44b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3225.9934735298157, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 86.84761904761906, "ram_util_percent": 83.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2126050501431107, "cur_kl_coeff": 0.0168940544128418, "cur_lr": 0.00010000000000000003, "total_loss": 0.6289819486951702, "policy_loss": -0.000325141395023339, "vf_loss": 0.6292538551426439, "vf_explained_var": -0.00013598667250739203, "kl": 0.0031509625786070583, "entropy": 0.8160937011241913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 290115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.856022281467757, "cur_kl_coeff": 0.00902033618185669, "cur_lr": 0.00010000000000000003, "total_loss": 0.6557471417403095, "policy_loss": -0.0005546612729116407, "vf_loss": 0.6562290929415554, "vf_explained_var": -0.003346780431333673, "kl": 0.008060664434128801, "entropy": 0.9703271403829887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 290115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000}, "env_runners": {"episode_reward_max": 44.0, "episode_reward_min": -933.0, "episode_reward_mean": -15.57, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1156.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 44.0, "predator_policy": 1257.0}, "policy_reward_mean": {"prey_policy": -23.1, "predator_policy": 15.315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -14.0, 13.0, 0.0, -5.0, -18.0, 0.0, -191.0, 0.0, 4.0, -1.0, 0.0, 7.0, 21.0, 0.0, -3.0, 5.0, 4.0, -18.0, -16.0, -4.0, -177.0, 1.0, 12.0, 17.0, 2.0, -36.0, 0.0, -2.0, -4.0, 0.0, 44.0, -26.0, 2.0, 13.0, 0.0, 5.0, 43.0, 7.0, -13.0, -10.0, 6.0, -8.0, 0.0, 0.0, -3.0, -2.0, 1.0, 29.0, 0.0, -5.0, 2.0, 0.0, -39.0, 5.0, 0.0, 14.0, 1.0, -933.0, -8.0, -6.0, 0.0, 12.0, -22.0, 0.0, 0.0, -5.0, -13.0, 25.0, 19.0, -14.0, 0.0, -18.0, 8.0, 9.0, 0.0, 0.0, -1.0, 0.0, 0.0, 0.0, -26.0, -5.0, 0.0, -14.0, -14.0, 0.0, 10.0, 0.0, -6.0, -22.0, -20.0, 0.0, 12.0, 3.0, -165.0, -8.0, -1.0, 4.0, -19.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.0, 0.0, 0.0, -29.0, 10.0, 2.0, 0.0, 0.0, 0.0, -10.0, 26.0, -115.0, 0.0, 0.0, -382.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, -79.0, 0.0, 4.0, 13.0, 0.0, 0.0, -55.0, 0.0, 0.0, 2.0, -6.0, 7.0, -32.0, -29.0, -34.0, -5.0, 0.0, -8.0, -18.0, -336.0, 0.0, -3.0, 12.0, 0.0, 17.0, 0.0, 0.0, -8.0, -7.0, -75.0, 0.0, 0.0, 0.0, -5.0, 0.0, -11.0, 0.0, 0.0, 0.0, 44.0, -37.0, -72.0, -53.0, 9.0, 0.0, 13.0, 0.0, 0.0, -29.0, 0.0, 13.0, 30.0, 1.0, -1.0, -34.0, 0.0, 0.0, -20.0, 0.0, 6.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 4.0, -14.0, 0.0, -10.0, 1.0, 0.0, 0.0, 29.0, 0.0, 0.0, -4.0, -4.0, 2.0, 0.0, 0.0, 0.0, -28.0, -26.0, 0.0, 4.0, 0.0, 0.0, 0.0, 14.0, -34.0, 0.0, -1156.0, -1034.0, 0.0, -61.0, 0.0, -12.0, 0.0, 0.0, -22.0, 2.0, -29.0, -21.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, -21.0, -26.0, 0.0, 25.0, 0.0, 2.0, -30.0, 0.0, 0.0, 0.0, 0.0, -42.0, 1.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -54.0, 0.0, -31.0, 0.0, -52.0, -39.0, 2.0, -10.0, -31.0, -2.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -12.0, 0.0, -45.0, 0.0, -47.0, 0.0, 0.0, 12.0, 0.0, 0.0, -9.0, -372.0, 21.0, 10.0, -75.0, -10.0, -4.0, -11.0, 0.0, -10.0, -20.0], "policy_predator_policy_reward": [3.0, 5.0, 0.0, 15.0, 0.0, 1.0, 0.0, 0.0, 0.0, 5.0, 71.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 0.0, 4.0, 2.0, 1.0, 0.0, 0.0, 40.0, 46.0, 0.0, 4.0, 0.0, 0.0, 27.0, 25.0, 0.0, 3.0, 0.0, 3.0, 0.0, 43.0, 23.0, 0.0, 4.0, 0.0, 9.0, 168.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 41.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 41.0, 42.0, 15.0, 31.0, 0.0, 0.0, 0.0, 0.0, 26.0, 8.0, 0.0, 0.0, 0.0, 7.0, 12.0, 9.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 1.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 24.0, 1257.0, 0.0, 21.0, 32.0, 6.0, 0.0, 0.0, 0.0, 32.0, 0.0, 6.0, 22.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 34.0, 0.0, 0.0, 17.0, 0.0, 1.0, 15.0, 0.0, 0.0, 22.0, 2.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 41.0, 26.0, 0.0, 24.0, 28.0, 12.0, 11.0, 14.0, 13.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 23.0, 0.0, 26.0, 1.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 186.0, 0.0, 57.0, 11.0, 2.0, 3.0, 12.0, 11.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1569811228771696, "mean_inference_ms": 3.552688284167234, "mean_action_processing_ms": 0.513816029023265, "mean_env_wait_ms": 0.41399618211992734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004675745964050293, "StateBufferConnector_ms": 0.00558781623840332, "ViewRequirementAgentConnector_ms": 0.22310864925384521}, "num_episodes": 18, "episode_return_max": 44.0, "episode_return_min": -933.0, "episode_return_mean": -15.57, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.9519682960164, "num_env_steps_trained_throughput_per_sec": 294.9519682960164, "timesteps_total": 616000, "num_env_steps_sampled_lifetime": 616000, "num_agent_steps_sampled_lifetime": 2464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2464000, "timers": {"training_iteration_time_ms": 15120.106, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15120.053, "sample_time_ms": 2882.797, "learn_time_ms": 12217.851, "learn_throughput": 327.39, "synch_weights_time_ms": 16.7}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000}, "done": false, "training_iteration": 154, "trial_id": "e1352_00002", "date": "2024-08-13_19-55-55", "timestamp": 1723593355, "time_this_iter_s": 13.618736982345581, "time_total_s": 3239.6122105121613, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b98a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3239.6122105121613, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 82.46842105263158, "ram_util_percent": 83.44210526315788}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2446386326084693, "cur_kl_coeff": 0.0084470272064209, "cur_lr": 0.00010000000000000003, "total_loss": 0.34564540941248495, "policy_loss": -0.002339224946049471, "vf_loss": 0.34788961659192363, "vf_explained_var": 0.0038868346542277666, "kl": 0.011248771132659225, "entropy": 0.7333456859386788, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 292005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3066650185438378, "cur_kl_coeff": 0.00902033618185669, "cur_lr": 0.00010000000000000003, "total_loss": 0.4484098935999788, "policy_loss": -0.0026637552949112086, "vf_loss": 0.4509098547466454, "vf_explained_var": -0.05516939308277514, "kl": 0.01815836904150312, "entropy": 0.93834483629812, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 292005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "env_runners": {"episode_reward_max": 44.0, "episode_reward_min": -933.0, "episode_reward_mean": -12.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1156.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 44.0, "predator_policy": 1257.0}, "policy_reward_mean": {"prey_policy": -18.995, "predator_policy": 12.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 17.0, 2.0, -36.0, 0.0, -2.0, -4.0, 0.0, 44.0, -26.0, 2.0, 13.0, 0.0, 5.0, 43.0, 7.0, -13.0, -10.0, 6.0, -8.0, 0.0, 0.0, -3.0, -2.0, 1.0, 29.0, 0.0, -5.0, 2.0, 0.0, -39.0, 5.0, 0.0, 14.0, 1.0, -933.0, -8.0, -6.0, 0.0, 12.0, -22.0, 0.0, 0.0, -5.0, -13.0, 25.0, 19.0, -14.0, 0.0, -18.0, 8.0, 9.0, 0.0, 0.0, -1.0, 0.0, 0.0, 0.0, -26.0, -5.0, 0.0, -14.0, -14.0, 0.0, 10.0, 0.0, -6.0, -22.0, -20.0, 0.0, 12.0, 3.0, -165.0, -8.0, -1.0, 4.0, -19.0, 5.0, -33.0, -6.0, 0.0, -1.0, -6.0, 9.0, -10.0, 0.0, 21.0, -6.0, -6.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, -15.0, 5.0, 2.0, -12.0, -24.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [12.0, 0.0, 17.0, 0.0, 0.0, -8.0, -7.0, -75.0, 0.0, 0.0, 0.0, -5.0, 0.0, -11.0, 0.0, 0.0, 0.0, 44.0, -37.0, -72.0, -53.0, 9.0, 0.0, 13.0, 0.0, 0.0, -29.0, 0.0, 13.0, 30.0, 1.0, -1.0, -34.0, 0.0, 0.0, -20.0, 0.0, 6.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 4.0, -14.0, 0.0, -10.0, 1.0, 0.0, 0.0, 29.0, 0.0, 0.0, -4.0, -4.0, 2.0, 0.0, 0.0, 0.0, -28.0, -26.0, 0.0, 4.0, 0.0, 0.0, 0.0, 14.0, -34.0, 0.0, -1156.0, -1034.0, 0.0, -61.0, 0.0, -12.0, 0.0, 0.0, -22.0, 2.0, -29.0, -21.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, -21.0, -26.0, 0.0, 25.0, 0.0, 2.0, -30.0, 0.0, 0.0, 0.0, 0.0, -42.0, 1.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -54.0, 0.0, -31.0, 0.0, -52.0, -39.0, 2.0, -10.0, -31.0, -2.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -12.0, 0.0, -45.0, 0.0, -47.0, 0.0, 0.0, 12.0, 0.0, 0.0, -9.0, -372.0, 21.0, 10.0, -75.0, -10.0, -4.0, -11.0, 0.0, -10.0, -20.0, -8.0, 5.0, -32.0, -25.0, -17.0, 0.0, 0.0, 0.0, -16.0, 0.0, -12.0, 0.0, 0.0, 9.0, -30.0, 0.0, 0.0, 0.0, 17.0, 4.0, 0.0, -12.0, -13.0, -2.0, 0.0, 0.0, 0.0, -1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, 0.0, 0.0, 5.0, 0.0, 2.0, -10.0, -16.0, -88.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 41.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 41.0, 42.0, 15.0, 31.0, 0.0, 0.0, 0.0, 0.0, 26.0, 8.0, 0.0, 0.0, 0.0, 7.0, 12.0, 9.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 1.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 24.0, 1257.0, 0.0, 21.0, 32.0, 6.0, 0.0, 0.0, 0.0, 32.0, 0.0, 6.0, 22.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 34.0, 0.0, 0.0, 17.0, 0.0, 1.0, 15.0, 0.0, 0.0, 22.0, 2.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 41.0, 26.0, 0.0, 24.0, 28.0, 12.0, 11.0, 14.0, 13.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 23.0, 0.0, 26.0, 1.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 186.0, 0.0, 57.0, 11.0, 2.0, 3.0, 12.0, 11.0, 0.0, 4.0, 4.0, 7.0, 17.0, 0.0, 11.0, 0.0, 0.0, 9.0, 6.0, 0.0, 6.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 1.0, 8.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 20.0, 44.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.157177101678287, "mean_inference_ms": 3.5535761817374145, "mean_action_processing_ms": 0.5136521334514531, "mean_env_wait_ms": 0.4141575221028464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014602184295654297, "StateBufferConnector_ms": 0.005702972412109375, "ViewRequirementAgentConnector_ms": 0.2534928321838379}, "num_episodes": 23, "episode_return_max": 44.0, "episode_return_min": -933.0, "episode_return_mean": -12.37, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 249.44996299930182, "num_env_steps_trained_throughput_per_sec": 249.44996299930182, "timesteps_total": 620000, "num_env_steps_sampled_lifetime": 620000, "num_agent_steps_sampled_lifetime": 2480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2480000, "timers": {"training_iteration_time_ms": 14922.913, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14922.86, "sample_time_ms": 2833.938, "learn_time_ms": 12070.598, "learn_throughput": 331.384, "synch_weights_time_ms": 15.267}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "done": false, "training_iteration": 155, "trial_id": "e1352_00002", "date": "2024-08-13_19-56-11", "timestamp": 1723593371, "time_this_iter_s": 16.110728979110718, "time_total_s": 3255.722939491272, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f423a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3255.722939491272, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 82.46363636363637, "ram_util_percent": 83.64999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6098116241632, "cur_kl_coeff": 0.0084470272064209, "cur_lr": 0.00010000000000000003, "total_loss": 0.7778207608395152, "policy_loss": -0.001729014208638873, "vf_loss": 0.7794218064576545, "vf_explained_var": 0.00013636360092768594, "kl": 0.01514932899635198, "entropy": 0.7257126685488161, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 293895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7801790655802483, "cur_kl_coeff": 0.00902033618185669, "cur_lr": 0.00010000000000000003, "total_loss": 0.768601725807305, "policy_loss": -0.002762699983250251, "vf_loss": 0.7712047724417909, "vf_explained_var": -0.0003035372211819603, "kl": 0.017699291433149803, "entropy": 0.8773571424698704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 293895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000}, "env_runners": {"episode_reward_max": 29.0, "episode_reward_min": -933.0, "episode_reward_mean": -14.55, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1156.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 29.0, "predator_policy": 1257.0}, "policy_reward_mean": {"prey_policy": -23.67, "predator_policy": 16.395}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -2.0, 1.0, 29.0, 0.0, -5.0, 2.0, 0.0, -39.0, 5.0, 0.0, 14.0, 1.0, -933.0, -8.0, -6.0, 0.0, 12.0, -22.0, 0.0, 0.0, -5.0, -13.0, 25.0, 19.0, -14.0, 0.0, -18.0, 8.0, 9.0, 0.0, 0.0, -1.0, 0.0, 0.0, 0.0, -26.0, -5.0, 0.0, -14.0, -14.0, 0.0, 10.0, 0.0, -6.0, -22.0, -20.0, 0.0, 12.0, 3.0, -165.0, -8.0, -1.0, 4.0, -19.0, 5.0, -33.0, -6.0, 0.0, -1.0, -6.0, 9.0, -10.0, 0.0, 21.0, -6.0, -6.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, -15.0, 5.0, 2.0, -12.0, -24.0, -14.0, 0.0, -16.0, -6.0, -25.0, 1.0, -10.0, -5.0, -130.0, -10.0, -2.0, 0.0, -3.0, -2.0, 20.0, -13.0, -5.0, -13.0, 23.0, 18.0, 0.0, 26.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4.0, -14.0, 0.0, -10.0, 1.0, 0.0, 0.0, 29.0, 0.0, 0.0, -4.0, -4.0, 2.0, 0.0, 0.0, 0.0, -28.0, -26.0, 0.0, 4.0, 0.0, 0.0, 0.0, 14.0, -34.0, 0.0, -1156.0, -1034.0, 0.0, -61.0, 0.0, -12.0, 0.0, 0.0, -22.0, 2.0, -29.0, -21.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, -21.0, -26.0, 0.0, 25.0, 0.0, 2.0, -30.0, 0.0, 0.0, 0.0, 0.0, -42.0, 1.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -54.0, 0.0, -31.0, 0.0, -52.0, -39.0, 2.0, -10.0, -31.0, -2.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -12.0, 0.0, -45.0, 0.0, -47.0, 0.0, 0.0, 12.0, 0.0, 0.0, -9.0, -372.0, 21.0, 10.0, -75.0, -10.0, -4.0, -11.0, 0.0, -10.0, -20.0, -8.0, 5.0, -32.0, -25.0, -17.0, 0.0, 0.0, 0.0, -16.0, 0.0, -12.0, 0.0, 0.0, 9.0, -30.0, 0.0, 0.0, 0.0, 17.0, 4.0, 0.0, -12.0, -13.0, -2.0, 0.0, 0.0, 0.0, -1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, 0.0, 0.0, 5.0, 0.0, 2.0, -10.0, -16.0, -88.0, 0.0, -19.0, -24.0, 0.0, 0.0, -10.0, -22.0, -4.0, -4.0, -10.0, -49.0, 1.0, 0.0, -20.0, 0.0, -18.0, 0.0, 0.0, -930.0, -25.0, 0.0, 0.0, -9.0, 0.0, 0.0, 0.0, -6.0, -10.0, -8.0, 12.0, 8.0, -31.0, 0.0, -10.0, 0.0, -27.0, 0.0, 0.0, 23.0, 0.0, 17.0, 0.0, 0.0, 6.0, 11.0], "policy_predator_policy_reward": [0.0, 7.0, 1.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 24.0, 1257.0, 0.0, 21.0, 32.0, 6.0, 0.0, 0.0, 0.0, 32.0, 0.0, 6.0, 22.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 34.0, 0.0, 0.0, 17.0, 0.0, 1.0, 15.0, 0.0, 0.0, 22.0, 2.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 41.0, 26.0, 0.0, 24.0, 28.0, 12.0, 11.0, 14.0, 13.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 23.0, 0.0, 26.0, 1.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 186.0, 0.0, 57.0, 11.0, 2.0, 3.0, 12.0, 11.0, 0.0, 4.0, 4.0, 7.0, 17.0, 0.0, 11.0, 0.0, 0.0, 9.0, 6.0, 0.0, 6.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 1.0, 8.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 20.0, 44.0, 2.0, 27.0, 0.0, 0.0, 5.0, 11.0, 0.0, 2.0, 19.0, 15.0, 0.0, 0.0, 10.0, 0.0, 4.0, 9.0, 0.0, 800.0, 15.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 3.0, 16.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 5.0, 14.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 9.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1565583080355384, "mean_inference_ms": 3.552014284188863, "mean_action_processing_ms": 0.5131029040253722, "mean_env_wait_ms": 0.41395487304457773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014622807502746582, "StateBufferConnector_ms": 0.005830168724060059, "ViewRequirementAgentConnector_ms": 0.24332475662231445}, "num_episodes": 22, "episode_return_max": 29.0, "episode_return_min": -933.0, "episode_return_mean": -14.55, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.7401814736654, "num_env_steps_trained_throughput_per_sec": 299.7401814736654, "timesteps_total": 624000, "num_env_steps_sampled_lifetime": 624000, "num_agent_steps_sampled_lifetime": 2496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2496000, "timers": {"training_iteration_time_ms": 14859.497, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14859.446, "sample_time_ms": 2727.156, "learn_time_ms": 12113.596, "learn_throughput": 330.207, "synch_weights_time_ms": 15.823}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000}, "done": false, "training_iteration": 156, "trial_id": "e1352_00002", "date": "2024-08-13_19-56-24", "timestamp": 1723593384, "time_this_iter_s": 13.40742301940918, "time_total_s": 3269.130362510681, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d44b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3269.130362510681, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 78.65263157894738, "ram_util_percent": 83.57368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1180319465893918, "cur_kl_coeff": 0.0084470272064209, "cur_lr": 0.00010000000000000003, "total_loss": 0.7736786292343544, "policy_loss": -0.0005012385561944, "vf_loss": 0.7741148105689457, "vf_explained_var": 0.0009071892531460555, "kl": 0.007701850265049882, "entropy": 0.7908400714082062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9041750216058322, "cur_kl_coeff": 0.00902033618185669, "cur_lr": 0.00010000000000000003, "total_loss": 0.7182313155579977, "policy_loss": -0.00042548828595687473, "vf_loss": 0.7185866803364463, "vf_explained_var": -0.005497575247729266, "kl": 0.007773981062538082, "entropy": 0.882938872884821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 2512000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -165.0, "episode_reward_mean": -5.55, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -930.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 25.0, "predator_policy": 800.0}, "policy_reward_mean": {"prey_policy": -14.585, "predator_policy": 11.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.0, 0.0, 0.0, -5.0, -13.0, 25.0, 19.0, -14.0, 0.0, -18.0, 8.0, 9.0, 0.0, 0.0, -1.0, 0.0, 0.0, 0.0, -26.0, -5.0, 0.0, -14.0, -14.0, 0.0, 10.0, 0.0, -6.0, -22.0, -20.0, 0.0, 12.0, 3.0, -165.0, -8.0, -1.0, 4.0, -19.0, 5.0, -33.0, -6.0, 0.0, -1.0, -6.0, 9.0, -10.0, 0.0, 21.0, -6.0, -6.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, -15.0, 5.0, 2.0, -12.0, -24.0, -14.0, 0.0, -16.0, -6.0, -25.0, 1.0, -10.0, -5.0, -130.0, -10.0, -2.0, 0.0, -3.0, -2.0, 20.0, -13.0, -5.0, -13.0, 23.0, 18.0, 0.0, 26.0, 0.0, -22.0, 21.0, -16.0, 0.0, -2.0, -15.0, 11.0, 0.0, 6.0, -3.0, -6.0, 0.0, 13.0, -6.0, -5.0, -2.0, -6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-29.0, -21.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, -21.0, -26.0, 0.0, 25.0, 0.0, 2.0, -30.0, 0.0, 0.0, 0.0, 0.0, -42.0, 1.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -54.0, 0.0, -31.0, 0.0, -52.0, -39.0, 2.0, -10.0, -31.0, -2.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -12.0, 0.0, -45.0, 0.0, -47.0, 0.0, 0.0, 12.0, 0.0, 0.0, -9.0, -372.0, 21.0, 10.0, -75.0, -10.0, -4.0, -11.0, 0.0, -10.0, -20.0, -8.0, 5.0, -32.0, -25.0, -17.0, 0.0, 0.0, 0.0, -16.0, 0.0, -12.0, 0.0, 0.0, 9.0, -30.0, 0.0, 0.0, 0.0, 17.0, 4.0, 0.0, -12.0, -13.0, -2.0, 0.0, 0.0, 0.0, -1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, 0.0, 0.0, 5.0, 0.0, 2.0, -10.0, -16.0, -88.0, 0.0, -19.0, -24.0, 0.0, 0.0, -10.0, -22.0, -4.0, -4.0, -10.0, -49.0, 1.0, 0.0, -20.0, 0.0, -18.0, 0.0, 0.0, -930.0, -25.0, 0.0, 0.0, -9.0, 0.0, 0.0, 0.0, -6.0, -10.0, -8.0, 12.0, 8.0, -31.0, 0.0, -10.0, 0.0, -27.0, 0.0, 0.0, 23.0, 0.0, 17.0, 0.0, 0.0, 6.0, 11.0, 0.0, 0.0, -50.0, 0.0, 21.0, 0.0, 0.0, -76.0, 0.0, 0.0, 0.0, -4.0, -12.0, -12.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, -360.0, 10.0, 0.0, -14.0, 0.0, 0.0, -6.0, 7.0, 0.0, -12.0, 0.0, -23.0, -4.0, 0.0, -12.0, 0.0], "policy_predator_policy_reward": [6.0, 22.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 34.0, 0.0, 0.0, 17.0, 0.0, 1.0, 15.0, 0.0, 0.0, 22.0, 2.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 41.0, 26.0, 0.0, 24.0, 28.0, 12.0, 11.0, 14.0, 13.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 23.0, 0.0, 26.0, 1.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 186.0, 0.0, 57.0, 11.0, 2.0, 3.0, 12.0, 11.0, 0.0, 4.0, 4.0, 7.0, 17.0, 0.0, 11.0, 0.0, 0.0, 9.0, 6.0, 0.0, 6.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 1.0, 8.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 20.0, 44.0, 2.0, 27.0, 0.0, 0.0, 5.0, 11.0, 0.0, 2.0, 19.0, 15.0, 0.0, 0.0, 10.0, 0.0, 4.0, 9.0, 0.0, 800.0, 15.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 3.0, 16.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 5.0, 14.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 26.0, 2.0, 0.0, 0.0, 22.0, 38.0, 0.0, 0.0, 2.0, 0.0, 9.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 167.0, 180.0, 7.0, 1.0, 0.0, 0.0, 0.0, 12.0, 6.0, 0.0, 10.0, 8.0, 0.0, 2.0, 0.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1563930592227867, "mean_inference_ms": 3.551866931866508, "mean_action_processing_ms": 0.512725570810514, "mean_env_wait_ms": 0.4140224895611989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014333605766296387, "StateBufferConnector_ms": 0.003878355026245117, "ViewRequirementAgentConnector_ms": 0.21189236640930176}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -165.0, "episode_return_mean": -5.55, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 2512000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.58443007167085, "num_env_steps_trained_throughput_per_sec": 277.58443007167085, "timesteps_total": 628000, "num_env_steps_sampled_lifetime": 628000, "num_agent_steps_sampled_lifetime": 2512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2512000, "timers": {"training_iteration_time_ms": 14486.588, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14486.542, "sample_time_ms": 2524.702, "learn_time_ms": 11943.649, "learn_throughput": 334.906, "synch_weights_time_ms": 15.562}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 2512000}, "done": false, "training_iteration": 157, "trial_id": "e1352_00002", "date": "2024-08-13_19-56-39", "timestamp": 1723593399, "time_this_iter_s": 14.545813083648682, "time_total_s": 3283.67617559433, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f8c550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3283.67617559433, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 84.20952380952382, "ram_util_percent": 83.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2883039702577566, "cur_kl_coeff": 0.0084470272064209, "cur_lr": 0.00010000000000000003, "total_loss": 0.48656104820430596, "policy_loss": -0.00041973224887870765, "vf_loss": 0.48690394573187745, "vf_explained_var": -0.0014834665432178155, "kl": 0.009095985607079634, "entropy": 0.6746321248945105, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 297675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.055839909301706, "cur_kl_coeff": 0.00902033618185669, "cur_lr": 0.00010000000000000003, "total_loss": 0.5796781421932219, "policy_loss": -0.007721300153357405, "vf_loss": 0.5872097135674228, "vf_explained_var": -0.0015042118925266165, "kl": 0.02103318925083539, "entropy": 0.904145209120695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 297675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -165.0, "episode_reward_mean": -6.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -930.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 23.0, "predator_policy": 800.0}, "policy_reward_mean": {"prey_policy": -15.79, "predator_policy": 12.345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.0, -5.0, 0.0, -14.0, -14.0, 0.0, 10.0, 0.0, -6.0, -22.0, -20.0, 0.0, 12.0, 3.0, -165.0, -8.0, -1.0, 4.0, -19.0, 5.0, -33.0, -6.0, 0.0, -1.0, -6.0, 9.0, -10.0, 0.0, 21.0, -6.0, -6.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, -15.0, 5.0, 2.0, -12.0, -24.0, -14.0, 0.0, -16.0, -6.0, -25.0, 1.0, -10.0, -5.0, -130.0, -10.0, -2.0, 0.0, -3.0, -2.0, 20.0, -13.0, -5.0, -13.0, 23.0, 18.0, 0.0, 26.0, 0.0, -22.0, 21.0, -16.0, 0.0, -2.0, -15.0, 11.0, 0.0, 6.0, -3.0, -6.0, 0.0, 13.0, -6.0, -5.0, -2.0, -6.0, -1.0, 0.0, -92.0, 0.0, 22.0, -79.0, 14.0, 11.0, -12.0, 0.0, 14.0, 11.0, 0.0, -11.0, -9.0, 0.0, -6.0, -8.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.0, -54.0, 0.0, -31.0, 0.0, -52.0, -39.0, 2.0, -10.0, -31.0, -2.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -12.0, 0.0, -45.0, 0.0, -47.0, 0.0, 0.0, 12.0, 0.0, 0.0, -9.0, -372.0, 21.0, 10.0, -75.0, -10.0, -4.0, -11.0, 0.0, -10.0, -20.0, -8.0, 5.0, -32.0, -25.0, -17.0, 0.0, 0.0, 0.0, -16.0, 0.0, -12.0, 0.0, 0.0, 9.0, -30.0, 0.0, 0.0, 0.0, 17.0, 4.0, 0.0, -12.0, -13.0, -2.0, 0.0, 0.0, 0.0, -1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, 0.0, 0.0, 5.0, 0.0, 2.0, -10.0, -16.0, -88.0, 0.0, -19.0, -24.0, 0.0, 0.0, -10.0, -22.0, -4.0, -4.0, -10.0, -49.0, 1.0, 0.0, -20.0, 0.0, -18.0, 0.0, 0.0, -930.0, -25.0, 0.0, 0.0, -9.0, 0.0, 0.0, 0.0, -6.0, -10.0, -8.0, 12.0, 8.0, -31.0, 0.0, -10.0, 0.0, -27.0, 0.0, 0.0, 23.0, 0.0, 17.0, 0.0, 0.0, 6.0, 11.0, 0.0, 0.0, -50.0, 0.0, 21.0, 0.0, 0.0, -76.0, 0.0, 0.0, 0.0, -4.0, -12.0, -12.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, -360.0, 10.0, 0.0, -14.0, 0.0, 0.0, -6.0, 7.0, 0.0, -12.0, 0.0, -23.0, -4.0, 0.0, -12.0, 0.0, -2.0, 0.0, 0.0, 0.0, -37.0, -174.0, 0.0, -4.0, 20.0, -1.0, -93.0, -40.0, 14.0, 0.0, 10.0, 0.0, -31.0, 0.0, 0.0, 0.0, 1.0, 2.0, 0.0, 11.0, 0.0, 0.0, -14.0, -14.0, -19.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, -16.0], "policy_predator_policy_reward": [7.0, 41.0, 26.0, 0.0, 24.0, 28.0, 12.0, 11.0, 14.0, 13.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 23.0, 0.0, 26.0, 1.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 186.0, 0.0, 57.0, 11.0, 2.0, 3.0, 12.0, 11.0, 0.0, 4.0, 4.0, 7.0, 17.0, 0.0, 11.0, 0.0, 0.0, 9.0, 6.0, 0.0, 6.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 1.0, 8.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 20.0, 44.0, 2.0, 27.0, 0.0, 0.0, 5.0, 11.0, 0.0, 2.0, 19.0, 15.0, 0.0, 0.0, 10.0, 0.0, 4.0, 9.0, 0.0, 800.0, 15.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 3.0, 16.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 5.0, 14.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 26.0, 2.0, 0.0, 0.0, 22.0, 38.0, 0.0, 0.0, 2.0, 0.0, 9.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 167.0, 180.0, 7.0, 1.0, 0.0, 0.0, 0.0, 12.0, 6.0, 0.0, 10.0, 8.0, 0.0, 2.0, 0.0, 6.0, 0.0, 1.0, 0.0, 0.0, 97.0, 22.0, 4.0, 0.0, 3.0, 0.0, 31.0, 23.0, 0.0, 0.0, 1.0, 0.0, 3.0, 16.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 8.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1561491900862122, "mean_inference_ms": 3.5519360454536093, "mean_action_processing_ms": 0.5123220807634702, "mean_env_wait_ms": 0.4140334546970007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015558242797851562, "StateBufferConnector_ms": 0.0037279129028320312, "ViewRequirementAgentConnector_ms": 0.2092578411102295}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -165.0, "episode_return_mean": -6.89, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.00668446641095, "num_env_steps_trained_throughput_per_sec": 279.00668446641095, "timesteps_total": 632000, "num_env_steps_sampled_lifetime": 632000, "num_agent_steps_sampled_lifetime": 2528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2528000, "timers": {"training_iteration_time_ms": 14449.567, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14449.517, "sample_time_ms": 2586.815, "learn_time_ms": 11843.296, "learn_throughput": 337.744, "synch_weights_time_ms": 16.712}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000}, "done": false, "training_iteration": 158, "trial_id": "e1352_00002", "date": "2024-08-13_19-56-53", "timestamp": 1723593413, "time_this_iter_s": 14.426830768585205, "time_total_s": 3298.103006362915, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f72d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3298.103006362915, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 79.475, "ram_util_percent": 83.63000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9814361597968158, "cur_kl_coeff": 0.0084470272064209, "cur_lr": 0.00010000000000000003, "total_loss": 0.24532405398983173, "policy_loss": -0.004277445284018993, "vf_loss": 0.24949789740947179, "vf_explained_var": 0.026598153322462053, "kl": 0.01226492347960928, "entropy": 0.69124461560653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 299565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.961665029153622, "cur_kl_coeff": 0.013530504272785042, "cur_lr": 0.00010000000000000003, "total_loss": 0.40992736190024065, "policy_loss": -0.003344305266106314, "vf_loss": 0.4129040896744103, "vf_explained_var": -0.023566781402264952, "kl": 0.027166534412422286, "entropy": 0.8743038122931486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 299565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -130.0, "episode_reward_mean": -4.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -930.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 23.0, "predator_policy": 800.0}, "policy_reward_mean": {"prey_policy": -12.835, "predator_policy": 10.435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.0, 5.0, -33.0, -6.0, 0.0, -1.0, -6.0, 9.0, -10.0, 0.0, 21.0, -6.0, -6.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, -15.0, 5.0, 2.0, -12.0, -24.0, -14.0, 0.0, -16.0, -6.0, -25.0, 1.0, -10.0, -5.0, -130.0, -10.0, -2.0, 0.0, -3.0, -2.0, 20.0, -13.0, -5.0, -13.0, 23.0, 18.0, 0.0, 26.0, 0.0, -22.0, 21.0, -16.0, 0.0, -2.0, -15.0, 11.0, 0.0, 6.0, -3.0, -6.0, 0.0, 13.0, -6.0, -5.0, -2.0, -6.0, -1.0, 0.0, -92.0, 0.0, 22.0, -79.0, 14.0, 11.0, -12.0, 0.0, 14.0, 11.0, 0.0, -11.0, -9.0, 0.0, -6.0, -8.0, 11.0, -22.0, -13.0, -13.0, 0.0, 9.0, 9.0, -2.0, 0.0, -1.0, 1.0, 6.0, -29.0, 4.0, 7.0, 0.0, -5.0, -5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.0, -20.0, -8.0, 5.0, -32.0, -25.0, -17.0, 0.0, 0.0, 0.0, -16.0, 0.0, -12.0, 0.0, 0.0, 9.0, -30.0, 0.0, 0.0, 0.0, 17.0, 4.0, 0.0, -12.0, -13.0, -2.0, 0.0, 0.0, 0.0, -1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, 0.0, 0.0, 5.0, 0.0, 2.0, -10.0, -16.0, -88.0, 0.0, -19.0, -24.0, 0.0, 0.0, -10.0, -22.0, -4.0, -4.0, -10.0, -49.0, 1.0, 0.0, -20.0, 0.0, -18.0, 0.0, 0.0, -930.0, -25.0, 0.0, 0.0, -9.0, 0.0, 0.0, 0.0, -6.0, -10.0, -8.0, 12.0, 8.0, -31.0, 0.0, -10.0, 0.0, -27.0, 0.0, 0.0, 23.0, 0.0, 17.0, 0.0, 0.0, 6.0, 11.0, 0.0, 0.0, -50.0, 0.0, 21.0, 0.0, 0.0, -76.0, 0.0, 0.0, 0.0, -4.0, -12.0, -12.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, -360.0, 10.0, 0.0, -14.0, 0.0, 0.0, -6.0, 7.0, 0.0, -12.0, 0.0, -23.0, -4.0, 0.0, -12.0, 0.0, -2.0, 0.0, 0.0, 0.0, -37.0, -174.0, 0.0, -4.0, 20.0, -1.0, -93.0, -40.0, 14.0, 0.0, 10.0, 0.0, -31.0, 0.0, 0.0, 0.0, 1.0, 2.0, 0.0, 11.0, 0.0, 0.0, -14.0, -14.0, -19.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, -16.0, -8.0, 0.0, -39.0, -5.0, -26.0, 0.0, -26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, -10.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -8.0, 4.0, 0.0, -24.0, -23.0, 0.0, -7.0, 3.0, 4.0, 0.0, 0.0, 0.0, -10.0, 0.0, -10.0], "policy_predator_policy_reward": [11.0, 0.0, 4.0, 4.0, 7.0, 17.0, 0.0, 11.0, 0.0, 0.0, 9.0, 6.0, 0.0, 6.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 1.0, 8.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 20.0, 44.0, 2.0, 27.0, 0.0, 0.0, 5.0, 11.0, 0.0, 2.0, 19.0, 15.0, 0.0, 0.0, 10.0, 0.0, 4.0, 9.0, 0.0, 800.0, 15.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 3.0, 16.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 5.0, 14.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 26.0, 2.0, 0.0, 0.0, 22.0, 38.0, 0.0, 0.0, 2.0, 0.0, 9.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 167.0, 180.0, 7.0, 1.0, 0.0, 0.0, 0.0, 12.0, 6.0, 0.0, 10.0, 8.0, 0.0, 2.0, 0.0, 6.0, 0.0, 1.0, 0.0, 0.0, 97.0, 22.0, 4.0, 0.0, 3.0, 0.0, 31.0, 23.0, 0.0, 0.0, 1.0, 0.0, 3.0, 16.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 8.0, 0.0, 19.0, 0.0, 12.0, 10.0, 13.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 2.0, 0.0, 9.0, 9.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 5.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1566624201709264, "mean_inference_ms": 3.553723234899611, "mean_action_processing_ms": 0.512150201894401, "mean_env_wait_ms": 0.4142270534393863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0216444730758667, "StateBufferConnector_ms": 0.0038175582885742188, "ViewRequirementAgentConnector_ms": 0.21429169178009033}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -130.0, "episode_return_mean": -4.8, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.9166600850909, "num_env_steps_trained_throughput_per_sec": 276.9166600850909, "timesteps_total": 636000, "num_env_steps_sampled_lifetime": 636000, "num_agent_steps_sampled_lifetime": 2544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2544000, "timers": {"training_iteration_time_ms": 14453.386, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14453.336, "sample_time_ms": 2650.717, "learn_time_ms": 11782.638, "learn_throughput": 339.483, "synch_weights_time_ms": 17.394}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000}, "done": false, "training_iteration": 159, "trial_id": "e1352_00002", "date": "2024-08-13_19-57-08", "timestamp": 1723593428, "time_this_iter_s": 14.553488969802856, "time_total_s": 3312.656495332718, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e5a1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3312.656495332718, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 79.76190476190476, "ram_util_percent": 83.51904761904763}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1964906889373665, "cur_kl_coeff": 0.0084470272064209, "cur_lr": 0.00010000000000000003, "total_loss": 0.29642176853601265, "policy_loss": -0.003750589035362715, "vf_loss": 0.3000852160196734, "vf_explained_var": 0.007589610796126109, "kl": 0.010316244648454756, "entropy": 0.6641531942382691, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 301455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1028943138542, "cur_kl_coeff": 0.020295756409177558, "cur_lr": 0.00010000000000000003, "total_loss": 0.5118226740621376, "policy_loss": -0.001496601178158055, "vf_loss": 0.5131595155071448, "vf_explained_var": 0.0383133330673137, "kl": 0.007871525621425625, "entropy": 0.8062170252598152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 301455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "env_runners": {"episode_reward_max": 37.0, "episode_reward_min": -130.0, "episode_reward_mean": -1.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -930.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 29.0, "predator_policy": 800.0}, "policy_reward_mean": {"prey_policy": -10.945, "predator_policy": 9.965}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0, -25.0, 1.0, -10.0, -5.0, -130.0, -10.0, -2.0, 0.0, -3.0, -2.0, 20.0, -13.0, -5.0, -13.0, 23.0, 18.0, 0.0, 26.0, 0.0, -22.0, 21.0, -16.0, 0.0, -2.0, -15.0, 11.0, 0.0, 6.0, -3.0, -6.0, 0.0, 13.0, -6.0, -5.0, -2.0, -6.0, -1.0, 0.0, -92.0, 0.0, 22.0, -79.0, 14.0, 11.0, -12.0, 0.0, 14.0, 11.0, 0.0, -11.0, -9.0, 0.0, -6.0, -8.0, 11.0, -22.0, -13.0, -13.0, 0.0, 9.0, 9.0, -2.0, 0.0, -1.0, 1.0, 6.0, -29.0, 4.0, 7.0, 0.0, -5.0, -5.0, 5.0, 19.0, 9.0, -5.0, 18.0, 24.0, 1.0, 2.0, 0.0, 2.0, 0.0, 6.0, 29.0, 0.0, -6.0, 5.0, -1.0, 2.0, 15.0, -12.0, -5.0, 21.0, 0.0, 37.0, 0.0, -14.0, 9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.0, -4.0, -10.0, -49.0, 1.0, 0.0, -20.0, 0.0, -18.0, 0.0, 0.0, -930.0, -25.0, 0.0, 0.0, -9.0, 0.0, 0.0, 0.0, -6.0, -10.0, -8.0, 12.0, 8.0, -31.0, 0.0, -10.0, 0.0, -27.0, 0.0, 0.0, 23.0, 0.0, 17.0, 0.0, 0.0, 6.0, 11.0, 0.0, 0.0, -50.0, 0.0, 21.0, 0.0, 0.0, -76.0, 0.0, 0.0, 0.0, -4.0, -12.0, -12.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, -360.0, 10.0, 0.0, -14.0, 0.0, 0.0, -6.0, 7.0, 0.0, -12.0, 0.0, -23.0, -4.0, 0.0, -12.0, 0.0, -2.0, 0.0, 0.0, 0.0, -37.0, -174.0, 0.0, -4.0, 20.0, -1.0, -93.0, -40.0, 14.0, 0.0, 10.0, 0.0, -31.0, 0.0, 0.0, 0.0, 1.0, 2.0, 0.0, 11.0, 0.0, 0.0, -14.0, -14.0, -19.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, -16.0, -8.0, 0.0, -39.0, -5.0, -26.0, 0.0, -26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, -10.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -8.0, 4.0, 0.0, -24.0, -23.0, 0.0, -7.0, 3.0, 4.0, 0.0, 0.0, 0.0, -10.0, 0.0, -10.0, 0.0, 5.0, 0.0, 11.0, 9.0, 0.0, -4.0, -6.0, 18.0, 0.0, 0.0, 24.0, -2.0, -9.0, 2.0, 0.0, 0.0, 0.0, -5.0, -5.0, 0.0, 0.0, 15.0, -18.0, 0.0, 29.0, 0.0, 0.0, -21.0, 0.0, 6.0, -22.0, 0.0, -8.0, 0.0, 2.0, -2.0, 2.0, -2.0, -22.0, -10.0, 0.0, 0.0, 17.0, 0.0, 0.0, -14.0, 24.0, 0.0, 0.0, -12.0, -8.0, 9.0, 0.0], "policy_predator_policy_reward": [0.0, 2.0, 19.0, 15.0, 0.0, 0.0, 10.0, 0.0, 4.0, 9.0, 0.0, 800.0, 15.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 3.0, 16.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 5.0, 14.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 26.0, 2.0, 0.0, 0.0, 22.0, 38.0, 0.0, 0.0, 2.0, 0.0, 9.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 167.0, 180.0, 7.0, 1.0, 0.0, 0.0, 0.0, 12.0, 6.0, 0.0, 10.0, 8.0, 0.0, 2.0, 0.0, 6.0, 0.0, 1.0, 0.0, 0.0, 97.0, 22.0, 4.0, 0.0, 3.0, 0.0, 31.0, 23.0, 0.0, 0.0, 1.0, 0.0, 3.0, 16.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 8.0, 0.0, 19.0, 0.0, 12.0, 10.0, 13.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 2.0, 0.0, 9.0, 9.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 5.0, 16.0, 7.0, 0.0, 0.0, 0.0, 15.0, 0.0, 11.0, 1.0, 5.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 17.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1573997946110195, "mean_inference_ms": 3.5556691993214242, "mean_action_processing_ms": 0.5117694535312317, "mean_env_wait_ms": 0.4143211621400814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01992940902709961, "StateBufferConnector_ms": 0.005513787269592285, "ViewRequirementAgentConnector_ms": 0.24235224723815918}, "num_episodes": 27, "episode_return_max": 37.0, "episode_return_min": -130.0, "episode_return_mean": -1.96, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.79435203651497, "num_env_steps_trained_throughput_per_sec": 267.79435203651497, "timesteps_total": 640000, "num_env_steps_sampled_lifetime": 640000, "num_agent_steps_sampled_lifetime": 2560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2560000, "timers": {"training_iteration_time_ms": 14604.505, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14604.454, "sample_time_ms": 2809.682, "learn_time_ms": 11774.052, "learn_throughput": 339.73, "synch_weights_time_ms": 17.815}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "done": false, "training_iteration": 160, "trial_id": "e1352_00002", "date": "2024-08-13_19-57-23", "timestamp": 1723593443, "time_this_iter_s": 14.998884201049805, "time_total_s": 3327.6553795337677, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e68670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3327.6553795337677, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 82.75238095238095, "ram_util_percent": 83.06190476190476}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5866964650138344, "cur_kl_coeff": 0.0084470272064209, "cur_lr": 0.00010000000000000003, "total_loss": 0.44248031062423865, "policy_loss": -0.0012514258330815998, "vf_loss": 0.4436801376656467, "vf_explained_var": 0.013342536473400378, "kl": 0.0061085444852362536, "entropy": 0.5781428752595155, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 303345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5346548373894717, "cur_kl_coeff": 0.020295756409177558, "cur_lr": 0.00010000000000000003, "total_loss": 0.784074593000311, "policy_loss": -0.003904791951127764, "vf_loss": 0.7878569339002882, "vf_explained_var": 0.062017432533243974, "kl": 0.006033304020735211, "entropy": 0.8103548405977784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 303345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000}, "env_runners": {"episode_reward_max": 52.0, "episode_reward_min": -92.0, "episode_reward_mean": 0.7, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -360.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 36.0, "predator_policy": 180.0}, "policy_reward_mean": {"prey_policy": -6.01, "predator_policy": 6.36}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.0, 0.0, -22.0, 21.0, -16.0, 0.0, -2.0, -15.0, 11.0, 0.0, 6.0, -3.0, -6.0, 0.0, 13.0, -6.0, -5.0, -2.0, -6.0, -1.0, 0.0, -92.0, 0.0, 22.0, -79.0, 14.0, 11.0, -12.0, 0.0, 14.0, 11.0, 0.0, -11.0, -9.0, 0.0, -6.0, -8.0, 11.0, -22.0, -13.0, -13.0, 0.0, 9.0, 9.0, -2.0, 0.0, -1.0, 1.0, 6.0, -29.0, 4.0, 7.0, 0.0, -5.0, -5.0, 5.0, 19.0, 9.0, -5.0, 18.0, 24.0, 1.0, 2.0, 0.0, 2.0, 0.0, 6.0, 29.0, 0.0, -6.0, 5.0, -1.0, 2.0, 15.0, -12.0, -5.0, 21.0, 0.0, 37.0, 0.0, -14.0, 9.0, 28.0, 40.0, -6.0, -37.0, 13.0, 16.0, 16.0, -3.0, 0.0, 0.0, 0.0, -19.0, -11.0, 34.0, 0.0, 52.0, -24.0, 5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6.0, 11.0, 0.0, 0.0, -50.0, 0.0, 21.0, 0.0, 0.0, -76.0, 0.0, 0.0, 0.0, -4.0, -12.0, -12.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, -360.0, 10.0, 0.0, -14.0, 0.0, 0.0, -6.0, 7.0, 0.0, -12.0, 0.0, -23.0, -4.0, 0.0, -12.0, 0.0, -2.0, 0.0, 0.0, 0.0, -37.0, -174.0, 0.0, -4.0, 20.0, -1.0, -93.0, -40.0, 14.0, 0.0, 10.0, 0.0, -31.0, 0.0, 0.0, 0.0, 1.0, 2.0, 0.0, 11.0, 0.0, 0.0, -14.0, -14.0, -19.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, -16.0, -8.0, 0.0, -39.0, -5.0, -26.0, 0.0, -26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, -10.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -8.0, 4.0, 0.0, -24.0, -23.0, 0.0, -7.0, 3.0, 4.0, 0.0, 0.0, 0.0, -10.0, 0.0, -10.0, 0.0, 5.0, 0.0, 11.0, 9.0, 0.0, -4.0, -6.0, 18.0, 0.0, 0.0, 24.0, -2.0, -9.0, 2.0, 0.0, 0.0, 0.0, -5.0, -5.0, 0.0, 0.0, 15.0, -18.0, 0.0, 29.0, 0.0, 0.0, -21.0, 0.0, 6.0, -22.0, 0.0, -8.0, 0.0, 2.0, -2.0, 2.0, -2.0, -22.0, -10.0, 0.0, 0.0, 17.0, 0.0, 0.0, -14.0, 24.0, 0.0, 0.0, -12.0, -8.0, 9.0, 0.0, -31.0, 33.0, 15.0, 23.0, -18.0, 2.0, -16.0, -42.0, 7.0, 5.0, 16.0, 0.0, 16.0, 0.0, 0.0, -18.0, 16.0, -39.0, 0.0, 0.0, 0.0, 0.0, -44.0, 0.0, 0.0, -22.0, 0.0, 11.0, 0.0, 0.0, 36.0, 6.0, -55.0, -8.0, -6.0, 0.0], "policy_predator_policy_reward": [9.0, 0.0, 0.0, 0.0, 26.0, 2.0, 0.0, 0.0, 22.0, 38.0, 0.0, 0.0, 2.0, 0.0, 9.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 167.0, 180.0, 7.0, 1.0, 0.0, 0.0, 0.0, 12.0, 6.0, 0.0, 10.0, 8.0, 0.0, 2.0, 0.0, 6.0, 0.0, 1.0, 0.0, 0.0, 97.0, 22.0, 4.0, 0.0, 3.0, 0.0, 31.0, 23.0, 0.0, 0.0, 1.0, 0.0, 3.0, 16.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 8.0, 0.0, 19.0, 0.0, 12.0, 10.0, 13.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 2.0, 0.0, 9.0, 9.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 5.0, 16.0, 7.0, 0.0, 0.0, 0.0, 15.0, 0.0, 11.0, 1.0, 5.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 17.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 17.0, 9.0, 0.0, 2.0, 5.0, 5.0, 21.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 6.0, 14.0, 9.0, 0.0, 0.0, 0.0, 0.0, 14.0, 11.0, 0.0, 11.0, 23.0, 0.0, 0.0, 0.0, 0.0, 10.0, 12.0, 27.0, 5.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1582579767814365, "mean_inference_ms": 3.558595210453876, "mean_action_processing_ms": 0.5118329463907857, "mean_env_wait_ms": 0.4146119892267252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02281773090362549, "StateBufferConnector_ms": 0.007979154586791992, "ViewRequirementAgentConnector_ms": 0.2517716884613037}, "num_episodes": 18, "episode_return_max": 52.0, "episode_return_min": -92.0, "episode_return_mean": 0.7, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.4395026190461, "num_env_steps_trained_throughput_per_sec": 287.4395026190461, "timesteps_total": 644000, "num_env_steps_sampled_lifetime": 644000, "num_agent_steps_sampled_lifetime": 2576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2576000, "timers": {"training_iteration_time_ms": 14428.258, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14428.208, "sample_time_ms": 2720.051, "learn_time_ms": 11686.215, "learn_throughput": 342.284, "synch_weights_time_ms": 18.694}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000}, "done": false, "training_iteration": 161, "trial_id": "e1352_00002", "date": "2024-08-13_19-57-37", "timestamp": 1723593457, "time_this_iter_s": 13.972611904144287, "time_total_s": 3341.627991437912, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e5a9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3341.627991437912, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 86.77999999999999, "ram_util_percent": 83.36999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8727220758243845, "cur_kl_coeff": 0.0084470272064209, "cur_lr": 0.00010000000000000003, "total_loss": 0.6083946788910205, "policy_loss": -0.0019332736755213725, "vf_loss": 0.610268328472893, "vf_explained_var": 0.008990981528367945, "kl": 0.007058409449714616, "entropy": 0.7104130476240128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 305235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.629492044787874, "cur_kl_coeff": 0.020295756409177558, "cur_lr": 0.00010000000000000003, "total_loss": 0.8581434544983995, "policy_loss": -0.004627302229138357, "vf_loss": 0.8625803861905027, "vf_explained_var": 0.06991119551910925, "kl": 0.009379631822880154, "entropy": 0.7674218870029248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 305235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000}, "env_runners": {"episode_reward_max": 52.0, "episode_reward_min": -92.0, "episode_reward_mean": 1.6, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -174.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 36.0, "predator_policy": 97.0}, "policy_reward_mean": {"prey_policy": -4.045, "predator_policy": 4.845}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0, -1.0, 0.0, -92.0, 0.0, 22.0, -79.0, 14.0, 11.0, -12.0, 0.0, 14.0, 11.0, 0.0, -11.0, -9.0, 0.0, -6.0, -8.0, 11.0, -22.0, -13.0, -13.0, 0.0, 9.0, 9.0, -2.0, 0.0, -1.0, 1.0, 6.0, -29.0, 4.0, 7.0, 0.0, -5.0, -5.0, 5.0, 19.0, 9.0, -5.0, 18.0, 24.0, 1.0, 2.0, 0.0, 2.0, 0.0, 6.0, 29.0, 0.0, -6.0, 5.0, -1.0, 2.0, 15.0, -12.0, -5.0, 21.0, 0.0, 37.0, 0.0, -14.0, 9.0, 28.0, 40.0, -6.0, -37.0, 13.0, 16.0, 16.0, -3.0, 0.0, 0.0, 0.0, -19.0, -11.0, 34.0, 0.0, 52.0, -24.0, 5.0, 0.0, 35.0, 0.0, -11.0, 0.0, 29.0, 0.0, -3.0, 6.0, 9.0, 0.0, -1.0, 23.0, 12.0, -6.0, 5.0, 0.0, -8.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.0, 0.0, -2.0, 0.0, 0.0, 0.0, -37.0, -174.0, 0.0, -4.0, 20.0, -1.0, -93.0, -40.0, 14.0, 0.0, 10.0, 0.0, -31.0, 0.0, 0.0, 0.0, 1.0, 2.0, 0.0, 11.0, 0.0, 0.0, -14.0, -14.0, -19.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, -16.0, -8.0, 0.0, -39.0, -5.0, -26.0, 0.0, -26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, -10.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -8.0, 4.0, 0.0, -24.0, -23.0, 0.0, -7.0, 3.0, 4.0, 0.0, 0.0, 0.0, -10.0, 0.0, -10.0, 0.0, 5.0, 0.0, 11.0, 9.0, 0.0, -4.0, -6.0, 18.0, 0.0, 0.0, 24.0, -2.0, -9.0, 2.0, 0.0, 0.0, 0.0, -5.0, -5.0, 0.0, 0.0, 15.0, -18.0, 0.0, 29.0, 0.0, 0.0, -21.0, 0.0, 6.0, -22.0, 0.0, -8.0, 0.0, 2.0, -2.0, 2.0, -2.0, -22.0, -10.0, 0.0, 0.0, 17.0, 0.0, 0.0, -14.0, 24.0, 0.0, 0.0, -12.0, -8.0, 9.0, 0.0, -31.0, 33.0, 15.0, 23.0, -18.0, 2.0, -16.0, -42.0, 7.0, 5.0, 16.0, 0.0, 16.0, 0.0, 0.0, -18.0, 16.0, -39.0, 0.0, 0.0, 0.0, 0.0, -44.0, 0.0, 0.0, -22.0, 0.0, 11.0, 0.0, 0.0, 36.0, 6.0, -55.0, -8.0, -6.0, 0.0, 0.0, 0.0, 0.0, 12.0, -1.0, -8.0, 0.0, -22.0, 0.0, -20.0, 0.0, -7.0, 0.0, 0.0, -20.0, -7.0, 3.0, -11.0, -2.0, -1.0, 0.0, 0.0, 0.0, -2.0, 0.0, 22.0, 3.0, -10.0, -12.0, 0.0, 0.0, -11.0, 0.0, 0.0, -6.0, -10.0], "policy_predator_policy_reward": [0.0, 6.0, 0.0, 1.0, 0.0, 0.0, 97.0, 22.0, 4.0, 0.0, 3.0, 0.0, 31.0, 23.0, 0.0, 0.0, 1.0, 0.0, 3.0, 16.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 8.0, 0.0, 19.0, 0.0, 12.0, 10.0, 13.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 2.0, 0.0, 9.0, 9.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 5.0, 16.0, 7.0, 0.0, 0.0, 0.0, 15.0, 0.0, 11.0, 1.0, 5.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 17.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 17.0, 9.0, 0.0, 2.0, 5.0, 5.0, 21.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 6.0, 14.0, 9.0, 0.0, 0.0, 0.0, 0.0, 14.0, 11.0, 0.0, 11.0, 23.0, 0.0, 0.0, 0.0, 0.0, 10.0, 12.0, 27.0, 5.0, 6.0, 0.0, 0.0, 23.0, 0.0, 0.0, 9.0, 0.0, 11.0, 11.0, 9.0, 20.0, 16.0, 0.0, 0.0, 10.0, 14.0, 14.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 5.0, 14.0, 0.0, 6.0, 9.0, 7.0, 0.0, 0.0, 5.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1587774773093336, "mean_inference_ms": 3.5602327979580797, "mean_action_processing_ms": 0.5117146109124193, "mean_env_wait_ms": 0.41465709865051836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02322995662689209, "StateBufferConnector_ms": 0.00796961784362793, "ViewRequirementAgentConnector_ms": 0.2519207000732422}, "num_episodes": 18, "episode_return_max": 52.0, "episode_return_min": -92.0, "episode_return_mean": 1.6, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.2288078019249, "num_env_steps_trained_throughput_per_sec": 277.2288078019249, "timesteps_total": 648000, "num_env_steps_sampled_lifetime": 648000, "num_agent_steps_sampled_lifetime": 2592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2592000, "timers": {"training_iteration_time_ms": 14383.499, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14383.449, "sample_time_ms": 2649.093, "learn_time_ms": 11712.246, "learn_throughput": 341.523, "synch_weights_time_ms": 18.935}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000}, "done": false, "training_iteration": 162, "trial_id": "e1352_00002", "date": "2024-08-13_19-57-52", "timestamp": 1723593472, "time_this_iter_s": 14.514960050582886, "time_total_s": 3356.142951488495, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f8cb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3356.142951488495, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 84.36000000000001, "ram_util_percent": 83.69500000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.317182365674821, "cur_kl_coeff": 0.0084470272064209, "cur_lr": 0.00010000000000000003, "total_loss": 1.6368891926038833, "policy_loss": -0.0014792701773956498, "vf_loss": 1.6383274397522054, "vf_explained_var": 0.02007139485979837, "kl": 0.0048570751360812806, "entropy": 0.6618713997028493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 307125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4673401479367856, "cur_kl_coeff": 0.020295756409177558, "cur_lr": 0.00010000000000000003, "total_loss": 1.6178799756935665, "policy_loss": -0.002996055845900503, "vf_loss": 1.620672198042037, "vf_explained_var": 0.06700171837731013, "kl": 0.0100430762940606, "entropy": 0.7512488547456327, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 307125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 2608000}, "env_runners": {"episode_reward_max": 115.0, "episode_reward_min": -37.0, "episode_reward_mean": 8.62, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 95.0, "predator_policy": 35.0}, "policy_reward_mean": {"prey_policy": -0.415, "predator_policy": 4.725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.0, 11.0, -22.0, -13.0, -13.0, 0.0, 9.0, 9.0, -2.0, 0.0, -1.0, 1.0, 6.0, -29.0, 4.0, 7.0, 0.0, -5.0, -5.0, 5.0, 19.0, 9.0, -5.0, 18.0, 24.0, 1.0, 2.0, 0.0, 2.0, 0.0, 6.0, 29.0, 0.0, -6.0, 5.0, -1.0, 2.0, 15.0, -12.0, -5.0, 21.0, 0.0, 37.0, 0.0, -14.0, 9.0, 28.0, 40.0, -6.0, -37.0, 13.0, 16.0, 16.0, -3.0, 0.0, 0.0, 0.0, -19.0, -11.0, 34.0, 0.0, 52.0, -24.0, 5.0, 0.0, 35.0, 0.0, -11.0, 0.0, 29.0, 0.0, -3.0, 6.0, 9.0, 0.0, -1.0, 23.0, 12.0, -6.0, 5.0, 0.0, -8.0, 0.0, 102.0, 96.0, 0.0, 0.0, 32.0, 84.0, 0.0, 0.0, 21.0, 0.0, 72.0, 14.0, -3.0, -21.0, 36.0, 10.0, 115.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -16.0, -8.0, 0.0, -39.0, -5.0, -26.0, 0.0, -26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, -10.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -8.0, 4.0, 0.0, -24.0, -23.0, 0.0, -7.0, 3.0, 4.0, 0.0, 0.0, 0.0, -10.0, 0.0, -10.0, 0.0, 5.0, 0.0, 11.0, 9.0, 0.0, -4.0, -6.0, 18.0, 0.0, 0.0, 24.0, -2.0, -9.0, 2.0, 0.0, 0.0, 0.0, -5.0, -5.0, 0.0, 0.0, 15.0, -18.0, 0.0, 29.0, 0.0, 0.0, -21.0, 0.0, 6.0, -22.0, 0.0, -8.0, 0.0, 2.0, -2.0, 2.0, -2.0, -22.0, -10.0, 0.0, 0.0, 17.0, 0.0, 0.0, -14.0, 24.0, 0.0, 0.0, -12.0, -8.0, 9.0, 0.0, -31.0, 33.0, 15.0, 23.0, -18.0, 2.0, -16.0, -42.0, 7.0, 5.0, 16.0, 0.0, 16.0, 0.0, 0.0, -18.0, 16.0, -39.0, 0.0, 0.0, 0.0, 0.0, -44.0, 0.0, 0.0, -22.0, 0.0, 11.0, 0.0, 0.0, 36.0, 6.0, -55.0, -8.0, -6.0, 0.0, 0.0, 0.0, 0.0, 12.0, -1.0, -8.0, 0.0, -22.0, 0.0, -20.0, 0.0, -7.0, 0.0, 0.0, -20.0, -7.0, 3.0, -11.0, -2.0, -1.0, 0.0, 0.0, 0.0, -2.0, 0.0, 22.0, 3.0, -10.0, -12.0, 0.0, 0.0, -11.0, 0.0, 0.0, -6.0, -10.0, 0.0, 0.0, 0.0, 93.0, 0.0, 95.0, 0.0, 0.0, 0.0, 0.0, 29.0, -10.0, 34.0, 30.0, 0.0, 0.0, 0.0, 0.0, -15.0, -2.0, 0.0, 0.0, 41.0, 0.0, 10.0, 0.0, -6.0, 0.0, -28.0, -10.0, 0.0, 26.0, 5.0, -17.0, 35.0, 21.0], "policy_predator_policy_reward": [8.0, 0.0, 19.0, 0.0, 12.0, 10.0, 13.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 2.0, 0.0, 9.0, 9.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 5.0, 16.0, 7.0, 0.0, 0.0, 0.0, 15.0, 0.0, 11.0, 1.0, 5.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 17.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 17.0, 9.0, 0.0, 2.0, 5.0, 5.0, 21.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 6.0, 14.0, 9.0, 0.0, 0.0, 0.0, 0.0, 14.0, 11.0, 0.0, 11.0, 23.0, 0.0, 0.0, 0.0, 0.0, 10.0, 12.0, 27.0, 5.0, 6.0, 0.0, 0.0, 23.0, 0.0, 0.0, 9.0, 0.0, 11.0, 11.0, 9.0, 20.0, 16.0, 0.0, 0.0, 10.0, 14.0, 14.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 5.0, 14.0, 0.0, 6.0, 9.0, 7.0, 0.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, 9.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 5.0, 12.0, 8.0, 0.0, 0.0, 0.0, 0.0, 17.0, 21.0, 0.0, 0.0, 31.0, 0.0, 0.0, 4.0, 3.0, 0.0, 17.0, 0.0, 8.0, 2.0, 0.0, 22.0, 35.0, 24.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1590555970811882, "mean_inference_ms": 3.5607319723470914, "mean_action_processing_ms": 0.511570985451362, "mean_env_wait_ms": 0.41464388119591983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022079944610595703, "StateBufferConnector_ms": 0.007942914962768555, "ViewRequirementAgentConnector_ms": 0.2713491916656494}, "num_episodes": 18, "episode_return_max": 115.0, "episode_return_min": -37.0, "episode_return_mean": 8.62, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 2608000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.2067695585421, "num_env_steps_trained_throughput_per_sec": 293.2067695585421, "timesteps_total": 652000, "num_env_steps_sampled_lifetime": 652000, "num_agent_steps_sampled_lifetime": 2608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2608000, "timers": {"training_iteration_time_ms": 14305.675, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14305.623, "sample_time_ms": 2654.014, "learn_time_ms": 11628.909, "learn_throughput": 343.97, "synch_weights_time_ms": 19.481}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 2608000}, "done": false, "training_iteration": 163, "trial_id": "e1352_00002", "date": "2024-08-13_19-58-05", "timestamp": 1723593485, "time_this_iter_s": 13.722689867019653, "time_total_s": 3369.8656413555145, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e68670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3369.8656413555145, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 80.515, "ram_util_percent": 83.75500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0716973193265775, "cur_kl_coeff": 0.00422351360321045, "cur_lr": 0.00010000000000000003, "total_loss": 1.8186173032831263, "policy_loss": -0.002178631322064176, "vf_loss": 1.820773429246176, "vf_explained_var": 0.020228573443397645, "kl": 0.005328128623882259, "entropy": 0.6555381264951494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 309015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2863361557640096, "cur_kl_coeff": 0.020295756409177558, "cur_lr": 0.00010000000000000003, "total_loss": 2.1784928042421896, "policy_loss": -0.007234011118413594, "vf_loss": 2.1854890500426922, "vf_explained_var": 0.07204928454898653, "kl": 0.011715376583364029, "entropy": 0.711488354237622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 309015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000}, "env_runners": {"episode_reward_max": 175.0, "episode_reward_min": -37.0, "episode_reward_mean": 14.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 120.0, "predator_policy": 53.0}, "policy_reward_mean": {"prey_policy": 1.56, "predator_policy": 5.86}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.0, 24.0, 1.0, 2.0, 0.0, 2.0, 0.0, 6.0, 29.0, 0.0, -6.0, 5.0, -1.0, 2.0, 15.0, -12.0, -5.0, 21.0, 0.0, 37.0, 0.0, -14.0, 9.0, 28.0, 40.0, -6.0, -37.0, 13.0, 16.0, 16.0, -3.0, 0.0, 0.0, 0.0, -19.0, -11.0, 34.0, 0.0, 52.0, -24.0, 5.0, 0.0, 35.0, 0.0, -11.0, 0.0, 29.0, 0.0, -3.0, 6.0, 9.0, 0.0, -1.0, 23.0, 12.0, -6.0, 5.0, 0.0, -8.0, 0.0, 102.0, 96.0, 0.0, 0.0, 32.0, 84.0, 0.0, 0.0, 21.0, 0.0, 72.0, 14.0, -3.0, -21.0, 36.0, 10.0, 115.0, 11.0, 0.0, -5.0, 175.0, 0.0, -3.0, 20.0, 143.0, 91.0, 37.0, 38.0, 0.0, 0.0, 2.0, -13.0, -4.0, 56.0, 45.0, -3.0, 5.0, 10.0, 0.0, -6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [18.0, 0.0, 0.0, 24.0, -2.0, -9.0, 2.0, 0.0, 0.0, 0.0, -5.0, -5.0, 0.0, 0.0, 15.0, -18.0, 0.0, 29.0, 0.0, 0.0, -21.0, 0.0, 6.0, -22.0, 0.0, -8.0, 0.0, 2.0, -2.0, 2.0, -2.0, -22.0, -10.0, 0.0, 0.0, 17.0, 0.0, 0.0, -14.0, 24.0, 0.0, 0.0, -12.0, -8.0, 9.0, 0.0, -31.0, 33.0, 15.0, 23.0, -18.0, 2.0, -16.0, -42.0, 7.0, 5.0, 16.0, 0.0, 16.0, 0.0, 0.0, -18.0, 16.0, -39.0, 0.0, 0.0, 0.0, 0.0, -44.0, 0.0, 0.0, -22.0, 0.0, 11.0, 0.0, 0.0, 36.0, 6.0, -55.0, -8.0, -6.0, 0.0, 0.0, 0.0, 0.0, 12.0, -1.0, -8.0, 0.0, -22.0, 0.0, -20.0, 0.0, -7.0, 0.0, 0.0, -20.0, -7.0, 3.0, -11.0, -2.0, -1.0, 0.0, 0.0, 0.0, -2.0, 0.0, 22.0, 3.0, -10.0, -12.0, 0.0, 0.0, -11.0, 0.0, 0.0, -6.0, -10.0, 0.0, 0.0, 0.0, 93.0, 0.0, 95.0, 0.0, 0.0, 0.0, 0.0, 29.0, -10.0, 34.0, 30.0, 0.0, 0.0, 0.0, 0.0, -15.0, -2.0, 0.0, 0.0, 41.0, 0.0, 10.0, 0.0, -6.0, 0.0, -28.0, -10.0, 0.0, 26.0, 5.0, -17.0, 35.0, 21.0, -1.0, 0.0, 0.0, 0.0, -10.0, 0.0, 42.0, 120.0, 0.0, 0.0, 0.0, -6.0, 25.0, -10.0, 70.0, 42.0, 64.0, 0.0, 19.0, 0.0, -16.0, 17.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, -4.0, -22.0, -8.0, 0.0, -23.0, -8.0, 0.0, 16.0, 0.0, -20.0, -10.0, -14.0, -6.0, -30.0, 0.0, 0.0, 0.0, -13.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 5.0, 16.0, 7.0, 0.0, 0.0, 0.0, 15.0, 0.0, 11.0, 1.0, 5.0, 0.0, 2.0, 2.0, 0.0, 0.0, 10.0, 17.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 17.0, 9.0, 0.0, 2.0, 5.0, 5.0, 21.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 6.0, 14.0, 9.0, 0.0, 0.0, 0.0, 0.0, 14.0, 11.0, 0.0, 11.0, 23.0, 0.0, 0.0, 0.0, 0.0, 10.0, 12.0, 27.0, 5.0, 6.0, 0.0, 0.0, 23.0, 0.0, 0.0, 9.0, 0.0, 11.0, 11.0, 9.0, 20.0, 16.0, 0.0, 0.0, 10.0, 14.0, 14.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 5.0, 14.0, 0.0, 6.0, 9.0, 7.0, 0.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, 9.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 5.0, 12.0, 8.0, 0.0, 0.0, 0.0, 0.0, 17.0, 21.0, 0.0, 0.0, 31.0, 0.0, 0.0, 4.0, 3.0, 0.0, 17.0, 0.0, 8.0, 2.0, 0.0, 22.0, 35.0, 24.0, 12.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 13.0, 0.0, 0.0, 3.0, 0.0, 0.0, 5.0, 4.0, 27.0, 11.0, 16.0, 0.0, 18.0, 20.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 2.0, 4.0, 0.0, 53.0, 34.0, 8.0, 21.0, 4.0, 13.0, 24.0, 5.0, 23.0, 23.0, 0.0, 0.0, 0.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1571784798102114, "mean_inference_ms": 3.5615460287707332, "mean_action_processing_ms": 0.5109759068094015, "mean_env_wait_ms": 0.41472975027372483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012177824974060059, "StateBufferConnector_ms": 0.010178685188293457, "ViewRequirementAgentConnector_ms": 0.24926912784576416}, "num_episodes": 23, "episode_return_max": 175.0, "episode_return_min": -37.0, "episode_return_mean": 14.84, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 242.12287812379338, "num_env_steps_trained_throughput_per_sec": 242.12287812379338, "timesteps_total": 656000, "num_env_steps_sampled_lifetime": 656000, "num_agent_steps_sampled_lifetime": 2624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2624000, "timers": {"training_iteration_time_ms": 14601.575, "restore_workers_time_ms": 0.022, "training_step_time_ms": 14601.519, "sample_time_ms": 2686.283, "learn_time_ms": 11892.981, "learn_throughput": 336.333, "synch_weights_time_ms": 19.274}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000}, "done": false, "training_iteration": 164, "trial_id": "e1352_00002", "date": "2024-08-13_19-58-22", "timestamp": 1723593502, "time_this_iter_s": 16.603410959243774, "time_total_s": 3386.4690523147583, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b984c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3386.4690523147583, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 93.31739130434784, "ram_util_percent": 83.47826086956522}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2411248308483254, "cur_kl_coeff": 0.00422351360321045, "cur_lr": 0.00010000000000000003, "total_loss": 1.7838700330446637, "policy_loss": -0.0017320833909300662, "vf_loss": 1.7855714425208076, "vf_explained_var": 0.04836316849819567, "kl": 0.0072627876973628495, "entropy": 0.628862302044712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 310905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.837596928048386, "cur_kl_coeff": 0.020295756409177558, "cur_lr": 0.00010000000000000003, "total_loss": 3.7797498353574643, "policy_loss": -0.002285920176162291, "vf_loss": 3.781951457230502, "vf_explained_var": 0.10955813937086277, "kl": 0.004153457496507183, "entropy": 0.7379000768775031, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 310905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "env_runners": {"episode_reward_max": 199.0, "episode_reward_min": -37.0, "episode_reward_mean": 30.6, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 132.0, "predator_policy": 53.0}, "policy_reward_mean": {"prey_policy": 7.79, "predator_policy": 7.51}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, 28.0, 40.0, -6.0, -37.0, 13.0, 16.0, 16.0, -3.0, 0.0, 0.0, 0.0, -19.0, -11.0, 34.0, 0.0, 52.0, -24.0, 5.0, 0.0, 35.0, 0.0, -11.0, 0.0, 29.0, 0.0, -3.0, 6.0, 9.0, 0.0, -1.0, 23.0, 12.0, -6.0, 5.0, 0.0, -8.0, 0.0, 102.0, 96.0, 0.0, 0.0, 32.0, 84.0, 0.0, 0.0, 21.0, 0.0, 72.0, 14.0, -3.0, -21.0, 36.0, 10.0, 115.0, 11.0, 0.0, -5.0, 175.0, 0.0, -3.0, 20.0, 143.0, 91.0, 37.0, 38.0, 0.0, 0.0, 2.0, -13.0, -4.0, 56.0, 45.0, -3.0, 5.0, 10.0, 0.0, -6.0, 49.0, 8.0, 91.0, 107.0, 113.0, 7.0, 185.0, 199.0, 82.0, -7.0, 72.0, 64.0, 15.0, 174.0, 179.0, 129.0, 104.0, -21.0, 22.0, 47.0, 45.0, 36.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [9.0, 0.0, -31.0, 33.0, 15.0, 23.0, -18.0, 2.0, -16.0, -42.0, 7.0, 5.0, 16.0, 0.0, 16.0, 0.0, 0.0, -18.0, 16.0, -39.0, 0.0, 0.0, 0.0, 0.0, -44.0, 0.0, 0.0, -22.0, 0.0, 11.0, 0.0, 0.0, 36.0, 6.0, -55.0, -8.0, -6.0, 0.0, 0.0, 0.0, 0.0, 12.0, -1.0, -8.0, 0.0, -22.0, 0.0, -20.0, 0.0, -7.0, 0.0, 0.0, -20.0, -7.0, 3.0, -11.0, -2.0, -1.0, 0.0, 0.0, 0.0, -2.0, 0.0, 22.0, 3.0, -10.0, -12.0, 0.0, 0.0, -11.0, 0.0, 0.0, -6.0, -10.0, 0.0, 0.0, 0.0, 93.0, 0.0, 95.0, 0.0, 0.0, 0.0, 0.0, 29.0, -10.0, 34.0, 30.0, 0.0, 0.0, 0.0, 0.0, -15.0, -2.0, 0.0, 0.0, 41.0, 0.0, 10.0, 0.0, -6.0, 0.0, -28.0, -10.0, 0.0, 26.0, 5.0, -17.0, 35.0, 21.0, -1.0, 0.0, 0.0, 0.0, -10.0, 0.0, 42.0, 120.0, 0.0, 0.0, 0.0, -6.0, 25.0, -10.0, 70.0, 42.0, 64.0, 0.0, 19.0, 0.0, -16.0, 17.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, -4.0, -22.0, -8.0, 0.0, -23.0, -8.0, 0.0, 16.0, 0.0, -20.0, -10.0, -14.0, -6.0, -30.0, 0.0, 0.0, 0.0, -13.0, -28.0, 0.0, -1.0, -12.0, 0.0, 71.0, -13.0, 96.0, 97.0, 0.0, -4.0, 0.0, 132.0, 53.0, 98.0, 77.0, 0.0, 70.0, -45.0, 0.0, 0.0, 44.0, 0.0, 19.0, 0.0, -17.0, 55.0, 94.0, 79.0, 74.0, 0.0, 128.0, 37.0, 41.0, -6.0, -32.0, 22.0, 0.0, 0.0, 43.0, 25.0, 0.0, 28.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 17.0, 9.0, 0.0, 2.0, 5.0, 5.0, 21.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 6.0, 14.0, 9.0, 0.0, 0.0, 0.0, 0.0, 14.0, 11.0, 0.0, 11.0, 23.0, 0.0, 0.0, 0.0, 0.0, 10.0, 12.0, 27.0, 5.0, 6.0, 0.0, 0.0, 23.0, 0.0, 0.0, 9.0, 0.0, 11.0, 11.0, 9.0, 20.0, 16.0, 0.0, 0.0, 10.0, 14.0, 14.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 5.0, 14.0, 0.0, 6.0, 9.0, 7.0, 0.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, 9.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 5.0, 12.0, 8.0, 0.0, 0.0, 0.0, 0.0, 17.0, 21.0, 0.0, 0.0, 31.0, 0.0, 0.0, 4.0, 3.0, 0.0, 17.0, 0.0, 8.0, 2.0, 0.0, 22.0, 35.0, 24.0, 12.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 13.0, 0.0, 0.0, 3.0, 0.0, 0.0, 5.0, 4.0, 27.0, 11.0, 16.0, 0.0, 18.0, 20.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 2.0, 4.0, 0.0, 53.0, 34.0, 8.0, 21.0, 4.0, 13.0, 24.0, 5.0, 23.0, 23.0, 0.0, 0.0, 0.0, 7.0, 27.0, 50.0, 7.0, 14.0, 1.0, 19.0, 22.0, 2.0, 0.0, 16.0, 8.0, 3.0, 0.0, 0.0, 24.0, 0.0, 12.0, 0.0, 11.0, 27.0, 3.0, 25.0, 21.0, 24.0, 32.0, 0.0, 20.0, 5.0, 6.0, 20.0, 0.0, 1.0, 26.0, 0.0, 11.0, 6.0, 0.0, 0.0, 4.0, 0.0, 20.0, 0.0, 0.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1571270910122735, "mean_inference_ms": 3.556234634552362, "mean_action_processing_ms": 0.5105256836855011, "mean_env_wait_ms": 0.4141409286826601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010149836540222168, "StateBufferConnector_ms": 0.008450865745544434, "ViewRequirementAgentConnector_ms": 0.18181943893432617}, "num_episodes": 22, "episode_return_max": 199.0, "episode_return_min": -37.0, "episode_return_mean": 30.6, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.1281920252722, "num_env_steps_trained_throughput_per_sec": 272.1281920252722, "timesteps_total": 660000, "num_env_steps_sampled_lifetime": 660000, "num_agent_steps_sampled_lifetime": 2640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2640000, "timers": {"training_iteration_time_ms": 14467.944, "restore_workers_time_ms": 0.023, "training_step_time_ms": 14467.886, "sample_time_ms": 2549.889, "learn_time_ms": 11897.226, "learn_throughput": 336.213, "synch_weights_time_ms": 18.23}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "done": false, "training_iteration": 165, "trial_id": "e1352_00002", "date": "2024-08-13_19-58-37", "timestamp": 1723593517, "time_this_iter_s": 14.770745754241943, "time_total_s": 3401.2397980690002, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f8cca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3401.2397980690002, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 88.41428571428571, "ram_util_percent": 83.01904761904763}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2742241080475862, "cur_kl_coeff": 0.00422351360321045, "cur_lr": 0.00010000000000000003, "total_loss": 2.7717987830045994, "policy_loss": -0.0059338460720720744, "vf_loss": 2.7776901185197174, "vf_explained_var": 0.030600435677028838, "kl": 0.010064604301327676, "entropy": 0.6700372032387547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 312795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8372277578979572, "cur_kl_coeff": 0.010147878204588779, "cur_lr": 0.00010000000000000003, "total_loss": 3.8391191053642797, "policy_loss": -0.001310802835394584, "vf_loss": 3.8403680100012076, "vf_explained_var": 0.07251212379289051, "kl": 0.006099793392998257, "entropy": 0.7619659230822609, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 312795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000}, "env_runners": {"episode_reward_max": 297.0, "episode_reward_min": -21.0, "episode_reward_mean": 41.25, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -77.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 157.0, "predator_policy": 87.0}, "policy_reward_mean": {"prey_policy": 11.375, "predator_policy": 9.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, 0.0, 35.0, 0.0, -11.0, 0.0, 29.0, 0.0, -3.0, 6.0, 9.0, 0.0, -1.0, 23.0, 12.0, -6.0, 5.0, 0.0, -8.0, 0.0, 102.0, 96.0, 0.0, 0.0, 32.0, 84.0, 0.0, 0.0, 21.0, 0.0, 72.0, 14.0, -3.0, -21.0, 36.0, 10.0, 115.0, 11.0, 0.0, -5.0, 175.0, 0.0, -3.0, 20.0, 143.0, 91.0, 37.0, 38.0, 0.0, 0.0, 2.0, -13.0, -4.0, 56.0, 45.0, -3.0, 5.0, 10.0, 0.0, -6.0, 49.0, 8.0, 91.0, 107.0, 113.0, 7.0, 185.0, 199.0, 82.0, -7.0, 72.0, 64.0, 15.0, 174.0, 179.0, 129.0, 104.0, -21.0, 22.0, 47.0, 45.0, 36.0, 36.0, 297.0, 126.0, 18.0, -4.0, 198.0, 0.0, 0.0, 171.0, 80.0, 29.0, 0.0, 8.0, 71.0, -10.0, 123.0, 38.0, -8.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, 0.0, 0.0, 0.0, 0.0, 12.0, -1.0, -8.0, 0.0, -22.0, 0.0, -20.0, 0.0, -7.0, 0.0, 0.0, -20.0, -7.0, 3.0, -11.0, -2.0, -1.0, 0.0, 0.0, 0.0, -2.0, 0.0, 22.0, 3.0, -10.0, -12.0, 0.0, 0.0, -11.0, 0.0, 0.0, -6.0, -10.0, 0.0, 0.0, 0.0, 93.0, 0.0, 95.0, 0.0, 0.0, 0.0, 0.0, 29.0, -10.0, 34.0, 30.0, 0.0, 0.0, 0.0, 0.0, -15.0, -2.0, 0.0, 0.0, 41.0, 0.0, 10.0, 0.0, -6.0, 0.0, -28.0, -10.0, 0.0, 26.0, 5.0, -17.0, 35.0, 21.0, -1.0, 0.0, 0.0, 0.0, -10.0, 0.0, 42.0, 120.0, 0.0, 0.0, 0.0, -6.0, 25.0, -10.0, 70.0, 42.0, 64.0, 0.0, 19.0, 0.0, -16.0, 17.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, -4.0, -22.0, -8.0, 0.0, -23.0, -8.0, 0.0, 16.0, 0.0, -20.0, -10.0, -14.0, -6.0, -30.0, 0.0, 0.0, 0.0, -13.0, -28.0, 0.0, -1.0, -12.0, 0.0, 71.0, -13.0, 96.0, 97.0, 0.0, -4.0, 0.0, 132.0, 53.0, 98.0, 77.0, 0.0, 70.0, -45.0, 0.0, 0.0, 44.0, 0.0, 19.0, 0.0, -17.0, 55.0, 94.0, 79.0, 74.0, 0.0, 128.0, 37.0, 41.0, -6.0, -32.0, 22.0, 0.0, 0.0, 43.0, 25.0, 0.0, 28.0, 0.0, 10.0, -77.0, 137.0, 157.0, 52.0, -34.0, 3.0, 0.0, -8.0, 0.0, 67.0, 84.0, 0.0, 0.0, 0.0, 0.0, 38.0, 133.0, 51.0, 0.0, 0.0, 29.0, 0.0, 0.0, 8.0, 0.0, 19.0, 0.0, -20.0, 0.0, -4.0, 125.0, -28.0, -59.0, 0.0, -64.0], "policy_predator_policy_reward": [5.0, 6.0, 0.0, 0.0, 23.0, 0.0, 0.0, 9.0, 0.0, 11.0, 11.0, 9.0, 20.0, 16.0, 0.0, 0.0, 10.0, 14.0, 14.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 5.0, 14.0, 0.0, 6.0, 9.0, 7.0, 0.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, 9.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 5.0, 12.0, 8.0, 0.0, 0.0, 0.0, 0.0, 17.0, 21.0, 0.0, 0.0, 31.0, 0.0, 0.0, 4.0, 3.0, 0.0, 17.0, 0.0, 8.0, 2.0, 0.0, 22.0, 35.0, 24.0, 12.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 13.0, 0.0, 0.0, 3.0, 0.0, 0.0, 5.0, 4.0, 27.0, 11.0, 16.0, 0.0, 18.0, 20.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 2.0, 4.0, 0.0, 53.0, 34.0, 8.0, 21.0, 4.0, 13.0, 24.0, 5.0, 23.0, 23.0, 0.0, 0.0, 0.0, 7.0, 27.0, 50.0, 7.0, 14.0, 1.0, 19.0, 22.0, 2.0, 0.0, 16.0, 8.0, 3.0, 0.0, 0.0, 24.0, 0.0, 12.0, 0.0, 11.0, 27.0, 3.0, 25.0, 21.0, 24.0, 32.0, 0.0, 20.0, 5.0, 6.0, 20.0, 0.0, 1.0, 26.0, 0.0, 11.0, 6.0, 0.0, 0.0, 4.0, 0.0, 20.0, 0.0, 0.0, 8.0, 49.0, 54.0, 0.0, 3.0, 53.0, 55.0, 15.0, 0.0, 0.0, 4.0, 0.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 23.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 36.0, 10.0, 0.0, 2.0, 0.0, 87.0, 38.0, 30.0, 26.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1560275794799344, "mean_inference_ms": 3.5537680892179817, "mean_action_processing_ms": 0.5100097311776239, "mean_env_wait_ms": 0.41388886146680415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007770895957946777, "StateBufferConnector_ms": 0.005836367607116699, "ViewRequirementAgentConnector_ms": 0.17689752578735352}, "num_episodes": 18, "episode_return_max": 297.0, "episode_return_min": -21.0, "episode_return_mean": 41.25, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.392823401932, "num_env_steps_trained_throughput_per_sec": 311.392823401932, "timesteps_total": 664000, "num_env_steps_sampled_lifetime": 664000, "num_agent_steps_sampled_lifetime": 2656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2656000, "timers": {"training_iteration_time_ms": 14418.006, "restore_workers_time_ms": 0.022, "training_step_time_ms": 14417.947, "sample_time_ms": 2559.881, "learn_time_ms": 11838.233, "learn_throughput": 337.888, "synch_weights_time_ms": 17.076}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000}, "done": false, "training_iteration": 166, "trial_id": "e1352_00002", "date": "2024-08-13_19-58-50", "timestamp": 1723593530, "time_this_iter_s": 12.902756929397583, "time_total_s": 3414.142554998398, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f42ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3414.142554998398, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 79.49444444444445, "ram_util_percent": 83.18888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.104477059541556, "cur_kl_coeff": 0.00422351360321045, "cur_lr": 0.00010000000000000003, "total_loss": 2.9465636334722003, "policy_loss": -0.005096115789341706, "vf_loss": 2.9516188648642685, "vf_explained_var": 0.01722053466019807, "kl": 0.009679502164992384, "entropy": 0.6343122764712288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 314685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.831322996420835, "cur_kl_coeff": 0.010147878204588779, "cur_lr": 0.00010000000000000003, "total_loss": 3.597793263228482, "policy_loss": -0.004640078718069369, "vf_loss": 3.6023378700175614, "vf_explained_var": 0.020633130855661222, "kl": 0.009409001120189858, "entropy": 0.76094302465676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 314685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 2672000}, "env_runners": {"episode_reward_max": 297.0, "episode_reward_min": -21.0, "episode_reward_mean": 47.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -110.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 157.0, "predator_policy": 87.0}, "policy_reward_mean": {"prey_policy": 12.33, "predator_policy": 11.59}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.0, 0.0, 102.0, 96.0, 0.0, 0.0, 32.0, 84.0, 0.0, 0.0, 21.0, 0.0, 72.0, 14.0, -3.0, -21.0, 36.0, 10.0, 115.0, 11.0, 0.0, -5.0, 175.0, 0.0, -3.0, 20.0, 143.0, 91.0, 37.0, 38.0, 0.0, 0.0, 2.0, -13.0, -4.0, 56.0, 45.0, -3.0, 5.0, 10.0, 0.0, -6.0, 49.0, 8.0, 91.0, 107.0, 113.0, 7.0, 185.0, 199.0, 82.0, -7.0, 72.0, 64.0, 15.0, 174.0, 179.0, 129.0, 104.0, -21.0, 22.0, 47.0, 45.0, 36.0, 36.0, 297.0, 126.0, 18.0, -4.0, 198.0, 0.0, 0.0, 171.0, 80.0, 29.0, 0.0, 8.0, 71.0, -10.0, 123.0, 38.0, -8.0, 91.0, 33.0, 111.0, 1.0, 143.0, 138.0, 37.0, -13.0, 46.0, 34.0, 94.0, 0.0, -5.0, 0.0, -8.0, 32.0, 28.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, -10.0, 0.0, 0.0, 0.0, 93.0, 0.0, 95.0, 0.0, 0.0, 0.0, 0.0, 29.0, -10.0, 34.0, 30.0, 0.0, 0.0, 0.0, 0.0, -15.0, -2.0, 0.0, 0.0, 41.0, 0.0, 10.0, 0.0, -6.0, 0.0, -28.0, -10.0, 0.0, 26.0, 5.0, -17.0, 35.0, 21.0, -1.0, 0.0, 0.0, 0.0, -10.0, 0.0, 42.0, 120.0, 0.0, 0.0, 0.0, -6.0, 25.0, -10.0, 70.0, 42.0, 64.0, 0.0, 19.0, 0.0, -16.0, 17.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, -4.0, -22.0, -8.0, 0.0, -23.0, -8.0, 0.0, 16.0, 0.0, -20.0, -10.0, -14.0, -6.0, -30.0, 0.0, 0.0, 0.0, -13.0, -28.0, 0.0, -1.0, -12.0, 0.0, 71.0, -13.0, 96.0, 97.0, 0.0, -4.0, 0.0, 132.0, 53.0, 98.0, 77.0, 0.0, 70.0, -45.0, 0.0, 0.0, 44.0, 0.0, 19.0, 0.0, -17.0, 55.0, 94.0, 79.0, 74.0, 0.0, 128.0, 37.0, 41.0, -6.0, -32.0, 22.0, 0.0, 0.0, 43.0, 25.0, 0.0, 28.0, 0.0, 10.0, -77.0, 137.0, 157.0, 52.0, -34.0, 3.0, 0.0, -8.0, 0.0, 67.0, 84.0, 0.0, 0.0, 0.0, 0.0, 38.0, 133.0, 51.0, 0.0, 0.0, 29.0, 0.0, 0.0, 8.0, 0.0, 19.0, 0.0, -20.0, 0.0, -4.0, 125.0, -28.0, -59.0, 0.0, -64.0, 76.0, 0.0, 0.0, -28.0, 0.0, 106.0, 0.0, 1.0, 27.0, 47.0, 51.0, -2.0, -27.0, 0.0, 25.0, -110.0, 0.0, 3.0, -18.0, -8.0, -40.0, 47.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, -16.0, 0.0, 29.0, -12.0, -50.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [5.0, 3.0, 0.0, 0.0, 0.0, 9.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 5.0, 12.0, 8.0, 0.0, 0.0, 0.0, 0.0, 17.0, 21.0, 0.0, 0.0, 31.0, 0.0, 0.0, 4.0, 3.0, 0.0, 17.0, 0.0, 8.0, 2.0, 0.0, 22.0, 35.0, 24.0, 12.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 13.0, 0.0, 0.0, 3.0, 0.0, 0.0, 5.0, 4.0, 27.0, 11.0, 16.0, 0.0, 18.0, 20.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 2.0, 4.0, 0.0, 53.0, 34.0, 8.0, 21.0, 4.0, 13.0, 24.0, 5.0, 23.0, 23.0, 0.0, 0.0, 0.0, 7.0, 27.0, 50.0, 7.0, 14.0, 1.0, 19.0, 22.0, 2.0, 0.0, 16.0, 8.0, 3.0, 0.0, 0.0, 24.0, 0.0, 12.0, 0.0, 11.0, 27.0, 3.0, 25.0, 21.0, 24.0, 32.0, 0.0, 20.0, 5.0, 6.0, 20.0, 0.0, 1.0, 26.0, 0.0, 11.0, 6.0, 0.0, 0.0, 4.0, 0.0, 20.0, 0.0, 0.0, 8.0, 49.0, 54.0, 0.0, 3.0, 53.0, 55.0, 15.0, 0.0, 0.0, 4.0, 0.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 23.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 36.0, 10.0, 0.0, 2.0, 0.0, 87.0, 38.0, 30.0, 26.0, 0.0, 15.0, 0.0, 61.0, 5.0, 0.0, 0.0, 0.0, 40.0, 29.0, 35.0, 54.0, 42.0, 22.0, 55.0, 17.0, 43.0, 0.0, 16.0, 44.0, 37.0, 50.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 3.0, 5.0, 4.0, 11.0, 42.0, 36.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1557185590872001, "mean_inference_ms": 3.5531852512096354, "mean_action_processing_ms": 0.5097054416404994, "mean_env_wait_ms": 0.41391493003636626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013704776763916016, "StateBufferConnector_ms": 0.013041377067565918, "ViewRequirementAgentConnector_ms": 0.19105315208435059}, "num_episodes": 18, "episode_return_max": 297.0, "episode_return_min": -21.0, "episode_return_mean": 47.84, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 2672000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 221.8130882368826, "num_env_steps_trained_throughput_per_sec": 221.8130882368826, "timesteps_total": 668000, "num_env_steps_sampled_lifetime": 668000, "num_agent_steps_sampled_lifetime": 2672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2672000, "timers": {"training_iteration_time_ms": 14780.323, "restore_workers_time_ms": 0.022, "training_step_time_ms": 14780.264, "sample_time_ms": 2721.734, "learn_time_ms": 12036.821, "learn_throughput": 332.314, "synch_weights_time_ms": 18.966}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 2672000}, "done": false, "training_iteration": 167, "trial_id": "e1352_00002", "date": "2024-08-13_19-59-08", "timestamp": 1723593548, "time_this_iter_s": 18.100014686584473, "time_total_s": 3432.2425696849823, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b984c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3432.2425696849823, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 87.85384615384616, "ram_util_percent": 83.01153846153845}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7241701839225634, "cur_kl_coeff": 0.00422351360321045, "cur_lr": 0.00010000000000000003, "total_loss": 3.9520743476019966, "policy_loss": -0.005737043532330996, "vf_loss": 3.9577605841651797, "vf_explained_var": 0.01465013692618678, "kl": 0.012027826312502073, "entropy": 0.5617849474861508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 316575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4603038819063276, "cur_kl_coeff": 0.010147878204588779, "cur_lr": 0.00010000000000000003, "total_loss": 3.8110328877413715, "policy_loss": -0.005529232948239912, "vf_loss": 3.816424927761946, "vf_explained_var": -0.018983273310636085, "kl": 0.0135197332295267, "entropy": 0.779908955633325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 316575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000}, "env_runners": {"episode_reward_max": 297.0, "episode_reward_min": -108.0, "episode_reward_mean": 47.76, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -295.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 157.0, "predator_policy": 117.0}, "policy_reward_mean": {"prey_policy": 7.855, "predator_policy": 16.025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [115.0, 11.0, 0.0, -5.0, 175.0, 0.0, -3.0, 20.0, 143.0, 91.0, 37.0, 38.0, 0.0, 0.0, 2.0, -13.0, -4.0, 56.0, 45.0, -3.0, 5.0, 10.0, 0.0, -6.0, 49.0, 8.0, 91.0, 107.0, 113.0, 7.0, 185.0, 199.0, 82.0, -7.0, 72.0, 64.0, 15.0, 174.0, 179.0, 129.0, 104.0, -21.0, 22.0, 47.0, 45.0, 36.0, 36.0, 297.0, 126.0, 18.0, -4.0, 198.0, 0.0, 0.0, 171.0, 80.0, 29.0, 0.0, 8.0, 71.0, -10.0, 123.0, 38.0, -8.0, 91.0, 33.0, 111.0, 1.0, 143.0, 138.0, 37.0, -13.0, 46.0, 34.0, 94.0, 0.0, -5.0, 0.0, -8.0, 32.0, 28.0, 0.0, 0.0, -16.0, 0.0, -7.0, -53.0, 19.0, 139.0, 8.0, -1.0, 53.0, 79.0, -27.0, 29.0, -19.0, 134.0, -108.0, 0.0, 197.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [35.0, 21.0, -1.0, 0.0, 0.0, 0.0, -10.0, 0.0, 42.0, 120.0, 0.0, 0.0, 0.0, -6.0, 25.0, -10.0, 70.0, 42.0, 64.0, 0.0, 19.0, 0.0, -16.0, 17.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, -4.0, -22.0, -8.0, 0.0, -23.0, -8.0, 0.0, 16.0, 0.0, -20.0, -10.0, -14.0, -6.0, -30.0, 0.0, 0.0, 0.0, -13.0, -28.0, 0.0, -1.0, -12.0, 0.0, 71.0, -13.0, 96.0, 97.0, 0.0, -4.0, 0.0, 132.0, 53.0, 98.0, 77.0, 0.0, 70.0, -45.0, 0.0, 0.0, 44.0, 0.0, 19.0, 0.0, -17.0, 55.0, 94.0, 79.0, 74.0, 0.0, 128.0, 37.0, 41.0, -6.0, -32.0, 22.0, 0.0, 0.0, 43.0, 25.0, 0.0, 28.0, 0.0, 10.0, -77.0, 137.0, 157.0, 52.0, -34.0, 3.0, 0.0, -8.0, 0.0, 67.0, 84.0, 0.0, 0.0, 0.0, 0.0, 38.0, 133.0, 51.0, 0.0, 0.0, 29.0, 0.0, 0.0, 8.0, 0.0, 19.0, 0.0, -20.0, 0.0, -4.0, 125.0, -28.0, -59.0, 0.0, -64.0, 76.0, 0.0, 0.0, -28.0, 0.0, 106.0, 0.0, 1.0, 27.0, 47.0, 51.0, -2.0, -27.0, 0.0, 25.0, -110.0, 0.0, 3.0, -18.0, -8.0, -40.0, 47.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, -16.0, 0.0, 29.0, -12.0, -50.0, 0.0, 0.0, 0.0, 0.0, 0.0, -78.0, -21.0, 0.0, 0.0, 2.0, -61.0, 0.0, -190.0, -3.0, 0.0, 0.0, 139.0, 0.0, -131.0, -2.0, 0.0, 0.0, -2.0, 43.0, 0.0, -123.0, 0.0, -43.0, -22.0, 0.0, -73.0, -4.0, 78.0, 0.0, -295.0, 0.0, 0.0, 49.0, 101.0], "policy_predator_policy_reward": [35.0, 24.0, 12.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 13.0, 0.0, 0.0, 3.0, 0.0, 0.0, 5.0, 4.0, 27.0, 11.0, 16.0, 0.0, 18.0, 20.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 2.0, 4.0, 0.0, 53.0, 34.0, 8.0, 21.0, 4.0, 13.0, 24.0, 5.0, 23.0, 23.0, 0.0, 0.0, 0.0, 7.0, 27.0, 50.0, 7.0, 14.0, 1.0, 19.0, 22.0, 2.0, 0.0, 16.0, 8.0, 3.0, 0.0, 0.0, 24.0, 0.0, 12.0, 0.0, 11.0, 27.0, 3.0, 25.0, 21.0, 24.0, 32.0, 0.0, 20.0, 5.0, 6.0, 20.0, 0.0, 1.0, 26.0, 0.0, 11.0, 6.0, 0.0, 0.0, 4.0, 0.0, 20.0, 0.0, 0.0, 8.0, 49.0, 54.0, 0.0, 3.0, 53.0, 55.0, 15.0, 0.0, 0.0, 4.0, 0.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 23.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 36.0, 10.0, 0.0, 2.0, 0.0, 87.0, 38.0, 30.0, 26.0, 0.0, 15.0, 0.0, 61.0, 5.0, 0.0, 0.0, 0.0, 40.0, 29.0, 35.0, 54.0, 42.0, 22.0, 55.0, 17.0, 43.0, 0.0, 16.0, 44.0, 37.0, 50.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 3.0, 5.0, 4.0, 11.0, 42.0, 36.0, 0.0, 0.0, 0.0, 0.0, 83.0, 0.0, 0.0, 0.0, 37.0, 15.0, 79.0, 58.0, 0.0, 22.0, 0.0, 0.0, 83.0, 56.0, 1.0, 0.0, 53.0, 2.0, 36.0, 0.0, 0.0, 96.0, 7.0, 87.0, 54.0, 0.0, 0.0, 60.0, 117.0, 70.0, 0.0, 0.0, 44.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1554267194107368, "mean_inference_ms": 3.552745605432533, "mean_action_processing_ms": 0.5093427867574833, "mean_env_wait_ms": 0.4139400922387337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013723969459533691, "StateBufferConnector_ms": 0.013287544250488281, "ViewRequirementAgentConnector_ms": 0.1712348461151123}, "num_episodes": 18, "episode_return_max": 297.0, "episode_return_min": -108.0, "episode_return_mean": 47.76, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 252.5860872068849, "num_env_steps_trained_throughput_per_sec": 252.5860872068849, "timesteps_total": 672000, "num_env_steps_sampled_lifetime": 672000, "num_agent_steps_sampled_lifetime": 2688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2688000, "timers": {"training_iteration_time_ms": 14930.282, "restore_workers_time_ms": 0.02, "training_step_time_ms": 14930.228, "sample_time_ms": 2658.678, "learn_time_ms": 12248.705, "learn_throughput": 326.565, "synch_weights_time_ms": 20.231}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000}, "done": false, "training_iteration": 168, "trial_id": "e1352_00002", "date": "2024-08-13_19-59-24", "timestamp": 1723593564, "time_this_iter_s": 15.935720920562744, "time_total_s": 3448.178290605545, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f724c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3448.178290605545, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 88.48181818181818, "ram_util_percent": 82.8590909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.602357128341362, "cur_kl_coeff": 0.00422351360321045, "cur_lr": 0.00010000000000000003, "total_loss": 3.9720118766108516, "policy_loss": -0.007451861739779512, "vf_loss": 3.9793057970269015, "vf_explained_var": 0.01391438438148095, "kl": 0.03739675291684798, "entropy": 0.5917503376328755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 318465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9383377924324976, "cur_kl_coeff": 0.010147878204588779, "cur_lr": 0.00010000000000000003, "total_loss": 3.5087159196535747, "policy_loss": -0.0015701660897494071, "vf_loss": 3.510219007951242, "vf_explained_var": -0.03892296136371673, "kl": 0.006609272337755582, "entropy": 0.7817820094565235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 318465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 2704000}, "env_runners": {"episode_reward_max": 297.0, "episode_reward_min": -136.0, "episode_reward_mean": 37.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -299.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 157.0, "predator_policy": 158.0}, "policy_reward_mean": {"prey_policy": -5.12, "predator_policy": 24.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [107.0, 113.0, 7.0, 185.0, 199.0, 82.0, -7.0, 72.0, 64.0, 15.0, 174.0, 179.0, 129.0, 104.0, -21.0, 22.0, 47.0, 45.0, 36.0, 36.0, 297.0, 126.0, 18.0, -4.0, 198.0, 0.0, 0.0, 171.0, 80.0, 29.0, 0.0, 8.0, 71.0, -10.0, 123.0, 38.0, -8.0, 91.0, 33.0, 111.0, 1.0, 143.0, 138.0, 37.0, -13.0, 46.0, 34.0, 94.0, 0.0, -5.0, 0.0, -8.0, 32.0, 28.0, 0.0, 0.0, -16.0, 0.0, -7.0, -53.0, 19.0, 139.0, 8.0, -1.0, 53.0, 79.0, -27.0, 29.0, -19.0, 134.0, -108.0, 0.0, 197.0, 26.0, 70.0, -42.0, -10.0, 42.0, 0.0, -6.0, -14.0, -76.0, 157.0, -67.0, -19.0, 28.0, 78.0, -90.0, 0.0, -7.0, 0.0, 0.0, -66.0, 83.0, -136.0, 25.0, -75.0, -14.0, 0.0, -15.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.0, 96.0, 97.0, 0.0, -4.0, 0.0, 132.0, 53.0, 98.0, 77.0, 0.0, 70.0, -45.0, 0.0, 0.0, 44.0, 0.0, 19.0, 0.0, -17.0, 55.0, 94.0, 79.0, 74.0, 0.0, 128.0, 37.0, 41.0, -6.0, -32.0, 22.0, 0.0, 0.0, 43.0, 25.0, 0.0, 28.0, 0.0, 10.0, -77.0, 137.0, 157.0, 52.0, -34.0, 3.0, 0.0, -8.0, 0.0, 67.0, 84.0, 0.0, 0.0, 0.0, 0.0, 38.0, 133.0, 51.0, 0.0, 0.0, 29.0, 0.0, 0.0, 8.0, 0.0, 19.0, 0.0, -20.0, 0.0, -4.0, 125.0, -28.0, -59.0, 0.0, -64.0, 76.0, 0.0, 0.0, -28.0, 0.0, 106.0, 0.0, 1.0, 27.0, 47.0, 51.0, -2.0, -27.0, 0.0, 25.0, -110.0, 0.0, 3.0, -18.0, -8.0, -40.0, 47.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, -16.0, 0.0, 29.0, -12.0, -50.0, 0.0, 0.0, 0.0, 0.0, 0.0, -78.0, -21.0, 0.0, 0.0, 2.0, -61.0, 0.0, -190.0, -3.0, 0.0, 0.0, 139.0, 0.0, -131.0, -2.0, 0.0, 0.0, -2.0, 43.0, 0.0, -123.0, 0.0, -43.0, -22.0, 0.0, -73.0, -4.0, 78.0, 0.0, -295.0, 0.0, 0.0, 49.0, 101.0, -52.0, -2.0, 0.0, 12.0, -151.0, -4.0, 0.0, -102.0, 42.0, 0.0, 0.0, 0.0, 0.0, -12.0, -74.0, 0.0, -299.0, -69.0, 0.0, 157.0, 0.0, -259.0, -2.0, -204.0, 20.0, 0.0, -4.0, 28.0, 0.0, -211.0, 0.0, 0.0, -26.0, -3.0, 0.0, 0.0, 0.0, 0.0, -195.0, 0.0, -7.0, 5.0, -89.0, -264.0, -60.0, 0.0, -155.0, -66.0, 0.0, -150.0, 0.0, 0.0, 0.0, -97.0], "policy_predator_policy_reward": [22.0, 2.0, 0.0, 16.0, 8.0, 3.0, 0.0, 0.0, 24.0, 0.0, 12.0, 0.0, 11.0, 27.0, 3.0, 25.0, 21.0, 24.0, 32.0, 0.0, 20.0, 5.0, 6.0, 20.0, 0.0, 1.0, 26.0, 0.0, 11.0, 6.0, 0.0, 0.0, 4.0, 0.0, 20.0, 0.0, 0.0, 8.0, 49.0, 54.0, 0.0, 3.0, 53.0, 55.0, 15.0, 0.0, 0.0, 4.0, 0.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 23.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 36.0, 10.0, 0.0, 2.0, 0.0, 87.0, 38.0, 30.0, 26.0, 0.0, 15.0, 0.0, 61.0, 5.0, 0.0, 0.0, 0.0, 40.0, 29.0, 35.0, 54.0, 42.0, 22.0, 55.0, 17.0, 43.0, 0.0, 16.0, 44.0, 37.0, 50.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 3.0, 5.0, 4.0, 11.0, 42.0, 36.0, 0.0, 0.0, 0.0, 0.0, 83.0, 0.0, 0.0, 0.0, 37.0, 15.0, 79.0, 58.0, 0.0, 22.0, 0.0, 0.0, 83.0, 56.0, 1.0, 0.0, 53.0, 2.0, 36.0, 0.0, 0.0, 96.0, 7.0, 87.0, 54.0, 0.0, 0.0, 60.0, 117.0, 70.0, 0.0, 0.0, 44.0, 3.0, 0.0, 80.0, 0.0, 58.0, 66.0, 47.0, 34.0, 58.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 60.0, 0.0, 134.0, 158.0, 0.0, 0.0, 108.0, 84.0, 107.0, 80.0, 0.0, 8.0, 0.0, 54.0, 121.0, 0.0, 0.0, 0.0, 7.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 129.0, 85.0, 0.0, 85.0, 132.0, 0.0, 85.0, 146.0, 0.0, 53.0, 83.0, 0.0, 0.0, 34.0, 48.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1548265301060456, "mean_inference_ms": 3.5504712669202667, "mean_action_processing_ms": 0.5085217974347394, "mean_env_wait_ms": 0.4137050555097615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017087221145629883, "StateBufferConnector_ms": 0.011735200881958008, "ViewRequirementAgentConnector_ms": 0.19712090492248535}, "num_episodes": 27, "episode_return_max": 297.0, "episode_return_min": -136.0, "episode_return_mean": 37.86, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 2704000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.28974593585644, "num_env_steps_trained_throughput_per_sec": 305.28974593585644, "timesteps_total": 676000, "num_env_steps_sampled_lifetime": 676000, "num_agent_steps_sampled_lifetime": 2704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2704000, "timers": {"training_iteration_time_ms": 14796.035, "restore_workers_time_ms": 0.02, "training_step_time_ms": 14795.981, "sample_time_ms": 2554.596, "learn_time_ms": 12218.278, "learn_throughput": 327.378, "synch_weights_time_ms": 20.316}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 2704000}, "done": false, "training_iteration": 169, "trial_id": "e1352_00002", "date": "2024-08-13_19-59-37", "timestamp": 1723593577, "time_this_iter_s": 13.18932580947876, "time_total_s": 3461.367616415024, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f9bb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3461.367616415024, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 77.78421052631579, "ram_util_percent": 82.7421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7829426215123876, "cur_kl_coeff": 0.006335270404815672, "cur_lr": 0.00010000000000000003, "total_loss": 4.132778406269336, "policy_loss": -0.0011273383746840178, "vf_loss": 4.133870206308113, "vf_explained_var": 0.00568738649131129, "kl": 0.005608415952347079, "entropy": 0.5788801097365284, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 320355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0313424892841825, "cur_kl_coeff": 0.010147878204588779, "cur_lr": 0.00010000000000000003, "total_loss": 3.4706179627665765, "policy_loss": -0.015707871468772214, "vf_loss": 3.4857683060661193, "vf_explained_var": -0.015161501982855418, "kl": 0.054939265271017064, "entropy": 0.8287387472611887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 320355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "env_runners": {"episode_reward_max": 335.0, "episode_reward_min": -136.0, "episode_reward_mean": 19.62, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -340.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 169.0, "predator_policy": 158.0}, "policy_reward_mean": {"prey_policy": -22.51, "predator_policy": 32.32}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.0, 36.0, 297.0, 126.0, 18.0, -4.0, 198.0, 0.0, 0.0, 171.0, 80.0, 29.0, 0.0, 8.0, 71.0, -10.0, 123.0, 38.0, -8.0, 91.0, 33.0, 111.0, 1.0, 143.0, 138.0, 37.0, -13.0, 46.0, 34.0, 94.0, 0.0, -5.0, 0.0, -8.0, 32.0, 28.0, 0.0, 0.0, -16.0, 0.0, -7.0, -53.0, 19.0, 139.0, 8.0, -1.0, 53.0, 79.0, -27.0, 29.0, -19.0, 134.0, -108.0, 0.0, 197.0, 26.0, 70.0, -42.0, -10.0, 42.0, 0.0, -6.0, -14.0, -76.0, 157.0, -67.0, -19.0, 28.0, 78.0, -90.0, 0.0, -7.0, 0.0, 0.0, -66.0, 83.0, -136.0, 25.0, -75.0, -14.0, 0.0, -15.0, -4.0, 335.0, -1.0, -74.0, -56.0, 0.0, -67.0, -33.0, -70.0, -46.0, -79.0, -26.0, -17.0, -26.0, 0.0, 0.0, -54.0, -90.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [28.0, 0.0, 10.0, -77.0, 137.0, 157.0, 52.0, -34.0, 3.0, 0.0, -8.0, 0.0, 67.0, 84.0, 0.0, 0.0, 0.0, 0.0, 38.0, 133.0, 51.0, 0.0, 0.0, 29.0, 0.0, 0.0, 8.0, 0.0, 19.0, 0.0, -20.0, 0.0, -4.0, 125.0, -28.0, -59.0, 0.0, -64.0, 76.0, 0.0, 0.0, -28.0, 0.0, 106.0, 0.0, 1.0, 27.0, 47.0, 51.0, -2.0, -27.0, 0.0, 25.0, -110.0, 0.0, 3.0, -18.0, -8.0, -40.0, 47.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, -16.0, 0.0, 29.0, -12.0, -50.0, 0.0, 0.0, 0.0, 0.0, 0.0, -78.0, -21.0, 0.0, 0.0, 2.0, -61.0, 0.0, -190.0, -3.0, 0.0, 0.0, 139.0, 0.0, -131.0, -2.0, 0.0, 0.0, -2.0, 43.0, 0.0, -123.0, 0.0, -43.0, -22.0, 0.0, -73.0, -4.0, 78.0, 0.0, -295.0, 0.0, 0.0, 49.0, 101.0, -52.0, -2.0, 0.0, 12.0, -151.0, -4.0, 0.0, -102.0, 42.0, 0.0, 0.0, 0.0, 0.0, -12.0, -74.0, 0.0, -299.0, -69.0, 0.0, 157.0, 0.0, -259.0, -2.0, -204.0, 20.0, 0.0, -4.0, 28.0, 0.0, -211.0, 0.0, 0.0, -26.0, -3.0, 0.0, 0.0, 0.0, 0.0, -195.0, 0.0, -7.0, 5.0, -89.0, -264.0, -60.0, 0.0, -155.0, -66.0, 0.0, -150.0, 0.0, 0.0, 0.0, -97.0, -24.0, -38.0, 166.0, 169.0, 0.0, -4.0, -185.0, -57.0, -139.0, 0.0, 0.0, 0.0, -319.0, 0.0, -74.0, -44.0, 0.0, -153.0, -16.0, -250.0, 0.0, -340.0, 0.0, -67.0, -59.0, 0.0, 0.0, -336.0, 0.0, 0.0, 0.0, 0.0, 0.0, -305.0, -198.0, -38.0], "policy_predator_policy_reward": [0.0, 8.0, 49.0, 54.0, 0.0, 3.0, 53.0, 55.0, 15.0, 0.0, 0.0, 4.0, 0.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 23.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 36.0, 10.0, 0.0, 2.0, 0.0, 87.0, 38.0, 30.0, 26.0, 0.0, 15.0, 0.0, 61.0, 5.0, 0.0, 0.0, 0.0, 40.0, 29.0, 35.0, 54.0, 42.0, 22.0, 55.0, 17.0, 43.0, 0.0, 16.0, 44.0, 37.0, 50.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 3.0, 5.0, 4.0, 11.0, 42.0, 36.0, 0.0, 0.0, 0.0, 0.0, 83.0, 0.0, 0.0, 0.0, 37.0, 15.0, 79.0, 58.0, 0.0, 22.0, 0.0, 0.0, 83.0, 56.0, 1.0, 0.0, 53.0, 2.0, 36.0, 0.0, 0.0, 96.0, 7.0, 87.0, 54.0, 0.0, 0.0, 60.0, 117.0, 70.0, 0.0, 0.0, 44.0, 3.0, 0.0, 80.0, 0.0, 58.0, 66.0, 47.0, 34.0, 58.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 60.0, 0.0, 134.0, 158.0, 0.0, 0.0, 108.0, 84.0, 107.0, 80.0, 0.0, 8.0, 0.0, 54.0, 121.0, 0.0, 0.0, 0.0, 7.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 129.0, 85.0, 0.0, 85.0, 132.0, 0.0, 85.0, 146.0, 0.0, 53.0, 83.0, 0.0, 0.0, 34.0, 48.0, 30.0, 28.0, 0.0, 0.0, 2.0, 1.0, 93.0, 75.0, 0.0, 83.0, 0.0, 0.0, 127.0, 125.0, 52.0, 33.0, 83.0, 0.0, 87.0, 133.0, 133.0, 128.0, 41.0, 0.0, 30.0, 12.0, 152.0, 158.0, 0.0, 0.0, 0.0, 0.0, 149.0, 102.0, 0.0, 146.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1566245426023818, "mean_inference_ms": 3.556460235429425, "mean_action_processing_ms": 0.509134820092412, "mean_env_wait_ms": 0.4144933580355415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026196718215942383, "StateBufferConnector_ms": 0.011749505996704102, "ViewRequirementAgentConnector_ms": 0.21898746490478516}, "num_episodes": 18, "episode_return_max": 335.0, "episode_return_min": -136.0, "episode_return_mean": 19.62, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 227.7417200790164, "num_env_steps_trained_throughput_per_sec": 227.7417200790164, "timesteps_total": 680000, "num_env_steps_sampled_lifetime": 680000, "num_agent_steps_sampled_lifetime": 2720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2720000, "timers": {"training_iteration_time_ms": 15058.727, "restore_workers_time_ms": 0.02, "training_step_time_ms": 15058.673, "sample_time_ms": 2800.063, "learn_time_ms": 12234.388, "learn_throughput": 326.947, "synch_weights_time_ms": 21.702}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "done": false, "training_iteration": 170, "trial_id": "e1352_00002", "date": "2024-08-13_19-59-55", "timestamp": 1723593595, "time_this_iter_s": 17.659520864486694, "time_total_s": 3479.0271372795105, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f42430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3479.0271372795105, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 80.208, "ram_util_percent": 83.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.205733095558863, "cur_kl_coeff": 0.006335270404815672, "cur_lr": 0.00010000000000000003, "total_loss": 2.5863604367725435, "policy_loss": -0.00041023899909483377, "vf_loss": 2.5867439948692525, "vf_explained_var": 0.006138294840615893, "kl": 0.004211719574950677, "entropy": 0.41679176606198465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 322245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0886976633437726, "cur_kl_coeff": 0.015221817306883163, "cur_lr": 0.00010000000000000003, "total_loss": 1.9377865919045039, "policy_loss": -0.00461313978783668, "vf_loss": 1.9421709369414697, "vf_explained_var": -0.011207234481024364, "kl": 0.015030915355062962, "entropy": 0.810542867707197, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 322245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 2736000}, "env_runners": {"episode_reward_max": 335.0, "episode_reward_min": -136.0, "episode_reward_mean": 3.43, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -340.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 169.0, "predator_policy": 158.0}, "policy_reward_mean": {"prey_policy": -33.72, "predator_policy": 35.435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.0, 91.0, 33.0, 111.0, 1.0, 143.0, 138.0, 37.0, -13.0, 46.0, 34.0, 94.0, 0.0, -5.0, 0.0, -8.0, 32.0, 28.0, 0.0, 0.0, -16.0, 0.0, -7.0, -53.0, 19.0, 139.0, 8.0, -1.0, 53.0, 79.0, -27.0, 29.0, -19.0, 134.0, -108.0, 0.0, 197.0, 26.0, 70.0, -42.0, -10.0, 42.0, 0.0, -6.0, -14.0, -76.0, 157.0, -67.0, -19.0, 28.0, 78.0, -90.0, 0.0, -7.0, 0.0, 0.0, -66.0, 83.0, -136.0, 25.0, -75.0, -14.0, 0.0, -15.0, -4.0, 335.0, -1.0, -74.0, -56.0, 0.0, -67.0, -33.0, -70.0, -46.0, -79.0, -26.0, -17.0, -26.0, 0.0, 0.0, -54.0, -90.0, 0.0, -29.0, 0.0, -6.0, -124.0, 0.0, -5.0, 0.0, -4.0, -7.0, 16.0, 50.0, -47.0, -40.0, -94.0, -79.0, -14.0, -19.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -64.0, 76.0, 0.0, 0.0, -28.0, 0.0, 106.0, 0.0, 1.0, 27.0, 47.0, 51.0, -2.0, -27.0, 0.0, 25.0, -110.0, 0.0, 3.0, -18.0, -8.0, -40.0, 47.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, -16.0, 0.0, 29.0, -12.0, -50.0, 0.0, 0.0, 0.0, 0.0, 0.0, -78.0, -21.0, 0.0, 0.0, 2.0, -61.0, 0.0, -190.0, -3.0, 0.0, 0.0, 139.0, 0.0, -131.0, -2.0, 0.0, 0.0, -2.0, 43.0, 0.0, -123.0, 0.0, -43.0, -22.0, 0.0, -73.0, -4.0, 78.0, 0.0, -295.0, 0.0, 0.0, 49.0, 101.0, -52.0, -2.0, 0.0, 12.0, -151.0, -4.0, 0.0, -102.0, 42.0, 0.0, 0.0, 0.0, 0.0, -12.0, -74.0, 0.0, -299.0, -69.0, 0.0, 157.0, 0.0, -259.0, -2.0, -204.0, 20.0, 0.0, -4.0, 28.0, 0.0, -211.0, 0.0, 0.0, -26.0, -3.0, 0.0, 0.0, 0.0, 0.0, -195.0, 0.0, -7.0, 5.0, -89.0, -264.0, -60.0, 0.0, -155.0, -66.0, 0.0, -150.0, 0.0, 0.0, 0.0, -97.0, -24.0, -38.0, 166.0, 169.0, 0.0, -4.0, -185.0, -57.0, -139.0, 0.0, 0.0, 0.0, -319.0, 0.0, -74.0, -44.0, 0.0, -153.0, -16.0, -250.0, 0.0, -340.0, 0.0, -67.0, -59.0, 0.0, 0.0, -336.0, 0.0, 0.0, 0.0, 0.0, 0.0, -305.0, -198.0, -38.0, 0.0, 0.0, -143.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, -263.0, 0.0, 0.0, -53.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -14.0, 7.0, 0.0, 0.0, -133.0, -244.0, -26.0, -154.0, 0.0, -83.0, -145.0, -179.0, 0.0, -6.0, -22.0, -54.0, 1.0], "policy_predator_policy_reward": [30.0, 26.0, 0.0, 15.0, 0.0, 61.0, 5.0, 0.0, 0.0, 0.0, 40.0, 29.0, 35.0, 54.0, 42.0, 22.0, 55.0, 17.0, 43.0, 0.0, 16.0, 44.0, 37.0, 50.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 3.0, 5.0, 4.0, 11.0, 42.0, 36.0, 0.0, 0.0, 0.0, 0.0, 83.0, 0.0, 0.0, 0.0, 37.0, 15.0, 79.0, 58.0, 0.0, 22.0, 0.0, 0.0, 83.0, 56.0, 1.0, 0.0, 53.0, 2.0, 36.0, 0.0, 0.0, 96.0, 7.0, 87.0, 54.0, 0.0, 0.0, 60.0, 117.0, 70.0, 0.0, 0.0, 44.0, 3.0, 0.0, 80.0, 0.0, 58.0, 66.0, 47.0, 34.0, 58.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 60.0, 0.0, 134.0, 158.0, 0.0, 0.0, 108.0, 84.0, 107.0, 80.0, 0.0, 8.0, 0.0, 54.0, 121.0, 0.0, 0.0, 0.0, 7.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 129.0, 85.0, 0.0, 85.0, 132.0, 0.0, 85.0, 146.0, 0.0, 53.0, 83.0, 0.0, 0.0, 34.0, 48.0, 30.0, 28.0, 0.0, 0.0, 2.0, 1.0, 93.0, 75.0, 0.0, 83.0, 0.0, 0.0, 127.0, 125.0, 52.0, 33.0, 83.0, 0.0, 87.0, 133.0, 133.0, 128.0, 41.0, 0.0, 30.0, 12.0, 152.0, 158.0, 0.0, 0.0, 0.0, 0.0, 149.0, 102.0, 0.0, 146.0, 0.0, 0.0, 61.0, 53.0, 0.0, 0.0, 6.0, 0.0, 139.0, 0.0, 0.0, 0.0, 13.0, 35.0, 0.0, 0.0, 4.0, 0.0, 0.0, 7.0, 0.0, 9.0, 78.0, 105.0, 121.0, 102.0, 114.0, 0.0, 74.0, 60.0, 0.0, 100.0, 14.0, 0.0, 34.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1602863616324746, "mean_inference_ms": 3.565670576772874, "mean_action_processing_ms": 0.5100413819255415, "mean_env_wait_ms": 0.41570797587556413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02733898162841797, "StateBufferConnector_ms": 0.012402772903442383, "ViewRequirementAgentConnector_ms": 0.35829877853393555}, "num_episodes": 18, "episode_return_max": 335.0, "episode_return_min": -136.0, "episode_return_mean": 3.43, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 2736000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 176.645644838588, "num_env_steps_trained_throughput_per_sec": 176.645644838588, "timesteps_total": 684000, "num_env_steps_sampled_lifetime": 684000, "num_agent_steps_sampled_lifetime": 2736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2736000, "timers": {"training_iteration_time_ms": 15931.55, "restore_workers_time_ms": 0.021, "training_step_time_ms": 15931.496, "sample_time_ms": 3178.677, "learn_time_ms": 12728.95, "learn_throughput": 314.244, "synch_weights_time_ms": 21.807}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 2736000}, "done": false, "training_iteration": 171, "trial_id": "e1352_00002", "date": "2024-08-13_20-00-18", "timestamp": 1723593618, "time_this_iter_s": 22.726118803024292, "time_total_s": 3501.753256082535, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1681d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3501.753256082535, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 92.63030303030304, "ram_util_percent": 83.88787878787878}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.30391880288799, "cur_kl_coeff": 0.003167635202407836, "cur_lr": 0.00010000000000000003, "total_loss": 3.07033418435899, "policy_loss": -0.0008426265931496072, "vf_loss": 3.071165225303993, "vf_explained_var": 0.003989559916592149, "kl": 0.0036555869465648176, "entropy": 0.41651994297428735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 324135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.091090465411938, "cur_kl_coeff": 0.015221817306883163, "cur_lr": 0.00010000000000000003, "total_loss": 2.5513217905841805, "policy_loss": -0.0037708399521689567, "vf_loss": 2.554980608142873, "vf_explained_var": 0.000356764105892686, "kl": 0.007359120630007484, "entropy": 0.8372197083695225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 324135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000}, "env_runners": {"episode_reward_max": 335.0, "episode_reward_min": -143.0, "episode_reward_mean": -9.44, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -356.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 169.0, "predator_policy": 174.0}, "policy_reward_mean": {"prey_policy": -44.785, "predator_policy": 40.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, -16.0, 0.0, -7.0, -53.0, 19.0, 139.0, 8.0, -1.0, 53.0, 79.0, -27.0, 29.0, -19.0, 134.0, -108.0, 0.0, 197.0, 26.0, 70.0, -42.0, -10.0, 42.0, 0.0, -6.0, -14.0, -76.0, 157.0, -67.0, -19.0, 28.0, 78.0, -90.0, 0.0, -7.0, 0.0, 0.0, -66.0, 83.0, -136.0, 25.0, -75.0, -14.0, 0.0, -15.0, -4.0, 335.0, -1.0, -74.0, -56.0, 0.0, -67.0, -33.0, -70.0, -46.0, -79.0, -26.0, -17.0, -26.0, 0.0, 0.0, -54.0, -90.0, 0.0, -29.0, 0.0, -6.0, -124.0, 0.0, -5.0, 0.0, -4.0, -7.0, 16.0, 50.0, -47.0, -40.0, -94.0, -79.0, -14.0, -19.0, 0.0, 0.0, 0.0, -61.0, -143.0, -106.0, -22.0, -123.0, 28.0, 15.0, -3.0, -12.0, 0.0, 0.0, -44.0, 24.0, -67.0, -19.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, -78.0, -21.0, 0.0, 0.0, 2.0, -61.0, 0.0, -190.0, -3.0, 0.0, 0.0, 139.0, 0.0, -131.0, -2.0, 0.0, 0.0, -2.0, 43.0, 0.0, -123.0, 0.0, -43.0, -22.0, 0.0, -73.0, -4.0, 78.0, 0.0, -295.0, 0.0, 0.0, 49.0, 101.0, -52.0, -2.0, 0.0, 12.0, -151.0, -4.0, 0.0, -102.0, 42.0, 0.0, 0.0, 0.0, 0.0, -12.0, -74.0, 0.0, -299.0, -69.0, 0.0, 157.0, 0.0, -259.0, -2.0, -204.0, 20.0, 0.0, -4.0, 28.0, 0.0, -211.0, 0.0, 0.0, -26.0, -3.0, 0.0, 0.0, 0.0, 0.0, -195.0, 0.0, -7.0, 5.0, -89.0, -264.0, -60.0, 0.0, -155.0, -66.0, 0.0, -150.0, 0.0, 0.0, 0.0, -97.0, -24.0, -38.0, 166.0, 169.0, 0.0, -4.0, -185.0, -57.0, -139.0, 0.0, 0.0, 0.0, -319.0, 0.0, -74.0, -44.0, 0.0, -153.0, -16.0, -250.0, 0.0, -340.0, 0.0, -67.0, -59.0, 0.0, 0.0, -336.0, 0.0, 0.0, 0.0, 0.0, 0.0, -305.0, -198.0, -38.0, 0.0, 0.0, -143.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, -263.0, 0.0, 0.0, -53.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -14.0, 7.0, 0.0, 0.0, -133.0, -244.0, -26.0, -154.0, 0.0, -83.0, -145.0, -179.0, 0.0, -6.0, -22.0, -54.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, -138.0, -242.0, -110.0, -182.0, -82.0, 0.0, -238.0, -88.0, -112.0, -2.0, -55.0, 2.0, -3.0, -6.0, 0.0, -190.0, -30.0, 0.0, 0.0, 0.0, 0.0, 0.0, -100.0, -7.0, -52.0, -197.0, 0.0, 0.0, -356.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 83.0, 0.0, 0.0, 0.0, 37.0, 15.0, 79.0, 58.0, 0.0, 22.0, 0.0, 0.0, 83.0, 56.0, 1.0, 0.0, 53.0, 2.0, 36.0, 0.0, 0.0, 96.0, 7.0, 87.0, 54.0, 0.0, 0.0, 60.0, 117.0, 70.0, 0.0, 0.0, 44.0, 3.0, 0.0, 80.0, 0.0, 58.0, 66.0, 47.0, 34.0, 58.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 60.0, 0.0, 134.0, 158.0, 0.0, 0.0, 108.0, 84.0, 107.0, 80.0, 0.0, 8.0, 0.0, 54.0, 121.0, 0.0, 0.0, 0.0, 7.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 129.0, 85.0, 0.0, 85.0, 132.0, 0.0, 85.0, 146.0, 0.0, 53.0, 83.0, 0.0, 0.0, 34.0, 48.0, 30.0, 28.0, 0.0, 0.0, 2.0, 1.0, 93.0, 75.0, 0.0, 83.0, 0.0, 0.0, 127.0, 125.0, 52.0, 33.0, 83.0, 0.0, 87.0, 133.0, 133.0, 128.0, 41.0, 0.0, 30.0, 12.0, 152.0, 158.0, 0.0, 0.0, 0.0, 0.0, 149.0, 102.0, 0.0, 146.0, 0.0, 0.0, 61.0, 53.0, 0.0, 0.0, 6.0, 0.0, 139.0, 0.0, 0.0, 0.0, 13.0, 35.0, 0.0, 0.0, 4.0, 0.0, 0.0, 7.0, 0.0, 9.0, 78.0, 105.0, 121.0, 102.0, 114.0, 0.0, 74.0, 60.0, 0.0, 100.0, 14.0, 0.0, 34.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 75.0, 0.0, 121.0, 88.0, 0.0, 158.0, 100.0, 116.0, 3.0, 74.0, 85.0, 0.0, 16.0, 0.0, 3.0, 0.0, 109.0, 99.0, 0.0, 0.0, 0.0, 0.0, 56.0, 0.0, 41.0, 42.0, 130.0, 0.0, 174.0, 163.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1634881279861178, "mean_inference_ms": 3.574017952936117, "mean_action_processing_ms": 0.5108822471197098, "mean_env_wait_ms": 0.41686247682060473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021269559860229492, "StateBufferConnector_ms": 0.005232572555541992, "ViewRequirementAgentConnector_ms": 0.33733201026916504}, "num_episodes": 18, "episode_return_max": 335.0, "episode_return_min": -143.0, "episode_return_mean": -9.44, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 235.08633100511136, "num_env_steps_trained_throughput_per_sec": 235.08633100511136, "timesteps_total": 688000, "num_env_steps_sampled_lifetime": 688000, "num_agent_steps_sampled_lifetime": 2752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2752000, "timers": {"training_iteration_time_ms": 16190.203, "restore_workers_time_ms": 0.021, "training_step_time_ms": 16190.147, "sample_time_ms": 3259.934, "learn_time_ms": 12904.565, "learn_throughput": 309.968, "synch_weights_time_ms": 23.489}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000}, "done": false, "training_iteration": 172, "trial_id": "e1352_00002", "date": "2024-08-13_20-00-35", "timestamp": 1723593635, "time_this_iter_s": 17.24812388420105, "time_total_s": 3519.001379966736, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b984c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3519.001379966736, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 95.35416666666667, "ram_util_percent": 84.00833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7505512295813157, "cur_kl_coeff": 0.001583817601203918, "cur_lr": 0.00010000000000000003, "total_loss": 1.9067037408314054, "policy_loss": -0.0017788395714310426, "vf_loss": 1.9084726296720051, "vf_explained_var": 0.0016554129817498424, "kl": 0.006282633383199709, "entropy": 0.41494826348054975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 326025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.988552317985151, "cur_kl_coeff": 0.015221817306883163, "cur_lr": 0.00010000000000000003, "total_loss": 1.1283865115393406, "policy_loss": -0.009036474461819996, "vf_loss": 1.1372756912910118, "vf_explained_var": 0.0005363019685896616, "kl": 0.009676537171510182, "entropy": 0.7636828316267206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 326025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 2768000}, "env_runners": {"episode_reward_max": 335.0, "episode_reward_min": -143.0, "episode_reward_mean": -15.39, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 169.0, "predator_policy": 195.0}, "policy_reward_mean": {"prey_policy": -48.31, "predator_policy": 40.615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.0, 0.0, -6.0, -14.0, -76.0, 157.0, -67.0, -19.0, 28.0, 78.0, -90.0, 0.0, -7.0, 0.0, 0.0, -66.0, 83.0, -136.0, 25.0, -75.0, -14.0, 0.0, -15.0, -4.0, 335.0, -1.0, -74.0, -56.0, 0.0, -67.0, -33.0, -70.0, -46.0, -79.0, -26.0, -17.0, -26.0, 0.0, 0.0, -54.0, -90.0, 0.0, -29.0, 0.0, -6.0, -124.0, 0.0, -5.0, 0.0, -4.0, -7.0, 16.0, 50.0, -47.0, -40.0, -94.0, -79.0, -14.0, -19.0, 0.0, 0.0, 0.0, -61.0, -143.0, -106.0, -22.0, -123.0, 28.0, 15.0, -3.0, -12.0, 0.0, 0.0, -44.0, 24.0, -67.0, -19.0, -15.0, 16.0, -26.0, 1.0, -56.0, -2.0, -5.0, -7.0, -12.0, -14.0, 0.0, 127.0, 0.0, 0.0, 0.0, -35.0, 0.0, 1.0, 2.0, 0.0, -31.0, -54.0, -14.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [42.0, 0.0, 0.0, 0.0, 0.0, -12.0, -74.0, 0.0, -299.0, -69.0, 0.0, 157.0, 0.0, -259.0, -2.0, -204.0, 20.0, 0.0, -4.0, 28.0, 0.0, -211.0, 0.0, 0.0, -26.0, -3.0, 0.0, 0.0, 0.0, 0.0, -195.0, 0.0, -7.0, 5.0, -89.0, -264.0, -60.0, 0.0, -155.0, -66.0, 0.0, -150.0, 0.0, 0.0, 0.0, -97.0, -24.0, -38.0, 166.0, 169.0, 0.0, -4.0, -185.0, -57.0, -139.0, 0.0, 0.0, 0.0, -319.0, 0.0, -74.0, -44.0, 0.0, -153.0, -16.0, -250.0, 0.0, -340.0, 0.0, -67.0, -59.0, 0.0, 0.0, -336.0, 0.0, 0.0, 0.0, 0.0, 0.0, -305.0, -198.0, -38.0, 0.0, 0.0, -143.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, -263.0, 0.0, 0.0, -53.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -14.0, 7.0, 0.0, 0.0, -133.0, -244.0, -26.0, -154.0, 0.0, -83.0, -145.0, -179.0, 0.0, -6.0, -22.0, -54.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, -138.0, -242.0, -110.0, -182.0, -82.0, 0.0, -238.0, -88.0, -112.0, -2.0, -55.0, 2.0, -3.0, -6.0, 0.0, -190.0, -30.0, 0.0, 0.0, 0.0, 0.0, 0.0, -100.0, -7.0, -52.0, -197.0, 0.0, 0.0, -356.0, -400.0, 0.0, -6.0, -100.0, -67.0, 0.0, 0.0, 1.0, -112.0, 0.0, 0.0, -4.0, 0.0, -10.0, 0.0, -259.0, -57.0, 0.0, -28.0, 0.0, 0.0, 0.0, -2.0, 128.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -77.0, 0.0, 0.0, 1.0, 0.0, 0.0, -158.0, 0.0, 0.0, -337.0, 0.0, -125.0, 0.0, 0.0, -28.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 60.0, 0.0, 134.0, 158.0, 0.0, 0.0, 108.0, 84.0, 107.0, 80.0, 0.0, 8.0, 0.0, 54.0, 121.0, 0.0, 0.0, 0.0, 7.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 129.0, 85.0, 0.0, 85.0, 132.0, 0.0, 85.0, 146.0, 0.0, 53.0, 83.0, 0.0, 0.0, 34.0, 48.0, 30.0, 28.0, 0.0, 0.0, 2.0, 1.0, 93.0, 75.0, 0.0, 83.0, 0.0, 0.0, 127.0, 125.0, 52.0, 33.0, 83.0, 0.0, 87.0, 133.0, 133.0, 128.0, 41.0, 0.0, 30.0, 12.0, 152.0, 158.0, 0.0, 0.0, 0.0, 0.0, 149.0, 102.0, 0.0, 146.0, 0.0, 0.0, 61.0, 53.0, 0.0, 0.0, 6.0, 0.0, 139.0, 0.0, 0.0, 0.0, 13.0, 35.0, 0.0, 0.0, 4.0, 0.0, 0.0, 7.0, 0.0, 9.0, 78.0, 105.0, 121.0, 102.0, 114.0, 0.0, 74.0, 60.0, 0.0, 100.0, 14.0, 0.0, 34.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 75.0, 0.0, 121.0, 88.0, 0.0, 158.0, 100.0, 116.0, 3.0, 74.0, 85.0, 0.0, 16.0, 0.0, 3.0, 0.0, 109.0, 99.0, 0.0, 0.0, 0.0, 0.0, 56.0, 0.0, 41.0, 42.0, 130.0, 0.0, 174.0, 163.0, 190.0, 195.0, 62.0, 60.0, 6.0, 35.0, 0.0, 0.0, 56.0, 0.0, 2.0, 0.0, 0.0, 5.0, 132.0, 120.0, 36.0, 9.0, 14.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 42.0, 0.0, 0.0, 0.0, 0.0, 0.0, 82.0, 78.0, 0.0, 0.0, 143.0, 163.0, 0.0, 71.0, 14.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1678662581360097, "mean_inference_ms": 3.591427275904005, "mean_action_processing_ms": 0.512511687108303, "mean_env_wait_ms": 0.4191244253772895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022982478141784668, "StateBufferConnector_ms": 0.005012869834899902, "ViewRequirementAgentConnector_ms": 0.41921722888946533}, "num_episodes": 23, "episode_return_max": 335.0, "episode_return_min": -143.0, "episode_return_mean": -15.39, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 2768000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 166.2416430142578, "num_env_steps_trained_throughput_per_sec": 166.2416430142578, "timesteps_total": 692000, "num_env_steps_sampled_lifetime": 692000, "num_agent_steps_sampled_lifetime": 2768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2768000, "timers": {"training_iteration_time_ms": 17232.114, "restore_workers_time_ms": 0.021, "training_step_time_ms": 17232.059, "sample_time_ms": 3551.017, "learn_time_ms": 13654.969, "learn_throughput": 292.934, "synch_weights_time_ms": 23.932}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 2768000}, "done": false, "training_iteration": 173, "trial_id": "e1352_00002", "date": "2024-08-13_20-01-00", "timestamp": 1723593660, "time_this_iter_s": 24.858505964279175, "time_total_s": 3543.859885931015, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af096c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3543.859885931015, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 97.49714285714286, "ram_util_percent": 84.13714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.380047140140382, "cur_kl_coeff": 0.001583817601203918, "cur_lr": 0.00010000000000000003, "total_loss": 2.388159740412677, "policy_loss": -0.0005748662585146212, "vf_loss": 2.3887205358535524, "vf_explained_var": 0.0018467950442480662, "kl": 0.008883134214558382, "entropy": 0.4423998796908313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 327915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0430065354815237, "cur_kl_coeff": 0.015221817306883163, "cur_lr": 0.00010000000000000003, "total_loss": 1.8834169797008, "policy_loss": -0.007041651760252616, "vf_loss": 1.8903059661703765, "vf_explained_var": 0.0028589328445454754, "kl": 0.010029215667865535, "entropy": 0.7276531813005922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 327915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000}, "env_runners": {"episode_reward_max": 335.0, "episode_reward_min": -143.0, "episode_reward_mean": -10.72, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 169.0, "predator_policy": 195.0}, "policy_reward_mean": {"prey_policy": -42.405, "predator_policy": 37.045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.0, -4.0, 335.0, -1.0, -74.0, -56.0, 0.0, -67.0, -33.0, -70.0, -46.0, -79.0, -26.0, -17.0, -26.0, 0.0, 0.0, -54.0, -90.0, 0.0, -29.0, 0.0, -6.0, -124.0, 0.0, -5.0, 0.0, -4.0, -7.0, 16.0, 50.0, -47.0, -40.0, -94.0, -79.0, -14.0, -19.0, 0.0, 0.0, 0.0, -61.0, -143.0, -106.0, -22.0, -123.0, 28.0, 15.0, -3.0, -12.0, 0.0, 0.0, -44.0, 24.0, -67.0, -19.0, -15.0, 16.0, -26.0, 1.0, -56.0, -2.0, -5.0, -7.0, -12.0, -14.0, 0.0, 127.0, 0.0, 0.0, 0.0, -35.0, 0.0, 1.0, 2.0, 0.0, -31.0, -54.0, -14.0, 0.0, 45.0, 0.0, -8.0, 94.0, -39.0, 14.0, 0.0, 35.0, 0.0, 0.0, -6.0, -5.0, 0.0, 2.0, -6.0, 106.0, -12.0, 92.0, 0.0, -2.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -97.0, -24.0, -38.0, 166.0, 169.0, 0.0, -4.0, -185.0, -57.0, -139.0, 0.0, 0.0, 0.0, -319.0, 0.0, -74.0, -44.0, 0.0, -153.0, -16.0, -250.0, 0.0, -340.0, 0.0, -67.0, -59.0, 0.0, 0.0, -336.0, 0.0, 0.0, 0.0, 0.0, 0.0, -305.0, -198.0, -38.0, 0.0, 0.0, -143.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, -263.0, 0.0, 0.0, -53.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -14.0, 7.0, 0.0, 0.0, -133.0, -244.0, -26.0, -154.0, 0.0, -83.0, -145.0, -179.0, 0.0, -6.0, -22.0, -54.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, -138.0, -242.0, -110.0, -182.0, -82.0, 0.0, -238.0, -88.0, -112.0, -2.0, -55.0, 2.0, -3.0, -6.0, 0.0, -190.0, -30.0, 0.0, 0.0, 0.0, 0.0, 0.0, -100.0, -7.0, -52.0, -197.0, 0.0, 0.0, -356.0, -400.0, 0.0, -6.0, -100.0, -67.0, 0.0, 0.0, 1.0, -112.0, 0.0, 0.0, -4.0, 0.0, -10.0, 0.0, -259.0, -57.0, 0.0, -28.0, 0.0, 0.0, 0.0, -2.0, 128.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -77.0, 0.0, 0.0, 1.0, 0.0, 0.0, -158.0, 0.0, 0.0, -337.0, 0.0, -125.0, 0.0, 0.0, -28.0, 0.0, 0.0, 31.0, -2.0, 0.0, 0.0, -6.0, -10.0, 68.0, -50.0, -201.0, -10.0, -55.0, 0.0, 0.0, 0.0, 0.0, -198.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 2.0, 0.0, -12.0, -5.0, -112.0, 0.0, -90.0, -61.0, 25.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0], "policy_predator_policy_reward": [34.0, 48.0, 30.0, 28.0, 0.0, 0.0, 2.0, 1.0, 93.0, 75.0, 0.0, 83.0, 0.0, 0.0, 127.0, 125.0, 52.0, 33.0, 83.0, 0.0, 87.0, 133.0, 133.0, 128.0, 41.0, 0.0, 30.0, 12.0, 152.0, 158.0, 0.0, 0.0, 0.0, 0.0, 149.0, 102.0, 0.0, 146.0, 0.0, 0.0, 61.0, 53.0, 0.0, 0.0, 6.0, 0.0, 139.0, 0.0, 0.0, 0.0, 13.0, 35.0, 0.0, 0.0, 4.0, 0.0, 0.0, 7.0, 0.0, 9.0, 78.0, 105.0, 121.0, 102.0, 114.0, 0.0, 74.0, 60.0, 0.0, 100.0, 14.0, 0.0, 34.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 75.0, 0.0, 121.0, 88.0, 0.0, 158.0, 100.0, 116.0, 3.0, 74.0, 85.0, 0.0, 16.0, 0.0, 3.0, 0.0, 109.0, 99.0, 0.0, 0.0, 0.0, 0.0, 56.0, 0.0, 41.0, 42.0, 130.0, 0.0, 174.0, 163.0, 190.0, 195.0, 62.0, 60.0, 6.0, 35.0, 0.0, 0.0, 56.0, 0.0, 2.0, 0.0, 0.0, 5.0, 132.0, 120.0, 36.0, 9.0, 14.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 42.0, 0.0, 0.0, 0.0, 0.0, 0.0, 82.0, 78.0, 0.0, 0.0, 143.0, 163.0, 0.0, 71.0, 14.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 8.0, 0.0, 76.0, 73.0, 99.0, 35.0, 34.0, 0.0, 0.0, 110.0, 123.0, 0.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 121.0, 102.0, 44.0, 34.0, 41.0, 87.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1779336228397101, "mean_inference_ms": 3.6133392309152637, "mean_action_processing_ms": 0.516037655996453, "mean_env_wait_ms": 0.4218470701774388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01991736888885498, "StateBufferConnector_ms": 0.004700064659118652, "ViewRequirementAgentConnector_ms": 0.43145596981048584}, "num_episodes": 22, "episode_return_max": 335.0, "episode_return_min": -143.0, "episode_return_mean": -10.72, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 181.0709679402421, "num_env_steps_trained_throughput_per_sec": 181.0709679402421, "timesteps_total": 696000, "num_env_steps_sampled_lifetime": 696000, "num_agent_steps_sampled_lifetime": 2784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2784000, "timers": {"training_iteration_time_ms": 17789.146, "restore_workers_time_ms": 0.022, "training_step_time_ms": 17789.08, "sample_time_ms": 4100.715, "learn_time_ms": 13660.934, "learn_throughput": 292.806, "synch_weights_time_ms": 24.483}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000}, "done": false, "training_iteration": 174, "trial_id": "e1352_00002", "date": "2024-08-13_20-01-23", "timestamp": 1723593683, "time_this_iter_s": 22.167893886566162, "time_total_s": 3566.027779817581, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e429d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3566.027779817581, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 92.73124999999999, "ram_util_percent": 84.265625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3139483879404095, "cur_kl_coeff": 0.001583817601203918, "cur_lr": 0.00010000000000000003, "total_loss": 1.7955058424561112, "policy_loss": -0.0022525336031639386, "vf_loss": 1.7977471952085142, "vf_explained_var": 0.002061949583588454, "kl": 0.007062306208847051, "entropy": 0.38901361523481903, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 329805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.074482222287743, "cur_kl_coeff": 0.015221817306883163, "cur_lr": 0.00010000000000000003, "total_loss": 2.3800993814039484, "policy_loss": -0.0037281317216289974, "vf_loss": 2.383723477585606, "vf_explained_var": 0.011895673363297074, "kl": 0.006834973945017013, "entropy": 0.754546451473993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 329805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "env_runners": {"episode_reward_max": 157.0, "episode_reward_min": -143.0, "episode_reward_mean": -3.98, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 154.0, "predator_policy": 195.0}, "policy_reward_mean": {"prey_policy": -32.6, "predator_policy": 30.61}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-90.0, 0.0, -29.0, 0.0, -6.0, -124.0, 0.0, -5.0, 0.0, -4.0, -7.0, 16.0, 50.0, -47.0, -40.0, -94.0, -79.0, -14.0, -19.0, 0.0, 0.0, 0.0, -61.0, -143.0, -106.0, -22.0, -123.0, 28.0, 15.0, -3.0, -12.0, 0.0, 0.0, -44.0, 24.0, -67.0, -19.0, -15.0, 16.0, -26.0, 1.0, -56.0, -2.0, -5.0, -7.0, -12.0, -14.0, 0.0, 127.0, 0.0, 0.0, 0.0, -35.0, 0.0, 1.0, 2.0, 0.0, -31.0, -54.0, -14.0, 0.0, 45.0, 0.0, -8.0, 94.0, -39.0, 14.0, 0.0, 35.0, 0.0, 0.0, -6.0, -5.0, 0.0, 2.0, -6.0, 106.0, -12.0, 92.0, 0.0, -2.0, 0.0, 2.0, -63.0, -12.0, 7.0, -18.0, 0.0, 134.0, -6.0, 10.0, 157.0, -9.0, 54.0, 0.0, 156.0, 0.0, 73.0, -10.0, -34.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-198.0, -38.0, 0.0, 0.0, -143.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, -263.0, 0.0, 0.0, -53.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -14.0, 7.0, 0.0, 0.0, -133.0, -244.0, -26.0, -154.0, 0.0, -83.0, -145.0, -179.0, 0.0, -6.0, -22.0, -54.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, -138.0, -242.0, -110.0, -182.0, -82.0, 0.0, -238.0, -88.0, -112.0, -2.0, -55.0, 2.0, -3.0, -6.0, 0.0, -190.0, -30.0, 0.0, 0.0, 0.0, 0.0, 0.0, -100.0, -7.0, -52.0, -197.0, 0.0, 0.0, -356.0, -400.0, 0.0, -6.0, -100.0, -67.0, 0.0, 0.0, 1.0, -112.0, 0.0, 0.0, -4.0, 0.0, -10.0, 0.0, -259.0, -57.0, 0.0, -28.0, 0.0, 0.0, 0.0, -2.0, 128.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -77.0, 0.0, 0.0, 1.0, 0.0, 0.0, -158.0, 0.0, 0.0, -337.0, 0.0, -125.0, 0.0, 0.0, -28.0, 0.0, 0.0, 31.0, -2.0, 0.0, 0.0, -6.0, -10.0, 68.0, -50.0, -201.0, -10.0, -55.0, 0.0, 0.0, 0.0, 0.0, -198.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 2.0, 0.0, -12.0, -5.0, -112.0, 0.0, -90.0, -61.0, 25.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, -22.0, 0.0, -150.0, -60.0, -218.0, -27.0, 1.0, 0.0, 0.0, -39.0, 0.0, 0.0, 117.0, -36.0, 0.0, -20.0, 0.0, 10.0, 0.0, 154.0, -18.0, 0.0, 0.0, 45.0, 0.0, 0.0, 136.0, 0.0, 0.0, 0.0, 65.0, 4.0, 24.0, -92.0, -51.0, -34.0], "policy_predator_policy_reward": [0.0, 146.0, 0.0, 0.0, 61.0, 53.0, 0.0, 0.0, 6.0, 0.0, 139.0, 0.0, 0.0, 0.0, 13.0, 35.0, 0.0, 0.0, 4.0, 0.0, 0.0, 7.0, 0.0, 9.0, 78.0, 105.0, 121.0, 102.0, 114.0, 0.0, 74.0, 60.0, 0.0, 100.0, 14.0, 0.0, 34.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 75.0, 0.0, 121.0, 88.0, 0.0, 158.0, 100.0, 116.0, 3.0, 74.0, 85.0, 0.0, 16.0, 0.0, 3.0, 0.0, 109.0, 99.0, 0.0, 0.0, 0.0, 0.0, 56.0, 0.0, 41.0, 42.0, 130.0, 0.0, 174.0, 163.0, 190.0, 195.0, 62.0, 60.0, 6.0, 35.0, 0.0, 0.0, 56.0, 0.0, 2.0, 0.0, 0.0, 5.0, 132.0, 120.0, 36.0, 9.0, 14.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 42.0, 0.0, 0.0, 0.0, 0.0, 0.0, 82.0, 78.0, 0.0, 0.0, 143.0, 163.0, 0.0, 71.0, 14.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 8.0, 0.0, 76.0, 73.0, 99.0, 35.0, 34.0, 0.0, 0.0, 110.0, 123.0, 0.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 121.0, 102.0, 44.0, 34.0, 41.0, 87.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 24.0, 87.0, 60.0, 111.0, 122.0, 6.0, 0.0, 20.0, 1.0, 0.0, 0.0, 14.0, 39.0, 6.0, 8.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 1.0, 8.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 3.0, 1.0, 47.0, 11.0, 20.0, 31.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.183517582064298, "mean_inference_ms": 3.627643393448624, "mean_action_processing_ms": 0.5181504713915979, "mean_env_wait_ms": 0.4236360781748548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008999943733215332, "StateBufferConnector_ms": 0.00494539737701416, "ViewRequirementAgentConnector_ms": 0.42235100269317627}, "num_episodes": 18, "episode_return_max": 157.0, "episode_return_min": -143.0, "episode_return_mean": -3.98, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 201.7624966458033, "num_env_steps_trained_throughput_per_sec": 201.7624966458033, "timesteps_total": 700000, "num_env_steps_sampled_lifetime": 700000, "num_agent_steps_sampled_lifetime": 2800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2800000, "timers": {"training_iteration_time_ms": 18301.779, "restore_workers_time_ms": 0.022, "training_step_time_ms": 18301.714, "sample_time_ms": 4140.005, "learn_time_ms": 14131.617, "learn_throughput": 283.053, "synch_weights_time_ms": 26.861}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "done": false, "training_iteration": 175, "trial_id": "e1352_00002", "date": "2024-08-13_20-01-43", "timestamp": 1723593703, "time_this_iter_s": 19.925560235977173, "time_total_s": 3585.9533400535583, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f42700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3585.9533400535583, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 90.925, "ram_util_percent": 84.11428571428569}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7492317850469912, "cur_kl_coeff": 0.001583817601203918, "cur_lr": 0.00010000000000000003, "total_loss": 1.4827008704975169, "policy_loss": -0.0024875262641303594, "vf_loss": 1.4851821716815705, "vf_explained_var": 0.0055997079957729925, "kl": 0.003930034326382781, "entropy": 0.337320180229409, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 331695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2081369675341107, "cur_kl_coeff": 0.015221817306883163, "cur_lr": 0.00010000000000000003, "total_loss": 2.4215253186604335, "policy_loss": -0.006967925961331401, "vf_loss": 2.4283419008608216, "vf_explained_var": 0.0949275673381866, "kl": 0.009942421068221659, "entropy": 0.7225015685356483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 331695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000}, "env_runners": {"episode_reward_max": 157.0, "episode_reward_min": -143.0, "episode_reward_mean": 8.4, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 154.0, "predator_policy": 195.0}, "policy_reward_mean": {"prey_policy": -24.38, "predator_policy": 28.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.0, 0.0, 0.0, 0.0, -61.0, -143.0, -106.0, -22.0, -123.0, 28.0, 15.0, -3.0, -12.0, 0.0, 0.0, -44.0, 24.0, -67.0, -19.0, -15.0, 16.0, -26.0, 1.0, -56.0, -2.0, -5.0, -7.0, -12.0, -14.0, 0.0, 127.0, 0.0, 0.0, 0.0, -35.0, 0.0, 1.0, 2.0, 0.0, -31.0, -54.0, -14.0, 0.0, 45.0, 0.0, -8.0, 94.0, -39.0, 14.0, 0.0, 35.0, 0.0, 0.0, -6.0, -5.0, 0.0, 2.0, -6.0, 106.0, -12.0, 92.0, 0.0, -2.0, 0.0, 2.0, -63.0, -12.0, 7.0, -18.0, 0.0, 134.0, -6.0, 10.0, 157.0, -9.0, 54.0, 0.0, 156.0, 0.0, 73.0, -10.0, -34.0, 138.0, 0.0, 37.0, 0.0, 11.0, 57.0, 111.0, 106.0, -5.0, 0.0, 1.0, 74.0, 99.0, 68.0, 33.0, 0.0, 35.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-54.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, -138.0, -242.0, -110.0, -182.0, -82.0, 0.0, -238.0, -88.0, -112.0, -2.0, -55.0, 2.0, -3.0, -6.0, 0.0, -190.0, -30.0, 0.0, 0.0, 0.0, 0.0, 0.0, -100.0, -7.0, -52.0, -197.0, 0.0, 0.0, -356.0, -400.0, 0.0, -6.0, -100.0, -67.0, 0.0, 0.0, 1.0, -112.0, 0.0, 0.0, -4.0, 0.0, -10.0, 0.0, -259.0, -57.0, 0.0, -28.0, 0.0, 0.0, 0.0, -2.0, 128.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -77.0, 0.0, 0.0, 1.0, 0.0, 0.0, -158.0, 0.0, 0.0, -337.0, 0.0, -125.0, 0.0, 0.0, -28.0, 0.0, 0.0, 31.0, -2.0, 0.0, 0.0, -6.0, -10.0, 68.0, -50.0, -201.0, -10.0, -55.0, 0.0, 0.0, 0.0, 0.0, -198.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 2.0, 0.0, -12.0, -5.0, -112.0, 0.0, -90.0, -61.0, 25.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, -22.0, 0.0, -150.0, -60.0, -218.0, -27.0, 1.0, 0.0, 0.0, -39.0, 0.0, 0.0, 117.0, -36.0, 0.0, -20.0, 0.0, 10.0, 0.0, 154.0, -18.0, 0.0, 0.0, 45.0, 0.0, 0.0, 136.0, 0.0, 0.0, 0.0, 65.0, 4.0, 24.0, -92.0, -51.0, -34.0, 0.0, 107.0, 0.0, 0.0, 14.0, -2.0, 0.0, 0.0, -186.0, 18.0, 0.0, 47.0, 53.0, 0.0, 0.0, -62.0, 0.0, -10.0, 0.0, 0.0, 0.0, -18.0, 27.0, -40.0, 88.0, -14.0, 22.0, 0.0, -22.0, -62.0, 0.0, 0.0, -52.0, 22.0, 0.0, 0.0], "policy_predator_policy_reward": [34.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 75.0, 0.0, 121.0, 88.0, 0.0, 158.0, 100.0, 116.0, 3.0, 74.0, 85.0, 0.0, 16.0, 0.0, 3.0, 0.0, 109.0, 99.0, 0.0, 0.0, 0.0, 0.0, 56.0, 0.0, 41.0, 42.0, 130.0, 0.0, 174.0, 163.0, 190.0, 195.0, 62.0, 60.0, 6.0, 35.0, 0.0, 0.0, 56.0, 0.0, 2.0, 0.0, 0.0, 5.0, 132.0, 120.0, 36.0, 9.0, 14.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 42.0, 0.0, 0.0, 0.0, 0.0, 0.0, 82.0, 78.0, 0.0, 0.0, 143.0, 163.0, 0.0, 71.0, 14.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 8.0, 0.0, 76.0, 73.0, 99.0, 35.0, 34.0, 0.0, 0.0, 110.0, 123.0, 0.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 121.0, 102.0, 44.0, 34.0, 41.0, 87.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 24.0, 87.0, 60.0, 111.0, 122.0, 6.0, 0.0, 20.0, 1.0, 0.0, 0.0, 14.0, 39.0, 6.0, 8.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 1.0, 8.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 3.0, 1.0, 47.0, 11.0, 20.0, 31.0, 31.0, 0.0, 0.0, 0.0, 8.0, 17.0, 0.0, 0.0, 98.0, 81.0, 0.0, 10.0, 30.0, 28.0, 85.0, 83.0, 4.0, 1.0, 0.0, 0.0, 0.0, 19.0, 43.0, 44.0, 16.0, 9.0, 46.0, 0.0, 61.0, 56.0, 0.0, 0.0, 65.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1887209510572074, "mean_inference_ms": 3.6428330728558307, "mean_action_processing_ms": 0.5203191085008863, "mean_env_wait_ms": 0.42549685773995255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007545351982116699, "StateBufferConnector_ms": 0.004503011703491211, "ViewRequirementAgentConnector_ms": 0.31742918491363525}, "num_episodes": 18, "episode_return_max": 157.0, "episode_return_min": -143.0, "episode_return_mean": 8.4, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 195.84246176209697, "num_env_steps_trained_throughput_per_sec": 195.84246176209697, "timesteps_total": 704000, "num_env_steps_sampled_lifetime": 704000, "num_agent_steps_sampled_lifetime": 2816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2816000, "timers": {"training_iteration_time_ms": 19059.686, "restore_workers_time_ms": 0.022, "training_step_time_ms": 19059.622, "sample_time_ms": 4512.525, "learn_time_ms": 14514.57, "learn_throughput": 275.585, "synch_weights_time_ms": 29.353}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000}, "done": false, "training_iteration": 176, "trial_id": "e1352_00002", "date": "2024-08-13_20-02-03", "timestamp": 1723593723, "time_this_iter_s": 20.53281569480896, "time_total_s": 3606.4861557483673, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f9b430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3606.4861557483673, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 89.84333333333333, "ram_util_percent": 83.95333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.215834798013407, "cur_kl_coeff": 0.000791908800601959, "cur_lr": 0.00010000000000000003, "total_loss": 1.9560960743162368, "policy_loss": -0.0031835859735057782, "vf_loss": 1.9592534629125444, "vf_explained_var": 0.012709658454965663, "kl": 0.03308375010288901, "entropy": 0.4002377605075559, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 333585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.636306001742681, "cur_kl_coeff": 0.015221817306883163, "cur_lr": 0.00010000000000000003, "total_loss": 2.550835749018129, "policy_loss": -0.012615733031582619, "vf_loss": 2.562028893907234, "vf_explained_var": 0.19116969253651048, "kl": 0.09345735858518003, "entropy": 0.8607897560117106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 333585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 2832000}, "env_runners": {"episode_reward_max": 264.0, "episode_reward_min": -63.0, "episode_reward_mean": 33.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 195.0}, "policy_reward_mean": {"prey_policy": -7.185, "predator_policy": 23.815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.0, -15.0, 16.0, -26.0, 1.0, -56.0, -2.0, -5.0, -7.0, -12.0, -14.0, 0.0, 127.0, 0.0, 0.0, 0.0, -35.0, 0.0, 1.0, 2.0, 0.0, -31.0, -54.0, -14.0, 0.0, 45.0, 0.0, -8.0, 94.0, -39.0, 14.0, 0.0, 35.0, 0.0, 0.0, -6.0, -5.0, 0.0, 2.0, -6.0, 106.0, -12.0, 92.0, 0.0, -2.0, 0.0, 2.0, -63.0, -12.0, 7.0, -18.0, 0.0, 134.0, -6.0, 10.0, 157.0, -9.0, 54.0, 0.0, 156.0, 0.0, 73.0, -10.0, -34.0, 138.0, 0.0, 37.0, 0.0, 11.0, 57.0, 111.0, 106.0, -5.0, 0.0, 1.0, 74.0, 99.0, 68.0, 33.0, 0.0, 35.0, 0.0, 0.0, 0.0, 211.0, 162.0, 35.0, 200.0, 182.0, 264.0, 186.0, 37.0, 45.0, 0.0, 51.0, 201.0, 199.0, 180.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -356.0, -400.0, 0.0, -6.0, -100.0, -67.0, 0.0, 0.0, 1.0, -112.0, 0.0, 0.0, -4.0, 0.0, -10.0, 0.0, -259.0, -57.0, 0.0, -28.0, 0.0, 0.0, 0.0, -2.0, 128.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -77.0, 0.0, 0.0, 1.0, 0.0, 0.0, -158.0, 0.0, 0.0, -337.0, 0.0, -125.0, 0.0, 0.0, -28.0, 0.0, 0.0, 31.0, -2.0, 0.0, 0.0, -6.0, -10.0, 68.0, -50.0, -201.0, -10.0, -55.0, 0.0, 0.0, 0.0, 0.0, -198.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 2.0, 0.0, -12.0, -5.0, -112.0, 0.0, -90.0, -61.0, 25.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, -22.0, 0.0, -150.0, -60.0, -218.0, -27.0, 1.0, 0.0, 0.0, -39.0, 0.0, 0.0, 117.0, -36.0, 0.0, -20.0, 0.0, 10.0, 0.0, 154.0, -18.0, 0.0, 0.0, 45.0, 0.0, 0.0, 136.0, 0.0, 0.0, 0.0, 65.0, 4.0, 24.0, -92.0, -51.0, -34.0, 0.0, 107.0, 0.0, 0.0, 14.0, -2.0, 0.0, 0.0, -186.0, 18.0, 0.0, 47.0, 53.0, 0.0, 0.0, -62.0, 0.0, -10.0, 0.0, 0.0, 0.0, -18.0, 27.0, -40.0, 88.0, -14.0, 22.0, 0.0, -22.0, -62.0, 0.0, 0.0, -52.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 134.0, 110.0, -4.0, 0.0, -39.0, 0.0, 200.0, 0.0, 155.0, 4.0, 149.0, 186.0, 0.0, 0.0, 37.0, 0.0, 32.0, 0.0, 0.0, -2.0, 44.0, 71.0, 80.0, 199.0, 0.0, 1.0, 159.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [174.0, 163.0, 190.0, 195.0, 62.0, 60.0, 6.0, 35.0, 0.0, 0.0, 56.0, 0.0, 2.0, 0.0, 0.0, 5.0, 132.0, 120.0, 36.0, 9.0, 14.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 42.0, 0.0, 0.0, 0.0, 0.0, 0.0, 82.0, 78.0, 0.0, 0.0, 143.0, 163.0, 0.0, 71.0, 14.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 8.0, 0.0, 76.0, 73.0, 99.0, 35.0, 34.0, 0.0, 0.0, 110.0, 123.0, 0.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 121.0, 102.0, 44.0, 34.0, 41.0, 87.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 24.0, 87.0, 60.0, 111.0, 122.0, 6.0, 0.0, 20.0, 1.0, 0.0, 0.0, 14.0, 39.0, 6.0, 8.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 1.0, 8.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 3.0, 1.0, 47.0, 11.0, 20.0, 31.0, 31.0, 0.0, 0.0, 0.0, 8.0, 17.0, 0.0, 0.0, 98.0, 81.0, 0.0, 10.0, 30.0, 28.0, 85.0, 83.0, 4.0, 1.0, 0.0, 0.0, 0.0, 19.0, 43.0, 44.0, 16.0, 9.0, 46.0, 0.0, 61.0, 56.0, 0.0, 0.0, 65.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 27.0, 29.0, 74.0, 0.0, 0.0, 0.0, 13.0, 14.0, 54.0, 57.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 9.0, 14.0, 36.0, 0.0, 0.0, 13.0, 7.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1947296465841513, "mean_inference_ms": 3.6599546673133285, "mean_action_processing_ms": 0.5228441543974788, "mean_env_wait_ms": 0.4275635121149921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007364034652709961, "StateBufferConnector_ms": 0.0049315690994262695, "ViewRequirementAgentConnector_ms": 0.3738560676574707}, "num_episodes": 18, "episode_return_max": 264.0, "episode_return_min": -63.0, "episode_return_mean": 33.26, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 2832000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.90119452186659, "num_env_steps_trained_throughput_per_sec": 212.90119452186659, "timesteps_total": 708000, "num_env_steps_sampled_lifetime": 708000, "num_agent_steps_sampled_lifetime": 2832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2832000, "timers": {"training_iteration_time_ms": 19135.172, "restore_workers_time_ms": 0.022, "training_step_time_ms": 19135.107, "sample_time_ms": 4591.397, "learn_time_ms": 14512.357, "learn_throughput": 275.627, "synch_weights_time_ms": 27.237}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 2832000}, "done": false, "training_iteration": 177, "trial_id": "e1352_00002", "date": "2024-08-13_20-02-22", "timestamp": 1723593742, "time_this_iter_s": 18.856852054595947, "time_total_s": 3625.3430078029633, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af096550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3625.3430078029633, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 89.68148148148147, "ram_util_percent": 83.9962962962963}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7712222237277913, "cur_kl_coeff": 0.0011878632009029388, "cur_lr": 0.00010000000000000003, "total_loss": 2.6709783941349654, "policy_loss": -0.0022495424897267073, "vf_loss": 2.6732165362469105, "vf_explained_var": 0.019699431096435224, "kl": 0.009599141869054386, "entropy": 0.4206150135035237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 335475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.416984731195465, "cur_kl_coeff": 0.02283272596032476, "cur_lr": 0.00010000000000000003, "total_loss": 3.4159605744023804, "policy_loss": -0.004961009935855314, "vf_loss": 3.4206619617169496, "vf_explained_var": 0.19598041410168643, "kl": 0.011370252142604377, "entropy": 0.9169201412213542, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 335475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000}, "env_runners": {"episode_reward_max": 354.0, "episode_reward_min": -63.0, "episode_reward_mean": 57.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -218.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 123.0}, "policy_reward_mean": {"prey_policy": 11.77, "predator_policy": 17.01}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.0, 94.0, -39.0, 14.0, 0.0, 35.0, 0.0, 0.0, -6.0, -5.0, 0.0, 2.0, -6.0, 106.0, -12.0, 92.0, 0.0, -2.0, 0.0, 2.0, -63.0, -12.0, 7.0, -18.0, 0.0, 134.0, -6.0, 10.0, 157.0, -9.0, 54.0, 0.0, 156.0, 0.0, 73.0, -10.0, -34.0, 138.0, 0.0, 37.0, 0.0, 11.0, 57.0, 111.0, 106.0, -5.0, 0.0, 1.0, 74.0, 99.0, 68.0, 33.0, 0.0, 35.0, 0.0, 0.0, 0.0, 211.0, 162.0, 35.0, 200.0, 182.0, 264.0, 186.0, 37.0, 45.0, 0.0, 51.0, 201.0, 199.0, 180.0, 0.0, 0.0, 0.0, 167.0, 0.0, 187.0, 165.0, 17.0, 85.0, 166.0, 354.0, 0.0, -2.0, 98.0, 0.0, 125.0, 237.0, -1.0, 291.0, 200.0, -15.0, 27.0, 0.0, 112.0, 0.0, -14.0, 0.0, 140.0, -7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, -10.0, 68.0, -50.0, -201.0, -10.0, -55.0, 0.0, 0.0, 0.0, 0.0, -198.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 2.0, 0.0, -12.0, -5.0, -112.0, 0.0, -90.0, -61.0, 25.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, -22.0, 0.0, -150.0, -60.0, -218.0, -27.0, 1.0, 0.0, 0.0, -39.0, 0.0, 0.0, 117.0, -36.0, 0.0, -20.0, 0.0, 10.0, 0.0, 154.0, -18.0, 0.0, 0.0, 45.0, 0.0, 0.0, 136.0, 0.0, 0.0, 0.0, 65.0, 4.0, 24.0, -92.0, -51.0, -34.0, 0.0, 107.0, 0.0, 0.0, 14.0, -2.0, 0.0, 0.0, -186.0, 18.0, 0.0, 47.0, 53.0, 0.0, 0.0, -62.0, 0.0, -10.0, 0.0, 0.0, 0.0, -18.0, 27.0, -40.0, 88.0, -14.0, 22.0, 0.0, -22.0, -62.0, 0.0, 0.0, -52.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 134.0, 110.0, -4.0, 0.0, -39.0, 0.0, 200.0, 0.0, 155.0, 4.0, 149.0, 186.0, 0.0, 0.0, 37.0, 0.0, 32.0, 0.0, 0.0, -2.0, 44.0, 71.0, 80.0, 199.0, 0.0, 1.0, 159.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 164.0, 0.0, 0.0, -2.0, 182.0, 0.0, 134.0, -25.0, -10.0, 0.0, 37.0, 0.0, 146.0, 170.0, 158.0, 0.0, 0.0, 0.0, -4.0, 0.0, 29.0, 0.0, 0.0, 97.0, 0.0, 69.0, 110.0, -2.0, 0.0, 170.0, 95.0, 200.0, 0.0, -8.0, -16.0, 0.0, 12.0, -6.0, 0.0, 0.0, 73.0, 0.0, 0.0, -28.0, 0.0, 0.0, 0.0, 0.0, 116.0, -7.0, -16.0], "policy_predator_policy_reward": [0.0, 8.0, 0.0, 76.0, 73.0, 99.0, 35.0, 34.0, 0.0, 0.0, 110.0, 123.0, 0.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 121.0, 102.0, 44.0, 34.0, 41.0, 87.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 24.0, 87.0, 60.0, 111.0, 122.0, 6.0, 0.0, 20.0, 1.0, 0.0, 0.0, 14.0, 39.0, 6.0, 8.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 1.0, 8.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 3.0, 1.0, 47.0, 11.0, 20.0, 31.0, 31.0, 0.0, 0.0, 0.0, 8.0, 17.0, 0.0, 0.0, 98.0, 81.0, 0.0, 10.0, 30.0, 28.0, 85.0, 83.0, 4.0, 1.0, 0.0, 0.0, 0.0, 19.0, 43.0, 44.0, 16.0, 9.0, 46.0, 0.0, 61.0, 56.0, 0.0, 0.0, 65.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 27.0, 29.0, 74.0, 0.0, 0.0, 0.0, 13.0, 14.0, 54.0, 57.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 9.0, 14.0, 36.0, 0.0, 0.0, 13.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 3.0, 4.0, 21.0, 10.0, 28.0, 24.0, 24.0, 24.0, 14.0, 6.0, 12.0, 14.0, 0.0, 0.0, 2.0, 0.0, 32.0, 37.0, 0.0, 0.0, 9.0, 19.0, 25.0, 33.0, 1.0, 0.0, 9.0, 17.0, 0.0, 0.0, 0.0, 9.0, 8.0, 7.0, 3.0, 3.0, 28.0, 11.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 24.0, 8.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2015862984812922, "mean_inference_ms": 3.679149222443659, "mean_action_processing_ms": 0.5254189299676186, "mean_env_wait_ms": 0.4300915066777193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005919814109802246, "StateBufferConnector_ms": 0.004905581474304199, "ViewRequirementAgentConnector_ms": 0.2921513319015503}, "num_episodes": 27, "episode_return_max": 354.0, "episode_return_min": -63.0, "episode_return_mean": 57.56, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 221.98733117926668, "num_env_steps_trained_throughput_per_sec": 221.98733117926668, "timesteps_total": 712000, "num_env_steps_sampled_lifetime": 712000, "num_agent_steps_sampled_lifetime": 2848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2848000, "timers": {"training_iteration_time_ms": 19353.458, "restore_workers_time_ms": 0.022, "training_step_time_ms": 19353.388, "sample_time_ms": 4662.377, "learn_time_ms": 14661.142, "learn_throughput": 272.83, "synch_weights_time_ms": 25.237}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000}, "done": false, "training_iteration": 178, "trial_id": "e1352_00002", "date": "2024-08-13_20-02-41", "timestamp": 1723593761, "time_this_iter_s": 18.108849048614502, "time_total_s": 3643.4518568515778, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f42700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3643.4518568515778, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 96.484, "ram_util_percent": 83.87999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.043525826114984, "cur_kl_coeff": 0.0011878632009029388, "cur_lr": 0.00010000000000000003, "total_loss": 0.40813041401130185, "policy_loss": -0.004818556694037936, "vf_loss": 0.412934556613287, "vf_explained_var": 0.01892107157480149, "kl": 0.012133857838941761, "entropy": 0.41952289640903473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 337365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8324333607992798, "cur_kl_coeff": 0.02283272596032476, "cur_lr": 0.00010000000000000003, "total_loss": 2.540747625550265, "policy_loss": -0.004202168520845513, "vf_loss": 2.54475020548654, "vf_explained_var": 0.21001827801976886, "kl": 0.008741228851487478, "entropy": 0.9366583779690758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 337365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 2864000}, "env_runners": {"episode_reward_max": 354.0, "episode_reward_min": -63.0, "episode_reward_mean": 69.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -218.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 122.0}, "policy_reward_mean": {"prey_policy": 21.83, "predator_policy": 13.07}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 2.0, -63.0, -12.0, 7.0, -18.0, 0.0, 134.0, -6.0, 10.0, 157.0, -9.0, 54.0, 0.0, 156.0, 0.0, 73.0, -10.0, -34.0, 138.0, 0.0, 37.0, 0.0, 11.0, 57.0, 111.0, 106.0, -5.0, 0.0, 1.0, 74.0, 99.0, 68.0, 33.0, 0.0, 35.0, 0.0, 0.0, 0.0, 211.0, 162.0, 35.0, 200.0, 182.0, 264.0, 186.0, 37.0, 45.0, 0.0, 51.0, 201.0, 199.0, 180.0, 0.0, 0.0, 0.0, 167.0, 0.0, 187.0, 165.0, 17.0, 85.0, 166.0, 354.0, 0.0, -2.0, 98.0, 0.0, 125.0, 237.0, -1.0, 291.0, 200.0, -15.0, 27.0, 0.0, 112.0, 0.0, -14.0, 0.0, 140.0, -7.0, 132.0, 157.0, 0.0, -3.0, 176.0, 113.0, 191.0, 0.0, -7.0, 0.0, 265.0, 0.0, -3.0, 162.0, 0.0, 150.0, -5.0, 161.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -22.0, 0.0, -150.0, -60.0, -218.0, -27.0, 1.0, 0.0, 0.0, -39.0, 0.0, 0.0, 117.0, -36.0, 0.0, -20.0, 0.0, 10.0, 0.0, 154.0, -18.0, 0.0, 0.0, 45.0, 0.0, 0.0, 136.0, 0.0, 0.0, 0.0, 65.0, 4.0, 24.0, -92.0, -51.0, -34.0, 0.0, 107.0, 0.0, 0.0, 14.0, -2.0, 0.0, 0.0, -186.0, 18.0, 0.0, 47.0, 53.0, 0.0, 0.0, -62.0, 0.0, -10.0, 0.0, 0.0, 0.0, -18.0, 27.0, -40.0, 88.0, -14.0, 22.0, 0.0, -22.0, -62.0, 0.0, 0.0, -52.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 134.0, 110.0, -4.0, 0.0, -39.0, 0.0, 200.0, 0.0, 155.0, 4.0, 149.0, 186.0, 0.0, 0.0, 37.0, 0.0, 32.0, 0.0, 0.0, -2.0, 44.0, 71.0, 80.0, 199.0, 0.0, 1.0, 159.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 164.0, 0.0, 0.0, -2.0, 182.0, 0.0, 134.0, -25.0, -10.0, 0.0, 37.0, 0.0, 146.0, 170.0, 158.0, 0.0, 0.0, 0.0, -4.0, 0.0, 29.0, 0.0, 0.0, 97.0, 0.0, 69.0, 110.0, -2.0, 0.0, 170.0, 95.0, 200.0, 0.0, -8.0, -16.0, 0.0, 12.0, -6.0, 0.0, 0.0, 73.0, 0.0, 0.0, -28.0, 0.0, 0.0, 0.0, 0.0, 116.0, -7.0, -16.0, 98.0, 0.0, -40.0, 164.0, 0.0, 0.0, -6.0, 0.0, 164.0, -32.0, 0.0, 113.0, 0.0, 191.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 169.0, 72.0, 0.0, 0.0, 0.0, -6.0, -12.0, 161.0, 0.0, 0.0, 110.0, -2.0, -10.0, 0.0, 45.0, 102.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 24.0, 87.0, 60.0, 111.0, 122.0, 6.0, 0.0, 20.0, 1.0, 0.0, 0.0, 14.0, 39.0, 6.0, 8.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 1.0, 8.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 3.0, 1.0, 47.0, 11.0, 20.0, 31.0, 31.0, 0.0, 0.0, 0.0, 8.0, 17.0, 0.0, 0.0, 98.0, 81.0, 0.0, 10.0, 30.0, 28.0, 85.0, 83.0, 4.0, 1.0, 0.0, 0.0, 0.0, 19.0, 43.0, 44.0, 16.0, 9.0, 46.0, 0.0, 61.0, 56.0, 0.0, 0.0, 65.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 27.0, 29.0, 74.0, 0.0, 0.0, 0.0, 13.0, 14.0, 54.0, 57.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 9.0, 14.0, 36.0, 0.0, 0.0, 13.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 3.0, 4.0, 21.0, 10.0, 28.0, 24.0, 24.0, 24.0, 14.0, 6.0, 12.0, 14.0, 0.0, 0.0, 2.0, 0.0, 32.0, 37.0, 0.0, 0.0, 9.0, 19.0, 25.0, 33.0, 1.0, 0.0, 9.0, 17.0, 0.0, 0.0, 0.0, 9.0, 8.0, 7.0, 3.0, 3.0, 28.0, 11.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 24.0, 8.0, 8.0, 0.0, 34.0, 27.0, 6.0, 0.0, 0.0, 0.0, 3.0, 44.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 3.0, 13.0, 0.0, 0.0, 0.0, 22.0, 20.0, 5.0, 0.0, 14.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2047538567692055, "mean_inference_ms": 3.688840479934588, "mean_action_processing_ms": 0.526803589612725, "mean_env_wait_ms": 0.43105938222423407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005747675895690918, "StateBufferConnector_ms": 0.004690647125244141, "ViewRequirementAgentConnector_ms": 0.2607121467590332}, "num_episodes": 18, "episode_return_max": 354.0, "episode_return_min": -63.0, "episode_return_mean": 69.8, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 2864000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.64157502808624, "num_env_steps_trained_throughput_per_sec": 246.64157502808624, "timesteps_total": 716000, "num_env_steps_sampled_lifetime": 716000, "num_agent_steps_sampled_lifetime": 2864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2864000, "timers": {"training_iteration_time_ms": 19665.014, "restore_workers_time_ms": 0.023, "training_step_time_ms": 19664.943, "sample_time_ms": 4823.304, "learn_time_ms": 14811.773, "learn_throughput": 270.055, "synch_weights_time_ms": 25.191}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 2864000}, "done": false, "training_iteration": 179, "trial_id": "e1352_00002", "date": "2024-08-13_20-02-57", "timestamp": 1723593777, "time_this_iter_s": 16.27292799949646, "time_total_s": 3659.724784851074, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f9b430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3659.724784851074, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 86.9375, "ram_util_percent": 79.98333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.021905382009095, "cur_kl_coeff": 0.0011878632009029388, "cur_lr": 0.00010000000000000003, "total_loss": 0.41197075097964553, "policy_loss": -0.0005333758459460956, "vf_loss": 0.4124979837617724, "vf_explained_var": -0.000516081171691733, "kl": 0.005171983916142147, "entropy": 0.37125373689270524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 339255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.812882110965315, "cur_kl_coeff": 0.02283272596032476, "cur_lr": 0.00010000000000000003, "total_loss": 1.5232665320237477, "policy_loss": -0.0020817667670873187, "vf_loss": 1.5249911232915505, "vf_explained_var": 0.24973597327868144, "kl": 0.015643028716404512, "entropy": 0.9421856265850168, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 339255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "env_runners": {"episode_reward_max": 354.0, "episode_reward_min": -34.0, "episode_reward_mean": 71.66, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -186.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 98.0}, "policy_reward_mean": {"prey_policy": 25.495, "predator_policy": 10.335}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, 138.0, 0.0, 37.0, 0.0, 11.0, 57.0, 111.0, 106.0, -5.0, 0.0, 1.0, 74.0, 99.0, 68.0, 33.0, 0.0, 35.0, 0.0, 0.0, 0.0, 211.0, 162.0, 35.0, 200.0, 182.0, 264.0, 186.0, 37.0, 45.0, 0.0, 51.0, 201.0, 199.0, 180.0, 0.0, 0.0, 0.0, 167.0, 0.0, 187.0, 165.0, 17.0, 85.0, 166.0, 354.0, 0.0, -2.0, 98.0, 0.0, 125.0, 237.0, -1.0, 291.0, 200.0, -15.0, 27.0, 0.0, 112.0, 0.0, -14.0, 0.0, 140.0, -7.0, 132.0, 157.0, 0.0, -3.0, 176.0, 113.0, 191.0, 0.0, -7.0, 0.0, 265.0, 0.0, -3.0, 162.0, 0.0, 150.0, -5.0, 161.0, -4.0, 0.0, 0.0, -1.0, 0.0, 200.0, 0.0, 0.0, 128.0, 0.0, 0.0, 165.0, 0.0, 0.0, -6.0, 0.0, 0.0, 179.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-51.0, -34.0, 0.0, 107.0, 0.0, 0.0, 14.0, -2.0, 0.0, 0.0, -186.0, 18.0, 0.0, 47.0, 53.0, 0.0, 0.0, -62.0, 0.0, -10.0, 0.0, 0.0, 0.0, -18.0, 27.0, -40.0, 88.0, -14.0, 22.0, 0.0, -22.0, -62.0, 0.0, 0.0, -52.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 134.0, 110.0, -4.0, 0.0, -39.0, 0.0, 200.0, 0.0, 155.0, 4.0, 149.0, 186.0, 0.0, 0.0, 37.0, 0.0, 32.0, 0.0, 0.0, -2.0, 44.0, 71.0, 80.0, 199.0, 0.0, 1.0, 159.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 164.0, 0.0, 0.0, -2.0, 182.0, 0.0, 134.0, -25.0, -10.0, 0.0, 37.0, 0.0, 146.0, 170.0, 158.0, 0.0, 0.0, 0.0, -4.0, 0.0, 29.0, 0.0, 0.0, 97.0, 0.0, 69.0, 110.0, -2.0, 0.0, 170.0, 95.0, 200.0, 0.0, -8.0, -16.0, 0.0, 12.0, -6.0, 0.0, 0.0, 73.0, 0.0, 0.0, -28.0, 0.0, 0.0, 0.0, 0.0, 116.0, -7.0, -16.0, 98.0, 0.0, -40.0, 164.0, 0.0, 0.0, -6.0, 0.0, 164.0, -32.0, 0.0, 113.0, 0.0, 191.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 169.0, 72.0, 0.0, 0.0, 0.0, -6.0, -12.0, 161.0, 0.0, 0.0, 110.0, -2.0, -10.0, 0.0, 45.0, 102.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 58.0, 40.0, 0.0, 0.0, 0.0, 0.0, 165.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 170.0, -4.0], "policy_predator_policy_reward": [20.0, 31.0, 31.0, 0.0, 0.0, 0.0, 8.0, 17.0, 0.0, 0.0, 98.0, 81.0, 0.0, 10.0, 30.0, 28.0, 85.0, 83.0, 4.0, 1.0, 0.0, 0.0, 0.0, 19.0, 43.0, 44.0, 16.0, 9.0, 46.0, 0.0, 61.0, 56.0, 0.0, 0.0, 65.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 27.0, 29.0, 74.0, 0.0, 0.0, 0.0, 13.0, 14.0, 54.0, 57.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 9.0, 14.0, 36.0, 0.0, 0.0, 13.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 3.0, 4.0, 21.0, 10.0, 28.0, 24.0, 24.0, 24.0, 14.0, 6.0, 12.0, 14.0, 0.0, 0.0, 2.0, 0.0, 32.0, 37.0, 0.0, 0.0, 9.0, 19.0, 25.0, 33.0, 1.0, 0.0, 9.0, 17.0, 0.0, 0.0, 0.0, 9.0, 8.0, 7.0, 3.0, 3.0, 28.0, 11.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 24.0, 8.0, 8.0, 0.0, 34.0, 27.0, 6.0, 0.0, 0.0, 0.0, 3.0, 44.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 3.0, 13.0, 0.0, 0.0, 0.0, 22.0, 20.0, 5.0, 0.0, 14.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2072836664445388, "mean_inference_ms": 3.697031076405726, "mean_action_processing_ms": 0.5278247209205138, "mean_env_wait_ms": 0.4320517412191441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052318572998046875, "StateBufferConnector_ms": 0.004376888275146484, "ViewRequirementAgentConnector_ms": 0.2578747272491455}, "num_episodes": 18, "episode_return_max": 354.0, "episode_return_min": -34.0, "episode_return_mean": 71.66, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.1091891544731, "num_env_steps_trained_throughput_per_sec": 269.1091891544731, "timesteps_total": 720000, "num_env_steps_sampled_lifetime": 720000, "num_agent_steps_sampled_lifetime": 2880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2880000, "timers": {"training_iteration_time_ms": 19395.024, "restore_workers_time_ms": 0.023, "training_step_time_ms": 19394.953, "sample_time_ms": 4418.407, "learn_time_ms": 14947.541, "learn_throughput": 267.603, "synch_weights_time_ms": 24.327}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "done": false, "training_iteration": 180, "trial_id": "e1352_00002", "date": "2024-08-13_20-03-12", "timestamp": 1723593792, "time_this_iter_s": 14.92890214920044, "time_total_s": 3674.6536870002747, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f42700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3674.6536870002747, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 81.17619047619048, "ram_util_percent": 76.1952380952381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6951955524741342, "cur_kl_coeff": 0.0011878632009029388, "cur_lr": 0.00010000000000000003, "total_loss": 0.1632796805884157, "policy_loss": -0.0005793899593372194, "vf_loss": 0.163853212960296, "vf_explained_var": 0.048780152627399986, "kl": 0.004931052153606894, "entropy": 0.31067781790539073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 341145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.407617847629325, "cur_kl_coeff": 0.02283272596032476, "cur_lr": 0.00010000000000000003, "total_loss": 2.720687118346098, "policy_loss": -0.0026698471786129096, "vf_loss": 2.722998863742465, "vf_explained_var": 0.33168280064744293, "kl": 0.01568384380647927, "entropy": 0.8868042930724129, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 341145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 2896000}, "env_runners": {"episode_reward_max": 354.0, "episode_reward_min": -20.0, "episode_reward_mean": 80.18, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -42.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 74.0}, "policy_reward_mean": {"prey_policy": 33.57, "predator_policy": 6.52}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 211.0, 162.0, 35.0, 200.0, 182.0, 264.0, 186.0, 37.0, 45.0, 0.0, 51.0, 201.0, 199.0, 180.0, 0.0, 0.0, 0.0, 167.0, 0.0, 187.0, 165.0, 17.0, 85.0, 166.0, 354.0, 0.0, -2.0, 98.0, 0.0, 125.0, 237.0, -1.0, 291.0, 200.0, -15.0, 27.0, 0.0, 112.0, 0.0, -14.0, 0.0, 140.0, -7.0, 132.0, 157.0, 0.0, -3.0, 176.0, 113.0, 191.0, 0.0, -7.0, 0.0, 265.0, 0.0, -3.0, 162.0, 0.0, 150.0, -5.0, 161.0, -4.0, 0.0, 0.0, -1.0, 0.0, 200.0, 0.0, 0.0, 128.0, 0.0, 0.0, 165.0, 0.0, 0.0, -6.0, 0.0, 0.0, 179.0, -6.0, -20.0, 0.0, -5.0, 85.0, 200.0, -3.0, 158.0, 324.0, 196.0, 0.0, 200.0, 0.0, 0.0, 0.0, 66.0, 200.0, 188.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 134.0, 110.0, -4.0, 0.0, -39.0, 0.0, 200.0, 0.0, 155.0, 4.0, 149.0, 186.0, 0.0, 0.0, 37.0, 0.0, 32.0, 0.0, 0.0, -2.0, 44.0, 71.0, 80.0, 199.0, 0.0, 1.0, 159.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 164.0, 0.0, 0.0, -2.0, 182.0, 0.0, 134.0, -25.0, -10.0, 0.0, 37.0, 0.0, 146.0, 170.0, 158.0, 0.0, 0.0, 0.0, -4.0, 0.0, 29.0, 0.0, 0.0, 97.0, 0.0, 69.0, 110.0, -2.0, 0.0, 170.0, 95.0, 200.0, 0.0, -8.0, -16.0, 0.0, 12.0, -6.0, 0.0, 0.0, 73.0, 0.0, 0.0, -28.0, 0.0, 0.0, 0.0, 0.0, 116.0, -7.0, -16.0, 98.0, 0.0, -40.0, 164.0, 0.0, 0.0, -6.0, 0.0, 164.0, -32.0, 0.0, 113.0, 0.0, 191.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 169.0, 72.0, 0.0, 0.0, 0.0, -6.0, -12.0, 161.0, 0.0, 0.0, 110.0, -2.0, -10.0, 0.0, 45.0, 102.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 58.0, 40.0, 0.0, 0.0, 0.0, 0.0, 165.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 170.0, -4.0, -42.0, 0.0, -40.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 59.0, 200.0, 0.0, -6.0, 0.0, 0.0, 158.0, 145.0, 152.0, 196.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 65.0, 200.0, 0.0, 182.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 27.0, 29.0, 74.0, 0.0, 0.0, 0.0, 13.0, 14.0, 54.0, 57.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 9.0, 14.0, 36.0, 0.0, 0.0, 13.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 3.0, 4.0, 21.0, 10.0, 28.0, 24.0, 24.0, 24.0, 14.0, 6.0, 12.0, 14.0, 0.0, 0.0, 2.0, 0.0, 32.0, 37.0, 0.0, 0.0, 9.0, 19.0, 25.0, 33.0, 1.0, 0.0, 9.0, 17.0, 0.0, 0.0, 0.0, 9.0, 8.0, 7.0, 3.0, 3.0, 28.0, 11.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 24.0, 8.0, 8.0, 0.0, 34.0, 27.0, 6.0, 0.0, 0.0, 0.0, 3.0, 44.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 3.0, 13.0, 0.0, 0.0, 0.0, 22.0, 20.0, 5.0, 0.0, 14.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 8.0, 15.0, 21.0, 20.0, 0.0, 0.0, 0.0, 5.0, 0.0, 26.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 16.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.20914954667214, "mean_inference_ms": 3.703478370932805, "mean_action_processing_ms": 0.5286973210764822, "mean_env_wait_ms": 0.4327676454923879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060536861419677734, "StateBufferConnector_ms": 0.004533648490905762, "ViewRequirementAgentConnector_ms": 0.25296711921691895}, "num_episodes": 18, "episode_return_max": 354.0, "episode_return_min": -20.0, "episode_return_mean": 80.18, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 2896000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 135.0341737820679, "num_env_steps_trained_throughput_per_sec": 135.0341737820679, "timesteps_total": 724000, "num_env_steps_sampled_lifetime": 724000, "num_agent_steps_sampled_lifetime": 2896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2896000, "timers": {"training_iteration_time_ms": 20092.817, "restore_workers_time_ms": 0.022, "training_step_time_ms": 20092.745, "sample_time_ms": 4301.288, "learn_time_ms": 15756.582, "learn_throughput": 253.862, "synch_weights_time_ms": 29.991}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 2896000}, "done": false, "training_iteration": 181, "trial_id": "e1352_00002", "date": "2024-08-13_20-03-42", "timestamp": 1723593822, "time_this_iter_s": 29.774948120117188, "time_total_s": 3704.428635120392, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f42670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3704.428635120392, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 97.76341463414634, "ram_util_percent": 82.54634146341462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4480846235282208, "cur_kl_coeff": 0.0005939316004514694, "cur_lr": 0.00010000000000000003, "total_loss": 0.1646683367182348, "policy_loss": -0.0014252365175043307, "vf_loss": 0.16608702617441182, "vf_explained_var": 0.030976965156181778, "kl": 0.01102334960942411, "entropy": 0.3557675150572938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 343035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.264670174320539, "cur_kl_coeff": 0.02283272596032476, "cur_lr": 0.00010000000000000003, "total_loss": 2.5537237225386202, "policy_loss": -0.0023440421980229164, "vf_loss": 2.555846728155853, "vf_explained_var": 0.3727251955125698, "kl": 0.009680412547521224, "entropy": 0.9135278990029028, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 343035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000}, "env_runners": {"episode_reward_max": 365.0, "episode_reward_min": -20.0, "episode_reward_mean": 75.66, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -42.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 44.0}, "policy_reward_mean": {"prey_policy": 32.83, "predator_policy": 5.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [165.0, 17.0, 85.0, 166.0, 354.0, 0.0, -2.0, 98.0, 0.0, 125.0, 237.0, -1.0, 291.0, 200.0, -15.0, 27.0, 0.0, 112.0, 0.0, -14.0, 0.0, 140.0, -7.0, 132.0, 157.0, 0.0, -3.0, 176.0, 113.0, 191.0, 0.0, -7.0, 0.0, 265.0, 0.0, -3.0, 162.0, 0.0, 150.0, -5.0, 161.0, -4.0, 0.0, 0.0, -1.0, 0.0, 200.0, 0.0, 0.0, 128.0, 0.0, 0.0, 165.0, 0.0, 0.0, -6.0, 0.0, 0.0, 179.0, -6.0, -20.0, 0.0, -5.0, 85.0, 200.0, -3.0, 158.0, 324.0, 196.0, 0.0, 200.0, 0.0, 0.0, 0.0, 66.0, 200.0, 188.0, 196.0, 0.0, 0.0, 193.0, 365.0, 188.0, 183.0, -6.0, -3.0, 191.0, 0.0, -15.0, 196.0, 0.0, 0.0, 0.0, 0.0, 182.0, -9.0, 0.0, 0.0, 93.0, 101.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 134.0, -25.0, -10.0, 0.0, 37.0, 0.0, 146.0, 170.0, 158.0, 0.0, 0.0, 0.0, -4.0, 0.0, 29.0, 0.0, 0.0, 97.0, 0.0, 69.0, 110.0, -2.0, 0.0, 170.0, 95.0, 200.0, 0.0, -8.0, -16.0, 0.0, 12.0, -6.0, 0.0, 0.0, 73.0, 0.0, 0.0, -28.0, 0.0, 0.0, 0.0, 0.0, 116.0, -7.0, -16.0, 98.0, 0.0, -40.0, 164.0, 0.0, 0.0, -6.0, 0.0, 164.0, -32.0, 0.0, 113.0, 0.0, 191.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 169.0, 72.0, 0.0, 0.0, 0.0, -6.0, -12.0, 161.0, 0.0, 0.0, 110.0, -2.0, -10.0, 0.0, 45.0, 102.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 58.0, 40.0, 0.0, 0.0, 0.0, 0.0, 165.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 170.0, -4.0, -42.0, 0.0, -40.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 59.0, 200.0, 0.0, -6.0, 0.0, 0.0, 158.0, 145.0, 152.0, 196.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 65.0, 200.0, 0.0, 182.0, 0.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 200.0, 164.0, 173.0, 182.0, 0.0, 188.0, -18.0, 0.0, -14.0, 0.0, -6.0, 200.0, -18.0, 0.0, 0.0, -30.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 173.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 93.0, -6.0, 99.0], "policy_predator_policy_reward": [21.0, 10.0, 28.0, 24.0, 24.0, 24.0, 14.0, 6.0, 12.0, 14.0, 0.0, 0.0, 2.0, 0.0, 32.0, 37.0, 0.0, 0.0, 9.0, 19.0, 25.0, 33.0, 1.0, 0.0, 9.0, 17.0, 0.0, 0.0, 0.0, 9.0, 8.0, 7.0, 3.0, 3.0, 28.0, 11.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 24.0, 8.0, 8.0, 0.0, 34.0, 27.0, 6.0, 0.0, 0.0, 0.0, 3.0, 44.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 3.0, 13.0, 0.0, 0.0, 0.0, 22.0, 20.0, 5.0, 0.0, 14.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 8.0, 15.0, 21.0, 20.0, 0.0, 0.0, 0.0, 5.0, 0.0, 26.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 16.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 19.0, 9.0, 6.0, 0.0, 8.0, 5.0, 3.0, 5.0, 3.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2099048063566762, "mean_inference_ms": 3.7126753001748214, "mean_action_processing_ms": 0.5295254116140755, "mean_env_wait_ms": 0.43417466995607223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01501774787902832, "StateBufferConnector_ms": 0.004866957664489746, "ViewRequirementAgentConnector_ms": 0.3478018045425415}, "num_episodes": 23, "episode_return_max": 365.0, "episode_return_min": -20.0, "episode_return_mean": 75.66, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 192.89219187587915, "num_env_steps_trained_throughput_per_sec": 192.89219187587915, "timesteps_total": 728000, "num_env_steps_sampled_lifetime": 728000, "num_agent_steps_sampled_lifetime": 2912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2912000, "timers": {"training_iteration_time_ms": 20465.01, "restore_workers_time_ms": 0.022, "training_step_time_ms": 20464.938, "sample_time_ms": 4437.032, "learn_time_ms": 15991.843, "learn_throughput": 250.128, "synch_weights_time_ms": 31.149}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000}, "done": false, "training_iteration": 182, "trial_id": "e1352_00002", "date": "2024-08-13_20-04-03", "timestamp": 1723593843, "time_this_iter_s": 21.04571509361267, "time_total_s": 3725.4743502140045, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2038c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3725.4743502140045, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 88.12333333333335, "ram_util_percent": 84.19666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3910924016877457, "cur_kl_coeff": 0.0005939316004514694, "cur_lr": 0.00010000000000000003, "total_loss": 0.694569460550944, "policy_loss": -0.00199873205348258, "vf_loss": 0.6965653634260571, "vf_explained_var": 0.021804384106681462, "kl": 0.004761564497903959, "entropy": 0.30917694789391975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 344925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.318932548496458, "cur_kl_coeff": 0.02283272596032476, "cur_lr": 0.00010000000000000003, "total_loss": 4.219609779403323, "policy_loss": -0.001316061935131315, "vf_loss": 4.22051890564974, "vf_explained_var": 0.41802556473742086, "kl": 0.01782207666870125, "entropy": 0.929537828763326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 344925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 2928000}, "env_runners": {"episode_reward_max": 365.0, "episode_reward_min": -20.0, "episode_reward_mean": 88.05, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -42.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 44.0}, "policy_reward_mean": {"prey_policy": 40.335, "predator_policy": 3.69}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.0, 132.0, 157.0, 0.0, -3.0, 176.0, 113.0, 191.0, 0.0, -7.0, 0.0, 265.0, 0.0, -3.0, 162.0, 0.0, 150.0, -5.0, 161.0, -4.0, 0.0, 0.0, -1.0, 0.0, 200.0, 0.0, 0.0, 128.0, 0.0, 0.0, 165.0, 0.0, 0.0, -6.0, 0.0, 0.0, 179.0, -6.0, -20.0, 0.0, -5.0, 85.0, 200.0, -3.0, 158.0, 324.0, 196.0, 0.0, 200.0, 0.0, 0.0, 0.0, 66.0, 200.0, 188.0, 196.0, 0.0, 0.0, 193.0, 365.0, 188.0, 183.0, -6.0, -3.0, 191.0, 0.0, -15.0, 196.0, 0.0, 0.0, 0.0, 0.0, 182.0, -9.0, 0.0, 0.0, 93.0, 101.0, 106.0, -9.0, 200.0, 0.0, 198.0, 176.0, 328.0, 37.0, 208.0, 128.0, 171.0, 360.0, 0.0, 176.0, 179.0, 133.0, 185.0, -9.0, 178.0, 135.0, 190.0, 154.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-7.0, -16.0, 98.0, 0.0, -40.0, 164.0, 0.0, 0.0, -6.0, 0.0, 164.0, -32.0, 0.0, 113.0, 0.0, 191.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 169.0, 72.0, 0.0, 0.0, 0.0, -6.0, -12.0, 161.0, 0.0, 0.0, 110.0, -2.0, -10.0, 0.0, 45.0, 102.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 58.0, 40.0, 0.0, 0.0, 0.0, 0.0, 165.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 170.0, -4.0, -42.0, 0.0, -40.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 59.0, 200.0, 0.0, -6.0, 0.0, 0.0, 158.0, 145.0, 152.0, 196.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 65.0, 200.0, 0.0, 182.0, 0.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 200.0, 164.0, 173.0, 182.0, 0.0, 188.0, -18.0, 0.0, -14.0, 0.0, -6.0, 200.0, -18.0, 0.0, 0.0, -30.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 173.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 93.0, -6.0, 99.0, 0.0, 106.0, -18.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 197.0, 140.0, 0.0, 114.0, 200.0, 28.0, 0.0, 8.0, 200.0, -8.0, 117.0, 176.0, -10.0, 176.0, 164.0, 0.0, 0.0, -16.0, 176.0, 167.0, 0.0, 0.0, 133.0, 173.0, 0.0, -18.0, 0.0, 0.0, 164.0, 116.0, 0.0, 0.0, 185.0, 156.0, -8.0], "policy_predator_policy_reward": [8.0, 8.0, 0.0, 34.0, 27.0, 6.0, 0.0, 0.0, 0.0, 3.0, 44.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 3.0, 13.0, 0.0, 0.0, 0.0, 22.0, 20.0, 5.0, 0.0, 14.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 8.0, 15.0, 21.0, 20.0, 0.0, 0.0, 0.0, 5.0, 0.0, 26.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 16.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 19.0, 9.0, 6.0, 0.0, 8.0, 5.0, 3.0, 5.0, 3.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 16.0, 20.0, 0.0, 14.0, 4.0, 5.0, 0.0, 0.0, 2.0, 17.0, 5.0, 0.0, 8.0, 12.0, 0.0, 0.0, 8.0, 8.0, 8.0, 4.0, 0.0, 0.0, 6.0, 6.0, 9.0, 0.0, 2.0, 12.0, 19.0, 0.0, 0.0, 5.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2203010384947226, "mean_inference_ms": 3.7302833364569223, "mean_action_processing_ms": 0.5318342179218789, "mean_env_wait_ms": 0.4363509480451345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09438490867614746, "StateBufferConnector_ms": 0.013715028762817383, "ViewRequirementAgentConnector_ms": 0.6121383905410767}, "num_episodes": 22, "episode_return_max": 365.0, "episode_return_min": -20.0, "episode_return_mean": 88.05, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 2928000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 143.23625992256052, "num_env_steps_trained_throughput_per_sec": 143.23625992256052, "timesteps_total": 732000, "num_env_steps_sampled_lifetime": 732000, "num_agent_steps_sampled_lifetime": 2928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2928000, "timers": {"training_iteration_time_ms": 20851.463, "restore_workers_time_ms": 0.023, "training_step_time_ms": 20851.391, "sample_time_ms": 5061.947, "learn_time_ms": 15750.442, "learn_throughput": 253.961, "synch_weights_time_ms": 32.716}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 2928000}, "done": false, "training_iteration": 183, "trial_id": "e1352_00002", "date": "2024-08-13_20-04-31", "timestamp": 1723593871, "time_this_iter_s": 28.202401876449585, "time_total_s": 3753.676752090454, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2038b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3753.676752090454, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 91.77837837837838, "ram_util_percent": 84.01351351351352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9335390918153934, "cur_kl_coeff": 0.0002969658002257347, "cur_lr": 0.00010000000000000003, "total_loss": 0.9977718496133411, "policy_loss": -0.0013726390505248987, "vf_loss": 0.9991432960544314, "vf_explained_var": 0.03442030161146133, "kl": 0.004010295976329141, "entropy": 0.2554618734688986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 346815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.6411086864887725, "cur_kl_coeff": 0.02283272596032476, "cur_lr": 0.00010000000000000003, "total_loss": 3.7695413438100664, "policy_loss": -0.002733344095635903, "vf_loss": 3.7716662809331583, "vf_explained_var": 0.5449781069679865, "kl": 0.02664585641209666, "entropy": 0.9344081181382377, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 346815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000}, "env_runners": {"episode_reward_max": 365.0, "episode_reward_min": -20.0, "episode_reward_mean": 95.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -42.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 28.0}, "policy_reward_mean": {"prey_policy": 43.825, "predator_policy": 3.805}, "custom_metrics": {}, "hist_stats": {"episode_reward": [161.0, -4.0, 0.0, 0.0, -1.0, 0.0, 200.0, 0.0, 0.0, 128.0, 0.0, 0.0, 165.0, 0.0, 0.0, -6.0, 0.0, 0.0, 179.0, -6.0, -20.0, 0.0, -5.0, 85.0, 200.0, -3.0, 158.0, 324.0, 196.0, 0.0, 200.0, 0.0, 0.0, 0.0, 66.0, 200.0, 188.0, 196.0, 0.0, 0.0, 193.0, 365.0, 188.0, 183.0, -6.0, -3.0, 191.0, 0.0, -15.0, 196.0, 0.0, 0.0, 0.0, 0.0, 182.0, -9.0, 0.0, 0.0, 93.0, 101.0, 106.0, -9.0, 200.0, 0.0, 198.0, 176.0, 328.0, 37.0, 208.0, 128.0, 171.0, 360.0, 0.0, 176.0, 179.0, 133.0, 185.0, -9.0, 178.0, 135.0, 190.0, 154.0, 178.0, 0.0, 184.0, 0.0, -6.0, -2.0, -13.0, 365.0, 0.0, 12.0, 318.0, 139.0, 343.0, 154.0, -7.0, -13.0, 197.0, 193.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [45.0, 102.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 58.0, 40.0, 0.0, 0.0, 0.0, 0.0, 165.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 170.0, -4.0, -42.0, 0.0, -40.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 59.0, 200.0, 0.0, -6.0, 0.0, 0.0, 158.0, 145.0, 152.0, 196.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 65.0, 200.0, 0.0, 182.0, 0.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 200.0, 164.0, 173.0, 182.0, 0.0, 188.0, -18.0, 0.0, -14.0, 0.0, -6.0, 200.0, -18.0, 0.0, 0.0, -30.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 173.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 93.0, -6.0, 99.0, 0.0, 106.0, -18.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 197.0, 140.0, 0.0, 114.0, 200.0, 28.0, 0.0, 8.0, 200.0, -8.0, 117.0, 176.0, -10.0, 176.0, 164.0, 0.0, 0.0, -16.0, 176.0, 167.0, 0.0, 0.0, 133.0, 173.0, 0.0, -18.0, 0.0, 0.0, 164.0, 116.0, 0.0, 0.0, 185.0, 156.0, -8.0, 167.0, 0.0, 0.0, 0.0, 176.0, 0.0, 0.0, 0.0, -2.0, -8.0, 0.0, -32.0, -24.0, -2.0, 188.0, 155.0, 0.0, 0.0, 12.0, 0.0, 164.0, 114.0, -18.0, 116.0, 173.0, 146.0, 0.0, 131.0, 0.0, -14.0, 0.0, -26.0, 182.0, 9.0, 194.0, -6.0], "policy_predator_policy_reward": [14.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 8.0, 15.0, 21.0, 20.0, 0.0, 0.0, 0.0, 5.0, 0.0, 26.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 16.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 19.0, 9.0, 6.0, 0.0, 8.0, 5.0, 3.0, 5.0, 3.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 16.0, 20.0, 0.0, 14.0, 4.0, 5.0, 0.0, 0.0, 2.0, 17.0, 5.0, 0.0, 8.0, 12.0, 0.0, 0.0, 8.0, 8.0, 8.0, 4.0, 0.0, 0.0, 6.0, 6.0, 9.0, 0.0, 2.0, 12.0, 19.0, 0.0, 0.0, 5.0, 6.0, 0.0, 0.0, 11.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 3.0, 1.0, 14.0, 16.0, 0.0, 13.0, 8.0, 14.0, 0.0, 0.0, 0.0, 0.0, 12.0, 28.0, 17.0, 24.0, 13.0, 11.0, 9.0, 14.0, 0.0, 7.0, 13.0, 0.0, 6.0, 0.0, 3.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2293201984024025, "mean_inference_ms": 3.75050343658366, "mean_action_processing_ms": 0.534170936840831, "mean_env_wait_ms": 0.43905247043834444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10658252239227295, "StateBufferConnector_ms": 0.014312028884887695, "ViewRequirementAgentConnector_ms": 0.642946720123291}, "num_episodes": 18, "episode_return_max": 365.0, "episode_return_min": -20.0, "episode_return_mean": 95.26, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 201.57032519325458, "num_env_steps_trained_throughput_per_sec": 201.57032519325458, "timesteps_total": 736000, "num_env_steps_sampled_lifetime": 736000, "num_agent_steps_sampled_lifetime": 2944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2944000, "timers": {"training_iteration_time_ms": 20626.817, "restore_workers_time_ms": 0.048, "training_step_time_ms": 20626.697, "sample_time_ms": 4994.358, "learn_time_ms": 15592.941, "learn_throughput": 256.526, "synch_weights_time_ms": 33.321}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000}, "done": false, "training_iteration": 184, "trial_id": "e1352_00002", "date": "2024-08-13_20-04-52", "timestamp": 1723593892, "time_this_iter_s": 19.90104103088379, "time_total_s": 3773.577793121338, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f8c700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3773.577793121338, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 85.6586206896552, "ram_util_percent": 84.05862068965517}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0405484002024408, "cur_kl_coeff": 0.00014848290011286734, "cur_lr": 0.00010000000000000003, "total_loss": 0.7697091121837576, "policy_loss": -0.0011219834502313344, "vf_loss": 0.770830581837861, "vf_explained_var": 0.03259308505310583, "kl": 0.0034534090808001914, "entropy": 0.2583877649729845, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 348705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.1393944256362465, "cur_kl_coeff": 0.03424908894048711, "cur_lr": 0.00010000000000000003, "total_loss": 4.191870136740347, "policy_loss": -0.0030495508709459237, "vf_loss": 4.194370844376781, "vf_explained_var": 0.6049370094266519, "kl": 0.016025299852611523, "entropy": 0.9150618538970039, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 348705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "env_runners": {"episode_reward_max": 386.0, "episode_reward_min": -29.0, "episode_reward_mean": 113.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 36.0}, "policy_reward_mean": {"prey_policy": 51.915, "predator_policy": 4.77}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.0, -6.0, -20.0, 0.0, -5.0, 85.0, 200.0, -3.0, 158.0, 324.0, 196.0, 0.0, 200.0, 0.0, 0.0, 0.0, 66.0, 200.0, 188.0, 196.0, 0.0, 0.0, 193.0, 365.0, 188.0, 183.0, -6.0, -3.0, 191.0, 0.0, -15.0, 196.0, 0.0, 0.0, 0.0, 0.0, 182.0, -9.0, 0.0, 0.0, 93.0, 101.0, 106.0, -9.0, 200.0, 0.0, 198.0, 176.0, 328.0, 37.0, 208.0, 128.0, 171.0, 360.0, 0.0, 176.0, 179.0, 133.0, 185.0, -9.0, 178.0, 135.0, 190.0, 154.0, 178.0, 0.0, 184.0, 0.0, -6.0, -2.0, -13.0, 365.0, 0.0, 12.0, 318.0, 139.0, 343.0, 154.0, -7.0, -13.0, 197.0, 193.0, 176.0, 0.0, 0.0, 348.0, 176.0, -4.0, 355.0, -17.0, 182.0, -29.0, 135.0, 378.0, 200.0, -3.0, 386.0, 174.0, 0.0, -3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [170.0, -4.0, -42.0, 0.0, -40.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 59.0, 200.0, 0.0, -6.0, 0.0, 0.0, 158.0, 145.0, 152.0, 196.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 65.0, 200.0, 0.0, 182.0, 0.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 200.0, 164.0, 173.0, 182.0, 0.0, 188.0, -18.0, 0.0, -14.0, 0.0, -6.0, 200.0, -18.0, 0.0, 0.0, -30.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 173.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 93.0, -6.0, 99.0, 0.0, 106.0, -18.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 197.0, 140.0, 0.0, 114.0, 200.0, 28.0, 0.0, 8.0, 200.0, -8.0, 117.0, 176.0, -10.0, 176.0, 164.0, 0.0, 0.0, -16.0, 176.0, 167.0, 0.0, 0.0, 133.0, 173.0, 0.0, -18.0, 0.0, 0.0, 164.0, 116.0, 0.0, 0.0, 185.0, 156.0, -8.0, 167.0, 0.0, 0.0, 0.0, 176.0, 0.0, 0.0, 0.0, -2.0, -8.0, 0.0, -32.0, -24.0, -2.0, 188.0, 155.0, 0.0, 0.0, 12.0, 0.0, 164.0, 114.0, -18.0, 116.0, 173.0, 146.0, 0.0, 131.0, 0.0, -14.0, 0.0, -26.0, 182.0, 9.0, 194.0, -6.0, 0.0, 164.0, 0.0, 0.0, 0.0, 0.0, 137.0, 173.0, 158.0, 0.0, 0.0, -8.0, 200.0, 107.0, -32.0, -2.0, -20.0, 188.0, -44.0, -14.0, -14.0, 113.0, 200.0, 167.0, 200.0, 0.0, -10.0, 0.0, 200.0, 179.0, 0.0, 170.0, 0.0, 0.0, -6.0, 0.0], "policy_predator_policy_reward": [5.0, 8.0, 15.0, 21.0, 20.0, 0.0, 0.0, 0.0, 5.0, 0.0, 26.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 16.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 19.0, 9.0, 6.0, 0.0, 8.0, 5.0, 3.0, 5.0, 3.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 16.0, 20.0, 0.0, 14.0, 4.0, 5.0, 0.0, 0.0, 2.0, 17.0, 5.0, 0.0, 8.0, 12.0, 0.0, 0.0, 8.0, 8.0, 8.0, 4.0, 0.0, 0.0, 6.0, 6.0, 9.0, 0.0, 2.0, 12.0, 19.0, 0.0, 0.0, 5.0, 6.0, 0.0, 0.0, 11.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 3.0, 1.0, 14.0, 16.0, 0.0, 13.0, 8.0, 14.0, 0.0, 0.0, 0.0, 0.0, 12.0, 28.0, 17.0, 24.0, 13.0, 11.0, 9.0, 14.0, 0.0, 7.0, 13.0, 0.0, 6.0, 0.0, 3.0, 2.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 18.0, 20.0, 9.0, 9.0, 0.0, 4.0, 18.0, 30.0, 16.0, 1.0, 10.0, 4.0, 7.0, 22.0, 36.0, 0.0, 11.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 7.0, 4.0, 0.0, 0.0, 0.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2395245327691145, "mean_inference_ms": 3.7731035405536666, "mean_action_processing_ms": 0.5367853216125238, "mean_env_wait_ms": 0.44209850517854404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10818815231323242, "StateBufferConnector_ms": 0.015126585960388184, "ViewRequirementAgentConnector_ms": 0.7249200344085693}, "num_episodes": 18, "episode_return_max": 386.0, "episode_return_min": -29.0, "episode_return_mean": 113.37, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 230.87713562901362, "num_env_steps_trained_throughput_per_sec": 230.87713562901362, "timesteps_total": 740000, "num_env_steps_sampled_lifetime": 740000, "num_agent_steps_sampled_lifetime": 2960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2960000, "timers": {"training_iteration_time_ms": 20376.812, "restore_workers_time_ms": 0.048, "training_step_time_ms": 20376.69, "sample_time_ms": 5168.658, "learn_time_ms": 15169.583, "learn_throughput": 263.686, "synch_weights_time_ms": 32.415}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "done": false, "training_iteration": 185, "trial_id": "e1352_00002", "date": "2024-08-13_20-05-09", "timestamp": 1723593909, "time_this_iter_s": 17.442646980285645, "time_total_s": 3791.0204401016235, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f8c4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3791.0204401016235, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 86.06400000000002, "ram_util_percent": 83.67200000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4696614218609674, "cur_kl_coeff": 7.424145005643367e-05, "cur_lr": 0.00010000000000000003, "total_loss": 0.4528484481273505, "policy_loss": -0.001844971360165685, "vf_loss": 0.45469053213499366, "vf_explained_var": -0.0031927613354233836, "kl": 0.03891226134229131, "entropy": 0.4061862225097323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 350595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.56536200639432, "cur_kl_coeff": 0.03424908894048711, "cur_lr": 0.00010000000000000003, "total_loss": 3.318789808586161, "policy_loss": -0.0047855583604711, "vf_loss": 3.3227645016221143, "vf_explained_var": 0.5895976225219707, "kl": 0.023675612626477483, "entropy": 0.943912720427942, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 350595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000}, "env_runners": {"episode_reward_max": 386.0, "episode_reward_min": -85.0, "episode_reward_mean": 123.16, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -98.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 49.0}, "policy_reward_mean": {"prey_policy": 56.315, "predator_policy": 5.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [188.0, 196.0, 0.0, 0.0, 193.0, 365.0, 188.0, 183.0, -6.0, -3.0, 191.0, 0.0, -15.0, 196.0, 0.0, 0.0, 0.0, 0.0, 182.0, -9.0, 0.0, 0.0, 93.0, 101.0, 106.0, -9.0, 200.0, 0.0, 198.0, 176.0, 328.0, 37.0, 208.0, 128.0, 171.0, 360.0, 0.0, 176.0, 179.0, 133.0, 185.0, -9.0, 178.0, 135.0, 190.0, 154.0, 178.0, 0.0, 184.0, 0.0, -6.0, -2.0, -13.0, 365.0, 0.0, 12.0, 318.0, 139.0, 343.0, 154.0, -7.0, -13.0, 197.0, 193.0, 176.0, 0.0, 0.0, 348.0, 176.0, -4.0, 355.0, -17.0, 182.0, -29.0, 135.0, 378.0, 200.0, -3.0, 386.0, 174.0, 0.0, -3.0, -4.0, -6.0, 162.0, 190.0, 304.0, 196.0, 358.0, -1.0, 0.0, 184.0, 381.0, -85.0, 362.0, -36.0, 200.0, 366.0, -18.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [182.0, 0.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 200.0, 164.0, 173.0, 182.0, 0.0, 188.0, -18.0, 0.0, -14.0, 0.0, -6.0, 200.0, -18.0, 0.0, 0.0, -30.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 173.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 93.0, -6.0, 99.0, 0.0, 106.0, -18.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 197.0, 140.0, 0.0, 114.0, 200.0, 28.0, 0.0, 8.0, 200.0, -8.0, 117.0, 176.0, -10.0, 176.0, 164.0, 0.0, 0.0, -16.0, 176.0, 167.0, 0.0, 0.0, 133.0, 173.0, 0.0, -18.0, 0.0, 0.0, 164.0, 116.0, 0.0, 0.0, 185.0, 156.0, -8.0, 167.0, 0.0, 0.0, 0.0, 176.0, 0.0, 0.0, 0.0, -2.0, -8.0, 0.0, -32.0, -24.0, -2.0, 188.0, 155.0, 0.0, 0.0, 12.0, 0.0, 164.0, 114.0, -18.0, 116.0, 173.0, 146.0, 0.0, 131.0, 0.0, -14.0, 0.0, -26.0, 182.0, 9.0, 194.0, -6.0, 0.0, 164.0, 0.0, 0.0, 0.0, 0.0, 137.0, 173.0, 158.0, 0.0, 0.0, -8.0, 200.0, 107.0, -32.0, -2.0, -20.0, 188.0, -44.0, -14.0, -14.0, 113.0, 200.0, 167.0, 200.0, 0.0, -10.0, 0.0, 200.0, 179.0, 0.0, 170.0, 0.0, 0.0, -6.0, 0.0, -8.0, 0.0, 0.0, -12.0, 125.0, 0.0, 185.0, 0.0, 112.0, 188.0, -8.0, 200.0, 173.0, 176.0, -2.0, 0.0, 0.0, 0.0, 0.0, 176.0, 185.0, 188.0, -98.0, -40.0, 194.0, 143.0, -58.0, -14.0, 0.0, 200.0, 173.0, 182.0, 0.0, -36.0, 0.0, 0.0], "policy_predator_policy_reward": [6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 19.0, 9.0, 6.0, 0.0, 8.0, 5.0, 3.0, 5.0, 3.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 16.0, 20.0, 0.0, 14.0, 4.0, 5.0, 0.0, 0.0, 2.0, 17.0, 5.0, 0.0, 8.0, 12.0, 0.0, 0.0, 8.0, 8.0, 8.0, 4.0, 0.0, 0.0, 6.0, 6.0, 9.0, 0.0, 2.0, 12.0, 19.0, 0.0, 0.0, 5.0, 6.0, 0.0, 0.0, 11.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 3.0, 1.0, 14.0, 16.0, 0.0, 13.0, 8.0, 14.0, 0.0, 0.0, 0.0, 0.0, 12.0, 28.0, 17.0, 24.0, 13.0, 11.0, 9.0, 14.0, 0.0, 7.0, 13.0, 0.0, 6.0, 0.0, 3.0, 2.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 18.0, 20.0, 9.0, 9.0, 0.0, 4.0, 18.0, 30.0, 16.0, 1.0, 10.0, 4.0, 7.0, 22.0, 36.0, 0.0, 11.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 7.0, 4.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 4.0, 6.0, 0.0, 23.0, 14.0, 0.0, 5.0, 0.0, 4.0, 4.0, 0.0, 9.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 8.0, 0.0, 4.0, 49.0, 5.0, 20.0, 36.0, 0.0, 0.0, 0.0, 0.0, 11.0, 18.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.248944813984622, "mean_inference_ms": 3.793524421253045, "mean_action_processing_ms": 0.5390632685221217, "mean_env_wait_ms": 0.44495042523542266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10758733749389648, "StateBufferConnector_ms": 0.01473689079284668, "ViewRequirementAgentConnector_ms": 0.6901209354400635}, "num_episodes": 18, "episode_return_max": 386.0, "episode_return_min": -85.0, "episode_return_mean": 123.16, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.30965007728125, "num_env_steps_trained_throughput_per_sec": 234.30965007728125, "timesteps_total": 744000, "num_env_steps_sampled_lifetime": 744000, "num_agent_steps_sampled_lifetime": 2976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2976000, "timers": {"training_iteration_time_ms": 20041.505, "restore_workers_time_ms": 0.053, "training_step_time_ms": 20041.367, "sample_time_ms": 4871.465, "learn_time_ms": 15132.729, "learn_throughput": 264.328, "synch_weights_time_ms": 30.735}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000}, "done": false, "training_iteration": 186, "trial_id": "e1352_00002", "date": "2024-08-13_20-05-27", "timestamp": 1723593927, "time_this_iter_s": 17.15922474861145, "time_total_s": 3808.179664850235, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f724c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3808.179664850235, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 87.53333333333335, "ram_util_percent": 83.70833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.854108648798453, "cur_kl_coeff": 0.00011136217508465055, "cur_lr": 0.00010000000000000003, "total_loss": 1.1151080357965337, "policy_loss": -0.000756645089547549, "vf_loss": 1.1158640026730835, "vf_explained_var": 0.011703170607329677, "kl": 0.006111552773742942, "entropy": 0.5026631529999789, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 352485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.131555900971096, "cur_kl_coeff": 0.051373633410730674, "cur_lr": 0.00010000000000000003, "total_loss": 4.543601417036914, "policy_loss": -0.0014906794633519238, "vf_loss": 4.544624432306441, "vf_explained_var": 0.6011112332659424, "kl": 0.009103244337242557, "entropy": 0.9283617231580946, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 352485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 2992000}, "env_runners": {"episode_reward_max": 386.0, "episode_reward_min": -85.0, "episode_reward_mean": 134.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -98.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 49.0}, "policy_reward_mean": {"prey_policy": 61.07, "predator_policy": 6.27}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 198.0, 176.0, 328.0, 37.0, 208.0, 128.0, 171.0, 360.0, 0.0, 176.0, 179.0, 133.0, 185.0, -9.0, 178.0, 135.0, 190.0, 154.0, 178.0, 0.0, 184.0, 0.0, -6.0, -2.0, -13.0, 365.0, 0.0, 12.0, 318.0, 139.0, 343.0, 154.0, -7.0, -13.0, 197.0, 193.0, 176.0, 0.0, 0.0, 348.0, 176.0, -4.0, 355.0, -17.0, 182.0, -29.0, 135.0, 378.0, 200.0, -3.0, 386.0, 174.0, 0.0, -3.0, -4.0, -6.0, 162.0, 190.0, 304.0, 196.0, 358.0, -1.0, 0.0, 184.0, 381.0, -85.0, 362.0, -36.0, 200.0, 366.0, -18.0, 0.0, -6.0, 0.0, 109.0, 0.0, 366.0, 346.0, 59.0, 320.0, -8.0, 0.0, 200.0, 178.0, 174.0, 198.0, 304.0, 0.0, 378.0, 358.0, 0.0, 0.0, 0.0, 0.0, -5.0, 0.0, 367.0, -13.0, 167.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 197.0, 140.0, 0.0, 114.0, 200.0, 28.0, 0.0, 8.0, 200.0, -8.0, 117.0, 176.0, -10.0, 176.0, 164.0, 0.0, 0.0, -16.0, 176.0, 167.0, 0.0, 0.0, 133.0, 173.0, 0.0, -18.0, 0.0, 0.0, 164.0, 116.0, 0.0, 0.0, 185.0, 156.0, -8.0, 167.0, 0.0, 0.0, 0.0, 176.0, 0.0, 0.0, 0.0, -2.0, -8.0, 0.0, -32.0, -24.0, -2.0, 188.0, 155.0, 0.0, 0.0, 12.0, 0.0, 164.0, 114.0, -18.0, 116.0, 173.0, 146.0, 0.0, 131.0, 0.0, -14.0, 0.0, -26.0, 182.0, 9.0, 194.0, -6.0, 0.0, 164.0, 0.0, 0.0, 0.0, 0.0, 137.0, 173.0, 158.0, 0.0, 0.0, -8.0, 200.0, 107.0, -32.0, -2.0, -20.0, 188.0, -44.0, -14.0, -14.0, 113.0, 200.0, 167.0, 200.0, 0.0, -10.0, 0.0, 200.0, 179.0, 0.0, 170.0, 0.0, 0.0, -6.0, 0.0, -8.0, 0.0, 0.0, -12.0, 125.0, 0.0, 185.0, 0.0, 112.0, 188.0, -8.0, 200.0, 173.0, 176.0, -2.0, 0.0, 0.0, 0.0, 0.0, 176.0, 185.0, 188.0, -98.0, -40.0, 194.0, 143.0, -58.0, -14.0, 0.0, 200.0, 173.0, 182.0, 0.0, -36.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 109.0, 0.0, 0.0, 182.0, 167.0, 178.0, 160.0, 0.0, 5.0, 167.0, 139.0, -14.0, -8.0, -8.0, 0.0, 0.0, 200.0, 0.0, 167.0, 168.0, -8.0, 197.0, 0.0, 65.0, 161.0, 0.0, 0.0, 200.0, 161.0, 194.0, 134.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, 0.0, 0.0, 174.0, 192.0, -12.0, -22.0, 155.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 1.0, 16.0, 20.0, 0.0, 14.0, 4.0, 5.0, 0.0, 0.0, 2.0, 17.0, 5.0, 0.0, 8.0, 12.0, 0.0, 0.0, 8.0, 8.0, 8.0, 4.0, 0.0, 0.0, 6.0, 6.0, 9.0, 0.0, 2.0, 12.0, 19.0, 0.0, 0.0, 5.0, 6.0, 0.0, 0.0, 11.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 3.0, 1.0, 14.0, 16.0, 0.0, 13.0, 8.0, 14.0, 0.0, 0.0, 0.0, 0.0, 12.0, 28.0, 17.0, 24.0, 13.0, 11.0, 9.0, 14.0, 0.0, 7.0, 13.0, 0.0, 6.0, 0.0, 3.0, 2.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 18.0, 20.0, 9.0, 9.0, 0.0, 4.0, 18.0, 30.0, 16.0, 1.0, 10.0, 4.0, 7.0, 22.0, 36.0, 0.0, 11.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 7.0, 4.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 4.0, 6.0, 0.0, 23.0, 14.0, 0.0, 5.0, 0.0, 4.0, 4.0, 0.0, 9.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 8.0, 0.0, 4.0, 49.0, 5.0, 20.0, 36.0, 0.0, 0.0, 0.0, 0.0, 11.0, 18.0, 0.0, 0.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 13.0, 8.0, 0.0, 24.0, 30.0, 14.0, 0.0, 3.0, 11.0, 4.0, 4.0, 0.0, 0.0, 0.0, 11.0, 14.0, 0.0, 0.0, 1.0, 38.0, 40.0, 0.0, 0.0, 12.0, 5.0, 17.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 10.0, 0.0, 0.0, 0.0, 1.0, 10.0, 11.0, 0.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2605298331335966, "mean_inference_ms": 3.817527267988444, "mean_action_processing_ms": 0.5412951747690606, "mean_env_wait_ms": 0.44864584357830295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.091727614402771, "StateBufferConnector_ms": 0.013956189155578613, "ViewRequirementAgentConnector_ms": 0.5358350276947021}, "num_episodes": 27, "episode_return_max": 386.0, "episode_return_min": -85.0, "episode_return_mean": 134.68, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 2992000, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 231.3084702287207, "num_env_steps_trained_throughput_per_sec": 231.3084702287207, "timesteps_total": 748000, "num_env_steps_sampled_lifetime": 748000, "num_agent_steps_sampled_lifetime": 2992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2992000, "timers": {"training_iteration_time_ms": 19891.991, "restore_workers_time_ms": 0.053, "training_step_time_ms": 19891.854, "sample_time_ms": 4655.485, "learn_time_ms": 15200.016, "learn_throughput": 263.158, "synch_weights_time_ms": 30.8}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 2992000}, "done": false, "training_iteration": 187, "trial_id": "e1352_00002", "date": "2024-08-13_20-05-44", "timestamp": 1723593944, "time_this_iter_s": 17.383569717407227, "time_total_s": 3825.563234567642, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b981f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3825.563234567642, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 92.57199999999999, "ram_util_percent": 83.736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8253684543664492, "cur_kl_coeff": 0.00011136217508465055, "cur_lr": 0.00010000000000000003, "total_loss": 0.6987072853972672, "policy_loss": -0.0022676202820899783, "vf_loss": 0.700973334376301, "vf_explained_var": 0.007659528873584889, "kl": 0.014105980211907256, "entropy": 0.4507227762035592, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 354375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.606001860281777, "cur_kl_coeff": 0.051373633410730674, "cur_lr": 0.00010000000000000003, "total_loss": 2.2241970841846768, "policy_loss": -0.0011116575104770836, "vf_loss": 2.2246060388428823, "vf_explained_var": 0.783290497840397, "kl": 0.013678295152129, "entropy": 0.9747911953421496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 354375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000}, "env_runners": {"episode_reward_max": 386.0, "episode_reward_min": -85.0, "episode_reward_mean": 115.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -98.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 49.0}, "policy_reward_mean": {"prey_policy": 51.7, "predator_policy": 5.835}, "custom_metrics": {}, "hist_stats": {"episode_reward": [154.0, 178.0, 0.0, 184.0, 0.0, -6.0, -2.0, -13.0, 365.0, 0.0, 12.0, 318.0, 139.0, 343.0, 154.0, -7.0, -13.0, 197.0, 193.0, 176.0, 0.0, 0.0, 348.0, 176.0, -4.0, 355.0, -17.0, 182.0, -29.0, 135.0, 378.0, 200.0, -3.0, 386.0, 174.0, 0.0, -3.0, -4.0, -6.0, 162.0, 190.0, 304.0, 196.0, 358.0, -1.0, 0.0, 184.0, 381.0, -85.0, 362.0, -36.0, 200.0, 366.0, -18.0, 0.0, -6.0, 0.0, 109.0, 0.0, 366.0, 346.0, 59.0, 320.0, -8.0, 0.0, 200.0, 178.0, 174.0, 198.0, 304.0, 0.0, 378.0, 358.0, 0.0, 0.0, 0.0, 0.0, -5.0, 0.0, 367.0, -13.0, 167.0, -7.0, -3.0, 109.0, 151.0, 0.0, 0.0, 0.0, -3.0, 0.0, 0.0, 374.0, 200.0, -1.0, 7.0, -6.0, 0.0, 0.0, -9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [156.0, -8.0, 167.0, 0.0, 0.0, 0.0, 176.0, 0.0, 0.0, 0.0, -2.0, -8.0, 0.0, -32.0, -24.0, -2.0, 188.0, 155.0, 0.0, 0.0, 12.0, 0.0, 164.0, 114.0, -18.0, 116.0, 173.0, 146.0, 0.0, 131.0, 0.0, -14.0, 0.0, -26.0, 182.0, 9.0, 194.0, -6.0, 0.0, 164.0, 0.0, 0.0, 0.0, 0.0, 137.0, 173.0, 158.0, 0.0, 0.0, -8.0, 200.0, 107.0, -32.0, -2.0, -20.0, 188.0, -44.0, -14.0, -14.0, 113.0, 200.0, 167.0, 200.0, 0.0, -10.0, 0.0, 200.0, 179.0, 0.0, 170.0, 0.0, 0.0, -6.0, 0.0, -8.0, 0.0, 0.0, -12.0, 125.0, 0.0, 185.0, 0.0, 112.0, 188.0, -8.0, 200.0, 173.0, 176.0, -2.0, 0.0, 0.0, 0.0, 0.0, 176.0, 185.0, 188.0, -98.0, -40.0, 194.0, 143.0, -58.0, -14.0, 0.0, 200.0, 173.0, 182.0, 0.0, -36.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 109.0, 0.0, 0.0, 182.0, 167.0, 178.0, 160.0, 0.0, 5.0, 167.0, 139.0, -14.0, -8.0, -8.0, 0.0, 0.0, 200.0, 0.0, 167.0, 168.0, -8.0, 197.0, 0.0, 65.0, 161.0, 0.0, 0.0, 200.0, 161.0, 194.0, 134.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, 0.0, 0.0, 174.0, 192.0, -12.0, -22.0, 155.0, 0.0, -14.0, 0.0, 0.0, -6.0, 85.0, 0.0, 140.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 200.0, 152.0, 200.0, 0.0, -2.0, 0.0, 7.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0], "policy_predator_policy_reward": [6.0, 0.0, 0.0, 11.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 3.0, 1.0, 14.0, 16.0, 0.0, 13.0, 8.0, 14.0, 0.0, 0.0, 0.0, 0.0, 12.0, 28.0, 17.0, 24.0, 13.0, 11.0, 9.0, 14.0, 0.0, 7.0, 13.0, 0.0, 6.0, 0.0, 3.0, 2.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 18.0, 20.0, 9.0, 9.0, 0.0, 4.0, 18.0, 30.0, 16.0, 1.0, 10.0, 4.0, 7.0, 22.0, 36.0, 0.0, 11.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 7.0, 4.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 4.0, 6.0, 0.0, 23.0, 14.0, 0.0, 5.0, 0.0, 4.0, 4.0, 0.0, 9.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 8.0, 0.0, 4.0, 49.0, 5.0, 20.0, 36.0, 0.0, 0.0, 0.0, 0.0, 11.0, 18.0, 0.0, 0.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 13.0, 8.0, 0.0, 24.0, 30.0, 14.0, 0.0, 3.0, 11.0, 4.0, 4.0, 0.0, 0.0, 0.0, 11.0, 14.0, 0.0, 0.0, 1.0, 38.0, 40.0, 0.0, 0.0, 12.0, 5.0, 17.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 10.0, 0.0, 0.0, 0.0, 1.0, 10.0, 11.0, 0.0, 12.0, 0.0, 7.0, 3.0, 0.0, 24.0, 0.0, 9.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 14.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2644134599880597, "mean_inference_ms": 3.82955075279113, "mean_action_processing_ms": 0.542766225662204, "mean_env_wait_ms": 0.4498232870433633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01921391487121582, "StateBufferConnector_ms": 0.005797624588012695, "ViewRequirementAgentConnector_ms": 0.3305412530899048}, "num_episodes": 18, "episode_return_max": 386.0, "episode_return_min": -85.0, "episode_return_mean": 115.07, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 203.68730093106734, "num_env_steps_trained_throughput_per_sec": 203.68730093106734, "timesteps_total": 752000, "num_env_steps_sampled_lifetime": 752000, "num_agent_steps_sampled_lifetime": 3008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3008000, "timers": {"training_iteration_time_ms": 20053.882, "restore_workers_time_ms": 0.053, "training_step_time_ms": 20053.732, "sample_time_ms": 4905.119, "learn_time_ms": 15112.657, "learn_throughput": 264.679, "synch_weights_time_ms": 30.685}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000}, "done": false, "training_iteration": 188, "trial_id": "e1352_00002", "date": "2024-08-13_20-06-04", "timestamp": 1723593964, "time_this_iter_s": 19.728205919265747, "time_total_s": 3845.291440486908, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2ff1d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3845.291440486908, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 96.48571428571428, "ram_util_percent": 83.77142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2750778752738836, "cur_kl_coeff": 0.00011136217508465055, "cur_lr": 0.00010000000000000003, "total_loss": 0.6040316223782837, "policy_loss": -0.005518407866890941, "vf_loss": 0.6095490417822643, "vf_explained_var": 0.02666913069114483, "kl": 0.008873459484749081, "entropy": 0.49997012042810046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 356265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.526382081754624, "cur_kl_coeff": 0.051373633410730674, "cur_lr": 0.00010000000000000003, "total_loss": 5.672365827661343, "policy_loss": 0.0015320189373577557, "vf_loss": 5.67050987500993, "vf_explained_var": 0.6980295987040909, "kl": 0.006305551123497141, "entropy": 0.8854995621890618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 356265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 3024000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": -85.0, "episode_reward_mean": 130.9, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -98.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 49.0}, "policy_reward_mean": {"prey_policy": 59.915, "predator_policy": 5.535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193.0, 176.0, 0.0, 0.0, 348.0, 176.0, -4.0, 355.0, -17.0, 182.0, -29.0, 135.0, 378.0, 200.0, -3.0, 386.0, 174.0, 0.0, -3.0, -4.0, -6.0, 162.0, 190.0, 304.0, 196.0, 358.0, -1.0, 0.0, 184.0, 381.0, -85.0, 362.0, -36.0, 200.0, 366.0, -18.0, 0.0, -6.0, 0.0, 109.0, 0.0, 366.0, 346.0, 59.0, 320.0, -8.0, 0.0, 200.0, 178.0, 174.0, 198.0, 304.0, 0.0, 378.0, 358.0, 0.0, 0.0, 0.0, 0.0, -5.0, 0.0, 367.0, -13.0, 167.0, -7.0, -3.0, 109.0, 151.0, 0.0, 0.0, 0.0, -3.0, 0.0, 0.0, 374.0, 200.0, -1.0, 7.0, -6.0, 0.0, 0.0, -9.0, 167.0, 174.0, 371.0, 0.0, 0.0, 390.0, 0.0, 311.0, 188.0, 164.0, 347.0, 180.0, 178.0, 312.0, 138.0, 311.0, 159.0, 196.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [194.0, -6.0, 0.0, 164.0, 0.0, 0.0, 0.0, 0.0, 137.0, 173.0, 158.0, 0.0, 0.0, -8.0, 200.0, 107.0, -32.0, -2.0, -20.0, 188.0, -44.0, -14.0, -14.0, 113.0, 200.0, 167.0, 200.0, 0.0, -10.0, 0.0, 200.0, 179.0, 0.0, 170.0, 0.0, 0.0, -6.0, 0.0, -8.0, 0.0, 0.0, -12.0, 125.0, 0.0, 185.0, 0.0, 112.0, 188.0, -8.0, 200.0, 173.0, 176.0, -2.0, 0.0, 0.0, 0.0, 0.0, 176.0, 185.0, 188.0, -98.0, -40.0, 194.0, 143.0, -58.0, -14.0, 0.0, 200.0, 173.0, 182.0, 0.0, -36.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 109.0, 0.0, 0.0, 182.0, 167.0, 178.0, 160.0, 0.0, 5.0, 167.0, 139.0, -14.0, -8.0, -8.0, 0.0, 0.0, 200.0, 0.0, 167.0, 168.0, -8.0, 197.0, 0.0, 65.0, 161.0, 0.0, 0.0, 200.0, 161.0, 194.0, 134.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, 0.0, 0.0, 174.0, 192.0, -12.0, -22.0, 155.0, 0.0, -14.0, 0.0, 0.0, -6.0, 85.0, 0.0, 140.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 200.0, 152.0, 200.0, 0.0, -2.0, 0.0, 7.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, 161.0, 0.0, 164.0, 0.0, 179.0, 179.0, 0.0, 0.0, 0.0, 0.0, 190.0, 200.0, 0.0, 0.0, 137.0, 161.0, 0.0, 182.0, 146.0, 0.0, 156.0, 176.0, 180.0, 0.0, 167.0, 0.0, 155.0, 137.0, -50.0, 163.0, 182.0, 117.0, 122.0, 0.0, 0.0, 194.0], "policy_predator_policy_reward": [3.0, 2.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 18.0, 20.0, 9.0, 9.0, 0.0, 4.0, 18.0, 30.0, 16.0, 1.0, 10.0, 4.0, 7.0, 22.0, 36.0, 0.0, 11.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 7.0, 4.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 4.0, 6.0, 0.0, 23.0, 14.0, 0.0, 5.0, 0.0, 4.0, 4.0, 0.0, 9.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 8.0, 0.0, 4.0, 49.0, 5.0, 20.0, 36.0, 0.0, 0.0, 0.0, 0.0, 11.0, 18.0, 0.0, 0.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 13.0, 8.0, 0.0, 24.0, 30.0, 14.0, 0.0, 3.0, 11.0, 4.0, 4.0, 0.0, 0.0, 0.0, 11.0, 14.0, 0.0, 0.0, 1.0, 38.0, 40.0, 0.0, 0.0, 12.0, 5.0, 17.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 10.0, 0.0, 0.0, 0.0, 1.0, 10.0, 11.0, 0.0, 12.0, 0.0, 7.0, 3.0, 0.0, 24.0, 0.0, 9.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 14.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 3.0, 3.0, 5.0, 5.0, 5.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 6.0, 0.0, 0.0, 18.0, 0.0, 15.0, 0.0, 0.0, 0.0, 11.0, 0.0, 20.0, 0.0, 25.0, 0.0, 12.0, 19.0, 18.0, 2.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2665902663931694, "mean_inference_ms": 3.835390696190095, "mean_action_processing_ms": 0.5431272021039163, "mean_env_wait_ms": 0.4506233906699482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006927847862243652, "StateBufferConnector_ms": 0.004516482353210449, "ViewRequirementAgentConnector_ms": 0.3325244188308716}, "num_episodes": 18, "episode_return_max": 390.0, "episode_return_min": -85.0, "episode_return_mean": 130.9, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 3024000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.42977205188075, "num_env_steps_trained_throughput_per_sec": 251.42977205188075, "timesteps_total": 756000, "num_env_steps_sampled_lifetime": 756000, "num_agent_steps_sampled_lifetime": 3024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3024000, "timers": {"training_iteration_time_ms": 20022.997, "restore_workers_time_ms": 0.053, "training_step_time_ms": 20022.796, "sample_time_ms": 4842.895, "learn_time_ms": 15143.956, "learn_throughput": 264.132, "synch_weights_time_ms": 30.51}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 3024000}, "done": false, "training_iteration": 189, "trial_id": "e1352_00002", "date": "2024-08-13_20-06-20", "timestamp": 1723593980, "time_this_iter_s": 15.958380699157715, "time_total_s": 3861.2498211860657, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2ff13a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3861.2498211860657, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 86.21818181818182, "ram_util_percent": 82.55909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8045293762885704, "cur_kl_coeff": 0.00011136217508465055, "cur_lr": 0.00010000000000000003, "total_loss": 0.9111506550084977, "policy_loss": -0.0015596262830994512, "vf_loss": 0.9127096306710016, "vf_explained_var": 0.0014042432976778222, "kl": 0.0058440650890315944, "entropy": 0.5090612088877057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 358155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.144722848499894, "cur_kl_coeff": 0.051373633410730674, "cur_lr": 0.00010000000000000003, "total_loss": 5.251252105879405, "policy_loss": -0.002655644066109465, "vf_loss": 5.253383226747866, "vf_explained_var": 0.7372005050459867, "kl": 0.010209984309030154, "entropy": 0.8257690125987643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 358155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": -85.0, "episode_reward_mean": 133.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -98.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 49.0}, "policy_reward_mean": {"prey_policy": 61.725, "predator_policy": 5.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -6.0, 162.0, 190.0, 304.0, 196.0, 358.0, -1.0, 0.0, 184.0, 381.0, -85.0, 362.0, -36.0, 200.0, 366.0, -18.0, 0.0, -6.0, 0.0, 109.0, 0.0, 366.0, 346.0, 59.0, 320.0, -8.0, 0.0, 200.0, 178.0, 174.0, 198.0, 304.0, 0.0, 378.0, 358.0, 0.0, 0.0, 0.0, 0.0, -5.0, 0.0, 367.0, -13.0, 167.0, -7.0, -3.0, 109.0, 151.0, 0.0, 0.0, 0.0, -3.0, 0.0, 0.0, 374.0, 200.0, -1.0, 7.0, -6.0, 0.0, 0.0, -9.0, 167.0, 174.0, 371.0, 0.0, 0.0, 390.0, 0.0, 311.0, 188.0, 164.0, 347.0, 180.0, 178.0, 312.0, 138.0, 311.0, 159.0, 196.0, 112.0, 86.0, 285.0, -1.0, 200.0, 0.0, 27.0, 388.0, 0.0, 380.0, 296.0, 0.0, 262.0, 344.0, 370.0, 0.0, 0.0, 196.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, 0.0, -8.0, 0.0, 0.0, -12.0, 125.0, 0.0, 185.0, 0.0, 112.0, 188.0, -8.0, 200.0, 173.0, 176.0, -2.0, 0.0, 0.0, 0.0, 0.0, 176.0, 185.0, 188.0, -98.0, -40.0, 194.0, 143.0, -58.0, -14.0, 0.0, 200.0, 173.0, 182.0, 0.0, -36.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 109.0, 0.0, 0.0, 182.0, 167.0, 178.0, 160.0, 0.0, 5.0, 167.0, 139.0, -14.0, -8.0, -8.0, 0.0, 0.0, 200.0, 0.0, 167.0, 168.0, -8.0, 197.0, 0.0, 65.0, 161.0, 0.0, 0.0, 200.0, 161.0, 194.0, 134.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, 0.0, 0.0, 174.0, 192.0, -12.0, -22.0, 155.0, 0.0, -14.0, 0.0, 0.0, -6.0, 85.0, 0.0, 140.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 200.0, 152.0, 200.0, 0.0, -2.0, 0.0, 7.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, 161.0, 0.0, 164.0, 0.0, 179.0, 179.0, 0.0, 0.0, 0.0, 0.0, 190.0, 200.0, 0.0, 0.0, 137.0, 161.0, 0.0, 182.0, 146.0, 0.0, 156.0, 176.0, 180.0, 0.0, 167.0, 0.0, 155.0, 137.0, -50.0, 163.0, 182.0, 117.0, 122.0, 0.0, 0.0, 194.0, 0.0, 109.0, 88.0, -18.0, 152.0, 108.0, 0.0, -26.0, 0.0, 200.0, 0.0, 0.0, 0.0, 27.0, 200.0, 182.0, 0.0, 0.0, 179.0, 182.0, 134.0, 134.0, 0.0, 0.0, 73.0, 167.0, 170.0, 152.0, 161.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 194.0], "policy_predator_policy_reward": [0.0, 3.0, 0.0, 4.0, 6.0, 0.0, 23.0, 14.0, 0.0, 5.0, 0.0, 4.0, 4.0, 0.0, 9.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 8.0, 0.0, 4.0, 49.0, 5.0, 20.0, 36.0, 0.0, 0.0, 0.0, 0.0, 11.0, 18.0, 0.0, 0.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 13.0, 8.0, 0.0, 24.0, 30.0, 14.0, 0.0, 3.0, 11.0, 4.0, 4.0, 0.0, 0.0, 0.0, 11.0, 14.0, 0.0, 0.0, 1.0, 38.0, 40.0, 0.0, 0.0, 12.0, 5.0, 17.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 10.0, 0.0, 0.0, 0.0, 1.0, 10.0, 11.0, 0.0, 12.0, 0.0, 7.0, 3.0, 0.0, 24.0, 0.0, 9.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 14.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 3.0, 3.0, 5.0, 5.0, 5.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 6.0, 0.0, 0.0, 18.0, 0.0, 15.0, 0.0, 0.0, 0.0, 11.0, 0.0, 20.0, 0.0, 25.0, 0.0, 12.0, 19.0, 18.0, 2.0, 0.0, 3.0, 0.0, 8.0, 8.0, 10.0, 15.0, 12.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 9.0, 10.0, 19.0, 9.0, 0.0, 0.0, 11.0, 11.0, 12.0, 10.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.268043611502396, "mean_inference_ms": 3.8406433223114957, "mean_action_processing_ms": 0.5434041372137536, "mean_env_wait_ms": 0.4513062353203243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006713151931762695, "StateBufferConnector_ms": 0.004041433334350586, "ViewRequirementAgentConnector_ms": 0.27825963497161865}, "num_episodes": 18, "episode_return_max": 390.0, "episode_return_min": -85.0, "episode_return_mean": 133.85, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 244.95450872119974, "num_env_steps_trained_throughput_per_sec": 244.95450872119974, "timesteps_total": 760000, "num_env_steps_sampled_lifetime": 760000, "num_agent_steps_sampled_lifetime": 3040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3040000, "timers": {"training_iteration_time_ms": 20169.567, "restore_workers_time_ms": 0.053, "training_step_time_ms": 20169.367, "sample_time_ms": 5013.37, "learn_time_ms": 15119.36, "learn_throughput": 264.561, "synch_weights_time_ms": 31.161}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "done": false, "training_iteration": 190, "trial_id": "e1352_00002", "date": "2024-08-13_20-06-36", "timestamp": 1723593996, "time_this_iter_s": 16.38913893699646, "time_total_s": 3877.638960123062, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af096ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3877.638960123062, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 89.59583333333335, "ram_util_percent": 82.82083333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.711876317712838, "cur_kl_coeff": 0.00011136217508465055, "cur_lr": 0.00010000000000000003, "total_loss": 0.8053852219272543, "policy_loss": -0.001406886444855777, "vf_loss": 0.806791415069469, "vf_explained_var": -0.002563976768463377, "kl": 0.0062290008094323356, "entropy": 0.40075376861625245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 360045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.730108514286222, "cur_kl_coeff": 0.051373633410730674, "cur_lr": 0.00010000000000000003, "total_loss": 6.169645302131693, "policy_loss": 0.0012338600848264322, "vf_loss": 6.1679505181691, "vf_explained_var": 0.6822251131294896, "kl": 0.008972055737022613, "entropy": 0.8251385428602733, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 360045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 3056000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": -13.0, "episode_reward_mean": 149.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -112.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 55.0}, "policy_reward_mean": {"prey_policy": 69.26, "predator_policy": 5.245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.0, 346.0, 59.0, 320.0, -8.0, 0.0, 200.0, 178.0, 174.0, 198.0, 304.0, 0.0, 378.0, 358.0, 0.0, 0.0, 0.0, 0.0, -5.0, 0.0, 367.0, -13.0, 167.0, -7.0, -3.0, 109.0, 151.0, 0.0, 0.0, 0.0, -3.0, 0.0, 0.0, 374.0, 200.0, -1.0, 7.0, -6.0, 0.0, 0.0, -9.0, 167.0, 174.0, 371.0, 0.0, 0.0, 390.0, 0.0, 311.0, 188.0, 164.0, 347.0, 180.0, 178.0, 312.0, 138.0, 311.0, 159.0, 196.0, 112.0, 86.0, 285.0, -1.0, 200.0, 0.0, 27.0, 388.0, 0.0, 380.0, 296.0, 0.0, 262.0, 344.0, 370.0, 0.0, 0.0, 196.0, 275.0, 137.0, 102.0, 87.0, 198.0, 341.0, 210.0, 169.0, 185.0, -13.0, 371.0, 155.0, 193.0, 164.0, 196.0, 134.0, 187.0, 77.0, 358.0, 33.0, 225.0, 272.0, 113.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [182.0, 167.0, 178.0, 160.0, 0.0, 5.0, 167.0, 139.0, -14.0, -8.0, -8.0, 0.0, 0.0, 200.0, 0.0, 167.0, 168.0, -8.0, 197.0, 0.0, 65.0, 161.0, 0.0, 0.0, 200.0, 161.0, 194.0, 134.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, 0.0, 0.0, 174.0, 192.0, -12.0, -22.0, 155.0, 0.0, -14.0, 0.0, 0.0, -6.0, 85.0, 0.0, 140.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 200.0, 152.0, 200.0, 0.0, -2.0, 0.0, 7.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, 161.0, 0.0, 164.0, 0.0, 179.0, 179.0, 0.0, 0.0, 0.0, 0.0, 190.0, 200.0, 0.0, 0.0, 137.0, 161.0, 0.0, 182.0, 146.0, 0.0, 156.0, 176.0, 180.0, 0.0, 167.0, 0.0, 155.0, 137.0, -50.0, 163.0, 182.0, 117.0, 122.0, 0.0, 0.0, 194.0, 0.0, 109.0, 88.0, -18.0, 152.0, 108.0, 0.0, -26.0, 0.0, 200.0, 0.0, 0.0, 0.0, 27.0, 200.0, 182.0, 0.0, 0.0, 179.0, 182.0, 134.0, 134.0, 0.0, 0.0, 73.0, 167.0, 170.0, 152.0, 161.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 194.0, 173.0, 93.0, 0.0, 129.0, 102.0, 0.0, 0.0, 87.0, 197.0, 0.0, 141.0, 200.0, 200.0, 10.0, 0.0, 152.0, 185.0, 0.0, -26.0, 0.0, 167.0, 188.0, -112.0, 177.0, 185.0, 0.0, 162.0, 0.0, 194.0, 0.0, 0.0, 134.0, 182.0, 0.0, -80.0, 117.0, 161.0, 179.0, 0.0, 33.0, 34.0, 171.0, 87.0, 185.0, 113.0, 0.0], "policy_predator_policy_reward": [4.0, 13.0, 8.0, 0.0, 24.0, 30.0, 14.0, 0.0, 3.0, 11.0, 4.0, 4.0, 0.0, 0.0, 0.0, 11.0, 14.0, 0.0, 0.0, 1.0, 38.0, 40.0, 0.0, 0.0, 12.0, 5.0, 17.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 10.0, 0.0, 0.0, 0.0, 1.0, 10.0, 11.0, 0.0, 12.0, 0.0, 7.0, 3.0, 0.0, 24.0, 0.0, 9.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 14.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 3.0, 3.0, 5.0, 5.0, 5.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 6.0, 0.0, 0.0, 18.0, 0.0, 15.0, 0.0, 0.0, 0.0, 11.0, 0.0, 20.0, 0.0, 25.0, 0.0, 12.0, 19.0, 18.0, 2.0, 0.0, 3.0, 0.0, 8.0, 8.0, 10.0, 15.0, 12.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 9.0, 10.0, 19.0, 9.0, 0.0, 0.0, 11.0, 11.0, 12.0, 10.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 11.0, 0.0, 0.0, 0.0, 13.0, 3.0, 13.0, 35.0, 55.0, 4.0, 4.0, 2.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 5.0, 40.0, 0.0, 17.0, 1.0, 0.0, 0.0, 8.0, 12.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2687169559902396, "mean_inference_ms": 3.849207071569652, "mean_action_processing_ms": 0.5437163258181259, "mean_env_wait_ms": 0.4529452604238132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006300210952758789, "StateBufferConnector_ms": 0.007239818572998047, "ViewRequirementAgentConnector_ms": 0.2855573892593384}, "num_episodes": 23, "episode_return_max": 390.0, "episode_return_min": -13.0, "episode_return_mean": 149.01, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 3056000, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 239.08243347015213, "num_env_steps_trained_throughput_per_sec": 239.08243347015213, "timesteps_total": 764000, "num_env_steps_sampled_lifetime": 764000, "num_agent_steps_sampled_lifetime": 3056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3056000, "timers": {"training_iteration_time_ms": 18880.417, "restore_workers_time_ms": 0.053, "training_step_time_ms": 18880.218, "sample_time_ms": 4865.348, "learn_time_ms": 13983.634, "learn_throughput": 286.049, "synch_weights_time_ms": 25.962}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 3056000}, "done": false, "training_iteration": 191, "trial_id": "e1352_00002", "date": "2024-08-13_20-06-53", "timestamp": 1723594013, "time_this_iter_s": 16.802570104599, "time_total_s": 3894.441530227661, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f9ba60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3894.441530227661, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 85.52499999999999, "ram_util_percent": 83.15833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.612288342763192, "cur_kl_coeff": 0.00011136217508465055, "cur_lr": 0.00010000000000000003, "total_loss": 2.433555429259305, "policy_loss": -0.0010079208665364791, "vf_loss": 2.4345625316655193, "vf_explained_var": -0.0016123331097698717, "kl": 0.007360473441573078, "entropy": 0.478260623147248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 361935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.681686880001946, "cur_kl_coeff": 0.051373633410730674, "cur_lr": 0.00010000000000000003, "total_loss": 5.477736119366197, "policy_loss": -0.0042898634733218284, "vf_loss": 5.481301257471559, "vf_explained_var": 0.6770167023416549, "kl": 0.014106954384678605, "entropy": 0.8218378125675141, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 361935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": -13.0, "episode_reward_mean": 151.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -206.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 75.0}, "policy_reward_mean": {"prey_policy": 68.645, "predator_policy": 6.86}, "custom_metrics": {}, "hist_stats": {"episode_reward": [167.0, -7.0, -3.0, 109.0, 151.0, 0.0, 0.0, 0.0, -3.0, 0.0, 0.0, 374.0, 200.0, -1.0, 7.0, -6.0, 0.0, 0.0, -9.0, 167.0, 174.0, 371.0, 0.0, 0.0, 390.0, 0.0, 311.0, 188.0, 164.0, 347.0, 180.0, 178.0, 312.0, 138.0, 311.0, 159.0, 196.0, 112.0, 86.0, 285.0, -1.0, 200.0, 0.0, 27.0, 388.0, 0.0, 380.0, 296.0, 0.0, 262.0, 344.0, 370.0, 0.0, 0.0, 196.0, 275.0, 137.0, 102.0, 87.0, 198.0, 341.0, 210.0, 169.0, 185.0, -13.0, 371.0, 155.0, 193.0, 164.0, 196.0, 134.0, 187.0, 77.0, 358.0, 33.0, 225.0, 272.0, 113.0, 324.0, 46.0, 334.0, 19.0, 195.0, 162.0, 130.0, 138.0, 0.0, 99.0, 138.0, 164.0, 198.0, 254.0, 180.0, 178.0, 109.0, 141.0, 200.0, 200.0, 43.0, 170.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [155.0, 0.0, -14.0, 0.0, 0.0, -6.0, 85.0, 0.0, 140.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 200.0, 152.0, 200.0, 0.0, -2.0, 0.0, 7.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, 161.0, 0.0, 164.0, 0.0, 179.0, 179.0, 0.0, 0.0, 0.0, 0.0, 190.0, 200.0, 0.0, 0.0, 137.0, 161.0, 0.0, 182.0, 146.0, 0.0, 156.0, 176.0, 180.0, 0.0, 167.0, 0.0, 155.0, 137.0, -50.0, 163.0, 182.0, 117.0, 122.0, 0.0, 0.0, 194.0, 0.0, 109.0, 88.0, -18.0, 152.0, 108.0, 0.0, -26.0, 0.0, 200.0, 0.0, 0.0, 0.0, 27.0, 200.0, 182.0, 0.0, 0.0, 179.0, 182.0, 134.0, 134.0, 0.0, 0.0, 73.0, 167.0, 170.0, 152.0, 161.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 194.0, 173.0, 93.0, 0.0, 129.0, 102.0, 0.0, 0.0, 87.0, 197.0, 0.0, 141.0, 200.0, 200.0, 10.0, 0.0, 152.0, 185.0, 0.0, -26.0, 0.0, 167.0, 188.0, -112.0, 177.0, 185.0, 0.0, 162.0, 0.0, 194.0, 0.0, 0.0, 134.0, 182.0, 0.0, -80.0, 117.0, 161.0, 179.0, 0.0, 33.0, 34.0, 171.0, 87.0, 185.0, 113.0, 0.0, 173.0, 142.0, -206.0, 149.0, 140.0, 173.0, 56.0, -74.0, -10.0, 200.0, -10.0, 151.0, 0.0, 130.0, 138.0, 0.0, 0.0, 0.0, 45.0, -8.0, 113.0, 0.0, 164.0, 0.0, 197.0, 0.0, 12.0, 199.0, 0.0, 170.0, 21.0, 140.0, 25.0, 0.0, 107.0, 0.0, 0.0, 200.0, 200.0, 0.0, -21.0, -85.0, 0.0, 155.0], "policy_predator_policy_reward": [0.0, 12.0, 0.0, 7.0, 3.0, 0.0, 24.0, 0.0, 9.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 14.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 3.0, 3.0, 5.0, 5.0, 5.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 6.0, 0.0, 0.0, 18.0, 0.0, 15.0, 0.0, 0.0, 0.0, 11.0, 0.0, 20.0, 0.0, 25.0, 0.0, 12.0, 19.0, 18.0, 2.0, 0.0, 3.0, 0.0, 8.0, 8.0, 10.0, 15.0, 12.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 9.0, 10.0, 19.0, 9.0, 0.0, 0.0, 11.0, 11.0, 12.0, 10.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 11.0, 0.0, 0.0, 0.0, 13.0, 3.0, 13.0, 35.0, 55.0, 4.0, 4.0, 2.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 5.0, 40.0, 0.0, 17.0, 1.0, 0.0, 0.0, 8.0, 12.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 57.0, 46.0, 21.0, 0.0, 37.0, 0.0, 0.0, 5.0, 5.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0, 35.0, 0.0, 25.0, 0.0, 0.0, 0.0, 1.0, 1.0, 42.0, 5.0, 5.0, 8.0, 9.0, 43.0, 41.0, 20.0, 14.0, 0.0, 0.0, 0.0, 0.0, 75.0, 74.0, 1.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2722364255998435, "mean_inference_ms": 3.854155696630737, "mean_action_processing_ms": 0.5442649862492467, "mean_env_wait_ms": 0.45321772397621485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071659088134765625, "StateBufferConnector_ms": 0.007446765899658203, "ViewRequirementAgentConnector_ms": 0.30407512187957764}, "num_episodes": 22, "episode_return_max": 390.0, "episode_return_min": -13.0, "episode_return_mean": 151.01, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 237.34098786478435, "num_env_steps_trained_throughput_per_sec": 237.34098786478435, "timesteps_total": 768000, "num_env_steps_sampled_lifetime": 768000, "num_agent_steps_sampled_lifetime": 3072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3072000, "timers": {"training_iteration_time_ms": 18492.059, "restore_workers_time_ms": 0.053, "training_step_time_ms": 18491.86, "sample_time_ms": 4710.5, "learn_time_ms": 13752.049, "learn_throughput": 290.866, "synch_weights_time_ms": 24.188}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000}, "done": false, "training_iteration": 192, "trial_id": "e1352_00002", "date": "2024-08-13_20-07-10", "timestamp": 1723594030, "time_this_iter_s": 16.936348915100098, "time_total_s": 3911.3778791427612, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1681ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3911.3778791427612, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 86.34166666666668, "ram_util_percent": 83.71666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2156641377343074, "cur_kl_coeff": 0.00011136217508465055, "cur_lr": 0.00010000000000000003, "total_loss": 0.8658866962427816, "policy_loss": -0.003125523994849236, "vf_loss": 0.8690110290492022, "vf_explained_var": 0.09318087952477591, "kl": 0.010694520694759587, "entropy": 0.49774498673027784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 363825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.742011404668213, "cur_kl_coeff": 0.051373633410730674, "cur_lr": 0.00010000000000000003, "total_loss": 5.621641958579815, "policy_loss": 0.0022327885280545583, "vf_loss": 5.619017460484984, "vf_explained_var": 0.8363324286761107, "kl": 0.0076250092689226735, "entropy": 0.7809336665446165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 363825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 3088000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": -23.0, "episode_reward_mean": 173.77, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -206.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 75.0}, "policy_reward_mean": {"prey_policy": 79.55, "predator_policy": 7.335}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0, 167.0, 174.0, 371.0, 0.0, 0.0, 390.0, 0.0, 311.0, 188.0, 164.0, 347.0, 180.0, 178.0, 312.0, 138.0, 311.0, 159.0, 196.0, 112.0, 86.0, 285.0, -1.0, 200.0, 0.0, 27.0, 388.0, 0.0, 380.0, 296.0, 0.0, 262.0, 344.0, 370.0, 0.0, 0.0, 196.0, 275.0, 137.0, 102.0, 87.0, 198.0, 341.0, 210.0, 169.0, 185.0, -13.0, 371.0, 155.0, 193.0, 164.0, 196.0, 134.0, 187.0, 77.0, 358.0, 33.0, 225.0, 272.0, 113.0, 324.0, 46.0, 334.0, 19.0, 195.0, 162.0, 130.0, 138.0, 0.0, 99.0, 138.0, 164.0, 198.0, 254.0, 180.0, 178.0, 109.0, 141.0, 200.0, 200.0, 43.0, 170.0, -1.0, 199.0, 365.0, 151.0, 354.0, 198.0, 155.0, 323.0, 379.0, 367.0, 54.0, 172.0, 173.0, 175.0, 180.0, 12.0, -23.0, 31.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -18.0, 161.0, 0.0, 164.0, 0.0, 179.0, 179.0, 0.0, 0.0, 0.0, 0.0, 190.0, 200.0, 0.0, 0.0, 137.0, 161.0, 0.0, 182.0, 146.0, 0.0, 156.0, 176.0, 180.0, 0.0, 167.0, 0.0, 155.0, 137.0, -50.0, 163.0, 182.0, 117.0, 122.0, 0.0, 0.0, 194.0, 0.0, 109.0, 88.0, -18.0, 152.0, 108.0, 0.0, -26.0, 0.0, 200.0, 0.0, 0.0, 0.0, 27.0, 200.0, 182.0, 0.0, 0.0, 179.0, 182.0, 134.0, 134.0, 0.0, 0.0, 73.0, 167.0, 170.0, 152.0, 161.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 194.0, 173.0, 93.0, 0.0, 129.0, 102.0, 0.0, 0.0, 87.0, 197.0, 0.0, 141.0, 200.0, 200.0, 10.0, 0.0, 152.0, 185.0, 0.0, -26.0, 0.0, 167.0, 188.0, -112.0, 177.0, 185.0, 0.0, 162.0, 0.0, 194.0, 0.0, 0.0, 134.0, 182.0, 0.0, -80.0, 117.0, 161.0, 179.0, 0.0, 33.0, 34.0, 171.0, 87.0, 185.0, 113.0, 0.0, 173.0, 142.0, -206.0, 149.0, 140.0, 173.0, 56.0, -74.0, -10.0, 200.0, -10.0, 151.0, 0.0, 130.0, 138.0, 0.0, 0.0, 0.0, 45.0, -8.0, 113.0, 0.0, 164.0, 0.0, 197.0, 0.0, 12.0, 199.0, 0.0, 170.0, 21.0, 140.0, 25.0, 0.0, 107.0, 0.0, 0.0, 200.0, 200.0, 0.0, -21.0, -85.0, 0.0, 155.0, -2.0, 0.0, 199.0, 0.0, 134.0, 197.0, 144.0, 0.0, 173.0, 164.0, 197.0, 0.0, 146.0, -18.0, 171.0, 142.0, 198.0, 176.0, 179.0, 179.0, 54.0, 0.0, -2.0, 158.0, -10.0, 164.0, 0.0, 152.0, 171.0, 0.0, 0.0, 11.0, 0.0, -46.0, 0.0, 31.0], "policy_predator_policy_reward": [0.0, 9.0, 3.0, 3.0, 5.0, 5.0, 5.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 6.0, 0.0, 0.0, 18.0, 0.0, 15.0, 0.0, 0.0, 0.0, 11.0, 0.0, 20.0, 0.0, 25.0, 0.0, 12.0, 19.0, 18.0, 2.0, 0.0, 3.0, 0.0, 8.0, 8.0, 10.0, 15.0, 12.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 9.0, 10.0, 19.0, 9.0, 0.0, 0.0, 11.0, 11.0, 12.0, 10.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 11.0, 0.0, 0.0, 0.0, 13.0, 3.0, 13.0, 35.0, 55.0, 4.0, 4.0, 2.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 5.0, 40.0, 0.0, 17.0, 1.0, 0.0, 0.0, 8.0, 12.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 57.0, 46.0, 21.0, 0.0, 37.0, 0.0, 0.0, 5.0, 5.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0, 35.0, 0.0, 25.0, 0.0, 0.0, 0.0, 1.0, 1.0, 42.0, 5.0, 5.0, 8.0, 9.0, 43.0, 41.0, 20.0, 14.0, 0.0, 0.0, 0.0, 0.0, 75.0, 74.0, 1.0, 14.0, 1.0, 0.0, 0.0, 0.0, 20.0, 14.0, 0.0, 7.0, 12.0, 5.0, 0.0, 1.0, 18.0, 9.0, 6.0, 4.0, 5.0, 0.0, 9.0, 0.0, 0.0, 0.0, 14.0, 2.0, 6.0, 13.0, 14.0, 9.0, 4.0, 5.0, 1.0, 0.0, 0.0, 23.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2729677755919686, "mean_inference_ms": 3.8571417955461698, "mean_action_processing_ms": 0.5443455692889188, "mean_env_wait_ms": 0.4535986591957331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0079498291015625, "StateBufferConnector_ms": 0.007516264915466309, "ViewRequirementAgentConnector_ms": 0.26358699798583984}, "num_episodes": 18, "episode_return_max": 390.0, "episode_return_min": -23.0, "episode_return_mean": 173.77, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 3088000, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 238.7899714171643, "num_env_steps_trained_throughput_per_sec": 238.7899714171643, "timesteps_total": 772000, "num_env_steps_sampled_lifetime": 772000, "num_agent_steps_sampled_lifetime": 3088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3088000, "timers": {"training_iteration_time_ms": 17374.582, "restore_workers_time_ms": 0.053, "training_step_time_ms": 17374.384, "sample_time_ms": 3906.841, "learn_time_ms": 13442.202, "learn_throughput": 297.57, "synch_weights_time_ms": 21.653}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 3088000}, "done": false, "training_iteration": 193, "trial_id": "e1352_00002", "date": "2024-08-13_20-07-27", "timestamp": 1723594047, "time_this_iter_s": 16.8036150932312, "time_total_s": 3928.1814942359924, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2038790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3928.1814942359924, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 86.99583333333334, "ram_util_percent": 83.67916666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6461648219555776, "cur_kl_coeff": 0.00011136217508465055, "cur_lr": 0.00010000000000000003, "total_loss": 0.49992801405923076, "policy_loss": -0.0014342008937130528, "vf_loss": 0.5013605855917804, "vf_explained_var": 0.03473525299597039, "kl": 0.01463187214710203, "entropy": 0.5123643795964579, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 365715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.019127867934564, "cur_kl_coeff": 0.051373633410730674, "cur_lr": 0.00010000000000000003, "total_loss": 5.507308785372941, "policy_loss": 0.00042807032642442553, "vf_loss": 5.506562829648376, "vf_explained_var": 0.8053624570054352, "kl": 0.006187909781849931, "entropy": 0.7785012789504238, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 365715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000}, "env_runners": {"episode_reward_max": 388.0, "episode_reward_min": -23.0, "episode_reward_mean": 171.71, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -206.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 75.0}, "policy_reward_mean": {"prey_policy": 78.66, "predator_policy": 7.195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [196.0, 112.0, 86.0, 285.0, -1.0, 200.0, 0.0, 27.0, 388.0, 0.0, 380.0, 296.0, 0.0, 262.0, 344.0, 370.0, 0.0, 0.0, 196.0, 275.0, 137.0, 102.0, 87.0, 198.0, 341.0, 210.0, 169.0, 185.0, -13.0, 371.0, 155.0, 193.0, 164.0, 196.0, 134.0, 187.0, 77.0, 358.0, 33.0, 225.0, 272.0, 113.0, 324.0, 46.0, 334.0, 19.0, 195.0, 162.0, 130.0, 138.0, 0.0, 99.0, 138.0, 164.0, 198.0, 254.0, 180.0, 178.0, 109.0, 141.0, 200.0, 200.0, 43.0, 170.0, -1.0, 199.0, 365.0, 151.0, 354.0, 198.0, 155.0, 323.0, 379.0, 367.0, 54.0, 172.0, 173.0, 175.0, 180.0, 12.0, -23.0, 31.0, 316.0, 31.0, 293.0, 125.0, 345.0, 122.0, 165.0, 0.0, 182.0, 139.0, 119.0, -5.0, 192.0, 170.0, 86.0, 332.0, 367.0, 196.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 194.0, 0.0, 109.0, 88.0, -18.0, 152.0, 108.0, 0.0, -26.0, 0.0, 200.0, 0.0, 0.0, 0.0, 27.0, 200.0, 182.0, 0.0, 0.0, 179.0, 182.0, 134.0, 134.0, 0.0, 0.0, 73.0, 167.0, 170.0, 152.0, 161.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 194.0, 173.0, 93.0, 0.0, 129.0, 102.0, 0.0, 0.0, 87.0, 197.0, 0.0, 141.0, 200.0, 200.0, 10.0, 0.0, 152.0, 185.0, 0.0, -26.0, 0.0, 167.0, 188.0, -112.0, 177.0, 185.0, 0.0, 162.0, 0.0, 194.0, 0.0, 0.0, 134.0, 182.0, 0.0, -80.0, 117.0, 161.0, 179.0, 0.0, 33.0, 34.0, 171.0, 87.0, 185.0, 113.0, 0.0, 173.0, 142.0, -206.0, 149.0, 140.0, 173.0, 56.0, -74.0, -10.0, 200.0, -10.0, 151.0, 0.0, 130.0, 138.0, 0.0, 0.0, 0.0, 45.0, -8.0, 113.0, 0.0, 164.0, 0.0, 197.0, 0.0, 12.0, 199.0, 0.0, 170.0, 21.0, 140.0, 25.0, 0.0, 107.0, 0.0, 0.0, 200.0, 200.0, 0.0, -21.0, -85.0, 0.0, 155.0, -2.0, 0.0, 199.0, 0.0, 134.0, 197.0, 144.0, 0.0, 173.0, 164.0, 197.0, 0.0, 146.0, -18.0, 171.0, 142.0, 198.0, 176.0, 179.0, 179.0, 54.0, 0.0, -2.0, 158.0, -10.0, 164.0, 0.0, 152.0, 171.0, 0.0, 0.0, 11.0, 0.0, -46.0, 0.0, 31.0, 132.0, 170.0, 0.0, 31.0, 200.0, 93.0, 125.0, 0.0, 167.0, 167.0, 124.0, -4.0, -18.0, 161.0, 0.0, 0.0, 173.0, 0.0, 199.0, -120.0, 119.0, 0.0, -10.0, 0.0, 0.0, 188.0, 0.0, 155.0, 2.0, 77.0, 200.0, 132.0, 200.0, 151.0, 0.0, 194.0], "policy_predator_policy_reward": [2.0, 0.0, 3.0, 0.0, 8.0, 8.0, 10.0, 15.0, 12.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 9.0, 10.0, 19.0, 9.0, 0.0, 0.0, 11.0, 11.0, 12.0, 10.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 11.0, 0.0, 0.0, 0.0, 13.0, 3.0, 13.0, 35.0, 55.0, 4.0, 4.0, 2.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 5.0, 40.0, 0.0, 17.0, 1.0, 0.0, 0.0, 8.0, 12.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 57.0, 46.0, 21.0, 0.0, 37.0, 0.0, 0.0, 5.0, 5.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0, 35.0, 0.0, 25.0, 0.0, 0.0, 0.0, 1.0, 1.0, 42.0, 5.0, 5.0, 8.0, 9.0, 43.0, 41.0, 20.0, 14.0, 0.0, 0.0, 0.0, 0.0, 75.0, 74.0, 1.0, 14.0, 1.0, 0.0, 0.0, 0.0, 20.0, 14.0, 0.0, 7.0, 12.0, 5.0, 0.0, 1.0, 18.0, 9.0, 6.0, 4.0, 5.0, 0.0, 9.0, 0.0, 0.0, 0.0, 14.0, 2.0, 6.0, 13.0, 14.0, 9.0, 4.0, 5.0, 1.0, 0.0, 0.0, 23.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 2.0, 9.0, 13.0, 0.0, 0.0, 0.0, 9.0, 60.0, 0.0, 0.0, 0.0, 5.0, 0.0, 1.0, 3.0, 0.0, 15.0, 7.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2736761184220131, "mean_inference_ms": 3.859685588647144, "mean_action_processing_ms": 0.5444571634805002, "mean_env_wait_ms": 0.4539278597900714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073587894439697266, "StateBufferConnector_ms": 0.007382392883300781, "ViewRequirementAgentConnector_ms": 0.23189246654510498}, "num_episodes": 18, "episode_return_max": 388.0, "episode_return_min": -23.0, "episode_return_mean": 171.71, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 252.5133727491143, "num_env_steps_trained_throughput_per_sec": 252.5133727491143, "timesteps_total": 776000, "num_env_steps_sampled_lifetime": 776000, "num_agent_steps_sampled_lifetime": 3104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3104000, "timers": {"training_iteration_time_ms": 16974.217, "restore_workers_time_ms": 0.02, "training_step_time_ms": 16974.074, "sample_time_ms": 3495.911, "learn_time_ms": 13452.926, "learn_throughput": 297.333, "synch_weights_time_ms": 22.024}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000}, "done": false, "training_iteration": 194, "trial_id": "e1352_00002", "date": "2024-08-13_20-07-43", "timestamp": 1723594063, "time_this_iter_s": 15.908314943313599, "time_total_s": 3944.089809179306, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f8cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3944.089809179306, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 82.99545454545454, "ram_util_percent": 83.50909090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8355509959673757, "cur_kl_coeff": 0.00011136217508465055, "cur_lr": 0.00010000000000000003, "total_loss": 1.0101730558922681, "policy_loss": -0.0022368643888661627, "vf_loss": 1.0124086267260648, "vf_explained_var": -0.012029018351640651, "kl": 0.011618857007795795, "entropy": 0.40493733723642966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 367605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.350053147285704, "cur_kl_coeff": 0.051373633410730674, "cur_lr": 0.00010000000000000003, "total_loss": 5.339458640668758, "policy_loss": 0.0015332888425007541, "vf_loss": 5.337030432463954, "vf_explained_var": 0.6327113438850989, "kl": 0.017419809490466454, "entropy": 0.7857647143343769, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 367605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "env_runners": {"episode_reward_max": 379.0, "episode_reward_min": -41.0, "episode_reward_mean": 164.94, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -302.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 151.0}, "policy_reward_mean": {"prey_policy": 74.78, "predator_policy": 7.69}, "custom_metrics": {}, "hist_stats": {"episode_reward": [196.0, 275.0, 137.0, 102.0, 87.0, 198.0, 341.0, 210.0, 169.0, 185.0, -13.0, 371.0, 155.0, 193.0, 164.0, 196.0, 134.0, 187.0, 77.0, 358.0, 33.0, 225.0, 272.0, 113.0, 324.0, 46.0, 334.0, 19.0, 195.0, 162.0, 130.0, 138.0, 0.0, 99.0, 138.0, 164.0, 198.0, 254.0, 180.0, 178.0, 109.0, 141.0, 200.0, 200.0, 43.0, 170.0, -1.0, 199.0, 365.0, 151.0, 354.0, 198.0, 155.0, 323.0, 379.0, 367.0, 54.0, 172.0, 173.0, 175.0, 180.0, 12.0, -23.0, 31.0, 316.0, 31.0, 293.0, 125.0, 345.0, 122.0, 165.0, 0.0, 182.0, 139.0, 119.0, -5.0, 192.0, 170.0, 86.0, 332.0, 367.0, 196.0, 186.0, 87.0, 198.0, 53.0, 0.0, -24.0, 151.0, -12.0, 312.0, 193.0, 367.0, -2.0, -17.0, -41.0, 198.0, 154.0, 267.0, 198.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 194.0, 173.0, 93.0, 0.0, 129.0, 102.0, 0.0, 0.0, 87.0, 197.0, 0.0, 141.0, 200.0, 200.0, 10.0, 0.0, 152.0, 185.0, 0.0, -26.0, 0.0, 167.0, 188.0, -112.0, 177.0, 185.0, 0.0, 162.0, 0.0, 194.0, 0.0, 0.0, 134.0, 182.0, 0.0, -80.0, 117.0, 161.0, 179.0, 0.0, 33.0, 34.0, 171.0, 87.0, 185.0, 113.0, 0.0, 173.0, 142.0, -206.0, 149.0, 140.0, 173.0, 56.0, -74.0, -10.0, 200.0, -10.0, 151.0, 0.0, 130.0, 138.0, 0.0, 0.0, 0.0, 45.0, -8.0, 113.0, 0.0, 164.0, 0.0, 197.0, 0.0, 12.0, 199.0, 0.0, 170.0, 21.0, 140.0, 25.0, 0.0, 107.0, 0.0, 0.0, 200.0, 200.0, 0.0, -21.0, -85.0, 0.0, 155.0, -2.0, 0.0, 199.0, 0.0, 134.0, 197.0, 144.0, 0.0, 173.0, 164.0, 197.0, 0.0, 146.0, -18.0, 171.0, 142.0, 198.0, 176.0, 179.0, 179.0, 54.0, 0.0, -2.0, 158.0, -10.0, 164.0, 0.0, 152.0, 171.0, 0.0, 0.0, 11.0, 0.0, -46.0, 0.0, 31.0, 132.0, 170.0, 0.0, 31.0, 200.0, 93.0, 125.0, 0.0, 167.0, 167.0, 124.0, -4.0, -18.0, 161.0, 0.0, 0.0, 173.0, 0.0, 199.0, -120.0, 119.0, 0.0, -10.0, 0.0, 0.0, 188.0, 0.0, 155.0, 2.0, 77.0, 200.0, 132.0, 200.0, 151.0, 0.0, 194.0, 54.0, 131.0, 87.0, 0.0, 0.0, 198.0, 53.0, 0.0, 0.0, 0.0, -302.0, 124.0, -16.0, 143.0, -24.0, 0.0, 195.0, 117.0, 192.0, 0.0, 152.0, 197.0, -4.0, 0.0, 0.0, -34.0, -82.0, 0.0, 0.0, 197.0, 0.0, 154.0, 185.0, 71.0, 198.0, 0.0], "policy_predator_policy_reward": [0.0, 2.0, 0.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 11.0, 0.0, 0.0, 0.0, 13.0, 3.0, 13.0, 35.0, 55.0, 4.0, 4.0, 2.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 5.0, 40.0, 0.0, 17.0, 1.0, 0.0, 0.0, 8.0, 12.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 57.0, 46.0, 21.0, 0.0, 37.0, 0.0, 0.0, 5.0, 5.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0, 35.0, 0.0, 25.0, 0.0, 0.0, 0.0, 1.0, 1.0, 42.0, 5.0, 5.0, 8.0, 9.0, 43.0, 41.0, 20.0, 14.0, 0.0, 0.0, 0.0, 0.0, 75.0, 74.0, 1.0, 14.0, 1.0, 0.0, 0.0, 0.0, 20.0, 14.0, 0.0, 7.0, 12.0, 5.0, 0.0, 1.0, 18.0, 9.0, 6.0, 4.0, 5.0, 0.0, 9.0, 0.0, 0.0, 0.0, 14.0, 2.0, 6.0, 13.0, 14.0, 9.0, 4.0, 5.0, 1.0, 0.0, 0.0, 23.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 2.0, 9.0, 13.0, 0.0, 0.0, 0.0, 9.0, 60.0, 0.0, 0.0, 0.0, 5.0, 0.0, 1.0, 3.0, 0.0, 15.0, 7.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 2.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 151.0, 11.0, 13.0, 12.0, 0.0, 0.0, 0.0, 0.0, 1.0, 16.0, 2.0, 0.0, 2.0, 16.0, 1.0, 0.0, 41.0, 1.0, 0.0, 0.0, 0.0, 4.0, 7.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.275336591724333, "mean_inference_ms": 3.8649056351607824, "mean_action_processing_ms": 0.545004243200244, "mean_env_wait_ms": 0.454499512515572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009069204330444336, "StateBufferConnector_ms": 0.010645270347595215, "ViewRequirementAgentConnector_ms": 0.262581467628479}, "num_episodes": 18, "episode_return_max": 379.0, "episode_return_min": -41.0, "episode_return_mean": 164.94, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 196.82957936123483, "num_env_steps_trained_throughput_per_sec": 196.82957936123483, "timesteps_total": 780000, "num_env_steps_sampled_lifetime": 780000, "num_agent_steps_sampled_lifetime": 3120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3120000, "timers": {"training_iteration_time_ms": 17273.908, "restore_workers_time_ms": 0.02, "training_step_time_ms": 17273.767, "sample_time_ms": 3659.542, "learn_time_ms": 13589.696, "learn_throughput": 294.341, "synch_weights_time_ms": 21.419}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "done": false, "training_iteration": 195, "trial_id": "e1352_00002", "date": "2024-08-13_20-08-04", "timestamp": 1723594084, "time_this_iter_s": 20.427248001098633, "time_total_s": 3964.5170571804047, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f8c550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3964.5170571804047, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 87.07931034482759, "ram_util_percent": 83.82758620689654}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1359412722328983, "cur_kl_coeff": 0.00011136217508465055, "cur_lr": 0.00010000000000000003, "total_loss": 1.169110249716138, "policy_loss": -0.002175547443354926, "vf_loss": 1.1712850761003595, "vf_explained_var": -0.0011443375595032222, "kl": 0.006508503318629599, "entropy": 0.3554302910175273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 369495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.417502404299993, "cur_kl_coeff": 0.051373633410730674, "cur_lr": 0.00010000000000000003, "total_loss": 6.062388460219853, "policy_loss": -0.0003349022820306124, "vf_loss": 6.061414128258114, "vf_explained_var": 0.7018486394768669, "kl": 0.02548485220212487, "entropy": 0.7896175147679748, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 369495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000}, "env_runners": {"episode_reward_max": 399.0, "episode_reward_min": -69.0, "episode_reward_mean": 160.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -350.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 175.0}, "policy_reward_mean": {"prey_policy": 71.835, "predator_policy": 8.585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.0, 195.0, 162.0, 130.0, 138.0, 0.0, 99.0, 138.0, 164.0, 198.0, 254.0, 180.0, 178.0, 109.0, 141.0, 200.0, 200.0, 43.0, 170.0, -1.0, 199.0, 365.0, 151.0, 354.0, 198.0, 155.0, 323.0, 379.0, 367.0, 54.0, 172.0, 173.0, 175.0, 180.0, 12.0, -23.0, 31.0, 316.0, 31.0, 293.0, 125.0, 345.0, 122.0, 165.0, 0.0, 182.0, 139.0, 119.0, -5.0, 192.0, 170.0, 86.0, 332.0, 367.0, 196.0, 186.0, 87.0, 198.0, 53.0, 0.0, -24.0, 151.0, -12.0, 312.0, 193.0, 367.0, -2.0, -17.0, -41.0, 198.0, 154.0, 267.0, 198.0, 187.0, 150.0, 178.0, -69.0, 94.0, 317.0, 299.0, 336.0, 35.0, 75.0, 200.0, 179.0, 312.0, 99.0, 172.0, 200.0, 49.0, 388.0, 11.0, 119.0, 188.0, 399.0, 0.0, 357.0, 21.0, 178.0, 185.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [56.0, -74.0, -10.0, 200.0, -10.0, 151.0, 0.0, 130.0, 138.0, 0.0, 0.0, 0.0, 45.0, -8.0, 113.0, 0.0, 164.0, 0.0, 197.0, 0.0, 12.0, 199.0, 0.0, 170.0, 21.0, 140.0, 25.0, 0.0, 107.0, 0.0, 0.0, 200.0, 200.0, 0.0, -21.0, -85.0, 0.0, 155.0, -2.0, 0.0, 199.0, 0.0, 134.0, 197.0, 144.0, 0.0, 173.0, 164.0, 197.0, 0.0, 146.0, -18.0, 171.0, 142.0, 198.0, 176.0, 179.0, 179.0, 54.0, 0.0, -2.0, 158.0, -10.0, 164.0, 0.0, 152.0, 171.0, 0.0, 0.0, 11.0, 0.0, -46.0, 0.0, 31.0, 132.0, 170.0, 0.0, 31.0, 200.0, 93.0, 125.0, 0.0, 167.0, 167.0, 124.0, -4.0, -18.0, 161.0, 0.0, 0.0, 173.0, 0.0, 199.0, -120.0, 119.0, 0.0, -10.0, 0.0, 0.0, 188.0, 0.0, 155.0, 2.0, 77.0, 200.0, 132.0, 200.0, 151.0, 0.0, 194.0, 54.0, 131.0, 87.0, 0.0, 0.0, 198.0, 53.0, 0.0, 0.0, 0.0, -302.0, 124.0, -16.0, 143.0, -24.0, 0.0, 195.0, 117.0, 192.0, 0.0, 152.0, 197.0, -4.0, 0.0, 0.0, -34.0, -82.0, 0.0, 0.0, 197.0, 0.0, 154.0, 185.0, 71.0, 198.0, 0.0, 0.0, 173.0, 59.0, 45.0, 170.0, 0.0, -112.0, -26.0, 0.0, 82.0, 166.0, 151.0, 102.0, 196.0, 107.0, 197.0, 33.0, 0.0, 0.0, 75.0, -3.0, 200.0, 99.0, 60.0, 88.0, 188.0, -138.0, 167.0, 0.0, 137.0, 200.0, 0.0, 0.0, 41.0, 200.0, 182.0, 11.0, 0.0, 0.0, 119.0, 175.0, 0.0, 199.0, 200.0, 0.0, 0.0, 180.0, 168.0, -350.0, 196.0, 177.0, 0.0, -4.0, 186.0], "policy_predator_policy_reward": [37.0, 0.0, 0.0, 5.0, 5.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0, 35.0, 0.0, 25.0, 0.0, 0.0, 0.0, 1.0, 1.0, 42.0, 5.0, 5.0, 8.0, 9.0, 43.0, 41.0, 20.0, 14.0, 0.0, 0.0, 0.0, 0.0, 75.0, 74.0, 1.0, 14.0, 1.0, 0.0, 0.0, 0.0, 20.0, 14.0, 0.0, 7.0, 12.0, 5.0, 0.0, 1.0, 18.0, 9.0, 6.0, 4.0, 5.0, 0.0, 9.0, 0.0, 0.0, 0.0, 14.0, 2.0, 6.0, 13.0, 14.0, 9.0, 4.0, 5.0, 1.0, 0.0, 0.0, 23.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 2.0, 9.0, 13.0, 0.0, 0.0, 0.0, 9.0, 60.0, 0.0, 0.0, 0.0, 5.0, 0.0, 1.0, 3.0, 0.0, 15.0, 7.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 2.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 151.0, 11.0, 13.0, 12.0, 0.0, 0.0, 0.0, 0.0, 1.0, 16.0, 2.0, 0.0, 2.0, 16.0, 1.0, 0.0, 41.0, 1.0, 0.0, 0.0, 0.0, 4.0, 7.0, 0.0, 0.0, 7.0, 7.0, 28.0, 18.0, 8.0, 0.0, 0.0, 69.0, 7.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 32.0, 2.0, 0.0, 0.0, 0.0, 0.0, 3.0, 20.0, 0.0, 0.0, 36.0, 1.0, 69.0, 15.0, 20.0, 0.0, 0.0, 5.0, 3.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 175.0, 1.0, 0.0, 2.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2775358412069593, "mean_inference_ms": 3.872186984410596, "mean_action_processing_ms": 0.5455132117283089, "mean_env_wait_ms": 0.4551823129107276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0100020170211792, "StateBufferConnector_ms": 0.007945895195007324, "ViewRequirementAgentConnector_ms": 0.29925453662872314}, "num_episodes": 27, "episode_return_max": 399.0, "episode_return_min": -69.0, "episode_return_mean": 160.84, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 180.44425476847678, "num_env_steps_trained_throughput_per_sec": 180.44425476847678, "timesteps_total": 784000, "num_env_steps_sampled_lifetime": 784000, "num_agent_steps_sampled_lifetime": 3136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3136000, "timers": {"training_iteration_time_ms": 17783.508, "restore_workers_time_ms": 0.016, "training_step_time_ms": 17783.383, "sample_time_ms": 3711.396, "learn_time_ms": 14046.375, "learn_throughput": 284.771, "synch_weights_time_ms": 22.881}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000}, "done": false, "training_iteration": 196, "trial_id": "e1352_00002", "date": "2024-08-13_20-08-26", "timestamp": 1723594106, "time_this_iter_s": 22.329617023468018, "time_total_s": 3986.8466742038727, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2ff15e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3986.8466742038727, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 93.80645161290323, "ram_util_percent": 83.79354838709678}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.384878079348771, "cur_kl_coeff": 0.00011136217508465055, "cur_lr": 0.00010000000000000003, "total_loss": 1.2796182108303857, "policy_loss": -0.001254679050257124, "vf_loss": 1.280872054074807, "vf_explained_var": 0.005189909159191071, "kl": 0.007496291228200414, "entropy": 0.31697334380692277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 371385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.865789360501779, "cur_kl_coeff": 0.07706045011609605, "cur_lr": 0.00010000000000000003, "total_loss": 5.5655071006250125, "policy_loss": -0.0009046571166624152, "vf_loss": 5.5655877453940255, "vf_explained_var": 0.5690636678347512, "kl": 0.010693073335907742, "entropy": 0.8904870297542955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 371385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 3152000}, "env_runners": {"episode_reward_max": 399.0, "episode_reward_min": -69.0, "episode_reward_mean": 157.02, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -350.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 175.0}, "policy_reward_mean": {"prey_policy": 70.2, "predator_policy": 8.31}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.0, -1.0, 199.0, 365.0, 151.0, 354.0, 198.0, 155.0, 323.0, 379.0, 367.0, 54.0, 172.0, 173.0, 175.0, 180.0, 12.0, -23.0, 31.0, 316.0, 31.0, 293.0, 125.0, 345.0, 122.0, 165.0, 0.0, 182.0, 139.0, 119.0, -5.0, 192.0, 170.0, 86.0, 332.0, 367.0, 196.0, 186.0, 87.0, 198.0, 53.0, 0.0, -24.0, 151.0, -12.0, 312.0, 193.0, 367.0, -2.0, -17.0, -41.0, 198.0, 154.0, 267.0, 198.0, 187.0, 150.0, 178.0, -69.0, 94.0, 317.0, 299.0, 336.0, 35.0, 75.0, 200.0, 179.0, 312.0, 99.0, 172.0, 200.0, 49.0, 388.0, 11.0, 119.0, 188.0, 399.0, 0.0, 357.0, 21.0, 178.0, 185.0, 306.0, 0.0, 176.0, 0.0, 127.0, 289.0, 31.0, 88.0, 0.0, 183.0, 14.0, 178.0, 111.0, 106.0, 173.0, 83.0, 170.0, 131.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 155.0, -2.0, 0.0, 199.0, 0.0, 134.0, 197.0, 144.0, 0.0, 173.0, 164.0, 197.0, 0.0, 146.0, -18.0, 171.0, 142.0, 198.0, 176.0, 179.0, 179.0, 54.0, 0.0, -2.0, 158.0, -10.0, 164.0, 0.0, 152.0, 171.0, 0.0, 0.0, 11.0, 0.0, -46.0, 0.0, 31.0, 132.0, 170.0, 0.0, 31.0, 200.0, 93.0, 125.0, 0.0, 167.0, 167.0, 124.0, -4.0, -18.0, 161.0, 0.0, 0.0, 173.0, 0.0, 199.0, -120.0, 119.0, 0.0, -10.0, 0.0, 0.0, 188.0, 0.0, 155.0, 2.0, 77.0, 200.0, 132.0, 200.0, 151.0, 0.0, 194.0, 54.0, 131.0, 87.0, 0.0, 0.0, 198.0, 53.0, 0.0, 0.0, 0.0, -302.0, 124.0, -16.0, 143.0, -24.0, 0.0, 195.0, 117.0, 192.0, 0.0, 152.0, 197.0, -4.0, 0.0, 0.0, -34.0, -82.0, 0.0, 0.0, 197.0, 0.0, 154.0, 185.0, 71.0, 198.0, 0.0, 0.0, 173.0, 59.0, 45.0, 170.0, 0.0, -112.0, -26.0, 0.0, 82.0, 166.0, 151.0, 102.0, 196.0, 107.0, 197.0, 33.0, 0.0, 0.0, 75.0, -3.0, 200.0, 99.0, 60.0, 88.0, 188.0, -138.0, 167.0, 0.0, 137.0, 200.0, 0.0, 0.0, 41.0, 200.0, 182.0, 11.0, 0.0, 0.0, 119.0, 175.0, 0.0, 199.0, 200.0, 0.0, 0.0, 180.0, 168.0, -350.0, 196.0, 177.0, 0.0, -4.0, 186.0, 116.0, 153.0, 0.0, 0.0, -48.0, 200.0, 0.0, 0.0, 112.0, 0.0, 169.0, 106.0, 185.0, -318.0, 1.0, 84.0, 0.0, 0.0, 113.0, 66.0, 0.0, 14.0, 0.0, 173.0, 25.0, 15.0, 77.0, 0.0, 78.0, 68.0, 24.0, 35.0, 156.0, 0.0, 133.0, -4.0], "policy_predator_policy_reward": [1.0, 14.0, 1.0, 0.0, 0.0, 0.0, 20.0, 14.0, 0.0, 7.0, 12.0, 5.0, 0.0, 1.0, 18.0, 9.0, 6.0, 4.0, 5.0, 0.0, 9.0, 0.0, 0.0, 0.0, 14.0, 2.0, 6.0, 13.0, 14.0, 9.0, 4.0, 5.0, 1.0, 0.0, 0.0, 23.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 2.0, 9.0, 13.0, 0.0, 0.0, 0.0, 9.0, 60.0, 0.0, 0.0, 0.0, 5.0, 0.0, 1.0, 3.0, 0.0, 15.0, 7.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 2.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 151.0, 11.0, 13.0, 12.0, 0.0, 0.0, 0.0, 0.0, 1.0, 16.0, 2.0, 0.0, 2.0, 16.0, 1.0, 0.0, 41.0, 1.0, 0.0, 0.0, 0.0, 4.0, 7.0, 0.0, 0.0, 7.0, 7.0, 28.0, 18.0, 8.0, 0.0, 0.0, 69.0, 7.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 32.0, 2.0, 0.0, 0.0, 0.0, 0.0, 3.0, 20.0, 0.0, 0.0, 36.0, 1.0, 69.0, 15.0, 20.0, 0.0, 0.0, 5.0, 3.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 175.0, 1.0, 0.0, 2.0, 1.0, 26.0, 11.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 8.0, 7.0, 5.0, 9.0, 5.0, 159.0, 2.0, 1.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 4.0, 1.0, 34.0, 37.0, 29.0, 0.0, 24.0, 3.0, 12.0, 12.0, 0.0, 14.0, 0.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.279829297334162, "mean_inference_ms": 3.8792760161661124, "mean_action_processing_ms": 0.5467365816556116, "mean_env_wait_ms": 0.4559536894115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009864211082458496, "StateBufferConnector_ms": 0.008299946784973145, "ViewRequirementAgentConnector_ms": 0.3323037624359131}, "num_episodes": 18, "episode_return_max": 399.0, "episode_return_min": -69.0, "episode_return_mean": 157.02, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 3152000, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.79720872890798, "num_env_steps_trained_throughput_per_sec": 216.79720872890798, "timesteps_total": 788000, "num_env_steps_sampled_lifetime": 788000, "num_agent_steps_sampled_lifetime": 3152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3152000, "timers": {"training_iteration_time_ms": 17899.258, "restore_workers_time_ms": 0.016, "training_step_time_ms": 17899.132, "sample_time_ms": 3827.232, "learn_time_ms": 14046.499, "learn_throughput": 284.768, "synch_weights_time_ms": 22.74}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 3152000}, "done": false, "training_iteration": 197, "trial_id": "e1352_00002", "date": "2024-08-13_20-08-45", "timestamp": 1723594125, "time_this_iter_s": 18.512348890304565, "time_total_s": 4005.3590230941772, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af096a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4005.3590230941772, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 92.80000000000001, "ram_util_percent": 84.16923076923078}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.676267761504524, "cur_kl_coeff": 0.00011136217508465055, "cur_lr": 0.00010000000000000003, "total_loss": 0.7432445190097919, "policy_loss": -0.0013661984502086563, "vf_loss": 0.7446101688991779, "vf_explained_var": 0.036590802007251316, "kl": 0.004899656224391823, "entropy": 0.4208002256968665, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 373275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.561773005080601, "cur_kl_coeff": 0.07706045011609605, "cur_lr": 0.00010000000000000003, "total_loss": 5.1424250548478785, "policy_loss": -0.0008444720759702029, "vf_loss": 5.142043359948214, "vf_explained_var": 0.7459109313904293, "kl": 0.01591171287534882, "entropy": 0.9058781747780149, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 373275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000}, "env_runners": {"episode_reward_max": 399.0, "episode_reward_min": -115.0, "episode_reward_mean": 141.3, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -350.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 175.0}, "policy_reward_mean": {"prey_policy": 62.05, "predator_policy": 8.6}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.0, 316.0, 31.0, 293.0, 125.0, 345.0, 122.0, 165.0, 0.0, 182.0, 139.0, 119.0, -5.0, 192.0, 170.0, 86.0, 332.0, 367.0, 196.0, 186.0, 87.0, 198.0, 53.0, 0.0, -24.0, 151.0, -12.0, 312.0, 193.0, 367.0, -2.0, -17.0, -41.0, 198.0, 154.0, 267.0, 198.0, 187.0, 150.0, 178.0, -69.0, 94.0, 317.0, 299.0, 336.0, 35.0, 75.0, 200.0, 179.0, 312.0, 99.0, 172.0, 200.0, 49.0, 388.0, 11.0, 119.0, 188.0, 399.0, 0.0, 357.0, 21.0, 178.0, 185.0, 306.0, 0.0, 176.0, 0.0, 127.0, 289.0, 31.0, 88.0, 0.0, 183.0, 14.0, 178.0, 111.0, 106.0, 173.0, 83.0, 170.0, 131.0, 158.0, 108.0, 375.0, 105.0, 72.0, 143.0, 0.0, 171.0, 77.0, 127.0, 36.0, -115.0, 21.0, -10.0, 359.0, 82.0, -47.0, 169.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 31.0, 132.0, 170.0, 0.0, 31.0, 200.0, 93.0, 125.0, 0.0, 167.0, 167.0, 124.0, -4.0, -18.0, 161.0, 0.0, 0.0, 173.0, 0.0, 199.0, -120.0, 119.0, 0.0, -10.0, 0.0, 0.0, 188.0, 0.0, 155.0, 2.0, 77.0, 200.0, 132.0, 200.0, 151.0, 0.0, 194.0, 54.0, 131.0, 87.0, 0.0, 0.0, 198.0, 53.0, 0.0, 0.0, 0.0, -302.0, 124.0, -16.0, 143.0, -24.0, 0.0, 195.0, 117.0, 192.0, 0.0, 152.0, 197.0, -4.0, 0.0, 0.0, -34.0, -82.0, 0.0, 0.0, 197.0, 0.0, 154.0, 185.0, 71.0, 198.0, 0.0, 0.0, 173.0, 59.0, 45.0, 170.0, 0.0, -112.0, -26.0, 0.0, 82.0, 166.0, 151.0, 102.0, 196.0, 107.0, 197.0, 33.0, 0.0, 0.0, 75.0, -3.0, 200.0, 99.0, 60.0, 88.0, 188.0, -138.0, 167.0, 0.0, 137.0, 200.0, 0.0, 0.0, 41.0, 200.0, 182.0, 11.0, 0.0, 0.0, 119.0, 175.0, 0.0, 199.0, 200.0, 0.0, 0.0, 180.0, 168.0, -350.0, 196.0, 177.0, 0.0, -4.0, 186.0, 116.0, 153.0, 0.0, 0.0, -48.0, 200.0, 0.0, 0.0, 112.0, 0.0, 169.0, 106.0, 185.0, -318.0, 1.0, 84.0, 0.0, 0.0, 113.0, 66.0, 0.0, 14.0, 0.0, 173.0, 25.0, 15.0, 77.0, 0.0, 78.0, 68.0, 24.0, 35.0, 156.0, 0.0, 133.0, -4.0, 158.0, 0.0, 0.0, 108.0, 190.0, 185.0, -10.0, 88.0, -16.0, 80.0, 128.0, -4.0, 0.0, 0.0, 24.0, 119.0, -4.0, 79.0, 8.0, 74.0, 31.0, 0.0, -76.0, -84.0, 21.0, 0.0, -20.0, 0.0, 195.0, 164.0, 79.0, 0.0, 2.0, -128.0, 165.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 2.0, 9.0, 13.0, 0.0, 0.0, 0.0, 9.0, 60.0, 0.0, 0.0, 0.0, 5.0, 0.0, 1.0, 3.0, 0.0, 15.0, 7.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 2.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 151.0, 11.0, 13.0, 12.0, 0.0, 0.0, 0.0, 0.0, 1.0, 16.0, 2.0, 0.0, 2.0, 16.0, 1.0, 0.0, 41.0, 1.0, 0.0, 0.0, 0.0, 4.0, 7.0, 0.0, 0.0, 7.0, 7.0, 28.0, 18.0, 8.0, 0.0, 0.0, 69.0, 7.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 32.0, 2.0, 0.0, 0.0, 0.0, 0.0, 3.0, 20.0, 0.0, 0.0, 36.0, 1.0, 69.0, 15.0, 20.0, 0.0, 0.0, 5.0, 3.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 175.0, 1.0, 0.0, 2.0, 1.0, 26.0, 11.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 8.0, 7.0, 5.0, 9.0, 5.0, 159.0, 2.0, 1.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 4.0, 1.0, 34.0, 37.0, 29.0, 0.0, 24.0, 3.0, 12.0, 12.0, 0.0, 14.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 22.0, 8.0, 0.0, 11.0, 8.0, 0.0, 0.0, 27.0, 1.0, 0.0, 2.0, 25.0, 20.0, 3.0, 2.0, 45.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 3.0, 0.0, 0.0, 79.0, 4.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2814846341103356, "mean_inference_ms": 3.8849103559408724, "mean_action_processing_ms": 0.5474717981562506, "mean_env_wait_ms": 0.45661982373860277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009076714515686035, "StateBufferConnector_ms": 0.008326172828674316, "ViewRequirementAgentConnector_ms": 0.34103870391845703}, "num_episodes": 18, "episode_return_max": 399.0, "episode_return_min": -115.0, "episode_return_mean": 141.3, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.53181230910883, "num_env_steps_trained_throughput_per_sec": 259.53181230910883, "timesteps_total": 792000, "num_env_steps_sampled_lifetime": 792000, "num_agent_steps_sampled_lifetime": 3168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3168000, "timers": {"training_iteration_time_ms": 17476.699, "restore_workers_time_ms": 0.015, "training_step_time_ms": 17476.591, "sample_time_ms": 3549.156, "learn_time_ms": 13900.734, "learn_throughput": 287.755, "synch_weights_time_ms": 23.771}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000}, "done": false, "training_iteration": 198, "trial_id": "e1352_00002", "date": "2024-08-13_20-09-00", "timestamp": 1723594140, "time_this_iter_s": 15.486042261123657, "time_total_s": 4020.845065355301, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b30233a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4020.845065355301, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 85.05000000000001, "ram_util_percent": 83.82727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6690256941886177, "cur_kl_coeff": 5.5681087542325275e-05, "cur_lr": 0.00010000000000000003, "total_loss": 1.432460833068878, "policy_loss": -0.004136355841906849, "vf_loss": 1.4365967162071713, "vf_explained_var": 0.022905223489438416, "kl": 0.00849637476813883, "entropy": 0.37616818165652965, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 375165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.961625026931207, "cur_kl_coeff": 0.07706045011609605, "cur_lr": 0.00010000000000000003, "total_loss": 5.0825310577160465, "policy_loss": 0.005712397459268609, "vf_loss": 5.075434705441591, "vf_explained_var": 0.627449564612101, "kl": 0.017959485234986968, "entropy": 0.8917708660559679, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 375165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 3184000}, "env_runners": {"episode_reward_max": 399.0, "episode_reward_min": -115.0, "episode_reward_mean": 141.08, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -350.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 175.0}, "policy_reward_mean": {"prey_policy": 61.03, "predator_policy": 9.51}, "custom_metrics": {}, "hist_stats": {"episode_reward": [196.0, 186.0, 87.0, 198.0, 53.0, 0.0, -24.0, 151.0, -12.0, 312.0, 193.0, 367.0, -2.0, -17.0, -41.0, 198.0, 154.0, 267.0, 198.0, 187.0, 150.0, 178.0, -69.0, 94.0, 317.0, 299.0, 336.0, 35.0, 75.0, 200.0, 179.0, 312.0, 99.0, 172.0, 200.0, 49.0, 388.0, 11.0, 119.0, 188.0, 399.0, 0.0, 357.0, 21.0, 178.0, 185.0, 306.0, 0.0, 176.0, 0.0, 127.0, 289.0, 31.0, 88.0, 0.0, 183.0, 14.0, 178.0, 111.0, 106.0, 173.0, 83.0, 170.0, 131.0, 158.0, 108.0, 375.0, 105.0, 72.0, 143.0, 0.0, 171.0, 77.0, 127.0, 36.0, -115.0, 21.0, -10.0, 359.0, 82.0, -47.0, 169.0, 205.0, 173.0, 187.0, 136.0, 80.0, 5.0, 397.0, 101.0, 196.0, 186.0, 394.0, 0.0, 171.0, 0.0, 192.0, -29.0, 302.0, 292.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 194.0, 54.0, 131.0, 87.0, 0.0, 0.0, 198.0, 53.0, 0.0, 0.0, 0.0, -302.0, 124.0, -16.0, 143.0, -24.0, 0.0, 195.0, 117.0, 192.0, 0.0, 152.0, 197.0, -4.0, 0.0, 0.0, -34.0, -82.0, 0.0, 0.0, 197.0, 0.0, 154.0, 185.0, 71.0, 198.0, 0.0, 0.0, 173.0, 59.0, 45.0, 170.0, 0.0, -112.0, -26.0, 0.0, 82.0, 166.0, 151.0, 102.0, 196.0, 107.0, 197.0, 33.0, 0.0, 0.0, 75.0, -3.0, 200.0, 99.0, 60.0, 88.0, 188.0, -138.0, 167.0, 0.0, 137.0, 200.0, 0.0, 0.0, 41.0, 200.0, 182.0, 11.0, 0.0, 0.0, 119.0, 175.0, 0.0, 199.0, 200.0, 0.0, 0.0, 180.0, 168.0, -350.0, 196.0, 177.0, 0.0, -4.0, 186.0, 116.0, 153.0, 0.0, 0.0, -48.0, 200.0, 0.0, 0.0, 112.0, 0.0, 169.0, 106.0, 185.0, -318.0, 1.0, 84.0, 0.0, 0.0, 113.0, 66.0, 0.0, 14.0, 0.0, 173.0, 25.0, 15.0, 77.0, 0.0, 78.0, 68.0, 24.0, 35.0, 156.0, 0.0, 133.0, -4.0, 158.0, 0.0, 0.0, 108.0, 190.0, 185.0, -10.0, 88.0, -16.0, 80.0, 128.0, -4.0, 0.0, 0.0, 24.0, 119.0, -4.0, 79.0, 8.0, 74.0, 31.0, 0.0, -76.0, -84.0, 21.0, 0.0, -20.0, 0.0, 195.0, 164.0, 79.0, 0.0, 2.0, -128.0, 165.0, 0.0, 50.0, 146.0, 173.0, 0.0, 187.0, 0.0, 0.0, 136.0, -42.0, 87.0, 111.0, -258.0, 200.0, 197.0, 88.0, 0.0, -4.0, 198.0, -4.0, 186.0, 192.0, 200.0, 0.0, 0.0, 0.0, 171.0, 0.0, 0.0, 0.0, 189.0, -111.0, -16.0, 169.0, 133.0, 108.0, 155.0], "policy_predator_policy_reward": [0.0, 2.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 151.0, 11.0, 13.0, 12.0, 0.0, 0.0, 0.0, 0.0, 1.0, 16.0, 2.0, 0.0, 2.0, 16.0, 1.0, 0.0, 41.0, 1.0, 0.0, 0.0, 0.0, 4.0, 7.0, 0.0, 0.0, 7.0, 7.0, 28.0, 18.0, 8.0, 0.0, 0.0, 69.0, 7.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 32.0, 2.0, 0.0, 0.0, 0.0, 0.0, 3.0, 20.0, 0.0, 0.0, 36.0, 1.0, 69.0, 15.0, 20.0, 0.0, 0.0, 5.0, 3.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 175.0, 1.0, 0.0, 2.0, 1.0, 26.0, 11.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 8.0, 7.0, 5.0, 9.0, 5.0, 159.0, 2.0, 1.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 4.0, 1.0, 34.0, 37.0, 29.0, 0.0, 24.0, 3.0, 12.0, 12.0, 0.0, 14.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 22.0, 8.0, 0.0, 11.0, 8.0, 0.0, 0.0, 27.0, 1.0, 0.0, 2.0, 25.0, 20.0, 3.0, 2.0, 45.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 3.0, 0.0, 0.0, 79.0, 4.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35.0, 23.0, 129.0, 0.0, 0.0, 3.0, 10.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 8.0, 90.0, 0.0, 0.0, 4.0, 25.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2827208513453814, "mean_inference_ms": 3.8904677206993425, "mean_action_processing_ms": 0.5481610326887546, "mean_env_wait_ms": 0.45728231074507464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0091780424118042, "StateBufferConnector_ms": 0.008407831192016602, "ViewRequirementAgentConnector_ms": 0.34441637992858887}, "num_episodes": 18, "episode_return_max": 399.0, "episode_return_min": -115.0, "episode_return_mean": 141.08, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 3184000, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 239.70607672727422, "num_env_steps_trained_throughput_per_sec": 239.70607672727422, "timesteps_total": 796000, "num_env_steps_sampled_lifetime": 796000, "num_agent_steps_sampled_lifetime": 3184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3184000, "timers": {"training_iteration_time_ms": 17554.508, "restore_workers_time_ms": 0.015, "training_step_time_ms": 17554.451, "sample_time_ms": 3522.064, "learn_time_ms": 14005.416, "learn_throughput": 285.604, "synch_weights_time_ms": 24.104}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 3184000}, "done": false, "training_iteration": 199, "trial_id": "e1352_00002", "date": "2024-08-13_20-09-17", "timestamp": 1723594157, "time_this_iter_s": 16.79081892967224, "time_total_s": 4037.635884284973, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2ff1f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4037.635884284973, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 85.0125, "ram_util_percent": 83.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5415574580430986, "cur_kl_coeff": 5.5681087542325275e-05, "cur_lr": 0.00010000000000000003, "total_loss": 0.6454360470569954, "policy_loss": -0.0026536255821132315, "vf_loss": 0.6480893515641727, "vf_explained_var": 0.03851209355409814, "kl": 0.005759544150113129, "entropy": 0.3237550441313673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 377055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.720871636381856, "cur_kl_coeff": 0.07706045011609605, "cur_lr": 0.00010000000000000003, "total_loss": 5.2372955960571455, "policy_loss": -0.0007528547315843522, "vf_loss": 5.2369663937381965, "vf_explained_var": 0.4783118236632574, "kl": 0.014041627882736508, "entropy": 0.891598661740621, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 377055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "env_runners": {"episode_reward_max": 399.0, "episode_reward_min": -115.0, "episode_reward_mean": 142.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -350.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 175.0}, "policy_reward_mean": {"prey_policy": 61.71, "predator_policy": 9.47}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 75.0, 200.0, 179.0, 312.0, 99.0, 172.0, 200.0, 49.0, 388.0, 11.0, 119.0, 188.0, 399.0, 0.0, 357.0, 21.0, 178.0, 185.0, 306.0, 0.0, 176.0, 0.0, 127.0, 289.0, 31.0, 88.0, 0.0, 183.0, 14.0, 178.0, 111.0, 106.0, 173.0, 83.0, 170.0, 131.0, 158.0, 108.0, 375.0, 105.0, 72.0, 143.0, 0.0, 171.0, 77.0, 127.0, 36.0, -115.0, 21.0, -10.0, 359.0, 82.0, -47.0, 169.0, 205.0, 173.0, 187.0, 136.0, 80.0, 5.0, 397.0, 101.0, 196.0, 186.0, 394.0, 0.0, 171.0, 0.0, 192.0, -29.0, 302.0, 292.0, 105.0, 297.0, 147.0, 133.0, 336.0, -1.0, 220.0, 136.0, 121.0, -5.0, 333.0, -3.0, 262.0, -2.0, 368.0, 148.0, 149.0, 214.0, -11.0, 224.0, 0.0, 126.0, 183.0, 82.0, 182.0, 49.0, 291.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [33.0, 0.0, 0.0, 75.0, -3.0, 200.0, 99.0, 60.0, 88.0, 188.0, -138.0, 167.0, 0.0, 137.0, 200.0, 0.0, 0.0, 41.0, 200.0, 182.0, 11.0, 0.0, 0.0, 119.0, 175.0, 0.0, 199.0, 200.0, 0.0, 0.0, 180.0, 168.0, -350.0, 196.0, 177.0, 0.0, -4.0, 186.0, 116.0, 153.0, 0.0, 0.0, -48.0, 200.0, 0.0, 0.0, 112.0, 0.0, 169.0, 106.0, 185.0, -318.0, 1.0, 84.0, 0.0, 0.0, 113.0, 66.0, 0.0, 14.0, 0.0, 173.0, 25.0, 15.0, 77.0, 0.0, 78.0, 68.0, 24.0, 35.0, 156.0, 0.0, 133.0, -4.0, 158.0, 0.0, 0.0, 108.0, 190.0, 185.0, -10.0, 88.0, -16.0, 80.0, 128.0, -4.0, 0.0, 0.0, 24.0, 119.0, -4.0, 79.0, 8.0, 74.0, 31.0, 0.0, -76.0, -84.0, 21.0, 0.0, -20.0, 0.0, 195.0, 164.0, 79.0, 0.0, 2.0, -128.0, 165.0, 0.0, 50.0, 146.0, 173.0, 0.0, 187.0, 0.0, 0.0, 136.0, -42.0, 87.0, 111.0, -258.0, 200.0, 197.0, 88.0, 0.0, -4.0, 198.0, -4.0, 186.0, 192.0, 200.0, 0.0, 0.0, 0.0, 171.0, 0.0, 0.0, 0.0, 189.0, -111.0, -16.0, 169.0, 133.0, 108.0, 155.0, 101.0, 0.0, 165.0, 125.0, -12.0, 150.0, 67.0, 17.0, 198.0, 103.0, 0.0, -6.0, 90.0, 92.0, -4.0, 130.0, 0.0, 121.0, -30.0, 0.0, 133.0, 194.0, -6.0, 0.0, 148.0, 91.0, -4.0, 0.0, 170.0, 188.0, 96.0, 0.0, 0.0, 139.0, 33.0, 129.0, -22.0, 0.0, 18.0, 190.0, 0.0, 0.0, 120.0, -18.0, 46.0, 97.0, 81.0, 0.0, 161.0, 3.0, 41.0, 0.0, 170.0, 121.0], "policy_predator_policy_reward": [2.0, 0.0, 0.0, 0.0, 0.0, 3.0, 20.0, 0.0, 0.0, 36.0, 1.0, 69.0, 15.0, 20.0, 0.0, 0.0, 5.0, 3.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 175.0, 1.0, 0.0, 2.0, 1.0, 26.0, 11.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 8.0, 7.0, 5.0, 9.0, 5.0, 159.0, 2.0, 1.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 4.0, 1.0, 34.0, 37.0, 29.0, 0.0, 24.0, 3.0, 12.0, 12.0, 0.0, 14.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 22.0, 8.0, 0.0, 11.0, 8.0, 0.0, 0.0, 27.0, 1.0, 0.0, 2.0, 25.0, 20.0, 3.0, 2.0, 45.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 3.0, 0.0, 0.0, 79.0, 4.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35.0, 23.0, 129.0, 0.0, 0.0, 3.0, 10.0, 2.0, 0.0, 2.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 8.0, 90.0, 0.0, 0.0, 4.0, 25.0, 0.0, 4.0, 6.0, 1.0, 3.0, 6.0, 49.0, 0.0, 22.0, 13.0, 3.0, 2.0, 32.0, 6.0, 10.0, 0.0, 0.0, 0.0, 13.0, 12.0, 1.0, 5.0, 3.0, 0.0, 11.0, 12.0, 2.0, 0.0, 10.0, 0.0, 26.0, 26.0, 7.0, 3.0, 0.0, 52.0, 0.0, 11.0, 0.0, 16.0, 0.0, 0.0, 13.0, 11.0, 26.0, 14.0, 1.0, 0.0, 13.0, 5.0, 4.0, 4.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2810126783116242, "mean_inference_ms": 3.8959108829417968, "mean_action_processing_ms": 0.5481986631532942, "mean_env_wait_ms": 0.4583685560903888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00650179386138916, "StateBufferConnector_ms": 0.0046234130859375, "ViewRequirementAgentConnector_ms": 0.2756326198577881}, "num_episodes": 27, "episode_return_max": 399.0, "episode_return_min": -115.0, "episode_return_mean": 142.36, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 250.84134755912547, "num_env_steps_trained_throughput_per_sec": 250.84134755912547, "timesteps_total": 800000, "num_env_steps_sampled_lifetime": 800000, "num_agent_steps_sampled_lifetime": 3200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3200000, "timers": {"training_iteration_time_ms": 17516.186, "restore_workers_time_ms": 0.015, "training_step_time_ms": 17516.08, "sample_time_ms": 3405.38, "learn_time_ms": 14084.539, "learn_throughput": 283.999, "synch_weights_time_ms": 22.746}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "done": true, "training_iteration": 200, "trial_id": "e1352_00002", "date": "2024-08-13_20-09-33", "timestamp": 1723594173, "time_this_iter_s": 15.986620903015137, "time_total_s": 4053.6225051879883, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b30234c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4053.6225051879883, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 89.33181818181818, "ram_util_percent": 83.89545454545456}}
