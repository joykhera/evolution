{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8399495772086083, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.629122771322727, "policy_loss": -0.012339419140092407, "vf_loss": 6.638432840506236, "vf_explained_var": 0.0506777660921216, "kl": 0.015146968482981393, "entropy": 1.5944654437402883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9440572902560234, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.618500619133314, "policy_loss": -0.020691594078865214, "vf_loss": 6.634849698344866, "vf_explained_var": 0.05250056739896536, "kl": 0.02171252642527918, "entropy": 1.5882602619628112, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -15.236000128652446, "predator_policy": -24.309441760726155}, "policy_reward_max": {"prey_policy": 24.309441760726155, "predator_policy": 15.236000128652446}, "policy_reward_mean": {"prey_policy": -0.8815181284110292, "predator_policy": 0.8815181284110292}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.0939933232316292, 3.2019935106055897, -1.3538641920674408, -11.027097101067355, -2.002348990015136, 24.309441760726155, -2.054449397155345, 4.759212774882464, 0.9470537397206726, -5.555942353541607, 0.13463757859816639, -7.910503462018749, 15.637068249153103, -14.825851295813711, 4.598377796521614, -15.236000128652446, -8.22320506193013, 1.8281435838872575], "policy_predator_policy_reward": [3.0939933232316292, -3.2019935106055897, 1.3538641920674408, 11.027097101067355, 2.002348990015136, -24.309441760726155, 2.054449397155345, -4.759212774882464, -0.9470537397206726, 5.555942353541607, -0.13463757859816639, 7.910503462018749, -15.637068249153103, 14.825851295813711, -4.598377796521614, 15.236000128652446, 8.22320506193013, -1.8281435838872575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7687443346738659, "mean_inference_ms": 2.183573858242603, "mean_action_processing_ms": 0.28586743440867934, "mean_env_wait_ms": 0.19494684222382247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008676449457804361, "StateBufferConnector_ms": 0.009478463066948785, "ViewRequirementAgentConnector_ms": 0.0921765963236491}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 408.8257263940602, "num_env_steps_trained_throughput_per_sec": 408.8257263940602, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 9784.129, "restore_workers_time_ms": 0.018, "training_step_time_ms": 9784.067, "sample_time_ms": 1750.568, "learn_time_ms": 8018.384, "learn_throughput": 498.854, "synch_weights_time_ms": 13.645}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 1, "trial_id": "1f352_00000", "date": "2024-08-11_14-54-50", "timestamp": 1723402490, "time_this_iter_s": 9.852423906326294, "time_total_s": 9.852423906326294, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af490f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9.852423906326294, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 59.92666666666666, "ram_util_percent": 83.56000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1587331561061243, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.783895388245583, "policy_loss": -0.02528018794982927, "vf_loss": 6.8046357800563175, "vf_explained_var": -0.022282096184790136, "kl": 0.022698975177127715, "entropy": 1.5437180829544863, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.235184567514807, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.799484073619047, "policy_loss": -0.011747982398568032, "vf_loss": 6.806922531624635, "vf_explained_var": -0.02262068763375282, "kl": 0.014364994192233145, "entropy": 1.5460746719191472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -20.156362688160446, "predator_policy": -24.309441760726155}, "policy_reward_max": {"prey_policy": 24.309441760726155, "predator_policy": 20.156362688160446}, "policy_reward_mean": {"prey_policy": 0.4745958600309994, "predator_policy": -0.4745958600309994}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.0939933232316292, 3.2019935106055897, -1.3538641920674408, -11.027097101067355, -2.002348990015136, 24.309441760726155, -2.054449397155345, 4.759212774882464, 0.9470537397206726, -5.555942353541607, 0.13463757859816639, -7.910503462018749, 15.637068249153103, -14.825851295813711, 4.598377796521614, -15.236000128652446, -8.22320506193013, 1.8281435838872575, 10.571695748435388, -12.497315237135645, 23.687632251020656, -0.33538599331791197, 7.6992273766700485, -2.5726110792767933, 1.5955132039139563, -19.072578110456792, 20.34615480256549, 16.228601406417663, 13.904434214223809, 5.474500541157283, 9.309272157628051, -8.930565458393882, 9.57033838973253, -6.222994339688835, -15.64677991282008, -20.156362688160446], "policy_predator_policy_reward": [3.0939933232316292, -3.2019935106055897, 1.3538641920674408, 11.027097101067355, 2.002348990015136, -24.309441760726155, 2.054449397155345, -4.759212774882464, -0.9470537397206726, 5.555942353541607, -0.13463757859816639, 7.910503462018749, -15.637068249153103, 14.825851295813711, -4.598377796521614, 15.236000128652446, 8.22320506193013, -1.8281435838872575, -10.571695748435388, 12.497315237135645, -23.687632251020656, 0.33538599331791197, -7.6992273766700485, 2.5726110792767933, -1.5955132039139563, 19.072578110456792, -20.34615480256549, -16.228601406417663, -13.904434214223809, -5.474500541157283, -9.309272157628051, 8.930565458393882, -9.57033838973253, 6.222994339688835, 15.64677991282008, 20.156362688160446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7757270815127275, "mean_inference_ms": 2.2767512352279304, "mean_action_processing_ms": 0.2962394932677963, "mean_env_wait_ms": 0.200839502040137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012143452962239584, "StateBufferConnector_ms": 0.0069164567523532445, "ViewRequirementAgentConnector_ms": 0.1547624667485555}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 414.91623582905066, "num_env_steps_trained_throughput_per_sec": 414.91623582905066, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 9712.341, "restore_workers_time_ms": 0.058, "training_step_time_ms": 9712.061, "sample_time_ms": 1782.195, "learn_time_ms": 7910.26, "learn_throughput": 505.672, "synch_weights_time_ms": 18.041}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 2, "trial_id": "1f352_00000", "date": "2024-08-11_14-55-03", "timestamp": 1723402503, "time_this_iter_s": 9.683797121047974, "time_total_s": 19.536221027374268, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af3f89d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19.536221027374268, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 58.58888888888888, "ram_util_percent": 83.49444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6296188021699587, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.591734551886717, "policy_loss": -0.01469073547826459, "vf_loss": 7.601918005943299, "vf_explained_var": -0.15651367790997028, "kl": 0.015024301748149508, "entropy": 1.4962453794976076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6763865150821706, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.596395936608315, "policy_loss": -0.008098993978395204, "vf_loss": 7.602019240955512, "vf_explained_var": -0.15838642958551646, "kl": 0.008252345557354374, "entropy": 1.539288209999601, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -33.31293446341593, "predator_policy": -24.309441760726155}, "policy_reward_max": {"prey_policy": 24.309441760726155, "predator_policy": 33.31293446341593}, "policy_reward_mean": {"prey_policy": -3.5729256566838683, "predator_policy": 3.5729256566838683}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.0939933232316292, 3.2019935106055897, -1.3538641920674408, -11.027097101067355, -2.002348990015136, 24.309441760726155, -2.054449397155345, 4.759212774882464, 0.9470537397206726, -5.555942353541607, 0.13463757859816639, -7.910503462018749, 15.637068249153103, -14.825851295813711, 4.598377796521614, -15.236000128652446, -8.22320506193013, 1.8281435838872575, 10.571695748435388, -12.497315237135645, 23.687632251020656, -0.33538599331791197, 7.6992273766700485, -2.5726110792767933, 1.5955132039139563, -19.072578110456792, 20.34615480256549, 16.228601406417663, 13.904434214223809, 5.474500541157283, 9.309272157628051, -8.930565458393882, 9.57033838973253, -6.222994339688835, -15.64677991282008, -20.156362688160446, 8.154548622216467, -14.55663813515101, -5.695804077343411, -4.235938079597057, -16.91492306922657, -23.897407855146756, -15.637981738478356, 4.066182987111999, -8.317156951316168, -19.019144566571413, -29.00591856862853, 3.633344580483902, -14.679301685599874, -1.480932622976887, -4.522248712372708, -33.31293446341593, -10.731713021636038, -23.869469064396494], "policy_predator_policy_reward": [3.0939933232316292, -3.2019935106055897, 1.3538641920674408, 11.027097101067355, 2.002348990015136, -24.309441760726155, 2.054449397155345, -4.759212774882464, -0.9470537397206726, 5.555942353541607, -0.13463757859816639, 7.910503462018749, -15.637068249153103, 14.825851295813711, -4.598377796521614, 15.236000128652446, 8.22320506193013, -1.8281435838872575, -10.571695748435388, 12.497315237135645, -23.687632251020656, 0.33538599331791197, -7.6992273766700485, 2.5726110792767933, -1.5955132039139563, 19.072578110456792, -20.34615480256549, -16.228601406417663, -13.904434214223809, -5.474500541157283, -9.309272157628051, 8.930565458393882, -9.57033838973253, 6.222994339688835, 15.64677991282008, 20.156362688160446, -8.154548622216467, 14.55663813515101, 5.695804077343411, 4.235938079597057, 16.91492306922657, 23.897407855146756, 15.637981738478356, -4.066182987111999, 8.317156951316168, 19.019144566571413, 29.00591856862853, -3.633344580483902, 14.679301685599874, 1.480932622976887, 4.522248712372708, 33.31293446341593, 10.731713021636038, 23.869469064396494]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7422315501940169, "mean_inference_ms": 2.2168063548500334, "mean_action_processing_ms": 0.2866643192906846, "mean_env_wait_ms": 0.19359981744295088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010218885209825303, "StateBufferConnector_ms": 0.005525129812735098, "ViewRequirementAgentConnector_ms": 0.1243273417154948}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 472.50978691285565, "num_env_steps_trained_throughput_per_sec": 472.50978691285565, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 9296.8, "restore_workers_time_ms": 0.049, "training_step_time_ms": 9295.711, "sample_time_ms": 1546.459, "learn_time_ms": 7728.75, "learn_throughput": 517.548, "synch_weights_time_ms": 19.053}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 3, "trial_id": "1f352_00000", "date": "2024-08-11_14-55-11", "timestamp": 1723402511, "time_this_iter_s": 8.527523040771484, "time_total_s": 28.063744068145752, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4a7700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28.063744068145752, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 56.341666666666676, "ram_util_percent": 83.19166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4909231425883869, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.856941581765811, "policy_loss": -0.007180671155219897, "vf_loss": 6.861213687062263, "vf_explained_var": -0.08016233947128057, "kl": 0.00969523163349239, "entropy": 1.4870101520170769, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5230950818086664, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.8629554271697994, "policy_loss": -0.004384704637777759, "vf_loss": 6.86530364404122, "vf_explained_var": -0.07853840067982673, "kl": 0.006788273025914848, "entropy": 1.5579813923686743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -34.98883805599059, "predator_policy": -24.309441760726155}, "policy_reward_max": {"prey_policy": 24.309441760726155, "predator_policy": 34.98883805599059}, "policy_reward_mean": {"prey_policy": -6.483575621112198, "predator_policy": 6.483575621112198}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.0939933232316292, 3.2019935106055897, -1.3538641920674408, -11.027097101067355, -2.002348990015136, 24.309441760726155, -2.054449397155345, 4.759212774882464, 0.9470537397206726, -5.555942353541607, 0.13463757859816639, -7.910503462018749, 15.637068249153103, -14.825851295813711, 4.598377796521614, -15.236000128652446, -8.22320506193013, 1.8281435838872575, 10.571695748435388, -12.497315237135645, 23.687632251020656, -0.33538599331791197, 7.6992273766700485, -2.5726110792767933, 1.5955132039139563, -19.072578110456792, 20.34615480256549, 16.228601406417663, 13.904434214223809, 5.474500541157283, 9.309272157628051, -8.930565458393882, 9.57033838973253, -6.222994339688835, -15.64677991282008, -20.156362688160446, 8.154548622216467, -14.55663813515101, -5.695804077343411, -4.235938079597057, -16.91492306922657, -23.897407855146756, -15.637981738478356, 4.066182987111999, -8.317156951316168, -19.019144566571413, -29.00591856862853, 3.633344580483902, -14.679301685599874, -1.480932622976887, -4.522248712372708, -33.31293446341593, -10.731713021636038, -23.869469064396494, -25.597572000376715, -20.923652130113343, -34.98883805599059, -4.748720210187422, 1.5028876917156335, -17.398783628867303, -9.902907827517257, -4.685616896994344, -20.01719817118258, -16.867955133657276, -22.5842610099079, -12.10670877226241, -32.81810243192695, -11.414766091239283, -22.54629809590703, -3.9372369481406677, -15.456651891750967, 0.612922345156985], "policy_predator_policy_reward": [3.0939933232316292, -3.2019935106055897, 1.3538641920674408, 11.027097101067355, 2.002348990015136, -24.309441760726155, 2.054449397155345, -4.759212774882464, -0.9470537397206726, 5.555942353541607, -0.13463757859816639, 7.910503462018749, -15.637068249153103, 14.825851295813711, -4.598377796521614, 15.236000128652446, 8.22320506193013, -1.8281435838872575, -10.571695748435388, 12.497315237135645, -23.687632251020656, 0.33538599331791197, -7.6992273766700485, 2.5726110792767933, -1.5955132039139563, 19.072578110456792, -20.34615480256549, -16.228601406417663, -13.904434214223809, -5.474500541157283, -9.309272157628051, 8.930565458393882, -9.57033838973253, 6.222994339688835, 15.64677991282008, 20.156362688160446, -8.154548622216467, 14.55663813515101, 5.695804077343411, 4.235938079597057, 16.91492306922657, 23.897407855146756, 15.637981738478356, -4.066182987111999, 8.317156951316168, 19.019144566571413, 29.00591856862853, -3.633344580483902, 14.679301685599874, 1.480932622976887, 4.522248712372708, 33.31293446341593, 10.731713021636038, 23.869469064396494, 25.597572000376715, 20.923652130113343, 34.98883805599059, 4.748720210187422, -1.5028876917156335, 17.398783628867303, 9.902907827517257, 4.685616896994344, 20.01719817118258, 16.867955133657276, 22.5842610099079, 12.10670877226241, 32.81810243192695, 11.414766091239283, 22.54629809590703, 3.9372369481406677, 15.456651891750967, -0.612922345156985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.722654505079756, "mean_inference_ms": 2.19729541407772, "mean_action_processing_ms": 0.2817551921931639, "mean_env_wait_ms": 0.18926317338134419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011640787124633789, "StateBufferConnector_ms": 0.00485959980222914, "ViewRequirementAgentConnector_ms": 0.11862119038899739}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 454.8644794049928, "num_env_steps_trained_throughput_per_sec": 454.8644794049928, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 9171.067, "restore_workers_time_ms": 0.042, "training_step_time_ms": 9170.232, "sample_time_ms": 1543.051, "learn_time_ms": 7606.636, "learn_throughput": 525.857, "synch_weights_time_ms": 19.277}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 4, "trial_id": "1f352_00000", "date": "2024-08-11_14-55-20", "timestamp": 1723402520, "time_this_iter_s": 8.839676141738892, "time_total_s": 36.903420209884644, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4a7430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 36.903420209884644, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 54.69230769230769, "ram_util_percent": 83.20769230769231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3346953972553213, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.1191447933514915, "policy_loss": -0.007057717680678858, "vf_loss": 7.12396128376325, "vf_explained_var": -0.05197943424185117, "kl": 0.007470682520668588, "entropy": 1.4646106333782276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2856983294400075, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.117565217614174, "policy_loss": -0.012392031836013, "vf_loss": 7.126296371221542, "vf_explained_var": -0.050107198394835, "kl": 0.012202943419160051, "entropy": 1.5533374156802893, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -55.46493758602248, "predator_policy": -24.309441760726155}, "policy_reward_max": {"prey_policy": 24.309441760726155, "predator_policy": 55.46493758602248}, "policy_reward_mean": {"prey_policy": -10.268453139790982, "predator_policy": 10.268453139790982}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.0939933232316292, 3.2019935106055897, -1.3538641920674408, -11.027097101067355, -2.002348990015136, 24.309441760726155, -2.054449397155345, 4.759212774882464, 0.9470537397206726, -5.555942353541607, 0.13463757859816639, -7.910503462018749, 15.637068249153103, -14.825851295813711, 4.598377796521614, -15.236000128652446, -8.22320506193013, 1.8281435838872575, 10.571695748435388, -12.497315237135645, 23.687632251020656, -0.33538599331791197, 7.6992273766700485, -2.5726110792767933, 1.5955132039139563, -19.072578110456792, 20.34615480256549, 16.228601406417663, 13.904434214223809, 5.474500541157283, 9.309272157628051, -8.930565458393882, 9.57033838973253, -6.222994339688835, -15.64677991282008, -20.156362688160446, 8.154548622216467, -14.55663813515101, -5.695804077343411, -4.235938079597057, -16.91492306922657, -23.897407855146756, -15.637981738478356, 4.066182987111999, -8.317156951316168, -19.019144566571413, -29.00591856862853, 3.633344580483902, -14.679301685599874, -1.480932622976887, -4.522248712372708, -33.31293446341593, -10.731713021636038, -23.869469064396494, -25.597572000376715, -20.923652130113343, -34.98883805599059, -4.748720210187422, 1.5028876917156335, -17.398783628867303, -9.902907827517257, -4.685616896994344, -20.01719817118258, -16.867955133657276, -22.5842610099079, -12.10670877226241, -32.81810243192695, -11.414766091239283, -22.54629809590703, -3.9372369481406677, -15.456651891750967, 0.612922345156985, 1.102537002763908, -30.730686591865844, -4.496764330122855, -27.11726534590013, -22.37723090103283, -36.45705522856341, -55.46493758602248, 2.7543620584559525, -29.709108984088303, -28.820428239620615, -50.7036054300104, -16.51418442612104, -32.567456168079545, -26.141215136026926, -3.5474285433163146, -15.796376665274192, -28.99825031233043, -11.734229033427486, 0.7921564869602555, 1.0641207191491633, -15.376173422422443, -11.069596292421734, -28.45492412148922, 7.609606300839445, -31.27233402724474, -25.836239544544224, -29.896708357472612], "policy_predator_policy_reward": [3.0939933232316292, -3.2019935106055897, 1.3538641920674408, 11.027097101067355, 2.002348990015136, -24.309441760726155, 2.054449397155345, -4.759212774882464, -0.9470537397206726, 5.555942353541607, -0.13463757859816639, 7.910503462018749, -15.637068249153103, 14.825851295813711, -4.598377796521614, 15.236000128652446, 8.22320506193013, -1.8281435838872575, -10.571695748435388, 12.497315237135645, -23.687632251020656, 0.33538599331791197, -7.6992273766700485, 2.5726110792767933, -1.5955132039139563, 19.072578110456792, -20.34615480256549, -16.228601406417663, -13.904434214223809, -5.474500541157283, -9.309272157628051, 8.930565458393882, -9.57033838973253, 6.222994339688835, 15.64677991282008, 20.156362688160446, -8.154548622216467, 14.55663813515101, 5.695804077343411, 4.235938079597057, 16.91492306922657, 23.897407855146756, 15.637981738478356, -4.066182987111999, 8.317156951316168, 19.019144566571413, 29.00591856862853, -3.633344580483902, 14.679301685599874, 1.480932622976887, 4.522248712372708, 33.31293446341593, 10.731713021636038, 23.869469064396494, 25.597572000376715, 20.923652130113343, 34.98883805599059, 4.748720210187422, -1.5028876917156335, 17.398783628867303, 9.902907827517257, 4.685616896994344, 20.01719817118258, 16.867955133657276, 22.5842610099079, 12.10670877226241, 32.81810243192695, 11.414766091239283, 22.54629809590703, 3.9372369481406677, 15.456651891750967, -0.612922345156985, -1.102537002763908, 30.730686591865844, 4.496764330122855, 27.11726534590013, 22.37723090103283, 36.45705522856341, 55.46493758602248, -2.7543620584559525, 29.709108984088303, 28.820428239620615, 50.7036054300104, 16.51418442612104, 32.567456168079545, 26.141215136026926, 3.5474285433163146, 15.796376665274192, 28.99825031233043, 11.734229033427486, -0.7921564869602555, -1.0641207191491633, 15.376173422422443, 11.069596292421734, 28.45492412148922, -7.609606300839445, 31.27233402724474, 25.836239544544224, 29.896708357472612]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.70188847051143, "mean_inference_ms": 2.1770432721095476, "mean_action_processing_ms": 0.2757474702829149, "mean_env_wait_ms": 0.18457979176469516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011153413791849155, "StateBufferConnector_ms": 0.004430852755151614, "ViewRequirementAgentConnector_ms": 0.1062780919701162}, "num_episodes": 27, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 395.42086985956246, "num_env_steps_trained_throughput_per_sec": 395.42086985956246, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 9360.023, "restore_workers_time_ms": 0.036, "training_step_time_ms": 9359.322, "sample_time_ms": 1509.179, "learn_time_ms": 7827.186, "learn_throughput": 511.039, "synch_weights_time_ms": 21.727}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 5, "trial_id": "1f352_00000", "date": "2024-08-11_14-55-30", "timestamp": 1723402530, "time_this_iter_s": 10.1695396900177, "time_total_s": 47.072959899902344, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af487430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 47.072959899902344, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 67.71428571428571, "ram_util_percent": 83.30714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5269920250711342, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.007404199739297, "policy_loss": -0.009231209612335079, "vf_loss": 7.013984486460686, "vf_explained_var": -0.062431432865560056, "kl": 0.008836416258896663, "entropy": 1.4411306728919346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5147979158597689, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.022195308903853, "policy_loss": -0.008452710113245606, "vf_loss": 7.028440228601297, "vf_explained_var": -0.06768334327886502, "kl": 0.0073593156474299785, "entropy": 1.5281596458206574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.46493758602248, "predator_policy": -23.687632251020656}, "policy_reward_max": {"prey_policy": 23.687632251020656, "predator_policy": 55.46493758602248}, "policy_reward_mean": {"prey_policy": -13.425951415947923, "predator_policy": 13.425951415947923}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.8281435838872575, 10.571695748435388, -12.497315237135645, 23.687632251020656, -0.33538599331791197, 7.6992273766700485, -2.5726110792767933, 1.5955132039139563, -19.072578110456792, 20.34615480256549, 16.228601406417663, 13.904434214223809, 5.474500541157283, 9.309272157628051, -8.930565458393882, 9.57033838973253, -6.222994339688835, -15.64677991282008, -20.156362688160446, 8.154548622216467, -14.55663813515101, -5.695804077343411, -4.235938079597057, -16.91492306922657, -23.897407855146756, -15.637981738478356, 4.066182987111999, -8.317156951316168, -19.019144566571413, -29.00591856862853, 3.633344580483902, -14.679301685599874, -1.480932622976887, -4.522248712372708, -33.31293446341593, -10.731713021636038, -23.869469064396494, -25.597572000376715, -20.923652130113343, -34.98883805599059, -4.748720210187422, 1.5028876917156335, -17.398783628867303, -9.902907827517257, -4.685616896994344, -20.01719817118258, -16.867955133657276, -22.5842610099079, -12.10670877226241, -32.81810243192695, -11.414766091239283, -22.54629809590703, -3.9372369481406677, -15.456651891750967, 0.612922345156985, 1.102537002763908, -30.730686591865844, -4.496764330122855, -27.11726534590013, -22.37723090103283, -36.45705522856341, -55.46493758602248, 2.7543620584559525, -29.709108984088303, -28.820428239620615, -50.7036054300104, -16.51418442612104, -32.567456168079545, -26.141215136026926, -3.5474285433163146, -15.796376665274192, -28.99825031233043, -11.734229033427486, 0.7921564869602555, 1.0641207191491633, -15.376173422422443, -11.069596292421734, -28.45492412148922, 7.609606300839445, -31.27233402724474, -25.836239544544224, -29.896708357472612, -14.519736050745273, -9.087773539746447, -25.3565670850041, -10.521793309239706, -17.540455775768457, -9.345183935569299, -6.498613144885104, -15.10239063576953, -39.19872143962627, -35.2705229929586, -29.114222193627747, -9.535932530123967, -26.119402669744645, -19.57317817598031, -13.285394734973146, -28.90533561663004, -17.178817036501858, -17.559709783876336], "policy_predator_policy_reward": [-1.8281435838872575, -10.571695748435388, 12.497315237135645, -23.687632251020656, 0.33538599331791197, -7.6992273766700485, 2.5726110792767933, -1.5955132039139563, 19.072578110456792, -20.34615480256549, -16.228601406417663, -13.904434214223809, -5.474500541157283, -9.309272157628051, 8.930565458393882, -9.57033838973253, 6.222994339688835, 15.64677991282008, 20.156362688160446, -8.154548622216467, 14.55663813515101, 5.695804077343411, 4.235938079597057, 16.91492306922657, 23.897407855146756, 15.637981738478356, -4.066182987111999, 8.317156951316168, 19.019144566571413, 29.00591856862853, -3.633344580483902, 14.679301685599874, 1.480932622976887, 4.522248712372708, 33.31293446341593, 10.731713021636038, 23.869469064396494, 25.597572000376715, 20.923652130113343, 34.98883805599059, 4.748720210187422, -1.5028876917156335, 17.398783628867303, 9.902907827517257, 4.685616896994344, 20.01719817118258, 16.867955133657276, 22.5842610099079, 12.10670877226241, 32.81810243192695, 11.414766091239283, 22.54629809590703, 3.9372369481406677, 15.456651891750967, -0.612922345156985, -1.102537002763908, 30.730686591865844, 4.496764330122855, 27.11726534590013, 22.37723090103283, 36.45705522856341, 55.46493758602248, -2.7543620584559525, 29.709108984088303, 28.820428239620615, 50.7036054300104, 16.51418442612104, 32.567456168079545, 26.141215136026926, 3.5474285433163146, 15.796376665274192, 28.99825031233043, 11.734229033427486, -0.7921564869602555, -1.0641207191491633, 15.376173422422443, 11.069596292421734, 28.45492412148922, -7.609606300839445, 31.27233402724474, 25.836239544544224, 29.896708357472612, 14.519736050745273, 9.087773539746447, 25.3565670850041, 10.521793309239706, 17.540455775768457, 9.345183935569299, 6.498613144885104, 15.10239063576953, 39.19872143962627, 35.2705229929586, 29.114222193627747, 9.535932530123967, 26.119402669744645, 19.57317817598031, 13.285394734973146, 28.90533561663004, 17.178817036501858, 17.559709783876336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6757100599534257, "mean_inference_ms": 2.1532725602691656, "mean_action_processing_ms": 0.2697349558887371, "mean_env_wait_ms": 0.17970563395741354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010189175605773926, "StateBufferConnector_ms": 0.0031533241271972656, "ViewRequirementAgentConnector_ms": 0.10612881183624268}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 429.0373287846125, "num_env_steps_trained_throughput_per_sec": 429.0373287846125, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 9353.947, "restore_workers_time_ms": 0.054, "training_step_time_ms": 9353.271, "sample_time_ms": 1454.5, "learn_time_ms": 7877.17, "learn_throughput": 507.797, "synch_weights_time_ms": 20.48}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 6, "trial_id": "1f352_00000", "date": "2024-08-11_14-55-40", "timestamp": 1723402540, "time_this_iter_s": 9.381570100784302, "time_total_s": 56.454530000686646, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af487b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 56.454530000686646, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 60.54615384615385, "ram_util_percent": 83.10769230769232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.349874884945651, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.079535340766112, "policy_loss": -0.010099649566109292, "vf_loss": 7.086337461074193, "vf_explained_var": -0.24693725667893887, "kl": 0.010991787611085609, "entropy": 1.3972029251356919, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3744007219870886, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.092636433740457, "policy_loss": -0.007256143867562059, "vf_loss": 7.097463540732861, "vf_explained_var": -0.18251488997290533, "kl": 0.008096775489108768, "entropy": 1.5051540256788334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.46493758602248, "predator_policy": -8.154548622216467}, "policy_reward_max": {"prey_policy": 8.154548622216467, "predator_policy": 55.46493758602248}, "policy_reward_mean": {"prey_policy": -17.059122756149854, "predator_policy": 17.059122756149854}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.156362688160446, 8.154548622216467, -14.55663813515101, -5.695804077343411, -4.235938079597057, -16.91492306922657, -23.897407855146756, -15.637981738478356, 4.066182987111999, -8.317156951316168, -19.019144566571413, -29.00591856862853, 3.633344580483902, -14.679301685599874, -1.480932622976887, -4.522248712372708, -33.31293446341593, -10.731713021636038, -23.869469064396494, -25.597572000376715, -20.923652130113343, -34.98883805599059, -4.748720210187422, 1.5028876917156335, -17.398783628867303, -9.902907827517257, -4.685616896994344, -20.01719817118258, -16.867955133657276, -22.5842610099079, -12.10670877226241, -32.81810243192695, -11.414766091239283, -22.54629809590703, -3.9372369481406677, -15.456651891750967, 0.612922345156985, 1.102537002763908, -30.730686591865844, -4.496764330122855, -27.11726534590013, -22.37723090103283, -36.45705522856341, -55.46493758602248, 2.7543620584559525, -29.709108984088303, -28.820428239620615, -50.7036054300104, -16.51418442612104, -32.567456168079545, -26.141215136026926, -3.5474285433163146, -15.796376665274192, -28.99825031233043, -11.734229033427486, 0.7921564869602555, 1.0641207191491633, -15.376173422422443, -11.069596292421734, -28.45492412148922, 7.609606300839445, -31.27233402724474, -25.836239544544224, -29.896708357472612, -14.519736050745273, -9.087773539746447, -25.3565670850041, -10.521793309239706, -17.540455775768457, -9.345183935569299, -6.498613144885104, -15.10239063576953, -39.19872143962627, -35.2705229929586, -29.114222193627747, -9.535932530123967, -26.119402669744645, -19.57317817598031, -13.285394734973146, -28.90533561663004, -17.178817036501858, -17.559709783876336, -21.82685755206529, -11.301222349800168, -8.606908734510897, -35.55327767936338, -20.80119252159019, -8.065653595643077, -5.885471419962818, -8.71396624118222, -18.951478831868886, -11.511912998038962, -27.533908176579782, -7.783095322803456, -30.66369468691233, -11.732473599296267, -4.956598284433303, -14.061244633236214, -27.210726592920174, -33.22016725542368], "policy_predator_policy_reward": [20.156362688160446, -8.154548622216467, 14.55663813515101, 5.695804077343411, 4.235938079597057, 16.91492306922657, 23.897407855146756, 15.637981738478356, -4.066182987111999, 8.317156951316168, 19.019144566571413, 29.00591856862853, -3.633344580483902, 14.679301685599874, 1.480932622976887, 4.522248712372708, 33.31293446341593, 10.731713021636038, 23.869469064396494, 25.597572000376715, 20.923652130113343, 34.98883805599059, 4.748720210187422, -1.5028876917156335, 17.398783628867303, 9.902907827517257, 4.685616896994344, 20.01719817118258, 16.867955133657276, 22.5842610099079, 12.10670877226241, 32.81810243192695, 11.414766091239283, 22.54629809590703, 3.9372369481406677, 15.456651891750967, -0.612922345156985, -1.102537002763908, 30.730686591865844, 4.496764330122855, 27.11726534590013, 22.37723090103283, 36.45705522856341, 55.46493758602248, -2.7543620584559525, 29.709108984088303, 28.820428239620615, 50.7036054300104, 16.51418442612104, 32.567456168079545, 26.141215136026926, 3.5474285433163146, 15.796376665274192, 28.99825031233043, 11.734229033427486, -0.7921564869602555, -1.0641207191491633, 15.376173422422443, 11.069596292421734, 28.45492412148922, -7.609606300839445, 31.27233402724474, 25.836239544544224, 29.896708357472612, 14.519736050745273, 9.087773539746447, 25.3565670850041, 10.521793309239706, 17.540455775768457, 9.345183935569299, 6.498613144885104, 15.10239063576953, 39.19872143962627, 35.2705229929586, 29.114222193627747, 9.535932530123967, 26.119402669744645, 19.57317817598031, 13.285394734973146, 28.90533561663004, 17.178817036501858, 17.559709783876336, 21.82685755206529, 11.301222349800168, 8.606908734510897, 35.55327767936338, 20.80119252159019, 8.065653595643077, 5.885471419962818, 8.71396624118222, 18.951478831868886, 11.511912998038962, 27.533908176579782, 7.783095322803456, 30.66369468691233, 11.732473599296267, 4.956598284433303, 14.061244633236214, 27.210726592920174, 33.22016725542368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6534551774636778, "mean_inference_ms": 2.1161871175023124, "mean_action_processing_ms": 0.2633339788895577, "mean_env_wait_ms": 0.17360957692177906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008204936981201172, "StateBufferConnector_ms": 0.0030215978622436523, "ViewRequirementAgentConnector_ms": 0.10837864875793457}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 364.9478230523763, "num_env_steps_trained_throughput_per_sec": 364.9478230523763, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 9583.458, "restore_workers_time_ms": 0.049, "training_step_time_ms": 9582.855, "sample_time_ms": 1531.669, "learn_time_ms": 8025.441, "learn_throughput": 498.415, "synch_weights_time_ms": 24.634}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 7, "trial_id": "1f352_00000", "date": "2024-08-11_14-55-51", "timestamp": 1723402551, "time_this_iter_s": 11.02543592453003, "time_total_s": 67.47996592521667, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af47b700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 67.47996592521667, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 63.6625, "ram_util_percent": 83.21875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4081364084966481, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.4158166279395425, "policy_loss": -0.0074429454883405315, "vf_loss": 6.420613095661005, "vf_explained_var": 0.21038259553412597, "kl": 0.008821571023804075, "entropy": 1.380421482026577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4381715629249812, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.481480405728022, "policy_loss": -0.0085360181464542, "vf_loss": 6.487237135569255, "vf_explained_var": 0.18302258836726348, "kl": 0.009264260139181902, "entropy": 1.4610014273474614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.46493758602248, "predator_policy": -7.609606300839445}, "policy_reward_max": {"prey_policy": 7.609606300839445, "predator_policy": 55.46493758602248}, "policy_reward_mean": {"prey_policy": -18.43470361442505, "predator_policy": 18.43470361442505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-23.869469064396494, -25.597572000376715, -20.923652130113343, -34.98883805599059, -4.748720210187422, 1.5028876917156335, -17.398783628867303, -9.902907827517257, -4.685616896994344, -20.01719817118258, -16.867955133657276, -22.5842610099079, -12.10670877226241, -32.81810243192695, -11.414766091239283, -22.54629809590703, -3.9372369481406677, -15.456651891750967, 0.612922345156985, 1.102537002763908, -30.730686591865844, -4.496764330122855, -27.11726534590013, -22.37723090103283, -36.45705522856341, -55.46493758602248, 2.7543620584559525, -29.709108984088303, -28.820428239620615, -50.7036054300104, -16.51418442612104, -32.567456168079545, -26.141215136026926, -3.5474285433163146, -15.796376665274192, -28.99825031233043, -11.734229033427486, 0.7921564869602555, 1.0641207191491633, -15.376173422422443, -11.069596292421734, -28.45492412148922, 7.609606300839445, -31.27233402724474, -25.836239544544224, -29.896708357472612, -14.519736050745273, -9.087773539746447, -25.3565670850041, -10.521793309239706, -17.540455775768457, -9.345183935569299, -6.498613144885104, -15.10239063576953, -39.19872143962627, -35.2705229929586, -29.114222193627747, -9.535932530123967, -26.119402669744645, -19.57317817598031, -13.285394734973146, -28.90533561663004, -17.178817036501858, -17.559709783876336, -21.82685755206529, -11.301222349800168, -8.606908734510897, -35.55327767936338, -20.80119252159019, -8.065653595643077, -5.885471419962818, -8.71396624118222, -18.951478831868886, -11.511912998038962, -27.533908176579782, -7.783095322803456, -30.66369468691233, -11.732473599296267, -4.956598284433303, -14.061244633236214, -27.210726592920174, -33.22016725542368, -36.56535739296844, -1.4152517430955047, -42.02785206227515, -21.060589128449237, -21.676739190021408, 0.5462791712497754, -22.423297473725697, -11.796523431443688, -26.17262883021351, -0.31821018729318595, -39.90627169354467, 6.049443076676827, -21.938628700356496, -45.071103020676965, -19.20045979951681, -7.763816235434654, -7.840391549969172, -25.28701768227011], "policy_predator_policy_reward": [23.869469064396494, 25.597572000376715, 20.923652130113343, 34.98883805599059, 4.748720210187422, -1.5028876917156335, 17.398783628867303, 9.902907827517257, 4.685616896994344, 20.01719817118258, 16.867955133657276, 22.5842610099079, 12.10670877226241, 32.81810243192695, 11.414766091239283, 22.54629809590703, 3.9372369481406677, 15.456651891750967, -0.612922345156985, -1.102537002763908, 30.730686591865844, 4.496764330122855, 27.11726534590013, 22.37723090103283, 36.45705522856341, 55.46493758602248, -2.7543620584559525, 29.709108984088303, 28.820428239620615, 50.7036054300104, 16.51418442612104, 32.567456168079545, 26.141215136026926, 3.5474285433163146, 15.796376665274192, 28.99825031233043, 11.734229033427486, -0.7921564869602555, -1.0641207191491633, 15.376173422422443, 11.069596292421734, 28.45492412148922, -7.609606300839445, 31.27233402724474, 25.836239544544224, 29.896708357472612, 14.519736050745273, 9.087773539746447, 25.3565670850041, 10.521793309239706, 17.540455775768457, 9.345183935569299, 6.498613144885104, 15.10239063576953, 39.19872143962627, 35.2705229929586, 29.114222193627747, 9.535932530123967, 26.119402669744645, 19.57317817598031, 13.285394734973146, 28.90533561663004, 17.178817036501858, 17.559709783876336, 21.82685755206529, 11.301222349800168, 8.606908734510897, 35.55327767936338, 20.80119252159019, 8.065653595643077, 5.885471419962818, 8.71396624118222, 18.951478831868886, 11.511912998038962, 27.533908176579782, 7.783095322803456, 30.66369468691233, 11.732473599296267, 4.956598284433303, 14.061244633236214, 27.210726592920174, 33.22016725542368, 36.56535739296844, 1.4152517430955047, 42.02785206227515, 21.060589128449237, 21.676739190021408, -0.5462791712497754, 22.423297473725697, 11.796523431443688, 26.17262883021351, 0.31821018729318595, 39.90627169354467, -6.049443076676827, 21.938628700356496, 45.071103020676965, 19.20045979951681, 7.763816235434654, 7.840391549969172, 25.28701768227011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6472520415640588, "mean_inference_ms": 2.1164175947886936, "mean_action_processing_ms": 0.2627401602873151, "mean_env_wait_ms": 0.1718539159820142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007733702659606934, "StateBufferConnector_ms": 0.0036698579788208008, "ViewRequirementAgentConnector_ms": 0.11146128177642822}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 392.34880798193285, "num_env_steps_trained_throughput_per_sec": 392.34880798193285, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 9659.91, "restore_workers_time_ms": 0.046, "training_step_time_ms": 9659.228, "sample_time_ms": 1515.485, "learn_time_ms": 8106.03, "learn_throughput": 493.46, "synch_weights_time_ms": 36.291}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 8, "trial_id": "1f352_00000", "date": "2024-08-11_14-56-01", "timestamp": 1723402561, "time_this_iter_s": 10.259829044342041, "time_total_s": 77.73979496955872, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af47c4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 77.73979496955872, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 55.786666666666655, "ram_util_percent": 83.23333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4072121256341537, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.543625810742379, "policy_loss": -0.006492089519451838, "vf_loss": 6.548020942509174, "vf_explained_var": -0.028974812539915244, "kl": 0.00698988292911924, "entropy": 1.3314089994877576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4444892103783786, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.583262402315935, "policy_loss": -0.007228600681507184, "vf_loss": 6.588675618668398, "vf_explained_var": -0.02934135664254427, "kl": 0.006051132291761027, "entropy": 1.424835165341695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.46493758602248, "predator_policy": -7.609606300839445}, "policy_reward_max": {"prey_policy": 7.609606300839445, "predator_policy": 55.46493758602248}, "policy_reward_mean": {"prey_policy": -18.875123948133783, "predator_policy": 18.875123948133783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-27.11726534590013, -22.37723090103283, -36.45705522856341, -55.46493758602248, 2.7543620584559525, -29.709108984088303, -28.820428239620615, -50.7036054300104, -16.51418442612104, -32.567456168079545, -26.141215136026926, -3.5474285433163146, -15.796376665274192, -28.99825031233043, -11.734229033427486, 0.7921564869602555, 1.0641207191491633, -15.376173422422443, -11.069596292421734, -28.45492412148922, 7.609606300839445, -31.27233402724474, -25.836239544544224, -29.896708357472612, -14.519736050745273, -9.087773539746447, -25.3565670850041, -10.521793309239706, -17.540455775768457, -9.345183935569299, -6.498613144885104, -15.10239063576953, -39.19872143962627, -35.2705229929586, -29.114222193627747, -9.535932530123967, -26.119402669744645, -19.57317817598031, -13.285394734973146, -28.90533561663004, -17.178817036501858, -17.559709783876336, -21.82685755206529, -11.301222349800168, -8.606908734510897, -35.55327767936338, -20.80119252159019, -8.065653595643077, -5.885471419962818, -8.71396624118222, -18.951478831868886, -11.511912998038962, -27.533908176579782, -7.783095322803456, -30.66369468691233, -11.732473599296267, -4.956598284433303, -14.061244633236214, -27.210726592920174, -33.22016725542368, -36.56535739296844, -1.4152517430955047, -42.02785206227515, -21.060589128449237, -21.676739190021408, 0.5462791712497754, -22.423297473725697, -11.796523431443688, -26.17262883021351, -0.31821018729318595, -39.90627169354467, 6.049443076676827, -21.938628700356496, -45.071103020676965, -19.20045979951681, -7.763816235434654, -7.840391549969172, -25.28701768227011, -18.561567829019637, -4.86343445544653, -16.96656717211249, -7.601013544575367, -24.525955589583482, -20.129795247805944, 0.5791998093136694, -30.670189467463306, -5.409304723030555, -7.9865715912961885, -1.7147898887144333, -12.772256935441025, 6.082286946416023, -20.966860347227207, -19.971732336147994, -17.896745980981375, -31.986235247866514, -27.987489632496427, -36.34573970953629, -38.33549442938894, -23.06127444625395, -14.824343794986206], "policy_predator_policy_reward": [27.11726534590013, 22.37723090103283, 36.45705522856341, 55.46493758602248, -2.7543620584559525, 29.709108984088303, 28.820428239620615, 50.7036054300104, 16.51418442612104, 32.567456168079545, 26.141215136026926, 3.5474285433163146, 15.796376665274192, 28.99825031233043, 11.734229033427486, -0.7921564869602555, -1.0641207191491633, 15.376173422422443, 11.069596292421734, 28.45492412148922, -7.609606300839445, 31.27233402724474, 25.836239544544224, 29.896708357472612, 14.519736050745273, 9.087773539746447, 25.3565670850041, 10.521793309239706, 17.540455775768457, 9.345183935569299, 6.498613144885104, 15.10239063576953, 39.19872143962627, 35.2705229929586, 29.114222193627747, 9.535932530123967, 26.119402669744645, 19.57317817598031, 13.285394734973146, 28.90533561663004, 17.178817036501858, 17.559709783876336, 21.82685755206529, 11.301222349800168, 8.606908734510897, 35.55327767936338, 20.80119252159019, 8.065653595643077, 5.885471419962818, 8.71396624118222, 18.951478831868886, 11.511912998038962, 27.533908176579782, 7.783095322803456, 30.66369468691233, 11.732473599296267, 4.956598284433303, 14.061244633236214, 27.210726592920174, 33.22016725542368, 36.56535739296844, 1.4152517430955047, 42.02785206227515, 21.060589128449237, 21.676739190021408, -0.5462791712497754, 22.423297473725697, 11.796523431443688, 26.17262883021351, 0.31821018729318595, 39.90627169354467, -6.049443076676827, 21.938628700356496, 45.071103020676965, 19.20045979951681, 7.763816235434654, 7.840391549969172, 25.28701768227011, 18.561567829019637, 4.86343445544653, 16.96656717211249, 7.601013544575367, 24.525955589583482, 20.129795247805944, -0.5791998093136694, 30.670189467463306, 5.409304723030555, 7.9865715912961885, 1.7147898887144333, 12.772256935441025, -6.082286946416023, 20.966860347227207, 19.971732336147994, 17.896745980981375, 31.986235247866514, 27.987489632496427, 36.34573970953629, 38.33549442938894, 23.06127444625395, 14.824343794986206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6390569051567818, "mean_inference_ms": 2.0919990310474104, "mean_action_processing_ms": 0.26003363583518146, "mean_env_wait_ms": 0.16911139790792448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005370616912841797, "StateBufferConnector_ms": 0.0036705732345581055, "ViewRequirementAgentConnector_ms": 0.10538280010223389}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 407.3202793117272, "num_env_steps_trained_throughput_per_sec": 407.3202793117272, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 9677.734, "restore_workers_time_ms": 0.044, "training_step_time_ms": 9677.117, "sample_time_ms": 1454.267, "learn_time_ms": 8186.645, "learn_throughput": 488.601, "synch_weights_time_ms": 34.817}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 9, "trial_id": "1f352_00000", "date": "2024-08-11_14-56-11", "timestamp": 1723402571, "time_this_iter_s": 9.900782823562622, "time_total_s": 87.64057779312134, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af487dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 87.64057779312134, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 54.41428571428571, "ram_util_percent": 83.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.454033117989699, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.953838211794694, "policy_loss": -0.0063174826813337855, "vf_loss": 6.958487565318744, "vf_explained_var": 0.08908054623752833, "kl": 0.005560396590313277, "entropy": 1.2997203969707092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5128128530147176, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.968085351586342, "policy_loss": -0.006196118138905149, "vf_loss": 6.972676002482573, "vf_explained_var": 0.06065960706522067, "kl": 0.00535155584508266, "entropy": 1.4278802428394557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -45.071103020676965, "predator_policy": -21.237102178068525}, "policy_reward_max": {"prey_policy": 21.237102178068525, "predator_policy": 45.071103020676965}, "policy_reward_mean": {"prey_policy": -17.520431918147196, "predator_policy": 17.520431918147196}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-29.896708357472612, -14.519736050745273, -9.087773539746447, -25.3565670850041, -10.521793309239706, -17.540455775768457, -9.345183935569299, -6.498613144885104, -15.10239063576953, -39.19872143962627, -35.2705229929586, -29.114222193627747, -9.535932530123967, -26.119402669744645, -19.57317817598031, -13.285394734973146, -28.90533561663004, -17.178817036501858, -17.559709783876336, -21.82685755206529, -11.301222349800168, -8.606908734510897, -35.55327767936338, -20.80119252159019, -8.065653595643077, -5.885471419962818, -8.71396624118222, -18.951478831868886, -11.511912998038962, -27.533908176579782, -7.783095322803456, -30.66369468691233, -11.732473599296267, -4.956598284433303, -14.061244633236214, -27.210726592920174, -33.22016725542368, -36.56535739296844, -1.4152517430955047, -42.02785206227515, -21.060589128449237, -21.676739190021408, 0.5462791712497754, -22.423297473725697, -11.796523431443688, -26.17262883021351, -0.31821018729318595, -39.90627169354467, 6.049443076676827, -21.938628700356496, -45.071103020676965, -19.20045979951681, -7.763816235434654, -7.840391549969172, -25.28701768227011, -18.561567829019637, -4.86343445544653, -16.96656717211249, -7.601013544575367, -24.525955589583482, -20.129795247805944, 0.5791998093136694, -30.670189467463306, -5.409304723030555, -7.9865715912961885, -1.7147898887144333, -12.772256935441025, 6.082286946416023, -20.966860347227207, -19.971732336147994, -17.896745980981375, -31.986235247866514, -27.987489632496427, -36.34573970953629, -38.33549442938894, -23.06127444625395, -14.824343794986206, -41.51065817745864, -12.169933016416287, -13.018535163178242, -21.822986404580305, -4.24385979515589, -13.381964421800614, -7.5020465753156245, -35.3682091500702, 21.237102178068525, 2.4411522902486684, -18.85032952808794, -28.275976632276304, -22.529432132637133, -11.549547902357997, -7.518736938609455, -23.668667031962997, -19.212287136358462, -28.617140554815194, -32.417508036487106, 6.448704777540868, -3.431329654308268, -9.148900807611334, -26.157501030242557], "policy_predator_policy_reward": [29.896708357472612, 14.519736050745273, 9.087773539746447, 25.3565670850041, 10.521793309239706, 17.540455775768457, 9.345183935569299, 6.498613144885104, 15.10239063576953, 39.19872143962627, 35.2705229929586, 29.114222193627747, 9.535932530123967, 26.119402669744645, 19.57317817598031, 13.285394734973146, 28.90533561663004, 17.178817036501858, 17.559709783876336, 21.82685755206529, 11.301222349800168, 8.606908734510897, 35.55327767936338, 20.80119252159019, 8.065653595643077, 5.885471419962818, 8.71396624118222, 18.951478831868886, 11.511912998038962, 27.533908176579782, 7.783095322803456, 30.66369468691233, 11.732473599296267, 4.956598284433303, 14.061244633236214, 27.210726592920174, 33.22016725542368, 36.56535739296844, 1.4152517430955047, 42.02785206227515, 21.060589128449237, 21.676739190021408, -0.5462791712497754, 22.423297473725697, 11.796523431443688, 26.17262883021351, 0.31821018729318595, 39.90627169354467, -6.049443076676827, 21.938628700356496, 45.071103020676965, 19.20045979951681, 7.763816235434654, 7.840391549969172, 25.28701768227011, 18.561567829019637, 4.86343445544653, 16.96656717211249, 7.601013544575367, 24.525955589583482, 20.129795247805944, -0.5791998093136694, 30.670189467463306, 5.409304723030555, 7.9865715912961885, 1.7147898887144333, 12.772256935441025, -6.082286946416023, 20.966860347227207, 19.971732336147994, 17.896745980981375, 31.986235247866514, 27.987489632496427, 36.34573970953629, 38.33549442938894, 23.06127444625395, 14.824343794986206, 41.51065817745864, 12.169933016416287, 13.018535163178242, 21.822986404580305, 4.24385979515589, 13.381964421800614, 7.5020465753156245, 35.3682091500702, -21.237102178068525, -2.4411522902486684, 18.85032952808794, 28.275976632276304, 22.529432132637133, 11.549547902357997, 7.518736938609455, 23.668667031962997, 19.212287136358462, 28.617140554815194, 32.417508036487106, -6.448704777540868, 3.431329654308268, 9.148900807611334, 26.157501030242557]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.628904954970648, "mean_inference_ms": 2.056668746285088, "mean_action_processing_ms": 0.2579455969483287, "mean_env_wait_ms": 0.16551827965669458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012675046920776367, "StateBufferConnector_ms": 0.00903165340423584, "ViewRequirementAgentConnector_ms": 0.1303088665008545}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 437.78159141801524, "num_env_steps_trained_throughput_per_sec": 437.78159141801524, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 9623.66, "restore_workers_time_ms": 0.041, "training_step_time_ms": 9623.091, "sample_time_ms": 1412.002, "learn_time_ms": 8175.474, "learn_throughput": 489.268, "synch_weights_time_ms": 34.134}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 10, "trial_id": "1f352_00000", "date": "2024-08-11_14-56-21", "timestamp": 1723402581, "time_this_iter_s": 9.201075077056885, "time_total_s": 96.84165287017822, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af487af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 96.84165287017822, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 52.76923076923077, "ram_util_percent": 83.29999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8536119317325452, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.286660724381606, "policy_loss": -0.00525704720178813, "vf_loss": 6.290654564400514, "vf_explained_var": -0.0735897824789087, "kl": 0.004210545943361756, "entropy": 1.3323095245907703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7980200001969933, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.36469844977061, "policy_loss": -0.011502386445984787, "vf_loss": 6.373423175017039, "vf_explained_var": 0.01893328924973806, "kl": 0.009258922966004677, "entropy": 1.4077645289401213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -45.071103020676965, "predator_policy": -21.237102178068525}, "policy_reward_max": {"prey_policy": 21.237102178068525, "predator_policy": 45.071103020676965}, "policy_reward_mean": {"prey_policy": -15.771486471728677, "predator_policy": 15.771486471728677}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.559709783876336, -21.82685755206529, -11.301222349800168, -8.606908734510897, -35.55327767936338, -20.80119252159019, -8.065653595643077, -5.885471419962818, -8.71396624118222, -18.951478831868886, -11.511912998038962, -27.533908176579782, -7.783095322803456, -30.66369468691233, -11.732473599296267, -4.956598284433303, -14.061244633236214, -27.210726592920174, -33.22016725542368, -36.56535739296844, -1.4152517430955047, -42.02785206227515, -21.060589128449237, -21.676739190021408, 0.5462791712497754, -22.423297473725697, -11.796523431443688, -26.17262883021351, -0.31821018729318595, -39.90627169354467, 6.049443076676827, -21.938628700356496, -45.071103020676965, -19.20045979951681, -7.763816235434654, -7.840391549969172, -25.28701768227011, -18.561567829019637, -4.86343445544653, -16.96656717211249, -7.601013544575367, -24.525955589583482, -20.129795247805944, 0.5791998093136694, -30.670189467463306, -5.409304723030555, -7.9865715912961885, -1.7147898887144333, -12.772256935441025, 6.082286946416023, -20.966860347227207, -19.971732336147994, -17.896745980981375, -31.986235247866514, -27.987489632496427, -36.34573970953629, -38.33549442938894, -23.06127444625395, -14.824343794986206, -41.51065817745864, -12.169933016416287, -13.018535163178242, -21.822986404580305, -4.24385979515589, -13.381964421800614, -7.5020465753156245, -35.3682091500702, 21.237102178068525, 2.4411522902486684, -18.85032952808794, -28.275976632276304, -22.529432132637133, -11.549547902357997, -7.518736938609455, -23.668667031962997, -19.212287136358462, -28.617140554815194, -32.417508036487106, 6.448704777540868, -3.431329654308268, -9.148900807611334, -26.157501030242557, -3.306318591484793, -9.484642132617402, -5.082519374355761, 5.080179752117319, -8.67233043865083, -10.404456332731337, -33.373251423881946, -30.998089223732265, 7.153759478677053, -28.706558221476694, -17.050150529078156, 7.414853535317125, 12.411165595407022, -17.139114810285434, -21.92615751120634, 7.954827053670506, -14.146607937740715, -20.880793470462834], "policy_predator_policy_reward": [17.559709783876336, 21.82685755206529, 11.301222349800168, 8.606908734510897, 35.55327767936338, 20.80119252159019, 8.065653595643077, 5.885471419962818, 8.71396624118222, 18.951478831868886, 11.511912998038962, 27.533908176579782, 7.783095322803456, 30.66369468691233, 11.732473599296267, 4.956598284433303, 14.061244633236214, 27.210726592920174, 33.22016725542368, 36.56535739296844, 1.4152517430955047, 42.02785206227515, 21.060589128449237, 21.676739190021408, -0.5462791712497754, 22.423297473725697, 11.796523431443688, 26.17262883021351, 0.31821018729318595, 39.90627169354467, -6.049443076676827, 21.938628700356496, 45.071103020676965, 19.20045979951681, 7.763816235434654, 7.840391549969172, 25.28701768227011, 18.561567829019637, 4.86343445544653, 16.96656717211249, 7.601013544575367, 24.525955589583482, 20.129795247805944, -0.5791998093136694, 30.670189467463306, 5.409304723030555, 7.9865715912961885, 1.7147898887144333, 12.772256935441025, -6.082286946416023, 20.966860347227207, 19.971732336147994, 17.896745980981375, 31.986235247866514, 27.987489632496427, 36.34573970953629, 38.33549442938894, 23.06127444625395, 14.824343794986206, 41.51065817745864, 12.169933016416287, 13.018535163178242, 21.822986404580305, 4.24385979515589, 13.381964421800614, 7.5020465753156245, 35.3682091500702, -21.237102178068525, -2.4411522902486684, 18.85032952808794, 28.275976632276304, 22.529432132637133, 11.549547902357997, 7.518736938609455, 23.668667031962997, 19.212287136358462, 28.617140554815194, 32.417508036487106, -6.448704777540868, 3.431329654308268, 9.148900807611334, 26.157501030242557, 3.306318591484793, 9.484642132617402, 5.082519374355761, -5.080179752117319, 8.67233043865083, 10.404456332731337, 33.373251423881946, 30.998089223732265, -7.153759478677053, 28.706558221476694, 17.050150529078156, -7.414853535317125, -12.411165595407022, 17.139114810285434, 21.92615751120634, -7.954827053670506, 14.146607937740715, 20.880793470462834]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6270538478914602, "mean_inference_ms": 2.0468874345000523, "mean_action_processing_ms": 0.25762534316837615, "mean_env_wait_ms": 0.1633362854639822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012735724449157715, "StateBufferConnector_ms": 0.009131193161010742, "ViewRequirementAgentConnector_ms": 0.12727487087249756}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 361.5358323684852, "num_env_steps_trained_throughput_per_sec": 361.5358323684852, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 9751.642, "restore_workers_time_ms": 0.041, "training_step_time_ms": 9751.072, "sample_time_ms": 1394.299, "learn_time_ms": 8320.081, "learn_throughput": 480.765, "synch_weights_time_ms": 35.293}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 11, "trial_id": "1f352_00000", "date": "2024-08-11_14-56-32", "timestamp": 1723402592, "time_this_iter_s": 11.119004011154175, "time_total_s": 107.9606568813324, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4a7b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 107.9606568813324, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 59.256249999999994, "ram_util_percent": 83.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9464209750605126, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.972834472854932, "policy_loss": -0.004368180067588886, "vf_loss": 5.976333491007487, "vf_explained_var": -0.22079002447426319, "kl": 0.005794379978680836, "entropy": 1.2583663729329904, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9671349693710605, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.177614952127139, "policy_loss": -0.005607042724780816, "vf_loss": 6.181400928397974, "vf_explained_var": -0.04247617640842994, "kl": 0.0060703186258579565, "entropy": 1.3993211470544338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -45.071103020676965, "predator_policy": -21.237102178068525}, "policy_reward_max": {"prey_policy": 21.237102178068525, "predator_policy": 45.071103020676965}, "policy_reward_mean": {"prey_policy": -15.423747011990711, "predator_policy": 15.423747011990711}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-33.22016725542368, -36.56535739296844, -1.4152517430955047, -42.02785206227515, -21.060589128449237, -21.676739190021408, 0.5462791712497754, -22.423297473725697, -11.796523431443688, -26.17262883021351, -0.31821018729318595, -39.90627169354467, 6.049443076676827, -21.938628700356496, -45.071103020676965, -19.20045979951681, -7.763816235434654, -7.840391549969172, -25.28701768227011, -18.561567829019637, -4.86343445544653, -16.96656717211249, -7.601013544575367, -24.525955589583482, -20.129795247805944, 0.5791998093136694, -30.670189467463306, -5.409304723030555, -7.9865715912961885, -1.7147898887144333, -12.772256935441025, 6.082286946416023, -20.966860347227207, -19.971732336147994, -17.896745980981375, -31.986235247866514, -27.987489632496427, -36.34573970953629, -38.33549442938894, -23.06127444625395, -14.824343794986206, -41.51065817745864, -12.169933016416287, -13.018535163178242, -21.822986404580305, -4.24385979515589, -13.381964421800614, -7.5020465753156245, -35.3682091500702, 21.237102178068525, 2.4411522902486684, -18.85032952808794, -28.275976632276304, -22.529432132637133, -11.549547902357997, -7.518736938609455, -23.668667031962997, -19.212287136358462, -28.617140554815194, -32.417508036487106, 6.448704777540868, -3.431329654308268, -9.148900807611334, -26.157501030242557, -3.306318591484793, -9.484642132617402, -5.082519374355761, 5.080179752117319, -8.67233043865083, -10.404456332731337, -33.373251423881946, -30.998089223732265, 7.153759478677053, -28.706558221476694, -17.050150529078156, 7.414853535317125, 12.411165595407022, -17.139114810285434, -21.92615751120634, 7.954827053670506, -14.146607937740715, -20.880793470462834, -15.658335590819476, -0.08822158720370687, -1.4337095217113438, -20.085291178967715, -18.56174926392758, -1.878495170089482, -18.788300899530046, -15.573198222385539, 3.7346966791032203, -35.488407172694316, -28.82370382183408, -4.274236610129655, -21.664230943014694, -8.123264847144133, -7.33369184077504, -3.3918910927292476, -20.62109500602144, -39.89232094041235], "policy_predator_policy_reward": [33.22016725542368, 36.56535739296844, 1.4152517430955047, 42.02785206227515, 21.060589128449237, 21.676739190021408, -0.5462791712497754, 22.423297473725697, 11.796523431443688, 26.17262883021351, 0.31821018729318595, 39.90627169354467, -6.049443076676827, 21.938628700356496, 45.071103020676965, 19.20045979951681, 7.763816235434654, 7.840391549969172, 25.28701768227011, 18.561567829019637, 4.86343445544653, 16.96656717211249, 7.601013544575367, 24.525955589583482, 20.129795247805944, -0.5791998093136694, 30.670189467463306, 5.409304723030555, 7.9865715912961885, 1.7147898887144333, 12.772256935441025, -6.082286946416023, 20.966860347227207, 19.971732336147994, 17.896745980981375, 31.986235247866514, 27.987489632496427, 36.34573970953629, 38.33549442938894, 23.06127444625395, 14.824343794986206, 41.51065817745864, 12.169933016416287, 13.018535163178242, 21.822986404580305, 4.24385979515589, 13.381964421800614, 7.5020465753156245, 35.3682091500702, -21.237102178068525, -2.4411522902486684, 18.85032952808794, 28.275976632276304, 22.529432132637133, 11.549547902357997, 7.518736938609455, 23.668667031962997, 19.212287136358462, 28.617140554815194, 32.417508036487106, -6.448704777540868, 3.431329654308268, 9.148900807611334, 26.157501030242557, 3.306318591484793, 9.484642132617402, 5.082519374355761, -5.080179752117319, 8.67233043865083, 10.404456332731337, 33.373251423881946, 30.998089223732265, -7.153759478677053, 28.706558221476694, 17.050150529078156, -7.414853535317125, -12.411165595407022, 17.139114810285434, 21.92615751120634, -7.954827053670506, 14.146607937740715, 20.880793470462834, 15.658335590819476, 0.08822158720370687, 1.4337095217113438, 20.085291178967715, 18.56174926392758, 1.878495170089482, 18.788300899530046, 15.573198222385539, -3.7346966791032203, 35.488407172694316, 28.82370382183408, 4.274236610129655, 21.664230943014694, 8.123264847144133, 7.33369184077504, 3.3918910927292476, 20.62109500602144, 39.89232094041235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6146111384304619, "mean_inference_ms": 2.0090948119525, "mean_action_processing_ms": 0.2538180566243798, "mean_env_wait_ms": 0.1596024263258813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013461112976074219, "StateBufferConnector_ms": 0.008937478065490723, "ViewRequirementAgentConnector_ms": 0.10644066333770752}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 443.6736370599094, "num_env_steps_trained_throughput_per_sec": 443.6736370599094, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 9689.153, "restore_workers_time_ms": 0.033, "training_step_time_ms": 9688.619, "sample_time_ms": 1303.93, "learn_time_ms": 8347.803, "learn_throughput": 479.168, "synch_weights_time_ms": 35.536}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 12, "trial_id": "1f352_00000", "date": "2024-08-11_14-56-41", "timestamp": 1723402601, "time_this_iter_s": 9.050416707992554, "time_total_s": 117.01107358932495, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af490ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 117.01107358932495, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 51.23846153846153, "ram_util_percent": 83.18461538461537}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.228200207588573, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.481813976665338, "policy_loss": -0.00487393293636463, "vf_loss": 5.48610479136308, "vf_explained_var": 0.15335392113775015, "kl": 0.0038876648318604268, "entropy": 1.2319102515776952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2273902555927636, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.622303032378356, "policy_loss": -0.009813106282672379, "vf_loss": 5.629823849101862, "vf_explained_var": 0.1805453749373555, "kl": 0.0076409686730920506, "entropy": 1.3790398709475995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.51065817745864, "predator_policy": -21.237102178068525}, "policy_reward_max": {"prey_policy": 21.237102178068525, "predator_policy": 41.51065817745864}, "policy_reward_mean": {"prey_policy": -14.908720166166406, "predator_policy": 14.908720166166406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-25.28701768227011, -18.561567829019637, -4.86343445544653, -16.96656717211249, -7.601013544575367, -24.525955589583482, -20.129795247805944, 0.5791998093136694, -30.670189467463306, -5.409304723030555, -7.9865715912961885, -1.7147898887144333, -12.772256935441025, 6.082286946416023, -20.966860347227207, -19.971732336147994, -17.896745980981375, -31.986235247866514, -27.987489632496427, -36.34573970953629, -38.33549442938894, -23.06127444625395, -14.824343794986206, -41.51065817745864, -12.169933016416287, -13.018535163178242, -21.822986404580305, -4.24385979515589, -13.381964421800614, -7.5020465753156245, -35.3682091500702, 21.237102178068525, 2.4411522902486684, -18.85032952808794, -28.275976632276304, -22.529432132637133, -11.549547902357997, -7.518736938609455, -23.668667031962997, -19.212287136358462, -28.617140554815194, -32.417508036487106, 6.448704777540868, -3.431329654308268, -9.148900807611334, -26.157501030242557, -3.306318591484793, -9.484642132617402, -5.082519374355761, 5.080179752117319, -8.67233043865083, -10.404456332731337, -33.373251423881946, -30.998089223732265, 7.153759478677053, -28.706558221476694, -17.050150529078156, 7.414853535317125, 12.411165595407022, -17.139114810285434, -21.92615751120634, 7.954827053670506, -14.146607937740715, -20.880793470462834, -15.658335590819476, -0.08822158720370687, -1.4337095217113438, -20.085291178967715, -18.56174926392758, -1.878495170089482, -18.788300899530046, -15.573198222385539, 3.7346966791032203, -35.488407172694316, -28.82370382183408, -4.274236610129655, -21.664230943014694, -8.123264847144133, -7.33369184077504, -3.3918910927292476, -20.62109500602144, -39.89232094041235, -30.87320857674115, -31.26511115398426, -6.781516949604492, -9.200775641356495, -19.880534332138865, -20.864369465487073, -24.920822058051648, -20.57257158010276, -5.983750786123455, -30.216764643443497, -31.998476940123275, -7.842916826532539, 6.158602505842747, -3.865130091985818, -4.700272741933192, -15.505843136936027, -38.451633442091314, -3.533785003258683], "policy_predator_policy_reward": [25.28701768227011, 18.561567829019637, 4.86343445544653, 16.96656717211249, 7.601013544575367, 24.525955589583482, 20.129795247805944, -0.5791998093136694, 30.670189467463306, 5.409304723030555, 7.9865715912961885, 1.7147898887144333, 12.772256935441025, -6.082286946416023, 20.966860347227207, 19.971732336147994, 17.896745980981375, 31.986235247866514, 27.987489632496427, 36.34573970953629, 38.33549442938894, 23.06127444625395, 14.824343794986206, 41.51065817745864, 12.169933016416287, 13.018535163178242, 21.822986404580305, 4.24385979515589, 13.381964421800614, 7.5020465753156245, 35.3682091500702, -21.237102178068525, -2.4411522902486684, 18.85032952808794, 28.275976632276304, 22.529432132637133, 11.549547902357997, 7.518736938609455, 23.668667031962997, 19.212287136358462, 28.617140554815194, 32.417508036487106, -6.448704777540868, 3.431329654308268, 9.148900807611334, 26.157501030242557, 3.306318591484793, 9.484642132617402, 5.082519374355761, -5.080179752117319, 8.67233043865083, 10.404456332731337, 33.373251423881946, 30.998089223732265, -7.153759478677053, 28.706558221476694, 17.050150529078156, -7.414853535317125, -12.411165595407022, 17.139114810285434, 21.92615751120634, -7.954827053670506, 14.146607937740715, 20.880793470462834, 15.658335590819476, 0.08822158720370687, 1.4337095217113438, 20.085291178967715, 18.56174926392758, 1.878495170089482, 18.788300899530046, 15.573198222385539, -3.7346966791032203, 35.488407172694316, 28.82370382183408, 4.274236610129655, 21.664230943014694, 8.123264847144133, 7.33369184077504, 3.3918910927292476, 20.62109500602144, 39.89232094041235, 30.87320857674115, 31.26511115398426, 6.781516949604492, 9.200775641356495, 19.880534332138865, 20.864369465487073, 24.920822058051648, 20.57257158010276, 5.983750786123455, 30.216764643443497, 31.998476940123275, 7.842916826532539, -6.158602505842747, 3.865130091985818, 4.700272741933192, 15.505843136936027, 38.451633442091314, 3.533785003258683]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6057800609070952, "mean_inference_ms": 1.9838706984275831, "mean_action_processing_ms": 0.250386928978095, "mean_env_wait_ms": 0.15676985337304086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016139864921569824, "StateBufferConnector_ms": 0.008702397346496582, "ViewRequirementAgentConnector_ms": 0.1446472406387329}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.0134520202557, "num_env_steps_trained_throughput_per_sec": 406.0134520202557, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 9827.777, "restore_workers_time_ms": 0.032, "training_step_time_ms": 9827.492, "sample_time_ms": 1370.004, "learn_time_ms": 8420.25, "learn_throughput": 475.045, "synch_weights_time_ms": 35.936}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 13, "trial_id": "1f352_00000", "date": "2024-08-11_14-56-51", "timestamp": 1723402611, "time_this_iter_s": 9.871397972106934, "time_total_s": 126.88247156143188, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b187b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 126.88247156143188, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 53.88571428571428, "ram_util_percent": 83.20714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.285857838081817, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.552774126331012, "policy_loss": -0.007066852359275799, "vf_loss": 5.559127422670524, "vf_explained_var": 0.05130790757636229, "kl": 0.00951410779007542, "entropy": 1.2097184716413418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4509559530764817, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.548237589498361, "policy_loss": -0.007677596794140603, "vf_loss": 5.553977510333061, "vf_explained_var": 0.09408336629470189, "kl": 0.00645894849872202, "entropy": 1.3814985614269972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -43.68221671932391, "predator_policy": -21.237102178068525}, "policy_reward_max": {"prey_policy": 21.237102178068525, "predator_policy": 43.68221671932391}, "policy_reward_mean": {"prey_policy": -14.596067330923496, "predator_policy": 14.596067330923496}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.24385979515589, -13.381964421800614, -7.5020465753156245, -35.3682091500702, 21.237102178068525, 2.4411522902486684, -18.85032952808794, -28.275976632276304, -22.529432132637133, -11.549547902357997, -7.518736938609455, -23.668667031962997, -19.212287136358462, -28.617140554815194, -32.417508036487106, 6.448704777540868, -3.431329654308268, -9.148900807611334, -26.157501030242557, -3.306318591484793, -9.484642132617402, -5.082519374355761, 5.080179752117319, -8.67233043865083, -10.404456332731337, -33.373251423881946, -30.998089223732265, 7.153759478677053, -28.706558221476694, -17.050150529078156, 7.414853535317125, 12.411165595407022, -17.139114810285434, -21.92615751120634, 7.954827053670506, -14.146607937740715, -20.880793470462834, -15.658335590819476, -0.08822158720370687, -1.4337095217113438, -20.085291178967715, -18.56174926392758, -1.878495170089482, -18.788300899530046, -15.573198222385539, 3.7346966791032203, -35.488407172694316, -28.82370382183408, -4.274236610129655, -21.664230943014694, -8.123264847144133, -7.33369184077504, -3.3918910927292476, -20.62109500602144, -39.89232094041235, -30.87320857674115, -31.26511115398426, -6.781516949604492, -9.200775641356495, -19.880534332138865, -20.864369465487073, -24.920822058051648, -20.57257158010276, -5.983750786123455, -30.216764643443497, -31.998476940123275, -7.842916826532539, 6.158602505842747, -3.865130091985818, -4.700272741933192, -15.505843136936027, -38.451633442091314, -3.533785003258683, -39.97375967990517, -1.6897133623759943, -40.733539196120354, -12.170334106291602, -10.629568506927788, -27.138441707872886, -11.425677613609771, -43.68221671932391, -7.467536169574863, -33.876257309744226, -17.515202184911132, 4.022767420298296, -33.294767157930146, -41.18590344395629, -4.705200118733474, -15.524061983193526, -18.449789241905584, -11.243014187351527, -33.28026676347452, -13.342353214221687, 2.483420310716192, -15.039706680797057, -7.3877119821227755, -12.987261201190062, -10.989738820083668, -1.482606871549514, 0.24871795889619275], "policy_predator_policy_reward": [4.24385979515589, 13.381964421800614, 7.5020465753156245, 35.3682091500702, -21.237102178068525, -2.4411522902486684, 18.85032952808794, 28.275976632276304, 22.529432132637133, 11.549547902357997, 7.518736938609455, 23.668667031962997, 19.212287136358462, 28.617140554815194, 32.417508036487106, -6.448704777540868, 3.431329654308268, 9.148900807611334, 26.157501030242557, 3.306318591484793, 9.484642132617402, 5.082519374355761, -5.080179752117319, 8.67233043865083, 10.404456332731337, 33.373251423881946, 30.998089223732265, -7.153759478677053, 28.706558221476694, 17.050150529078156, -7.414853535317125, -12.411165595407022, 17.139114810285434, 21.92615751120634, -7.954827053670506, 14.146607937740715, 20.880793470462834, 15.658335590819476, 0.08822158720370687, 1.4337095217113438, 20.085291178967715, 18.56174926392758, 1.878495170089482, 18.788300899530046, 15.573198222385539, -3.7346966791032203, 35.488407172694316, 28.82370382183408, 4.274236610129655, 21.664230943014694, 8.123264847144133, 7.33369184077504, 3.3918910927292476, 20.62109500602144, 39.89232094041235, 30.87320857674115, 31.26511115398426, 6.781516949604492, 9.200775641356495, 19.880534332138865, 20.864369465487073, 24.920822058051648, 20.57257158010276, 5.983750786123455, 30.216764643443497, 31.998476940123275, 7.842916826532539, -6.158602505842747, 3.865130091985818, 4.700272741933192, 15.505843136936027, 38.451633442091314, 3.533785003258683, 39.97375967990517, 1.6897133623759943, 40.733539196120354, 12.170334106291602, 10.629568506927788, 27.138441707872886, 11.425677613609771, 43.68221671932391, 7.467536169574863, 33.876257309744226, 17.515202184911132, -4.022767420298296, 33.294767157930146, 41.18590344395629, 4.705200118733474, 15.524061983193526, 18.449789241905584, 11.243014187351527, 33.28026676347452, 13.342353214221687, -2.483420310716192, 15.039706680797057, 7.3877119821227755, 12.987261201190062, 10.989738820083668, 1.482606871549514, -0.24871795889619275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6015006517469451, "mean_inference_ms": 1.9692674735409796, "mean_action_processing_ms": 0.24837717292513975, "mean_env_wait_ms": 0.15443321742257285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016435861587524414, "StateBufferConnector_ms": 0.008850932121276855, "ViewRequirementAgentConnector_ms": 0.15327584743499756}, "num_episodes": 27, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 401.2691777146813, "num_env_steps_trained_throughput_per_sec": 401.2691777146813, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 9945.232, "restore_workers_time_ms": 0.033, "training_step_time_ms": 9944.937, "sample_time_ms": 1355.441, "learn_time_ms": 8551.967, "learn_throughput": 467.729, "synch_weights_time_ms": 36.151}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 14, "trial_id": "1f352_00000", "date": "2024-08-11_14-57-01", "timestamp": 1723402621, "time_this_iter_s": 9.99565601348877, "time_total_s": 136.87812757492065, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4e30d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 136.87812757492065, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 55.41428571428571, "ram_util_percent": 83.34285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4399765536809963, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.455434518059095, "policy_loss": -0.005612402062979527, "vf_loss": 5.460528343915939, "vf_explained_var": 0.1368320565049847, "kl": 0.006914484432611326, "entropy": 1.1684872856984536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5668410025537014, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.424233722438415, "policy_loss": -0.006544776661515547, "vf_loss": 5.429176993171374, "vf_explained_var": 0.22077078421910604, "kl": 0.0053383393359032255, "entropy": 1.3330232011775176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.86977208225172, "predator_policy": -12.411165595407022}, "policy_reward_max": {"prey_policy": 12.411165595407022, "predator_policy": 50.86977208225172}, "policy_reward_mean": {"prey_policy": -16.12129637495126, "predator_policy": 16.12129637495126}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.157501030242557, -3.306318591484793, -9.484642132617402, -5.082519374355761, 5.080179752117319, -8.67233043865083, -10.404456332731337, -33.373251423881946, -30.998089223732265, 7.153759478677053, -28.706558221476694, -17.050150529078156, 7.414853535317125, 12.411165595407022, -17.139114810285434, -21.92615751120634, 7.954827053670506, -14.146607937740715, -20.880793470462834, -15.658335590819476, -0.08822158720370687, -1.4337095217113438, -20.085291178967715, -18.56174926392758, -1.878495170089482, -18.788300899530046, -15.573198222385539, 3.7346966791032203, -35.488407172694316, -28.82370382183408, -4.274236610129655, -21.664230943014694, -8.123264847144133, -7.33369184077504, -3.3918910927292476, -20.62109500602144, -39.89232094041235, -30.87320857674115, -31.26511115398426, -6.781516949604492, -9.200775641356495, -19.880534332138865, -20.864369465487073, -24.920822058051648, -20.57257158010276, -5.983750786123455, -30.216764643443497, -31.998476940123275, -7.842916826532539, 6.158602505842747, -3.865130091985818, -4.700272741933192, -15.505843136936027, -38.451633442091314, -3.533785003258683, -39.97375967990517, -1.6897133623759943, -40.733539196120354, -12.170334106291602, -10.629568506927788, -27.138441707872886, -11.425677613609771, -43.68221671932391, -7.467536169574863, -33.876257309744226, -17.515202184911132, 4.022767420298296, -33.294767157930146, -41.18590344395629, -4.705200118733474, -15.524061983193526, -18.449789241905584, -11.243014187351527, -33.28026676347452, -13.342353214221687, 2.483420310716192, -15.039706680797057, -7.3877119821227755, -12.987261201190062, -10.989738820083668, -1.482606871549514, 0.24871795889619275, -40.811194399110846, -37.51507516227725, -11.177766612114052, -34.41484436569276, -11.075209102290628, -18.868684611483793, -22.544758687305805, -40.61520805807151, -50.86977208225172, 2.7485279509409812, -5.660793102559035, -28.103214555778504, -20.800300456251932, -31.564003096124523, -11.821431713346463, -20.44895679466463, -5.971010868441178, 1.401814262051154], "policy_predator_policy_reward": [26.157501030242557, 3.306318591484793, 9.484642132617402, 5.082519374355761, -5.080179752117319, 8.67233043865083, 10.404456332731337, 33.373251423881946, 30.998089223732265, -7.153759478677053, 28.706558221476694, 17.050150529078156, -7.414853535317125, -12.411165595407022, 17.139114810285434, 21.92615751120634, -7.954827053670506, 14.146607937740715, 20.880793470462834, 15.658335590819476, 0.08822158720370687, 1.4337095217113438, 20.085291178967715, 18.56174926392758, 1.878495170089482, 18.788300899530046, 15.573198222385539, -3.7346966791032203, 35.488407172694316, 28.82370382183408, 4.274236610129655, 21.664230943014694, 8.123264847144133, 7.33369184077504, 3.3918910927292476, 20.62109500602144, 39.89232094041235, 30.87320857674115, 31.26511115398426, 6.781516949604492, 9.200775641356495, 19.880534332138865, 20.864369465487073, 24.920822058051648, 20.57257158010276, 5.983750786123455, 30.216764643443497, 31.998476940123275, 7.842916826532539, -6.158602505842747, 3.865130091985818, 4.700272741933192, 15.505843136936027, 38.451633442091314, 3.533785003258683, 39.97375967990517, 1.6897133623759943, 40.733539196120354, 12.170334106291602, 10.629568506927788, 27.138441707872886, 11.425677613609771, 43.68221671932391, 7.467536169574863, 33.876257309744226, 17.515202184911132, -4.022767420298296, 33.294767157930146, 41.18590344395629, 4.705200118733474, 15.524061983193526, 18.449789241905584, 11.243014187351527, 33.28026676347452, 13.342353214221687, -2.483420310716192, 15.039706680797057, 7.3877119821227755, 12.987261201190062, 10.989738820083668, 1.482606871549514, -0.24871795889619275, 40.811194399110846, 37.51507516227725, 11.177766612114052, 34.41484436569276, 11.075209102290628, 18.868684611483793, 22.544758687305805, 40.61520805807151, 50.86977208225172, -2.7485279509409812, 5.660793102559035, 28.103214555778504, 20.800300456251932, 31.564003096124523, 11.821431713346463, 20.44895679466463, 5.971010868441178, -1.401814262051154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5990862075049872, "mean_inference_ms": 1.9749610786844836, "mean_action_processing_ms": 0.24881253445756152, "mean_env_wait_ms": 0.1538837609029453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007562756538391113, "StateBufferConnector_ms": 0.0037546157836914062, "ViewRequirementAgentConnector_ms": 0.13248956203460693}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 407.2692288281534, "num_env_steps_trained_throughput_per_sec": 407.2692288281534, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 9915.813, "restore_workers_time_ms": 0.034, "training_step_time_ms": 9915.434, "sample_time_ms": 1369.574, "learn_time_ms": 8506.871, "learn_throughput": 470.208, "synch_weights_time_ms": 37.407}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 15, "trial_id": "1f352_00000", "date": "2024-08-11_14-57-11", "timestamp": 1723402631, "time_this_iter_s": 9.874715089797974, "time_total_s": 146.75284266471863, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b187b280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 146.75284266471863, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 54.89999999999999, "ram_util_percent": 83.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3930731712219617, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.426237211128076, "policy_loss": -0.003889265758334659, "vf_loss": 5.4295500407616295, "vf_explained_var": 0.41431478355079887, "kl": 0.007685957698014789, "entropy": 1.136794105793039, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6566219363982477, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.450389004747072, "policy_loss": -0.005814560444559902, "vf_loss": 5.454576224585375, "vf_explained_var": 0.44760677771021923, "kl": 0.005424408128807404, "entropy": 1.3046780834595362, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.86977208225172, "predator_policy": -23.214878381560926}, "policy_reward_max": {"prey_policy": 23.214878381560926, "predator_policy": 50.86977208225172}, "policy_reward_mean": {"prey_policy": -15.44181217038207, "predator_policy": 15.44181217038207}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.880793470462834, -15.658335590819476, -0.08822158720370687, -1.4337095217113438, -20.085291178967715, -18.56174926392758, -1.878495170089482, -18.788300899530046, -15.573198222385539, 3.7346966791032203, -35.488407172694316, -28.82370382183408, -4.274236610129655, -21.664230943014694, -8.123264847144133, -7.33369184077504, -3.3918910927292476, -20.62109500602144, -39.89232094041235, -30.87320857674115, -31.26511115398426, -6.781516949604492, -9.200775641356495, -19.880534332138865, -20.864369465487073, -24.920822058051648, -20.57257158010276, -5.983750786123455, -30.216764643443497, -31.998476940123275, -7.842916826532539, 6.158602505842747, -3.865130091985818, -4.700272741933192, -15.505843136936027, -38.451633442091314, -3.533785003258683, -39.97375967990517, -1.6897133623759943, -40.733539196120354, -12.170334106291602, -10.629568506927788, -27.138441707872886, -11.425677613609771, -43.68221671932391, -7.467536169574863, -33.876257309744226, -17.515202184911132, 4.022767420298296, -33.294767157930146, -41.18590344395629, -4.705200118733474, -15.524061983193526, -18.449789241905584, -11.243014187351527, -33.28026676347452, -13.342353214221687, 2.483420310716192, -15.039706680797057, -7.3877119821227755, -12.987261201190062, -10.989738820083668, -1.482606871549514, 0.24871795889619275, -40.811194399110846, -37.51507516227725, -11.177766612114052, -34.41484436569276, -11.075209102290628, -18.868684611483793, -22.544758687305805, -40.61520805807151, -50.86977208225172, 2.7485279509409812, -5.660793102559035, -28.103214555778504, -20.800300456251932, -31.564003096124523, -11.821431713346463, -20.44895679466463, -5.971010868441178, 1.401814262051154, -18.003689547583534, -19.197882168688206, 1.8047869720753162, -22.042317554788156, -26.69376131612736, -3.905889391038409, -31.120620197338475, -24.53778090856309, 8.180881772290842, -7.8735126941581575, 17.345857859749216, -9.100827892103812, 7.441736908766753, -12.038103931868907, -9.457636120268809, 23.214878381560926, 13.92489759687074, -6.425509454163652], "policy_predator_policy_reward": [20.880793470462834, 15.658335590819476, 0.08822158720370687, 1.4337095217113438, 20.085291178967715, 18.56174926392758, 1.878495170089482, 18.788300899530046, 15.573198222385539, -3.7346966791032203, 35.488407172694316, 28.82370382183408, 4.274236610129655, 21.664230943014694, 8.123264847144133, 7.33369184077504, 3.3918910927292476, 20.62109500602144, 39.89232094041235, 30.87320857674115, 31.26511115398426, 6.781516949604492, 9.200775641356495, 19.880534332138865, 20.864369465487073, 24.920822058051648, 20.57257158010276, 5.983750786123455, 30.216764643443497, 31.998476940123275, 7.842916826532539, -6.158602505842747, 3.865130091985818, 4.700272741933192, 15.505843136936027, 38.451633442091314, 3.533785003258683, 39.97375967990517, 1.6897133623759943, 40.733539196120354, 12.170334106291602, 10.629568506927788, 27.138441707872886, 11.425677613609771, 43.68221671932391, 7.467536169574863, 33.876257309744226, 17.515202184911132, -4.022767420298296, 33.294767157930146, 41.18590344395629, 4.705200118733474, 15.524061983193526, 18.449789241905584, 11.243014187351527, 33.28026676347452, 13.342353214221687, -2.483420310716192, 15.039706680797057, 7.3877119821227755, 12.987261201190062, 10.989738820083668, 1.482606871549514, -0.24871795889619275, 40.811194399110846, 37.51507516227725, 11.177766612114052, 34.41484436569276, 11.075209102290628, 18.868684611483793, 22.544758687305805, 40.61520805807151, 50.86977208225172, -2.7485279509409812, 5.660793102559035, 28.103214555778504, 20.800300456251932, 31.564003096124523, 11.821431713346463, 20.44895679466463, 5.971010868441178, -1.401814262051154, 18.003689547583534, 19.197882168688206, -1.8047869720753162, 22.042317554788156, 26.69376131612736, 3.905889391038409, 31.120620197338475, 24.53778090856309, -8.180881772290842, 7.8735126941581575, -17.345857859749216, 9.100827892103812, -7.441736908766753, 12.038103931868907, 9.457636120268809, -23.214878381560926, -13.92489759687074, 6.425509454163652]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5962987625213946, "mean_inference_ms": 1.9704099719077584, "mean_action_processing_ms": 0.24819224934030984, "mean_env_wait_ms": 0.15312987916110984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007572650909423828, "StateBufferConnector_ms": 0.0036314725875854492, "ViewRequirementAgentConnector_ms": 0.1335761547088623}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 408.5785536159601, "num_env_steps_trained_throughput_per_sec": 408.5785536159601, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 9962.464, "restore_workers_time_ms": 0.022, "training_step_time_ms": 9962.133, "sample_time_ms": 1375.761, "learn_time_ms": 8547.584, "learn_throughput": 467.968, "synch_weights_time_ms": 37.219}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 16, "trial_id": "1f352_00000", "date": "2024-08-11_14-57-21", "timestamp": 1723402641, "time_this_iter_s": 9.855104684829712, "time_total_s": 156.60794734954834, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af490ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 156.60794734954834, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 53.25000000000001, "ram_util_percent": 83.26428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.726653699638943, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.464740710457166, "policy_loss": -0.004476211687627559, "vf_loss": 5.468626897037029, "vf_explained_var": 0.4459754188855489, "kl": 0.007867060018410517, "entropy": 1.0528571677704652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8965299578383563, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.367536276330551, "policy_loss": -0.006216765191978387, "vf_loss": 5.372132304807504, "vf_explained_var": 0.47415175624191763, "kl": 0.005402477431281453, "entropy": 1.2926279968271652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.86977208225172, "predator_policy": -23.214878381560926}, "policy_reward_max": {"prey_policy": 23.214878381560926, "predator_policy": 50.86977208225172}, "policy_reward_mean": {"prey_policy": -16.16531333354501, "predator_policy": 16.16531333354501}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-39.89232094041235, -30.87320857674115, -31.26511115398426, -6.781516949604492, -9.200775641356495, -19.880534332138865, -20.864369465487073, -24.920822058051648, -20.57257158010276, -5.983750786123455, -30.216764643443497, -31.998476940123275, -7.842916826532539, 6.158602505842747, -3.865130091985818, -4.700272741933192, -15.505843136936027, -38.451633442091314, -3.533785003258683, -39.97375967990517, -1.6897133623759943, -40.733539196120354, -12.170334106291602, -10.629568506927788, -27.138441707872886, -11.425677613609771, -43.68221671932391, -7.467536169574863, -33.876257309744226, -17.515202184911132, 4.022767420298296, -33.294767157930146, -41.18590344395629, -4.705200118733474, -15.524061983193526, -18.449789241905584, -11.243014187351527, -33.28026676347452, -13.342353214221687, 2.483420310716192, -15.039706680797057, -7.3877119821227755, -12.987261201190062, -10.989738820083668, -1.482606871549514, 0.24871795889619275, -40.811194399110846, -37.51507516227725, -11.177766612114052, -34.41484436569276, -11.075209102290628, -18.868684611483793, -22.544758687305805, -40.61520805807151, -50.86977208225172, 2.7485279509409812, -5.660793102559035, -28.103214555778504, -20.800300456251932, -31.564003096124523, -11.821431713346463, -20.44895679466463, -5.971010868441178, 1.401814262051154, -18.003689547583534, -19.197882168688206, 1.8047869720753162, -22.042317554788156, -26.69376131612736, -3.905889391038409, -31.120620197338475, -24.53778090856309, 8.180881772290842, -7.8735126941581575, 17.345857859749216, -9.100827892103812, 7.441736908766753, -12.038103931868907, -9.457636120268809, 23.214878381560926, 13.92489759687074, -6.425509454163652, -9.85068875828845, -33.86098915470138, -31.100223980965996, -5.961954873651434, -14.2208275110134, -11.583502344693489, -25.755680081794473, -20.881786356533794, -2.81789421877496, -9.089040771177451, -12.18045348164218, -20.78532478552344, -22.754969717987837, -14.810120824604603, -44.94704504264707, -15.46569163136945, -1.1435265933676515, -14.074315747893822], "policy_predator_policy_reward": [39.89232094041235, 30.87320857674115, 31.26511115398426, 6.781516949604492, 9.200775641356495, 19.880534332138865, 20.864369465487073, 24.920822058051648, 20.57257158010276, 5.983750786123455, 30.216764643443497, 31.998476940123275, 7.842916826532539, -6.158602505842747, 3.865130091985818, 4.700272741933192, 15.505843136936027, 38.451633442091314, 3.533785003258683, 39.97375967990517, 1.6897133623759943, 40.733539196120354, 12.170334106291602, 10.629568506927788, 27.138441707872886, 11.425677613609771, 43.68221671932391, 7.467536169574863, 33.876257309744226, 17.515202184911132, -4.022767420298296, 33.294767157930146, 41.18590344395629, 4.705200118733474, 15.524061983193526, 18.449789241905584, 11.243014187351527, 33.28026676347452, 13.342353214221687, -2.483420310716192, 15.039706680797057, 7.3877119821227755, 12.987261201190062, 10.989738820083668, 1.482606871549514, -0.24871795889619275, 40.811194399110846, 37.51507516227725, 11.177766612114052, 34.41484436569276, 11.075209102290628, 18.868684611483793, 22.544758687305805, 40.61520805807151, 50.86977208225172, -2.7485279509409812, 5.660793102559035, 28.103214555778504, 20.800300456251932, 31.564003096124523, 11.821431713346463, 20.44895679466463, 5.971010868441178, -1.401814262051154, 18.003689547583534, 19.197882168688206, -1.8047869720753162, 22.042317554788156, 26.69376131612736, 3.905889391038409, 31.120620197338475, 24.53778090856309, -8.180881772290842, 7.8735126941581575, -17.345857859749216, 9.100827892103812, -7.441736908766753, 12.038103931868907, 9.457636120268809, -23.214878381560926, -13.92489759687074, 6.425509454163652, 9.85068875828845, 33.86098915470138, 31.100223980965996, 5.961954873651434, 14.2208275110134, 11.583502344693489, 25.755680081794473, 20.881786356533794, 2.81789421877496, 9.089040771177451, 12.18045348164218, 20.78532478552344, 22.754969717987837, 14.810120824604603, 44.94704504264707, 15.46569163136945, 1.1435265933676515, 14.074315747893822]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5942818472355854, "mean_inference_ms": 1.9670408639908816, "mean_action_processing_ms": 0.24780243753093764, "mean_env_wait_ms": 0.15267828747104567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006598472595214844, "StateBufferConnector_ms": 0.0036493539810180664, "ViewRequirementAgentConnector_ms": 0.13024020195007324}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.8191882333993, "num_env_steps_trained_throughput_per_sec": 406.8191882333993, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 9849.652, "restore_workers_time_ms": 0.021, "training_step_time_ms": 9849.326, "sample_time_ms": 1263.046, "learn_time_ms": 8549.763, "learn_throughput": 467.849, "synch_weights_time_ms": 34.978}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 17, "trial_id": "1f352_00000", "date": "2024-08-11_14-57-31", "timestamp": 1723402651, "time_this_iter_s": 9.902508974075317, "time_total_s": 166.51045632362366, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4a7430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 166.51045632362366, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 55.51428571428572, "ram_util_percent": 83.29285714285717}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7140062168861427, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.53457631021738, "policy_loss": -0.005786112584367705, "vf_loss": 4.5398747923473515, "vf_explained_var": 0.3941453216597438, "kl": 0.006501883577716919, "entropy": 1.0237049963946143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8928205934663613, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.5732254482805725, "policy_loss": -0.010977308371608766, "vf_loss": 4.582104005664587, "vf_explained_var": 0.4308696099246542, "kl": 0.0069958825961722315, "entropy": 1.2740080152948698, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.86977208225172, "predator_policy": -23.214878381560926}, "policy_reward_max": {"prey_policy": 23.214878381560926, "predator_policy": 50.86977208225172}, "policy_reward_mean": {"prey_policy": -15.694705935859124, "predator_policy": 15.694705935859124}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.170334106291602, -10.629568506927788, -27.138441707872886, -11.425677613609771, -43.68221671932391, -7.467536169574863, -33.876257309744226, -17.515202184911132, 4.022767420298296, -33.294767157930146, -41.18590344395629, -4.705200118733474, -15.524061983193526, -18.449789241905584, -11.243014187351527, -33.28026676347452, -13.342353214221687, 2.483420310716192, -15.039706680797057, -7.3877119821227755, -12.987261201190062, -10.989738820083668, -1.482606871549514, 0.24871795889619275, -40.811194399110846, -37.51507516227725, -11.177766612114052, -34.41484436569276, -11.075209102290628, -18.868684611483793, -22.544758687305805, -40.61520805807151, -50.86977208225172, 2.7485279509409812, -5.660793102559035, -28.103214555778504, -20.800300456251932, -31.564003096124523, -11.821431713346463, -20.44895679466463, -5.971010868441178, 1.401814262051154, -18.003689547583534, -19.197882168688206, 1.8047869720753162, -22.042317554788156, -26.69376131612736, -3.905889391038409, -31.120620197338475, -24.53778090856309, 8.180881772290842, -7.8735126941581575, 17.345857859749216, -9.100827892103812, 7.441736908766753, -12.038103931868907, -9.457636120268809, 23.214878381560926, 13.92489759687074, -6.425509454163652, -9.85068875828845, -33.86098915470138, -31.100223980965996, -5.961954873651434, -14.2208275110134, -11.583502344693489, -25.755680081794473, -20.881786356533794, -2.81789421877496, -9.089040771177451, -12.18045348164218, -20.78532478552344, -22.754969717987837, -14.810120824604603, -44.94704504264707, -15.46569163136945, -1.1435265933676515, -14.074315747893822, -11.590029231293276, -23.485969120165798, -48.67577730007375, -9.067615917804991, -16.484348131157333, -24.31580441862552, -2.1735142841400723, -15.69695948568235, 4.096621251300524, 1.7448442489133793, -20.959317030143097, -27.40164709535783, -19.127648009783535, -10.646364658846114, -12.930760654084978, -31.904618657294378, -6.33975729623981, -18.73388965878504, 7.819581649776185, -36.03369764333105, -18.416068012208214, -35.20473481924957], "policy_predator_policy_reward": [12.170334106291602, 10.629568506927788, 27.138441707872886, 11.425677613609771, 43.68221671932391, 7.467536169574863, 33.876257309744226, 17.515202184911132, -4.022767420298296, 33.294767157930146, 41.18590344395629, 4.705200118733474, 15.524061983193526, 18.449789241905584, 11.243014187351527, 33.28026676347452, 13.342353214221687, -2.483420310716192, 15.039706680797057, 7.3877119821227755, 12.987261201190062, 10.989738820083668, 1.482606871549514, -0.24871795889619275, 40.811194399110846, 37.51507516227725, 11.177766612114052, 34.41484436569276, 11.075209102290628, 18.868684611483793, 22.544758687305805, 40.61520805807151, 50.86977208225172, -2.7485279509409812, 5.660793102559035, 28.103214555778504, 20.800300456251932, 31.564003096124523, 11.821431713346463, 20.44895679466463, 5.971010868441178, -1.401814262051154, 18.003689547583534, 19.197882168688206, -1.8047869720753162, 22.042317554788156, 26.69376131612736, 3.905889391038409, 31.120620197338475, 24.53778090856309, -8.180881772290842, 7.8735126941581575, -17.345857859749216, 9.100827892103812, -7.441736908766753, 12.038103931868907, 9.457636120268809, -23.214878381560926, -13.92489759687074, 6.425509454163652, 9.85068875828845, 33.86098915470138, 31.100223980965996, 5.961954873651434, 14.2208275110134, 11.583502344693489, 25.755680081794473, 20.881786356533794, 2.81789421877496, 9.089040771177451, 12.18045348164218, 20.78532478552344, 22.754969717987837, 14.810120824604603, 44.94704504264707, 15.46569163136945, 1.1435265933676515, 14.074315747893822, 11.590029231293276, 23.485969120165798, 48.67577730007375, 9.067615917804991, 16.484348131157333, 24.31580441862552, 2.1735142841400723, 15.69695948568235, -4.096621251300524, -1.7448442489133793, 20.959317030143097, 27.40164709535783, 19.127648009783535, 10.646364658846114, 12.930760654084978, 31.904618657294378, 6.33975729623981, 18.73388965878504, -7.819581649776185, 36.03369764333105, 18.416068012208214, 35.20473481924957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5909895336048074, "mean_inference_ms": 1.949731037992975, "mean_action_processing_ms": 0.24599031946828595, "mean_env_wait_ms": 0.151360605440268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038820505142211914, "StateBufferConnector_ms": 0.0038269758224487305, "ViewRequirementAgentConnector_ms": 0.0836033821105957}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 387.64494850860393, "num_env_steps_trained_throughput_per_sec": 387.64494850860393, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 9862.02, "restore_workers_time_ms": 0.022, "training_step_time_ms": 9861.807, "sample_time_ms": 1253.515, "learn_time_ms": 8582.563, "learn_throughput": 466.061, "synch_weights_time_ms": 24.455}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 18, "trial_id": "1f352_00000", "date": "2024-08-11_14-57-41", "timestamp": 1723402661, "time_this_iter_s": 10.386157035827637, "time_total_s": 176.8966133594513, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af487b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 176.8966133594513, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 58.60666666666666, "ram_util_percent": 83.20666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.747044707338015, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.078427198777596, "policy_loss": -0.005296601794543676, "vf_loss": 5.0831649720668795, "vf_explained_var": 0.4213437525555491, "kl": 0.007451166319114765, "entropy": 0.9284033898885051, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.974333710471789, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.011033568034569, "policy_loss": -0.006786061702587176, "vf_loss": 5.016599875440201, "vf_explained_var": 0.46919107797245185, "kl": 0.004065879302892839, "entropy": 1.2232782846937578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.86977208225172, "predator_policy": -23.214878381560926}, "policy_reward_max": {"prey_policy": 23.214878381560926, "predator_policy": 50.86977208225172}, "policy_reward_mean": {"prey_policy": -17.118466378499047, "predator_policy": 17.118466378499047}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.24871795889619275, -40.811194399110846, -37.51507516227725, -11.177766612114052, -34.41484436569276, -11.075209102290628, -18.868684611483793, -22.544758687305805, -40.61520805807151, -50.86977208225172, 2.7485279509409812, -5.660793102559035, -28.103214555778504, -20.800300456251932, -31.564003096124523, -11.821431713346463, -20.44895679466463, -5.971010868441178, 1.401814262051154, -18.003689547583534, -19.197882168688206, 1.8047869720753162, -22.042317554788156, -26.69376131612736, -3.905889391038409, -31.120620197338475, -24.53778090856309, 8.180881772290842, -7.8735126941581575, 17.345857859749216, -9.100827892103812, 7.441736908766753, -12.038103931868907, -9.457636120268809, 23.214878381560926, 13.92489759687074, -6.425509454163652, -9.85068875828845, -33.86098915470138, -31.100223980965996, -5.961954873651434, -14.2208275110134, -11.583502344693489, -25.755680081794473, -20.881786356533794, -2.81789421877496, -9.089040771177451, -12.18045348164218, -20.78532478552344, -22.754969717987837, -14.810120824604603, -44.94704504264707, -15.46569163136945, -1.1435265933676515, -14.074315747893822, -11.590029231293276, -23.485969120165798, -48.67577730007375, -9.067615917804991, -16.484348131157333, -24.31580441862552, -2.1735142841400723, -15.69695948568235, 4.096621251300524, 1.7448442489133793, -20.959317030143097, -27.40164709535783, -19.127648009783535, -10.646364658846114, -12.930760654084978, -31.904618657294378, -6.33975729623981, -18.73388965878504, 7.819581649776185, -36.03369764333105, -18.416068012208214, -35.20473481924957, -45.31953680653574, -4.364745788997385, 0.9880686441976678, -20.05719437258518, -11.486719769538396, -12.53924669643246, -28.18188942836094, -23.53500378915532, -23.058032646777264, -40.02456879765509, -12.38317055942661, -24.084333378425406, 1.6643796529819914, -38.683159816587725, -37.47780775625613, -23.57155281690223, 0.48009987913867747, -45.39298751909394, -13.238244935141006, -43.38467220712531, -17.404239122244707, -40.69791772877876, -16.934996758042786], "policy_predator_policy_reward": [-0.24871795889619275, 40.811194399110846, 37.51507516227725, 11.177766612114052, 34.41484436569276, 11.075209102290628, 18.868684611483793, 22.544758687305805, 40.61520805807151, 50.86977208225172, -2.7485279509409812, 5.660793102559035, 28.103214555778504, 20.800300456251932, 31.564003096124523, 11.821431713346463, 20.44895679466463, 5.971010868441178, -1.401814262051154, 18.003689547583534, 19.197882168688206, -1.8047869720753162, 22.042317554788156, 26.69376131612736, 3.905889391038409, 31.120620197338475, 24.53778090856309, -8.180881772290842, 7.8735126941581575, -17.345857859749216, 9.100827892103812, -7.441736908766753, 12.038103931868907, 9.457636120268809, -23.214878381560926, -13.92489759687074, 6.425509454163652, 9.85068875828845, 33.86098915470138, 31.100223980965996, 5.961954873651434, 14.2208275110134, 11.583502344693489, 25.755680081794473, 20.881786356533794, 2.81789421877496, 9.089040771177451, 12.18045348164218, 20.78532478552344, 22.754969717987837, 14.810120824604603, 44.94704504264707, 15.46569163136945, 1.1435265933676515, 14.074315747893822, 11.590029231293276, 23.485969120165798, 48.67577730007375, 9.067615917804991, 16.484348131157333, 24.31580441862552, 2.1735142841400723, 15.69695948568235, -4.096621251300524, -1.7448442489133793, 20.959317030143097, 27.40164709535783, 19.127648009783535, 10.646364658846114, 12.930760654084978, 31.904618657294378, 6.33975729623981, 18.73388965878504, -7.819581649776185, 36.03369764333105, 18.416068012208214, 35.20473481924957, 45.31953680653574, 4.364745788997385, -0.9880686441976678, 20.05719437258518, 11.486719769538396, 12.53924669643246, 28.18188942836094, 23.53500378915532, 23.058032646777264, 40.02456879765509, 12.38317055942661, 24.084333378425406, -1.6643796529819914, 38.683159816587725, 37.47780775625613, 23.57155281690223, -0.48009987913867747, 45.39298751909394, 13.238244935141006, 43.38467220712531, 17.404239122244707, 40.69791772877876, 16.934996758042786]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5828810664501622, "mean_inference_ms": 1.9293034331619745, "mean_action_processing_ms": 0.24334994473190494, "mean_env_wait_ms": 0.14963238625259737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006310701370239258, "StateBufferConnector_ms": 0.004713177680969238, "ViewRequirementAgentConnector_ms": 0.0874638557434082}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 401.8044251899703, "num_env_steps_trained_throughput_per_sec": 401.8044251899703, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 9875.623, "restore_workers_time_ms": 0.022, "training_step_time_ms": 9875.211, "sample_time_ms": 1272.732, "learn_time_ms": 8575.978, "learn_throughput": 466.419, "synch_weights_time_ms": 25.093}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 19, "trial_id": "1f352_00000", "date": "2024-08-11_14-57-51", "timestamp": 1723402671, "time_this_iter_s": 10.044169902801514, "time_total_s": 186.9407832622528, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4e33a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 186.9407832622528, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 53.971428571428554, "ram_util_percent": 83.16428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8956482596695423, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.63996211240689, "policy_loss": -0.006718750245636329, "vf_loss": 4.645969983687004, "vf_explained_var": 0.46953323675940434, "kl": 0.009478370618325885, "entropy": 0.9243991843114296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.141294411321481, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.5018494014938675, "policy_loss": -0.007368125515495194, "vf_loss": 4.507946569224199, "vf_explained_var": 0.5595360910519958, "kl": 0.008473005946420696, "entropy": 1.2051451578736305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -48.67577730007375, "predator_policy": -23.214878381560926}, "policy_reward_max": {"prey_policy": 23.214878381560926, "predator_policy": 48.67577730007375}, "policy_reward_mean": {"prey_policy": -15.968086425701465, "predator_policy": 15.968086425701465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.401814262051154, -18.003689547583534, -19.197882168688206, 1.8047869720753162, -22.042317554788156, -26.69376131612736, -3.905889391038409, -31.120620197338475, -24.53778090856309, 8.180881772290842, -7.8735126941581575, 17.345857859749216, -9.100827892103812, 7.441736908766753, -12.038103931868907, -9.457636120268809, 23.214878381560926, 13.92489759687074, -6.425509454163652, -9.85068875828845, -33.86098915470138, -31.100223980965996, -5.961954873651434, -14.2208275110134, -11.583502344693489, -25.755680081794473, -20.881786356533794, -2.81789421877496, -9.089040771177451, -12.18045348164218, -20.78532478552344, -22.754969717987837, -14.810120824604603, -44.94704504264707, -15.46569163136945, -1.1435265933676515, -14.074315747893822, -11.590029231293276, -23.485969120165798, -48.67577730007375, -9.067615917804991, -16.484348131157333, -24.31580441862552, -2.1735142841400723, -15.69695948568235, 4.096621251300524, 1.7448442489133793, -20.959317030143097, -27.40164709535783, -19.127648009783535, -10.646364658846114, -12.930760654084978, -31.904618657294378, -6.33975729623981, -18.73388965878504, 7.819581649776185, -36.03369764333105, -18.416068012208214, -35.20473481924957, -45.31953680653574, -4.364745788997385, 0.9880686441976678, -20.05719437258518, -11.486719769538396, -12.53924669643246, -28.18188942836094, -23.53500378915532, -23.058032646777264, -40.02456879765509, -12.38317055942661, -24.084333378425406, 1.6643796529819914, -38.683159816587725, -37.47780775625613, -23.57155281690223, 0.48009987913867747, -45.39298751909394, -13.238244935141006, -43.38467220712531, -17.404239122244707, -40.69791772877876, -16.934996758042786, -4.621152533922892, -16.63016865329354, -32.857658872675046, -16.226868352919716, -14.173021008585215, -13.769566338001503, -27.44901368889435, -21.189373149270534, -25.705138614032737, -23.15349810618865, -8.641532620888265, -6.87724467374253, -16.197089850948316, -1.5706679061272775, -27.607942575414746, -1.4785122504064727, -17.851408752119035, 1.7728754692615096], "policy_predator_policy_reward": [-1.401814262051154, 18.003689547583534, 19.197882168688206, -1.8047869720753162, 22.042317554788156, 26.69376131612736, 3.905889391038409, 31.120620197338475, 24.53778090856309, -8.180881772290842, 7.8735126941581575, -17.345857859749216, 9.100827892103812, -7.441736908766753, 12.038103931868907, 9.457636120268809, -23.214878381560926, -13.92489759687074, 6.425509454163652, 9.85068875828845, 33.86098915470138, 31.100223980965996, 5.961954873651434, 14.2208275110134, 11.583502344693489, 25.755680081794473, 20.881786356533794, 2.81789421877496, 9.089040771177451, 12.18045348164218, 20.78532478552344, 22.754969717987837, 14.810120824604603, 44.94704504264707, 15.46569163136945, 1.1435265933676515, 14.074315747893822, 11.590029231293276, 23.485969120165798, 48.67577730007375, 9.067615917804991, 16.484348131157333, 24.31580441862552, 2.1735142841400723, 15.69695948568235, -4.096621251300524, -1.7448442489133793, 20.959317030143097, 27.40164709535783, 19.127648009783535, 10.646364658846114, 12.930760654084978, 31.904618657294378, 6.33975729623981, 18.73388965878504, -7.819581649776185, 36.03369764333105, 18.416068012208214, 35.20473481924957, 45.31953680653574, 4.364745788997385, -0.9880686441976678, 20.05719437258518, 11.486719769538396, 12.53924669643246, 28.18188942836094, 23.53500378915532, 23.058032646777264, 40.02456879765509, 12.38317055942661, 24.084333378425406, -1.6643796529819914, 38.683159816587725, 37.47780775625613, 23.57155281690223, -0.48009987913867747, 45.39298751909394, 13.238244935141006, 43.38467220712531, 17.404239122244707, 40.69791772877876, 16.934996758042786, 4.621152533922892, 16.63016865329354, 32.857658872675046, 16.226868352919716, 14.173021008585215, 13.769566338001503, 27.44901368889435, 21.189373149270534, 25.705138614032737, 23.15349810618865, 8.641532620888265, 6.87724467374253, 16.197089850948316, 1.5706679061272775, 27.607942575414746, 1.4785122504064727, 17.851408752119035, -1.7728754692615096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5762459209839195, "mean_inference_ms": 1.9059892353134285, "mean_action_processing_ms": 0.24039766525370665, "mean_env_wait_ms": 0.14781108819131972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00617218017578125, "StateBufferConnector_ms": 0.004268288612365723, "ViewRequirementAgentConnector_ms": 0.07830154895782471}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.2869348179265, "num_env_steps_trained_throughput_per_sec": 428.2869348179265, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 9895.881, "restore_workers_time_ms": 0.022, "training_step_time_ms": 9895.443, "sample_time_ms": 1276.972, "learn_time_ms": 8591.99, "learn_throughput": 465.55, "synch_weights_time_ms": 25.039}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 20, "trial_id": "1f352_00000", "date": "2024-08-11_14-58-01", "timestamp": 1723402681, "time_this_iter_s": 9.414711713790894, "time_total_s": 196.3554949760437, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4e3e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 196.3554949760437, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 53.7, "ram_util_percent": 83.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.94852848003308, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.493977729976177, "policy_loss": -0.006570099995345421, "vf_loss": 4.49991646806399, "vf_explained_var": 0.5074664630616704, "kl": 0.008418154909041584, "entropy": 0.8551165334259471, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.335324242214362, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.2150598580638565, "policy_loss": -0.010583637622282064, "vf_loss": 4.224108047535022, "vf_explained_var": 0.5798856190716227, "kl": 0.010236318363439523, "entropy": 1.1379755834738414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -48.67577730007375, "predator_policy": -12.700376167254108}, "policy_reward_max": {"prey_policy": 12.700376167254108, "predator_policy": 48.67577730007375}, "policy_reward_mean": {"prey_policy": -18.201671824451203, "predator_policy": 18.201671824451203}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.425509454163652, -9.85068875828845, -33.86098915470138, -31.100223980965996, -5.961954873651434, -14.2208275110134, -11.583502344693489, -25.755680081794473, -20.881786356533794, -2.81789421877496, -9.089040771177451, -12.18045348164218, -20.78532478552344, -22.754969717987837, -14.810120824604603, -44.94704504264707, -15.46569163136945, -1.1435265933676515, -14.074315747893822, -11.590029231293276, -23.485969120165798, -48.67577730007375, -9.067615917804991, -16.484348131157333, -24.31580441862552, -2.1735142841400723, -15.69695948568235, 4.096621251300524, 1.7448442489133793, -20.959317030143097, -27.40164709535783, -19.127648009783535, -10.646364658846114, -12.930760654084978, -31.904618657294378, -6.33975729623981, -18.73388965878504, 7.819581649776185, -36.03369764333105, -18.416068012208214, -35.20473481924957, -45.31953680653574, -4.364745788997385, 0.9880686441976678, -20.05719437258518, -11.486719769538396, -12.53924669643246, -28.18188942836094, -23.53500378915532, -23.058032646777264, -40.02456879765509, -12.38317055942661, -24.084333378425406, 1.6643796529819914, -38.683159816587725, -37.47780775625613, -23.57155281690223, 0.48009987913867747, -45.39298751909394, -13.238244935141006, -43.38467220712531, -17.404239122244707, -40.69791772877876, -16.934996758042786, -4.621152533922892, -16.63016865329354, -32.857658872675046, -16.226868352919716, -14.173021008585215, -13.769566338001503, -27.44901368889435, -21.189373149270534, -25.705138614032737, -23.15349810618865, -8.641532620888265, -6.87724467374253, -16.197089850948316, -1.5706679061272775, -27.607942575414746, -1.4785122504064727, -17.851408752119035, 1.7728754692615096, 3.4101860027695006, -11.345861968176235, 12.700376167254108, -12.352546147965532, -21.42145684713174, -16.082647807259622, -30.849112016419426, -23.889396110415007, -40.635344597775536, -32.15731956474428, -8.844920039285626, -21.26137737864815, -37.235682362979695, -32.35219244331027, -1.3027861613663845, -16.612896345590066, -22.025418852947865, -21.757311370143924], "policy_predator_policy_reward": [6.425509454163652, 9.85068875828845, 33.86098915470138, 31.100223980965996, 5.961954873651434, 14.2208275110134, 11.583502344693489, 25.755680081794473, 20.881786356533794, 2.81789421877496, 9.089040771177451, 12.18045348164218, 20.78532478552344, 22.754969717987837, 14.810120824604603, 44.94704504264707, 15.46569163136945, 1.1435265933676515, 14.074315747893822, 11.590029231293276, 23.485969120165798, 48.67577730007375, 9.067615917804991, 16.484348131157333, 24.31580441862552, 2.1735142841400723, 15.69695948568235, -4.096621251300524, -1.7448442489133793, 20.959317030143097, 27.40164709535783, 19.127648009783535, 10.646364658846114, 12.930760654084978, 31.904618657294378, 6.33975729623981, 18.73388965878504, -7.819581649776185, 36.03369764333105, 18.416068012208214, 35.20473481924957, 45.31953680653574, 4.364745788997385, -0.9880686441976678, 20.05719437258518, 11.486719769538396, 12.53924669643246, 28.18188942836094, 23.53500378915532, 23.058032646777264, 40.02456879765509, 12.38317055942661, 24.084333378425406, -1.6643796529819914, 38.683159816587725, 37.47780775625613, 23.57155281690223, -0.48009987913867747, 45.39298751909394, 13.238244935141006, 43.38467220712531, 17.404239122244707, 40.69791772877876, 16.934996758042786, 4.621152533922892, 16.63016865329354, 32.857658872675046, 16.226868352919716, 14.173021008585215, 13.769566338001503, 27.44901368889435, 21.189373149270534, 25.705138614032737, 23.15349810618865, 8.641532620888265, 6.87724467374253, 16.197089850948316, 1.5706679061272775, 27.607942575414746, 1.4785122504064727, 17.851408752119035, -1.7728754692615096, -3.4101860027695006, 11.345861968176235, -12.700376167254108, 12.352546147965532, 21.42145684713174, 16.082647807259622, 30.849112016419426, 23.889396110415007, 40.635344597775536, 32.15731956474428, 8.844920039285626, 21.26137737864815, 37.235682362979695, 32.35219244331027, 1.3027861613663845, 16.612896345590066, 22.025418852947865, 21.757311370143924]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5690663313807776, "mean_inference_ms": 1.8826052802449769, "mean_action_processing_ms": 0.2374174156744305, "mean_env_wait_ms": 0.14619127217418496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006029367446899414, "StateBufferConnector_ms": 0.0043256282806396484, "ViewRequirementAgentConnector_ms": 0.07474827766418457}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 388.0807248404297, "num_env_steps_trained_throughput_per_sec": 388.0807248404297, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 9820.203, "restore_workers_time_ms": 0.023, "training_step_time_ms": 9819.763, "sample_time_ms": 1230.482, "learn_time_ms": 8563.692, "learn_throughput": 467.088, "synch_weights_time_ms": 24.132}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 21, "trial_id": "1f352_00000", "date": "2024-08-11_14-58-11", "timestamp": 1723402691, "time_this_iter_s": 10.365892171859741, "time_total_s": 206.72138714790344, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4e3b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 206.72138714790344, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 54.66666666666667, "ram_util_percent": 83.27333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0895694497972728, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.98361507008473, "policy_loss": -0.0026528448676496432, "vf_loss": 4.985782644152641, "vf_explained_var": 0.38460952676832677, "kl": 0.006470445221950213, "entropy": 0.8197732911755641, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.363730558504661, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.907331041991711, "policy_loss": -0.00710349546886088, "vf_loss": 4.913614497085413, "vf_explained_var": 0.569925079618891, "kl": 0.005466923636456519, "entropy": 1.0478624113524952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -53.63066499280504, "predator_policy": -12.700376167254108}, "policy_reward_max": {"prey_policy": 12.700376167254108, "predator_policy": 53.63066499280504}, "policy_reward_mean": {"prey_policy": -19.407458649370238, "predator_policy": 19.407458649370238}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.074315747893822, -11.590029231293276, -23.485969120165798, -48.67577730007375, -9.067615917804991, -16.484348131157333, -24.31580441862552, -2.1735142841400723, -15.69695948568235, 4.096621251300524, 1.7448442489133793, -20.959317030143097, -27.40164709535783, -19.127648009783535, -10.646364658846114, -12.930760654084978, -31.904618657294378, -6.33975729623981, -18.73388965878504, 7.819581649776185, -36.03369764333105, -18.416068012208214, -35.20473481924957, -45.31953680653574, -4.364745788997385, 0.9880686441976678, -20.05719437258518, -11.486719769538396, -12.53924669643246, -28.18188942836094, -23.53500378915532, -23.058032646777264, -40.02456879765509, -12.38317055942661, -24.084333378425406, 1.6643796529819914, -38.683159816587725, -37.47780775625613, -23.57155281690223, 0.48009987913867747, -45.39298751909394, -13.238244935141006, -43.38467220712531, -17.404239122244707, -40.69791772877876, -16.934996758042786, -4.621152533922892, -16.63016865329354, -32.857658872675046, -16.226868352919716, -14.173021008585215, -13.769566338001503, -27.44901368889435, -21.189373149270534, -25.705138614032737, -23.15349810618865, -8.641532620888265, -6.87724467374253, -16.197089850948316, -1.5706679061272775, -27.607942575414746, -1.4785122504064727, -17.851408752119035, 1.7728754692615096, 3.4101860027695006, -11.345861968176235, 12.700376167254108, -12.352546147965532, -21.42145684713174, -16.082647807259622, -30.849112016419426, -23.889396110415007, -40.635344597775536, -32.15731956474428, -8.844920039285626, -21.26137737864815, -37.235682362979695, -32.35219244331027, -1.3027861613663845, -16.612896345590066, -22.025418852947865, -21.757311370143924, -9.056752808675697, -9.357206175273271, -16.451754075524597, -21.437191337507315, -43.479696565403465, -39.904232005959884, -29.118648481021815, -21.299740234317618, -9.755473950806165, -26.687945184546496, -27.947617963977937, -15.826888991918658, -20.895038435480938, -42.03676720481964, -2.998751378036996, -53.63066499280504, -26.238557909228795, -8.090984379499767], "policy_predator_policy_reward": [14.074315747893822, 11.590029231293276, 23.485969120165798, 48.67577730007375, 9.067615917804991, 16.484348131157333, 24.31580441862552, 2.1735142841400723, 15.69695948568235, -4.096621251300524, -1.7448442489133793, 20.959317030143097, 27.40164709535783, 19.127648009783535, 10.646364658846114, 12.930760654084978, 31.904618657294378, 6.33975729623981, 18.73388965878504, -7.819581649776185, 36.03369764333105, 18.416068012208214, 35.20473481924957, 45.31953680653574, 4.364745788997385, -0.9880686441976678, 20.05719437258518, 11.486719769538396, 12.53924669643246, 28.18188942836094, 23.53500378915532, 23.058032646777264, 40.02456879765509, 12.38317055942661, 24.084333378425406, -1.6643796529819914, 38.683159816587725, 37.47780775625613, 23.57155281690223, -0.48009987913867747, 45.39298751909394, 13.238244935141006, 43.38467220712531, 17.404239122244707, 40.69791772877876, 16.934996758042786, 4.621152533922892, 16.63016865329354, 32.857658872675046, 16.226868352919716, 14.173021008585215, 13.769566338001503, 27.44901368889435, 21.189373149270534, 25.705138614032737, 23.15349810618865, 8.641532620888265, 6.87724467374253, 16.197089850948316, 1.5706679061272775, 27.607942575414746, 1.4785122504064727, 17.851408752119035, -1.7728754692615096, -3.4101860027695006, 11.345861968176235, -12.700376167254108, 12.352546147965532, 21.42145684713174, 16.082647807259622, 30.849112016419426, 23.889396110415007, 40.635344597775536, 32.15731956474428, 8.844920039285626, 21.26137737864815, 37.235682362979695, 32.35219244331027, 1.3027861613663845, 16.612896345590066, 22.025418852947865, 21.757311370143924, 9.056752808675697, 9.357206175273271, 16.451754075524597, 21.437191337507315, 43.479696565403465, 39.904232005959884, 29.118648481021815, 21.299740234317618, 9.755473950806165, 26.687945184546496, 27.947617963977937, 15.826888991918658, 20.895038435480938, 42.03676720481964, 2.998751378036996, 53.63066499280504, 26.238557909228795, 8.090984379499767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5628734411716715, "mean_inference_ms": 1.862357629825703, "mean_action_processing_ms": 0.2348491423825773, "mean_env_wait_ms": 0.14479386104668265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006035208702087402, "StateBufferConnector_ms": 0.004433393478393555, "ViewRequirementAgentConnector_ms": 0.0759122371673584}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 394.20650543968367, "num_env_steps_trained_throughput_per_sec": 394.20650543968367, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 9933.379, "restore_workers_time_ms": 0.027, "training_step_time_ms": 9932.743, "sample_time_ms": 1230.048, "learn_time_ms": 8667.685, "learn_throughput": 461.484, "synch_weights_time_ms": 32.95}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 22, "trial_id": "1f352_00000", "date": "2024-08-11_14-58-21", "timestamp": 1723402701, "time_this_iter_s": 10.21592092514038, "time_total_s": 216.93730807304382, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4e3af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 216.93730807304382, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 56.31428571428571, "ram_util_percent": 83.17142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.149504132134219, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.873941620687644, "policy_loss": -0.0018781104149335685, "vf_loss": 3.875297809143861, "vf_explained_var": 0.6108913550153374, "kl": 0.006958876382407301, "entropy": 0.8708822277064124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.365534145757556, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2946426971505085, "policy_loss": -0.009363499166405139, "vf_loss": 3.3033463433384895, "vf_explained_var": 0.7687378038962682, "kl": 0.0043989852857074276, "entropy": 1.1288719361027082, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -53.63066499280504, "predator_policy": -12.700376167254108}, "policy_reward_max": {"prey_policy": 12.700376167254108, "predator_policy": 53.63066499280504}, "policy_reward_mean": {"prey_policy": -19.859901825788576, "predator_policy": 19.859901825788576}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.486719769538396, -12.53924669643246, -28.18188942836094, -23.53500378915532, -23.058032646777264, -40.02456879765509, -12.38317055942661, -24.084333378425406, 1.6643796529819914, -38.683159816587725, -37.47780775625613, -23.57155281690223, 0.48009987913867747, -45.39298751909394, -13.238244935141006, -43.38467220712531, -17.404239122244707, -40.69791772877876, -16.934996758042786, -4.621152533922892, -16.63016865329354, -32.857658872675046, -16.226868352919716, -14.173021008585215, -13.769566338001503, -27.44901368889435, -21.189373149270534, -25.705138614032737, -23.15349810618865, -8.641532620888265, -6.87724467374253, -16.197089850948316, -1.5706679061272775, -27.607942575414746, -1.4785122504064727, -17.851408752119035, 1.7728754692615096, 3.4101860027695006, -11.345861968176235, 12.700376167254108, -12.352546147965532, -21.42145684713174, -16.082647807259622, -30.849112016419426, -23.889396110415007, -40.635344597775536, -32.15731956474428, -8.844920039285626, -21.26137737864815, -37.235682362979695, -32.35219244331027, -1.3027861613663845, -16.612896345590066, -22.025418852947865, -21.757311370143924, -9.056752808675697, -9.357206175273271, -16.451754075524597, -21.437191337507315, -43.479696565403465, -39.904232005959884, -29.118648481021815, -21.299740234317618, -9.755473950806165, -26.687945184546496, -27.947617963977937, -15.826888991918658, -20.895038435480938, -42.03676720481964, -2.998751378036996, -53.63066499280504, -26.238557909228795, -8.090984379499767, -34.04209246458552, -20.48317701162349, -32.894821068789675, -40.17488673384059, -15.47458320381679, -2.405272622185887, -28.173856888517786, -16.932156914748887, 1.0408296668461325, -12.186486202236281, -14.16424445540811, -0.810632421895173, -24.515340196270294, -19.524525361427475, -24.99721305277588, -21.252511792610587, -10.653338162834753, -34.54508984679546, -31.92348412066874, -9.8041624837779, -11.886977371104614, -20.18398069710439, -0.6368583438975737, -10.321448768221323, -25.561428479658822, -13.377789137471698, -27.71398785250363], "policy_predator_policy_reward": [11.486719769538396, 12.53924669643246, 28.18188942836094, 23.53500378915532, 23.058032646777264, 40.02456879765509, 12.38317055942661, 24.084333378425406, -1.6643796529819914, 38.683159816587725, 37.47780775625613, 23.57155281690223, -0.48009987913867747, 45.39298751909394, 13.238244935141006, 43.38467220712531, 17.404239122244707, 40.69791772877876, 16.934996758042786, 4.621152533922892, 16.63016865329354, 32.857658872675046, 16.226868352919716, 14.173021008585215, 13.769566338001503, 27.44901368889435, 21.189373149270534, 25.705138614032737, 23.15349810618865, 8.641532620888265, 6.87724467374253, 16.197089850948316, 1.5706679061272775, 27.607942575414746, 1.4785122504064727, 17.851408752119035, -1.7728754692615096, -3.4101860027695006, 11.345861968176235, -12.700376167254108, 12.352546147965532, 21.42145684713174, 16.082647807259622, 30.849112016419426, 23.889396110415007, 40.635344597775536, 32.15731956474428, 8.844920039285626, 21.26137737864815, 37.235682362979695, 32.35219244331027, 1.3027861613663845, 16.612896345590066, 22.025418852947865, 21.757311370143924, 9.056752808675697, 9.357206175273271, 16.451754075524597, 21.437191337507315, 43.479696565403465, 39.904232005959884, 29.118648481021815, 21.299740234317618, 9.755473950806165, 26.687945184546496, 27.947617963977937, 15.826888991918658, 20.895038435480938, 42.03676720481964, 2.998751378036996, 53.63066499280504, 26.238557909228795, 8.090984379499767, 34.04209246458552, 20.48317701162349, 32.894821068789675, 40.17488673384059, 15.47458320381679, 2.405272622185887, 28.173856888517786, 16.932156914748887, -1.0408296668461325, 12.186486202236281, 14.16424445540811, 0.810632421895173, 24.515340196270294, 19.524525361427475, 24.99721305277588, 21.252511792610587, 10.653338162834753, 34.54508984679546, 31.92348412066874, 9.8041624837779, 11.886977371104614, 20.18398069710439, 0.6368583438975737, 10.321448768221323, 25.561428479658822, 13.377789137471698, 27.71398785250363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542296561494865, "mean_inference_ms": 1.83108832393951, "mean_action_processing_ms": 0.2311049686253414, "mean_env_wait_ms": 0.1426474052098716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006012678146362305, "StateBufferConnector_ms": 0.004416704177856445, "ViewRequirementAgentConnector_ms": 0.07283079624176025}, "num_episodes": 27, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 410.78356010365314, "num_env_steps_trained_throughput_per_sec": 410.78356010365314, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 9921.936, "restore_workers_time_ms": 0.027, "training_step_time_ms": 9921.31, "sample_time_ms": 1150.36, "learn_time_ms": 8736.848, "learn_throughput": 457.831, "synch_weights_time_ms": 31.988}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 23, "trial_id": "1f352_00000", "date": "2024-08-11_14-58-31", "timestamp": 1723402711, "time_this_iter_s": 9.80008602142334, "time_total_s": 226.73739409446716, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af487af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 226.73739409446716, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 53.614285714285714, "ram_util_percent": 82.54285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.208950238364438, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.371244448920091, "policy_loss": -0.0037550613575149327, "vf_loss": 3.374574342245857, "vf_explained_var": 0.685238947160542, "kl": 0.005668960895000434, "entropy": 0.853973657079041, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4684936136628193, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2130421839654444, "policy_loss": -0.01455250007372039, "vf_loss": 3.226463577399651, "vf_explained_var": 0.761381076897184, "kl": 0.015081433070904994, "entropy": 1.1572962369769813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -53.63066499280504, "predator_policy": -12.700376167254108}, "policy_reward_max": {"prey_policy": 12.700376167254108, "predator_policy": 53.63066499280504}, "policy_reward_mean": {"prey_policy": -18.22880723552082, "predator_policy": 18.22880723552082}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.934996758042786, -4.621152533922892, -16.63016865329354, -32.857658872675046, -16.226868352919716, -14.173021008585215, -13.769566338001503, -27.44901368889435, -21.189373149270534, -25.705138614032737, -23.15349810618865, -8.641532620888265, -6.87724467374253, -16.197089850948316, -1.5706679061272775, -27.607942575414746, -1.4785122504064727, -17.851408752119035, 1.7728754692615096, 3.4101860027695006, -11.345861968176235, 12.700376167254108, -12.352546147965532, -21.42145684713174, -16.082647807259622, -30.849112016419426, -23.889396110415007, -40.635344597775536, -32.15731956474428, -8.844920039285626, -21.26137737864815, -37.235682362979695, -32.35219244331027, -1.3027861613663845, -16.612896345590066, -22.025418852947865, -21.757311370143924, -9.056752808675697, -9.357206175273271, -16.451754075524597, -21.437191337507315, -43.479696565403465, -39.904232005959884, -29.118648481021815, -21.299740234317618, -9.755473950806165, -26.687945184546496, -27.947617963977937, -15.826888991918658, -20.895038435480938, -42.03676720481964, -2.998751378036996, -53.63066499280504, -26.238557909228795, -8.090984379499767, -34.04209246458552, -20.48317701162349, -32.894821068789675, -40.17488673384059, -15.47458320381679, -2.405272622185887, -28.173856888517786, -16.932156914748887, 1.0408296668461325, -12.186486202236281, -14.16424445540811, -0.810632421895173, -24.515340196270294, -19.524525361427475, -24.99721305277588, -21.252511792610587, -10.653338162834753, -34.54508984679546, -31.92348412066874, -9.8041624837779, -11.886977371104614, -20.18398069710439, -0.6368583438975737, -10.321448768221323, -25.561428479658822, -13.377789137471698, -27.71398785250363, -21.4014851826408, -35.10021155920532, -2.2636185079349547, -4.273114126944989, -5.048610389913307, -18.59929205194231, -38.882625197449194, 3.914008231546986, -6.886292053096756, -16.143869529093333, -17.13520104374759, -15.186075570243236, -7.878743117763857, -21.092056213431214, -19.24975912462529, -24.142885183532623, 4.047890936687908, -24.567668725674917], "policy_predator_policy_reward": [16.934996758042786, 4.621152533922892, 16.63016865329354, 32.857658872675046, 16.226868352919716, 14.173021008585215, 13.769566338001503, 27.44901368889435, 21.189373149270534, 25.705138614032737, 23.15349810618865, 8.641532620888265, 6.87724467374253, 16.197089850948316, 1.5706679061272775, 27.607942575414746, 1.4785122504064727, 17.851408752119035, -1.7728754692615096, -3.4101860027695006, 11.345861968176235, -12.700376167254108, 12.352546147965532, 21.42145684713174, 16.082647807259622, 30.849112016419426, 23.889396110415007, 40.635344597775536, 32.15731956474428, 8.844920039285626, 21.26137737864815, 37.235682362979695, 32.35219244331027, 1.3027861613663845, 16.612896345590066, 22.025418852947865, 21.757311370143924, 9.056752808675697, 9.357206175273271, 16.451754075524597, 21.437191337507315, 43.479696565403465, 39.904232005959884, 29.118648481021815, 21.299740234317618, 9.755473950806165, 26.687945184546496, 27.947617963977937, 15.826888991918658, 20.895038435480938, 42.03676720481964, 2.998751378036996, 53.63066499280504, 26.238557909228795, 8.090984379499767, 34.04209246458552, 20.48317701162349, 32.894821068789675, 40.17488673384059, 15.47458320381679, 2.405272622185887, 28.173856888517786, 16.932156914748887, -1.0408296668461325, 12.186486202236281, 14.16424445540811, 0.810632421895173, 24.515340196270294, 19.524525361427475, 24.99721305277588, 21.252511792610587, 10.653338162834753, 34.54508984679546, 31.92348412066874, 9.8041624837779, 11.886977371104614, 20.18398069710439, 0.6368583438975737, 10.321448768221323, 25.561428479658822, 13.377789137471698, 27.71398785250363, 21.4014851826408, 35.10021155920532, 2.2636185079349547, 4.273114126944989, 5.048610389913307, 18.59929205194231, 38.882625197449194, -3.914008231546986, 6.886292053096756, 16.143869529093333, 17.13520104374759, 15.186075570243236, 7.878743117763857, 21.092056213431214, 19.24975912462529, 24.142885183532623, -4.047890936687908, 24.567668725674917]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5470945540847655, "mean_inference_ms": 1.8124399926519046, "mean_action_processing_ms": 0.22834096878880175, "mean_env_wait_ms": 0.14124380814151472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005186557769775391, "StateBufferConnector_ms": 0.003462672233581543, "ViewRequirementAgentConnector_ms": 0.06557536125183105}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.66972372139554, "num_env_steps_trained_throughput_per_sec": 417.66972372139554, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 9882.79, "restore_workers_time_ms": 0.025, "training_step_time_ms": 9882.174, "sample_time_ms": 1118.562, "learn_time_ms": 8725.81, "learn_throughput": 458.41, "synch_weights_time_ms": 34.86}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 24, "trial_id": "1f352_00000", "date": "2024-08-11_14-58-41", "timestamp": 1723402721, "time_this_iter_s": 9.614946126937866, "time_total_s": 236.35234022140503, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4909d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 236.35234022140503, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 52.03571428571428, "ram_util_percent": 82.70714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.448073265142739, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5368069159487883, "policy_loss": -0.00444666420808062, "vf_loss": 3.5406361050903796, "vf_explained_var": 0.6950375432148576, "kl": 0.00823303423191651, "entropy": 0.8212299588446815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.630816562473774, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.203063377737999, "policy_loss": -0.009183881335047772, "vf_loss": 3.2114365151772897, "vf_explained_var": 0.8102016129220525, "kl": 0.010809910259967977, "entropy": 1.127966873596112, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -53.63066499280504, "predator_policy": -12.700376167254108}, "policy_reward_max": {"prey_policy": 12.700376167254108, "predator_policy": 53.63066499280504}, "policy_reward_mean": {"prey_policy": -19.138537207630193, "predator_policy": 19.138537207630193}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.7728754692615096, 3.4101860027695006, -11.345861968176235, 12.700376167254108, -12.352546147965532, -21.42145684713174, -16.082647807259622, -30.849112016419426, -23.889396110415007, -40.635344597775536, -32.15731956474428, -8.844920039285626, -21.26137737864815, -37.235682362979695, -32.35219244331027, -1.3027861613663845, -16.612896345590066, -22.025418852947865, -21.757311370143924, -9.056752808675697, -9.357206175273271, -16.451754075524597, -21.437191337507315, -43.479696565403465, -39.904232005959884, -29.118648481021815, -21.299740234317618, -9.755473950806165, -26.687945184546496, -27.947617963977937, -15.826888991918658, -20.895038435480938, -42.03676720481964, -2.998751378036996, -53.63066499280504, -26.238557909228795, -8.090984379499767, -34.04209246458552, -20.48317701162349, -32.894821068789675, -40.17488673384059, -15.47458320381679, -2.405272622185887, -28.173856888517786, -16.932156914748887, 1.0408296668461325, -12.186486202236281, -14.16424445540811, -0.810632421895173, -24.515340196270294, -19.524525361427475, -24.99721305277588, -21.252511792610587, -10.653338162834753, -34.54508984679546, -31.92348412066874, -9.8041624837779, -11.886977371104614, -20.18398069710439, -0.6368583438975737, -10.321448768221323, -25.561428479658822, -13.377789137471698, -27.71398785250363, -21.4014851826408, -35.10021155920532, -2.2636185079349547, -4.273114126944989, -5.048610389913307, -18.59929205194231, -38.882625197449194, 3.914008231546986, -6.886292053096756, -16.143869529093333, -17.13520104374759, -15.186075570243236, -7.878743117763857, -21.092056213431214, -19.24975912462529, -24.142885183532623, 4.047890936687908, -24.567668725674917, -23.244400027988576, -0.21359126933010586, -13.358638564293075, -42.429795476491066, -16.279861205282476, 9.620197319899416, -43.57234325331415, -10.282779132432726, -28.69033272213568, -4.3874924740423715, -9.26387381939369, -31.022733314691965, -21.51740480534274, -22.425864058283228, -13.203075603383992, -36.062997296969954, -35.75569408113099, -41.817172131803815], "policy_predator_policy_reward": [-1.7728754692615096, -3.4101860027695006, 11.345861968176235, -12.700376167254108, 12.352546147965532, 21.42145684713174, 16.082647807259622, 30.849112016419426, 23.889396110415007, 40.635344597775536, 32.15731956474428, 8.844920039285626, 21.26137737864815, 37.235682362979695, 32.35219244331027, 1.3027861613663845, 16.612896345590066, 22.025418852947865, 21.757311370143924, 9.056752808675697, 9.357206175273271, 16.451754075524597, 21.437191337507315, 43.479696565403465, 39.904232005959884, 29.118648481021815, 21.299740234317618, 9.755473950806165, 26.687945184546496, 27.947617963977937, 15.826888991918658, 20.895038435480938, 42.03676720481964, 2.998751378036996, 53.63066499280504, 26.238557909228795, 8.090984379499767, 34.04209246458552, 20.48317701162349, 32.894821068789675, 40.17488673384059, 15.47458320381679, 2.405272622185887, 28.173856888517786, 16.932156914748887, -1.0408296668461325, 12.186486202236281, 14.16424445540811, 0.810632421895173, 24.515340196270294, 19.524525361427475, 24.99721305277588, 21.252511792610587, 10.653338162834753, 34.54508984679546, 31.92348412066874, 9.8041624837779, 11.886977371104614, 20.18398069710439, 0.6368583438975737, 10.321448768221323, 25.561428479658822, 13.377789137471698, 27.71398785250363, 21.4014851826408, 35.10021155920532, 2.2636185079349547, 4.273114126944989, 5.048610389913307, 18.59929205194231, 38.882625197449194, -3.914008231546986, 6.886292053096756, 16.143869529093333, 17.13520104374759, 15.186075570243236, 7.878743117763857, 21.092056213431214, 19.24975912462529, 24.142885183532623, -4.047890936687908, 24.567668725674917, 23.244400027988576, 0.21359126933010586, 13.358638564293075, 42.429795476491066, 16.279861205282476, -9.620197319899416, 43.57234325331415, 10.282779132432726, 28.69033272213568, 4.3874924740423715, 9.26387381939369, 31.022733314691965, 21.51740480534274, 22.425864058283228, 13.203075603383992, 36.062997296969954, 35.75569408113099, 41.817172131803815]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5420160174055701, "mean_inference_ms": 1.796935862579349, "mean_action_processing_ms": 0.22626920903439193, "mean_env_wait_ms": 0.14011401436351897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005248427391052246, "StateBufferConnector_ms": 0.003575921058654785, "ViewRequirementAgentConnector_ms": 0.06839776039123535}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 415.00849486245295, "num_env_steps_trained_throughput_per_sec": 415.00849486245295, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 9864.464, "restore_workers_time_ms": 0.025, "training_step_time_ms": 9863.934, "sample_time_ms": 1094.13, "learn_time_ms": 8734.373, "learn_throughput": 457.961, "synch_weights_time_ms": 32.683}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 25, "trial_id": "1f352_00000", "date": "2024-08-11_14-58-51", "timestamp": 1723402731, "time_this_iter_s": 9.672482967376709, "time_total_s": 246.02482318878174, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4f5790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 246.02482318878174, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 53.214285714285715, "ram_util_percent": 82.85714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.810066931260129, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.222178309659163, "policy_loss": 0.0004825897044308173, "vf_loss": 3.2215152201553185, "vf_explained_var": 0.8293015150974195, "kl": 0.0024066991713806033, "entropy": 0.7354424638673663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.057875210295121, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9877388805150984, "policy_loss": -0.008973086613211004, "vf_loss": 2.9957117127875486, "vf_explained_var": 0.8709702445194125, "kl": 0.013336591622989022, "entropy": 1.0770349636673928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -53.63066499280504, "predator_policy": -9.620197319899416}, "policy_reward_max": {"prey_policy": 9.620197319899416, "predator_policy": 53.63066499280504}, "policy_reward_mean": {"prey_policy": -19.05809742939156, "predator_policy": 19.05809742939156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-21.757311370143924, -9.056752808675697, -9.357206175273271, -16.451754075524597, -21.437191337507315, -43.479696565403465, -39.904232005959884, -29.118648481021815, -21.299740234317618, -9.755473950806165, -26.687945184546496, -27.947617963977937, -15.826888991918658, -20.895038435480938, -42.03676720481964, -2.998751378036996, -53.63066499280504, -26.238557909228795, -8.090984379499767, -34.04209246458552, -20.48317701162349, -32.894821068789675, -40.17488673384059, -15.47458320381679, -2.405272622185887, -28.173856888517786, -16.932156914748887, 1.0408296668461325, -12.186486202236281, -14.16424445540811, -0.810632421895173, -24.515340196270294, -19.524525361427475, -24.99721305277588, -21.252511792610587, -10.653338162834753, -34.54508984679546, -31.92348412066874, -9.8041624837779, -11.886977371104614, -20.18398069710439, -0.6368583438975737, -10.321448768221323, -25.561428479658822, -13.377789137471698, -27.71398785250363, -21.4014851826408, -35.10021155920532, -2.2636185079349547, -4.273114126944989, -5.048610389913307, -18.59929205194231, -38.882625197449194, 3.914008231546986, -6.886292053096756, -16.143869529093333, -17.13520104374759, -15.186075570243236, -7.878743117763857, -21.092056213431214, -19.24975912462529, -24.142885183532623, 4.047890936687908, -24.567668725674917, -23.244400027988576, -0.21359126933010586, -13.358638564293075, -42.429795476491066, -16.279861205282476, 9.620197319899416, -43.57234325331415, -10.282779132432726, -28.69033272213568, -4.3874924740423715, -9.26387381939369, -31.022733314691965, -21.51740480534274, -22.425864058283228, -13.203075603383992, -36.062997296969954, -35.75569408113099, -41.817172131803815, -24.760958597337506, -6.394599204024817, -16.363270141590505, -17.978019371090312, -7.608654621297088, -27.443351129790052, -4.869012693821508, -33.81421974087303, -29.93516110692555, -10.842374068278493, -8.319911671511104, -33.72711961282146, -31.248278148127447, 9.115288381280797, -2.911842094954589, -35.183347277543504, -13.902522711219364, -6.254189370940827], "policy_predator_policy_reward": [21.757311370143924, 9.056752808675697, 9.357206175273271, 16.451754075524597, 21.437191337507315, 43.479696565403465, 39.904232005959884, 29.118648481021815, 21.299740234317618, 9.755473950806165, 26.687945184546496, 27.947617963977937, 15.826888991918658, 20.895038435480938, 42.03676720481964, 2.998751378036996, 53.63066499280504, 26.238557909228795, 8.090984379499767, 34.04209246458552, 20.48317701162349, 32.894821068789675, 40.17488673384059, 15.47458320381679, 2.405272622185887, 28.173856888517786, 16.932156914748887, -1.0408296668461325, 12.186486202236281, 14.16424445540811, 0.810632421895173, 24.515340196270294, 19.524525361427475, 24.99721305277588, 21.252511792610587, 10.653338162834753, 34.54508984679546, 31.92348412066874, 9.8041624837779, 11.886977371104614, 20.18398069710439, 0.6368583438975737, 10.321448768221323, 25.561428479658822, 13.377789137471698, 27.71398785250363, 21.4014851826408, 35.10021155920532, 2.2636185079349547, 4.273114126944989, 5.048610389913307, 18.59929205194231, 38.882625197449194, -3.914008231546986, 6.886292053096756, 16.143869529093333, 17.13520104374759, 15.186075570243236, 7.878743117763857, 21.092056213431214, 19.24975912462529, 24.142885183532623, -4.047890936687908, 24.567668725674917, 23.244400027988576, 0.21359126933010586, 13.358638564293075, 42.429795476491066, 16.279861205282476, -9.620197319899416, 43.57234325331415, 10.282779132432726, 28.69033272213568, 4.3874924740423715, 9.26387381939369, 31.022733314691965, 21.51740480534274, 22.425864058283228, 13.203075603383992, 36.062997296969954, 35.75569408113099, 41.817172131803815, 24.760958597337506, 6.394599204024817, 16.363270141590505, 17.978019371090312, 7.608654621297088, 27.443351129790052, 4.869012693821508, 33.81421974087303, 29.93516110692555, 10.842374068278493, 8.319911671511104, 33.72711961282146, 31.248278148127447, -9.115288381280797, 2.911842094954589, 35.183347277543504, 13.902522711219364, 6.254189370940827]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5391669787323918, "mean_inference_ms": 1.7850970065040133, "mean_action_processing_ms": 0.22469645113985592, "mean_env_wait_ms": 0.13915414554825176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005975842475891113, "StateBufferConnector_ms": 0.0037882328033447266, "ViewRequirementAgentConnector_ms": 0.08225536346435547}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 411.1232235880193, "num_env_steps_trained_throughput_per_sec": 411.1232235880193, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 9858.405, "restore_workers_time_ms": 0.025, "training_step_time_ms": 9857.874, "sample_time_ms": 1111.25, "learn_time_ms": 8710.999, "learn_throughput": 459.19, "synch_weights_time_ms": 32.794}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 26, "trial_id": "1f352_00000", "date": "2024-08-11_14-59-00", "timestamp": 1723402740, "time_this_iter_s": 9.760664939880371, "time_total_s": 255.7854881286621, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4f5c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 255.7854881286621, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 54.84285714285715, "ram_util_percent": 82.69285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.448899473436177, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.621571470052004, "policy_loss": -0.004169192420764981, "vf_loss": 2.6254204640785854, "vf_explained_var": 0.7801091002300382, "kl": 0.008538715694689359, "entropy": 0.7324184649934371, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.604549919379254, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5183671467006206, "policy_loss": -0.012732831826724578, "vf_loss": 2.529653855289022, "vf_explained_var": 0.8245479026809335, "kl": 0.01928163174131754, "entropy": 1.051408150481681, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -60.60059573595055, "predator_policy": -9.620197319899416}, "policy_reward_max": {"prey_policy": 9.620197319899416, "predator_policy": 60.60059573595055}, "policy_reward_mean": {"prey_policy": -18.09777402529032, "predator_policy": 18.09777402529032}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-40.17488673384059, -15.47458320381679, -2.405272622185887, -28.173856888517786, -16.932156914748887, 1.0408296668461325, -12.186486202236281, -14.16424445540811, -0.810632421895173, -24.515340196270294, -19.524525361427475, -24.99721305277588, -21.252511792610587, -10.653338162834753, -34.54508984679546, -31.92348412066874, -9.8041624837779, -11.886977371104614, -20.18398069710439, -0.6368583438975737, -10.321448768221323, -25.561428479658822, -13.377789137471698, -27.71398785250363, -21.4014851826408, -35.10021155920532, -2.2636185079349547, -4.273114126944989, -5.048610389913307, -18.59929205194231, -38.882625197449194, 3.914008231546986, -6.886292053096756, -16.143869529093333, -17.13520104374759, -15.186075570243236, -7.878743117763857, -21.092056213431214, -19.24975912462529, -24.142885183532623, 4.047890936687908, -24.567668725674917, -23.244400027988576, -0.21359126933010586, -13.358638564293075, -42.429795476491066, -16.279861205282476, 9.620197319899416, -43.57234325331415, -10.282779132432726, -28.69033272213568, -4.3874924740423715, -9.26387381939369, -31.022733314691965, -21.51740480534274, -22.425864058283228, -13.203075603383992, -36.062997296969954, -35.75569408113099, -41.817172131803815, -24.760958597337506, -6.394599204024817, -16.363270141590505, -17.978019371090312, -7.608654621297088, -27.443351129790052, -4.869012693821508, -33.81421974087303, -29.93516110692555, -10.842374068278493, -8.319911671511104, -33.72711961282146, -31.248278148127447, 9.115288381280797, -2.911842094954589, -35.183347277543504, -13.902522711219364, -6.254189370940827, -5.949853817082768, -39.74566909918123, -40.45506892235944, -5.717750376998309, -60.60059573595055, -17.851565341253636, -17.753202448404792, -7.109899377104136, -9.045849927010474, -20.0292218014269, -46.005291243993426, -32.11719812232151, 3.7955098654205788, -0.26405921736096616, -22.998522740768426, -3.679106664495616, -1.1987595320955666, -1.8219316863817117, -29.431896366864738, -28.858672196307566, -23.768380957132667, -26.751987870749623], "policy_predator_policy_reward": [40.17488673384059, 15.47458320381679, 2.405272622185887, 28.173856888517786, 16.932156914748887, -1.0408296668461325, 12.186486202236281, 14.16424445540811, 0.810632421895173, 24.515340196270294, 19.524525361427475, 24.99721305277588, 21.252511792610587, 10.653338162834753, 34.54508984679546, 31.92348412066874, 9.8041624837779, 11.886977371104614, 20.18398069710439, 0.6368583438975737, 10.321448768221323, 25.561428479658822, 13.377789137471698, 27.71398785250363, 21.4014851826408, 35.10021155920532, 2.2636185079349547, 4.273114126944989, 5.048610389913307, 18.59929205194231, 38.882625197449194, -3.914008231546986, 6.886292053096756, 16.143869529093333, 17.13520104374759, 15.186075570243236, 7.878743117763857, 21.092056213431214, 19.24975912462529, 24.142885183532623, -4.047890936687908, 24.567668725674917, 23.244400027988576, 0.21359126933010586, 13.358638564293075, 42.429795476491066, 16.279861205282476, -9.620197319899416, 43.57234325331415, 10.282779132432726, 28.69033272213568, 4.3874924740423715, 9.26387381939369, 31.022733314691965, 21.51740480534274, 22.425864058283228, 13.203075603383992, 36.062997296969954, 35.75569408113099, 41.817172131803815, 24.760958597337506, 6.394599204024817, 16.363270141590505, 17.978019371090312, 7.608654621297088, 27.443351129790052, 4.869012693821508, 33.81421974087303, 29.93516110692555, 10.842374068278493, 8.319911671511104, 33.72711961282146, 31.248278148127447, -9.115288381280797, 2.911842094954589, 35.183347277543504, 13.902522711219364, 6.254189370940827, 5.949853817082768, 39.74566909918123, 40.45506892235944, 5.717750376998309, 60.60059573595055, 17.851565341253636, 17.753202448404792, 7.109899377104136, 9.045849927010474, 20.0292218014269, 46.005291243993426, 32.11719812232151, -3.7955098654205788, 0.26405921736096616, 22.998522740768426, 3.679106664495616, 1.1987595320955666, 1.8219316863817117, 29.431896366864738, 28.858672196307566, 23.768380957132667, 26.751987870749623]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5391536443956889, "mean_inference_ms": 1.779079034080092, "mean_action_processing_ms": 0.22402961692195295, "mean_env_wait_ms": 0.13863377633187354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006699919700622559, "StateBufferConnector_ms": 0.003614187240600586, "ViewRequirementAgentConnector_ms": 0.09558641910552979}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 405.1911033380511, "num_env_steps_trained_throughput_per_sec": 405.1911033380511, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 9862.357, "restore_workers_time_ms": 0.026, "training_step_time_ms": 9861.727, "sample_time_ms": 1152.477, "learn_time_ms": 8672.112, "learn_throughput": 461.249, "synch_weights_time_ms": 34.066}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 27, "trial_id": "1f352_00000", "date": "2024-08-11_14-59-10", "timestamp": 1723402750, "time_this_iter_s": 9.938654899597168, "time_total_s": 265.7241430282593, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4f51f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 265.7241430282593, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 54.56428571428571, "ram_util_percent": 82.91428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.063816100234787, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5365932866930962, "policy_loss": -0.00333892164635472, "vf_loss": 2.5396851427853107, "vf_explained_var": 0.7983068730061252, "kl": 0.0065884021442222974, "entropy": 0.6906900520746907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1246336192513504, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5373027654985587, "policy_loss": -0.0064671326045451375, "vf_loss": 2.5433104650427896, "vf_explained_var": 0.8065056752413511, "kl": 0.006125753933187416, "entropy": 1.0521356783807279, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -60.60059573595055, "predator_policy": -9.620197319899416}, "policy_reward_max": {"prey_policy": 9.620197319899416, "predator_policy": 60.60059573595055}, "policy_reward_mean": {"prey_policy": -18.422915314659733, "predator_policy": 18.422915314659733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-27.71398785250363, -21.4014851826408, -35.10021155920532, -2.2636185079349547, -4.273114126944989, -5.048610389913307, -18.59929205194231, -38.882625197449194, 3.914008231546986, -6.886292053096756, -16.143869529093333, -17.13520104374759, -15.186075570243236, -7.878743117763857, -21.092056213431214, -19.24975912462529, -24.142885183532623, 4.047890936687908, -24.567668725674917, -23.244400027988576, -0.21359126933010586, -13.358638564293075, -42.429795476491066, -16.279861205282476, 9.620197319899416, -43.57234325331415, -10.282779132432726, -28.69033272213568, -4.3874924740423715, -9.26387381939369, -31.022733314691965, -21.51740480534274, -22.425864058283228, -13.203075603383992, -36.062997296969954, -35.75569408113099, -41.817172131803815, -24.760958597337506, -6.394599204024817, -16.363270141590505, -17.978019371090312, -7.608654621297088, -27.443351129790052, -4.869012693821508, -33.81421974087303, -29.93516110692555, -10.842374068278493, -8.319911671511104, -33.72711961282146, -31.248278148127447, 9.115288381280797, -2.911842094954589, -35.183347277543504, -13.902522711219364, -6.254189370940827, -5.949853817082768, -39.74566909918123, -40.45506892235944, -5.717750376998309, -60.60059573595055, -17.851565341253636, -17.753202448404792, -7.109899377104136, -9.045849927010474, -20.0292218014269, -46.005291243993426, -32.11719812232151, 3.7955098654205788, -0.26405921736096616, -22.998522740768426, -3.679106664495616, -1.1987595320955666, -1.8219316863817117, -29.431896366864738, -28.858672196307566, -23.768380957132667, -26.751987870749623, 6.727535263720794, -29.320938476223272, -25.788698583548136, -29.049105532847516, -31.29911757085889, 8.374176251362002, -3.1295331400568305, 8.466311724486582, -32.63800471687885, -6.284695814933549, -17.164046581924094, 2.140858133078069, -22.085527873270866, -53.21749943227929, -24.264901361745395, -17.123881783963395, -44.26496380906533, -7.125722000553894, -31.19393514179193, -34.39744777499542, 5.045959553342996, -31.984589851689925, -11.40179800672767], "policy_predator_policy_reward": [27.71398785250363, 21.4014851826408, 35.10021155920532, 2.2636185079349547, 4.273114126944989, 5.048610389913307, 18.59929205194231, 38.882625197449194, -3.914008231546986, 6.886292053096756, 16.143869529093333, 17.13520104374759, 15.186075570243236, 7.878743117763857, 21.092056213431214, 19.24975912462529, 24.142885183532623, -4.047890936687908, 24.567668725674917, 23.244400027988576, 0.21359126933010586, 13.358638564293075, 42.429795476491066, 16.279861205282476, -9.620197319899416, 43.57234325331415, 10.282779132432726, 28.69033272213568, 4.3874924740423715, 9.26387381939369, 31.022733314691965, 21.51740480534274, 22.425864058283228, 13.203075603383992, 36.062997296969954, 35.75569408113099, 41.817172131803815, 24.760958597337506, 6.394599204024817, 16.363270141590505, 17.978019371090312, 7.608654621297088, 27.443351129790052, 4.869012693821508, 33.81421974087303, 29.93516110692555, 10.842374068278493, 8.319911671511104, 33.72711961282146, 31.248278148127447, -9.115288381280797, 2.911842094954589, 35.183347277543504, 13.902522711219364, 6.254189370940827, 5.949853817082768, 39.74566909918123, 40.45506892235944, 5.717750376998309, 60.60059573595055, 17.851565341253636, 17.753202448404792, 7.109899377104136, 9.045849927010474, 20.0292218014269, 46.005291243993426, 32.11719812232151, -3.7955098654205788, 0.26405921736096616, 22.998522740768426, 3.679106664495616, 1.1987595320955666, 1.8219316863817117, 29.431896366864738, 28.858672196307566, 23.768380957132667, 26.751987870749623, -6.727535263720794, 29.320938476223272, 25.788698583548136, 29.049105532847516, 31.29911757085889, -8.374176251362002, 3.1295331400568305, -8.466311724486582, 32.63800471687885, 6.284695814933549, 17.164046581924094, -2.140858133078069, 22.085527873270866, 53.21749943227929, 24.264901361745395, 17.123881783963395, 44.26496380906533, 7.125722000553894, 31.19393514179193, 34.39744777499542, -5.045959553342996, 31.984589851689925, 11.40179800672767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5365977702993857, "mean_inference_ms": 1.7722733373632595, "mean_action_processing_ms": 0.22289922978377652, "mean_env_wait_ms": 0.13765531115781882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068291425704956055, "StateBufferConnector_ms": 0.002969980239868164, "ViewRequirementAgentConnector_ms": 0.10028958320617676}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 402.66796674639517, "num_env_steps_trained_throughput_per_sec": 402.66796674639517, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 9823.859, "restore_workers_time_ms": 0.025, "training_step_time_ms": 9823.232, "sample_time_ms": 1150.504, "learn_time_ms": 8634.989, "learn_throughput": 463.232, "synch_weights_time_ms": 34.683}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 28, "trial_id": "1f352_00000", "date": "2024-08-11_14-59-20", "timestamp": 1723402760, "time_this_iter_s": 9.990391969680786, "time_total_s": 275.71453499794006, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4f5160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 275.71453499794006, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 56.11428571428572, "ram_util_percent": 82.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.314161750363807, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.821446742862463, "policy_loss": -0.003779566124770402, "vf_loss": 1.8250025290374954, "vf_explained_var": 0.9328820348406831, "kl": 0.005967499844776022, "entropy": 0.671977989623944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4890165708959104, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.741914953601857, "policy_loss": -0.00527899043324093, "vf_loss": 1.746775960860153, "vf_explained_var": 0.9474302920823295, "kl": 0.005573143117870906, "entropy": 1.0241111133868495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -60.60059573595055, "predator_policy": -9.620197319899416}, "policy_reward_max": {"prey_policy": 9.620197319899416, "predator_policy": 60.60059573595055}, "policy_reward_mean": {"prey_policy": -19.49678575277027, "predator_policy": 19.49678575277027}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.567668725674917, -23.244400027988576, -0.21359126933010586, -13.358638564293075, -42.429795476491066, -16.279861205282476, 9.620197319899416, -43.57234325331415, -10.282779132432726, -28.69033272213568, -4.3874924740423715, -9.26387381939369, -31.022733314691965, -21.51740480534274, -22.425864058283228, -13.203075603383992, -36.062997296969954, -35.75569408113099, -41.817172131803815, -24.760958597337506, -6.394599204024817, -16.363270141590505, -17.978019371090312, -7.608654621297088, -27.443351129790052, -4.869012693821508, -33.81421974087303, -29.93516110692555, -10.842374068278493, -8.319911671511104, -33.72711961282146, -31.248278148127447, 9.115288381280797, -2.911842094954589, -35.183347277543504, -13.902522711219364, -6.254189370940827, -5.949853817082768, -39.74566909918123, -40.45506892235944, -5.717750376998309, -60.60059573595055, -17.851565341253636, -17.753202448404792, -7.109899377104136, -9.045849927010474, -20.0292218014269, -46.005291243993426, -32.11719812232151, 3.7955098654205788, -0.26405921736096616, -22.998522740768426, -3.679106664495616, -1.1987595320955666, -1.8219316863817117, -29.431896366864738, -28.858672196307566, -23.768380957132667, -26.751987870749623, 6.727535263720794, -29.320938476223272, -25.788698583548136, -29.049105532847516, -31.29911757085889, 8.374176251362002, -3.1295331400568305, 8.466311724486582, -32.63800471687885, -6.284695814933549, -17.164046581924094, 2.140858133078069, -22.085527873270866, -53.21749943227929, -24.264901361745395, -17.123881783963395, -44.26496380906533, -7.125722000553894, -31.19393514179193, -34.39744777499542, 5.045959553342996, -31.984589851689925, -11.40179800672767, -33.25622294904492, -30.930161235440053, -32.785505322604266, -16.689145988747438, -11.75274590409546, -31.314334258093762, -33.62190717488152, -12.543661302043414, -27.153369372302578, -25.106616400543746, -17.675585040646517, -17.59554306024014, -24.451202221183912, -9.444090297777828, -2.2426766274145056, -36.88117320443114, -10.576732691696346, -6.402298295699462], "policy_predator_policy_reward": [24.567668725674917, 23.244400027988576, 0.21359126933010586, 13.358638564293075, 42.429795476491066, 16.279861205282476, -9.620197319899416, 43.57234325331415, 10.282779132432726, 28.69033272213568, 4.3874924740423715, 9.26387381939369, 31.022733314691965, 21.51740480534274, 22.425864058283228, 13.203075603383992, 36.062997296969954, 35.75569408113099, 41.817172131803815, 24.760958597337506, 6.394599204024817, 16.363270141590505, 17.978019371090312, 7.608654621297088, 27.443351129790052, 4.869012693821508, 33.81421974087303, 29.93516110692555, 10.842374068278493, 8.319911671511104, 33.72711961282146, 31.248278148127447, -9.115288381280797, 2.911842094954589, 35.183347277543504, 13.902522711219364, 6.254189370940827, 5.949853817082768, 39.74566909918123, 40.45506892235944, 5.717750376998309, 60.60059573595055, 17.851565341253636, 17.753202448404792, 7.109899377104136, 9.045849927010474, 20.0292218014269, 46.005291243993426, 32.11719812232151, -3.7955098654205788, 0.26405921736096616, 22.998522740768426, 3.679106664495616, 1.1987595320955666, 1.8219316863817117, 29.431896366864738, 28.858672196307566, 23.768380957132667, 26.751987870749623, -6.727535263720794, 29.320938476223272, 25.788698583548136, 29.049105532847516, 31.29911757085889, -8.374176251362002, 3.1295331400568305, -8.466311724486582, 32.63800471687885, 6.284695814933549, 17.164046581924094, -2.140858133078069, 22.085527873270866, 53.21749943227929, 24.264901361745395, 17.123881783963395, 44.26496380906533, 7.125722000553894, 31.19393514179193, 34.39744777499542, -5.045959553342996, 31.984589851689925, 11.40179800672767, 33.25622294904492, 30.930161235440053, 32.785505322604266, 16.689145988747438, 11.75274590409546, 31.314334258093762, 33.62190717488152, 12.543661302043414, 27.153369372302578, 25.106616400543746, 17.675585040646517, 17.59554306024014, 24.451202221183912, 9.444090297777828, 2.2426766274145056, 36.88117320443114, 10.576732691696346, 6.402298295699462]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5356823633300012, "mean_inference_ms": 1.7684789745083318, "mean_action_processing_ms": 0.2223745795009539, "mean_env_wait_ms": 0.13711199685595823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005064845085144043, "StateBufferConnector_ms": 0.002893805503845215, "ViewRequirementAgentConnector_ms": 0.10148584842681885}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 401.62002772404065, "num_env_steps_trained_throughput_per_sec": 401.62002772404065, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 9824.192, "restore_workers_time_ms": 0.024, "training_step_time_ms": 9823.753, "sample_time_ms": 1140.612, "learn_time_ms": 8645.543, "learn_throughput": 462.666, "synch_weights_time_ms": 34.594}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "training_iteration": 29, "trial_id": "1f352_00000", "date": "2024-08-11_14-59-30", "timestamp": 1723402770, "time_this_iter_s": 9.978277921676636, "time_total_s": 285.6928129196167, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4a7af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 285.6928129196167, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 55.642857142857146, "ram_util_percent": 83.37142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3789199555292724, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5325630217790605, "policy_loss": -0.006434183917250872, "vf_loss": 2.538736634825667, "vf_explained_var": 0.8412582410499454, "kl": 0.006948668679285716, "entropy": 0.6755273654436071, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.461528831285735, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.436692997564872, "policy_loss": -0.014610459668620023, "vf_loss": 2.450027037660281, "vf_explained_var": 0.8460846382503708, "kl": 0.017018948321395087, "entropy": 0.9998279777665933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -60.60059573595055, "predator_policy": -9.115288381280797}, "policy_reward_max": {"prey_policy": 9.115288381280797, "predator_policy": 60.60059573595055}, "policy_reward_mean": {"prey_policy": -19.200960452700187, "predator_policy": 19.200960452700187}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-41.817172131803815, -24.760958597337506, -6.394599204024817, -16.363270141590505, -17.978019371090312, -7.608654621297088, -27.443351129790052, -4.869012693821508, -33.81421974087303, -29.93516110692555, -10.842374068278493, -8.319911671511104, -33.72711961282146, -31.248278148127447, 9.115288381280797, -2.911842094954589, -35.183347277543504, -13.902522711219364, -6.254189370940827, -5.949853817082768, -39.74566909918123, -40.45506892235944, -5.717750376998309, -60.60059573595055, -17.851565341253636, -17.753202448404792, -7.109899377104136, -9.045849927010474, -20.0292218014269, -46.005291243993426, -32.11719812232151, 3.7955098654205788, -0.26405921736096616, -22.998522740768426, -3.679106664495616, -1.1987595320955666, -1.8219316863817117, -29.431896366864738, -28.858672196307566, -23.768380957132667, -26.751987870749623, 6.727535263720794, -29.320938476223272, -25.788698583548136, -29.049105532847516, -31.29911757085889, 8.374176251362002, -3.1295331400568305, 8.466311724486582, -32.63800471687885, -6.284695814933549, -17.164046581924094, 2.140858133078069, -22.085527873270866, -53.21749943227929, -24.264901361745395, -17.123881783963395, -44.26496380906533, -7.125722000553894, -31.19393514179193, -34.39744777499542, 5.045959553342996, -31.984589851689925, -11.40179800672767, -33.25622294904492, -30.930161235440053, -32.785505322604266, -16.689145988747438, -11.75274590409546, -31.314334258093762, -33.62190717488152, -12.543661302043414, -27.153369372302578, -25.106616400543746, -17.675585040646517, -17.59554306024014, -24.451202221183912, -9.444090297777828, -2.2426766274145056, -36.88117320443114, -10.576732691696346, -6.402298295699462, -26.260405191676007, -42.890210782199, -18.67433294312786, -15.714603808385284, -10.488777051666696, -13.591362327476421, -11.665319731751556, -12.107438279658107, -20.10545930361363, -32.6346584977972, -8.701999180239326, -39.03732115630168, -10.578062498344243, -8.511383714419882, -5.156614507571598, -26.423603849331037, -20.74975334784546, -13.784512331869093], "policy_predator_policy_reward": [41.817172131803815, 24.760958597337506, 6.394599204024817, 16.363270141590505, 17.978019371090312, 7.608654621297088, 27.443351129790052, 4.869012693821508, 33.81421974087303, 29.93516110692555, 10.842374068278493, 8.319911671511104, 33.72711961282146, 31.248278148127447, -9.115288381280797, 2.911842094954589, 35.183347277543504, 13.902522711219364, 6.254189370940827, 5.949853817082768, 39.74566909918123, 40.45506892235944, 5.717750376998309, 60.60059573595055, 17.851565341253636, 17.753202448404792, 7.109899377104136, 9.045849927010474, 20.0292218014269, 46.005291243993426, 32.11719812232151, -3.7955098654205788, 0.26405921736096616, 22.998522740768426, 3.679106664495616, 1.1987595320955666, 1.8219316863817117, 29.431896366864738, 28.858672196307566, 23.768380957132667, 26.751987870749623, -6.727535263720794, 29.320938476223272, 25.788698583548136, 29.049105532847516, 31.29911757085889, -8.374176251362002, 3.1295331400568305, -8.466311724486582, 32.63800471687885, 6.284695814933549, 17.164046581924094, -2.140858133078069, 22.085527873270866, 53.21749943227929, 24.264901361745395, 17.123881783963395, 44.26496380906533, 7.125722000553894, 31.19393514179193, 34.39744777499542, -5.045959553342996, 31.984589851689925, 11.40179800672767, 33.25622294904492, 30.930161235440053, 32.785505322604266, 16.689145988747438, 11.75274590409546, 31.314334258093762, 33.62190717488152, 12.543661302043414, 27.153369372302578, 25.106616400543746, 17.675585040646517, 17.59554306024014, 24.451202221183912, 9.444090297777828, 2.2426766274145056, 36.88117320443114, 10.576732691696346, 6.402298295699462, 26.260405191676007, 42.890210782199, 18.67433294312786, 15.714603808385284, 10.488777051666696, 13.591362327476421, 11.665319731751556, 12.107438279658107, 20.10545930361363, 32.6346584977972, 8.701999180239326, 39.03732115630168, 10.578062498344243, 8.511383714419882, 5.156614507571598, 26.423603849331037, 20.74975334784546, 13.784512331869093]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.534036100759318, "mean_inference_ms": 1.761978673610313, "mean_action_processing_ms": 0.22149434097804183, "mean_env_wait_ms": 0.13639716936049642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004951357841491699, "StateBufferConnector_ms": 0.002691984176635742, "ViewRequirementAgentConnector_ms": 0.10001611709594727}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 426.06935950107584, "num_env_steps_trained_throughput_per_sec": 426.06935950107584, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 9829.054, "restore_workers_time_ms": 0.025, "training_step_time_ms": 9828.599, "sample_time_ms": 1124.272, "learn_time_ms": 8665.519, "learn_throughput": 461.6, "synch_weights_time_ms": 35.668}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 30, "trial_id": "1f352_00000", "date": "2024-08-11_14-59-40", "timestamp": 1723402780, "time_this_iter_s": 9.44959306716919, "time_total_s": 295.1424059867859, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af47c550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 295.1424059867859, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 53.442857142857136, "ram_util_percent": 83.24285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.625805147799353, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4027834656337896, "policy_loss": -0.004256930605091232, "vf_loss": 2.4068266440182926, "vf_explained_var": 0.8931852381676435, "kl": 0.005700167214850127, "entropy": 0.637093691683064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6571711301182708, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3613932931174832, "policy_loss": -0.005991572903682633, "vf_loss": 2.3667271633942923, "vf_explained_var": 0.8918898125489553, "kl": 0.008769574381161977, "entropy": 0.9497782250245412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -60.60059573595055, "predator_policy": -8.466311724486582}, "policy_reward_max": {"prey_policy": 8.466311724486582, "predator_policy": 60.60059573595055}, "policy_reward_mean": {"prey_policy": -18.960433056172338, "predator_policy": 18.960433056172338}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.254189370940827, -5.949853817082768, -39.74566909918123, -40.45506892235944, -5.717750376998309, -60.60059573595055, -17.851565341253636, -17.753202448404792, -7.109899377104136, -9.045849927010474, -20.0292218014269, -46.005291243993426, -32.11719812232151, 3.7955098654205788, -0.26405921736096616, -22.998522740768426, -3.679106664495616, -1.1987595320955666, -1.8219316863817117, -29.431896366864738, -28.858672196307566, -23.768380957132667, -26.751987870749623, 6.727535263720794, -29.320938476223272, -25.788698583548136, -29.049105532847516, -31.29911757085889, 8.374176251362002, -3.1295331400568305, 8.466311724486582, -32.63800471687885, -6.284695814933549, -17.164046581924094, 2.140858133078069, -22.085527873270866, -53.21749943227929, -24.264901361745395, -17.123881783963395, -44.26496380906533, -7.125722000553894, -31.19393514179193, -34.39744777499542, 5.045959553342996, -31.984589851689925, -11.40179800672767, -33.25622294904492, -30.930161235440053, -32.785505322604266, -16.689145988747438, -11.75274590409546, -31.314334258093762, -33.62190717488152, -12.543661302043414, -27.153369372302578, -25.106616400543746, -17.675585040646517, -17.59554306024014, -24.451202221183912, -9.444090297777828, -2.2426766274145056, -36.88117320443114, -10.576732691696346, -6.402298295699462, -26.260405191676007, -42.890210782199, -18.67433294312786, -15.714603808385284, -10.488777051666696, -13.591362327476421, -11.665319731751556, -12.107438279658107, -20.10545930361363, -32.6346584977972, -8.701999180239326, -39.03732115630168, -10.578062498344243, -8.511383714419882, -5.156614507571598, -26.423603849331037, -20.74975334784546, -13.784512331869093, -9.189299641418527, -26.480529481437607, -37.10832917927054, -13.266837952886117, 3.345117538673195, -26.593789398089434, -20.94049256668034, -5.206387385702648, -18.04700429633902, -41.129565425374444, -33.56549592099023, 0.6562163656141378, -4.908742691819667, -14.730568383483007, -18.263879453335676, -20.921810627705046, 4.603115772692989, -32.20350356139264], "policy_predator_policy_reward": [6.254189370940827, 5.949853817082768, 39.74566909918123, 40.45506892235944, 5.717750376998309, 60.60059573595055, 17.851565341253636, 17.753202448404792, 7.109899377104136, 9.045849927010474, 20.0292218014269, 46.005291243993426, 32.11719812232151, -3.7955098654205788, 0.26405921736096616, 22.998522740768426, 3.679106664495616, 1.1987595320955666, 1.8219316863817117, 29.431896366864738, 28.858672196307566, 23.768380957132667, 26.751987870749623, -6.727535263720794, 29.320938476223272, 25.788698583548136, 29.049105532847516, 31.29911757085889, -8.374176251362002, 3.1295331400568305, -8.466311724486582, 32.63800471687885, 6.284695814933549, 17.164046581924094, -2.140858133078069, 22.085527873270866, 53.21749943227929, 24.264901361745395, 17.123881783963395, 44.26496380906533, 7.125722000553894, 31.19393514179193, 34.39744777499542, -5.045959553342996, 31.984589851689925, 11.40179800672767, 33.25622294904492, 30.930161235440053, 32.785505322604266, 16.689145988747438, 11.75274590409546, 31.314334258093762, 33.62190717488152, 12.543661302043414, 27.153369372302578, 25.106616400543746, 17.675585040646517, 17.59554306024014, 24.451202221183912, 9.444090297777828, 2.2426766274145056, 36.88117320443114, 10.576732691696346, 6.402298295699462, 26.260405191676007, 42.890210782199, 18.67433294312786, 15.714603808385284, 10.488777051666696, 13.591362327476421, 11.665319731751556, 12.107438279658107, 20.10545930361363, 32.6346584977972, 8.701999180239326, 39.03732115630168, 10.578062498344243, 8.511383714419882, 5.156614507571598, 26.423603849331037, 20.74975334784546, 13.784512331869093, 9.189299641418527, 26.480529481437607, 37.10832917927054, 13.266837952886117, -3.345117538673195, 26.593789398089434, 20.94049256668034, 5.206387385702648, 18.04700429633902, 41.129565425374444, 33.56549592099023, -0.6562163656141378, 4.908742691819667, 14.730568383483007, 18.263879453335676, 20.921810627705046, -4.603115772692989, 32.20350356139264]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5320055941603055, "mean_inference_ms": 1.7571293755384414, "mean_action_processing_ms": 0.22075605873002188, "mean_env_wait_ms": 0.13578087603300135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004434704780578613, "StateBufferConnector_ms": 0.0024900436401367188, "ViewRequirementAgentConnector_ms": 0.11368036270141602}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 420.8221957686205, "num_env_steps_trained_throughput_per_sec": 420.8221957686205, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 9748.861, "restore_workers_time_ms": 0.024, "training_step_time_ms": 9748.408, "sample_time_ms": 1165.178, "learn_time_ms": 8544.613, "learn_throughput": 468.131, "synch_weights_time_ms": 35.502}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "training_iteration": 31, "trial_id": "1f352_00000", "date": "2024-08-11_14-59-49", "timestamp": 1723402789, "time_this_iter_s": 9.546782970428467, "time_total_s": 304.68918895721436, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4e3790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 304.68918895721436, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 53.60000000000001, "ram_util_percent": 82.97692307692309}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3680925306553644, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.458347473666072, "policy_loss": -0.0010990740668300229, "vf_loss": 2.45932227311035, "vf_explained_var": 0.8807433371121685, "kl": 0.0033140972471771214, "entropy": 0.6275484004989267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3966511487960815, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.486733237653971, "policy_loss": -0.009004021165795469, "vf_loss": 2.4950863563766084, "vf_explained_var": 0.8716835413128138, "kl": 0.008678731634696405, "entropy": 0.9587386426826318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -53.21749943227929, "predator_policy": -9.044407346264563}, "policy_reward_max": {"prey_policy": 9.044407346264563, "predator_policy": 53.21749943227929}, "policy_reward_mean": {"prey_policy": -19.07378572745051, "predator_policy": 19.07378572745051}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-31.29911757085889, 8.374176251362002, -3.1295331400568305, 8.466311724486582, -32.63800471687885, -6.284695814933549, -17.164046581924094, 2.140858133078069, -22.085527873270866, -53.21749943227929, -24.264901361745395, -17.123881783963395, -44.26496380906533, -7.125722000553894, -31.19393514179193, -34.39744777499542, 5.045959553342996, -31.984589851689925, -11.40179800672767, -33.25622294904492, -30.930161235440053, -32.785505322604266, -16.689145988747438, -11.75274590409546, -31.314334258093762, -33.62190717488152, -12.543661302043414, -27.153369372302578, -25.106616400543746, -17.675585040646517, -17.59554306024014, -24.451202221183912, -9.444090297777828, -2.2426766274145056, -36.88117320443114, -10.576732691696346, -6.402298295699462, -26.260405191676007, -42.890210782199, -18.67433294312786, -15.714603808385284, -10.488777051666696, -13.591362327476421, -11.665319731751556, -12.107438279658107, -20.10545930361363, -32.6346584977972, -8.701999180239326, -39.03732115630168, -10.578062498344243, -8.511383714419882, -5.156614507571598, -26.423603849331037, -20.74975334784546, -13.784512331869093, -9.189299641418527, -26.480529481437607, -37.10832917927054, -13.266837952886117, 3.345117538673195, -26.593789398089434, -20.94049256668034, -5.206387385702648, -18.04700429633902, -41.129565425374444, -33.56549592099023, 0.6562163656141378, -4.908742691819667, -14.730568383483007, -18.263879453335676, -20.921810627705046, 4.603115772692989, -32.20350356139264, -30.825042360798847, -9.440691012928015, -29.91512811075911, -18.216801890211485, -16.44941827266232, -3.1973179926318247, -14.085070420783348, -18.535959604828584, -32.749443385650295, -10.529473556755066, -31.84620788300058, -14.084575928435932, -27.814758738694756, -31.45579576884502, -5.809337975666628, -17.63740653730371, -41.59455548775497, -10.514125612848767, -23.476496254916114, 9.044407346264563, -3.2188854822993083, -8.751853380855637, -37.77838041652385, -19.083098781319578, -37.47439561649699, -9.48012371840168, -37.459700562371566], "policy_predator_policy_reward": [31.29911757085889, -8.374176251362002, 3.1295331400568305, -8.466311724486582, 32.63800471687885, 6.284695814933549, 17.164046581924094, -2.140858133078069, 22.085527873270866, 53.21749943227929, 24.264901361745395, 17.123881783963395, 44.26496380906533, 7.125722000553894, 31.19393514179193, 34.39744777499542, -5.045959553342996, 31.984589851689925, 11.40179800672767, 33.25622294904492, 30.930161235440053, 32.785505322604266, 16.689145988747438, 11.75274590409546, 31.314334258093762, 33.62190717488152, 12.543661302043414, 27.153369372302578, 25.106616400543746, 17.675585040646517, 17.59554306024014, 24.451202221183912, 9.444090297777828, 2.2426766274145056, 36.88117320443114, 10.576732691696346, 6.402298295699462, 26.260405191676007, 42.890210782199, 18.67433294312786, 15.714603808385284, 10.488777051666696, 13.591362327476421, 11.665319731751556, 12.107438279658107, 20.10545930361363, 32.6346584977972, 8.701999180239326, 39.03732115630168, 10.578062498344243, 8.511383714419882, 5.156614507571598, 26.423603849331037, 20.74975334784546, 13.784512331869093, 9.189299641418527, 26.480529481437607, 37.10832917927054, 13.266837952886117, -3.345117538673195, 26.593789398089434, 20.94049256668034, 5.206387385702648, 18.04700429633902, 41.129565425374444, 33.56549592099023, -0.6562163656141378, 4.908742691819667, 14.730568383483007, 18.263879453335676, 20.921810627705046, -4.603115772692989, 32.20350356139264, 30.825042360798847, 9.440691012928015, 29.91512811075911, 18.216801890211485, 16.44941827266232, 3.1973179926318247, 14.085070420783348, 18.535959604828584, 32.749443385650295, 10.529473556755066, 31.84620788300058, 14.084575928435932, 27.814758738694756, 31.45579576884502, 5.809337975666628, 17.63740653730371, 41.59455548775497, 10.514125612848767, 23.476496254916114, -9.044407346264563, 3.2188854822993083, 8.751853380855637, 37.77838041652385, 19.083098781319578, 37.47439561649699, 9.48012371840168, 37.459700562371566]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.531516609846644, "mean_inference_ms": 1.755260188933646, "mean_action_processing_ms": 0.22049754511691316, "mean_env_wait_ms": 0.1354482316208817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003827333450317383, "StateBufferConnector_ms": 0.002878546714782715, "ViewRequirementAgentConnector_ms": 0.10861945152282715}, "num_episodes": 27, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 411.30124679034344, "num_env_steps_trained_throughput_per_sec": 411.30124679034344, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 9706.649, "restore_workers_time_ms": 0.021, "training_step_time_ms": 9706.353, "sample_time_ms": 1235.564, "learn_time_ms": 8441.315, "learn_throughput": 473.86, "synch_weights_time_ms": 26.872}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 32, "trial_id": "1f352_00000", "date": "2024-08-11_14-59-59", "timestamp": 1723402799, "time_this_iter_s": 9.81710171699524, "time_total_s": 314.5062906742096, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a049d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 314.5062906742096, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 55.5, "ram_util_percent": 83.07142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.756015150559445, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.328407985592882, "policy_loss": -0.0032961017946945502, "vf_loss": 2.3316022974749404, "vf_explained_var": 0.9209264845276872, "kl": 0.005428474686325361, "entropy": 0.5614733611543973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8352611074844996, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2438736238827306, "policy_loss": -0.007928377817734145, "vf_loss": 2.250572434812784, "vf_explained_var": 0.9340734933192532, "kl": 0.016394160269782455, "entropy": 0.8942310767248273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.274762691625234, "predator_policy": -9.044407346264563}, "policy_reward_max": {"prey_policy": 9.044407346264563, "predator_policy": 46.274762691625234}, "policy_reward_mean": {"prey_policy": -18.715428534725003, "predator_policy": 18.715428534725003}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.40179800672767, -33.25622294904492, -30.930161235440053, -32.785505322604266, -16.689145988747438, -11.75274590409546, -31.314334258093762, -33.62190717488152, -12.543661302043414, -27.153369372302578, -25.106616400543746, -17.675585040646517, -17.59554306024014, -24.451202221183912, -9.444090297777828, -2.2426766274145056, -36.88117320443114, -10.576732691696346, -6.402298295699462, -26.260405191676007, -42.890210782199, -18.67433294312786, -15.714603808385284, -10.488777051666696, -13.591362327476421, -11.665319731751556, -12.107438279658107, -20.10545930361363, -32.6346584977972, -8.701999180239326, -39.03732115630168, -10.578062498344243, -8.511383714419882, -5.156614507571598, -26.423603849331037, -20.74975334784546, -13.784512331869093, -9.189299641418527, -26.480529481437607, -37.10832917927054, -13.266837952886117, 3.345117538673195, -26.593789398089434, -20.94049256668034, -5.206387385702648, -18.04700429633902, -41.129565425374444, -33.56549592099023, 0.6562163656141378, -4.908742691819667, -14.730568383483007, -18.263879453335676, -20.921810627705046, 4.603115772692989, -32.20350356139264, -30.825042360798847, -9.440691012928015, -29.91512811075911, -18.216801890211485, -16.44941827266232, -3.1973179926318247, -14.085070420783348, -18.535959604828584, -32.749443385650295, -10.529473556755066, -31.84620788300058, -14.084575928435932, -27.814758738694756, -31.45579576884502, -5.809337975666628, -17.63740653730371, -41.59455548775497, -10.514125612848767, -23.476496254916114, 9.044407346264563, -3.2188854822993083, -8.751853380855637, -37.77838041652385, -19.083098781319578, -37.47439561649699, -9.48012371840168, -37.459700562371566, -23.412927850879747, -17.00162061213654, -46.274762691625234, -6.474376672163073, -16.773158697199598, 0.8337953084418945, -30.499349703371003, -18.622407294011282, -25.89751977360487, -16.34467656262911, -12.949442497656987, -19.87675908346804, -17.738226108230954, -18.36520786989152, 4.619284783979245, -14.451839115848566, -4.09428778191022, -12.9873596969819], "policy_predator_policy_reward": [11.40179800672767, 33.25622294904492, 30.930161235440053, 32.785505322604266, 16.689145988747438, 11.75274590409546, 31.314334258093762, 33.62190717488152, 12.543661302043414, 27.153369372302578, 25.106616400543746, 17.675585040646517, 17.59554306024014, 24.451202221183912, 9.444090297777828, 2.2426766274145056, 36.88117320443114, 10.576732691696346, 6.402298295699462, 26.260405191676007, 42.890210782199, 18.67433294312786, 15.714603808385284, 10.488777051666696, 13.591362327476421, 11.665319731751556, 12.107438279658107, 20.10545930361363, 32.6346584977972, 8.701999180239326, 39.03732115630168, 10.578062498344243, 8.511383714419882, 5.156614507571598, 26.423603849331037, 20.74975334784546, 13.784512331869093, 9.189299641418527, 26.480529481437607, 37.10832917927054, 13.266837952886117, -3.345117538673195, 26.593789398089434, 20.94049256668034, 5.206387385702648, 18.04700429633902, 41.129565425374444, 33.56549592099023, -0.6562163656141378, 4.908742691819667, 14.730568383483007, 18.263879453335676, 20.921810627705046, -4.603115772692989, 32.20350356139264, 30.825042360798847, 9.440691012928015, 29.91512811075911, 18.216801890211485, 16.44941827266232, 3.1973179926318247, 14.085070420783348, 18.535959604828584, 32.749443385650295, 10.529473556755066, 31.84620788300058, 14.084575928435932, 27.814758738694756, 31.45579576884502, 5.809337975666628, 17.63740653730371, 41.59455548775497, 10.514125612848767, 23.476496254916114, -9.044407346264563, 3.2188854822993083, 8.751853380855637, 37.77838041652385, 19.083098781319578, 37.47439561649699, 9.48012371840168, 37.459700562371566, 23.412927850879747, 17.00162061213654, 46.274762691625234, 6.474376672163073, 16.773158697199598, -0.8337953084418945, 30.499349703371003, 18.622407294011282, 25.89751977360487, 16.34467656262911, 12.949442497656987, 19.87675908346804, 17.738226108230954, 18.36520786989152, -4.619284783979245, 14.451839115848566, 4.09428778191022, 12.9873596969819]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5291449793352468, "mean_inference_ms": 1.7525575630224757, "mean_action_processing_ms": 0.22002954735434221, "mean_env_wait_ms": 0.1352180372859555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035883188247680664, "StateBufferConnector_ms": 0.002859950065612793, "ViewRequirementAgentConnector_ms": 0.10868573188781738}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.5776175323647, "num_env_steps_trained_throughput_per_sec": 406.5776175323647, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 9716.723, "restore_workers_time_ms": 0.021, "training_step_time_ms": 9716.431, "sample_time_ms": 1263.428, "learn_time_ms": 8423.765, "learn_throughput": 474.847, "synch_weights_time_ms": 26.675}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 33, "trial_id": "1f352_00000", "date": "2024-08-11_15-00-09", "timestamp": 1723402809, "time_this_iter_s": 9.893867015838623, "time_total_s": 324.4001576900482, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af47c670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 324.4001576900482, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 55.92857142857144, "ram_util_percent": 83.09285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3567249567558366, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1416544634848833, "policy_loss": -0.002038010712324952, "vf_loss": 2.14356612910827, "vf_explained_var": 0.908165804296732, "kl": 0.006738985845977771, "entropy": 0.5700985787436366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4403387246032557, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.031658719976743, "policy_loss": -0.004441518583917059, "vf_loss": 2.035580319662889, "vf_explained_var": 0.8896966076145569, "kl": 0.006932203317196202, "entropy": 0.8410528408984344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.274762691625234, "predator_policy": -9.044407346264563}, "policy_reward_max": {"prey_policy": 9.044407346264563, "predator_policy": 46.274762691625234}, "policy_reward_mean": {"prey_policy": -18.77676213017725, "predator_policy": 18.77676213017725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.402298295699462, -26.260405191676007, -42.890210782199, -18.67433294312786, -15.714603808385284, -10.488777051666696, -13.591362327476421, -11.665319731751556, -12.107438279658107, -20.10545930361363, -32.6346584977972, -8.701999180239326, -39.03732115630168, -10.578062498344243, -8.511383714419882, -5.156614507571598, -26.423603849331037, -20.74975334784546, -13.784512331869093, -9.189299641418527, -26.480529481437607, -37.10832917927054, -13.266837952886117, 3.345117538673195, -26.593789398089434, -20.94049256668034, -5.206387385702648, -18.04700429633902, -41.129565425374444, -33.56549592099023, 0.6562163656141378, -4.908742691819667, -14.730568383483007, -18.263879453335676, -20.921810627705046, 4.603115772692989, -32.20350356139264, -30.825042360798847, -9.440691012928015, -29.91512811075911, -18.216801890211485, -16.44941827266232, -3.1973179926318247, -14.085070420783348, -18.535959604828584, -32.749443385650295, -10.529473556755066, -31.84620788300058, -14.084575928435932, -27.814758738694756, -31.45579576884502, -5.809337975666628, -17.63740653730371, -41.59455548775497, -10.514125612848767, -23.476496254916114, 9.044407346264563, -3.2188854822993083, -8.751853380855637, -37.77838041652385, -19.083098781319578, -37.47439561649699, -9.48012371840168, -37.459700562371566, -23.412927850879747, -17.00162061213654, -46.274762691625234, -6.474376672163073, -16.773158697199598, 0.8337953084418945, -30.499349703371003, -18.622407294011282, -25.89751977360487, -16.34467656262911, -12.949442497656987, -19.87675908346804, -17.738226108230954, -18.36520786989152, 4.619284783979245, -14.451839115848566, -4.09428778191022, -12.9873596969819, -23.65079468523177, -22.64712987987207, -16.45533300934075, -2.2098539433037683, -18.30640293757007, -30.6316238611535, -6.850962027658078, -38.33951779655107, -13.569789705882704, -16.91337899459975, -30.96727747714869, -12.229713255685875, -26.151299369512596, -31.183659934512626, -22.91724612002486, -24.727107663122865, -19.584856876514543, -34.21988306545446], "policy_predator_policy_reward": [6.402298295699462, 26.260405191676007, 42.890210782199, 18.67433294312786, 15.714603808385284, 10.488777051666696, 13.591362327476421, 11.665319731751556, 12.107438279658107, 20.10545930361363, 32.6346584977972, 8.701999180239326, 39.03732115630168, 10.578062498344243, 8.511383714419882, 5.156614507571598, 26.423603849331037, 20.74975334784546, 13.784512331869093, 9.189299641418527, 26.480529481437607, 37.10832917927054, 13.266837952886117, -3.345117538673195, 26.593789398089434, 20.94049256668034, 5.206387385702648, 18.04700429633902, 41.129565425374444, 33.56549592099023, -0.6562163656141378, 4.908742691819667, 14.730568383483007, 18.263879453335676, 20.921810627705046, -4.603115772692989, 32.20350356139264, 30.825042360798847, 9.440691012928015, 29.91512811075911, 18.216801890211485, 16.44941827266232, 3.1973179926318247, 14.085070420783348, 18.535959604828584, 32.749443385650295, 10.529473556755066, 31.84620788300058, 14.084575928435932, 27.814758738694756, 31.45579576884502, 5.809337975666628, 17.63740653730371, 41.59455548775497, 10.514125612848767, 23.476496254916114, -9.044407346264563, 3.2188854822993083, 8.751853380855637, 37.77838041652385, 19.083098781319578, 37.47439561649699, 9.48012371840168, 37.459700562371566, 23.412927850879747, 17.00162061213654, 46.274762691625234, 6.474376672163073, 16.773158697199598, -0.8337953084418945, 30.499349703371003, 18.622407294011282, 25.89751977360487, 16.34467656262911, 12.949442497656987, 19.87675908346804, 17.738226108230954, 18.36520786989152, -4.619284783979245, 14.451839115848566, 4.09428778191022, 12.9873596969819, 23.65079468523177, 22.64712987987207, 16.45533300934075, 2.2098539433037683, 18.30640293757007, 30.6316238611535, 6.850962027658078, 38.33951779655107, 13.569789705882704, 16.91337899459975, 30.96727747714869, 12.229713255685875, 26.151299369512596, 31.183659934512626, 22.91724612002486, 24.727107663122865, 19.584856876514543, 34.21988306545446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5284891500066359, "mean_inference_ms": 1.7516534333862714, "mean_action_processing_ms": 0.21985875377042496, "mean_env_wait_ms": 0.13516696298504027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003659486770629883, "StateBufferConnector_ms": 0.0029463768005371094, "ViewRequirementAgentConnector_ms": 0.11233055591583252}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.287593822669, "num_env_steps_trained_throughput_per_sec": 440.287593822669, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 9667.527, "restore_workers_time_ms": 0.021, "training_step_time_ms": 9667.173, "sample_time_ms": 1271.236, "learn_time_ms": 8368.058, "learn_throughput": 478.008, "synch_weights_time_ms": 25.95}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 34, "trial_id": "1f352_00000", "date": "2024-08-11_15-00-19", "timestamp": 1723402819, "time_this_iter_s": 9.167846918106079, "time_total_s": 333.5680046081543, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af47c4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 333.5680046081543, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 50.646153846153844, "ram_util_percent": 83.05384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7130769561355312, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2686243961254755, "policy_loss": -0.0021493372427357827, "vf_loss": 2.2706871314595145, "vf_explained_var": 0.9165527337541183, "kl": 0.00461837000772789, "entropy": 0.530066283668081, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8834087915097673, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.339343453447024, "policy_loss": -0.0050243319732544475, "vf_loss": 2.3438740089535712, "vf_explained_var": 0.9124495060493548, "kl": 0.006583569274209124, "entropy": 0.8403025427212317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -48.753738520099375, "predator_policy": -9.044407346264563}, "policy_reward_max": {"prey_policy": 9.044407346264563, "predator_policy": 48.753738520099375}, "policy_reward_mean": {"prey_policy": -18.57320535668671, "predator_policy": 18.57320535668671}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.784512331869093, -9.189299641418527, -26.480529481437607, -37.10832917927054, -13.266837952886117, 3.345117538673195, -26.593789398089434, -20.94049256668034, -5.206387385702648, -18.04700429633902, -41.129565425374444, -33.56549592099023, 0.6562163656141378, -4.908742691819667, -14.730568383483007, -18.263879453335676, -20.921810627705046, 4.603115772692989, -32.20350356139264, -30.825042360798847, -9.440691012928015, -29.91512811075911, -18.216801890211485, -16.44941827266232, -3.1973179926318247, -14.085070420783348, -18.535959604828584, -32.749443385650295, -10.529473556755066, -31.84620788300058, -14.084575928435932, -27.814758738694756, -31.45579576884502, -5.809337975666628, -17.63740653730371, -41.59455548775497, -10.514125612848767, -23.476496254916114, 9.044407346264563, -3.2188854822993083, -8.751853380855637, -37.77838041652385, -19.083098781319578, -37.47439561649699, -9.48012371840168, -37.459700562371566, -23.412927850879747, -17.00162061213654, -46.274762691625234, -6.474376672163073, -16.773158697199598, 0.8337953084418945, -30.499349703371003, -18.622407294011282, -25.89751977360487, -16.34467656262911, -12.949442497656987, -19.87675908346804, -17.738226108230954, -18.36520786989152, 4.619284783979245, -14.451839115848566, -4.09428778191022, -12.9873596969819, -23.65079468523177, -22.64712987987207, -16.45533300934075, -2.2098539433037683, -18.30640293757007, -30.6316238611535, -6.850962027658078, -38.33951779655107, -13.569789705882704, -16.91337899459975, -30.96727747714869, -12.229713255685875, -26.151299369512596, -31.183659934512626, -22.91724612002486, -24.727107663122865, -19.584856876514543, -34.21988306545446, -35.01465287132893, -5.175015933191199, -31.61210070980889, -20.975863864747808, -2.0859449606602007, -1.8632658704155869, -16.327476241884064, -33.02149591739584, -18.174030790926107, -48.753738520099375, -5.902525787129105, -44.47280580424902, 1.4546770577718924, -15.589341726221855, 5.973516613711517, -13.542509125015034, -15.614838869650857, -8.640513796809934], "policy_predator_policy_reward": [13.784512331869093, 9.189299641418527, 26.480529481437607, 37.10832917927054, 13.266837952886117, -3.345117538673195, 26.593789398089434, 20.94049256668034, 5.206387385702648, 18.04700429633902, 41.129565425374444, 33.56549592099023, -0.6562163656141378, 4.908742691819667, 14.730568383483007, 18.263879453335676, 20.921810627705046, -4.603115772692989, 32.20350356139264, 30.825042360798847, 9.440691012928015, 29.91512811075911, 18.216801890211485, 16.44941827266232, 3.1973179926318247, 14.085070420783348, 18.535959604828584, 32.749443385650295, 10.529473556755066, 31.84620788300058, 14.084575928435932, 27.814758738694756, 31.45579576884502, 5.809337975666628, 17.63740653730371, 41.59455548775497, 10.514125612848767, 23.476496254916114, -9.044407346264563, 3.2188854822993083, 8.751853380855637, 37.77838041652385, 19.083098781319578, 37.47439561649699, 9.48012371840168, 37.459700562371566, 23.412927850879747, 17.00162061213654, 46.274762691625234, 6.474376672163073, 16.773158697199598, -0.8337953084418945, 30.499349703371003, 18.622407294011282, 25.89751977360487, 16.34467656262911, 12.949442497656987, 19.87675908346804, 17.738226108230954, 18.36520786989152, -4.619284783979245, 14.451839115848566, 4.09428778191022, 12.9873596969819, 23.65079468523177, 22.64712987987207, 16.45533300934075, 2.2098539433037683, 18.30640293757007, 30.6316238611535, 6.850962027658078, 38.33951779655107, 13.569789705882704, 16.91337899459975, 30.96727747714869, 12.229713255685875, 26.151299369512596, 31.183659934512626, 22.91724612002486, 24.727107663122865, 19.584856876514543, 34.21988306545446, 35.01465287132893, 5.175015933191199, 31.61210070980889, 20.975863864747808, 2.0859449606602007, 1.8632658704155869, 16.327476241884064, 33.02149591739584, 18.174030790926107, 48.753738520099375, 5.902525787129105, 44.47280580424902, -1.4546770577718924, 15.589341726221855, -5.973516613711517, 13.542509125015034, 15.614838869650857, 8.640513796809934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5286383408039196, "mean_inference_ms": 1.7546150592047411, "mean_action_processing_ms": 0.22016164827284243, "mean_env_wait_ms": 0.13529248016759102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038105249404907227, "StateBufferConnector_ms": 0.003086566925048828, "ViewRequirementAgentConnector_ms": 0.13273406028747559}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 377.7396863330736, "num_env_steps_trained_throughput_per_sec": 377.7396863330736, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 9762.634, "restore_workers_time_ms": 0.028, "training_step_time_ms": 9762.262, "sample_time_ms": 1276.34, "learn_time_ms": 8457.484, "learn_throughput": 472.954, "synch_weights_time_ms": 26.375}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 35, "trial_id": "1f352_00000", "date": "2024-08-11_15-00-29", "timestamp": 1723402829, "time_this_iter_s": 10.690006017684937, "time_total_s": 344.25801062583923, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4879d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 344.25801062583923, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 58.57333333333334, "ram_util_percent": 83.29333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7138282822445037, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3066353234152, "policy_loss": -0.0031886265317249735, "vf_loss": 2.3097564737002054, "vf_explained_var": 0.9375714852164189, "kl": 0.007197066626270416, "entropy": 0.5494959465228021, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.588360233356555, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3036694654573995, "policy_loss": -0.006951559400719513, "vf_loss": 2.310363300020496, "vf_explained_var": 0.9340206600725651, "kl": 0.0034362758731347753, "entropy": 0.8517742071300745, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.4057567353438, "predator_policy": -9.044407346264563}, "policy_reward_max": {"prey_policy": 9.044407346264563, "predator_policy": 54.4057567353438}, "policy_reward_mean": {"prey_policy": -19.802979472827236, "predator_policy": 19.802979472827236}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.216801890211485, -16.44941827266232, -3.1973179926318247, -14.085070420783348, -18.535959604828584, -32.749443385650295, -10.529473556755066, -31.84620788300058, -14.084575928435932, -27.814758738694756, -31.45579576884502, -5.809337975666628, -17.63740653730371, -41.59455548775497, -10.514125612848767, -23.476496254916114, 9.044407346264563, -3.2188854822993083, -8.751853380855637, -37.77838041652385, -19.083098781319578, -37.47439561649699, -9.48012371840168, -37.459700562371566, -23.412927850879747, -17.00162061213654, -46.274762691625234, -6.474376672163073, -16.773158697199598, 0.8337953084418945, -30.499349703371003, -18.622407294011282, -25.89751977360487, -16.34467656262911, -12.949442497656987, -19.87675908346804, -17.738226108230954, -18.36520786989152, 4.619284783979245, -14.451839115848566, -4.09428778191022, -12.9873596969819, -23.65079468523177, -22.64712987987207, -16.45533300934075, -2.2098539433037683, -18.30640293757007, -30.6316238611535, -6.850962027658078, -38.33951779655107, -13.569789705882704, -16.91337899459975, -30.96727747714869, -12.229713255685875, -26.151299369512596, -31.183659934512626, -22.91724612002486, -24.727107663122865, -19.584856876514543, -34.21988306545446, -35.01465287132893, -5.175015933191199, -31.61210070980889, -20.975863864747808, -2.0859449606602007, -1.8632658704155869, -16.327476241884064, -33.02149591739584, -18.174030790926107, -48.753738520099375, -5.902525787129105, -44.47280580424902, 1.4546770577718924, -15.589341726221855, 5.973516613711517, -13.542509125015034, -15.614838869650857, -8.640513796809934, -9.100232800172131, -43.295966917688844, -54.4057567353438, -40.67236325887357, -21.390477200147682, -9.965130839223313, -0.8351342834838071, -36.987423779460556, -25.217288289655762, -35.656393788522855, -22.349495247459572, -33.887769688382065, 5.370099004060953, -25.40783550017548, -3.0086665121942375, -19.127406497785426, -38.20364536240663, -17.506316128501027, -18.133379530838262, -21.113637384865367, -19.341097415824233, -30.65925356240829], "policy_predator_policy_reward": [18.216801890211485, 16.44941827266232, 3.1973179926318247, 14.085070420783348, 18.535959604828584, 32.749443385650295, 10.529473556755066, 31.84620788300058, 14.084575928435932, 27.814758738694756, 31.45579576884502, 5.809337975666628, 17.63740653730371, 41.59455548775497, 10.514125612848767, 23.476496254916114, -9.044407346264563, 3.2188854822993083, 8.751853380855637, 37.77838041652385, 19.083098781319578, 37.47439561649699, 9.48012371840168, 37.459700562371566, 23.412927850879747, 17.00162061213654, 46.274762691625234, 6.474376672163073, 16.773158697199598, -0.8337953084418945, 30.499349703371003, 18.622407294011282, 25.89751977360487, 16.34467656262911, 12.949442497656987, 19.87675908346804, 17.738226108230954, 18.36520786989152, -4.619284783979245, 14.451839115848566, 4.09428778191022, 12.9873596969819, 23.65079468523177, 22.64712987987207, 16.45533300934075, 2.2098539433037683, 18.30640293757007, 30.6316238611535, 6.850962027658078, 38.33951779655107, 13.569789705882704, 16.91337899459975, 30.96727747714869, 12.229713255685875, 26.151299369512596, 31.183659934512626, 22.91724612002486, 24.727107663122865, 19.584856876514543, 34.21988306545446, 35.01465287132893, 5.175015933191199, 31.61210070980889, 20.975863864747808, 2.0859449606602007, 1.8632658704155869, 16.327476241884064, 33.02149591739584, 18.174030790926107, 48.753738520099375, 5.902525787129105, 44.47280580424902, -1.4546770577718924, 15.589341726221855, -5.973516613711517, 13.542509125015034, 15.614838869650857, 8.640513796809934, 9.100232800172131, 43.295966917688844, 54.4057567353438, 40.67236325887357, 21.390477200147682, 9.965130839223313, 0.8351342834838071, 36.987423779460556, 25.217288289655762, 35.656393788522855, 22.349495247459572, 33.887769688382065, -5.370099004060953, 25.40783550017548, 3.0086665121942375, 19.127406497785426, 38.20364536240663, 17.506316128501027, 18.133379530838262, 21.113637384865367, 19.341097415824233, 30.65925356240829]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5306287308544835, "mean_inference_ms": 1.7602976446277847, "mean_action_processing_ms": 0.22092797425440935, "mean_env_wait_ms": 0.1356527066433963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038629770278930664, "StateBufferConnector_ms": 0.0031358003616333008, "ViewRequirementAgentConnector_ms": 0.10677194595336914}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 414.6749389013003, "num_env_steps_trained_throughput_per_sec": 414.6749389013003, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 9754.304, "restore_workers_time_ms": 0.027, "training_step_time_ms": 9753.925, "sample_time_ms": 1275.432, "learn_time_ms": 8447.968, "learn_throughput": 473.487, "synch_weights_time_ms": 28.405}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 36, "trial_id": "1f352_00000", "date": "2024-08-11_15-00-39", "timestamp": 1723402839, "time_this_iter_s": 9.718206882476807, "time_total_s": 353.97621750831604, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b187b670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 353.97621750831604, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 56.61428571428572, "ram_util_percent": 83.38571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6668553380916515, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1996676630030074, "policy_loss": -0.001962906974707342, "vf_loss": 2.2015711959451436, "vf_explained_var": 0.9443168142189582, "kl": 0.006333027076457578, "entropy": 0.5233496059042712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.644417021671931, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2373754321907957, "policy_loss": -0.00650763576340978, "vf_loss": 2.2434897045294444, "vf_explained_var": 0.9383048482239247, "kl": 0.010489778496916813, "entropy": 0.8169211908554037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.4057567353438, "predator_policy": -12.203309407919617}, "policy_reward_max": {"prey_policy": 12.203309407919617, "predator_policy": 54.4057567353438}, "policy_reward_mean": {"prey_policy": -19.405180246141004, "predator_policy": 19.405180246141004}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-37.459700562371566, -23.412927850879747, -17.00162061213654, -46.274762691625234, -6.474376672163073, -16.773158697199598, 0.8337953084418945, -30.499349703371003, -18.622407294011282, -25.89751977360487, -16.34467656262911, -12.949442497656987, -19.87675908346804, -17.738226108230954, -18.36520786989152, 4.619284783979245, -14.451839115848566, -4.09428778191022, -12.9873596969819, -23.65079468523177, -22.64712987987207, -16.45533300934075, -2.2098539433037683, -18.30640293757007, -30.6316238611535, -6.850962027658078, -38.33951779655107, -13.569789705882704, -16.91337899459975, -30.96727747714869, -12.229713255685875, -26.151299369512596, -31.183659934512626, -22.91724612002486, -24.727107663122865, -19.584856876514543, -34.21988306545446, -35.01465287132893, -5.175015933191199, -31.61210070980889, -20.975863864747808, -2.0859449606602007, -1.8632658704155869, -16.327476241884064, -33.02149591739584, -18.174030790926107, -48.753738520099375, -5.902525787129105, -44.47280580424902, 1.4546770577718924, -15.589341726221855, 5.973516613711517, -13.542509125015034, -15.614838869650857, -8.640513796809934, -9.100232800172131, -43.295966917688844, -54.4057567353438, -40.67236325887357, -21.390477200147682, -9.965130839223313, -0.8351342834838071, -36.987423779460556, -25.217288289655762, -35.656393788522855, -22.349495247459572, -33.887769688382065, 5.370099004060953, -25.40783550017548, -3.0086665121942375, -19.127406497785426, -38.20364536240663, -17.506316128501027, -18.133379530838262, -21.113637384865367, -19.341097415824233, -30.65925356240829, -26.40230388311506, -19.051516426680262, -48.27075852555005, -13.082755405031694, -26.95209578462895, 1.8027688543543663, -1.8455088150722219, -23.284209139104433, -21.81422831977994, -5.039710015500359, -2.8014285390728064, -16.462006065900045, -27.3428130319666, -37.40314294933379, 12.203309407919617, -3.6128892711893634, -39.937862871038895, -6.87500674755313, -27.48218946753815, -16.82472236389607, -18.802407628557773, -11.004511711712432, -4.673163992050885], "policy_predator_policy_reward": [37.459700562371566, 23.412927850879747, 17.00162061213654, 46.274762691625234, 6.474376672163073, 16.773158697199598, -0.8337953084418945, 30.499349703371003, 18.622407294011282, 25.89751977360487, 16.34467656262911, 12.949442497656987, 19.87675908346804, 17.738226108230954, 18.36520786989152, -4.619284783979245, 14.451839115848566, 4.09428778191022, 12.9873596969819, 23.65079468523177, 22.64712987987207, 16.45533300934075, 2.2098539433037683, 18.30640293757007, 30.6316238611535, 6.850962027658078, 38.33951779655107, 13.569789705882704, 16.91337899459975, 30.96727747714869, 12.229713255685875, 26.151299369512596, 31.183659934512626, 22.91724612002486, 24.727107663122865, 19.584856876514543, 34.21988306545446, 35.01465287132893, 5.175015933191199, 31.61210070980889, 20.975863864747808, 2.0859449606602007, 1.8632658704155869, 16.327476241884064, 33.02149591739584, 18.174030790926107, 48.753738520099375, 5.902525787129105, 44.47280580424902, -1.4546770577718924, 15.589341726221855, -5.973516613711517, 13.542509125015034, 15.614838869650857, 8.640513796809934, 9.100232800172131, 43.295966917688844, 54.4057567353438, 40.67236325887357, 21.390477200147682, 9.965130839223313, 0.8351342834838071, 36.987423779460556, 25.217288289655762, 35.656393788522855, 22.349495247459572, 33.887769688382065, -5.370099004060953, 25.40783550017548, 3.0086665121942375, 19.127406497785426, 38.20364536240663, 17.506316128501027, 18.133379530838262, 21.113637384865367, 19.341097415824233, 30.65925356240829, 26.40230388311506, 19.051516426680262, 48.27075852555005, 13.082755405031694, 26.95209578462895, -1.8027688543543663, 1.8455088150722219, 23.284209139104433, 21.81422831977994, 5.039710015500359, 2.8014285390728064, 16.462006065900045, 27.3428130319666, 37.40314294933379, -12.203309407919617, 3.6128892711893634, 39.937862871038895, 6.87500674755313, 27.48218946753815, 16.82472236389607, 18.802407628557773, 11.004511711712432, 4.673163992050885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266960727602525, "mean_inference_ms": 1.7516071728915514, "mean_action_processing_ms": 0.21959855739252276, "mean_env_wait_ms": 0.13502568130486403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037059783935546875, "StateBufferConnector_ms": 0.0027894973754882812, "ViewRequirementAgentConnector_ms": 0.09685003757476807}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.91194985825797, "num_env_steps_trained_throughput_per_sec": 440.91194985825797, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 9674.34, "restore_workers_time_ms": 0.035, "training_step_time_ms": 9674.026, "sample_time_ms": 1250.502, "learn_time_ms": 8394.504, "learn_throughput": 476.502, "synch_weights_time_ms": 27.039}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "training_iteration": 37, "trial_id": "1f352_00000", "date": "2024-08-11_15-00-48", "timestamp": 1723402848, "time_this_iter_s": 9.129127025604248, "time_total_s": 363.1053445339203, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4f5f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 363.1053445339203, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 52.75384615384615, "ram_util_percent": 83.3153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.849478771102925, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0039850066105527, "policy_loss": -0.001167590890933449, "vf_loss": 2.005111862098177, "vf_explained_var": 0.9412516450509429, "kl": 0.0043448983653972895, "entropy": 0.5106971606612205, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.654581499348084, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0042731524755557, "policy_loss": -0.0067595679611258674, "vf_loss": 2.010791108881434, "vf_explained_var": 0.9531610011433561, "kl": 0.006443074721118, "entropy": 0.7997882371147473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.4057567353438, "predator_policy": -12.203309407919617}, "policy_reward_max": {"prey_policy": 12.203309407919617, "predator_policy": 54.4057567353438}, "policy_reward_mean": {"prey_policy": -19.059519689898863, "predator_policy": 19.059519689898863}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.9873596969819, -23.65079468523177, -22.64712987987207, -16.45533300934075, -2.2098539433037683, -18.30640293757007, -30.6316238611535, -6.850962027658078, -38.33951779655107, -13.569789705882704, -16.91337899459975, -30.96727747714869, -12.229713255685875, -26.151299369512596, -31.183659934512626, -22.91724612002486, -24.727107663122865, -19.584856876514543, -34.21988306545446, -35.01465287132893, -5.175015933191199, -31.61210070980889, -20.975863864747808, -2.0859449606602007, -1.8632658704155869, -16.327476241884064, -33.02149591739584, -18.174030790926107, -48.753738520099375, -5.902525787129105, -44.47280580424902, 1.4546770577718924, -15.589341726221855, 5.973516613711517, -13.542509125015034, -15.614838869650857, -8.640513796809934, -9.100232800172131, -43.295966917688844, -54.4057567353438, -40.67236325887357, -21.390477200147682, -9.965130839223313, -0.8351342834838071, -36.987423779460556, -25.217288289655762, -35.656393788522855, -22.349495247459572, -33.887769688382065, 5.370099004060953, -25.40783550017548, -3.0086665121942375, -19.127406497785426, -38.20364536240663, -17.506316128501027, -18.133379530838262, -21.113637384865367, -19.341097415824233, -30.65925356240829, -26.40230388311506, -19.051516426680262, -48.27075852555005, -13.082755405031694, -26.95209578462895, 1.8027688543543663, -1.8455088150722219, -23.284209139104433, -21.81422831977994, -5.039710015500359, -2.8014285390728064, -16.462006065900045, -27.3428130319666, -37.40314294933379, 12.203309407919617, -3.6128892711893634, -39.937862871038895, -6.87500674755313, -27.48218946753815, -16.82472236389607, -18.802407628557773, -11.004511711712432, -4.673163992050885, -9.769691197978664, -0.7300706833651311, -7.171678048284913, -11.483716289506052, -22.284936340078037, 1.1158258799852696, -8.913989865454463, -14.371963968924826, -19.351527221618785, -36.87125715562229, -24.031320421808722, -1.8051894326078752, -41.46904372615033, -34.284474816499674, 0.3872427451745164, 5.156343180576229, -34.27718931614446, -26.060490482055066], "policy_predator_policy_reward": [12.9873596969819, 23.65079468523177, 22.64712987987207, 16.45533300934075, 2.2098539433037683, 18.30640293757007, 30.6316238611535, 6.850962027658078, 38.33951779655107, 13.569789705882704, 16.91337899459975, 30.96727747714869, 12.229713255685875, 26.151299369512596, 31.183659934512626, 22.91724612002486, 24.727107663122865, 19.584856876514543, 34.21988306545446, 35.01465287132893, 5.175015933191199, 31.61210070980889, 20.975863864747808, 2.0859449606602007, 1.8632658704155869, 16.327476241884064, 33.02149591739584, 18.174030790926107, 48.753738520099375, 5.902525787129105, 44.47280580424902, -1.4546770577718924, 15.589341726221855, -5.973516613711517, 13.542509125015034, 15.614838869650857, 8.640513796809934, 9.100232800172131, 43.295966917688844, 54.4057567353438, 40.67236325887357, 21.390477200147682, 9.965130839223313, 0.8351342834838071, 36.987423779460556, 25.217288289655762, 35.656393788522855, 22.349495247459572, 33.887769688382065, -5.370099004060953, 25.40783550017548, 3.0086665121942375, 19.127406497785426, 38.20364536240663, 17.506316128501027, 18.133379530838262, 21.113637384865367, 19.341097415824233, 30.65925356240829, 26.40230388311506, 19.051516426680262, 48.27075852555005, 13.082755405031694, 26.95209578462895, -1.8027688543543663, 1.8455088150722219, 23.284209139104433, 21.81422831977994, 5.039710015500359, 2.8014285390728064, 16.462006065900045, 27.3428130319666, 37.40314294933379, -12.203309407919617, 3.6128892711893634, 39.937862871038895, 6.87500674755313, 27.48218946753815, 16.82472236389607, 18.802407628557773, 11.004511711712432, 4.673163992050885, 9.769691197978664, 0.7300706833651311, 7.171678048284913, 11.483716289506052, 22.284936340078037, -1.1158258799852696, 8.913989865454463, 14.371963968924826, 19.351527221618785, 36.87125715562229, 24.031320421808722, 1.8051894326078752, 41.46904372615033, 34.284474816499674, -0.3872427451745164, -5.156343180576229, 34.27718931614446, 26.060490482055066]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.526100695522603, "mean_inference_ms": 1.7513330298648158, "mean_action_processing_ms": 0.21941382114254196, "mean_env_wait_ms": 0.1350807284312962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003943085670471191, "StateBufferConnector_ms": 0.002911210060119629, "ViewRequirementAgentConnector_ms": 0.11191821098327637}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 389.15283999631566, "num_env_steps_trained_throughput_per_sec": 389.15283999631566, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 9708.84, "restore_workers_time_ms": 0.035, "training_step_time_ms": 9708.526, "sample_time_ms": 1284.763, "learn_time_ms": 8395.268, "learn_throughput": 476.459, "synch_weights_time_ms": 26.441}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 38, "trial_id": "1f352_00000", "date": "2024-08-11_15-00-59", "timestamp": 1723402859, "time_this_iter_s": 10.3054518699646, "time_total_s": 373.4107964038849, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b18a3790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 373.4107964038849, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 54.45333333333334, "ram_util_percent": 83.32666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4928171655163167, "cur_kl_coeff": 0.004687499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2849405903369187, "policy_loss": -0.003087618257510864, "vf_loss": 2.287997357423107, "vf_explained_var": 0.937031901627779, "kl": 0.006578846724552253, "entropy": 0.5537797383964062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.428176483201484, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3167801283299925, "policy_loss": -0.008047599324102823, "vf_loss": 2.3242067358146112, "vf_explained_var": 0.9314937544365723, "kl": 0.016559573422322, "entropy": 0.8169451145455241, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.4057567353438, "predator_policy": -12.203309407919617}, "policy_reward_max": {"prey_policy": 12.203309407919617, "predator_policy": 54.4057567353438}, "policy_reward_mean": {"prey_policy": -18.669496092007627, "predator_policy": 18.669496092007627}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-34.21988306545446, -35.01465287132893, -5.175015933191199, -31.61210070980889, -20.975863864747808, -2.0859449606602007, -1.8632658704155869, -16.327476241884064, -33.02149591739584, -18.174030790926107, -48.753738520099375, -5.902525787129105, -44.47280580424902, 1.4546770577718924, -15.589341726221855, 5.973516613711517, -13.542509125015034, -15.614838869650857, -8.640513796809934, -9.100232800172131, -43.295966917688844, -54.4057567353438, -40.67236325887357, -21.390477200147682, -9.965130839223313, -0.8351342834838071, -36.987423779460556, -25.217288289655762, -35.656393788522855, -22.349495247459572, -33.887769688382065, 5.370099004060953, -25.40783550017548, -3.0086665121942375, -19.127406497785426, -38.20364536240663, -17.506316128501027, -18.133379530838262, -21.113637384865367, -19.341097415824233, -30.65925356240829, -26.40230388311506, -19.051516426680262, -48.27075852555005, -13.082755405031694, -26.95209578462895, 1.8027688543543663, -1.8455088150722219, -23.284209139104433, -21.81422831977994, -5.039710015500359, -2.8014285390728064, -16.462006065900045, -27.3428130319666, -37.40314294933379, 12.203309407919617, -3.6128892711893634, -39.937862871038895, -6.87500674755313, -27.48218946753815, -16.82472236389607, -18.802407628557773, -11.004511711712432, -4.673163992050885, -9.769691197978664, -0.7300706833651311, -7.171678048284913, -11.483716289506052, -22.284936340078037, 1.1158258799852696, -8.913989865454463, -14.371963968924826, -19.351527221618785, -36.87125715562229, -24.031320421808722, -1.8051894326078752, -41.46904372615033, -34.284474816499674, 0.3872427451745164, 5.156343180576229, -34.27718931614446, -26.060490482055066, 1.0993475517897657, -36.92591171885552, -22.0261546244994, -12.975274956087919, -13.802443872776779, -31.72725954375453, -37.51953494352045, -17.60827701998591, -11.511356013643052, -3.0647891183801415, -20.809829048545016, -16.572262314346116, -25.20291312412018, -0.4007963117336413, -22.15110278091692, -16.27880903770998, -13.295445991769286, -30.548134576688632], "policy_predator_policy_reward": [34.21988306545446, 35.01465287132893, 5.175015933191199, 31.61210070980889, 20.975863864747808, 2.0859449606602007, 1.8632658704155869, 16.327476241884064, 33.02149591739584, 18.174030790926107, 48.753738520099375, 5.902525787129105, 44.47280580424902, -1.4546770577718924, 15.589341726221855, -5.973516613711517, 13.542509125015034, 15.614838869650857, 8.640513796809934, 9.100232800172131, 43.295966917688844, 54.4057567353438, 40.67236325887357, 21.390477200147682, 9.965130839223313, 0.8351342834838071, 36.987423779460556, 25.217288289655762, 35.656393788522855, 22.349495247459572, 33.887769688382065, -5.370099004060953, 25.40783550017548, 3.0086665121942375, 19.127406497785426, 38.20364536240663, 17.506316128501027, 18.133379530838262, 21.113637384865367, 19.341097415824233, 30.65925356240829, 26.40230388311506, 19.051516426680262, 48.27075852555005, 13.082755405031694, 26.95209578462895, -1.8027688543543663, 1.8455088150722219, 23.284209139104433, 21.81422831977994, 5.039710015500359, 2.8014285390728064, 16.462006065900045, 27.3428130319666, 37.40314294933379, -12.203309407919617, 3.6128892711893634, 39.937862871038895, 6.87500674755313, 27.48218946753815, 16.82472236389607, 18.802407628557773, 11.004511711712432, 4.673163992050885, 9.769691197978664, 0.7300706833651311, 7.171678048284913, 11.483716289506052, 22.284936340078037, -1.1158258799852696, 8.913989865454463, 14.371963968924826, 19.351527221618785, 36.87125715562229, 24.031320421808722, 1.8051894326078752, 41.46904372615033, 34.284474816499674, -0.3872427451745164, -5.156343180576229, 34.27718931614446, 26.060490482055066, -1.0993475517897657, 36.92591171885552, 22.0261546244994, 12.975274956087919, 13.802443872776779, 31.72725954375453, 37.51953494352045, 17.60827701998591, 11.511356013643052, 3.0647891183801415, 20.809829048545016, 16.572262314346116, 25.20291312412018, 0.4007963117336413, 22.15110278091692, 16.27880903770998, 13.295445991769286, 30.548134576688632]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.526022944275075, "mean_inference_ms": 1.7549485885785976, "mean_action_processing_ms": 0.21957979666971147, "mean_env_wait_ms": 0.1354516196656853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003945469856262207, "StateBufferConnector_ms": 0.002894282341003418, "ViewRequirementAgentConnector_ms": 0.13235414028167725}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 413.4399955524415, "num_env_steps_trained_throughput_per_sec": 413.4399955524415, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 9680.365, "restore_workers_time_ms": 0.034, "training_step_time_ms": 9680.046, "sample_time_ms": 1337.644, "learn_time_ms": 8314.146, "learn_throughput": 481.108, "synch_weights_time_ms": 26.173}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 39, "trial_id": "1f352_00000", "date": "2024-08-11_15-01-08", "timestamp": 1723402868, "time_this_iter_s": 9.738770008087158, "time_total_s": 383.14956641197205, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b18a34c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 383.14956641197205, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 53.28571428571429, "ram_util_percent": 83.19285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.643475232583781, "cur_kl_coeff": 0.004687499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8974528228243193, "policy_loss": -0.004054213361087022, "vf_loss": 1.9014630374809107, "vf_explained_var": 0.9339710167919596, "kl": 0.009388226105010656, "entropy": 0.5711884655058383, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.806528402554492, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8681177385772267, "policy_loss": -0.006579695641024349, "vf_loss": 1.8742855627089738, "vf_explained_var": 0.9558756309250991, "kl": 0.010983182049669553, "entropy": 0.8551594051842888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.10539141096376, "predator_policy": -12.203309407919617}, "policy_reward_max": {"prey_policy": 12.203309407919617, "predator_policy": 49.10539141096376}, "policy_reward_mean": {"prey_policy": -18.771993793690744, "predator_policy": 18.771993793690744}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-40.67236325887357, -21.390477200147682, -9.965130839223313, -0.8351342834838071, -36.987423779460556, -25.217288289655762, -35.656393788522855, -22.349495247459572, -33.887769688382065, 5.370099004060953, -25.40783550017548, -3.0086665121942375, -19.127406497785426, -38.20364536240663, -17.506316128501027, -18.133379530838262, -21.113637384865367, -19.341097415824233, -30.65925356240829, -26.40230388311506, -19.051516426680262, -48.27075852555005, -13.082755405031694, -26.95209578462895, 1.8027688543543663, -1.8455088150722219, -23.284209139104433, -21.81422831977994, -5.039710015500359, -2.8014285390728064, -16.462006065900045, -27.3428130319666, -37.40314294933379, 12.203309407919617, -3.6128892711893634, -39.937862871038895, -6.87500674755313, -27.48218946753815, -16.82472236389607, -18.802407628557773, -11.004511711712432, -4.673163992050885, -9.769691197978664, -0.7300706833651311, -7.171678048284913, -11.483716289506052, -22.284936340078037, 1.1158258799852696, -8.913989865454463, -14.371963968924826, -19.351527221618785, -36.87125715562229, -24.031320421808722, -1.8051894326078752, -41.46904372615033, -34.284474816499674, 0.3872427451745164, 5.156343180576229, -34.27718931614446, -26.060490482055066, 1.0993475517897657, -36.92591171885552, -22.0261546244994, -12.975274956087919, -13.802443872776779, -31.72725954375453, -37.51953494352045, -17.60827701998591, -11.511356013643052, -3.0647891183801415, -20.809829048545016, -16.572262314346116, -25.20291312412018, -0.4007963117336413, -22.15110278091692, -16.27880903770998, -13.295445991769286, -30.548134576688632, -2.8697188777227147, -36.833861394636415, -26.580259610426573, -13.51499589822683, -26.548651531392228, -43.01504842617858, 9.213312038074355, -8.991723772872348, -15.180639179593484, -16.970073169427344, -19.52075316742048, -44.68051837673756, -32.7025378978349, -30.94653590941691, -14.304892047909984, -49.10539141096376, -40.83793249876882, -7.349643638748988, -22.217995468334852, -1.4104910798873798, -16.0633795543111, -0.17780593228429287], "policy_predator_policy_reward": [40.67236325887357, 21.390477200147682, 9.965130839223313, 0.8351342834838071, 36.987423779460556, 25.217288289655762, 35.656393788522855, 22.349495247459572, 33.887769688382065, -5.370099004060953, 25.40783550017548, 3.0086665121942375, 19.127406497785426, 38.20364536240663, 17.506316128501027, 18.133379530838262, 21.113637384865367, 19.341097415824233, 30.65925356240829, 26.40230388311506, 19.051516426680262, 48.27075852555005, 13.082755405031694, 26.95209578462895, -1.8027688543543663, 1.8455088150722219, 23.284209139104433, 21.81422831977994, 5.039710015500359, 2.8014285390728064, 16.462006065900045, 27.3428130319666, 37.40314294933379, -12.203309407919617, 3.6128892711893634, 39.937862871038895, 6.87500674755313, 27.48218946753815, 16.82472236389607, 18.802407628557773, 11.004511711712432, 4.673163992050885, 9.769691197978664, 0.7300706833651311, 7.171678048284913, 11.483716289506052, 22.284936340078037, -1.1158258799852696, 8.913989865454463, 14.371963968924826, 19.351527221618785, 36.87125715562229, 24.031320421808722, 1.8051894326078752, 41.46904372615033, 34.284474816499674, -0.3872427451745164, -5.156343180576229, 34.27718931614446, 26.060490482055066, -1.0993475517897657, 36.92591171885552, 22.0261546244994, 12.975274956087919, 13.802443872776779, 31.72725954375453, 37.51953494352045, 17.60827701998591, 11.511356013643052, 3.0647891183801415, 20.809829048545016, 16.572262314346116, 25.20291312412018, 0.4007963117336413, 22.15110278091692, 16.27880903770998, 13.295445991769286, 30.548134576688632, 2.8697188777227147, 36.833861394636415, 26.580259610426573, 13.51499589822683, 26.548651531392228, 43.01504842617858, -9.213312038074355, 8.991723772872348, 15.180639179593484, 16.970073169427344, 19.52075316742048, 44.68051837673756, 32.7025378978349, 30.94653590941691, 14.304892047909984, 49.10539141096376, 40.83793249876882, 7.349643638748988, 22.217995468334852, 1.4104910798873798, 16.0633795543111, 0.17780593228429287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5286903707456877, "mean_inference_ms": 1.7638457466297268, "mean_action_processing_ms": 0.22059240115047257, "mean_env_wait_ms": 0.1363167385820594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003994941711425781, "StateBufferConnector_ms": 0.0030088424682617188, "ViewRequirementAgentConnector_ms": 0.12184274196624756}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 415.8718676032922, "num_env_steps_trained_throughput_per_sec": 415.8718676032922, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 9703.383, "restore_workers_time_ms": 0.034, "training_step_time_ms": 9703.111, "sample_time_ms": 1387.027, "learn_time_ms": 8290.62, "learn_throughput": 482.473, "synch_weights_time_ms": 23.71}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 40, "trial_id": "1f352_00000", "date": "2024-08-11_15-01-18", "timestamp": 1723402878, "time_this_iter_s": 9.699564933776855, "time_total_s": 392.8491313457489, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b18a3040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 392.8491313457489, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 52.3, "ram_util_percent": 83.14999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.848420371301472, "cur_kl_coeff": 0.004687499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4970386856546005, "policy_loss": -0.002367528273316566, "vf_loss": 2.499373917405804, "vf_explained_var": 0.9321060011784236, "kl": 0.006893632724591966, "entropy": 0.5697683039742212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9616439037024973, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4988319837798674, "policy_loss": -0.0066218645719345656, "vf_loss": 2.505138241996368, "vf_explained_var": 0.9485869965826471, "kl": 0.008416107010513896, "entropy": 0.8704364793375134, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.10539141096376, "predator_policy": -12.203309407919617}, "policy_reward_max": {"prey_policy": 12.203309407919617, "predator_policy": 49.10539141096376}, "policy_reward_mean": {"prey_policy": -17.722080091308168, "predator_policy": 17.722080091308168}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.95209578462895, 1.8027688543543663, -1.8455088150722219, -23.284209139104433, -21.81422831977994, -5.039710015500359, -2.8014285390728064, -16.462006065900045, -27.3428130319666, -37.40314294933379, 12.203309407919617, -3.6128892711893634, -39.937862871038895, -6.87500674755313, -27.48218946753815, -16.82472236389607, -18.802407628557773, -11.004511711712432, -4.673163992050885, -9.769691197978664, -0.7300706833651311, -7.171678048284913, -11.483716289506052, -22.284936340078037, 1.1158258799852696, -8.913989865454463, -14.371963968924826, -19.351527221618785, -36.87125715562229, -24.031320421808722, -1.8051894326078752, -41.46904372615033, -34.284474816499674, 0.3872427451745164, 5.156343180576229, -34.27718931614446, -26.060490482055066, 1.0993475517897657, -36.92591171885552, -22.0261546244994, -12.975274956087919, -13.802443872776779, -31.72725954375453, -37.51953494352045, -17.60827701998591, -11.511356013643052, -3.0647891183801415, -20.809829048545016, -16.572262314346116, -25.20291312412018, -0.4007963117336413, -22.15110278091692, -16.27880903770998, -13.295445991769286, -30.548134576688632, -2.8697188777227147, -36.833861394636415, -26.580259610426573, -13.51499589822683, -26.548651531392228, -43.01504842617858, 9.213312038074355, -8.991723772872348, -15.180639179593484, -16.970073169427344, -19.52075316742048, -44.68051837673756, -32.7025378978349, -30.94653590941691, -14.304892047909984, -49.10539141096376, -40.83793249876882, -7.349643638748988, -22.217995468334852, -1.4104910798873798, -16.0633795543111, -0.17780593228429287, -32.42302104456763, -0.21009233408314376, -3.7705737989509034, -25.93468460673697, -7.172523262633954, -1.9365173983460124, -20.802547464183274, -34.74966107675826, -2.685639352046155, -19.815177240953926, -25.080148683929213, -30.00899385557167, -39.774112646345806, -5.782868311761868, -44.12847056162451, -8.318427735393229, -17.966471195309857, -23.1911468748425, -15.767150108578308, -7.753821065185971, -16.975470566742615, -21.277675427168962, -10.383384656552089], "policy_predator_policy_reward": [26.95209578462895, -1.8027688543543663, 1.8455088150722219, 23.284209139104433, 21.81422831977994, 5.039710015500359, 2.8014285390728064, 16.462006065900045, 27.3428130319666, 37.40314294933379, -12.203309407919617, 3.6128892711893634, 39.937862871038895, 6.87500674755313, 27.48218946753815, 16.82472236389607, 18.802407628557773, 11.004511711712432, 4.673163992050885, 9.769691197978664, 0.7300706833651311, 7.171678048284913, 11.483716289506052, 22.284936340078037, -1.1158258799852696, 8.913989865454463, 14.371963968924826, 19.351527221618785, 36.87125715562229, 24.031320421808722, 1.8051894326078752, 41.46904372615033, 34.284474816499674, -0.3872427451745164, -5.156343180576229, 34.27718931614446, 26.060490482055066, -1.0993475517897657, 36.92591171885552, 22.0261546244994, 12.975274956087919, 13.802443872776779, 31.72725954375453, 37.51953494352045, 17.60827701998591, 11.511356013643052, 3.0647891183801415, 20.809829048545016, 16.572262314346116, 25.20291312412018, 0.4007963117336413, 22.15110278091692, 16.27880903770998, 13.295445991769286, 30.548134576688632, 2.8697188777227147, 36.833861394636415, 26.580259610426573, 13.51499589822683, 26.548651531392228, 43.01504842617858, -9.213312038074355, 8.991723772872348, 15.180639179593484, 16.970073169427344, 19.52075316742048, 44.68051837673756, 32.7025378978349, 30.94653590941691, 14.304892047909984, 49.10539141096376, 40.83793249876882, 7.349643638748988, 22.217995468334852, 1.4104910798873798, 16.0633795543111, 0.17780593228429287, 32.42302104456763, 0.21009233408314376, 3.7705737989509034, 25.93468460673697, 7.172523262633954, 1.9365173983460124, 20.802547464183274, 34.74966107675826, 2.685639352046155, 19.815177240953926, 25.080148683929213, 30.00899385557167, 39.774112646345806, 5.782868311761868, 44.12847056162451, 8.318427735393229, 17.966471195309857, 23.1911468748425, 15.767150108578308, 7.753821065185971, 16.975470566742615, 21.277675427168962, 10.383384656552089]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5267833978422112, "mean_inference_ms": 1.759963926982469, "mean_action_processing_ms": 0.22004529144307508, "mean_env_wait_ms": 0.13636811218431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003742694854736328, "StateBufferConnector_ms": 0.002802133560180664, "ViewRequirementAgentConnector_ms": 0.11633110046386719}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 423.75179966539775, "num_env_steps_trained_throughput_per_sec": 423.75179966539775, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 9696.814, "restore_workers_time_ms": 0.035, "training_step_time_ms": 9696.171, "sample_time_ms": 1319.688, "learn_time_ms": 8346.541, "learn_throughput": 479.24, "synch_weights_time_ms": 27.787}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "training_iteration": 41, "trial_id": "1f352_00000", "date": "2024-08-11_15-01-28", "timestamp": 1723402888, "time_this_iter_s": 9.501023292541504, "time_total_s": 402.3501546382904, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4a7700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 402.3501546382904, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 53.02307692307693, "ram_util_percent": 82.9076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3446534312019747, "cur_kl_coeff": 0.004687499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0442169000705084, "policy_loss": -0.0017758690189414968, "vf_loss": 2.045967040831844, "vf_explained_var": 0.9293216715256373, "kl": 0.005491294690075829, "entropy": 0.5554341410597166, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4330875447019933, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0898458983749153, "policy_loss": -0.009501379361366465, "vf_loss": 2.0990320650239784, "vf_explained_var": 0.9479499966527025, "kl": 0.008405482992205292, "entropy": 0.8402023600414396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.10539141096376, "predator_policy": -9.213312038074355}, "policy_reward_max": {"prey_policy": 9.213312038074355, "predator_policy": 49.10539141096376}, "policy_reward_mean": {"prey_policy": -18.588308316220203, "predator_policy": 18.588308316220203}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.673163992050885, -9.769691197978664, -0.7300706833651311, -7.171678048284913, -11.483716289506052, -22.284936340078037, 1.1158258799852696, -8.913989865454463, -14.371963968924826, -19.351527221618785, -36.87125715562229, -24.031320421808722, -1.8051894326078752, -41.46904372615033, -34.284474816499674, 0.3872427451745164, 5.156343180576229, -34.27718931614446, -26.060490482055066, 1.0993475517897657, -36.92591171885552, -22.0261546244994, -12.975274956087919, -13.802443872776779, -31.72725954375453, -37.51953494352045, -17.60827701998591, -11.511356013643052, -3.0647891183801415, -20.809829048545016, -16.572262314346116, -25.20291312412018, -0.4007963117336413, -22.15110278091692, -16.27880903770998, -13.295445991769286, -30.548134576688632, -2.8697188777227147, -36.833861394636415, -26.580259610426573, -13.51499589822683, -26.548651531392228, -43.01504842617858, 9.213312038074355, -8.991723772872348, -15.180639179593484, -16.970073169427344, -19.52075316742048, -44.68051837673756, -32.7025378978349, -30.94653590941691, -14.304892047909984, -49.10539141096376, -40.83793249876882, -7.349643638748988, -22.217995468334852, -1.4104910798873798, -16.0633795543111, -0.17780593228429287, -32.42302104456763, -0.21009233408314376, -3.7705737989509034, -25.93468460673697, -7.172523262633954, -1.9365173983460124, -20.802547464183274, -34.74966107675826, -2.685639352046155, -19.815177240953926, -25.080148683929213, -30.00899385557167, -39.774112646345806, -5.782868311761868, -44.12847056162451, -8.318427735393229, -17.966471195309857, -23.1911468748425, -15.767150108578308, -7.753821065185971, -16.975470566742615, -21.277675427168962, -10.383384656552089, -20.187517413479718, -31.79633368835459, -35.29427236844973, -31.588472070725388, -5.712009551683723, 7.404797069402745, -28.932742842519204, -11.656280518552453, -15.420578461920893, -5.633268690029951, -12.737205481318949, -9.348100215420029, 0.6011429808055571, -14.153806900704076, -29.766428476453854, -35.62895517082019, -33.77403783672999, -46.47740731381964], "policy_predator_policy_reward": [4.673163992050885, 9.769691197978664, 0.7300706833651311, 7.171678048284913, 11.483716289506052, 22.284936340078037, -1.1158258799852696, 8.913989865454463, 14.371963968924826, 19.351527221618785, 36.87125715562229, 24.031320421808722, 1.8051894326078752, 41.46904372615033, 34.284474816499674, -0.3872427451745164, -5.156343180576229, 34.27718931614446, 26.060490482055066, -1.0993475517897657, 36.92591171885552, 22.0261546244994, 12.975274956087919, 13.802443872776779, 31.72725954375453, 37.51953494352045, 17.60827701998591, 11.511356013643052, 3.0647891183801415, 20.809829048545016, 16.572262314346116, 25.20291312412018, 0.4007963117336413, 22.15110278091692, 16.27880903770998, 13.295445991769286, 30.548134576688632, 2.8697188777227147, 36.833861394636415, 26.580259610426573, 13.51499589822683, 26.548651531392228, 43.01504842617858, -9.213312038074355, 8.991723772872348, 15.180639179593484, 16.970073169427344, 19.52075316742048, 44.68051837673756, 32.7025378978349, 30.94653590941691, 14.304892047909984, 49.10539141096376, 40.83793249876882, 7.349643638748988, 22.217995468334852, 1.4104910798873798, 16.0633795543111, 0.17780593228429287, 32.42302104456763, 0.21009233408314376, 3.7705737989509034, 25.93468460673697, 7.172523262633954, 1.9365173983460124, 20.802547464183274, 34.74966107675826, 2.685639352046155, 19.815177240953926, 25.080148683929213, 30.00899385557167, 39.774112646345806, 5.782868311761868, 44.12847056162451, 8.318427735393229, 17.966471195309857, 23.1911468748425, 15.767150108578308, 7.753821065185971, 16.975470566742615, 21.277675427168962, 10.383384656552089, 20.187517413479718, 31.79633368835459, 35.29427236844973, 31.588472070725388, 5.712009551683723, -7.404797069402745, 28.932742842519204, 11.656280518552453, 15.420578461920893, 5.633268690029951, 12.737205481318949, 9.348100215420029, -0.6011429808055571, 14.153806900704076, 29.766428476453854, 35.62895517082019, 33.77403783672999, 46.47740731381964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5253664221407326, "mean_inference_ms": 1.7597884858098616, "mean_action_processing_ms": 0.21989066592888767, "mean_env_wait_ms": 0.1364852742767498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003655672073364258, "StateBufferConnector_ms": 0.002734065055847168, "ViewRequirementAgentConnector_ms": 0.11511123180389404}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 418.71785735419394, "num_env_steps_trained_throughput_per_sec": 418.71785735419394, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 9679.61, "restore_workers_time_ms": 0.036, "training_step_time_ms": 9678.96, "sample_time_ms": 1276.473, "learn_time_ms": 8372.771, "learn_throughput": 477.739, "synch_weights_time_ms": 27.651}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 42, "trial_id": "1f352_00000", "date": "2024-08-11_15-01-37", "timestamp": 1723402897, "time_this_iter_s": 9.589233160018921, "time_total_s": 411.9393877983093, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4e3790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 411.9393877983093, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 56.90714285714286, "ram_util_percent": 83.14285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7404200149700046, "cur_kl_coeff": 0.004687499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3138015026847523, "policy_loss": -0.0038667257264023646, "vf_loss": 2.317635428532958, "vf_explained_var": 0.9342415659998854, "kl": 0.0069964067987453695, "entropy": 0.5537863300181926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8970942098647354, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2196920864284038, "policy_loss": -0.006044828949476748, "vf_loss": 2.2252468520154554, "vf_explained_var": 0.9366002210105459, "kl": 0.013068183120863592, "entropy": 0.8783811381086707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.81587225912092, "predator_policy": -9.213312038074355}, "policy_reward_max": {"prey_policy": 9.213312038074355, "predator_policy": 56.81587225912092}, "policy_reward_mean": {"prey_policy": -19.76293713225226, "predator_policy": 19.76293713225226}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.060490482055066, 1.0993475517897657, -36.92591171885552, -22.0261546244994, -12.975274956087919, -13.802443872776779, -31.72725954375453, -37.51953494352045, -17.60827701998591, -11.511356013643052, -3.0647891183801415, -20.809829048545016, -16.572262314346116, -25.20291312412018, -0.4007963117336413, -22.15110278091692, -16.27880903770998, -13.295445991769286, -30.548134576688632, -2.8697188777227147, -36.833861394636415, -26.580259610426573, -13.51499589822683, -26.548651531392228, -43.01504842617858, 9.213312038074355, -8.991723772872348, -15.180639179593484, -16.970073169427344, -19.52075316742048, -44.68051837673756, -32.7025378978349, -30.94653590941691, -14.304892047909984, -49.10539141096376, -40.83793249876882, -7.349643638748988, -22.217995468334852, -1.4104910798873798, -16.0633795543111, -0.17780593228429287, -32.42302104456763, -0.21009233408314376, -3.7705737989509034, -25.93468460673697, -7.172523262633954, -1.9365173983460124, -20.802547464183274, -34.74966107675826, -2.685639352046155, -19.815177240953926, -25.080148683929213, -30.00899385557167, -39.774112646345806, -5.782868311761868, -44.12847056162451, -8.318427735393229, -17.966471195309857, -23.1911468748425, -15.767150108578308, -7.753821065185971, -16.975470566742615, -21.277675427168962, -10.383384656552089, -20.187517413479718, -31.79633368835459, -35.29427236844973, -31.588472070725388, -5.712009551683723, 7.404797069402745, -28.932742842519204, -11.656280518552453, -15.420578461920893, -5.633268690029951, -12.737205481318949, -9.348100215420029, 0.6011429808055571, -14.153806900704076, -29.766428476453854, -35.62895517082019, -33.77403783672999, -46.47740731381964, -29.849896390969477, -13.676392108654014, -10.573729921005548, 5.8583122903490406, -27.217378267890492, -18.876160145334637, -34.72566628069316, -4.229368032705167, -50.2169899340022, -23.449280510430043, -8.26693874857606, -8.350270701639083, -1.7316042716176137, -56.81587225912092, -29.972824970333697, -29.61924104007703, -32.625663084278976, -7.953717896586303], "policy_predator_policy_reward": [26.060490482055066, -1.0993475517897657, 36.92591171885552, 22.0261546244994, 12.975274956087919, 13.802443872776779, 31.72725954375453, 37.51953494352045, 17.60827701998591, 11.511356013643052, 3.0647891183801415, 20.809829048545016, 16.572262314346116, 25.20291312412018, 0.4007963117336413, 22.15110278091692, 16.27880903770998, 13.295445991769286, 30.548134576688632, 2.8697188777227147, 36.833861394636415, 26.580259610426573, 13.51499589822683, 26.548651531392228, 43.01504842617858, -9.213312038074355, 8.991723772872348, 15.180639179593484, 16.970073169427344, 19.52075316742048, 44.68051837673756, 32.7025378978349, 30.94653590941691, 14.304892047909984, 49.10539141096376, 40.83793249876882, 7.349643638748988, 22.217995468334852, 1.4104910798873798, 16.0633795543111, 0.17780593228429287, 32.42302104456763, 0.21009233408314376, 3.7705737989509034, 25.93468460673697, 7.172523262633954, 1.9365173983460124, 20.802547464183274, 34.74966107675826, 2.685639352046155, 19.815177240953926, 25.080148683929213, 30.00899385557167, 39.774112646345806, 5.782868311761868, 44.12847056162451, 8.318427735393229, 17.966471195309857, 23.1911468748425, 15.767150108578308, 7.753821065185971, 16.975470566742615, 21.277675427168962, 10.383384656552089, 20.187517413479718, 31.79633368835459, 35.29427236844973, 31.588472070725388, 5.712009551683723, -7.404797069402745, 28.932742842519204, 11.656280518552453, 15.420578461920893, 5.633268690029951, 12.737205481318949, 9.348100215420029, -0.6011429808055571, 14.153806900704076, 29.766428476453854, 35.62895517082019, 33.77403783672999, 46.47740731381964, 29.849896390969477, 13.676392108654014, 10.573729921005548, -5.8583122903490406, 27.217378267890492, 18.876160145334637, 34.72566628069316, 4.229368032705167, 50.2169899340022, 23.449280510430043, 8.26693874857606, 8.350270701639083, 1.7316042716176137, 56.81587225912092, 29.972824970333697, 29.61924104007703, 32.625663084278976, 7.953717896586303]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5252634139472954, "mean_inference_ms": 1.7619558647717792, "mean_action_processing_ms": 0.2200789168412032, "mean_env_wait_ms": 0.13682825540757076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035736560821533203, "StateBufferConnector_ms": 0.002819538116455078, "ViewRequirementAgentConnector_ms": 0.10058605670928955}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.3128322833861, "num_env_steps_trained_throughput_per_sec": 382.3128322833861, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 9742.051, "restore_workers_time_ms": 0.037, "training_step_time_ms": 9741.401, "sample_time_ms": 1332.735, "learn_time_ms": 8377.337, "learn_throughput": 477.479, "synch_weights_time_ms": 28.926}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "training_iteration": 43, "trial_id": "1f352_00000", "date": "2024-08-11_15-01-48", "timestamp": 1723402908, "time_this_iter_s": 10.52264404296875, "time_total_s": 422.4620318412781, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b187b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 422.4620318412781, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 55.26000000000001, "ram_util_percent": 82.94000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.90250060732166, "cur_kl_coeff": 0.004687499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.453613580390811, "policy_loss": -0.00539664457840748, "vf_loss": 2.4589734548081954, "vf_explained_var": 0.9548024212941527, "kl": 0.007845264203820198, "entropy": 0.5390765096060932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8704620992143948, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5086310878396034, "policy_loss": -0.010228235847413695, "vf_loss": 2.518358316148321, "vf_explained_var": 0.9425326676418384, "kl": 0.013360269464404221, "entropy": 0.8790904709448417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.81587225912092, "predator_policy": -17.94935713134838}, "policy_reward_max": {"prey_policy": 17.94935713134838, "predator_policy": 56.81587225912092}, "policy_reward_mean": {"prey_policy": -19.812969598267703, "predator_policy": 19.812969598267703}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-30.548134576688632, -2.8697188777227147, -36.833861394636415, -26.580259610426573, -13.51499589822683, -26.548651531392228, -43.01504842617858, 9.213312038074355, -8.991723772872348, -15.180639179593484, -16.970073169427344, -19.52075316742048, -44.68051837673756, -32.7025378978349, -30.94653590941691, -14.304892047909984, -49.10539141096376, -40.83793249876882, -7.349643638748988, -22.217995468334852, -1.4104910798873798, -16.0633795543111, -0.17780593228429287, -32.42302104456763, -0.21009233408314376, -3.7705737989509034, -25.93468460673697, -7.172523262633954, -1.9365173983460124, -20.802547464183274, -34.74966107675826, -2.685639352046155, -19.815177240953926, -25.080148683929213, -30.00899385557167, -39.774112646345806, -5.782868311761868, -44.12847056162451, -8.318427735393229, -17.966471195309857, -23.1911468748425, -15.767150108578308, -7.753821065185971, -16.975470566742615, -21.277675427168962, -10.383384656552089, -20.187517413479718, -31.79633368835459, -35.29427236844973, -31.588472070725388, -5.712009551683723, 7.404797069402745, -28.932742842519204, -11.656280518552453, -15.420578461920893, -5.633268690029951, -12.737205481318949, -9.348100215420029, 0.6011429808055571, -14.153806900704076, -29.766428476453854, -35.62895517082019, -33.77403783672999, -46.47740731381964, -29.849896390969477, -13.676392108654014, -10.573729921005548, 5.8583122903490406, -27.217378267890492, -18.876160145334637, -34.72566628069316, -4.229368032705167, -50.2169899340022, -23.449280510430043, -8.26693874857606, -8.350270701639083, -1.7316042716176137, -56.81587225912092, -29.972824970333697, -29.61924104007703, -32.625663084278976, -7.953717896586303, -11.793531461829888, -2.063450227998695, -5.709598181220873, -37.99497283492097, -25.877863046085146, -32.139856008684596, -23.900491237148977, -4.847864837092522, -16.903868287476286, -29.927708548315568, -14.684428337512948, -11.811650542334364, 1.0307121631109455, -30.858392815163004, 17.94935713134838, -37.406731414681616, -19.474673501611264, -45.421537964836496], "policy_predator_policy_reward": [30.548134576688632, 2.8697188777227147, 36.833861394636415, 26.580259610426573, 13.51499589822683, 26.548651531392228, 43.01504842617858, -9.213312038074355, 8.991723772872348, 15.180639179593484, 16.970073169427344, 19.52075316742048, 44.68051837673756, 32.7025378978349, 30.94653590941691, 14.304892047909984, 49.10539141096376, 40.83793249876882, 7.349643638748988, 22.217995468334852, 1.4104910798873798, 16.0633795543111, 0.17780593228429287, 32.42302104456763, 0.21009233408314376, 3.7705737989509034, 25.93468460673697, 7.172523262633954, 1.9365173983460124, 20.802547464183274, 34.74966107675826, 2.685639352046155, 19.815177240953926, 25.080148683929213, 30.00899385557167, 39.774112646345806, 5.782868311761868, 44.12847056162451, 8.318427735393229, 17.966471195309857, 23.1911468748425, 15.767150108578308, 7.753821065185971, 16.975470566742615, 21.277675427168962, 10.383384656552089, 20.187517413479718, 31.79633368835459, 35.29427236844973, 31.588472070725388, 5.712009551683723, -7.404797069402745, 28.932742842519204, 11.656280518552453, 15.420578461920893, 5.633268690029951, 12.737205481318949, 9.348100215420029, -0.6011429808055571, 14.153806900704076, 29.766428476453854, 35.62895517082019, 33.77403783672999, 46.47740731381964, 29.849896390969477, 13.676392108654014, 10.573729921005548, -5.8583122903490406, 27.217378267890492, 18.876160145334637, 34.72566628069316, 4.229368032705167, 50.2169899340022, 23.449280510430043, 8.26693874857606, 8.350270701639083, 1.7316042716176137, 56.81587225912092, 29.972824970333697, 29.61924104007703, 32.625663084278976, 7.953717896586303, 11.793531461829888, 2.063450227998695, 5.709598181220873, 37.99497283492097, 25.877863046085146, 32.139856008684596, 23.900491237148977, 4.847864837092522, 16.903868287476286, 29.927708548315568, 14.684428337512948, 11.811650542334364, -1.0307121631109455, 30.858392815163004, -17.94935713134838, 37.406731414681616, 19.474673501611264, 45.421537964836496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5251933908895857, "mean_inference_ms": 1.7626592846365492, "mean_action_processing_ms": 0.2202017596686123, "mean_env_wait_ms": 0.13710194335212558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036437511444091797, "StateBufferConnector_ms": 0.0028945207595825195, "ViewRequirementAgentConnector_ms": 0.0855715274810791}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 433.0204993864568, "num_env_steps_trained_throughput_per_sec": 433.0204993864568, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 9757.296, "restore_workers_time_ms": 0.037, "training_step_time_ms": 9756.693, "sample_time_ms": 1362.845, "learn_time_ms": 8364.799, "learn_throughput": 478.194, "synch_weights_time_ms": 26.909}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 44, "trial_id": "1f352_00000", "date": "2024-08-11_15-01-57", "timestamp": 1723402917, "time_this_iter_s": 9.299221992492676, "time_total_s": 431.76125383377075, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b18a60d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 431.76125383377075, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 54.138461538461534, "ram_util_percent": 82.96923076923078}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7126775665208696, "cur_kl_coeff": 0.004687499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.487837051972747, "policy_loss": -0.0018347542097520394, "vf_loss": 2.4896478292842708, "vf_explained_var": 0.9447168796012799, "kl": 0.005115552572582169, "entropy": 0.5106775999690095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8125802068039776, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4690074428915976, "policy_loss": -0.011589239020152794, "vf_loss": 2.480178041756153, "vf_explained_var": 0.9461718862255414, "kl": 0.011163591955058162, "entropy": 0.8382580092797677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.81587225912092, "predator_policy": -17.94935713134838}, "policy_reward_max": {"prey_policy": 17.94935713134838, "predator_policy": 56.81587225912092}, "policy_reward_mean": {"prey_policy": -19.947024938265393, "predator_policy": 19.947024938265393}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-0.17780593228429287, -32.42302104456763, -0.21009233408314376, -3.7705737989509034, -25.93468460673697, -7.172523262633954, -1.9365173983460124, -20.802547464183274, -34.74966107675826, -2.685639352046155, -19.815177240953926, -25.080148683929213, -30.00899385557167, -39.774112646345806, -5.782868311761868, -44.12847056162451, -8.318427735393229, -17.966471195309857, -23.1911468748425, -15.767150108578308, -7.753821065185971, -16.975470566742615, -21.277675427168962, -10.383384656552089, -20.187517413479718, -31.79633368835459, -35.29427236844973, -31.588472070725388, -5.712009551683723, 7.404797069402745, -28.932742842519204, -11.656280518552453, -15.420578461920893, -5.633268690029951, -12.737205481318949, -9.348100215420029, 0.6011429808055571, -14.153806900704076, -29.766428476453854, -35.62895517082019, -33.77403783672999, -46.47740731381964, -29.849896390969477, -13.676392108654014, -10.573729921005548, 5.8583122903490406, -27.217378267890492, -18.876160145334637, -34.72566628069316, -4.229368032705167, -50.2169899340022, -23.449280510430043, -8.26693874857606, -8.350270701639083, -1.7316042716176137, -56.81587225912092, -29.972824970333697, -29.61924104007703, -32.625663084278976, -7.953717896586303, -11.793531461829888, -2.063450227998695, -5.709598181220873, -37.99497283492097, -25.877863046085146, -32.139856008684596, -23.900491237148977, -4.847864837092522, -16.903868287476286, -29.927708548315568, -14.684428337512948, -11.811650542334364, 1.0307121631109455, -30.858392815163004, 17.94935713134838, -37.406731414681616, -19.474673501611264, -45.421537964836496, -16.691307262801686, -12.926325803230615, -11.817337395258692, -44.107641292611085, 3.7869527888949364, -15.674147951250859, -20.907321417141628, -18.91829854613063, -40.14907266206702, -45.58094849699753, -9.712705102769203, -34.9264063524013, -48.34064895111052, -17.335876618004928, -11.334434798784635, -27.220742504395798, -3.4741144930994157, -3.802907197490762, -33.964214255626864, -42.4744393054136, -24.84863356628486, -23.96482826521813], "policy_predator_policy_reward": [0.17780593228429287, 32.42302104456763, 0.21009233408314376, 3.7705737989509034, 25.93468460673697, 7.172523262633954, 1.9365173983460124, 20.802547464183274, 34.74966107675826, 2.685639352046155, 19.815177240953926, 25.080148683929213, 30.00899385557167, 39.774112646345806, 5.782868311761868, 44.12847056162451, 8.318427735393229, 17.966471195309857, 23.1911468748425, 15.767150108578308, 7.753821065185971, 16.975470566742615, 21.277675427168962, 10.383384656552089, 20.187517413479718, 31.79633368835459, 35.29427236844973, 31.588472070725388, 5.712009551683723, -7.404797069402745, 28.932742842519204, 11.656280518552453, 15.420578461920893, 5.633268690029951, 12.737205481318949, 9.348100215420029, -0.6011429808055571, 14.153806900704076, 29.766428476453854, 35.62895517082019, 33.77403783672999, 46.47740731381964, 29.849896390969477, 13.676392108654014, 10.573729921005548, -5.8583122903490406, 27.217378267890492, 18.876160145334637, 34.72566628069316, 4.229368032705167, 50.2169899340022, 23.449280510430043, 8.26693874857606, 8.350270701639083, 1.7316042716176137, 56.81587225912092, 29.972824970333697, 29.61924104007703, 32.625663084278976, 7.953717896586303, 11.793531461829888, 2.063450227998695, 5.709598181220873, 37.99497283492097, 25.877863046085146, 32.139856008684596, 23.900491237148977, 4.847864837092522, 16.903868287476286, 29.927708548315568, 14.684428337512948, 11.811650542334364, -1.0307121631109455, 30.858392815163004, -17.94935713134838, 37.406731414681616, 19.474673501611264, 45.421537964836496, 16.691307262801686, 12.926325803230615, 11.817337395258692, 44.107641292611085, -3.7869527888949364, 15.674147951250859, 20.907321417141628, 18.91829854613063, 40.14907266206702, 45.58094849699753, 9.712705102769203, 34.9264063524013, 48.34064895111052, 17.335876618004928, 11.334434798784635, 27.220742504395798, 3.4741144930994157, 3.802907197490762, 33.964214255626864, 42.4744393054136, 24.84863356628486, 23.96482826521813]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5253328034019671, "mean_inference_ms": 1.7642703178047754, "mean_action_processing_ms": 0.2204206408261182, "mean_env_wait_ms": 0.1375488566861539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003641843795776367, "StateBufferConnector_ms": 0.003175020217895508, "ViewRequirementAgentConnector_ms": 0.08110713958740234}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 414.5155103199123, "num_env_steps_trained_throughput_per_sec": 414.5155103199123, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 9663.335, "restore_workers_time_ms": 0.03, "training_step_time_ms": 9662.756, "sample_time_ms": 1385.634, "learn_time_ms": 8249.37, "learn_throughput": 484.886, "synch_weights_time_ms": 25.732}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 45, "trial_id": "1f352_00000", "date": "2024-08-11_15-02-07", "timestamp": 1723402927, "time_this_iter_s": 9.711378812789917, "time_total_s": 441.47263264656067, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a04af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 441.47263264656067, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 53.02857142857142, "ram_util_percent": 83.02857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.916777810206016, "cur_kl_coeff": 0.004687499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.581850872312983, "policy_loss": -0.0015847062517423184, "vf_loss": 2.5834231761594615, "vf_explained_var": 0.948038452056547, "kl": 0.0026452998761784603, "entropy": 0.5247996949590743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.846990978469451, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.570141279573242, "policy_loss": -0.01132809553091647, "vf_loss": 2.58103279893597, "vf_explained_var": 0.9391416987404227, "kl": 0.011642025410059138, "entropy": 0.7896945850923658, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.81587225912092, "predator_policy": -17.94935713134838}, "policy_reward_max": {"prey_policy": 17.94935713134838, "predator_policy": 56.81587225912092}, "policy_reward_mean": {"prey_policy": -20.577482208960856, "predator_policy": 20.577482208960856}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.383384656552089, -20.187517413479718, -31.79633368835459, -35.29427236844973, -31.588472070725388, -5.712009551683723, 7.404797069402745, -28.932742842519204, -11.656280518552453, -15.420578461920893, -5.633268690029951, -12.737205481318949, -9.348100215420029, 0.6011429808055571, -14.153806900704076, -29.766428476453854, -35.62895517082019, -33.77403783672999, -46.47740731381964, -29.849896390969477, -13.676392108654014, -10.573729921005548, 5.8583122903490406, -27.217378267890492, -18.876160145334637, -34.72566628069316, -4.229368032705167, -50.2169899340022, -23.449280510430043, -8.26693874857606, -8.350270701639083, -1.7316042716176137, -56.81587225912092, -29.972824970333697, -29.61924104007703, -32.625663084278976, -7.953717896586303, -11.793531461829888, -2.063450227998695, -5.709598181220873, -37.99497283492097, -25.877863046085146, -32.139856008684596, -23.900491237148977, -4.847864837092522, -16.903868287476286, -29.927708548315568, -14.684428337512948, -11.811650542334364, 1.0307121631109455, -30.858392815163004, 17.94935713134838, -37.406731414681616, -19.474673501611264, -45.421537964836496, -16.691307262801686, -12.926325803230615, -11.817337395258692, -44.107641292611085, 3.7869527888949364, -15.674147951250859, -20.907321417141628, -18.91829854613063, -40.14907266206702, -45.58094849699753, -9.712705102769203, -34.9264063524013, -48.34064895111052, -17.335876618004928, -11.334434798784635, -27.220742504395798, -3.4741144930994157, -3.802907197490762, -33.964214255626864, -42.4744393054136, -24.84863356628486, -23.96482826521813, -19.422126937997454, -5.0214793075729105, -24.345627909901566, 5.947684651804084, -15.489016472853377, -22.848664284943204, -7.82361406773029, -37.62717417650886, -13.631308707345077, -47.7482545921158, -14.245385574662407, -30.798612335038147, -41.467590027959794, -14.490082593197009, -19.9871880323291, -18.591996421861367, -29.156363003784087, -13.21360178779927, -21.25255636980816, -35.253864382495536, -15.372320091837128, -9.458113783062288, -17.451471404546208], "policy_predator_policy_reward": [10.383384656552089, 20.187517413479718, 31.79633368835459, 35.29427236844973, 31.588472070725388, 5.712009551683723, -7.404797069402745, 28.932742842519204, 11.656280518552453, 15.420578461920893, 5.633268690029951, 12.737205481318949, 9.348100215420029, -0.6011429808055571, 14.153806900704076, 29.766428476453854, 35.62895517082019, 33.77403783672999, 46.47740731381964, 29.849896390969477, 13.676392108654014, 10.573729921005548, -5.8583122903490406, 27.217378267890492, 18.876160145334637, 34.72566628069316, 4.229368032705167, 50.2169899340022, 23.449280510430043, 8.26693874857606, 8.350270701639083, 1.7316042716176137, 56.81587225912092, 29.972824970333697, 29.61924104007703, 32.625663084278976, 7.953717896586303, 11.793531461829888, 2.063450227998695, 5.709598181220873, 37.99497283492097, 25.877863046085146, 32.139856008684596, 23.900491237148977, 4.847864837092522, 16.903868287476286, 29.927708548315568, 14.684428337512948, 11.811650542334364, -1.0307121631109455, 30.858392815163004, -17.94935713134838, 37.406731414681616, 19.474673501611264, 45.421537964836496, 16.691307262801686, 12.926325803230615, 11.817337395258692, 44.107641292611085, -3.7869527888949364, 15.674147951250859, 20.907321417141628, 18.91829854613063, 40.14907266206702, 45.58094849699753, 9.712705102769203, 34.9264063524013, 48.34064895111052, 17.335876618004928, 11.334434798784635, 27.220742504395798, 3.4741144930994157, 3.802907197490762, 33.964214255626864, 42.4744393054136, 24.84863356628486, 23.96482826521813, 19.422126937997454, 5.0214793075729105, 24.345627909901566, -5.947684651804084, 15.489016472853377, 22.848664284943204, 7.82361406773029, 37.62717417650886, 13.631308707345077, 47.7482545921158, 14.245385574662407, 30.798612335038147, 41.467590027959794, 14.490082593197009, 19.9871880323291, 18.591996421861367, 29.156363003784087, 13.21360178779927, 21.25255636980816, 35.253864382495536, 15.372320091837128, 9.458113783062288, 17.451471404546208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5264325180598164, "mean_inference_ms": 1.7687343186152718, "mean_action_processing_ms": 0.22102057529839889, "mean_env_wait_ms": 0.13844209222395149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004360079765319824, "StateBufferConnector_ms": 0.003370046615600586, "ViewRequirementAgentConnector_ms": 0.09112417697906494}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 419.20979084756647, "num_env_steps_trained_throughput_per_sec": 419.20979084756647, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 9652.896, "restore_workers_time_ms": 0.03, "training_step_time_ms": 9652.317, "sample_time_ms": 1377.602, "learn_time_ms": 8248.097, "learn_throughput": 484.96, "synch_weights_time_ms": 24.653}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 46, "trial_id": "1f352_00000", "date": "2024-08-11_15-02-17", "timestamp": 1723402937, "time_this_iter_s": 9.612382888793945, "time_total_s": 451.0850155353546, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a045e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 451.0850155353546, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 53.223076923076924, "ram_util_percent": 82.95384615384614}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.796354592901965, "cur_kl_coeff": 0.0023437499999999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6293076148877543, "policy_loss": -0.004598497859357546, "vf_loss": 2.6338874618212382, "vf_explained_var": 0.9403868555401762, "kl": 0.007953799503397363, "entropy": 0.5656056211950878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9369903789212306, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6212567603836456, "policy_loss": -0.008879400415996013, "vf_loss": 2.6296186755100885, "vf_explained_var": 0.9246902067214251, "kl": 0.01379966707064384, "entropy": 0.8095651992286245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.81587225912092, "predator_policy": -17.94935713134838}, "policy_reward_max": {"prey_policy": 17.94935713134838, "predator_policy": 56.81587225912092}, "policy_reward_mean": {"prey_policy": -21.176394936976976, "predator_policy": 21.176394936976976}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-46.47740731381964, -29.849896390969477, -13.676392108654014, -10.573729921005548, 5.8583122903490406, -27.217378267890492, -18.876160145334637, -34.72566628069316, -4.229368032705167, -50.2169899340022, -23.449280510430043, -8.26693874857606, -8.350270701639083, -1.7316042716176137, -56.81587225912092, -29.972824970333697, -29.61924104007703, -32.625663084278976, -7.953717896586303, -11.793531461829888, -2.063450227998695, -5.709598181220873, -37.99497283492097, -25.877863046085146, -32.139856008684596, -23.900491237148977, -4.847864837092522, -16.903868287476286, -29.927708548315568, -14.684428337512948, -11.811650542334364, 1.0307121631109455, -30.858392815163004, 17.94935713134838, -37.406731414681616, -19.474673501611264, -45.421537964836496, -16.691307262801686, -12.926325803230615, -11.817337395258692, -44.107641292611085, 3.7869527888949364, -15.674147951250859, -20.907321417141628, -18.91829854613063, -40.14907266206702, -45.58094849699753, -9.712705102769203, -34.9264063524013, -48.34064895111052, -17.335876618004928, -11.334434798784635, -27.220742504395798, -3.4741144930994157, -3.802907197490762, -33.964214255626864, -42.4744393054136, -24.84863356628486, -23.96482826521813, -19.422126937997454, -5.0214793075729105, -24.345627909901566, 5.947684651804084, -15.489016472853377, -22.848664284943204, -7.82361406773029, -37.62717417650886, -13.631308707345077, -47.7482545921158, -14.245385574662407, -30.798612335038147, -41.467590027959794, -14.490082593197009, -19.9871880323291, -18.591996421861367, -29.156363003784087, -13.21360178779927, -21.25255636980816, -35.253864382495536, -15.372320091837128, -9.458113783062288, -17.451471404546208, -30.378111945574254, -15.833488368580273, -13.664662291162237, -32.97397613008385, -39.04368900214388, -13.37379712209534, -42.59911562092222, -1.478909721580414, -16.29258148623679, -2.5343616340165465, -36.5469106480696, -38.96583025498863, -16.909211905407773, -6.872477836460829, -23.883067936328445, -18.958175706925942, -12.88795469184854, -20.70240479269353], "policy_predator_policy_reward": [46.47740731381964, 29.849896390969477, 13.676392108654014, 10.573729921005548, -5.8583122903490406, 27.217378267890492, 18.876160145334637, 34.72566628069316, 4.229368032705167, 50.2169899340022, 23.449280510430043, 8.26693874857606, 8.350270701639083, 1.7316042716176137, 56.81587225912092, 29.972824970333697, 29.61924104007703, 32.625663084278976, 7.953717896586303, 11.793531461829888, 2.063450227998695, 5.709598181220873, 37.99497283492097, 25.877863046085146, 32.139856008684596, 23.900491237148977, 4.847864837092522, 16.903868287476286, 29.927708548315568, 14.684428337512948, 11.811650542334364, -1.0307121631109455, 30.858392815163004, -17.94935713134838, 37.406731414681616, 19.474673501611264, 45.421537964836496, 16.691307262801686, 12.926325803230615, 11.817337395258692, 44.107641292611085, -3.7869527888949364, 15.674147951250859, 20.907321417141628, 18.91829854613063, 40.14907266206702, 45.58094849699753, 9.712705102769203, 34.9264063524013, 48.34064895111052, 17.335876618004928, 11.334434798784635, 27.220742504395798, 3.4741144930994157, 3.802907197490762, 33.964214255626864, 42.4744393054136, 24.84863356628486, 23.96482826521813, 19.422126937997454, 5.0214793075729105, 24.345627909901566, -5.947684651804084, 15.489016472853377, 22.848664284943204, 7.82361406773029, 37.62717417650886, 13.631308707345077, 47.7482545921158, 14.245385574662407, 30.798612335038147, 41.467590027959794, 14.490082593197009, 19.9871880323291, 18.591996421861367, 29.156363003784087, 13.21360178779927, 21.25255636980816, 35.253864382495536, 15.372320091837128, 9.458113783062288, 17.451471404546208, 30.378111945574254, 15.833488368580273, 13.664662291162237, 32.97397613008385, 39.04368900214388, 13.37379712209534, 42.59911562092222, 1.478909721580414, 16.29258148623679, 2.5343616340165465, 36.5469106480696, 38.96583025498863, 16.909211905407773, 6.872477836460829, 23.883067936328445, 18.958175706925942, 12.88795469184854, 20.70240479269353]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5270695631004245, "mean_inference_ms": 1.770914184770082, "mean_action_processing_ms": 0.2212635314030438, "mean_env_wait_ms": 0.1389101717292395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004710078239440918, "StateBufferConnector_ms": 0.003340601921081543, "ViewRequirementAgentConnector_ms": 0.09096086025238037}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 429.28546345601336, "num_env_steps_trained_throughput_per_sec": 429.28546345601336, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 9677.525, "restore_workers_time_ms": 0.023, "training_step_time_ms": 9676.826, "sample_time_ms": 1371.85, "learn_time_ms": 8274.61, "learn_throughput": 483.406, "synch_weights_time_ms": 27.553}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "training_iteration": 47, "trial_id": "1f352_00000", "date": "2024-08-11_15-02-26", "timestamp": 1723402946, "time_this_iter_s": 9.471091985702515, "time_total_s": 460.55610752105713, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4e3790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 460.55610752105713, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 53.949999999999996, "ram_util_percent": 83.10714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7480432308589418, "cur_kl_coeff": 0.0023437499999999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3020628470927478, "policy_loss": -0.0032547254018330325, "vf_loss": 2.305305086200436, "vf_explained_var": 0.9520215747257074, "kl": 0.0053259282246165334, "entropy": 0.551281088621666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7602280237401526, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2863996046905717, "policy_loss": -0.009029539434898955, "vf_loss": 2.2951061965276796, "vf_explained_var": 0.9421608458583554, "kl": 0.008611749884019786, "entropy": 0.7869907821218173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.36295780338564, "predator_policy": -17.94935713134838}, "policy_reward_max": {"prey_policy": 17.94935713134838, "predator_policy": 56.36295780338564}, "policy_reward_mean": {"prey_policy": -20.722480919012856, "predator_policy": 20.722480919012856}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-7.953717896586303, -11.793531461829888, -2.063450227998695, -5.709598181220873, -37.99497283492097, -25.877863046085146, -32.139856008684596, -23.900491237148977, -4.847864837092522, -16.903868287476286, -29.927708548315568, -14.684428337512948, -11.811650542334364, 1.0307121631109455, -30.858392815163004, 17.94935713134838, -37.406731414681616, -19.474673501611264, -45.421537964836496, -16.691307262801686, -12.926325803230615, -11.817337395258692, -44.107641292611085, 3.7869527888949364, -15.674147951250859, -20.907321417141628, -18.91829854613063, -40.14907266206702, -45.58094849699753, -9.712705102769203, -34.9264063524013, -48.34064895111052, -17.335876618004928, -11.334434798784635, -27.220742504395798, -3.4741144930994157, -3.802907197490762, -33.964214255626864, -42.4744393054136, -24.84863356628486, -23.96482826521813, -19.422126937997454, -5.0214793075729105, -24.345627909901566, 5.947684651804084, -15.489016472853377, -22.848664284943204, -7.82361406773029, -37.62717417650886, -13.631308707345077, -47.7482545921158, -14.245385574662407, -30.798612335038147, -41.467590027959794, -14.490082593197009, -19.9871880323291, -18.591996421861367, -29.156363003784087, -13.21360178779927, -21.25255636980816, -35.253864382495536, -15.372320091837128, -9.458113783062288, -17.451471404546208, -30.378111945574254, -15.833488368580273, -13.664662291162237, -32.97397613008385, -39.04368900214388, -13.37379712209534, -42.59911562092222, -1.478909721580414, -16.29258148623679, -2.5343616340165465, -36.5469106480696, -38.96583025498863, -16.909211905407773, -6.872477836460829, -23.883067936328445, -18.958175706925942, -12.88795469184854, -20.70240479269353, -13.716342871165955, -22.14441822938455, -6.153205279461172, -28.03406046249137, -33.61771344485057, -34.75367729402982, -56.36295780338564, -30.95631812485544, -8.201820367213756, -35.21984250093221, -12.539695071189561, -19.75377027903711, -16.83117612181613, -17.346814484269494, 5.590639994325681, -22.33674664882198, 5.642910008343975, -28.689960914151044], "policy_predator_policy_reward": [7.953717896586303, 11.793531461829888, 2.063450227998695, 5.709598181220873, 37.99497283492097, 25.877863046085146, 32.139856008684596, 23.900491237148977, 4.847864837092522, 16.903868287476286, 29.927708548315568, 14.684428337512948, 11.811650542334364, -1.0307121631109455, 30.858392815163004, -17.94935713134838, 37.406731414681616, 19.474673501611264, 45.421537964836496, 16.691307262801686, 12.926325803230615, 11.817337395258692, 44.107641292611085, -3.7869527888949364, 15.674147951250859, 20.907321417141628, 18.91829854613063, 40.14907266206702, 45.58094849699753, 9.712705102769203, 34.9264063524013, 48.34064895111052, 17.335876618004928, 11.334434798784635, 27.220742504395798, 3.4741144930994157, 3.802907197490762, 33.964214255626864, 42.4744393054136, 24.84863356628486, 23.96482826521813, 19.422126937997454, 5.0214793075729105, 24.345627909901566, -5.947684651804084, 15.489016472853377, 22.848664284943204, 7.82361406773029, 37.62717417650886, 13.631308707345077, 47.7482545921158, 14.245385574662407, 30.798612335038147, 41.467590027959794, 14.490082593197009, 19.9871880323291, 18.591996421861367, 29.156363003784087, 13.21360178779927, 21.25255636980816, 35.253864382495536, 15.372320091837128, 9.458113783062288, 17.451471404546208, 30.378111945574254, 15.833488368580273, 13.664662291162237, 32.97397613008385, 39.04368900214388, 13.37379712209534, 42.59911562092222, 1.478909721580414, 16.29258148623679, 2.5343616340165465, 36.5469106480696, 38.96583025498863, 16.909211905407773, 6.872477836460829, 23.883067936328445, 18.958175706925942, 12.88795469184854, 20.70240479269353, 13.716342871165955, 22.14441822938455, 6.153205279461172, 28.03406046249137, 33.61771344485057, 34.75367729402982, 56.36295780338564, 30.95631812485544, 8.201820367213756, 35.21984250093221, 12.539695071189561, 19.75377027903711, 16.83117612181613, 17.346814484269494, -5.590639994325681, 22.33674664882198, -5.642910008343975, 28.689960914151044]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5274761125037181, "mean_inference_ms": 1.7710289774369188, "mean_action_processing_ms": 0.2212605549522963, "mean_env_wait_ms": 0.13919641764106705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006084442138671875, "StateBufferConnector_ms": 0.003272533416748047, "ViewRequirementAgentConnector_ms": 0.09408211708068848}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 401.07923038053457, "num_env_steps_trained_throughput_per_sec": 401.07923038053457, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 9646.983, "restore_workers_time_ms": 0.023, "training_step_time_ms": 9646.182, "sample_time_ms": 1354.407, "learn_time_ms": 8258.298, "learn_throughput": 484.361, "synch_weights_time_ms": 30.638}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 48, "trial_id": "1f352_00000", "date": "2024-08-11_15-02-37", "timestamp": 1723402957, "time_this_iter_s": 10.097998142242432, "time_total_s": 470.65410566329956, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4a70d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 470.65410566329956, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 58.221428571428575, "ram_util_percent": 83.14999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.950173350609839, "cur_kl_coeff": 0.0023437499999999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3872398396333057, "policy_loss": -0.0015371070059093958, "vf_loss": 2.3887712329626085, "vf_explained_var": 0.9527658036599557, "kl": 0.002442016050390153, "entropy": 0.5741092508969208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8465559179584186, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.35423854055504, "policy_loss": -0.008444714624783956, "vf_loss": 2.3622039314359426, "vf_explained_var": 0.9533702973276377, "kl": 0.012781942627836192, "entropy": 0.7799750613048673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.36295780338564, "predator_policy": -5.947684651804084}, "policy_reward_max": {"prey_policy": 5.947684651804084, "predator_policy": 56.36295780338564}, "policy_reward_mean": {"prey_policy": -21.707794826351073, "predator_policy": 21.707794826351073}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-44.107641292611085, 3.7869527888949364, -15.674147951250859, -20.907321417141628, -18.91829854613063, -40.14907266206702, -45.58094849699753, -9.712705102769203, -34.9264063524013, -48.34064895111052, -17.335876618004928, -11.334434798784635, -27.220742504395798, -3.4741144930994157, -3.802907197490762, -33.964214255626864, -42.4744393054136, -24.84863356628486, -23.96482826521813, -19.422126937997454, -5.0214793075729105, -24.345627909901566, 5.947684651804084, -15.489016472853377, -22.848664284943204, -7.82361406773029, -37.62717417650886, -13.631308707345077, -47.7482545921158, -14.245385574662407, -30.798612335038147, -41.467590027959794, -14.490082593197009, -19.9871880323291, -18.591996421861367, -29.156363003784087, -13.21360178779927, -21.25255636980816, -35.253864382495536, -15.372320091837128, -9.458113783062288, -17.451471404546208, -30.378111945574254, -15.833488368580273, -13.664662291162237, -32.97397613008385, -39.04368900214388, -13.37379712209534, -42.59911562092222, -1.478909721580414, -16.29258148623679, -2.5343616340165465, -36.5469106480696, -38.96583025498863, -16.909211905407773, -6.872477836460829, -23.883067936328445, -18.958175706925942, -12.88795469184854, -20.70240479269353, -13.716342871165955, -22.14441822938455, -6.153205279461172, -28.03406046249137, -33.61771344485057, -34.75367729402982, -56.36295780338564, -30.95631812485544, -8.201820367213756, -35.21984250093221, -12.539695071189561, -19.75377027903711, -16.83117612181613, -17.346814484269494, 5.590639994325681, -22.33674664882198, 5.642910008343975, -28.689960914151044, -53.283150194771885, -6.861230228890358, -34.20149809858938, -2.396982884699751, -28.658214147442166, -20.19815000942195, -44.251574862464096, -15.573618674144964, -38.08914553597627, -18.164424002835382, -7.490024298275995, -22.747985331744037, -5.292513084890461, -10.763787523679285, -18.105145730072234, -23.19158094734371, -30.33816791266473, -9.17177504960782, -13.6587229006841, -36.97052274626539, -16.745979577614456, -23.602435302074767], "policy_predator_policy_reward": [44.107641292611085, -3.7869527888949364, 15.674147951250859, 20.907321417141628, 18.91829854613063, 40.14907266206702, 45.58094849699753, 9.712705102769203, 34.9264063524013, 48.34064895111052, 17.335876618004928, 11.334434798784635, 27.220742504395798, 3.4741144930994157, 3.802907197490762, 33.964214255626864, 42.4744393054136, 24.84863356628486, 23.96482826521813, 19.422126937997454, 5.0214793075729105, 24.345627909901566, -5.947684651804084, 15.489016472853377, 22.848664284943204, 7.82361406773029, 37.62717417650886, 13.631308707345077, 47.7482545921158, 14.245385574662407, 30.798612335038147, 41.467590027959794, 14.490082593197009, 19.9871880323291, 18.591996421861367, 29.156363003784087, 13.21360178779927, 21.25255636980816, 35.253864382495536, 15.372320091837128, 9.458113783062288, 17.451471404546208, 30.378111945574254, 15.833488368580273, 13.664662291162237, 32.97397613008385, 39.04368900214388, 13.37379712209534, 42.59911562092222, 1.478909721580414, 16.29258148623679, 2.5343616340165465, 36.5469106480696, 38.96583025498863, 16.909211905407773, 6.872477836460829, 23.883067936328445, 18.958175706925942, 12.88795469184854, 20.70240479269353, 13.716342871165955, 22.14441822938455, 6.153205279461172, 28.03406046249137, 33.61771344485057, 34.75367729402982, 56.36295780338564, 30.95631812485544, 8.201820367213756, 35.21984250093221, 12.539695071189561, 19.75377027903711, 16.83117612181613, 17.346814484269494, -5.590639994325681, 22.33674664882198, -5.642910008343975, 28.689960914151044, 53.283150194771885, 6.861230228890358, 34.20149809858938, 2.396982884699751, 28.658214147442166, 20.19815000942195, 44.251574862464096, 15.573618674144964, 38.08914553597627, 18.164424002835382, 7.490024298275995, 22.747985331744037, 5.292513084890461, 10.763787523679285, 18.105145730072234, 23.19158094734371, 30.33816791266473, 9.17177504960782, 13.6587229006841, 36.97052274626539, 16.745979577614456, 23.602435302074767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5301358818892336, "mean_inference_ms": 1.776487141321096, "mean_action_processing_ms": 0.22204335454403343, "mean_env_wait_ms": 0.13977436814389038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008057355880737305, "StateBufferConnector_ms": 0.0032279491424560547, "ViewRequirementAgentConnector_ms": 0.08706653118133545}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 343.4537085859517, "num_env_steps_trained_throughput_per_sec": 343.4537085859517, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 9844.136, "restore_workers_time_ms": 0.024, "training_step_time_ms": 9843.339, "sample_time_ms": 1329.827, "learn_time_ms": 8424.793, "learn_throughput": 474.789, "synch_weights_time_ms": 85.714}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "training_iteration": 49, "trial_id": "1f352_00000", "date": "2024-08-11_15-02-48", "timestamp": 1723402968, "time_this_iter_s": 11.704792022705078, "time_total_s": 482.35889768600464, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b18a6040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 482.35889768600464, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 64.51764705882353, "ram_util_percent": 83.3941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.2239101922760405, "cur_kl_coeff": 0.0011718749999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2495484431584676, "policy_loss": -0.002344924416199016, "vf_loss": 3.2518863409757612, "vf_explained_var": 0.9421619288623333, "kl": 0.0060057039794303765, "entropy": 0.5023649430833756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.135664726421237, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.241998030245304, "policy_loss": -0.003511500276848286, "vf_loss": 3.245170170813799, "vf_explained_var": 0.9411077820385496, "kl": 0.009049314400310567, "entropy": 0.7595954940343896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.36295780338564, "predator_policy": -5.642910008343975}, "policy_reward_max": {"prey_policy": 5.642910008343975, "predator_policy": 56.36295780338564}, "policy_reward_mean": {"prey_policy": -21.62490424919502, "predator_policy": 21.62490424919502}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-15.489016472853377, -22.848664284943204, -7.82361406773029, -37.62717417650886, -13.631308707345077, -47.7482545921158, -14.245385574662407, -30.798612335038147, -41.467590027959794, -14.490082593197009, -19.9871880323291, -18.591996421861367, -29.156363003784087, -13.21360178779927, -21.25255636980816, -35.253864382495536, -15.372320091837128, -9.458113783062288, -17.451471404546208, -30.378111945574254, -15.833488368580273, -13.664662291162237, -32.97397613008385, -39.04368900214388, -13.37379712209534, -42.59911562092222, -1.478909721580414, -16.29258148623679, -2.5343616340165465, -36.5469106480696, -38.96583025498863, -16.909211905407773, -6.872477836460829, -23.883067936328445, -18.958175706925942, -12.88795469184854, -20.70240479269353, -13.716342871165955, -22.14441822938455, -6.153205279461172, -28.03406046249137, -33.61771344485057, -34.75367729402982, -56.36295780338564, -30.95631812485544, -8.201820367213756, -35.21984250093221, -12.539695071189561, -19.75377027903711, -16.83117612181613, -17.346814484269494, 5.590639994325681, -22.33674664882198, 5.642910008343975, -28.689960914151044, -53.283150194771885, -6.861230228890358, -34.20149809858938, -2.396982884699751, -28.658214147442166, -20.19815000942195, -44.251574862464096, -15.573618674144964, -38.08914553597627, -18.164424002835382, -7.490024298275995, -22.747985331744037, -5.292513084890461, -10.763787523679285, -18.105145730072234, -23.19158094734371, -30.33816791266473, -9.17177504960782, -13.6587229006841, -36.97052274626539, -16.745979577614456, -23.602435302074767, -28.829624499846872, -26.079918693191406, -31.653962197489165, -2.778316666524324, 0.631533981394675, -15.07780924154633, -37.397018141056066, -40.70591832667328, -1.9813119597924942, -39.51335805213206, -31.3363243405206, 4.397110834657049, -34.26571763272615, -25.159352524174487, -33.3724043127615, -14.21739189223161, 0.5850241730246442, -33.5839655721719, -22.79899475061877, -41.29618182349858, -4.695689022193045, -15.998008156904433, -22.375321958990025], "policy_predator_policy_reward": [15.489016472853377, 22.848664284943204, 7.82361406773029, 37.62717417650886, 13.631308707345077, 47.7482545921158, 14.245385574662407, 30.798612335038147, 41.467590027959794, 14.490082593197009, 19.9871880323291, 18.591996421861367, 29.156363003784087, 13.21360178779927, 21.25255636980816, 35.253864382495536, 15.372320091837128, 9.458113783062288, 17.451471404546208, 30.378111945574254, 15.833488368580273, 13.664662291162237, 32.97397613008385, 39.04368900214388, 13.37379712209534, 42.59911562092222, 1.478909721580414, 16.29258148623679, 2.5343616340165465, 36.5469106480696, 38.96583025498863, 16.909211905407773, 6.872477836460829, 23.883067936328445, 18.958175706925942, 12.88795469184854, 20.70240479269353, 13.716342871165955, 22.14441822938455, 6.153205279461172, 28.03406046249137, 33.61771344485057, 34.75367729402982, 56.36295780338564, 30.95631812485544, 8.201820367213756, 35.21984250093221, 12.539695071189561, 19.75377027903711, 16.83117612181613, 17.346814484269494, -5.590639994325681, 22.33674664882198, -5.642910008343975, 28.689960914151044, 53.283150194771885, 6.861230228890358, 34.20149809858938, 2.396982884699751, 28.658214147442166, 20.19815000942195, 44.251574862464096, 15.573618674144964, 38.08914553597627, 18.164424002835382, 7.490024298275995, 22.747985331744037, 5.292513084890461, 10.763787523679285, 18.105145730072234, 23.19158094734371, 30.33816791266473, 9.17177504960782, 13.6587229006841, 36.97052274626539, 16.745979577614456, 23.602435302074767, 28.829624499846872, 26.079918693191406, 31.653962197489165, 2.778316666524324, -0.631533981394675, 15.07780924154633, 37.397018141056066, 40.70591832667328, 1.9813119597924942, 39.51335805213206, 31.3363243405206, -4.397110834657049, 34.26571763272615, 25.159352524174487, 33.3724043127615, 14.21739189223161, -0.5850241730246442, 33.5839655721719, 22.79899475061877, 41.29618182349858, 4.695689022193045, 15.998008156904433, 22.375321958990025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5319838697409096, "mean_inference_ms": 1.7862699515781133, "mean_action_processing_ms": 0.22296329312180302, "mean_env_wait_ms": 0.14094909186906074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01030123233795166, "StateBufferConnector_ms": 0.0028706789016723633, "ViewRequirementAgentConnector_ms": 0.10476529598236084}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.35180957766255, "num_env_steps_trained_throughput_per_sec": 279.35180957766255, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 10314.192, "restore_workers_time_ms": 0.026, "training_step_time_ms": 10313.387, "sample_time_ms": 1599.49, "learn_time_ms": 8624.569, "learn_throughput": 463.791, "synch_weights_time_ms": 86.21}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 50, "trial_id": "1f352_00000", "date": "2024-08-11_15-03-03", "timestamp": 1723402983, "time_this_iter_s": 14.351895809173584, "time_total_s": 496.7107934951782, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b18a6700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 496.7107934951782, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 75.495, "ram_util_percent": 83.28999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.623352174460888, "cur_kl_coeff": 0.0011718749999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.372417482982079, "policy_loss": -0.004178753871868442, "vf_loss": 2.3765893361220756, "vf_explained_var": 0.9324226735159755, "kl": 0.005895400341975248, "entropy": 0.4646168025520941, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7516045828660327, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3577919331689676, "policy_loss": -0.006051748523411031, "vf_loss": 2.363348296036323, "vf_explained_var": 0.9315070748950044, "kl": 0.013210391148844671, "entropy": 0.7094352039198081, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.36295780338564, "predator_policy": -5.642910008343975}, "policy_reward_max": {"prey_policy": 5.642910008343975, "predator_policy": 56.36295780338564}, "policy_reward_mean": {"prey_policy": -20.155076004953578, "predator_policy": 20.155076004953578}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.451471404546208, -30.378111945574254, -15.833488368580273, -13.664662291162237, -32.97397613008385, -39.04368900214388, -13.37379712209534, -42.59911562092222, -1.478909721580414, -16.29258148623679, -2.5343616340165465, -36.5469106480696, -38.96583025498863, -16.909211905407773, -6.872477836460829, -23.883067936328445, -18.958175706925942, -12.88795469184854, -20.70240479269353, -13.716342871165955, -22.14441822938455, -6.153205279461172, -28.03406046249137, -33.61771344485057, -34.75367729402982, -56.36295780338564, -30.95631812485544, -8.201820367213756, -35.21984250093221, -12.539695071189561, -19.75377027903711, -16.83117612181613, -17.346814484269494, 5.590639994325681, -22.33674664882198, 5.642910008343975, -28.689960914151044, -53.283150194771885, -6.861230228890358, -34.20149809858938, -2.396982884699751, -28.658214147442166, -20.19815000942195, -44.251574862464096, -15.573618674144964, -38.08914553597627, -18.164424002835382, -7.490024298275995, -22.747985331744037, -5.292513084890461, -10.763787523679285, -18.105145730072234, -23.19158094734371, -30.33816791266473, -9.17177504960782, -13.6587229006841, -36.97052274626539, -16.745979577614456, -23.602435302074767, -28.829624499846872, -26.079918693191406, -31.653962197489165, -2.778316666524324, 0.631533981394675, -15.07780924154633, -37.397018141056066, -40.70591832667328, -1.9813119597924942, -39.51335805213206, -31.3363243405206, 4.397110834657049, -34.26571763272615, -25.159352524174487, -33.3724043127615, -14.21739189223161, 0.5850241730246442, -33.5839655721719, -22.79899475061877, -41.29618182349858, -4.695689022193045, -15.998008156904433, -22.375321958990025, -8.734625922288636, -15.988687349363596, -20.071323804768312, 1.3353363741265127, -16.53340353491403, -27.233637397717107, -34.20582852182776, 5.423190991241949, -14.31490367188166, -11.61858434868089, -22.733635196412383, -8.980385379445128, -30.95327679263452, -4.596273669107127, -11.28121161444479, -32.53349328582483, -1.6786255223245963, -6.773513634919516], "policy_predator_policy_reward": [17.451471404546208, 30.378111945574254, 15.833488368580273, 13.664662291162237, 32.97397613008385, 39.04368900214388, 13.37379712209534, 42.59911562092222, 1.478909721580414, 16.29258148623679, 2.5343616340165465, 36.5469106480696, 38.96583025498863, 16.909211905407773, 6.872477836460829, 23.883067936328445, 18.958175706925942, 12.88795469184854, 20.70240479269353, 13.716342871165955, 22.14441822938455, 6.153205279461172, 28.03406046249137, 33.61771344485057, 34.75367729402982, 56.36295780338564, 30.95631812485544, 8.201820367213756, 35.21984250093221, 12.539695071189561, 19.75377027903711, 16.83117612181613, 17.346814484269494, -5.590639994325681, 22.33674664882198, -5.642910008343975, 28.689960914151044, 53.283150194771885, 6.861230228890358, 34.20149809858938, 2.396982884699751, 28.658214147442166, 20.19815000942195, 44.251574862464096, 15.573618674144964, 38.08914553597627, 18.164424002835382, 7.490024298275995, 22.747985331744037, 5.292513084890461, 10.763787523679285, 18.105145730072234, 23.19158094734371, 30.33816791266473, 9.17177504960782, 13.6587229006841, 36.97052274626539, 16.745979577614456, 23.602435302074767, 28.829624499846872, 26.079918693191406, 31.653962197489165, 2.778316666524324, -0.631533981394675, 15.07780924154633, 37.397018141056066, 40.70591832667328, 1.9813119597924942, 39.51335805213206, 31.3363243405206, -4.397110834657049, 34.26571763272615, 25.159352524174487, 33.3724043127615, 14.21739189223161, -0.5850241730246442, 33.5839655721719, 22.79899475061877, 41.29618182349858, 4.695689022193045, 15.998008156904433, 22.375321958990025, 8.734625922288636, 15.988687349363596, 20.071323804768312, -1.3353363741265127, 16.53340353491403, 27.233637397717107, 34.20582852182776, -5.423190991241949, 14.31490367188166, 11.61858434868089, 22.733635196412383, 8.980385379445128, 30.95327679263452, 4.596273669107127, 11.28121161444479, 32.53349328582483, 1.6786255223245963, 6.773513634919516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5336745366056642, "mean_inference_ms": 1.7984206064264174, "mean_action_processing_ms": 0.22406097234040737, "mean_env_wait_ms": 0.14160398747896055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010035037994384766, "StateBufferConnector_ms": 0.0037556886672973633, "ViewRequirementAgentConnector_ms": 0.12146759033203125}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 385.7660350956807, "num_env_steps_trained_throughput_per_sec": 385.7660350956807, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 10407.138, "restore_workers_time_ms": 0.024, "training_step_time_ms": 10406.703, "sample_time_ms": 1683.958, "learn_time_ms": 8631.786, "learn_throughput": 463.404, "synch_weights_time_ms": 87.894}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "training_iteration": 51, "trial_id": "1f352_00000", "date": "2024-08-11_15-03-13", "timestamp": 1723402993, "time_this_iter_s": 10.405685901641846, "time_total_s": 507.11647939682007, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1890310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 507.11647939682007, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 65.15333333333334, "ram_util_percent": 83.31333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.564096097027262, "cur_kl_coeff": 0.0011718749999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3737362624456484, "policy_loss": -0.0025992534448353883, "vf_loss": 2.37632740996778, "vf_explained_var": 0.9508443359285593, "kl": 0.0069170845118269614, "entropy": 0.5295465318796535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.54669454600662, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.36745637220641, "policy_loss": -0.006204862632633497, "vf_loss": 2.373467677955826, "vf_explained_var": 0.9506209506342809, "kl": 0.005161482845706663, "entropy": 0.7055410598715146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.36295780338564, "predator_policy": -8.006398567955232}, "policy_reward_max": {"prey_policy": 8.006398567955232, "predator_policy": 56.36295780338564}, "policy_reward_mean": {"prey_policy": -18.499214272424204, "predator_policy": 18.499214272424204}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.70240479269353, -13.716342871165955, -22.14441822938455, -6.153205279461172, -28.03406046249137, -33.61771344485057, -34.75367729402982, -56.36295780338564, -30.95631812485544, -8.201820367213756, -35.21984250093221, -12.539695071189561, -19.75377027903711, -16.83117612181613, -17.346814484269494, 5.590639994325681, -22.33674664882198, 5.642910008343975, -28.689960914151044, -53.283150194771885, -6.861230228890358, -34.20149809858938, -2.396982884699751, -28.658214147442166, -20.19815000942195, -44.251574862464096, -15.573618674144964, -38.08914553597627, -18.164424002835382, -7.490024298275995, -22.747985331744037, -5.292513084890461, -10.763787523679285, -18.105145730072234, -23.19158094734371, -30.33816791266473, -9.17177504960782, -13.6587229006841, -36.97052274626539, -16.745979577614456, -23.602435302074767, -28.829624499846872, -26.079918693191406, -31.653962197489165, -2.778316666524324, 0.631533981394675, -15.07780924154633, -37.397018141056066, -40.70591832667328, -1.9813119597924942, -39.51335805213206, -31.3363243405206, 4.397110834657049, -34.26571763272615, -25.159352524174487, -33.3724043127615, -14.21739189223161, 0.5850241730246442, -33.5839655721719, -22.79899475061877, -41.29618182349858, -4.695689022193045, -15.998008156904433, -22.375321958990025, -8.734625922288636, -15.988687349363596, -20.071323804768312, 1.3353363741265127, -16.53340353491403, -27.233637397717107, -34.20582852182776, 5.423190991241949, -14.31490367188166, -11.61858434868089, -22.733635196412383, -8.980385379445128, -30.95327679263452, -4.596273669107127, -11.28121161444479, -32.53349328582483, -1.6786255223245963, -6.773513634919516, 8.006398567955232, -0.777567290807065, 0.5175284008508996, -34.62175367384885, -16.081967197391165, -40.81648905965167, 7.951035638568706, 0.9649165427455308, -14.232536777115893, -24.186825651279037, -18.100022605889066, -11.870543525020581, -9.132176403944513, -0.13546751400755852, 0.5472432306539123, -15.710392596218139, -16.21764884895532, -31.165351690679906], "policy_predator_policy_reward": [20.70240479269353, 13.716342871165955, 22.14441822938455, 6.153205279461172, 28.03406046249137, 33.61771344485057, 34.75367729402982, 56.36295780338564, 30.95631812485544, 8.201820367213756, 35.21984250093221, 12.539695071189561, 19.75377027903711, 16.83117612181613, 17.346814484269494, -5.590639994325681, 22.33674664882198, -5.642910008343975, 28.689960914151044, 53.283150194771885, 6.861230228890358, 34.20149809858938, 2.396982884699751, 28.658214147442166, 20.19815000942195, 44.251574862464096, 15.573618674144964, 38.08914553597627, 18.164424002835382, 7.490024298275995, 22.747985331744037, 5.292513084890461, 10.763787523679285, 18.105145730072234, 23.19158094734371, 30.33816791266473, 9.17177504960782, 13.6587229006841, 36.97052274626539, 16.745979577614456, 23.602435302074767, 28.829624499846872, 26.079918693191406, 31.653962197489165, 2.778316666524324, -0.631533981394675, 15.07780924154633, 37.397018141056066, 40.70591832667328, 1.9813119597924942, 39.51335805213206, 31.3363243405206, -4.397110834657049, 34.26571763272615, 25.159352524174487, 33.3724043127615, 14.21739189223161, -0.5850241730246442, 33.5839655721719, 22.79899475061877, 41.29618182349858, 4.695689022193045, 15.998008156904433, 22.375321958990025, 8.734625922288636, 15.988687349363596, 20.071323804768312, -1.3353363741265127, 16.53340353491403, 27.233637397717107, 34.20582852182776, -5.423190991241949, 14.31490367188166, 11.61858434868089, 22.733635196412383, 8.980385379445128, 30.95327679263452, 4.596273669107127, 11.28121161444479, 32.53349328582483, 1.6786255223245963, 6.773513634919516, -8.006398567955232, 0.777567290807065, -0.5175284008508996, 34.62175367384885, 16.081967197391165, 40.81648905965167, -7.951035638568706, -0.9649165427455308, 14.232536777115893, 24.186825651279037, 18.100022605889066, 11.870543525020581, 9.132176403944513, 0.13546751400755852, -0.5472432306539123, 15.710392596218139, 16.21764884895532, 31.165351690679906]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5373559934899333, "mean_inference_ms": 1.815423415394156, "mean_action_processing_ms": 0.22580031843810972, "mean_env_wait_ms": 0.1429416584488957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010066032409667969, "StateBufferConnector_ms": 0.004075050354003906, "ViewRequirementAgentConnector_ms": 0.12843382358551025}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 386.64889538112044, "num_env_steps_trained_throughput_per_sec": 386.64889538112044, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 10486.344, "restore_workers_time_ms": 0.023, "training_step_time_ms": 10485.961, "sample_time_ms": 1721.53, "learn_time_ms": 8674.524, "learn_throughput": 461.12, "synch_weights_time_ms": 86.918}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 52, "trial_id": "1f352_00000", "date": "2024-08-11_15-03-24", "timestamp": 1723403004, "time_this_iter_s": 10.40416407585144, "time_total_s": 517.5206434726715, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b18a3820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 517.5206434726715, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 62.30666666666666, "ram_util_percent": 83.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7978229048972327, "cur_kl_coeff": 0.0011718749999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4858051779369514, "policy_loss": -0.0010985694442448826, "vf_loss": 2.4868947570522626, "vf_explained_var": 0.9496966317296028, "kl": 0.007673189663647361, "entropy": 0.4720785231639942, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8090962767601013, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5119324405988057, "policy_loss": -0.005327885769899391, "vf_loss": 2.516984754552444, "vf_explained_var": 0.9481340316434701, "kl": 0.00734862015982228, "entropy": 0.7041306170945366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -53.283150194771885, "predator_policy": -8.006398567955232}, "policy_reward_max": {"prey_policy": 8.006398567955232, "predator_policy": 53.283150194771885}, "policy_reward_mean": {"prey_policy": -19.122794222823046, "predator_policy": 19.122794222823046}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-28.689960914151044, -53.283150194771885, -6.861230228890358, -34.20149809858938, -2.396982884699751, -28.658214147442166, -20.19815000942195, -44.251574862464096, -15.573618674144964, -38.08914553597627, -18.164424002835382, -7.490024298275995, -22.747985331744037, -5.292513084890461, -10.763787523679285, -18.105145730072234, -23.19158094734371, -30.33816791266473, -9.17177504960782, -13.6587229006841, -36.97052274626539, -16.745979577614456, -23.602435302074767, -28.829624499846872, -26.079918693191406, -31.653962197489165, -2.778316666524324, 0.631533981394675, -15.07780924154633, -37.397018141056066, -40.70591832667328, -1.9813119597924942, -39.51335805213206, -31.3363243405206, 4.397110834657049, -34.26571763272615, -25.159352524174487, -33.3724043127615, -14.21739189223161, 0.5850241730246442, -33.5839655721719, -22.79899475061877, -41.29618182349858, -4.695689022193045, -15.998008156904433, -22.375321958990025, -8.734625922288636, -15.988687349363596, -20.071323804768312, 1.3353363741265127, -16.53340353491403, -27.233637397717107, -34.20582852182776, 5.423190991241949, -14.31490367188166, -11.61858434868089, -22.733635196412383, -8.980385379445128, -30.95327679263452, -4.596273669107127, -11.28121161444479, -32.53349328582483, -1.6786255223245963, -6.773513634919516, 8.006398567955232, -0.777567290807065, 0.5175284008508996, -34.62175367384885, -16.081967197391165, -40.81648905965167, 7.951035638568706, 0.9649165427455308, -14.232536777115893, -24.186825651279037, -18.100022605889066, -11.870543525020581, -9.132176403944513, -0.13546751400755852, 0.5472432306539123, -15.710392596218139, -16.21764884895532, -31.165351690679906, -34.30970806134311, -36.51410653902055, -6.244310343686513, -22.233891088561002, -15.78365341238807, -12.925117969235162, -6.140903701460095, -9.552252675522082, -51.36374627341821, -36.70889876739161, -20.98121746978266, -30.330146213036038, -32.08005566311477, -34.386544647878324, 5.37152584207322, -29.255123812154732, -26.719108105838252, -29.63814991105487], "policy_predator_policy_reward": [28.689960914151044, 53.283150194771885, 6.861230228890358, 34.20149809858938, 2.396982884699751, 28.658214147442166, 20.19815000942195, 44.251574862464096, 15.573618674144964, 38.08914553597627, 18.164424002835382, 7.490024298275995, 22.747985331744037, 5.292513084890461, 10.763787523679285, 18.105145730072234, 23.19158094734371, 30.33816791266473, 9.17177504960782, 13.6587229006841, 36.97052274626539, 16.745979577614456, 23.602435302074767, 28.829624499846872, 26.079918693191406, 31.653962197489165, 2.778316666524324, -0.631533981394675, 15.07780924154633, 37.397018141056066, 40.70591832667328, 1.9813119597924942, 39.51335805213206, 31.3363243405206, -4.397110834657049, 34.26571763272615, 25.159352524174487, 33.3724043127615, 14.21739189223161, -0.5850241730246442, 33.5839655721719, 22.79899475061877, 41.29618182349858, 4.695689022193045, 15.998008156904433, 22.375321958990025, 8.734625922288636, 15.988687349363596, 20.071323804768312, -1.3353363741265127, 16.53340353491403, 27.233637397717107, 34.20582852182776, -5.423190991241949, 14.31490367188166, 11.61858434868089, 22.733635196412383, 8.980385379445128, 30.95327679263452, 4.596273669107127, 11.28121161444479, 32.53349328582483, 1.6786255223245963, 6.773513634919516, -8.006398567955232, 0.777567290807065, -0.5175284008508996, 34.62175367384885, 16.081967197391165, 40.81648905965167, -7.951035638568706, -0.9649165427455308, 14.232536777115893, 24.186825651279037, 18.100022605889066, 11.870543525020581, 9.132176403944513, 0.13546751400755852, -0.5472432306539123, 15.710392596218139, 16.21764884895532, 31.165351690679906, 34.30970806134311, 36.51410653902055, 6.244310343686513, 22.233891088561002, 15.78365341238807, 12.925117969235162, 6.140903701460095, 9.552252675522082, 51.36374627341821, 36.70889876739161, 20.98121746978266, 30.330146213036038, 32.08005566311477, 34.386544647878324, -5.37152584207322, 29.255123812154732, 26.719108105838252, 29.63814991105487]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5410845072276025, "mean_inference_ms": 1.8322428043284618, "mean_action_processing_ms": 0.22744729319498042, "mean_env_wait_ms": 0.14416451944940215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0086899995803833, "StateBufferConnector_ms": 0.004051804542541504, "ViewRequirementAgentConnector_ms": 0.12954044342041016}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 399.0102997652036, "num_env_steps_trained_throughput_per_sec": 399.0102997652036, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 424000, "timers": {"training_iteration_time_ms": 10442.57, "restore_workers_time_ms": 0.022, "training_step_time_ms": 10442.171, "sample_time_ms": 1716.826, "learn_time_ms": 8633.52, "learn_throughput": 463.31, "synch_weights_time_ms": 88.608}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "done": false, "training_iteration": 53, "trial_id": "1f352_00000", "date": "2024-08-11_15-03-34", "timestamp": 1723403014, "time_this_iter_s": 10.09104609489441, "time_total_s": 527.6116895675659, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b18a35e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 527.6116895675659, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 57.35714285714287, "ram_util_percent": 83.22857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.634844837213556, "cur_kl_coeff": 0.0011718749999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.111244231959184, "policy_loss": -0.003944078361989038, "vf_loss": 2.115181966125965, "vf_explained_var": 0.9623906448483467, "kl": 0.005413277551960968, "entropy": 0.5120346574733655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.735512106927733, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.198037860666712, "policy_loss": -0.00492039661767194, "vf_loss": 2.202632035749654, "vf_explained_var": 0.9613074200227857, "kl": 0.008699224819461785, "entropy": 0.691885045543313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -51.36374627341821, "predator_policy": -9.189361602950969}, "policy_reward_max": {"prey_policy": 9.189361602950969, "predator_policy": 51.36374627341821}, "policy_reward_mean": {"prey_policy": -18.68656058390485, "predator_policy": 18.68656058390485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-23.602435302074767, -28.829624499846872, -26.079918693191406, -31.653962197489165, -2.778316666524324, 0.631533981394675, -15.07780924154633, -37.397018141056066, -40.70591832667328, -1.9813119597924942, -39.51335805213206, -31.3363243405206, 4.397110834657049, -34.26571763272615, -25.159352524174487, -33.3724043127615, -14.21739189223161, 0.5850241730246442, -33.5839655721719, -22.79899475061877, -41.29618182349858, -4.695689022193045, -15.998008156904433, -22.375321958990025, -8.734625922288636, -15.988687349363596, -20.071323804768312, 1.3353363741265127, -16.53340353491403, -27.233637397717107, -34.20582852182776, 5.423190991241949, -14.31490367188166, -11.61858434868089, -22.733635196412383, -8.980385379445128, -30.95327679263452, -4.596273669107127, -11.28121161444479, -32.53349328582483, -1.6786255223245963, -6.773513634919516, 8.006398567955232, -0.777567290807065, 0.5175284008508996, -34.62175367384885, -16.081967197391165, -40.81648905965167, 7.951035638568706, 0.9649165427455308, -14.232536777115893, -24.186825651279037, -18.100022605889066, -11.870543525020581, -9.132176403944513, -0.13546751400755852, 0.5472432306539123, -15.710392596218139, -16.21764884895532, -31.165351690679906, -34.30970806134311, -36.51410653902055, -6.244310343686513, -22.233891088561002, -15.78365341238807, -12.925117969235162, -6.140903701460095, -9.552252675522082, -51.36374627341821, -36.70889876739161, -20.98121746978266, -30.330146213036038, -32.08005566311477, -34.386544647878324, 5.37152584207322, -29.255123812154732, -26.719108105838252, -29.63814991105487, -29.69579790030682, -19.15798635246719, -41.82672126861773, -20.38567370486449, -25.463978154911572, -25.890654164904348, -33.81546551029273, 1.4102470558160025, -40.14362446678993, -18.94844629673628, -25.566927721307643, -32.15846183575067, -41.69722264764588, -2.368919966372996, -13.896231915393741, -31.2144612660367, -16.34340671294472, 9.189361602950969, -19.01231771709501, -5.21456900099369, -6.080563455380526, -2.9389693643641586], "policy_predator_policy_reward": [23.602435302074767, 28.829624499846872, 26.079918693191406, 31.653962197489165, 2.778316666524324, -0.631533981394675, 15.07780924154633, 37.397018141056066, 40.70591832667328, 1.9813119597924942, 39.51335805213206, 31.3363243405206, -4.397110834657049, 34.26571763272615, 25.159352524174487, 33.3724043127615, 14.21739189223161, -0.5850241730246442, 33.5839655721719, 22.79899475061877, 41.29618182349858, 4.695689022193045, 15.998008156904433, 22.375321958990025, 8.734625922288636, 15.988687349363596, 20.071323804768312, -1.3353363741265127, 16.53340353491403, 27.233637397717107, 34.20582852182776, -5.423190991241949, 14.31490367188166, 11.61858434868089, 22.733635196412383, 8.980385379445128, 30.95327679263452, 4.596273669107127, 11.28121161444479, 32.53349328582483, 1.6786255223245963, 6.773513634919516, -8.006398567955232, 0.777567290807065, -0.5175284008508996, 34.62175367384885, 16.081967197391165, 40.81648905965167, -7.951035638568706, -0.9649165427455308, 14.232536777115893, 24.186825651279037, 18.100022605889066, 11.870543525020581, 9.132176403944513, 0.13546751400755852, -0.5472432306539123, 15.710392596218139, 16.21764884895532, 31.165351690679906, 34.30970806134311, 36.51410653902055, 6.244310343686513, 22.233891088561002, 15.78365341238807, 12.925117969235162, 6.140903701460095, 9.552252675522082, 51.36374627341821, 36.70889876739161, 20.98121746978266, 30.330146213036038, 32.08005566311477, 34.386544647878324, -5.37152584207322, 29.255123812154732, 26.719108105838252, 29.63814991105487, 29.69579790030682, 19.15798635246719, 41.82672126861773, 20.38567370486449, 25.463978154911572, 25.890654164904348, 33.81546551029273, -1.4102470558160025, 40.14362446678993, 18.94844629673628, 25.566927721307643, 32.15846183575067, 41.69722264764588, 2.368919966372996, 13.896231915393741, 31.2144612660367, 16.34340671294472, -9.189361602950969, 19.01231771709501, 5.21456900099369, 6.080563455380526, 2.9389693643641586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5455583112024739, "mean_inference_ms": 1.8531135438511899, "mean_action_processing_ms": 0.229551166726946, "mean_env_wait_ms": 0.145707937031931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006975531578063965, "StateBufferConnector_ms": 0.0041882991790771484, "ViewRequirementAgentConnector_ms": 0.13028109073638916}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.1848835751886, "num_env_steps_trained_throughput_per_sec": 406.1848835751886, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 10503.679, "restore_workers_time_ms": 0.023, "training_step_time_ms": 10503.138, "sample_time_ms": 1717.997, "learn_time_ms": 8689.53, "learn_throughput": 460.324, "synch_weights_time_ms": 92.108}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 54, "trial_id": "1f352_00000", "date": "2024-08-11_15-03-44", "timestamp": 1723403024, "time_this_iter_s": 9.879274606704712, "time_total_s": 537.4909641742706, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4f58b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 537.4909641742706, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 56.41428571428571, "ram_util_percent": 83.18571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.671853764541447, "cur_kl_coeff": 0.0011718749999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.392573447401325, "policy_loss": -0.003329383619711734, "vf_loss": 2.395895727723837, "vf_explained_var": 0.9493765871971845, "kl": 0.006051728877742953, "entropy": 0.4697047481313348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7727911895141006, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.400395373875896, "policy_loss": -0.007638213808483367, "vf_loss": 2.4074873010317486, "vf_explained_var": 0.9482063371067245, "kl": 0.014567435680803502, "entropy": 0.6823301846161485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -51.36374627341821, "predator_policy": -9.189361602950969}, "policy_reward_max": {"prey_policy": 9.189361602950969, "predator_policy": 51.36374627341821}, "policy_reward_mean": {"prey_policy": -17.673280293863915, "predator_policy": 17.673280293863915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.375321958990025, -8.734625922288636, -15.988687349363596, -20.071323804768312, 1.3353363741265127, -16.53340353491403, -27.233637397717107, -34.20582852182776, 5.423190991241949, -14.31490367188166, -11.61858434868089, -22.733635196412383, -8.980385379445128, -30.95327679263452, -4.596273669107127, -11.28121161444479, -32.53349328582483, -1.6786255223245963, -6.773513634919516, 8.006398567955232, -0.777567290807065, 0.5175284008508996, -34.62175367384885, -16.081967197391165, -40.81648905965167, 7.951035638568706, 0.9649165427455308, -14.232536777115893, -24.186825651279037, -18.100022605889066, -11.870543525020581, -9.132176403944513, -0.13546751400755852, 0.5472432306539123, -15.710392596218139, -16.21764884895532, -31.165351690679906, -34.30970806134311, -36.51410653902055, -6.244310343686513, -22.233891088561002, -15.78365341238807, -12.925117969235162, -6.140903701460095, -9.552252675522082, -51.36374627341821, -36.70889876739161, -20.98121746978266, -30.330146213036038, -32.08005566311477, -34.386544647878324, 5.37152584207322, -29.255123812154732, -26.719108105838252, -29.63814991105487, -29.69579790030682, -19.15798635246719, -41.82672126861773, -20.38567370486449, -25.463978154911572, -25.890654164904348, -33.81546551029273, 1.4102470558160025, -40.14362446678993, -18.94844629673628, -25.566927721307643, -32.15846183575067, -41.69722264764588, -2.368919966372996, -13.896231915393741, -31.2144612660367, -16.34340671294472, 9.189361602950969, -19.01231771709501, -5.21456900099369, -6.080563455380526, -2.9389693643641586, -42.7946439771836, -40.02952182562937, -6.265385850293858, -37.65748422389828, 2.017171124252487, -37.399148465731756, -13.560060382478072, -2.8286139257530403, 4.162458212253982, -24.93258582780482, -9.252849611771552, -10.495953637608602, -0.6056951214590498, 1.955202738027829, -38.513685792324225, -24.71596745926674, 1.7865113243184734, -3.537087245961854, -19.324369891982137, -31.716328117412274, -32.66313257058704, -23.613803619568124, -7.417030967095911], "policy_predator_policy_reward": [22.375321958990025, 8.734625922288636, 15.988687349363596, 20.071323804768312, -1.3353363741265127, 16.53340353491403, 27.233637397717107, 34.20582852182776, -5.423190991241949, 14.31490367188166, 11.61858434868089, 22.733635196412383, 8.980385379445128, 30.95327679263452, 4.596273669107127, 11.28121161444479, 32.53349328582483, 1.6786255223245963, 6.773513634919516, -8.006398567955232, 0.777567290807065, -0.5175284008508996, 34.62175367384885, 16.081967197391165, 40.81648905965167, -7.951035638568706, -0.9649165427455308, 14.232536777115893, 24.186825651279037, 18.100022605889066, 11.870543525020581, 9.132176403944513, 0.13546751400755852, -0.5472432306539123, 15.710392596218139, 16.21764884895532, 31.165351690679906, 34.30970806134311, 36.51410653902055, 6.244310343686513, 22.233891088561002, 15.78365341238807, 12.925117969235162, 6.140903701460095, 9.552252675522082, 51.36374627341821, 36.70889876739161, 20.98121746978266, 30.330146213036038, 32.08005566311477, 34.386544647878324, -5.37152584207322, 29.255123812154732, 26.719108105838252, 29.63814991105487, 29.69579790030682, 19.15798635246719, 41.82672126861773, 20.38567370486449, 25.463978154911572, 25.890654164904348, 33.81546551029273, -1.4102470558160025, 40.14362446678993, 18.94844629673628, 25.566927721307643, 32.15846183575067, 41.69722264764588, 2.368919966372996, 13.896231915393741, 31.2144612660367, 16.34340671294472, -9.189361602950969, 19.01231771709501, 5.21456900099369, 6.080563455380526, 2.9389693643641586, 42.7946439771836, 40.02952182562937, 6.265385850293858, 37.65748422389828, -2.017171124252487, 37.399148465731756, 13.560060382478072, 2.8286139257530403, -4.162458212253982, 24.93258582780482, 9.252849611771552, 10.495953637608602, 0.6056951214590498, -1.955202738027829, 38.513685792324225, 24.71596745926674, -1.7865113243184734, 3.537087245961854, 19.324369891982137, 31.716328117412274, 32.66313257058704, 23.613803619568124, 7.417030967095911]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5467274983728837, "mean_inference_ms": 1.8586858641538186, "mean_action_processing_ms": 0.23000896837363946, "mean_env_wait_ms": 0.14594467837913863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004672050476074219, "StateBufferConnector_ms": 0.004200100898742676, "ViewRequirementAgentConnector_ms": 0.11383378505706787}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 436.47847446324204, "num_env_steps_trained_throughput_per_sec": 436.47847446324204, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 10455.123, "restore_workers_time_ms": 0.023, "training_step_time_ms": 10454.582, "sample_time_ms": 1701.462, "learn_time_ms": 8657.73, "learn_throughput": 462.015, "synch_weights_time_ms": 91.98}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "training_iteration": 55, "trial_id": "1f352_00000", "date": "2024-08-11_15-03-53", "timestamp": 1723403033, "time_this_iter_s": 9.219868898391724, "time_total_s": 546.7108330726624, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a04550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 546.7108330726624, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 52.52307692307693, "ram_util_percent": 82.98461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8212725250671307, "cur_kl_coeff": 0.0011718749999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6747909884899856, "policy_loss": -0.0055046455025149045, "vf_loss": 2.6802843276411297, "vf_explained_var": 0.9180128900955121, "kl": 0.009650684042077291, "entropy": 0.47370682591572405, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.874199271760881, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6514383636415007, "policy_loss": -0.005931069812989639, "vf_loss": 2.6568081884334487, "vf_explained_var": 0.9213965826978286, "kl": 0.014966340604301938, "entropy": 0.6907890491187573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -51.36374627341821, "predator_policy": -9.189361602950969}, "policy_reward_max": {"prey_policy": 9.189361602950969, "predator_policy": 51.36374627341821}, "policy_reward_mean": {"prey_policy": -17.935916035289598, "predator_policy": 17.935916035289598}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.773513634919516, 8.006398567955232, -0.777567290807065, 0.5175284008508996, -34.62175367384885, -16.081967197391165, -40.81648905965167, 7.951035638568706, 0.9649165427455308, -14.232536777115893, -24.186825651279037, -18.100022605889066, -11.870543525020581, -9.132176403944513, -0.13546751400755852, 0.5472432306539123, -15.710392596218139, -16.21764884895532, -31.165351690679906, -34.30970806134311, -36.51410653902055, -6.244310343686513, -22.233891088561002, -15.78365341238807, -12.925117969235162, -6.140903701460095, -9.552252675522082, -51.36374627341821, -36.70889876739161, -20.98121746978266, -30.330146213036038, -32.08005566311477, -34.386544647878324, 5.37152584207322, -29.255123812154732, -26.719108105838252, -29.63814991105487, -29.69579790030682, -19.15798635246719, -41.82672126861773, -20.38567370486449, -25.463978154911572, -25.890654164904348, -33.81546551029273, 1.4102470558160025, -40.14362446678993, -18.94844629673628, -25.566927721307643, -32.15846183575067, -41.69722264764588, -2.368919966372996, -13.896231915393741, -31.2144612660367, -16.34340671294472, 9.189361602950969, -19.01231771709501, -5.21456900099369, -6.080563455380526, -2.9389693643641586, -42.7946439771836, -40.02952182562937, -6.265385850293858, -37.65748422389828, 2.017171124252487, -37.399148465731756, -13.560060382478072, -2.8286139257530403, 4.162458212253982, -24.93258582780482, -9.252849611771552, -10.495953637608602, -0.6056951214590498, 1.955202738027829, -38.513685792324225, -24.71596745926674, 1.7865113243184734, -3.537087245961854, -19.324369891982137, -31.716328117412274, -32.66313257058704, -23.613803619568124, -7.417030967095911, -20.74342502578963, -5.2250384631079365, -20.41631953048917, -32.88501696541205, -7.442154297395675, -24.064652106416, -24.959137783142584, -19.332899561188675, -18.829681714507565, -19.335907665698123, -8.271802915907266, -18.575121638913917, -22.78858625249055, -25.53398804451362, -8.539194892772104, -1.921354072957472, -14.089288133644853, -10.384695683478306], "policy_predator_policy_reward": [6.773513634919516, -8.006398567955232, 0.777567290807065, -0.5175284008508996, 34.62175367384885, 16.081967197391165, 40.81648905965167, -7.951035638568706, -0.9649165427455308, 14.232536777115893, 24.186825651279037, 18.100022605889066, 11.870543525020581, 9.132176403944513, 0.13546751400755852, -0.5472432306539123, 15.710392596218139, 16.21764884895532, 31.165351690679906, 34.30970806134311, 36.51410653902055, 6.244310343686513, 22.233891088561002, 15.78365341238807, 12.925117969235162, 6.140903701460095, 9.552252675522082, 51.36374627341821, 36.70889876739161, 20.98121746978266, 30.330146213036038, 32.08005566311477, 34.386544647878324, -5.37152584207322, 29.255123812154732, 26.719108105838252, 29.63814991105487, 29.69579790030682, 19.15798635246719, 41.82672126861773, 20.38567370486449, 25.463978154911572, 25.890654164904348, 33.81546551029273, -1.4102470558160025, 40.14362446678993, 18.94844629673628, 25.566927721307643, 32.15846183575067, 41.69722264764588, 2.368919966372996, 13.896231915393741, 31.2144612660367, 16.34340671294472, -9.189361602950969, 19.01231771709501, 5.21456900099369, 6.080563455380526, 2.9389693643641586, 42.7946439771836, 40.02952182562937, 6.265385850293858, 37.65748422389828, -2.017171124252487, 37.399148465731756, 13.560060382478072, 2.8286139257530403, -4.162458212253982, 24.93258582780482, 9.252849611771552, 10.495953637608602, 0.6056951214590498, -1.955202738027829, 38.513685792324225, 24.71596745926674, -1.7865113243184734, 3.537087245961854, 19.324369891982137, 31.716328117412274, 32.66313257058704, 23.613803619568124, 7.417030967095911, 20.74342502578963, 5.2250384631079365, 20.41631953048917, 32.88501696541205, 7.442154297395675, 24.064652106416, 24.959137783142584, 19.332899561188675, 18.829681714507565, 19.335907665698123, 8.271802915907266, 18.575121638913917, 22.78858625249055, 25.53398804451362, 8.539194892772104, 1.921354072957472, 14.089288133644853, 10.384695683478306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5467982892501404, "mean_inference_ms": 1.8590639711826775, "mean_action_processing_ms": 0.22989990960511675, "mean_env_wait_ms": 0.14593012104825945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043534040451049805, "StateBufferConnector_ms": 0.0031374692916870117, "ViewRequirementAgentConnector_ms": 0.09064006805419922}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 398.45432018837334, "num_env_steps_trained_throughput_per_sec": 398.45432018837334, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 10504.826, "restore_workers_time_ms": 0.023, "training_step_time_ms": 10504.29, "sample_time_ms": 1677.433, "learn_time_ms": 8729.497, "learn_throughput": 458.217, "synch_weights_time_ms": 93.985}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 56, "trial_id": "1f352_00000", "date": "2024-08-11_15-04-03", "timestamp": 1723403043, "time_this_iter_s": 10.089340209960938, "time_total_s": 556.8001732826233, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1890550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 556.8001732826233, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 55.542857142857144, "ram_util_percent": 83.15714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9077574719985324, "cur_kl_coeff": 0.0011718749999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.437665971244375, "policy_loss": -0.0017611521140982707, "vf_loss": 2.4394226604451736, "vf_explained_var": 0.9452466097970803, "kl": 0.0038042960538535436, "entropy": 0.42696616031850376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9339240682000916, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.365574979161223, "policy_loss": -0.006758888754120562, "vf_loss": 2.3718033596873282, "vf_explained_var": 0.9481466458489497, "kl": 0.014146922576342733, "entropy": 0.6662194502850374, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -51.36374627341821, "predator_policy": -9.189361602950969}, "policy_reward_max": {"prey_policy": 9.189361602950969, "predator_policy": 51.36374627341821}, "policy_reward_mean": {"prey_policy": -18.44591162902174, "predator_policy": 18.44591162902174}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-31.165351690679906, -34.30970806134311, -36.51410653902055, -6.244310343686513, -22.233891088561002, -15.78365341238807, -12.925117969235162, -6.140903701460095, -9.552252675522082, -51.36374627341821, -36.70889876739161, -20.98121746978266, -30.330146213036038, -32.08005566311477, -34.386544647878324, 5.37152584207322, -29.255123812154732, -26.719108105838252, -29.63814991105487, -29.69579790030682, -19.15798635246719, -41.82672126861773, -20.38567370486449, -25.463978154911572, -25.890654164904348, -33.81546551029273, 1.4102470558160025, -40.14362446678993, -18.94844629673628, -25.566927721307643, -32.15846183575067, -41.69722264764588, -2.368919966372996, -13.896231915393741, -31.2144612660367, -16.34340671294472, 9.189361602950969, -19.01231771709501, -5.21456900099369, -6.080563455380526, -2.9389693643641586, -42.7946439771836, -40.02952182562937, -6.265385850293858, -37.65748422389828, 2.017171124252487, -37.399148465731756, -13.560060382478072, -2.8286139257530403, 4.162458212253982, -24.93258582780482, -9.252849611771552, -10.495953637608602, -0.6056951214590498, 1.955202738027829, -38.513685792324225, -24.71596745926674, 1.7865113243184734, -3.537087245961854, -19.324369891982137, -31.716328117412274, -32.66313257058704, -23.613803619568124, -7.417030967095911, -20.74342502578963, -5.2250384631079365, -20.41631953048917, -32.88501696541205, -7.442154297395675, -24.064652106416, -24.959137783142584, -19.332899561188675, -18.829681714507565, -19.335907665698123, -8.271802915907266, -18.575121638913917, -22.78858625249055, -25.53398804451362, -8.539194892772104, -1.921354072957472, -14.089288133644853, -10.384695683478306, -6.8884083694994445, -24.871149327284357, -9.120935725999619, -20.68271205895367, -17.640004700514485, -37.162741613992225, 7.201773952415946, -32.41518911639939, -12.217520889018825, 1.651239767513415, -25.013827968934642, -20.72051752372936, -5.469462108214959, -7.610017431029057, -24.15947099277618, -10.249079964470866, 0.1325462864828708, 3.566136012916875], "policy_predator_policy_reward": [31.165351690679906, 34.30970806134311, 36.51410653902055, 6.244310343686513, 22.233891088561002, 15.78365341238807, 12.925117969235162, 6.140903701460095, 9.552252675522082, 51.36374627341821, 36.70889876739161, 20.98121746978266, 30.330146213036038, 32.08005566311477, 34.386544647878324, -5.37152584207322, 29.255123812154732, 26.719108105838252, 29.63814991105487, 29.69579790030682, 19.15798635246719, 41.82672126861773, 20.38567370486449, 25.463978154911572, 25.890654164904348, 33.81546551029273, -1.4102470558160025, 40.14362446678993, 18.94844629673628, 25.566927721307643, 32.15846183575067, 41.69722264764588, 2.368919966372996, 13.896231915393741, 31.2144612660367, 16.34340671294472, -9.189361602950969, 19.01231771709501, 5.21456900099369, 6.080563455380526, 2.9389693643641586, 42.7946439771836, 40.02952182562937, 6.265385850293858, 37.65748422389828, -2.017171124252487, 37.399148465731756, 13.560060382478072, 2.8286139257530403, -4.162458212253982, 24.93258582780482, 9.252849611771552, 10.495953637608602, 0.6056951214590498, -1.955202738027829, 38.513685792324225, 24.71596745926674, -1.7865113243184734, 3.537087245961854, 19.324369891982137, 31.716328117412274, 32.66313257058704, 23.613803619568124, 7.417030967095911, 20.74342502578963, 5.2250384631079365, 20.41631953048917, 32.88501696541205, 7.442154297395675, 24.064652106416, 24.959137783142584, 19.332899561188675, 18.829681714507565, 19.335907665698123, 8.271802915907266, 18.575121638913917, 22.78858625249055, 25.53398804451362, 8.539194892772104, 1.921354072957472, 14.089288133644853, 10.384695683478306, 6.8884083694994445, 24.871149327284357, 9.120935725999619, 20.68271205895367, 17.640004700514485, 37.162741613992225, -7.201773952415946, 32.41518911639939, 12.217520889018825, -1.651239767513415, 25.013827968934642, 20.72051752372936, 5.469462108214959, 7.610017431029057, 24.15947099277618, 10.249079964470866, -0.1325462864828708, -3.566136012916875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5458455351470112, "mean_inference_ms": 1.8559129105296535, "mean_action_processing_ms": 0.2294791064211126, "mean_env_wait_ms": 0.1455747673092301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004507780075073242, "StateBufferConnector_ms": 0.0028612613677978516, "ViewRequirementAgentConnector_ms": 0.08285152912139893}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.8726420873518, "num_env_steps_trained_throughput_per_sec": 406.8726420873518, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 10556.079, "restore_workers_time_ms": 0.023, "training_step_time_ms": 10555.7, "sample_time_ms": 1663.824, "learn_time_ms": 8798.831, "learn_throughput": 454.606, "synch_weights_time_ms": 90.585}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "training_iteration": 57, "trial_id": "1f352_00000", "date": "2024-08-11_15-04-13", "timestamp": 1723403053, "time_this_iter_s": 10.015349864959717, "time_total_s": 566.815523147583, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1890e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 566.815523147583, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 60.4, "ram_util_percent": 83.04666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.356833183330794, "cur_kl_coeff": 0.0005859374999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3241756247977416, "policy_loss": -0.0029790588598795392, "vf_loss": 1.3271510670582454, "vf_explained_var": 0.9781928812464078, "kl": 0.0061699750320970866, "entropy": 0.391504681451867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.380221110396087, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3202346589416265, "policy_loss": -0.007860196050993787, "vf_loss": 1.3277785169581573, "vf_explained_var": 0.9777552826330066, "kl": 0.008435655033300921, "entropy": 0.6609305387362838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.261084083005585, "predator_policy": -12.697787285746411}, "policy_reward_max": {"prey_policy": 12.697787285746411, "predator_policy": 50.261084083005585}, "policy_reward_mean": {"prey_policy": -15.834847903562167, "predator_policy": 15.834847903562167}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.38567370486449, -25.463978154911572, -25.890654164904348, -33.81546551029273, 1.4102470558160025, -40.14362446678993, -18.94844629673628, -25.566927721307643, -32.15846183575067, -41.69722264764588, -2.368919966372996, -13.896231915393741, -31.2144612660367, -16.34340671294472, 9.189361602950969, -19.01231771709501, -5.21456900099369, -6.080563455380526, -2.9389693643641586, -42.7946439771836, -40.02952182562937, -6.265385850293858, -37.65748422389828, 2.017171124252487, -37.399148465731756, -13.560060382478072, -2.8286139257530403, 4.162458212253982, -24.93258582780482, -9.252849611771552, -10.495953637608602, -0.6056951214590498, 1.955202738027829, -38.513685792324225, -24.71596745926674, 1.7865113243184734, -3.537087245961854, -19.324369891982137, -31.716328117412274, -32.66313257058704, -23.613803619568124, -7.417030967095911, -20.74342502578963, -5.2250384631079365, -20.41631953048917, -32.88501696541205, -7.442154297395675, -24.064652106416, -24.959137783142584, -19.332899561188675, -18.829681714507565, -19.335907665698123, -8.271802915907266, -18.575121638913917, -22.78858625249055, -25.53398804451362, -8.539194892772104, -1.921354072957472, -14.089288133644853, -10.384695683478306, -6.8884083694994445, -24.871149327284357, -9.120935725999619, -20.68271205895367, -17.640004700514485, -37.162741613992225, 7.201773952415946, -32.41518911639939, -12.217520889018825, 1.651239767513415, -25.013827968934642, -20.72051752372936, -5.469462108214959, -7.610017431029057, -24.15947099277618, -10.249079964470866, 0.1325462864828708, 3.566136012916875, 7.2267326364074815, -6.706709233108521, -16.059227896544364, -5.477441393421895, -8.16341597478637, 3.365494710302505, -14.42792899046733, -21.01852602592556, 12.697787285746411, -12.922740756243632, -20.027131541204653, 3.428378124203295, -16.07922496748006, 6.079570199336228, -18.8597331890954, -39.27558315443525, 4.282348714865828, -38.859770989875585, -40.72217609754405, -50.261084083005585, -17.76935349473162, -0.9851573619195015], "policy_predator_policy_reward": [20.38567370486449, 25.463978154911572, 25.890654164904348, 33.81546551029273, -1.4102470558160025, 40.14362446678993, 18.94844629673628, 25.566927721307643, 32.15846183575067, 41.69722264764588, 2.368919966372996, 13.896231915393741, 31.2144612660367, 16.34340671294472, -9.189361602950969, 19.01231771709501, 5.21456900099369, 6.080563455380526, 2.9389693643641586, 42.7946439771836, 40.02952182562937, 6.265385850293858, 37.65748422389828, -2.017171124252487, 37.399148465731756, 13.560060382478072, 2.8286139257530403, -4.162458212253982, 24.93258582780482, 9.252849611771552, 10.495953637608602, 0.6056951214590498, -1.955202738027829, 38.513685792324225, 24.71596745926674, -1.7865113243184734, 3.537087245961854, 19.324369891982137, 31.716328117412274, 32.66313257058704, 23.613803619568124, 7.417030967095911, 20.74342502578963, 5.2250384631079365, 20.41631953048917, 32.88501696541205, 7.442154297395675, 24.064652106416, 24.959137783142584, 19.332899561188675, 18.829681714507565, 19.335907665698123, 8.271802915907266, 18.575121638913917, 22.78858625249055, 25.53398804451362, 8.539194892772104, 1.921354072957472, 14.089288133644853, 10.384695683478306, 6.8884083694994445, 24.871149327284357, 9.120935725999619, 20.68271205895367, 17.640004700514485, 37.162741613992225, -7.201773952415946, 32.41518911639939, 12.217520889018825, -1.651239767513415, 25.013827968934642, 20.72051752372936, 5.469462108214959, 7.610017431029057, 24.15947099277618, 10.249079964470866, -0.1325462864828708, -3.566136012916875, -7.2267326364074815, 6.706709233108521, 16.059227896544364, 5.477441393421895, 8.16341597478637, -3.365494710302505, 14.42792899046733, 21.01852602592556, -12.697787285746411, 12.922740756243632, 20.027131541204653, -3.428378124203295, 16.07922496748006, -6.079570199336228, 18.8597331890954, 39.27558315443525, -4.282348714865828, 38.859770989875585, 40.72217609754405, 50.261084083005585, 17.76935349473162, 0.9851573619195015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5467360888461801, "mean_inference_ms": 1.8582459532903512, "mean_action_processing_ms": 0.22997328784140422, "mean_env_wait_ms": 0.14565160243049222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007892131805419922, "StateBufferConnector_ms": 0.002934575080871582, "ViewRequirementAgentConnector_ms": 0.07945764064788818}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 418.5345894913821, "num_env_steps_trained_throughput_per_sec": 418.5345894913821, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 10514.469, "restore_workers_time_ms": 0.022, "training_step_time_ms": 10514.134, "sample_time_ms": 1645.751, "learn_time_ms": 8777.042, "learn_throughput": 455.734, "synch_weights_time_ms": 88.844}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 58, "trial_id": "1f352_00000", "date": "2024-08-11_15-04-23", "timestamp": 1723403063, "time_this_iter_s": 9.603919982910156, "time_total_s": 576.4194431304932, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1890d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 576.4194431304932, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 55.146153846153844, "ram_util_percent": 83.16153846153847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.424915413868924, "cur_kl_coeff": 0.0005859374999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5244836983581385, "policy_loss": -0.0016558196201610067, "vf_loss": 1.5261373665804665, "vf_explained_var": 0.9713603768497705, "kl": 0.003669915516944595, "entropy": 0.40479766683032115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.586396085533003, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4903169671694438, "policy_loss": -0.003754827982629649, "vf_loss": 1.4936718933905164, "vf_explained_var": 0.9729739669710398, "kl": 0.01066406018479024, "entropy": 0.653297431456546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.261084083005585, "predator_policy": -12.697787285746411}, "policy_reward_max": {"prey_policy": 12.697787285746411, "predator_policy": 50.261084083005585}, "policy_reward_mean": {"prey_policy": -15.23672609065509, "predator_policy": 15.23672609065509}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.9389693643641586, -42.7946439771836, -40.02952182562937, -6.265385850293858, -37.65748422389828, 2.017171124252487, -37.399148465731756, -13.560060382478072, -2.8286139257530403, 4.162458212253982, -24.93258582780482, -9.252849611771552, -10.495953637608602, -0.6056951214590498, 1.955202738027829, -38.513685792324225, -24.71596745926674, 1.7865113243184734, -3.537087245961854, -19.324369891982137, -31.716328117412274, -32.66313257058704, -23.613803619568124, -7.417030967095911, -20.74342502578963, -5.2250384631079365, -20.41631953048917, -32.88501696541205, -7.442154297395675, -24.064652106416, -24.959137783142584, -19.332899561188675, -18.829681714507565, -19.335907665698123, -8.271802915907266, -18.575121638913917, -22.78858625249055, -25.53398804451362, -8.539194892772104, -1.921354072957472, -14.089288133644853, -10.384695683478306, -6.8884083694994445, -24.871149327284357, -9.120935725999619, -20.68271205895367, -17.640004700514485, -37.162741613992225, 7.201773952415946, -32.41518911639939, -12.217520889018825, 1.651239767513415, -25.013827968934642, -20.72051752372936, -5.469462108214959, -7.610017431029057, -24.15947099277618, -10.249079964470866, 0.1325462864828708, 3.566136012916875, 7.2267326364074815, -6.706709233108521, -16.059227896544364, -5.477441393421895, -8.16341597478637, 3.365494710302505, -14.42792899046733, -21.01852602592556, 12.697787285746411, -12.922740756243632, -20.027131541204653, 3.428378124203295, -16.07922496748006, 6.079570199336228, -18.8597331890954, -39.27558315443525, 4.282348714865828, -38.859770989875585, -40.72217609754405, -50.261084083005585, -17.76935349473162, -0.9851573619195015, -22.921256867790376, 2.2413993153135277, -18.01175376926053, -11.858735671894546, -12.362957953731481, -16.295391547054756, 3.9688912982755884, -20.878621842500603, 5.700251178502109, -12.763452908899843, -32.27623665297348, 4.807160477046345, -37.76354480176517, -20.47965345107818, -32.12395953519072, -30.02817502338002, -10.13400996063724, -26.609086870926568], "policy_predator_policy_reward": [2.9389693643641586, 42.7946439771836, 40.02952182562937, 6.265385850293858, 37.65748422389828, -2.017171124252487, 37.399148465731756, 13.560060382478072, 2.8286139257530403, -4.162458212253982, 24.93258582780482, 9.252849611771552, 10.495953637608602, 0.6056951214590498, -1.955202738027829, 38.513685792324225, 24.71596745926674, -1.7865113243184734, 3.537087245961854, 19.324369891982137, 31.716328117412274, 32.66313257058704, 23.613803619568124, 7.417030967095911, 20.74342502578963, 5.2250384631079365, 20.41631953048917, 32.88501696541205, 7.442154297395675, 24.064652106416, 24.959137783142584, 19.332899561188675, 18.829681714507565, 19.335907665698123, 8.271802915907266, 18.575121638913917, 22.78858625249055, 25.53398804451362, 8.539194892772104, 1.921354072957472, 14.089288133644853, 10.384695683478306, 6.8884083694994445, 24.871149327284357, 9.120935725999619, 20.68271205895367, 17.640004700514485, 37.162741613992225, -7.201773952415946, 32.41518911639939, 12.217520889018825, -1.651239767513415, 25.013827968934642, 20.72051752372936, 5.469462108214959, 7.610017431029057, 24.15947099277618, 10.249079964470866, -0.1325462864828708, -3.566136012916875, -7.2267326364074815, 6.706709233108521, 16.059227896544364, 5.477441393421895, 8.16341597478637, -3.365494710302505, 14.42792899046733, 21.01852602592556, -12.697787285746411, 12.922740756243632, 20.027131541204653, -3.428378124203295, 16.07922496748006, -6.079570199336228, 18.8597331890954, 39.27558315443525, -4.282348714865828, 38.859770989875585, 40.72217609754405, 50.261084083005585, 17.76935349473162, 0.9851573619195015, 22.921256867790376, -2.2413993153135277, 18.01175376926053, 11.858735671894546, 12.362957953731481, 16.295391547054756, -3.9688912982755884, 20.878621842500603, -5.700251178502109, 12.763452908899843, 32.27623665297348, -4.807160477046345, 37.76354480176517, 20.47965345107818, 32.12395953519072, 30.02817502338002, 10.13400996063724, 26.609086870926568]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5419097263112291, "mean_inference_ms": 1.8429521130529531, "mean_action_processing_ms": 0.2280681273663398, "mean_env_wait_ms": 0.14463302013757665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007490754127502441, "StateBufferConnector_ms": 0.0027000904083251953, "ViewRequirementAgentConnector_ms": 0.07184779644012451}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.2259577651666, "num_env_steps_trained_throughput_per_sec": 428.2259577651666, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 472000, "timers": {"training_iteration_time_ms": 10283.925, "restore_workers_time_ms": 0.022, "training_step_time_ms": 10283.573, "sample_time_ms": 1609.264, "learn_time_ms": 8637.649, "learn_throughput": 463.089, "synch_weights_time_ms": 33.962}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "done": false, "training_iteration": 59, "trial_id": "1f352_00000", "date": "2024-08-11_15-04-32", "timestamp": 1723403072, "time_this_iter_s": 9.387080907821655, "time_total_s": 585.8065240383148, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1890b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 585.8065240383148, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 55.91428571428571, "ram_util_percent": 83.30714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7150705329452953, "cur_kl_coeff": 0.00029296874999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6518277217944464, "policy_loss": -0.003130661395456021, "vf_loss": 1.6549572512507438, "vf_explained_var": 0.9697596866637468, "kl": 0.0038747878648657964, "entropy": 0.38470043235768875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6019324753433466, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6243435068055987, "policy_loss": -0.005678834664771178, "vf_loss": 1.6298150864119332, "vf_explained_var": 0.9721249667927623, "kl": 0.0055267842035005696, "entropy": 0.663661377131939, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.261084083005585, "predator_policy": -12.697787285746411}, "policy_reward_max": {"prey_policy": 12.697787285746411, "predator_policy": 50.261084083005585}, "policy_reward_mean": {"prey_policy": -15.412053167015854, "predator_policy": 15.412053167015854}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-7.417030967095911, -20.74342502578963, -5.2250384631079365, -20.41631953048917, -32.88501696541205, -7.442154297395675, -24.064652106416, -24.959137783142584, -19.332899561188675, -18.829681714507565, -19.335907665698123, -8.271802915907266, -18.575121638913917, -22.78858625249055, -25.53398804451362, -8.539194892772104, -1.921354072957472, -14.089288133644853, -10.384695683478306, -6.8884083694994445, -24.871149327284357, -9.120935725999619, -20.68271205895367, -17.640004700514485, -37.162741613992225, 7.201773952415946, -32.41518911639939, -12.217520889018825, 1.651239767513415, -25.013827968934642, -20.72051752372936, -5.469462108214959, -7.610017431029057, -24.15947099277618, -10.249079964470866, 0.1325462864828708, 3.566136012916875, 7.2267326364074815, -6.706709233108521, -16.059227896544364, -5.477441393421895, -8.16341597478637, 3.365494710302505, -14.42792899046733, -21.01852602592556, 12.697787285746411, -12.922740756243632, -20.027131541204653, 3.428378124203295, -16.07922496748006, 6.079570199336228, -18.8597331890954, -39.27558315443525, 4.282348714865828, -38.859770989875585, -40.72217609754405, -50.261084083005585, -17.76935349473162, -0.9851573619195015, -22.921256867790376, 2.2413993153135277, -18.01175376926053, -11.858735671894546, -12.362957953731481, -16.295391547054756, 3.9688912982755884, -20.878621842500603, 5.700251178502109, -12.763452908899843, -32.27623665297348, 4.807160477046345, -37.76354480176517, -20.47965345107818, -32.12395953519072, -30.02817502338002, -10.13400996063724, -26.609086870926568, -26.143300925215026, 2.266156580325667, -5.944636557526975, -31.13145060566191, -13.046842654911652, -15.00748187863484, -8.14845074485766, 9.320065294887794, -43.953755516490006, -11.293889143666732, -26.729655480414223, -35.873661630429275, 5.009734328233762, -8.45071037321648, -19.34944860124814, -11.36407206348489, -18.26636970943068, -19.281822958597957, -35.24544583379296, -35.64136400010331, -23.026668017651545, -2.5057033557980937, -36.64787730061738], "policy_predator_policy_reward": [7.417030967095911, 20.74342502578963, 5.2250384631079365, 20.41631953048917, 32.88501696541205, 7.442154297395675, 24.064652106416, 24.959137783142584, 19.332899561188675, 18.829681714507565, 19.335907665698123, 8.271802915907266, 18.575121638913917, 22.78858625249055, 25.53398804451362, 8.539194892772104, 1.921354072957472, 14.089288133644853, 10.384695683478306, 6.8884083694994445, 24.871149327284357, 9.120935725999619, 20.68271205895367, 17.640004700514485, 37.162741613992225, -7.201773952415946, 32.41518911639939, 12.217520889018825, -1.651239767513415, 25.013827968934642, 20.72051752372936, 5.469462108214959, 7.610017431029057, 24.15947099277618, 10.249079964470866, -0.1325462864828708, -3.566136012916875, -7.2267326364074815, 6.706709233108521, 16.059227896544364, 5.477441393421895, 8.16341597478637, -3.365494710302505, 14.42792899046733, 21.01852602592556, -12.697787285746411, 12.922740756243632, 20.027131541204653, -3.428378124203295, 16.07922496748006, -6.079570199336228, 18.8597331890954, 39.27558315443525, -4.282348714865828, 38.859770989875585, 40.72217609754405, 50.261084083005585, 17.76935349473162, 0.9851573619195015, 22.921256867790376, -2.2413993153135277, 18.01175376926053, 11.858735671894546, 12.362957953731481, 16.295391547054756, -3.9688912982755884, 20.878621842500603, -5.700251178502109, 12.763452908899843, 32.27623665297348, -4.807160477046345, 37.76354480176517, 20.47965345107818, 32.12395953519072, 30.02817502338002, 10.13400996063724, 26.609086870926568, 26.143300925215026, -2.266156580325667, 5.944636557526975, 31.13145060566191, 13.046842654911652, 15.00748187863484, 8.14845074485766, -9.320065294887794, 43.953755516490006, 11.293889143666732, 26.729655480414223, 35.873661630429275, -5.009734328233762, 8.45071037321648, 19.34944860124814, 11.36407206348489, 18.26636970943068, 19.281822958597957, 35.24544583379296, 35.64136400010331, 23.026668017651545, 2.5057033557980937, 36.64787730061738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.540618412684357, "mean_inference_ms": 1.853499147736372, "mean_action_processing_ms": 0.22742656236984043, "mean_env_wait_ms": 0.14440618355730028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008908510208129883, "StateBufferConnector_ms": 0.0027698278427124023, "ViewRequirementAgentConnector_ms": 0.07994365692138672}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.44571725931854, "num_env_steps_trained_throughput_per_sec": 322.44571725931854, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 10092.554, "restore_workers_time_ms": 0.02, "training_step_time_ms": 10092.21, "sample_time_ms": 1597.005, "learn_time_ms": 8458.487, "learn_throughput": 472.898, "synch_weights_time_ms": 34.15}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 60, "trial_id": "1f352_00000", "date": "2024-08-11_15-04-45", "timestamp": 1723403085, "time_this_iter_s": 12.460664987564087, "time_total_s": 598.2671890258789, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4e3dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 598.2671890258789, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 65.62941176470588, "ram_util_percent": 83.34705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3969465950503945, "cur_kl_coeff": 0.00014648437499999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6269862931221724, "policy_loss": -0.0010908534277405124, "vf_loss": 1.6280766377225517, "vf_explained_var": 0.9653880345324676, "kl": 0.00343053315704282, "entropy": 0.40836241049692035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.578186004422605, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.61097578064849, "policy_loss": -0.006478213181738587, "vf_loss": 1.617117127403617, "vf_explained_var": 0.9662799992909034, "kl": 0.008982964707020182, "entropy": 0.6286373853683471, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.261084083005585, "predator_policy": -12.697787285746411}, "policy_reward_max": {"prey_policy": 12.697787285746411, "predator_policy": 50.261084083005585}, "policy_reward_mean": {"prey_policy": -16.02054364590429, "predator_policy": 16.02054364590429}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.384695683478306, -6.8884083694994445, -24.871149327284357, -9.120935725999619, -20.68271205895367, -17.640004700514485, -37.162741613992225, 7.201773952415946, -32.41518911639939, -12.217520889018825, 1.651239767513415, -25.013827968934642, -20.72051752372936, -5.469462108214959, -7.610017431029057, -24.15947099277618, -10.249079964470866, 0.1325462864828708, 3.566136012916875, 7.2267326364074815, -6.706709233108521, -16.059227896544364, -5.477441393421895, -8.16341597478637, 3.365494710302505, -14.42792899046733, -21.01852602592556, 12.697787285746411, -12.922740756243632, -20.027131541204653, 3.428378124203295, -16.07922496748006, 6.079570199336228, -18.8597331890954, -39.27558315443525, 4.282348714865828, -38.859770989875585, -40.72217609754405, -50.261084083005585, -17.76935349473162, -0.9851573619195015, -22.921256867790376, 2.2413993153135277, -18.01175376926053, -11.858735671894546, -12.362957953731481, -16.295391547054756, 3.9688912982755884, -20.878621842500603, 5.700251178502109, -12.763452908899843, -32.27623665297348, 4.807160477046345, -37.76354480176517, -20.47965345107818, -32.12395953519072, -30.02817502338002, -10.13400996063724, -26.609086870926568, -26.143300925215026, 2.266156580325667, -5.944636557526975, -31.13145060566191, -13.046842654911652, -15.00748187863484, -8.14845074485766, 9.320065294887794, -43.953755516490006, -11.293889143666732, -26.729655480414223, -35.873661630429275, 5.009734328233762, -8.45071037321648, -19.34944860124814, -11.36407206348489, -18.26636970943068, -19.281822958597957, -35.24544583379296, -35.64136400010331, -23.026668017651545, -2.5057033557980937, -36.64787730061738, -15.430947635796445, -35.05929656254886, -5.773087227088915, -36.65824405011558, -16.977147202618717, -9.034103711321547, -24.10068393641093, -9.611993654759507, -37.43730581471253, -34.357838497849606, -14.7768905260407, -18.38099518082338, -8.82437707709845, -9.323155299483261, -25.690254789127223, -27.405035324196323, -29.55238524299392, -2.8259061873006566], "policy_predator_policy_reward": [10.384695683478306, 6.8884083694994445, 24.871149327284357, 9.120935725999619, 20.68271205895367, 17.640004700514485, 37.162741613992225, -7.201773952415946, 32.41518911639939, 12.217520889018825, -1.651239767513415, 25.013827968934642, 20.72051752372936, 5.469462108214959, 7.610017431029057, 24.15947099277618, 10.249079964470866, -0.1325462864828708, -3.566136012916875, -7.2267326364074815, 6.706709233108521, 16.059227896544364, 5.477441393421895, 8.16341597478637, -3.365494710302505, 14.42792899046733, 21.01852602592556, -12.697787285746411, 12.922740756243632, 20.027131541204653, -3.428378124203295, 16.07922496748006, -6.079570199336228, 18.8597331890954, 39.27558315443525, -4.282348714865828, 38.859770989875585, 40.72217609754405, 50.261084083005585, 17.76935349473162, 0.9851573619195015, 22.921256867790376, -2.2413993153135277, 18.01175376926053, 11.858735671894546, 12.362957953731481, 16.295391547054756, -3.9688912982755884, 20.878621842500603, -5.700251178502109, 12.763452908899843, 32.27623665297348, -4.807160477046345, 37.76354480176517, 20.47965345107818, 32.12395953519072, 30.02817502338002, 10.13400996063724, 26.609086870926568, 26.143300925215026, -2.266156580325667, 5.944636557526975, 31.13145060566191, 13.046842654911652, 15.00748187863484, 8.14845074485766, -9.320065294887794, 43.953755516490006, 11.293889143666732, 26.729655480414223, 35.873661630429275, -5.009734328233762, 8.45071037321648, 19.34944860124814, 11.36407206348489, 18.26636970943068, 19.281822958597957, 35.24544583379296, 35.64136400010331, 23.026668017651545, 2.5057033557980937, 36.64787730061738, 15.430947635796445, 35.05929656254886, 5.773087227088915, 36.65824405011558, 16.977147202618717, 9.034103711321547, 24.10068393641093, 9.611993654759507, 37.43730581471253, 34.357838497849606, 14.7768905260407, 18.38099518082338, 8.82437707709845, 9.323155299483261, 25.690254789127223, 27.405035324196323, 29.55238524299392, 2.8259061873006566]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5401374834390119, "mean_inference_ms": 1.8633919871338904, "mean_action_processing_ms": 0.22719018484786396, "mean_env_wait_ms": 0.1443214300377924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010000109672546387, "StateBufferConnector_ms": 0.002873539924621582, "ViewRequirementAgentConnector_ms": 0.08563494682312012}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 399.88591587854853, "num_env_steps_trained_throughput_per_sec": 399.88591587854853, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 488000, "timers": {"training_iteration_time_ms": 10056.108, "restore_workers_time_ms": 0.022, "training_step_time_ms": 10055.474, "sample_time_ms": 1566.002, "learn_time_ms": 8446.213, "learn_throughput": 473.585, "synch_weights_time_ms": 39.056}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "done": false, "training_iteration": 61, "trial_id": "1f352_00000", "date": "2024-08-11_15-04-55", "timestamp": 1723403095, "time_this_iter_s": 10.199887752532959, "time_total_s": 608.4670767784119, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b18a3700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 608.4670767784119, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 55.306666666666665, "ram_util_percent": 82.77333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.396736447761456, "cur_kl_coeff": 7.324218749999998e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4166909344494343, "policy_loss": -0.004174920664081583, "vf_loss": 2.4208654548972843, "vf_explained_var": 0.948298011161387, "kl": 0.005577249576900632, "entropy": 0.4930241709575057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.530221582700809, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4213449167708556, "policy_loss": -0.006048620356887113, "vf_loss": 2.427061818043391, "vf_explained_var": 0.9476486661781868, "kl": 0.008845919563682022, "entropy": 0.6766604136054715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.261084083005585, "predator_policy": -12.697787285746411}, "policy_reward_max": {"prey_policy": 12.697787285746411, "predator_policy": 50.261084083005585}, "policy_reward_mean": {"prey_policy": -16.8041240223154, "predator_policy": 16.8041240223154}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3.566136012916875, 7.2267326364074815, -6.706709233108521, -16.059227896544364, -5.477441393421895, -8.16341597478637, 3.365494710302505, -14.42792899046733, -21.01852602592556, 12.697787285746411, -12.922740756243632, -20.027131541204653, 3.428378124203295, -16.07922496748006, 6.079570199336228, -18.8597331890954, -39.27558315443525, 4.282348714865828, -38.859770989875585, -40.72217609754405, -50.261084083005585, -17.76935349473162, -0.9851573619195015, -22.921256867790376, 2.2413993153135277, -18.01175376926053, -11.858735671894546, -12.362957953731481, -16.295391547054756, 3.9688912982755884, -20.878621842500603, 5.700251178502109, -12.763452908899843, -32.27623665297348, 4.807160477046345, -37.76354480176517, -20.47965345107818, -32.12395953519072, -30.02817502338002, -10.13400996063724, -26.609086870926568, -26.143300925215026, 2.266156580325667, -5.944636557526975, -31.13145060566191, -13.046842654911652, -15.00748187863484, -8.14845074485766, 9.320065294887794, -43.953755516490006, -11.293889143666732, -26.729655480414223, -35.873661630429275, 5.009734328233762, -8.45071037321648, -19.34944860124814, -11.36407206348489, -18.26636970943068, -19.281822958597957, -35.24544583379296, -35.64136400010331, -23.026668017651545, -2.5057033557980937, -36.64787730061738, -15.430947635796445, -35.05929656254886, -5.773087227088915, -36.65824405011558, -16.977147202618717, -9.034103711321547, -24.10068393641093, -9.611993654759507, -37.43730581471253, -34.357838497849606, -14.7768905260407, -18.38099518082338, -8.82437707709845, -9.323155299483261, -25.690254789127223, -27.405035324196323, -29.55238524299392, -2.8259061873006566, -1.744590635456114, -35.20069034768582, -15.287980473456084, -35.14017059855992, -19.302093717393635, -21.50117959519409, 9.571878279005922, -14.682788514978558, -29.922063839325247, -49.1621181340282, -26.068430750249966, -16.893131300368886, -12.571478109537443, -27.8754029049639, -22.287604117929828, -5.653347067554163, 8.852189115821389, -19.109208397139312], "policy_predator_policy_reward": [-3.566136012916875, -7.2267326364074815, 6.706709233108521, 16.059227896544364, 5.477441393421895, 8.16341597478637, -3.365494710302505, 14.42792899046733, 21.01852602592556, -12.697787285746411, 12.922740756243632, 20.027131541204653, -3.428378124203295, 16.07922496748006, -6.079570199336228, 18.8597331890954, 39.27558315443525, -4.282348714865828, 38.859770989875585, 40.72217609754405, 50.261084083005585, 17.76935349473162, 0.9851573619195015, 22.921256867790376, -2.2413993153135277, 18.01175376926053, 11.858735671894546, 12.362957953731481, 16.295391547054756, -3.9688912982755884, 20.878621842500603, -5.700251178502109, 12.763452908899843, 32.27623665297348, -4.807160477046345, 37.76354480176517, 20.47965345107818, 32.12395953519072, 30.02817502338002, 10.13400996063724, 26.609086870926568, 26.143300925215026, -2.266156580325667, 5.944636557526975, 31.13145060566191, 13.046842654911652, 15.00748187863484, 8.14845074485766, -9.320065294887794, 43.953755516490006, 11.293889143666732, 26.729655480414223, 35.873661630429275, -5.009734328233762, 8.45071037321648, 19.34944860124814, 11.36407206348489, 18.26636970943068, 19.281822958597957, 35.24544583379296, 35.64136400010331, 23.026668017651545, 2.5057033557980937, 36.64787730061738, 15.430947635796445, 35.05929656254886, 5.773087227088915, 36.65824405011558, 16.977147202618717, 9.034103711321547, 24.10068393641093, 9.611993654759507, 37.43730581471253, 34.357838497849606, 14.7768905260407, 18.38099518082338, 8.82437707709845, 9.323155299483261, 25.690254789127223, 27.405035324196323, 29.55238524299392, 2.8259061873006566, 1.744590635456114, 35.20069034768582, 15.287980473456084, 35.14017059855992, 19.302093717393635, 21.50117959519409, -9.571878279005922, 14.682788514978558, 29.922063839325247, 49.1621181340282, 26.068430750249966, 16.893131300368886, 12.571478109537443, 27.8754029049639, 22.287604117929828, 5.653347067554163, -8.852189115821389, 19.109208397139312]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5414337559099355, "mean_inference_ms": 1.8804759441958252, "mean_action_processing_ms": 0.22793223112463212, "mean_env_wait_ms": 0.14473607904559976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009872078895568848, "StateBufferConnector_ms": 0.0033158063888549805, "ViewRequirementAgentConnector_ms": 0.11043238639831543}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.26093729964725, "num_env_steps_trained_throughput_per_sec": 295.26093729964725, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 10376.311, "restore_workers_time_ms": 0.023, "training_step_time_ms": 10375.675, "sample_time_ms": 1660.799, "learn_time_ms": 8670.413, "learn_throughput": 461.339, "synch_weights_time_ms": 39.395}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 62, "trial_id": "1f352_00000", "date": "2024-08-11_15-05-09", "timestamp": 1723403109, "time_this_iter_s": 13.610576152801514, "time_total_s": 622.0776529312134, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b188eaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 622.0776529312134, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 73.3578947368421, "ram_util_percent": 83.48947368421054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5340354716405273, "cur_kl_coeff": 7.324218749999998e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.488335228835543, "policy_loss": -0.003420903019529457, "vf_loss": 2.4917557639380297, "vf_explained_var": 0.938443049043417, "kl": 0.00502256866131637, "entropy": 0.4264565433996419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.758409490995109, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4753720494608085, "policy_loss": -0.006420322159829084, "vf_loss": 2.481419206658999, "vf_explained_var": 0.9385863561183214, "kl": 0.009951048469020262, "entropy": 0.664725306754311, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.1621181340282, "predator_policy": -9.571878279005922}, "policy_reward_max": {"prey_policy": 9.571878279005922, "predator_policy": 49.1621181340282}, "policy_reward_mean": {"prey_policy": -16.4497779004461, "predator_policy": 16.4497779004461}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-0.9851573619195015, -22.921256867790376, 2.2413993153135277, -18.01175376926053, -11.858735671894546, -12.362957953731481, -16.295391547054756, 3.9688912982755884, -20.878621842500603, 5.700251178502109, -12.763452908899843, -32.27623665297348, 4.807160477046345, -37.76354480176517, -20.47965345107818, -32.12395953519072, -30.02817502338002, -10.13400996063724, -26.609086870926568, -26.143300925215026, 2.266156580325667, -5.944636557526975, -31.13145060566191, -13.046842654911652, -15.00748187863484, -8.14845074485766, 9.320065294887794, -43.953755516490006, -11.293889143666732, -26.729655480414223, -35.873661630429275, 5.009734328233762, -8.45071037321648, -19.34944860124814, -11.36407206348489, -18.26636970943068, -19.281822958597957, -35.24544583379296, -35.64136400010331, -23.026668017651545, -2.5057033557980937, -36.64787730061738, -15.430947635796445, -35.05929656254886, -5.773087227088915, -36.65824405011558, -16.977147202618717, -9.034103711321547, -24.10068393641093, -9.611993654759507, -37.43730581471253, -34.357838497849606, -14.7768905260407, -18.38099518082338, -8.82437707709845, -9.323155299483261, -25.690254789127223, -27.405035324196323, -29.55238524299392, -2.8259061873006566, -1.744590635456114, -35.20069034768582, -15.287980473456084, -35.14017059855992, -19.302093717393635, -21.50117959519409, 9.571878279005922, -14.682788514978558, -29.922063839325247, -49.1621181340282, -26.068430750249966, -16.893131300368886, -12.571478109537443, -27.8754029049639, -22.287604117929828, -5.653347067554163, 8.852189115821389, -19.109208397139312, 6.174095607661192, 3.817249932478072, -31.809988006655843, -32.467369596997834, -7.362491755949889, -30.103416374194346, -10.75186611573566, -46.058098517276335, 7.808385828203143, -14.552575986291933, -9.817741038104721, -2.125518084790194, -6.953629315342203, -21.45076732912439, 8.614217641817895, 0.5406455064221838, -32.16118681554922, -18.683196253019467, -5.087035478485159, -6.482038864104009, -3.438023590782146, 1.8013606886594218], "policy_predator_policy_reward": [0.9851573619195015, 22.921256867790376, -2.2413993153135277, 18.01175376926053, 11.858735671894546, 12.362957953731481, 16.295391547054756, -3.9688912982755884, 20.878621842500603, -5.700251178502109, 12.763452908899843, 32.27623665297348, -4.807160477046345, 37.76354480176517, 20.47965345107818, 32.12395953519072, 30.02817502338002, 10.13400996063724, 26.609086870926568, 26.143300925215026, -2.266156580325667, 5.944636557526975, 31.13145060566191, 13.046842654911652, 15.00748187863484, 8.14845074485766, -9.320065294887794, 43.953755516490006, 11.293889143666732, 26.729655480414223, 35.873661630429275, -5.009734328233762, 8.45071037321648, 19.34944860124814, 11.36407206348489, 18.26636970943068, 19.281822958597957, 35.24544583379296, 35.64136400010331, 23.026668017651545, 2.5057033557980937, 36.64787730061738, 15.430947635796445, 35.05929656254886, 5.773087227088915, 36.65824405011558, 16.977147202618717, 9.034103711321547, 24.10068393641093, 9.611993654759507, 37.43730581471253, 34.357838497849606, 14.7768905260407, 18.38099518082338, 8.82437707709845, 9.323155299483261, 25.690254789127223, 27.405035324196323, 29.55238524299392, 2.8259061873006566, 1.744590635456114, 35.20069034768582, 15.287980473456084, 35.14017059855992, 19.302093717393635, 21.50117959519409, -9.571878279005922, 14.682788514978558, 29.922063839325247, 49.1621181340282, 26.068430750249966, 16.893131300368886, 12.571478109537443, 27.8754029049639, 22.287604117929828, 5.653347067554163, -8.852189115821389, 19.109208397139312, -6.174095607661192, -3.817249932478072, 31.809988006655843, 32.467369596997834, 7.362491755949889, 30.103416374194346, 10.75186611573566, 46.058098517276335, -7.808385828203143, 14.552575986291933, 9.817741038104721, 2.125518084790194, 6.953629315342203, 21.45076732912439, -8.614217641817895, -0.5406455064221838, 32.16118681554922, 18.683196253019467, 5.087035478485159, 6.482038864104009, 3.438023590782146, -1.8013606886594218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5434085310382222, "mean_inference_ms": 1.901401234589095, "mean_action_processing_ms": 0.22901393388709174, "mean_env_wait_ms": 0.145353367175368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008833169937133789, "StateBufferConnector_ms": 0.004217028617858887, "ViewRequirementAgentConnector_ms": 0.11612868309020996}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 434.2732405216627, "num_env_steps_trained_throughput_per_sec": 434.2732405216627, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 10294.901, "restore_workers_time_ms": 0.022, "training_step_time_ms": 10294.275, "sample_time_ms": 1606.803, "learn_time_ms": 8645.439, "learn_throughput": 462.672, "synch_weights_time_ms": 37.536}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "training_iteration": 63, "trial_id": "1f352_00000", "date": "2024-08-11_15-05-18", "timestamp": 1723403118, "time_this_iter_s": 9.279926776885986, "time_total_s": 631.3575797080994, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af4e3dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 631.3575797080994, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 54.92857142857144, "ram_util_percent": 81.97857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4116843563814956, "cur_kl_coeff": 7.324218749999998e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4235141549259422, "policy_loss": -0.006109293047726775, "vf_loss": 2.4296227832635244, "vf_explained_var": 0.9475322733943661, "kl": 0.009223371599549541, "entropy": 0.45248123401155077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4096847234914702, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.447331449886163, "policy_loss": -0.0038726706664116745, "vf_loss": 2.4509217125674088, "vf_explained_var": 0.9455150594934821, "kl": 0.007530989232240515, "entropy": 0.6834701839834452, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.1621181340282, "predator_policy": -9.571878279005922}, "policy_reward_max": {"prey_policy": 9.571878279005922, "predator_policy": 49.1621181340282}, "policy_reward_mean": {"prey_policy": -17.16688837580161, "predator_policy": 17.16688837580161}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.046842654911652, -15.00748187863484, -8.14845074485766, 9.320065294887794, -43.953755516490006, -11.293889143666732, -26.729655480414223, -35.873661630429275, 5.009734328233762, -8.45071037321648, -19.34944860124814, -11.36407206348489, -18.26636970943068, -19.281822958597957, -35.24544583379296, -35.64136400010331, -23.026668017651545, -2.5057033557980937, -36.64787730061738, -15.430947635796445, -35.05929656254886, -5.773087227088915, -36.65824405011558, -16.977147202618717, -9.034103711321547, -24.10068393641093, -9.611993654759507, -37.43730581471253, -34.357838497849606, -14.7768905260407, -18.38099518082338, -8.82437707709845, -9.323155299483261, -25.690254789127223, -27.405035324196323, -29.55238524299392, -2.8259061873006566, -1.744590635456114, -35.20069034768582, -15.287980473456084, -35.14017059855992, -19.302093717393635, -21.50117959519409, 9.571878279005922, -14.682788514978558, -29.922063839325247, -49.1621181340282, -26.068430750249966, -16.893131300368886, -12.571478109537443, -27.8754029049639, -22.287604117929828, -5.653347067554163, 8.852189115821389, -19.109208397139312, 6.174095607661192, 3.817249932478072, -31.809988006655843, -32.467369596997834, -7.362491755949889, -30.103416374194346, -10.75186611573566, -46.058098517276335, 7.808385828203143, -14.552575986291933, -9.817741038104721, -2.125518084790194, -6.953629315342203, -21.45076732912439, 8.614217641817895, 0.5406455064221838, -32.16118681554922, -18.683196253019467, -5.087035478485159, -6.482038864104009, -3.438023590782146, 1.8013606886594218, -20.10517655971852, -18.618688081395465, -21.047746719741653, -15.889702525920086, -22.828395985749303, -37.71817933227109, -29.29628366289813, 8.530665182182727, -9.552480709193897, -27.978796248542835, -43.22514205785998, -23.451061294446006, -3.6319947451766463, 3.3287110418573236, -12.712272567664511, 5.224750385609029, -33.58660113275266, -8.131554403856473, -24.17418823119908, -12.076214545629568, -14.365748696810023, -16.04649575177571, -44.08597435054251], "policy_predator_policy_reward": [13.046842654911652, 15.00748187863484, 8.14845074485766, -9.320065294887794, 43.953755516490006, 11.293889143666732, 26.729655480414223, 35.873661630429275, -5.009734328233762, 8.45071037321648, 19.34944860124814, 11.36407206348489, 18.26636970943068, 19.281822958597957, 35.24544583379296, 35.64136400010331, 23.026668017651545, 2.5057033557980937, 36.64787730061738, 15.430947635796445, 35.05929656254886, 5.773087227088915, 36.65824405011558, 16.977147202618717, 9.034103711321547, 24.10068393641093, 9.611993654759507, 37.43730581471253, 34.357838497849606, 14.7768905260407, 18.38099518082338, 8.82437707709845, 9.323155299483261, 25.690254789127223, 27.405035324196323, 29.55238524299392, 2.8259061873006566, 1.744590635456114, 35.20069034768582, 15.287980473456084, 35.14017059855992, 19.302093717393635, 21.50117959519409, -9.571878279005922, 14.682788514978558, 29.922063839325247, 49.1621181340282, 26.068430750249966, 16.893131300368886, 12.571478109537443, 27.8754029049639, 22.287604117929828, 5.653347067554163, -8.852189115821389, 19.109208397139312, -6.174095607661192, -3.817249932478072, 31.809988006655843, 32.467369596997834, 7.362491755949889, 30.103416374194346, 10.75186611573566, 46.058098517276335, -7.808385828203143, 14.552575986291933, 9.817741038104721, 2.125518084790194, 6.953629315342203, 21.45076732912439, -8.614217641817895, -0.5406455064221838, 32.16118681554922, 18.683196253019467, 5.087035478485159, 6.482038864104009, 3.438023590782146, -1.8013606886594218, 20.10517655971852, 18.618688081395465, 21.047746719741653, 15.889702525920086, 22.828395985749303, 37.71817933227109, 29.29628366289813, -8.530665182182727, 9.552480709193897, 27.978796248542835, 43.22514205785998, 23.451061294446006, 3.6319947451766463, -3.3287110418573236, 12.712272567664511, -5.224750385609029, 33.58660113275266, 8.131554403856473, 24.17418823119908, 12.076214545629568, 14.365748696810023, 16.04649575177571, 44.08597435054251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5468315564925326, "mean_inference_ms": 1.9243233114566918, "mean_action_processing_ms": 0.23052771605294764, "mean_env_wait_ms": 0.1462066031287362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008502006530761719, "StateBufferConnector_ms": 0.004343152046203613, "ViewRequirementAgentConnector_ms": 0.11870598793029785}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 421.896787525032, "num_env_steps_trained_throughput_per_sec": 421.896787525032, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 10258.148, "restore_workers_time_ms": 0.022, "training_step_time_ms": 10257.653, "sample_time_ms": 1607.786, "learn_time_ms": 8607.665, "learn_throughput": 464.702, "synch_weights_time_ms": 37.981}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 64, "trial_id": "1f352_00000", "date": "2024-08-11_15-05-28", "timestamp": 1723403128, "time_this_iter_s": 9.497076988220215, "time_total_s": 640.8546566963196, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b188eca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 640.8546566963196, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 54.51538461538462, "ram_util_percent": 81.98461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2387584134936334, "cur_kl_coeff": 7.324218749999998e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.023188027180731, "policy_loss": -0.0006867694576309683, "vf_loss": 2.023874485741059, "vf_explained_var": 0.9559985477477312, "kl": 0.004220941476688401, "entropy": 0.43716149209067223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.359562779466311, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.042303892162939, "policy_loss": -0.007331074816950907, "vf_loss": 2.0489205668369928, "vf_explained_var": 0.9556772314012051, "kl": 0.019050841906159195, "entropy": 0.6585952932015061, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.1621181340282, "predator_policy": -9.571878279005922}, "policy_reward_max": {"prey_policy": 9.571878279005922, "predator_policy": 49.1621181340282}, "policy_reward_mean": {"prey_policy": -17.564648447331773, "predator_policy": 17.564648447331773}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-36.64787730061738, -15.430947635796445, -35.05929656254886, -5.773087227088915, -36.65824405011558, -16.977147202618717, -9.034103711321547, -24.10068393641093, -9.611993654759507, -37.43730581471253, -34.357838497849606, -14.7768905260407, -18.38099518082338, -8.82437707709845, -9.323155299483261, -25.690254789127223, -27.405035324196323, -29.55238524299392, -2.8259061873006566, -1.744590635456114, -35.20069034768582, -15.287980473456084, -35.14017059855992, -19.302093717393635, -21.50117959519409, 9.571878279005922, -14.682788514978558, -29.922063839325247, -49.1621181340282, -26.068430750249966, -16.893131300368886, -12.571478109537443, -27.8754029049639, -22.287604117929828, -5.653347067554163, 8.852189115821389, -19.109208397139312, 6.174095607661192, 3.817249932478072, -31.809988006655843, -32.467369596997834, -7.362491755949889, -30.103416374194346, -10.75186611573566, -46.058098517276335, 7.808385828203143, -14.552575986291933, -9.817741038104721, -2.125518084790194, -6.953629315342203, -21.45076732912439, 8.614217641817895, 0.5406455064221838, -32.16118681554922, -18.683196253019467, -5.087035478485159, -6.482038864104009, -3.438023590782146, 1.8013606886594218, -20.10517655971852, -18.618688081395465, -21.047746719741653, -15.889702525920086, -22.828395985749303, -37.71817933227109, -29.29628366289813, 8.530665182182727, -9.552480709193897, -27.978796248542835, -43.22514205785998, -23.451061294446006, -3.6319947451766463, 3.3287110418573236, -12.712272567664511, 5.224750385609029, -33.58660113275266, -8.131554403856473, -24.17418823119908, -12.076214545629568, -14.365748696810023, -16.04649575177571, -44.08597435054251, -17.385266228223824, -24.768502704236404, -2.2601113201804885, -14.95806581685027, -28.105481230031693, -1.0246363536582521, -13.881519733547751, -30.08528826541696, -7.7909711438279405, -30.16815890572054, -34.7873854401952, -17.28399945140047, -32.13164423460107, 1.8440523709909424, -11.50573005493312, -31.179612037985002, -33.30592153816895, -23.853307404636386], "policy_predator_policy_reward": [36.64787730061738, 15.430947635796445, 35.05929656254886, 5.773087227088915, 36.65824405011558, 16.977147202618717, 9.034103711321547, 24.10068393641093, 9.611993654759507, 37.43730581471253, 34.357838497849606, 14.7768905260407, 18.38099518082338, 8.82437707709845, 9.323155299483261, 25.690254789127223, 27.405035324196323, 29.55238524299392, 2.8259061873006566, 1.744590635456114, 35.20069034768582, 15.287980473456084, 35.14017059855992, 19.302093717393635, 21.50117959519409, -9.571878279005922, 14.682788514978558, 29.922063839325247, 49.1621181340282, 26.068430750249966, 16.893131300368886, 12.571478109537443, 27.8754029049639, 22.287604117929828, 5.653347067554163, -8.852189115821389, 19.109208397139312, -6.174095607661192, -3.817249932478072, 31.809988006655843, 32.467369596997834, 7.362491755949889, 30.103416374194346, 10.75186611573566, 46.058098517276335, -7.808385828203143, 14.552575986291933, 9.817741038104721, 2.125518084790194, 6.953629315342203, 21.45076732912439, -8.614217641817895, -0.5406455064221838, 32.16118681554922, 18.683196253019467, 5.087035478485159, 6.482038864104009, 3.438023590782146, -1.8013606886594218, 20.10517655971852, 18.618688081395465, 21.047746719741653, 15.889702525920086, 22.828395985749303, 37.71817933227109, 29.29628366289813, -8.530665182182727, 9.552480709193897, 27.978796248542835, 43.22514205785998, 23.451061294446006, 3.6319947451766463, -3.3287110418573236, 12.712272567664511, -5.224750385609029, 33.58660113275266, 8.131554403856473, 24.17418823119908, 12.076214545629568, 14.365748696810023, 16.04649575177571, 44.08597435054251, 17.385266228223824, 24.768502704236404, 2.2601113201804885, 14.95806581685027, 28.105481230031693, 1.0246363536582521, 13.881519733547751, 30.08528826541696, 7.7909711438279405, 30.16815890572054, 34.7873854401952, 17.28399945140047, 32.13164423460107, -1.8440523709909424, 11.50573005493312, 31.179612037985002, 33.30592153816895, 23.853307404636386]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.546234542486776, "mean_inference_ms": 1.9254670687919875, "mean_action_processing_ms": 0.23061339954743648, "mean_env_wait_ms": 0.14599590660097092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007242798805236816, "StateBufferConnector_ms": 0.004056215286254883, "ViewRequirementAgentConnector_ms": 0.10501480102539062}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 433.04186947578347, "num_env_steps_trained_throughput_per_sec": 433.04186947578347, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 10265.437, "restore_workers_time_ms": 0.023, "training_step_time_ms": 10264.922, "sample_time_ms": 1592.085, "learn_time_ms": 8629.913, "learn_throughput": 463.504, "synch_weights_time_ms": 38.57}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "training_iteration": 65, "trial_id": "1f352_00000", "date": "2024-08-11_15-05-37", "timestamp": 1723403137, "time_this_iter_s": 9.257561683654785, "time_total_s": 650.1122183799744, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b18a6820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 650.1122183799744, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 53.61538461538461, "ram_util_percent": 82.5076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.361553488858044, "cur_kl_coeff": 3.662109374999999e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2082914974540473, "policy_loss": -0.0022123571558040566, "vf_loss": 2.2105037154008946, "vf_explained_var": 0.9361806644126773, "kl": 0.0033932980683153537, "entropy": 0.41982307881116865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.474238515583177, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1338848798225323, "policy_loss": -0.007327875112726663, "vf_loss": 2.140683936451872, "vf_explained_var": 0.9424367481842637, "kl": 0.014101748348060368, "entropy": 0.651532485956947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.1621181340282, "predator_policy": -10.33011786105457}, "policy_reward_max": {"prey_policy": 10.33011786105457, "predator_policy": 49.1621181340282}, "policy_reward_mean": {"prey_policy": -16.127939207223786, "predator_policy": 16.127939207223786}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.8259061873006566, -1.744590635456114, -35.20069034768582, -15.287980473456084, -35.14017059855992, -19.302093717393635, -21.50117959519409, 9.571878279005922, -14.682788514978558, -29.922063839325247, -49.1621181340282, -26.068430750249966, -16.893131300368886, -12.571478109537443, -27.8754029049639, -22.287604117929828, -5.653347067554163, 8.852189115821389, -19.109208397139312, 6.174095607661192, 3.817249932478072, -31.809988006655843, -32.467369596997834, -7.362491755949889, -30.103416374194346, -10.75186611573566, -46.058098517276335, 7.808385828203143, -14.552575986291933, -9.817741038104721, -2.125518084790194, -6.953629315342203, -21.45076732912439, 8.614217641817895, 0.5406455064221838, -32.16118681554922, -18.683196253019467, -5.087035478485159, -6.482038864104009, -3.438023590782146, 1.8013606886594218, -20.10517655971852, -18.618688081395465, -21.047746719741653, -15.889702525920086, -22.828395985749303, -37.71817933227109, -29.29628366289813, 8.530665182182727, -9.552480709193897, -27.978796248542835, -43.22514205785998, -23.451061294446006, -3.6319947451766463, 3.3287110418573236, -12.712272567664511, 5.224750385609029, -33.58660113275266, -8.131554403856473, -24.17418823119908, -12.076214545629568, -14.365748696810023, -16.04649575177571, -44.08597435054251, -17.385266228223824, -24.768502704236404, -2.2601113201804885, -14.95806581685027, -28.105481230031693, -1.0246363536582521, -13.881519733547751, -30.08528826541696, -7.7909711438279405, -30.16815890572054, -34.7873854401952, -17.28399945140047, -32.13164423460107, 1.8440523709909424, -11.50573005493312, -31.179612037985002, -33.30592153816895, -23.853307404636386, -22.179588217151107, -34.90356761438719, -1.2778422010840362, -26.864154648176687, -23.37366093247276, -14.171848301291536, -8.837786275737638, -13.86906586556002, -41.43457556758523, -10.672538197425554, -14.835352875341059, 10.33011786105457, -1.6775966454155884, -13.05454570249697, -1.3237374216208684, -5.894431796777445, -5.692838031214244, -21.637682590120953], "policy_predator_policy_reward": [2.8259061873006566, 1.744590635456114, 35.20069034768582, 15.287980473456084, 35.14017059855992, 19.302093717393635, 21.50117959519409, -9.571878279005922, 14.682788514978558, 29.922063839325247, 49.1621181340282, 26.068430750249966, 16.893131300368886, 12.571478109537443, 27.8754029049639, 22.287604117929828, 5.653347067554163, -8.852189115821389, 19.109208397139312, -6.174095607661192, -3.817249932478072, 31.809988006655843, 32.467369596997834, 7.362491755949889, 30.103416374194346, 10.75186611573566, 46.058098517276335, -7.808385828203143, 14.552575986291933, 9.817741038104721, 2.125518084790194, 6.953629315342203, 21.45076732912439, -8.614217641817895, -0.5406455064221838, 32.16118681554922, 18.683196253019467, 5.087035478485159, 6.482038864104009, 3.438023590782146, -1.8013606886594218, 20.10517655971852, 18.618688081395465, 21.047746719741653, 15.889702525920086, 22.828395985749303, 37.71817933227109, 29.29628366289813, -8.530665182182727, 9.552480709193897, 27.978796248542835, 43.22514205785998, 23.451061294446006, 3.6319947451766463, -3.3287110418573236, 12.712272567664511, -5.224750385609029, 33.58660113275266, 8.131554403856473, 24.17418823119908, 12.076214545629568, 14.365748696810023, 16.04649575177571, 44.08597435054251, 17.385266228223824, 24.768502704236404, 2.2601113201804885, 14.95806581685027, 28.105481230031693, 1.0246363536582521, 13.881519733547751, 30.08528826541696, 7.7909711438279405, 30.16815890572054, 34.7873854401952, 17.28399945140047, 32.13164423460107, -1.8440523709909424, 11.50573005493312, 31.179612037985002, 33.30592153816895, 23.853307404636386, 22.179588217151107, 34.90356761438719, 1.2778422010840362, 26.864154648176687, 23.37366093247276, 14.171848301291536, 8.837786275737638, 13.86906586556002, 41.43457556758523, 10.672538197425554, 14.835352875341059, -10.33011786105457, 1.6775966454155884, 13.05454570249697, 1.3237374216208684, 5.894431796777445, 5.692838031214244, 21.637682590120953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.54682386012381, "mean_inference_ms": 1.9285386094280306, "mean_action_processing_ms": 0.23107387131332202, "mean_env_wait_ms": 0.14613917548756697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065146684646606445, "StateBufferConnector_ms": 0.004150986671447754, "ViewRequirementAgentConnector_ms": 0.11773109436035156}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.77688105745636, "num_env_steps_trained_throughput_per_sec": 435.77688105745636, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 10179.458, "restore_workers_time_ms": 0.023, "training_step_time_ms": 10178.895, "sample_time_ms": 1621.551, "learn_time_ms": 8510.5, "learn_throughput": 470.008, "synch_weights_time_ms": 42.35}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 66, "trial_id": "1f352_00000", "date": "2024-08-11_15-05-46", "timestamp": 1723403146, "time_this_iter_s": 9.242617130279541, "time_total_s": 659.3548355102539, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b18a6d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 659.3548355102539, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 53.876923076923084, "ram_util_percent": 82.46153846153847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3717236505821346, "cur_kl_coeff": 1.8310546874999996e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7861721326907476, "policy_loss": -0.0029956961060330894, "vf_loss": 1.7891677434245745, "vf_explained_var": 0.964501347579062, "kl": 0.004444172981440294, "entropy": 0.40530401139209665, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.504968297171096, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8028423298771183, "policy_loss": -0.0031579105627315583, "vf_loss": 1.8057482145105799, "vf_explained_var": 0.9648321997374296, "kl": 0.006720769031853783, "entropy": 0.6620349913214644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.66143234561956, "predator_policy": -11.587921643510867}, "policy_reward_max": {"prey_policy": 11.587921643510867, "predator_policy": 46.66143234561956}, "policy_reward_mean": {"prey_policy": -16.603467831963417, "predator_policy": 16.603467831963417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-32.467369596997834, -7.362491755949889, -30.103416374194346, -10.75186611573566, -46.058098517276335, 7.808385828203143, -14.552575986291933, -9.817741038104721, -2.125518084790194, -6.953629315342203, -21.45076732912439, 8.614217641817895, 0.5406455064221838, -32.16118681554922, -18.683196253019467, -5.087035478485159, -6.482038864104009, -3.438023590782146, 1.8013606886594218, -20.10517655971852, -18.618688081395465, -21.047746719741653, -15.889702525920086, -22.828395985749303, -37.71817933227109, -29.29628366289813, 8.530665182182727, -9.552480709193897, -27.978796248542835, -43.22514205785998, -23.451061294446006, -3.6319947451766463, 3.3287110418573236, -12.712272567664511, 5.224750385609029, -33.58660113275266, -8.131554403856473, -24.17418823119908, -12.076214545629568, -14.365748696810023, -16.04649575177571, -44.08597435054251, -17.385266228223824, -24.768502704236404, -2.2601113201804885, -14.95806581685027, -28.105481230031693, -1.0246363536582521, -13.881519733547751, -30.08528826541696, -7.7909711438279405, -30.16815890572054, -34.7873854401952, -17.28399945140047, -32.13164423460107, 1.8440523709909424, -11.50573005493312, -31.179612037985002, -33.30592153816895, -23.853307404636386, -22.179588217151107, -34.90356761438719, -1.2778422010840362, -26.864154648176687, -23.37366093247276, -14.171848301291536, -8.837786275737638, -13.86906586556002, -41.43457556758523, -10.672538197425554, -14.835352875341059, 10.33011786105457, -1.6775966454155884, -13.05454570249697, -1.3237374216208684, -5.894431796777445, -5.692838031214244, -21.637682590120953, 6.863456799850373, -30.644977248814307, 1.749775777785917, -19.258814787986715, -27.953137775557614, -17.282071666886264, 11.587921643510867, -10.567093321844485, -34.277045786669284, -32.491222059118506, -16.782549353959872, -46.66143234561956, -31.16680329838385, -39.49938759972399, -5.721061751464181, -4.696066464722801, 1.6304194143086566, -12.675480300629124, -37.51911710483318, -31.85205530804399, -9.08519901015701, -19.873680687814776], "policy_predator_policy_reward": [32.467369596997834, 7.362491755949889, 30.103416374194346, 10.75186611573566, 46.058098517276335, -7.808385828203143, 14.552575986291933, 9.817741038104721, 2.125518084790194, 6.953629315342203, 21.45076732912439, -8.614217641817895, -0.5406455064221838, 32.16118681554922, 18.683196253019467, 5.087035478485159, 6.482038864104009, 3.438023590782146, -1.8013606886594218, 20.10517655971852, 18.618688081395465, 21.047746719741653, 15.889702525920086, 22.828395985749303, 37.71817933227109, 29.29628366289813, -8.530665182182727, 9.552480709193897, 27.978796248542835, 43.22514205785998, 23.451061294446006, 3.6319947451766463, -3.3287110418573236, 12.712272567664511, -5.224750385609029, 33.58660113275266, 8.131554403856473, 24.17418823119908, 12.076214545629568, 14.365748696810023, 16.04649575177571, 44.08597435054251, 17.385266228223824, 24.768502704236404, 2.2601113201804885, 14.95806581685027, 28.105481230031693, 1.0246363536582521, 13.881519733547751, 30.08528826541696, 7.7909711438279405, 30.16815890572054, 34.7873854401952, 17.28399945140047, 32.13164423460107, -1.8440523709909424, 11.50573005493312, 31.179612037985002, 33.30592153816895, 23.853307404636386, 22.179588217151107, 34.90356761438719, 1.2778422010840362, 26.864154648176687, 23.37366093247276, 14.171848301291536, 8.837786275737638, 13.86906586556002, 41.43457556758523, 10.672538197425554, 14.835352875341059, -10.33011786105457, 1.6775966454155884, 13.05454570249697, 1.3237374216208684, 5.894431796777445, 5.692838031214244, 21.637682590120953, -6.863456799850373, 30.644977248814307, -1.749775777785917, 19.258814787986715, 27.953137775557614, 17.282071666886264, -11.587921643510867, 10.567093321844485, 34.277045786669284, 32.491222059118506, 16.782549353959872, 46.66143234561956, 31.16680329838385, 39.49938759972399, 5.721061751464181, 4.696066464722801, -1.6304194143086566, 12.675480300629124, 37.51911710483318, 31.85205530804399, 9.08519901015701, 19.873680687814776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5493828501959139, "mean_inference_ms": 1.9360992204174006, "mean_action_processing_ms": 0.2321515857053312, "mean_env_wait_ms": 0.14661847445364012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050203800201416016, "StateBufferConnector_ms": 0.0036399364471435547, "ViewRequirementAgentConnector_ms": 0.09937727451324463}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 408.91660212202976, "num_env_steps_trained_throughput_per_sec": 408.91660212202976, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 536000, "timers": {"training_iteration_time_ms": 10174.544, "restore_workers_time_ms": 0.025, "training_step_time_ms": 10173.979, "sample_time_ms": 1705.816, "learn_time_ms": 8422.047, "learn_throughput": 474.944, "synch_weights_time_ms": 41.631}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "done": false, "training_iteration": 67, "trial_id": "1f352_00000", "date": "2024-08-11_15-05-56", "timestamp": 1723403156, "time_this_iter_s": 9.859385967254639, "time_total_s": 669.2142214775085, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af490af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 669.2142214775085, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 57.66428571428572, "ram_util_percent": 83.07142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3674915955091516, "cur_kl_coeff": 9.155273437499998e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8511287465070685, "policy_loss": -0.003089494173521719, "vf_loss": 1.8542182152469953, "vf_explained_var": 0.9570900701607267, "kl": 0.005995935333813399, "entropy": 0.3883176941735049, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.407702882277469, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8364893352612852, "policy_loss": -0.0036771427240940586, "vf_loss": 1.8398103887215256, "vf_explained_var": 0.9587484102075299, "kl": 0.009495700887092168, "entropy": 0.6337830783178409, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.66143234561956, "predator_policy": -11.587921643510867}, "policy_reward_max": {"prey_policy": 11.587921643510867, "predator_policy": 46.66143234561956}, "policy_reward_mean": {"prey_policy": -17.72266903486968, "predator_policy": 17.72266903486968}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.8013606886594218, -20.10517655971852, -18.618688081395465, -21.047746719741653, -15.889702525920086, -22.828395985749303, -37.71817933227109, -29.29628366289813, 8.530665182182727, -9.552480709193897, -27.978796248542835, -43.22514205785998, -23.451061294446006, -3.6319947451766463, 3.3287110418573236, -12.712272567664511, 5.224750385609029, -33.58660113275266, -8.131554403856473, -24.17418823119908, -12.076214545629568, -14.365748696810023, -16.04649575177571, -44.08597435054251, -17.385266228223824, -24.768502704236404, -2.2601113201804885, -14.95806581685027, -28.105481230031693, -1.0246363536582521, -13.881519733547751, -30.08528826541696, -7.7909711438279405, -30.16815890572054, -34.7873854401952, -17.28399945140047, -32.13164423460107, 1.8440523709909424, -11.50573005493312, -31.179612037985002, -33.30592153816895, -23.853307404636386, -22.179588217151107, -34.90356761438719, -1.2778422010840362, -26.864154648176687, -23.37366093247276, -14.171848301291536, -8.837786275737638, -13.86906586556002, -41.43457556758523, -10.672538197425554, -14.835352875341059, 10.33011786105457, -1.6775966454155884, -13.05454570249697, -1.3237374216208684, -5.894431796777445, -5.692838031214244, -21.637682590120953, 6.863456799850373, -30.644977248814307, 1.749775777785917, -19.258814787986715, -27.953137775557614, -17.282071666886264, 11.587921643510867, -10.567093321844485, -34.277045786669284, -32.491222059118506, -16.782549353959872, -46.66143234561956, -31.16680329838385, -39.49938759972399, -5.721061751464181, -4.696066464722801, 1.6304194143086566, -12.675480300629124, -37.51911710483318, -31.85205530804399, -9.08519901015701, -19.873680687814776, -1.483187261919154, -13.276767301622568, -26.596413505979235, -38.793768865874185, -30.06414485568908, 0.0348156910493671, -30.913527467846166, -31.347084706886513, -22.93389354957052, -17.579555067910167, -14.47519434032445, -10.155601719860861, -18.247119973664663, -9.513870666420479, -33.067745376188796, 0.892145227721624, -4.0353305377192275, -40.895582151225575], "policy_predator_policy_reward": [-1.8013606886594218, 20.10517655971852, 18.618688081395465, 21.047746719741653, 15.889702525920086, 22.828395985749303, 37.71817933227109, 29.29628366289813, -8.530665182182727, 9.552480709193897, 27.978796248542835, 43.22514205785998, 23.451061294446006, 3.6319947451766463, -3.3287110418573236, 12.712272567664511, -5.224750385609029, 33.58660113275266, 8.131554403856473, 24.17418823119908, 12.076214545629568, 14.365748696810023, 16.04649575177571, 44.08597435054251, 17.385266228223824, 24.768502704236404, 2.2601113201804885, 14.95806581685027, 28.105481230031693, 1.0246363536582521, 13.881519733547751, 30.08528826541696, 7.7909711438279405, 30.16815890572054, 34.7873854401952, 17.28399945140047, 32.13164423460107, -1.8440523709909424, 11.50573005493312, 31.179612037985002, 33.30592153816895, 23.853307404636386, 22.179588217151107, 34.90356761438719, 1.2778422010840362, 26.864154648176687, 23.37366093247276, 14.171848301291536, 8.837786275737638, 13.86906586556002, 41.43457556758523, 10.672538197425554, 14.835352875341059, -10.33011786105457, 1.6775966454155884, 13.05454570249697, 1.3237374216208684, 5.894431796777445, 5.692838031214244, 21.637682590120953, -6.863456799850373, 30.644977248814307, -1.749775777785917, 19.258814787986715, 27.953137775557614, 17.282071666886264, -11.587921643510867, 10.567093321844485, 34.277045786669284, 32.491222059118506, 16.782549353959872, 46.66143234561956, 31.16680329838385, 39.49938759972399, 5.721061751464181, 4.696066464722801, -1.6304194143086566, 12.675480300629124, 37.51911710483318, 31.85205530804399, 9.08519901015701, 19.873680687814776, 1.483187261919154, 13.276767301622568, 26.596413505979235, 38.793768865874185, 30.06414485568908, -0.0348156910493671, 30.913527467846166, 31.347084706886513, 22.93389354957052, 17.579555067910167, 14.47519434032445, 10.155601719860861, 18.247119973664663, 9.513870666420479, 33.067745376188796, -0.892145227721624, 4.0353305377192275, 40.895582151225575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5461114327498864, "mean_inference_ms": 1.925591033518203, "mean_action_processing_ms": 0.23050108912667716, "mean_env_wait_ms": 0.14578195299372296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037086009979248047, "StateBufferConnector_ms": 0.0027245283126831055, "ViewRequirementAgentConnector_ms": 0.09185528755187988}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 456.9741634378091, "num_env_steps_trained_throughput_per_sec": 456.9741634378091, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 10094.144, "restore_workers_time_ms": 0.024, "training_step_time_ms": 10093.615, "sample_time_ms": 1688.822, "learn_time_ms": 8356.998, "learn_throughput": 478.641, "synch_weights_time_ms": 43.417}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 68, "trial_id": "1f352_00000", "date": "2024-08-11_15-06-05", "timestamp": 1723403165, "time_this_iter_s": 8.814170122146606, "time_total_s": 678.0283915996552, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b187b670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 678.0283915996552, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 49.876923076923084, "ram_util_percent": 83.16153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.409687097556889, "cur_kl_coeff": 9.155273437499998e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.22857402972877, "policy_loss": -0.002429329527755423, "vf_loss": 2.2310033526892465, "vf_explained_var": 0.9583307079970836, "kl": 0.002957983777534819, "entropy": 0.4422363411014279, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5816277354955672, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2147576733492316, "policy_loss": -0.003916833758315382, "vf_loss": 2.2185239613056185, "vf_explained_var": 0.9588637337709467, "kl": 0.004014607175259936, "entropy": 0.6664323677619298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.20154488598328, "predator_policy": -13.998802234425373}, "policy_reward_max": {"prey_policy": 13.998802234425373, "predator_policy": 54.20154488598328}, "policy_reward_mean": {"prey_policy": -18.391316625321412, "predator_policy": 18.391316625321412}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-44.08597435054251, -17.385266228223824, -24.768502704236404, -2.2601113201804885, -14.95806581685027, -28.105481230031693, -1.0246363536582521, -13.881519733547751, -30.08528826541696, -7.7909711438279405, -30.16815890572054, -34.7873854401952, -17.28399945140047, -32.13164423460107, 1.8440523709909424, -11.50573005493312, -31.179612037985002, -33.30592153816895, -23.853307404636386, -22.179588217151107, -34.90356761438719, -1.2778422010840362, -26.864154648176687, -23.37366093247276, -14.171848301291536, -8.837786275737638, -13.86906586556002, -41.43457556758523, -10.672538197425554, -14.835352875341059, 10.33011786105457, -1.6775966454155884, -13.05454570249697, -1.3237374216208684, -5.894431796777445, -5.692838031214244, -21.637682590120953, 6.863456799850373, -30.644977248814307, 1.749775777785917, -19.258814787986715, -27.953137775557614, -17.282071666886264, 11.587921643510867, -10.567093321844485, -34.277045786669284, -32.491222059118506, -16.782549353959872, -46.66143234561956, -31.16680329838385, -39.49938759972399, -5.721061751464181, -4.696066464722801, 1.6304194143086566, -12.675480300629124, -37.51911710483318, -31.85205530804399, -9.08519901015701, -19.873680687814776, -1.483187261919154, -13.276767301622568, -26.596413505979235, -38.793768865874185, -30.06414485568908, 0.0348156910493671, -30.913527467846166, -31.347084706886513, -22.93389354957052, -17.579555067910167, -14.47519434032445, -10.155601719860861, -18.247119973664663, -9.513870666420479, -33.067745376188796, 0.892145227721624, -4.0353305377192275, -40.895582151225575, -11.47133269480213, -16.96047215391087, -6.05130414553464, -1.9057259922153236, -17.442446247480447, -21.69654457664405, -38.45080119405077, -12.716026450919195, -19.737107204662404, -40.49787062755708, -28.897359422114164, 13.998802234425373, -11.636301176494747, -19.80496901685048, -20.9529556357608, -20.19417488015842, -40.20509112840587, -5.50200141308061, -13.606962855363621, -23.87229015259668, -24.56695099456754, -6.044564384738784, -54.20154488598328], "policy_predator_policy_reward": [44.08597435054251, 17.385266228223824, 24.768502704236404, 2.2601113201804885, 14.95806581685027, 28.105481230031693, 1.0246363536582521, 13.881519733547751, 30.08528826541696, 7.7909711438279405, 30.16815890572054, 34.7873854401952, 17.28399945140047, 32.13164423460107, -1.8440523709909424, 11.50573005493312, 31.179612037985002, 33.30592153816895, 23.853307404636386, 22.179588217151107, 34.90356761438719, 1.2778422010840362, 26.864154648176687, 23.37366093247276, 14.171848301291536, 8.837786275737638, 13.86906586556002, 41.43457556758523, 10.672538197425554, 14.835352875341059, -10.33011786105457, 1.6775966454155884, 13.05454570249697, 1.3237374216208684, 5.894431796777445, 5.692838031214244, 21.637682590120953, -6.863456799850373, 30.644977248814307, -1.749775777785917, 19.258814787986715, 27.953137775557614, 17.282071666886264, -11.587921643510867, 10.567093321844485, 34.277045786669284, 32.491222059118506, 16.782549353959872, 46.66143234561956, 31.16680329838385, 39.49938759972399, 5.721061751464181, 4.696066464722801, -1.6304194143086566, 12.675480300629124, 37.51911710483318, 31.85205530804399, 9.08519901015701, 19.873680687814776, 1.483187261919154, 13.276767301622568, 26.596413505979235, 38.793768865874185, 30.06414485568908, -0.0348156910493671, 30.913527467846166, 31.347084706886513, 22.93389354957052, 17.579555067910167, 14.47519434032445, 10.155601719860861, 18.247119973664663, 9.513870666420479, 33.067745376188796, -0.892145227721624, 4.0353305377192275, 40.895582151225575, 11.47133269480213, 16.96047215391087, 6.05130414553464, 1.9057259922153236, 17.442446247480447, 21.69654457664405, 38.45080119405077, 12.716026450919195, 19.737107204662404, 40.49787062755708, 28.897359422114164, -13.998802234425373, 11.636301176494747, 19.80496901685048, 20.9529556357608, 20.19417488015842, 40.20509112840587, 5.50200141308061, 13.606962855363621, 23.87229015259668, 24.56695099456754, 6.044564384738784, 54.20154488598328]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5454682709494981, "mean_inference_ms": 1.9231404531329803, "mean_action_processing_ms": 0.23009108644578746, "mean_env_wait_ms": 0.14557686376767134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004275321960449219, "StateBufferConnector_ms": 0.0033015012741088867, "ViewRequirementAgentConnector_ms": 0.09890496730804443}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 418.90389017303875, "num_env_steps_trained_throughput_per_sec": 418.90389017303875, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 10114.916, "restore_workers_time_ms": 0.024, "training_step_time_ms": 10114.422, "sample_time_ms": 1744.614, "learn_time_ms": 8324.055, "learn_throughput": 480.535, "synch_weights_time_ms": 41.915}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "training_iteration": 69, "trial_id": "1f352_00000", "date": "2024-08-11_15-06-15", "timestamp": 1723403175, "time_this_iter_s": 9.624608039855957, "time_total_s": 687.6529996395111, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b18909d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 687.6529996395111, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 56.20000000000001, "ram_util_percent": 83.10714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8570792241642873, "cur_kl_coeff": 4.577636718749999e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5185405322661003, "policy_loss": -0.004703798201323176, "vf_loss": 2.523244326437513, "vf_explained_var": 0.9383446490392089, "kl": 0.00593915577849932, "entropy": 0.40779525684192774, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8883349273353813, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.504244722550114, "policy_loss": -0.0036284828318457587, "vf_loss": 2.5077520611385506, "vf_explained_var": 0.9388555324325959, "kl": 0.006460771319968141, "entropy": 0.6780896798397104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.20154488598328, "predator_policy": -13.998802234425373}, "policy_reward_max": {"prey_policy": 13.998802234425373, "predator_policy": 54.20154488598328}, "policy_reward_mean": {"prey_policy": -17.161003969746265, "predator_policy": 17.161003969746265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-23.853307404636386, -22.179588217151107, -34.90356761438719, -1.2778422010840362, -26.864154648176687, -23.37366093247276, -14.171848301291536, -8.837786275737638, -13.86906586556002, -41.43457556758523, -10.672538197425554, -14.835352875341059, 10.33011786105457, -1.6775966454155884, -13.05454570249697, -1.3237374216208684, -5.894431796777445, -5.692838031214244, -21.637682590120953, 6.863456799850373, -30.644977248814307, 1.749775777785917, -19.258814787986715, -27.953137775557614, -17.282071666886264, 11.587921643510867, -10.567093321844485, -34.277045786669284, -32.491222059118506, -16.782549353959872, -46.66143234561956, -31.16680329838385, -39.49938759972399, -5.721061751464181, -4.696066464722801, 1.6304194143086566, -12.675480300629124, -37.51911710483318, -31.85205530804399, -9.08519901015701, -19.873680687814776, -1.483187261919154, -13.276767301622568, -26.596413505979235, -38.793768865874185, -30.06414485568908, 0.0348156910493671, -30.913527467846166, -31.347084706886513, -22.93389354957052, -17.579555067910167, -14.47519434032445, -10.155601719860861, -18.247119973664663, -9.513870666420479, -33.067745376188796, 0.892145227721624, -4.0353305377192275, -40.895582151225575, -11.47133269480213, -16.96047215391087, -6.05130414553464, -1.9057259922153236, -17.442446247480447, -21.69654457664405, -38.45080119405077, -12.716026450919195, -19.737107204662404, -40.49787062755708, -28.897359422114164, 13.998802234425373, -11.636301176494747, -19.80496901685048, -20.9529556357608, -20.19417488015842, -40.20509112840587, -5.50200141308061, -13.606962855363621, -23.87229015259668, -24.56695099456754, -6.044564384738784, -54.20154488598328, 4.740969823923639, -5.842041132772744, 6.889920996777466, -34.019604257167934, 0.822647511483261, -25.958277147848182, -29.731661166049424, -7.267456427041214, -12.975579623255484, -22.350246289463477, -18.69728530044435, -22.851532418677, -27.609139850211978, -1.8388644256724982, -32.11854587596939, 13.65714606418699, -28.022401189859735, -6.661000172953084], "policy_predator_policy_reward": [23.853307404636386, 22.179588217151107, 34.90356761438719, 1.2778422010840362, 26.864154648176687, 23.37366093247276, 14.171848301291536, 8.837786275737638, 13.86906586556002, 41.43457556758523, 10.672538197425554, 14.835352875341059, -10.33011786105457, 1.6775966454155884, 13.05454570249697, 1.3237374216208684, 5.894431796777445, 5.692838031214244, 21.637682590120953, -6.863456799850373, 30.644977248814307, -1.749775777785917, 19.258814787986715, 27.953137775557614, 17.282071666886264, -11.587921643510867, 10.567093321844485, 34.277045786669284, 32.491222059118506, 16.782549353959872, 46.66143234561956, 31.16680329838385, 39.49938759972399, 5.721061751464181, 4.696066464722801, -1.6304194143086566, 12.675480300629124, 37.51911710483318, 31.85205530804399, 9.08519901015701, 19.873680687814776, 1.483187261919154, 13.276767301622568, 26.596413505979235, 38.793768865874185, 30.06414485568908, -0.0348156910493671, 30.913527467846166, 31.347084706886513, 22.93389354957052, 17.579555067910167, 14.47519434032445, 10.155601719860861, 18.247119973664663, 9.513870666420479, 33.067745376188796, -0.892145227721624, 4.0353305377192275, 40.895582151225575, 11.47133269480213, 16.96047215391087, 6.05130414553464, 1.9057259922153236, 17.442446247480447, 21.69654457664405, 38.45080119405077, 12.716026450919195, 19.737107204662404, 40.49787062755708, 28.897359422114164, -13.998802234425373, 11.636301176494747, 19.80496901685048, 20.9529556357608, 20.19417488015842, 40.20509112840587, 5.50200141308061, 13.606962855363621, 23.87229015259668, 24.56695099456754, 6.044564384738784, 54.20154488598328, -4.740969823923639, 5.842041132772744, -6.889920996777466, 34.019604257167934, -0.822647511483261, 25.958277147848182, 29.731661166049424, 7.267456427041214, 12.975579623255484, 22.350246289463477, 18.69728530044435, 22.851532418677, 27.609139850211978, 1.8388644256724982, 32.11854587596939, -13.65714606418699, 28.022401189859735, 6.661000172953084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5454108964845666, "mean_inference_ms": 1.9225472453598287, "mean_action_processing_ms": 0.22998506217064207, "mean_env_wait_ms": 0.14554406947774065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004732966423034668, "StateBufferConnector_ms": 0.0033878087997436523, "ViewRequirementAgentConnector_ms": 0.1062772274017334}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 436.7391021564565, "num_env_steps_trained_throughput_per_sec": 436.7391021564565, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 9790.275, "restore_workers_time_ms": 0.023, "training_step_time_ms": 9789.746, "sample_time_ms": 1499.871, "learn_time_ms": 8243.253, "learn_throughput": 485.245, "synch_weights_time_ms": 42.625}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 70, "trial_id": "1f352_00000", "date": "2024-08-11_15-06-24", "timestamp": 1723403184, "time_this_iter_s": 9.19793176651001, "time_total_s": 696.8509314060211, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a16a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 696.8509314060211, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 52.99999999999999, "ram_util_percent": 83.14615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6187688001121083, "cur_kl_coeff": 4.577636718749999e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0249090949694315, "policy_loss": -0.0026097920856652007, "vf_loss": 2.027518884713451, "vf_explained_var": 0.9610859472304583, "kl": 0.005936857817749589, "entropy": 0.39917570501565935, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5012467188760636, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0090533306201297, "policy_loss": -0.008482799427777838, "vf_loss": 2.0173001517852147, "vf_explained_var": 0.9628609344984095, "kl": 0.012585694804548941, "entropy": 0.6873497742538651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.20154488598328, "predator_policy": -13.998802234425373}, "policy_reward_max": {"prey_policy": 13.998802234425373, "predator_policy": 54.20154488598328}, "policy_reward_mean": {"prey_policy": -16.9793239113306, "predator_policy": 16.9793239113306}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-21.637682590120953, 6.863456799850373, -30.644977248814307, 1.749775777785917, -19.258814787986715, -27.953137775557614, -17.282071666886264, 11.587921643510867, -10.567093321844485, -34.277045786669284, -32.491222059118506, -16.782549353959872, -46.66143234561956, -31.16680329838385, -39.49938759972399, -5.721061751464181, -4.696066464722801, 1.6304194143086566, -12.675480300629124, -37.51911710483318, -31.85205530804399, -9.08519901015701, -19.873680687814776, -1.483187261919154, -13.276767301622568, -26.596413505979235, -38.793768865874185, -30.06414485568908, 0.0348156910493671, -30.913527467846166, -31.347084706886513, -22.93389354957052, -17.579555067910167, -14.47519434032445, -10.155601719860861, -18.247119973664663, -9.513870666420479, -33.067745376188796, 0.892145227721624, -4.0353305377192275, -40.895582151225575, -11.47133269480213, -16.96047215391087, -6.05130414553464, -1.9057259922153236, -17.442446247480447, -21.69654457664405, -38.45080119405077, -12.716026450919195, -19.737107204662404, -40.49787062755708, -28.897359422114164, 13.998802234425373, -11.636301176494747, -19.80496901685048, -20.9529556357608, -20.19417488015842, -40.20509112840587, -5.50200141308061, -13.606962855363621, -23.87229015259668, -24.56695099456754, -6.044564384738784, -54.20154488598328, 4.740969823923639, -5.842041132772744, 6.889920996777466, -34.019604257167934, 0.822647511483261, -25.958277147848182, -29.731661166049424, -7.267456427041214, -12.975579623255484, -22.350246289463477, -18.69728530044435, -22.851532418677, -27.609139850211978, -1.8388644256724982, -32.11854587596939, 13.65714606418699, -28.022401189859735, -6.661000172953084, -18.691384716523327, -21.279069094771284, -10.479229107081975, -2.2323400451870743, 2.5508249697896126, -32.13985678395514, 0.8012048425742329, -6.098359610938505, -11.725938682122022, -26.409958962986924, 8.373720543569934, -13.090409927086057, -10.77806219101867, -35.90474356883912, -32.6566236237917, -15.539241331105535, -1.9840768027643527, -8.134769903514746], "policy_predator_policy_reward": [21.637682590120953, -6.863456799850373, 30.644977248814307, -1.749775777785917, 19.258814787986715, 27.953137775557614, 17.282071666886264, -11.587921643510867, 10.567093321844485, 34.277045786669284, 32.491222059118506, 16.782549353959872, 46.66143234561956, 31.16680329838385, 39.49938759972399, 5.721061751464181, 4.696066464722801, -1.6304194143086566, 12.675480300629124, 37.51911710483318, 31.85205530804399, 9.08519901015701, 19.873680687814776, 1.483187261919154, 13.276767301622568, 26.596413505979235, 38.793768865874185, 30.06414485568908, -0.0348156910493671, 30.913527467846166, 31.347084706886513, 22.93389354957052, 17.579555067910167, 14.47519434032445, 10.155601719860861, 18.247119973664663, 9.513870666420479, 33.067745376188796, -0.892145227721624, 4.0353305377192275, 40.895582151225575, 11.47133269480213, 16.96047215391087, 6.05130414553464, 1.9057259922153236, 17.442446247480447, 21.69654457664405, 38.45080119405077, 12.716026450919195, 19.737107204662404, 40.49787062755708, 28.897359422114164, -13.998802234425373, 11.636301176494747, 19.80496901685048, 20.9529556357608, 20.19417488015842, 40.20509112840587, 5.50200141308061, 13.606962855363621, 23.87229015259668, 24.56695099456754, 6.044564384738784, 54.20154488598328, -4.740969823923639, 5.842041132772744, -6.889920996777466, 34.019604257167934, -0.822647511483261, 25.958277147848182, 29.731661166049424, 7.267456427041214, 12.975579623255484, 22.350246289463477, 18.69728530044435, 22.851532418677, 27.609139850211978, 1.8388644256724982, 32.11854587596939, -13.65714606418699, 28.022401189859735, 6.661000172953084, 18.691384716523327, 21.279069094771284, 10.479229107081975, 2.2323400451870743, -2.5508249697896126, 32.13985678395514, -0.8012048425742329, 6.098359610938505, 11.725938682122022, 26.409958962986924, -8.373720543569934, 13.090409927086057, 10.77806219101867, 35.90474356883912, 32.6566236237917, 15.539241331105535, 1.9840768027643527, 8.134769903514746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5448605204252843, "mean_inference_ms": 1.9201708506417692, "mean_action_processing_ms": 0.2297254782995485, "mean_env_wait_ms": 0.14537554210617085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004531741142272949, "StateBufferConnector_ms": 0.004166007041931152, "ViewRequirementAgentConnector_ms": 0.0970149040222168}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 444.4327534112894, "num_env_steps_trained_throughput_per_sec": 444.4327534112894, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 568000, "timers": {"training_iteration_time_ms": 9689.849, "restore_workers_time_ms": 0.021, "training_step_time_ms": 9689.595, "sample_time_ms": 1452.262, "learn_time_ms": 8202.475, "learn_throughput": 487.658, "synch_weights_time_ms": 32.808}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "done": false, "training_iteration": 71, "trial_id": "1f352_00000", "date": "2024-08-11_15-06-33", "timestamp": 1723403193, "time_this_iter_s": 9.01339602470398, "time_total_s": 705.8643274307251, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af3ce700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 705.8643274307251, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 53.076923076923066, "ram_util_percent": 83.16923076923075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5612084357688825, "cur_kl_coeff": 4.577636718749999e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2649518116066854, "policy_loss": -0.002918960733707839, "vf_loss": 2.2678707713882127, "vf_explained_var": 0.958837625508507, "kl": 0.004255047122832743, "entropy": 0.4491478315865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6495049251864353, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.235707672064503, "policy_loss": -0.009133966715065374, "vf_loss": 2.244569023326039, "vf_explained_var": 0.9595018021762372, "kl": 0.014539641195239685, "entropy": 0.6668658265843987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.20154488598328, "predator_policy": -18.438315648106894}, "policy_reward_max": {"prey_policy": 18.438315648106894, "predator_policy": 54.20154488598328}, "policy_reward_mean": {"prey_policy": -17.61127857715585, "predator_policy": 17.61127857715585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-19.873680687814776, -1.483187261919154, -13.276767301622568, -26.596413505979235, -38.793768865874185, -30.06414485568908, 0.0348156910493671, -30.913527467846166, -31.347084706886513, -22.93389354957052, -17.579555067910167, -14.47519434032445, -10.155601719860861, -18.247119973664663, -9.513870666420479, -33.067745376188796, 0.892145227721624, -4.0353305377192275, -40.895582151225575, -11.47133269480213, -16.96047215391087, -6.05130414553464, -1.9057259922153236, -17.442446247480447, -21.69654457664405, -38.45080119405077, -12.716026450919195, -19.737107204662404, -40.49787062755708, -28.897359422114164, 13.998802234425373, -11.636301176494747, -19.80496901685048, -20.9529556357608, -20.19417488015842, -40.20509112840587, -5.50200141308061, -13.606962855363621, -23.87229015259668, -24.56695099456754, -6.044564384738784, -54.20154488598328, 4.740969823923639, -5.842041132772744, 6.889920996777466, -34.019604257167934, 0.822647511483261, -25.958277147848182, -29.731661166049424, -7.267456427041214, -12.975579623255484, -22.350246289463477, -18.69728530044435, -22.851532418677, -27.609139850211978, -1.8388644256724982, -32.11854587596939, 13.65714606418699, -28.022401189859735, -6.661000172953084, -18.691384716523327, -21.279069094771284, -10.479229107081975, -2.2323400451870743, 2.5508249697896126, -32.13985678395514, 0.8012048425742329, -6.098359610938505, -11.725938682122022, -26.409958962986924, 8.373720543569934, -13.090409927086057, -10.77806219101867, -35.90474356883912, -32.6566236237917, -15.539241331105535, -1.9840768027643527, -8.134769903514746, 18.438315648106894, -18.00321759855296, -34.27664893972413, -22.33013573255139, -30.752710912862767, 7.167973754471243, -19.123699530753314, -31.145854528350686, -28.450530172484413, -45.62287704010417, -40.79756472672614, -6.38691704516353, 4.299118027644021, -15.418907516509611, -44.625805391382, -34.11908282663446, -14.957187689541197, -15.011300849638166, -24.510927065775263, -11.632703994120467, -25.83091976395315, -38.04350682699947], "policy_predator_policy_reward": [19.873680687814776, 1.483187261919154, 13.276767301622568, 26.596413505979235, 38.793768865874185, 30.06414485568908, -0.0348156910493671, 30.913527467846166, 31.347084706886513, 22.93389354957052, 17.579555067910167, 14.47519434032445, 10.155601719860861, 18.247119973664663, 9.513870666420479, 33.067745376188796, -0.892145227721624, 4.0353305377192275, 40.895582151225575, 11.47133269480213, 16.96047215391087, 6.05130414553464, 1.9057259922153236, 17.442446247480447, 21.69654457664405, 38.45080119405077, 12.716026450919195, 19.737107204662404, 40.49787062755708, 28.897359422114164, -13.998802234425373, 11.636301176494747, 19.80496901685048, 20.9529556357608, 20.19417488015842, 40.20509112840587, 5.50200141308061, 13.606962855363621, 23.87229015259668, 24.56695099456754, 6.044564384738784, 54.20154488598328, -4.740969823923639, 5.842041132772744, -6.889920996777466, 34.019604257167934, -0.822647511483261, 25.958277147848182, 29.731661166049424, 7.267456427041214, 12.975579623255484, 22.350246289463477, 18.69728530044435, 22.851532418677, 27.609139850211978, 1.8388644256724982, 32.11854587596939, -13.65714606418699, 28.022401189859735, 6.661000172953084, 18.691384716523327, 21.279069094771284, 10.479229107081975, 2.2323400451870743, -2.5508249697896126, 32.13985678395514, -0.8012048425742329, 6.098359610938505, 11.725938682122022, 26.409958962986924, -8.373720543569934, 13.090409927086057, 10.77806219101867, 35.90474356883912, 32.6566236237917, 15.539241331105535, 1.9840768027643527, 8.134769903514746, -18.438315648106894, 18.00321759855296, 34.27664893972413, 22.33013573255139, 30.752710912862767, -7.167973754471243, 19.123699530753314, 31.145854528350686, 28.450530172484413, 45.62287704010417, 40.79756472672614, 6.38691704516353, -4.299118027644021, 15.418907516509611, 44.625805391382, 34.11908282663446, 14.957187689541197, 15.011300849638166, 24.510927065775263, 11.632703994120467, 25.83091976395315, 38.04350682699947]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5438143705438649, "mean_inference_ms": 1.9162612701581667, "mean_action_processing_ms": 0.22936649878316825, "mean_env_wait_ms": 0.1452201346686673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005617976188659668, "StateBufferConnector_ms": 0.004596710205078125, "ViewRequirementAgentConnector_ms": 0.09723126888275146}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.0395815047848, "num_env_steps_trained_throughput_per_sec": 428.0395815047848, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 9269.613, "restore_workers_time_ms": 0.021, "training_step_time_ms": 9269.356, "sample_time_ms": 1344.832, "learn_time_ms": 7890.721, "learn_throughput": 506.925, "synch_weights_time_ms": 32.618}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 72, "trial_id": "1f352_00000", "date": "2024-08-11_15-06-42", "timestamp": 1723403202, "time_this_iter_s": 9.37564206123352, "time_total_s": 715.2399694919586, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af487700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 715.2399694919586, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 51.83076923076923, "ram_util_percent": 83.23076923076925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5750496020540594, "cur_kl_coeff": 2.2888183593749995e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.09107265137136, "policy_loss": -0.0028483176938607357, "vf_loss": 2.093920971080661, "vf_explained_var": 0.9632587901627024, "kl": 0.003927674173499123, "entropy": 0.40774343272981545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.45863201332589, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0772379133850336, "policy_loss": -0.0045513743258197795, "vf_loss": 2.0815992542852957, "vf_explained_var": 0.9642710680762927, "kl": 0.010135179819404618, "entropy": 0.6660163259754578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.20154488598328, "predator_policy": -18.438315648106894}, "policy_reward_max": {"prey_policy": 18.438315648106894, "predator_policy": 54.20154488598328}, "policy_reward_mean": {"prey_policy": -17.128643548884092, "predator_policy": 17.128643548884092}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.442446247480447, -21.69654457664405, -38.45080119405077, -12.716026450919195, -19.737107204662404, -40.49787062755708, -28.897359422114164, 13.998802234425373, -11.636301176494747, -19.80496901685048, -20.9529556357608, -20.19417488015842, -40.20509112840587, -5.50200141308061, -13.606962855363621, -23.87229015259668, -24.56695099456754, -6.044564384738784, -54.20154488598328, 4.740969823923639, -5.842041132772744, 6.889920996777466, -34.019604257167934, 0.822647511483261, -25.958277147848182, -29.731661166049424, -7.267456427041214, -12.975579623255484, -22.350246289463477, -18.69728530044435, -22.851532418677, -27.609139850211978, -1.8388644256724982, -32.11854587596939, 13.65714606418699, -28.022401189859735, -6.661000172953084, -18.691384716523327, -21.279069094771284, -10.479229107081975, -2.2323400451870743, 2.5508249697896126, -32.13985678395514, 0.8012048425742329, -6.098359610938505, -11.725938682122022, -26.409958962986924, 8.373720543569934, -13.090409927086057, -10.77806219101867, -35.90474356883912, -32.6566236237917, -15.539241331105535, -1.9840768027643527, -8.134769903514746, 18.438315648106894, -18.00321759855296, -34.27664893972413, -22.33013573255139, -30.752710912862767, 7.167973754471243, -19.123699530753314, -31.145854528350686, -28.450530172484413, -45.62287704010417, -40.79756472672614, -6.38691704516353, 4.299118027644021, -15.418907516509611, -44.625805391382, -34.11908282663446, -14.957187689541197, -15.011300849638166, -24.510927065775263, -11.632703994120467, -25.83091976395315, -38.04350682699947, -20.653479651635458, -14.143597769956555, -20.293643567150557, -23.158293096679184, -3.7892986631615937, -20.211341835444443, -13.568814563663963, 5.316881710973677, 8.265642141434224, -35.175448558430844, -23.690092829143914, -14.62194302498847, -26.34030926852398, -19.497940774745253, -2.620447674963339, -39.09563330433338, -47.71358048640644, 8.002133344473613, -21.420880539690174, -35.765088741596415, -11.7475936078057, 10.671504952997628, 10.80042653140801], "policy_predator_policy_reward": [17.442446247480447, 21.69654457664405, 38.45080119405077, 12.716026450919195, 19.737107204662404, 40.49787062755708, 28.897359422114164, -13.998802234425373, 11.636301176494747, 19.80496901685048, 20.9529556357608, 20.19417488015842, 40.20509112840587, 5.50200141308061, 13.606962855363621, 23.87229015259668, 24.56695099456754, 6.044564384738784, 54.20154488598328, -4.740969823923639, 5.842041132772744, -6.889920996777466, 34.019604257167934, -0.822647511483261, 25.958277147848182, 29.731661166049424, 7.267456427041214, 12.975579623255484, 22.350246289463477, 18.69728530044435, 22.851532418677, 27.609139850211978, 1.8388644256724982, 32.11854587596939, -13.65714606418699, 28.022401189859735, 6.661000172953084, 18.691384716523327, 21.279069094771284, 10.479229107081975, 2.2323400451870743, -2.5508249697896126, 32.13985678395514, -0.8012048425742329, 6.098359610938505, 11.725938682122022, 26.409958962986924, -8.373720543569934, 13.090409927086057, 10.77806219101867, 35.90474356883912, 32.6566236237917, 15.539241331105535, 1.9840768027643527, 8.134769903514746, -18.438315648106894, 18.00321759855296, 34.27664893972413, 22.33013573255139, 30.752710912862767, -7.167973754471243, 19.123699530753314, 31.145854528350686, 28.450530172484413, 45.62287704010417, 40.79756472672614, 6.38691704516353, -4.299118027644021, 15.418907516509611, 44.625805391382, 34.11908282663446, 14.957187689541197, 15.011300849638166, 24.510927065775263, 11.632703994120467, 25.83091976395315, 38.04350682699947, 20.653479651635458, 14.143597769956555, 20.293643567150557, 23.158293096679184, 3.7892986631615937, 20.211341835444443, 13.568814563663963, -5.316881710973677, -8.265642141434224, 35.175448558430844, 23.690092829143914, 14.62194302498847, 26.34030926852398, 19.497940774745253, 2.620447674963339, 39.09563330433338, 47.71358048640644, -8.002133344473613, 21.420880539690174, 35.765088741596415, 11.7475936078057, -10.671504952997628, -10.80042653140801]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5437746636714147, "mean_inference_ms": 1.9137436377080397, "mean_action_processing_ms": 0.22941929418692453, "mean_env_wait_ms": 0.14525482819003352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005637407302856445, "StateBufferConnector_ms": 0.004673361778259277, "ViewRequirementAgentConnector_ms": 0.09808921813964844}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 463.14817168974577, "num_env_steps_trained_throughput_per_sec": 463.14817168974577, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 584000, "timers": {"training_iteration_time_ms": 9212.187, "restore_workers_time_ms": 0.021, "training_step_time_ms": 9211.934, "sample_time_ms": 1326.314, "learn_time_ms": 7848.634, "learn_throughput": 509.643, "synch_weights_time_ms": 35.53}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "done": false, "training_iteration": 73, "trial_id": "1f352_00000", "date": "2024-08-11_15-06-51", "timestamp": 1723403211, "time_this_iter_s": 8.658068895339966, "time_total_s": 723.8980383872986, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a04ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 723.8980383872986, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 50.083333333333336, "ram_util_percent": 83.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6480594971527656, "cur_kl_coeff": 1.1444091796874997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.079422455281019, "policy_loss": -0.002666242391812072, "vf_loss": 2.082088702917099, "vf_explained_var": 0.9650778139010072, "kl": 0.005361699667401837, "entropy": 0.4160671668748061, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5871449537575244, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.087199511813621, "policy_loss": -0.005087413712074825, "vf_loss": 2.0921123859783015, "vf_explained_var": 0.9658455519626538, "kl": 0.00930915835960775, "entropy": 0.6698720457653204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.20154488598328, "predator_policy": -18.438315648106894}, "policy_reward_max": {"prey_policy": 18.438315648106894, "predator_policy": 54.20154488598328}, "policy_reward_mean": {"prey_policy": -17.722457855472317, "predator_policy": 17.722457855472317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-54.20154488598328, 4.740969823923639, -5.842041132772744, 6.889920996777466, -34.019604257167934, 0.822647511483261, -25.958277147848182, -29.731661166049424, -7.267456427041214, -12.975579623255484, -22.350246289463477, -18.69728530044435, -22.851532418677, -27.609139850211978, -1.8388644256724982, -32.11854587596939, 13.65714606418699, -28.022401189859735, -6.661000172953084, -18.691384716523327, -21.279069094771284, -10.479229107081975, -2.2323400451870743, 2.5508249697896126, -32.13985678395514, 0.8012048425742329, -6.098359610938505, -11.725938682122022, -26.409958962986924, 8.373720543569934, -13.090409927086057, -10.77806219101867, -35.90474356883912, -32.6566236237917, -15.539241331105535, -1.9840768027643527, -8.134769903514746, 18.438315648106894, -18.00321759855296, -34.27664893972413, -22.33013573255139, -30.752710912862767, 7.167973754471243, -19.123699530753314, -31.145854528350686, -28.450530172484413, -45.62287704010417, -40.79756472672614, -6.38691704516353, 4.299118027644021, -15.418907516509611, -44.625805391382, -34.11908282663446, -14.957187689541197, -15.011300849638166, -24.510927065775263, -11.632703994120467, -25.83091976395315, -38.04350682699947, -20.653479651635458, -14.143597769956555, -20.293643567150557, -23.158293096679184, -3.7892986631615937, -20.211341835444443, -13.568814563663963, 5.316881710973677, 8.265642141434224, -35.175448558430844, -23.690092829143914, -14.62194302498847, -26.34030926852398, -19.497940774745253, -2.620447674963339, -39.09563330433338, -47.71358048640644, 8.002133344473613, -21.420880539690174, -35.765088741596415, -11.7475936078057, 10.671504952997628, 10.80042653140801, 2.9529676831903258, -22.925038734481046, -23.478808534662235, -19.201841914318464, -32.28961353037105, -20.214509198905194, 8.600867390452684, -2.613026229887339, -17.63153739223669, -34.94051057845881, -34.67975346668595, -9.181048337660858, -40.76236815338447, -39.42651596796972, -7.321371426661048, -22.89836918639124, -44.64195745663844, -50.55461075077338], "policy_predator_policy_reward": [54.20154488598328, -4.740969823923639, 5.842041132772744, -6.889920996777466, 34.019604257167934, -0.822647511483261, 25.958277147848182, 29.731661166049424, 7.267456427041214, 12.975579623255484, 22.350246289463477, 18.69728530044435, 22.851532418677, 27.609139850211978, 1.8388644256724982, 32.11854587596939, -13.65714606418699, 28.022401189859735, 6.661000172953084, 18.691384716523327, 21.279069094771284, 10.479229107081975, 2.2323400451870743, -2.5508249697896126, 32.13985678395514, -0.8012048425742329, 6.098359610938505, 11.725938682122022, 26.409958962986924, -8.373720543569934, 13.090409927086057, 10.77806219101867, 35.90474356883912, 32.6566236237917, 15.539241331105535, 1.9840768027643527, 8.134769903514746, -18.438315648106894, 18.00321759855296, 34.27664893972413, 22.33013573255139, 30.752710912862767, -7.167973754471243, 19.123699530753314, 31.145854528350686, 28.450530172484413, 45.62287704010417, 40.79756472672614, 6.38691704516353, -4.299118027644021, 15.418907516509611, 44.625805391382, 34.11908282663446, 14.957187689541197, 15.011300849638166, 24.510927065775263, 11.632703994120467, 25.83091976395315, 38.04350682699947, 20.653479651635458, 14.143597769956555, 20.293643567150557, 23.158293096679184, 3.7892986631615937, 20.211341835444443, 13.568814563663963, -5.316881710973677, -8.265642141434224, 35.175448558430844, 23.690092829143914, 14.62194302498847, 26.34030926852398, 19.497940774745253, 2.620447674963339, 39.09563330433338, 47.71358048640644, -8.002133344473613, 21.420880539690174, 35.765088741596415, 11.7475936078057, -10.671504952997628, -10.80042653140801, -2.9529676831903258, 22.925038734481046, 23.478808534662235, 19.201841914318464, 32.28961353037105, 20.214509198905194, -8.600867390452684, 2.613026229887339, 17.63153739223669, 34.94051057845881, 34.67975346668595, 9.181048337660858, 40.76236815338447, 39.42651596796972, 7.321371426661048, 22.89836918639124, 44.64195745663844, 50.55461075077338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5417235000131408, "mean_inference_ms": 1.9079107363881418, "mean_action_processing_ms": 0.22875122317767826, "mean_env_wait_ms": 0.14473563002413306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004902839660644531, "StateBufferConnector_ms": 0.004321694374084473, "ViewRequirementAgentConnector_ms": 0.08497250080108643}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 445.33735509435405, "num_env_steps_trained_throughput_per_sec": 445.33735509435405, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 9162.282, "restore_workers_time_ms": 0.02, "training_step_time_ms": 9162.058, "sample_time_ms": 1296.637, "learn_time_ms": 7833.17, "learn_throughput": 510.649, "synch_weights_time_ms": 30.827}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 74, "trial_id": "1f352_00000", "date": "2024-08-11_15-07-00", "timestamp": 1723403220, "time_this_iter_s": 9.02858591079712, "time_total_s": 732.9266242980957, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b18a6d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 732.9266242980957, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 51.78461538461538, "ram_util_percent": 83.3076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5640363679577907, "cur_kl_coeff": 1.1444091796874997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9110345614453157, "policy_loss": -0.0019451484865082118, "vf_loss": 1.9129797081152597, "vf_explained_var": 0.9604888793081046, "kl": 0.0037129075781132904, "entropy": 0.4048543319726984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7616269873455166, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.945710037400325, "policy_loss": -0.0021125964378976886, "vf_loss": 1.9477613314986228, "vf_explained_var": 0.959828469529748, "kl": 0.0032696632393958815, "entropy": 0.6698988164464633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.55461075077338, "predator_policy": -18.438315648106894}, "policy_reward_max": {"prey_policy": 18.438315648106894, "predator_policy": 50.55461075077338}, "policy_reward_mean": {"prey_policy": -18.29609815602983, "predator_policy": 18.29609815602983}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.661000172953084, -18.691384716523327, -21.279069094771284, -10.479229107081975, -2.2323400451870743, 2.5508249697896126, -32.13985678395514, 0.8012048425742329, -6.098359610938505, -11.725938682122022, -26.409958962986924, 8.373720543569934, -13.090409927086057, -10.77806219101867, -35.90474356883912, -32.6566236237917, -15.539241331105535, -1.9840768027643527, -8.134769903514746, 18.438315648106894, -18.00321759855296, -34.27664893972413, -22.33013573255139, -30.752710912862767, 7.167973754471243, -19.123699530753314, -31.145854528350686, -28.450530172484413, -45.62287704010417, -40.79756472672614, -6.38691704516353, 4.299118027644021, -15.418907516509611, -44.625805391382, -34.11908282663446, -14.957187689541197, -15.011300849638166, -24.510927065775263, -11.632703994120467, -25.83091976395315, -38.04350682699947, -20.653479651635458, -14.143597769956555, -20.293643567150557, -23.158293096679184, -3.7892986631615937, -20.211341835444443, -13.568814563663963, 5.316881710973677, 8.265642141434224, -35.175448558430844, -23.690092829143914, -14.62194302498847, -26.34030926852398, -19.497940774745253, -2.620447674963339, -39.09563330433338, -47.71358048640644, 8.002133344473613, -21.420880539690174, -35.765088741596415, -11.7475936078057, 10.671504952997628, 10.80042653140801, 2.9529676831903258, -22.925038734481046, -23.478808534662235, -19.201841914318464, -32.28961353037105, -20.214509198905194, 8.600867390452684, -2.613026229887339, -17.63153739223669, -34.94051057845881, -34.67975346668595, -9.181048337660858, -40.76236815338447, -39.42651596796972, -7.321371426661048, -22.89836918639124, -44.64195745663844, -50.55461075077338, -14.433084488643225, -2.591274405292845, -33.33165772313811, 16.159458700290998, -34.74720353359409, -26.199220940111285, -37.380155777451236, -17.748275525815895, -41.452108202744824, -35.890589781954105, -25.206228359997358, -0.009861218208211397, -15.88829416104691, -42.63542877414871, -14.222358696007218, -14.949849396602662, -10.771075504917288, -3.4403178604141935], "policy_predator_policy_reward": [6.661000172953084, 18.691384716523327, 21.279069094771284, 10.479229107081975, 2.2323400451870743, -2.5508249697896126, 32.13985678395514, -0.8012048425742329, 6.098359610938505, 11.725938682122022, 26.409958962986924, -8.373720543569934, 13.090409927086057, 10.77806219101867, 35.90474356883912, 32.6566236237917, 15.539241331105535, 1.9840768027643527, 8.134769903514746, -18.438315648106894, 18.00321759855296, 34.27664893972413, 22.33013573255139, 30.752710912862767, -7.167973754471243, 19.123699530753314, 31.145854528350686, 28.450530172484413, 45.62287704010417, 40.79756472672614, 6.38691704516353, -4.299118027644021, 15.418907516509611, 44.625805391382, 34.11908282663446, 14.957187689541197, 15.011300849638166, 24.510927065775263, 11.632703994120467, 25.83091976395315, 38.04350682699947, 20.653479651635458, 14.143597769956555, 20.293643567150557, 23.158293096679184, 3.7892986631615937, 20.211341835444443, 13.568814563663963, -5.316881710973677, -8.265642141434224, 35.175448558430844, 23.690092829143914, 14.62194302498847, 26.34030926852398, 19.497940774745253, 2.620447674963339, 39.09563330433338, 47.71358048640644, -8.002133344473613, 21.420880539690174, 35.765088741596415, 11.7475936078057, -10.671504952997628, -10.80042653140801, -2.9529676831903258, 22.925038734481046, 23.478808534662235, 19.201841914318464, 32.28961353037105, 20.214509198905194, -8.600867390452684, 2.613026229887339, 17.63153739223669, 34.94051057845881, 34.67975346668595, 9.181048337660858, 40.76236815338447, 39.42651596796972, 7.321371426661048, 22.89836918639124, 44.64195745663844, 50.55461075077338, 14.433084488643225, 2.591274405292845, 33.33165772313811, -16.159458700290998, 34.74720353359409, 26.199220940111285, 37.380155777451236, 17.748275525815895, 41.452108202744824, 35.890589781954105, 25.206228359997358, 0.009861218208211397, 15.88829416104691, 42.63542877414871, 14.222358696007218, 14.949849396602662, 10.771075504917288, 3.4403178604141935]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5404354379481915, "mean_inference_ms": 1.9030757433814056, "mean_action_processing_ms": 0.22836812266448706, "mean_env_wait_ms": 0.14444028830603428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005023360252380371, "StateBufferConnector_ms": 0.0039861202239990234, "ViewRequirementAgentConnector_ms": 0.09964776039123535}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 457.29295324365813, "num_env_steps_trained_throughput_per_sec": 457.29295324365813, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 9113.282, "restore_workers_time_ms": 0.019, "training_step_time_ms": 9113.061, "sample_time_ms": 1304.193, "learn_time_ms": 7776.418, "learn_throughput": 514.376, "synch_weights_time_ms": 31.071}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 75, "trial_id": "1f352_00000", "date": "2024-08-11_15-07-09", "timestamp": 1723403229, "time_this_iter_s": 8.791800737380981, "time_total_s": 741.7184250354767, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af487700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 741.7184250354767, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 54.77692307692309, "ram_util_percent": 83.13846153846156}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6652024117608866, "cur_kl_coeff": 5.722045898437499e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7623437082394957, "policy_loss": -0.0007821435361014058, "vf_loss": 1.7631258480250835, "vf_explained_var": 0.9586069342369835, "kl": 0.0022027040290093208, "entropy": 0.33520899058009185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.732162776092688, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.770908993917207, "policy_loss": -0.006613459495808153, "vf_loss": 1.777451346690456, "vf_explained_var": 0.9581516632189353, "kl": 0.007584140450511009, "entropy": 0.6045303054774801, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.55461075077338, "predator_policy": -16.159458700290998}, "policy_reward_max": {"prey_policy": 16.159458700290998, "predator_policy": 50.55461075077338}, "policy_reward_mean": {"prey_policy": -18.81078310253889, "predator_policy": 18.81078310253889}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.33013573255139, -30.752710912862767, 7.167973754471243, -19.123699530753314, -31.145854528350686, -28.450530172484413, -45.62287704010417, -40.79756472672614, -6.38691704516353, 4.299118027644021, -15.418907516509611, -44.625805391382, -34.11908282663446, -14.957187689541197, -15.011300849638166, -24.510927065775263, -11.632703994120467, -25.83091976395315, -38.04350682699947, -20.653479651635458, -14.143597769956555, -20.293643567150557, -23.158293096679184, -3.7892986631615937, -20.211341835444443, -13.568814563663963, 5.316881710973677, 8.265642141434224, -35.175448558430844, -23.690092829143914, -14.62194302498847, -26.34030926852398, -19.497940774745253, -2.620447674963339, -39.09563330433338, -47.71358048640644, 8.002133344473613, -21.420880539690174, -35.765088741596415, -11.7475936078057, 10.671504952997628, 10.80042653140801, 2.9529676831903258, -22.925038734481046, -23.478808534662235, -19.201841914318464, -32.28961353037105, -20.214509198905194, 8.600867390452684, -2.613026229887339, -17.63153739223669, -34.94051057845881, -34.67975346668595, -9.181048337660858, -40.76236815338447, -39.42651596796972, -7.321371426661048, -22.89836918639124, -44.64195745663844, -50.55461075077338, -14.433084488643225, -2.591274405292845, -33.33165772313811, 16.159458700290998, -34.74720353359409, -26.199220940111285, -37.380155777451236, -17.748275525815895, -41.452108202744824, -35.890589781954105, -25.206228359997358, -0.009861218208211397, -15.88829416104691, -42.63542877414871, -14.222358696007218, -14.949849396602662, -10.771075504917288, -3.4403178604141935, -27.662641388805323, -14.878157499110099, 11.044068654964022, -1.743008419209247, -10.514204333321782, -20.497721715393865, 2.4749504445418538, -31.077209002350536, -1.9376971903079636, -12.51886579171775, -23.184786012392628, 13.348739806844307, -19.9238741954536, -3.8041096018503238, -43.75242914630457, -21.549902873246516, -41.90936874688793, 3.640549292809446, -10.094408217375069, -9.892350165335882, -30.23848983537292, -32.71844377450459], "policy_predator_policy_reward": [22.33013573255139, 30.752710912862767, -7.167973754471243, 19.123699530753314, 31.145854528350686, 28.450530172484413, 45.62287704010417, 40.79756472672614, 6.38691704516353, -4.299118027644021, 15.418907516509611, 44.625805391382, 34.11908282663446, 14.957187689541197, 15.011300849638166, 24.510927065775263, 11.632703994120467, 25.83091976395315, 38.04350682699947, 20.653479651635458, 14.143597769956555, 20.293643567150557, 23.158293096679184, 3.7892986631615937, 20.211341835444443, 13.568814563663963, -5.316881710973677, -8.265642141434224, 35.175448558430844, 23.690092829143914, 14.62194302498847, 26.34030926852398, 19.497940774745253, 2.620447674963339, 39.09563330433338, 47.71358048640644, -8.002133344473613, 21.420880539690174, 35.765088741596415, 11.7475936078057, -10.671504952997628, -10.80042653140801, -2.9529676831903258, 22.925038734481046, 23.478808534662235, 19.201841914318464, 32.28961353037105, 20.214509198905194, -8.600867390452684, 2.613026229887339, 17.63153739223669, 34.94051057845881, 34.67975346668595, 9.181048337660858, 40.76236815338447, 39.42651596796972, 7.321371426661048, 22.89836918639124, 44.64195745663844, 50.55461075077338, 14.433084488643225, 2.591274405292845, 33.33165772313811, -16.159458700290998, 34.74720353359409, 26.199220940111285, 37.380155777451236, 17.748275525815895, 41.452108202744824, 35.890589781954105, 25.206228359997358, 0.009861218208211397, 15.88829416104691, 42.63542877414871, 14.222358696007218, 14.949849396602662, 10.771075504917288, 3.4403178604141935, 27.662641388805323, 14.878157499110099, -11.044068654964022, 1.743008419209247, 10.514204333321782, 20.497721715393865, -2.4749504445418538, 31.077209002350536, 1.9376971903079636, 12.51886579171775, 23.184786012392628, -13.348739806844307, 19.9238741954536, 3.8041096018503238, 43.75242914630457, 21.549902873246516, 41.90936874688793, -3.640549292809446, 10.094408217375069, 9.892350165335882, 30.23848983537292, 32.71844377450459]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5417433017973293, "mean_inference_ms": 1.9065858899196806, "mean_action_processing_ms": 0.2292732922490282, "mean_env_wait_ms": 0.14478186762008766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490494728088379, "StateBufferConnector_ms": 0.00348818302154541, "ViewRequirementAgentConnector_ms": 0.08817493915557861}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 476.0068754969926, "num_env_steps_trained_throughput_per_sec": 476.0068754969926, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 9035.71, "restore_workers_time_ms": 0.019, "training_step_time_ms": 9035.527, "sample_time_ms": 1266.423, "learn_time_ms": 7742.678, "learn_throughput": 516.617, "synch_weights_time_ms": 25.194}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 76, "trial_id": "1f352_00000", "date": "2024-08-11_15-07-17", "timestamp": 1723403237, "time_this_iter_s": 8.442145109176636, "time_total_s": 750.1605701446533, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b188ee50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 750.1605701446533, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 49.28333333333334, "ram_util_percent": 82.84166666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.147076670949658, "cur_kl_coeff": 2.8610229492187494e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3034401627878347, "policy_loss": -0.002508265797465962, "vf_loss": 1.305948431479434, "vf_explained_var": 0.968444311246276, "kl": 0.002904885666002113, "entropy": 0.2870549650862813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.216301655272643, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3157855827361344, "policy_loss": -0.006511798520417263, "vf_loss": 1.3222276189674933, "vf_explained_var": 0.969013732423385, "kl": 0.007441625883364548, "entropy": 0.5867486006890734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.55461075077338, "predator_policy": -16.159458700290998}, "policy_reward_max": {"prey_policy": 16.159458700290998, "predator_policy": 50.55461075077338}, "policy_reward_mean": {"prey_policy": -17.400006328412434, "predator_policy": 17.400006328412434}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-38.04350682699947, -20.653479651635458, -14.143597769956555, -20.293643567150557, -23.158293096679184, -3.7892986631615937, -20.211341835444443, -13.568814563663963, 5.316881710973677, 8.265642141434224, -35.175448558430844, -23.690092829143914, -14.62194302498847, -26.34030926852398, -19.497940774745253, -2.620447674963339, -39.09563330433338, -47.71358048640644, 8.002133344473613, -21.420880539690174, -35.765088741596415, -11.7475936078057, 10.671504952997628, 10.80042653140801, 2.9529676831903258, -22.925038734481046, -23.478808534662235, -19.201841914318464, -32.28961353037105, -20.214509198905194, 8.600867390452684, -2.613026229887339, -17.63153739223669, -34.94051057845881, -34.67975346668595, -9.181048337660858, -40.76236815338447, -39.42651596796972, -7.321371426661048, -22.89836918639124, -44.64195745663844, -50.55461075077338, -14.433084488643225, -2.591274405292845, -33.33165772313811, 16.159458700290998, -34.74720353359409, -26.199220940111285, -37.380155777451236, -17.748275525815895, -41.452108202744824, -35.890589781954105, -25.206228359997358, -0.009861218208211397, -15.88829416104691, -42.63542877414871, -14.222358696007218, -14.949849396602662, -10.771075504917288, -3.4403178604141935, -27.662641388805323, -14.878157499110099, 11.044068654964022, -1.743008419209247, -10.514204333321782, -20.497721715393865, 2.4749504445418538, -31.077209002350536, -1.9376971903079636, -12.51886579171775, -23.184786012392628, 13.348739806844307, -19.9238741954536, -3.8041096018503238, -43.75242914630457, -21.549902873246516, -41.90936874688793, 3.640549292809446, -10.094408217375069, -9.892350165335882, -30.23848983537292, -32.71844377450459, -24.838899857169512, -11.93177607356792, -25.41982780600914, 9.778425728912481, -31.944068419951343, -27.09401930981484, -12.538326281448816, -8.558105227020233, -15.997529597691766, 1.5204618840358481, -6.022048739788983, -10.679646845387577, -11.049176561570285, -28.433628057108407, -15.888469621061367, -4.511836614124269, -1.9550048316366215, -32.60887936138744], "policy_predator_policy_reward": [38.04350682699947, 20.653479651635458, 14.143597769956555, 20.293643567150557, 23.158293096679184, 3.7892986631615937, 20.211341835444443, 13.568814563663963, -5.316881710973677, -8.265642141434224, 35.175448558430844, 23.690092829143914, 14.62194302498847, 26.34030926852398, 19.497940774745253, 2.620447674963339, 39.09563330433338, 47.71358048640644, -8.002133344473613, 21.420880539690174, 35.765088741596415, 11.7475936078057, -10.671504952997628, -10.80042653140801, -2.9529676831903258, 22.925038734481046, 23.478808534662235, 19.201841914318464, 32.28961353037105, 20.214509198905194, -8.600867390452684, 2.613026229887339, 17.63153739223669, 34.94051057845881, 34.67975346668595, 9.181048337660858, 40.76236815338447, 39.42651596796972, 7.321371426661048, 22.89836918639124, 44.64195745663844, 50.55461075077338, 14.433084488643225, 2.591274405292845, 33.33165772313811, -16.159458700290998, 34.74720353359409, 26.199220940111285, 37.380155777451236, 17.748275525815895, 41.452108202744824, 35.890589781954105, 25.206228359997358, 0.009861218208211397, 15.88829416104691, 42.63542877414871, 14.222358696007218, 14.949849396602662, 10.771075504917288, 3.4403178604141935, 27.662641388805323, 14.878157499110099, -11.044068654964022, 1.743008419209247, 10.514204333321782, 20.497721715393865, -2.4749504445418538, 31.077209002350536, 1.9376971903079636, 12.51886579171775, 23.184786012392628, -13.348739806844307, 19.9238741954536, 3.8041096018503238, 43.75242914630457, 21.549902873246516, 41.90936874688793, -3.640549292809446, 10.094408217375069, 9.892350165335882, 30.23848983537292, 32.71844377450459, 24.838899857169512, 11.93177607356792, 25.41982780600914, -9.778425728912481, 31.944068419951343, 27.09401930981484, 12.538326281448816, 8.558105227020233, 15.997529597691766, -1.5204618840358481, 6.022048739788983, 10.679646845387577, 11.049176561570285, 28.433628057108407, 15.888469621061367, 4.511836614124269, 1.9550048316366215, 32.60887936138744]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5378995373295156, "mean_inference_ms": 1.8929328160123828, "mean_action_processing_ms": 0.2275365750734332, "mean_env_wait_ms": 0.14377237662666484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037746429443359375, "StateBufferConnector_ms": 0.003251791000366211, "ViewRequirementAgentConnector_ms": 0.08205771446228027}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.1357156157946, "num_env_steps_trained_throughput_per_sec": 428.1357156157946, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 616000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 616000, "timers": {"training_iteration_time_ms": 8991.799, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8991.617, "sample_time_ms": 1233.454, "learn_time_ms": 7729.702, "learn_throughput": 517.484, "synch_weights_time_ms": 26.689}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "done": false, "training_iteration": 77, "trial_id": "1f352_00000", "date": "2024-08-11_15-07-27", "timestamp": 1723403247, "time_this_iter_s": 9.421382904052734, "time_total_s": 759.581953048706, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1af1820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 759.581953048706, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 54.56153846153846, "ram_util_percent": 83.02307692307691}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.16138395772626, "cur_kl_coeff": 1.4305114746093747e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8859829385454456, "policy_loss": -0.0036878694707411343, "vf_loss": 1.8896708159397047, "vf_explained_var": 0.9449683741355935, "kl": 0.0029198198435931707, "entropy": 0.3288621850466977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0882797942186397, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8435135342180728, "policy_loss": -0.006772121769123866, "vf_loss": 1.8501883080850046, "vf_explained_var": 0.9470463857054711, "kl": 0.01038366823447251, "entropy": 0.57226935159415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.55461075077338, "predator_policy": -16.159458700290998}, "policy_reward_max": {"prey_policy": 16.159458700290998, "predator_policy": 50.55461075077338}, "policy_reward_mean": {"prey_policy": -16.415609501749483, "predator_policy": 16.415609501749483}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [10.80042653140801, 2.9529676831903258, -22.925038734481046, -23.478808534662235, -19.201841914318464, -32.28961353037105, -20.214509198905194, 8.600867390452684, -2.613026229887339, -17.63153739223669, -34.94051057845881, -34.67975346668595, -9.181048337660858, -40.76236815338447, -39.42651596796972, -7.321371426661048, -22.89836918639124, -44.64195745663844, -50.55461075077338, -14.433084488643225, -2.591274405292845, -33.33165772313811, 16.159458700290998, -34.74720353359409, -26.199220940111285, -37.380155777451236, -17.748275525815895, -41.452108202744824, -35.890589781954105, -25.206228359997358, -0.009861218208211397, -15.88829416104691, -42.63542877414871, -14.222358696007218, -14.949849396602662, -10.771075504917288, -3.4403178604141935, -27.662641388805323, -14.878157499110099, 11.044068654964022, -1.743008419209247, -10.514204333321782, -20.497721715393865, 2.4749504445418538, -31.077209002350536, -1.9376971903079636, -12.51886579171775, -23.184786012392628, 13.348739806844307, -19.9238741954536, -3.8041096018503238, -43.75242914630457, -21.549902873246516, -41.90936874688793, 3.640549292809446, -10.094408217375069, -9.892350165335882, -30.23848983537292, -32.71844377450459, -24.838899857169512, -11.93177607356792, -25.41982780600914, 9.778425728912481, -31.944068419951343, -27.09401930981484, -12.538326281448816, -8.558105227020233, -15.997529597691766, 1.5204618840358481, -6.022048739788983, -10.679646845387577, -11.049176561570285, -28.433628057108407, -15.888469621061367, -4.511836614124269, -1.9550048316366215, -32.60887936138744, -1.0776458002533982, -0.6409714476718849, -1.1756767539498298, -20.218889180609533, -16.63055292438535, -26.186267120027424, -0.31844156583754835, 2.1872877285507535, -31.27224895269981, 7.935925725882122, -25.433508885515995, -16.85250560547661, -11.521070757479423, -5.17220413985399, -3.8287973525416863, -7.094760508254971, -30.845625420422948, -25.690351156742004, -4.960886002385419, -40.03114805217062, -8.23177807715878, -22.34539432676437, -11.449579393375997], "policy_predator_policy_reward": [-10.80042653140801, -2.9529676831903258, 22.925038734481046, 23.478808534662235, 19.201841914318464, 32.28961353037105, 20.214509198905194, -8.600867390452684, 2.613026229887339, 17.63153739223669, 34.94051057845881, 34.67975346668595, 9.181048337660858, 40.76236815338447, 39.42651596796972, 7.321371426661048, 22.89836918639124, 44.64195745663844, 50.55461075077338, 14.433084488643225, 2.591274405292845, 33.33165772313811, -16.159458700290998, 34.74720353359409, 26.199220940111285, 37.380155777451236, 17.748275525815895, 41.452108202744824, 35.890589781954105, 25.206228359997358, 0.009861218208211397, 15.88829416104691, 42.63542877414871, 14.222358696007218, 14.949849396602662, 10.771075504917288, 3.4403178604141935, 27.662641388805323, 14.878157499110099, -11.044068654964022, 1.743008419209247, 10.514204333321782, 20.497721715393865, -2.4749504445418538, 31.077209002350536, 1.9376971903079636, 12.51886579171775, 23.184786012392628, -13.348739806844307, 19.9238741954536, 3.8041096018503238, 43.75242914630457, 21.549902873246516, 41.90936874688793, -3.640549292809446, 10.094408217375069, 9.892350165335882, 30.23848983537292, 32.71844377450459, 24.838899857169512, 11.93177607356792, 25.41982780600914, -9.778425728912481, 31.944068419951343, 27.09401930981484, 12.538326281448816, 8.558105227020233, 15.997529597691766, -1.5204618840358481, 6.022048739788983, 10.679646845387577, 11.049176561570285, 28.433628057108407, 15.888469621061367, 4.511836614124269, 1.9550048316366215, 32.60887936138744, 1.0776458002533982, 0.6409714476718849, 1.1756767539498298, 20.218889180609533, 16.63055292438535, 26.186267120027424, 0.31844156583754835, -2.1872877285507535, 31.27224895269981, -7.935925725882122, 25.433508885515995, 16.85250560547661, 11.521070757479423, 5.17220413985399, 3.8287973525416863, 7.094760508254971, 30.845625420422948, 25.690351156742004, 4.960886002385419, 40.03114805217062, 8.23177807715878, 22.34539432676437, 11.449579393375997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5365735690528495, "mean_inference_ms": 1.8871486704538198, "mean_action_processing_ms": 0.22701737151040516, "mean_env_wait_ms": 0.1433475665305785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004026055335998535, "StateBufferConnector_ms": 0.003473520278930664, "ViewRequirementAgentConnector_ms": 0.10371875762939453}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 465.71091075248444, "num_env_steps_trained_throughput_per_sec": 465.71091075248444, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 8975.376, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8975.214, "sample_time_ms": 1226.558, "learn_time_ms": 7720.456, "learn_throughput": 518.104, "synch_weights_time_ms": 26.365}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 78, "trial_id": "1f352_00000", "date": "2024-08-11_15-07-36", "timestamp": 1723403256, "time_this_iter_s": 8.634833097457886, "time_total_s": 768.2167861461639, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b188e820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 768.2167861461639, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 54.89166666666666, "ram_util_percent": 83.20833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.15331378399084, "cur_kl_coeff": 7.152557373046873e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4835529027506709, "policy_loss": -0.0015453850355697796, "vf_loss": 1.4850982839862505, "vf_explained_var": 0.9587443386514981, "kl": 0.0034925654685449043, "entropy": 0.3084447166106353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1583246995384493, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.456642605488499, "policy_loss": -0.004751739021351871, "vf_loss": 1.4613190227498611, "vf_explained_var": 0.9609951246529818, "kl": 0.008034226991006027, "entropy": 0.5439001736231148, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.55461075077338, "predator_policy": -16.159458700290998}, "policy_reward_max": {"prey_policy": 16.159458700290998, "predator_policy": 50.55461075077338}, "policy_reward_mean": {"prey_policy": -15.272301399664766, "predator_policy": 15.272301399664766}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-50.55461075077338, -14.433084488643225, -2.591274405292845, -33.33165772313811, 16.159458700290998, -34.74720353359409, -26.199220940111285, -37.380155777451236, -17.748275525815895, -41.452108202744824, -35.890589781954105, -25.206228359997358, -0.009861218208211397, -15.88829416104691, -42.63542877414871, -14.222358696007218, -14.949849396602662, -10.771075504917288, -3.4403178604141935, -27.662641388805323, -14.878157499110099, 11.044068654964022, -1.743008419209247, -10.514204333321782, -20.497721715393865, 2.4749504445418538, -31.077209002350536, -1.9376971903079636, -12.51886579171775, -23.184786012392628, 13.348739806844307, -19.9238741954536, -3.8041096018503238, -43.75242914630457, -21.549902873246516, -41.90936874688793, 3.640549292809446, -10.094408217375069, -9.892350165335882, -30.23848983537292, -32.71844377450459, -24.838899857169512, -11.93177607356792, -25.41982780600914, 9.778425728912481, -31.944068419951343, -27.09401930981484, -12.538326281448816, -8.558105227020233, -15.997529597691766, 1.5204618840358481, -6.022048739788983, -10.679646845387577, -11.049176561570285, -28.433628057108407, -15.888469621061367, -4.511836614124269, -1.9550048316366215, -32.60887936138744, -1.0776458002533982, -0.6409714476718849, -1.1756767539498298, -20.218889180609533, -16.63055292438535, -26.186267120027424, -0.31844156583754835, 2.1872877285507535, -31.27224895269981, 7.935925725882122, -25.433508885515995, -16.85250560547661, -11.521070757479423, -5.17220413985399, -3.8287973525416863, -7.094760508254971, -30.845625420422948, -25.690351156742004, -4.960886002385419, -40.03114805217062, -8.23177807715878, -22.34539432676437, -11.449579393375997, -6.8391208864955715, -22.49815460448041, -32.728945839571416, -25.591539351209665, -1.6614926241670718, -31.428523287386838, -5.074605492101295, -3.3836221678762577, -33.32258913424362, -15.136665545197058, -12.239144767957153, -6.834318376183342, -19.097629109855863, 0.27085679513574945, -29.818099097165906, 7.3273717509577025, -2.723413031986892, 5.258436474594696], "policy_predator_policy_reward": [50.55461075077338, 14.433084488643225, 2.591274405292845, 33.33165772313811, -16.159458700290998, 34.74720353359409, 26.199220940111285, 37.380155777451236, 17.748275525815895, 41.452108202744824, 35.890589781954105, 25.206228359997358, 0.009861218208211397, 15.88829416104691, 42.63542877414871, 14.222358696007218, 14.949849396602662, 10.771075504917288, 3.4403178604141935, 27.662641388805323, 14.878157499110099, -11.044068654964022, 1.743008419209247, 10.514204333321782, 20.497721715393865, -2.4749504445418538, 31.077209002350536, 1.9376971903079636, 12.51886579171775, 23.184786012392628, -13.348739806844307, 19.9238741954536, 3.8041096018503238, 43.75242914630457, 21.549902873246516, 41.90936874688793, -3.640549292809446, 10.094408217375069, 9.892350165335882, 30.23848983537292, 32.71844377450459, 24.838899857169512, 11.93177607356792, 25.41982780600914, -9.778425728912481, 31.944068419951343, 27.09401930981484, 12.538326281448816, 8.558105227020233, 15.997529597691766, -1.5204618840358481, 6.022048739788983, 10.679646845387577, 11.049176561570285, 28.433628057108407, 15.888469621061367, 4.511836614124269, 1.9550048316366215, 32.60887936138744, 1.0776458002533982, 0.6409714476718849, 1.1756767539498298, 20.218889180609533, 16.63055292438535, 26.186267120027424, 0.31844156583754835, -2.1872877285507535, 31.27224895269981, -7.935925725882122, 25.433508885515995, 16.85250560547661, 11.521070757479423, 5.17220413985399, 3.8287973525416863, 7.094760508254971, 30.845625420422948, 25.690351156742004, 4.960886002385419, 40.03114805217062, 8.23177807715878, 22.34539432676437, 11.449579393375997, 6.8391208864955715, 22.49815460448041, 32.728945839571416, 25.591539351209665, 1.6614926241670718, 31.428523287386838, 5.074605492101295, 3.3836221678762577, 33.32258913424362, 15.136665545197058, 12.239144767957153, 6.834318376183342, 19.097629109855863, -0.27085679513574945, 29.818099097165906, -7.3273717509577025, 2.723413031986892, -5.258436474594696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.536130346741038, "mean_inference_ms": 1.8836597958262808, "mean_action_processing_ms": 0.22661222631136194, "mean_env_wait_ms": 0.14305646903247532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004717707633972168, "StateBufferConnector_ms": 0.004168510437011719, "ViewRequirementAgentConnector_ms": 0.14445197582244873}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 459.4344108520313, "num_env_steps_trained_throughput_per_sec": 459.4344108520313, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 632000, "timers": {"training_iteration_time_ms": 8891.139, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8890.976, "sample_time_ms": 1218.876, "learn_time_ms": 7643.969, "learn_throughput": 523.288, "synch_weights_time_ms": 26.302}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "done": false, "training_iteration": 79, "trial_id": "1f352_00000", "date": "2024-08-11_15-07-44", "timestamp": 1723403264, "time_this_iter_s": 8.744117975234985, "time_total_s": 776.9609041213989, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b188ec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 776.9609041213989, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 49.661538461538456, "ram_util_percent": 83.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.104453692274789, "cur_kl_coeff": 3.576278686523437e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7787002203365168, "policy_loss": -0.0037067957974310653, "vf_loss": 1.7824070143202941, "vf_explained_var": 0.9602256457631787, "kl": 0.005196811721431137, "entropy": 0.287922818834583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.247123023370902, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7113016774257024, "policy_loss": -0.0047877649699027336, "vf_loss": 1.7160226752981544, "vf_explained_var": 0.9619335700447361, "kl": 0.007122350926836174, "entropy": 0.5504338281229139, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.13724889330874, "predator_policy": -13.572412836435593}, "policy_reward_max": {"prey_policy": 13.572412836435593, "predator_policy": 49.13724889330874}, "policy_reward_mean": {"prey_policy": -14.22812430858648, "predator_policy": 14.22812430858648}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1.743008419209247, -10.514204333321782, -20.497721715393865, 2.4749504445418538, -31.077209002350536, -1.9376971903079636, -12.51886579171775, -23.184786012392628, 13.348739806844307, -19.9238741954536, -3.8041096018503238, -43.75242914630457, -21.549902873246516, -41.90936874688793, 3.640549292809446, -10.094408217375069, -9.892350165335882, -30.23848983537292, -32.71844377450459, -24.838899857169512, -11.93177607356792, -25.41982780600914, 9.778425728912481, -31.944068419951343, -27.09401930981484, -12.538326281448816, -8.558105227020233, -15.997529597691766, 1.5204618840358481, -6.022048739788983, -10.679646845387577, -11.049176561570285, -28.433628057108407, -15.888469621061367, -4.511836614124269, -1.9550048316366215, -32.60887936138744, -1.0776458002533982, -0.6409714476718849, -1.1756767539498298, -20.218889180609533, -16.63055292438535, -26.186267120027424, -0.31844156583754835, 2.1872877285507535, -31.27224895269981, 7.935925725882122, -25.433508885515995, -16.85250560547661, -11.521070757479423, -5.17220413985399, -3.8287973525416863, -7.094760508254971, -30.845625420422948, -25.690351156742004, -4.960886002385419, -40.03114805217062, -8.23177807715878, -22.34539432676437, -11.449579393375997, -6.8391208864955715, -22.49815460448041, -32.728945839571416, -25.591539351209665, -1.6614926241670718, -31.428523287386838, -5.074605492101295, -3.3836221678762577, -33.32258913424362, -15.136665545197058, -12.239144767957153, -6.834318376183342, -19.097629109855863, 0.27085679513574945, -29.818099097165906, 7.3273717509577025, -2.723413031986892, 5.258436474594696, -15.08813465053932, 9.263247992791753, -49.13724889330874, -11.098820452597177, 10.70434528668991, -12.326794073658618, -11.506719736397075, 13.572412836435593, -25.09479052822615, -24.422473308133508, -29.453027430599263, -26.433468371837872, -1.3985129951388764, -3.0592901117625013, -23.776850794268125, -37.09010055157244, -2.8949512062089937, -6.082291260551417, -14.167817395032447, -35.42499610122286, -28.010453984249413, -9.444421796305924], "policy_predator_policy_reward": [1.743008419209247, 10.514204333321782, 20.497721715393865, -2.4749504445418538, 31.077209002350536, 1.9376971903079636, 12.51886579171775, 23.184786012392628, -13.348739806844307, 19.9238741954536, 3.8041096018503238, 43.75242914630457, 21.549902873246516, 41.90936874688793, -3.640549292809446, 10.094408217375069, 9.892350165335882, 30.23848983537292, 32.71844377450459, 24.838899857169512, 11.93177607356792, 25.41982780600914, -9.778425728912481, 31.944068419951343, 27.09401930981484, 12.538326281448816, 8.558105227020233, 15.997529597691766, -1.5204618840358481, 6.022048739788983, 10.679646845387577, 11.049176561570285, 28.433628057108407, 15.888469621061367, 4.511836614124269, 1.9550048316366215, 32.60887936138744, 1.0776458002533982, 0.6409714476718849, 1.1756767539498298, 20.218889180609533, 16.63055292438535, 26.186267120027424, 0.31844156583754835, -2.1872877285507535, 31.27224895269981, -7.935925725882122, 25.433508885515995, 16.85250560547661, 11.521070757479423, 5.17220413985399, 3.8287973525416863, 7.094760508254971, 30.845625420422948, 25.690351156742004, 4.960886002385419, 40.03114805217062, 8.23177807715878, 22.34539432676437, 11.449579393375997, 6.8391208864955715, 22.49815460448041, 32.728945839571416, 25.591539351209665, 1.6614926241670718, 31.428523287386838, 5.074605492101295, 3.3836221678762577, 33.32258913424362, 15.136665545197058, 12.239144767957153, 6.834318376183342, 19.097629109855863, -0.27085679513574945, 29.818099097165906, -7.3273717509577025, 2.723413031986892, -5.258436474594696, 15.08813465053932, -9.263247992791753, 49.13724889330874, 11.098820452597177, -10.70434528668991, 12.326794073658618, 11.506719736397075, -13.572412836435593, 25.09479052822615, 24.422473308133508, 29.453027430599263, 26.433468371837872, 1.3985129951388764, 3.0592901117625013, 23.776850794268125, 37.09010055157244, 2.8949512062089937, 6.082291260551417, 14.167817395032447, 35.42499610122286, 28.010453984249413, 9.444421796305924]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5385599514411152, "mean_inference_ms": 1.8896710934910357, "mean_action_processing_ms": 0.22770206738127122, "mean_env_wait_ms": 0.14342636138587703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004998683929443359, "StateBufferConnector_ms": 0.004330992698669434, "ViewRequirementAgentConnector_ms": 0.12827515602111816}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 410.37110895438923, "num_env_steps_trained_throughput_per_sec": 410.37110895438923, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 8949.988, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8949.85, "sample_time_ms": 1214.603, "learn_time_ms": 7706.017, "learn_throughput": 519.075, "synch_weights_time_ms": 27.492}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 80, "trial_id": "1f352_00000", "date": "2024-08-11_15-07-54", "timestamp": 1723403274, "time_this_iter_s": 9.788741111755371, "time_total_s": 786.7496452331543, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b18a6820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 786.7496452331543, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 57.028571428571425, "ram_util_percent": 83.24285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3627264136448503, "cur_kl_coeff": 3.576278686523437e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7886299509555101, "policy_loss": 0.0014635244151577353, "vf_loss": 1.7871664284418027, "vf_explained_var": 0.9606870936850707, "kl": 0.0023433830607723044, "entropy": 0.31595017928630115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.361864850173394, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.764446277047197, "policy_loss": -0.0074044126168397876, "vf_loss": 1.7717645487437645, "vf_explained_var": 0.96027544165651, "kl": 0.00918863032220661, "entropy": 0.5359345278081794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.13724889330874, "predator_policy": -13.572412836435593}, "policy_reward_max": {"prey_policy": 13.572412836435593, "predator_policy": 49.13724889330874}, "policy_reward_mean": {"prey_policy": -14.0160111267295, "predator_policy": 14.0160111267295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-32.71844377450459, -24.838899857169512, -11.93177607356792, -25.41982780600914, 9.778425728912481, -31.944068419951343, -27.09401930981484, -12.538326281448816, -8.558105227020233, -15.997529597691766, 1.5204618840358481, -6.022048739788983, -10.679646845387577, -11.049176561570285, -28.433628057108407, -15.888469621061367, -4.511836614124269, -1.9550048316366215, -32.60887936138744, -1.0776458002533982, -0.6409714476718849, -1.1756767539498298, -20.218889180609533, -16.63055292438535, -26.186267120027424, -0.31844156583754835, 2.1872877285507535, -31.27224895269981, 7.935925725882122, -25.433508885515995, -16.85250560547661, -11.521070757479423, -5.17220413985399, -3.8287973525416863, -7.094760508254971, -30.845625420422948, -25.690351156742004, -4.960886002385419, -40.03114805217062, -8.23177807715878, -22.34539432676437, -11.449579393375997, -6.8391208864955715, -22.49815460448041, -32.728945839571416, -25.591539351209665, -1.6614926241670718, -31.428523287386838, -5.074605492101295, -3.3836221678762577, -33.32258913424362, -15.136665545197058, -12.239144767957153, -6.834318376183342, -19.097629109855863, 0.27085679513574945, -29.818099097165906, 7.3273717509577025, -2.723413031986892, 5.258436474594696, -15.08813465053932, 9.263247992791753, -49.13724889330874, -11.098820452597177, 10.70434528668991, -12.326794073658618, -11.506719736397075, 13.572412836435593, -25.09479052822615, -24.422473308133508, -29.453027430599263, -26.433468371837872, -1.3985129951388764, -3.0592901117625013, -23.776850794268125, -37.09010055157244, -2.8949512062089937, -6.082291260551417, -14.167817395032447, -35.42499610122286, -28.010453984249413, -9.444421796305924, -41.73647351931656, -20.683202518078012, -10.362117297087227, -9.589173857025651, 5.7847094705239215, 2.6307935519212986, -9.038447818711877, 2.1750156681460577, -30.845692647540673, -20.06296456821927, 9.057032672425226, -37.444288316405164, -17.381665331703434, 5.5983098040776245, -43.15676638001032, -18.36165675827833, -5.943410804790695, -2.602868866553692], "policy_predator_policy_reward": [32.71844377450459, 24.838899857169512, 11.93177607356792, 25.41982780600914, -9.778425728912481, 31.944068419951343, 27.09401930981484, 12.538326281448816, 8.558105227020233, 15.997529597691766, -1.5204618840358481, 6.022048739788983, 10.679646845387577, 11.049176561570285, 28.433628057108407, 15.888469621061367, 4.511836614124269, 1.9550048316366215, 32.60887936138744, 1.0776458002533982, 0.6409714476718849, 1.1756767539498298, 20.218889180609533, 16.63055292438535, 26.186267120027424, 0.31844156583754835, -2.1872877285507535, 31.27224895269981, -7.935925725882122, 25.433508885515995, 16.85250560547661, 11.521070757479423, 5.17220413985399, 3.8287973525416863, 7.094760508254971, 30.845625420422948, 25.690351156742004, 4.960886002385419, 40.03114805217062, 8.23177807715878, 22.34539432676437, 11.449579393375997, 6.8391208864955715, 22.49815460448041, 32.728945839571416, 25.591539351209665, 1.6614926241670718, 31.428523287386838, 5.074605492101295, 3.3836221678762577, 33.32258913424362, 15.136665545197058, 12.239144767957153, 6.834318376183342, 19.097629109855863, -0.27085679513574945, 29.818099097165906, -7.3273717509577025, 2.723413031986892, -5.258436474594696, 15.08813465053932, -9.263247992791753, 49.13724889330874, 11.098820452597177, -10.70434528668991, 12.326794073658618, 11.506719736397075, -13.572412836435593, 25.09479052822615, 24.422473308133508, 29.453027430599263, 26.433468371837872, 1.3985129951388764, 3.0592901117625013, 23.776850794268125, 37.09010055157244, 2.8949512062089937, 6.082291260551417, 14.167817395032447, 35.42499610122286, 28.010453984249413, 9.444421796305924, 41.73647351931656, 20.683202518078012, 10.362117297087227, 9.589173857025651, -5.7847094705239215, -2.6307935519212986, 9.038447818711877, -2.1750156681460577, 30.845692647540673, 20.06296456821927, -9.057032672425226, 37.444288316405164, 17.381665331703434, -5.5983098040776245, 43.15676638001032, 18.36165675827833, 5.943410804790695, 2.602868866553692]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5361171337355841, "mean_inference_ms": 1.8800422861431592, "mean_action_processing_ms": 0.22624737895307048, "mean_env_wait_ms": 0.14260586168531209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005279183387756348, "StateBufferConnector_ms": 0.0037993192672729492, "ViewRequirementAgentConnector_ms": 0.14248931407928467}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.13507512510046, "num_env_steps_trained_throughput_per_sec": 442.13507512510046, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 8954.665, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8954.5, "sample_time_ms": 1279.447, "learn_time_ms": 7636.434, "learn_throughput": 523.805, "synch_weights_time_ms": 36.367}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "training_iteration": 81, "trial_id": "1f352_00000", "date": "2024-08-11_15-08-03", "timestamp": 1723403283, "time_this_iter_s": 9.12617015838623, "time_total_s": 795.8758153915405, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b187baf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 795.8758153915405, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 54.98461538461538, "ram_util_percent": 83.42307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5463157991568246, "cur_kl_coeff": 1.7881393432617184e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4106032411257425, "policy_loss": -0.0016055828687967732, "vf_loss": 2.4122088284542165, "vf_explained_var": 0.9511388745158911, "kl": 0.003136354138902449, "entropy": 0.3536296041061481, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.764816989873846, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.404500726858775, "policy_loss": -0.003171259736700449, "vf_loss": 2.407644016047319, "vf_explained_var": 0.9539062907298406, "kl": 0.0029827999220502686, "entropy": 0.5349605454442402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.13724889330874, "predator_policy": -17.017489273705927}, "policy_reward_max": {"prey_policy": 17.017489273705927, "predator_policy": 49.13724889330874}, "policy_reward_mean": {"prey_policy": -15.066185140044546, "predator_policy": 15.066185140044546}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.63055292438535, -26.186267120027424, -0.31844156583754835, 2.1872877285507535, -31.27224895269981, 7.935925725882122, -25.433508885515995, -16.85250560547661, -11.521070757479423, -5.17220413985399, -3.8287973525416863, -7.094760508254971, -30.845625420422948, -25.690351156742004, -4.960886002385419, -40.03114805217062, -8.23177807715878, -22.34539432676437, -11.449579393375997, -6.8391208864955715, -22.49815460448041, -32.728945839571416, -25.591539351209665, -1.6614926241670718, -31.428523287386838, -5.074605492101295, -3.3836221678762577, -33.32258913424362, -15.136665545197058, -12.239144767957153, -6.834318376183342, -19.097629109855863, 0.27085679513574945, -29.818099097165906, 7.3273717509577025, -2.723413031986892, 5.258436474594696, -15.08813465053932, 9.263247992791753, -49.13724889330874, -11.098820452597177, 10.70434528668991, -12.326794073658618, -11.506719736397075, 13.572412836435593, -25.09479052822615, -24.422473308133508, -29.453027430599263, -26.433468371837872, -1.3985129951388764, -3.0592901117625013, -23.776850794268125, -37.09010055157244, -2.8949512062089937, -6.082291260551417, -14.167817395032447, -35.42499610122286, -28.010453984249413, -9.444421796305924, -41.73647351931656, -20.683202518078012, -10.362117297087227, -9.589173857025651, 5.7847094705239215, 2.6307935519212986, -9.038447818711877, 2.1750156681460577, -30.845692647540673, -20.06296456821927, 9.057032672425226, -37.444288316405164, -17.381665331703434, 5.5983098040776245, -43.15676638001032, -18.36165675827833, -5.943410804790695, -2.602868866553692, -45.601112096755294, -15.003736624420478, -17.413735566609276, -30.715066586516507, -30.428933549892804, -48.65262022168734, -15.714140095776774, -19.68751929151819, -13.514017955896332, -46.86622229218028, 5.045223794217893, -10.184717501656088, 0.5106960781609242, -29.549499032894687, -21.54961249800448, -34.13923383896072, -20.267861872345602, -5.779767059539463, 17.017489273705927, -33.301651626323434, -0.576929208964593, 2.595848647895078, -5.2442647543214544], "policy_predator_policy_reward": [16.63055292438535, 26.186267120027424, 0.31844156583754835, -2.1872877285507535, 31.27224895269981, -7.935925725882122, 25.433508885515995, 16.85250560547661, 11.521070757479423, 5.17220413985399, 3.8287973525416863, 7.094760508254971, 30.845625420422948, 25.690351156742004, 4.960886002385419, 40.03114805217062, 8.23177807715878, 22.34539432676437, 11.449579393375997, 6.8391208864955715, 22.49815460448041, 32.728945839571416, 25.591539351209665, 1.6614926241670718, 31.428523287386838, 5.074605492101295, 3.3836221678762577, 33.32258913424362, 15.136665545197058, 12.239144767957153, 6.834318376183342, 19.097629109855863, -0.27085679513574945, 29.818099097165906, -7.3273717509577025, 2.723413031986892, -5.258436474594696, 15.08813465053932, -9.263247992791753, 49.13724889330874, 11.098820452597177, -10.70434528668991, 12.326794073658618, 11.506719736397075, -13.572412836435593, 25.09479052822615, 24.422473308133508, 29.453027430599263, 26.433468371837872, 1.3985129951388764, 3.0592901117625013, 23.776850794268125, 37.09010055157244, 2.8949512062089937, 6.082291260551417, 14.167817395032447, 35.42499610122286, 28.010453984249413, 9.444421796305924, 41.73647351931656, 20.683202518078012, 10.362117297087227, 9.589173857025651, -5.7847094705239215, -2.6307935519212986, 9.038447818711877, -2.1750156681460577, 30.845692647540673, 20.06296456821927, -9.057032672425226, 37.444288316405164, 17.381665331703434, -5.5983098040776245, 43.15676638001032, 18.36165675827833, 5.943410804790695, 2.602868866553692, 45.601112096755294, 15.003736624420478, 17.413735566609276, 30.715066586516507, 30.428933549892804, 48.65262022168734, 15.714140095776774, 19.68751929151819, 13.514017955896332, 46.86622229218028, -5.045223794217893, 10.184717501656088, -0.5106960781609242, 29.549499032894687, 21.54961249800448, 34.13923383896072, 20.267861872345602, 5.779767059539463, -17.017489273705927, 33.301651626323434, 0.576929208964593, -2.595848647895078, 5.2442647543214544]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5372907737479906, "mean_inference_ms": 1.8799331497288292, "mean_action_processing_ms": 0.22648984829875984, "mean_env_wait_ms": 0.14252147342099986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005275845527648926, "StateBufferConnector_ms": 0.0038095712661743164, "ViewRequirementAgentConnector_ms": 0.14154279232025146}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 439.3677438933593, "num_env_steps_trained_throughput_per_sec": 439.3677438933593, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 8930.566, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8930.404, "sample_time_ms": 1243.692, "learn_time_ms": 7646.945, "learn_throughput": 523.085, "synch_weights_time_ms": 37.494}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 82, "trial_id": "1f352_00000", "date": "2024-08-11_15-08-13", "timestamp": 1723403293, "time_this_iter_s": 9.138903856277466, "time_total_s": 805.014719247818, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a16700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 805.014719247818, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 51.53846153846154, "ram_util_percent": 83.26153846153845}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6048933822040756, "cur_kl_coeff": 8.940696716308592e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5410662734260163, "policy_loss": -0.0014779918133475197, "vf_loss": 2.5425442850838107, "vf_explained_var": 0.9509815535197655, "kl": 0.00289669997435175, "entropy": 0.34442547409174346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7380331377188365, "cur_kl_coeff": 0.004687499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.528317991395791, "policy_loss": -0.00576385219610529, "vf_loss": 2.534033301969369, "vf_explained_var": 0.9512457964320977, "kl": 0.010356389765772788, "entropy": 0.5086780137692889, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -61.10449463765307, "predator_policy": -17.017489273705927}, "policy_reward_max": {"prey_policy": 17.017489273705927, "predator_policy": 61.10449463765307}, "policy_reward_mean": {"prey_policy": -16.114339019053048, "predator_policy": 16.114339019053048}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.449579393375997, -6.8391208864955715, -22.49815460448041, -32.728945839571416, -25.591539351209665, -1.6614926241670718, -31.428523287386838, -5.074605492101295, -3.3836221678762577, -33.32258913424362, -15.136665545197058, -12.239144767957153, -6.834318376183342, -19.097629109855863, 0.27085679513574945, -29.818099097165906, 7.3273717509577025, -2.723413031986892, 5.258436474594696, -15.08813465053932, 9.263247992791753, -49.13724889330874, -11.098820452597177, 10.70434528668991, -12.326794073658618, -11.506719736397075, 13.572412836435593, -25.09479052822615, -24.422473308133508, -29.453027430599263, -26.433468371837872, -1.3985129951388764, -3.0592901117625013, -23.776850794268125, -37.09010055157244, -2.8949512062089937, -6.082291260551417, -14.167817395032447, -35.42499610122286, -28.010453984249413, -9.444421796305924, -41.73647351931656, -20.683202518078012, -10.362117297087227, -9.589173857025651, 5.7847094705239215, 2.6307935519212986, -9.038447818711877, 2.1750156681460577, -30.845692647540673, -20.06296456821927, 9.057032672425226, -37.444288316405164, -17.381665331703434, 5.5983098040776245, -43.15676638001032, -18.36165675827833, -5.943410804790695, -2.602868866553692, -45.601112096755294, -15.003736624420478, -17.413735566609276, -30.715066586516507, -30.428933549892804, -48.65262022168734, -15.714140095776774, -19.68751929151819, -13.514017955896332, -46.86622229218028, 5.045223794217893, -10.184717501656088, 0.5106960781609242, -29.549499032894687, -21.54961249800448, -34.13923383896072, -20.267861872345602, -5.779767059539463, 17.017489273705927, -33.301651626323434, -0.576929208964593, 2.595848647895078, -5.2442647543214544, -7.940993439291571, -33.94077239944295, -27.404500500498543, -40.438746960867974, -61.10449463765307, -37.00465661714982, -4.35451273270401, -8.652356329869962, 2.3813164066330454, -19.539532212549368, -13.580681460395828, -15.0451765759666, -29.69916883739848, -25.05726778224764, 2.4810669290015532, -13.663438157511981, -28.87139530626842, -9.672404679952695], "policy_predator_policy_reward": [11.449579393375997, 6.8391208864955715, 22.49815460448041, 32.728945839571416, 25.591539351209665, 1.6614926241670718, 31.428523287386838, 5.074605492101295, 3.3836221678762577, 33.32258913424362, 15.136665545197058, 12.239144767957153, 6.834318376183342, 19.097629109855863, -0.27085679513574945, 29.818099097165906, -7.3273717509577025, 2.723413031986892, -5.258436474594696, 15.08813465053932, -9.263247992791753, 49.13724889330874, 11.098820452597177, -10.70434528668991, 12.326794073658618, 11.506719736397075, -13.572412836435593, 25.09479052822615, 24.422473308133508, 29.453027430599263, 26.433468371837872, 1.3985129951388764, 3.0592901117625013, 23.776850794268125, 37.09010055157244, 2.8949512062089937, 6.082291260551417, 14.167817395032447, 35.42499610122286, 28.010453984249413, 9.444421796305924, 41.73647351931656, 20.683202518078012, 10.362117297087227, 9.589173857025651, -5.7847094705239215, -2.6307935519212986, 9.038447818711877, -2.1750156681460577, 30.845692647540673, 20.06296456821927, -9.057032672425226, 37.444288316405164, 17.381665331703434, -5.5983098040776245, 43.15676638001032, 18.36165675827833, 5.943410804790695, 2.602868866553692, 45.601112096755294, 15.003736624420478, 17.413735566609276, 30.715066586516507, 30.428933549892804, 48.65262022168734, 15.714140095776774, 19.68751929151819, 13.514017955896332, 46.86622229218028, -5.045223794217893, 10.184717501656088, -0.5106960781609242, 29.549499032894687, 21.54961249800448, 34.13923383896072, 20.267861872345602, 5.779767059539463, -17.017489273705927, 33.301651626323434, 0.576929208964593, -2.595848647895078, 5.2442647543214544, 7.940993439291571, 33.94077239944295, 27.404500500498543, 40.438746960867974, 61.10449463765307, 37.00465661714982, 4.35451273270401, 8.652356329869962, -2.3813164066330454, 19.539532212549368, 13.580681460395828, 15.0451765759666, 29.69916883739848, 25.05726778224764, -2.4810669290015532, 13.663438157511981, 28.87139530626842, 9.672404679952695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5366994558905889, "mean_inference_ms": 1.879196310871328, "mean_action_processing_ms": 0.22622351623934925, "mean_env_wait_ms": 0.14227219640680486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005788564682006836, "StateBufferConnector_ms": 0.0040171146392822266, "ViewRequirementAgentConnector_ms": 0.12222599983215332}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.025528459395, "num_env_steps_trained_throughput_per_sec": 417.025528459395, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 664000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 664000, "timers": {"training_iteration_time_ms": 9026.087, "restore_workers_time_ms": 0.017, "training_step_time_ms": 9025.911, "sample_time_ms": 1288.596, "learn_time_ms": 7700.64, "learn_throughput": 519.437, "synch_weights_time_ms": 34.632}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "done": false, "training_iteration": 83, "trial_id": "1f352_00000", "date": "2024-08-11_15-08-22", "timestamp": 1723403302, "time_this_iter_s": 9.649037837982178, "time_total_s": 814.6637570858002, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a1a550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 814.6637570858002, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 56.03846153846155, "ram_util_percent": 83.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.798682135219375, "cur_kl_coeff": 4.470348358154296e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0143772803246973, "policy_loss": -0.0017964498154469765, "vf_loss": 3.016173728555441, "vf_explained_var": 0.9164650562529763, "kl": 0.003278396072920816, "entropy": 0.40891422087637086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6880341925968727, "cur_kl_coeff": 0.004687499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.999919606621067, "policy_loss": -0.007494885341535943, "vf_loss": 3.007359640300274, "vf_explained_var": 0.9164761858681838, "kl": 0.01170095308086478, "entropy": 0.5525422332187494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -61.10449463765307, "predator_policy": -17.017489273705927}, "policy_reward_max": {"prey_policy": 17.017489273705927, "predator_policy": 61.10449463765307}, "policy_reward_mean": {"prey_policy": -16.857060058361267, "predator_policy": 16.857060058361267}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.258436474594696, -15.08813465053932, 9.263247992791753, -49.13724889330874, -11.098820452597177, 10.70434528668991, -12.326794073658618, -11.506719736397075, 13.572412836435593, -25.09479052822615, -24.422473308133508, -29.453027430599263, -26.433468371837872, -1.3985129951388764, -3.0592901117625013, -23.776850794268125, -37.09010055157244, -2.8949512062089937, -6.082291260551417, -14.167817395032447, -35.42499610122286, -28.010453984249413, -9.444421796305924, -41.73647351931656, -20.683202518078012, -10.362117297087227, -9.589173857025651, 5.7847094705239215, 2.6307935519212986, -9.038447818711877, 2.1750156681460577, -30.845692647540673, -20.06296456821927, 9.057032672425226, -37.444288316405164, -17.381665331703434, 5.5983098040776245, -43.15676638001032, -18.36165675827833, -5.943410804790695, -2.602868866553692, -45.601112096755294, -15.003736624420478, -17.413735566609276, -30.715066586516507, -30.428933549892804, -48.65262022168734, -15.714140095776774, -19.68751929151819, -13.514017955896332, -46.86622229218028, 5.045223794217893, -10.184717501656088, 0.5106960781609242, -29.549499032894687, -21.54961249800448, -34.13923383896072, -20.267861872345602, -5.779767059539463, 17.017489273705927, -33.301651626323434, -0.576929208964593, 2.595848647895078, -5.2442647543214544, -7.940993439291571, -33.94077239944295, -27.404500500498543, -40.438746960867974, -61.10449463765307, -37.00465661714982, -4.35451273270401, -8.652356329869962, 2.3813164066330454, -19.539532212549368, -13.580681460395828, -15.0451765759666, -29.69916883739848, -25.05726778224764, 2.4810669290015532, -13.663438157511981, -28.87139530626842, -9.672404679952695, -23.596961029652398, -22.56860825499392, 4.068459789601089, -14.408681574108613, -8.784268198900005, -24.019056352075435, -3.6799348132677836, -5.205063072795436, -28.79401274974004, -13.342206982526786, -45.3024250966902, -27.348929740187888, -18.004484505315062, -19.504278169633906, -40.295735510287216, -0.3666105221757565, -10.697471256211838, -24.65105005502165], "policy_predator_policy_reward": [-5.258436474594696, 15.08813465053932, -9.263247992791753, 49.13724889330874, 11.098820452597177, -10.70434528668991, 12.326794073658618, 11.506719736397075, -13.572412836435593, 25.09479052822615, 24.422473308133508, 29.453027430599263, 26.433468371837872, 1.3985129951388764, 3.0592901117625013, 23.776850794268125, 37.09010055157244, 2.8949512062089937, 6.082291260551417, 14.167817395032447, 35.42499610122286, 28.010453984249413, 9.444421796305924, 41.73647351931656, 20.683202518078012, 10.362117297087227, 9.589173857025651, -5.7847094705239215, -2.6307935519212986, 9.038447818711877, -2.1750156681460577, 30.845692647540673, 20.06296456821927, -9.057032672425226, 37.444288316405164, 17.381665331703434, -5.5983098040776245, 43.15676638001032, 18.36165675827833, 5.943410804790695, 2.602868866553692, 45.601112096755294, 15.003736624420478, 17.413735566609276, 30.715066586516507, 30.428933549892804, 48.65262022168734, 15.714140095776774, 19.68751929151819, 13.514017955896332, 46.86622229218028, -5.045223794217893, 10.184717501656088, -0.5106960781609242, 29.549499032894687, 21.54961249800448, 34.13923383896072, 20.267861872345602, 5.779767059539463, -17.017489273705927, 33.301651626323434, 0.576929208964593, -2.595848647895078, 5.2442647543214544, 7.940993439291571, 33.94077239944295, 27.404500500498543, 40.438746960867974, 61.10449463765307, 37.00465661714982, 4.35451273270401, 8.652356329869962, -2.3813164066330454, 19.539532212549368, 13.580681460395828, 15.0451765759666, 29.69916883739848, 25.05726778224764, -2.4810669290015532, 13.663438157511981, 28.87139530626842, 9.672404679952695, 23.596961029652398, 22.56860825499392, -4.068459789601089, 14.408681574108613, 8.784268198900005, 24.019056352075435, 3.6799348132677836, 5.205063072795436, 28.79401274974004, 13.342206982526786, 45.3024250966902, 27.348929740187888, 18.004484505315062, 19.504278169633906, 40.295735510287216, 0.3666105221757565, 10.697471256211838, 24.65105005502165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5366774667931764, "mean_inference_ms": 1.8788346582253928, "mean_action_processing_ms": 0.22631344394001515, "mean_env_wait_ms": 0.14216088703500834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00522458553314209, "StateBufferConnector_ms": 0.003373265266418457, "ViewRequirementAgentConnector_ms": 0.0855870246887207}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 384.66905921000216, "num_env_steps_trained_throughput_per_sec": 384.66905921000216, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 9167.747, "restore_workers_time_ms": 0.018, "training_step_time_ms": 9167.57, "sample_time_ms": 1290.938, "learn_time_ms": 7839.76, "learn_throughput": 510.22, "synch_weights_time_ms": 34.66}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 84, "trial_id": "1f352_00000", "date": "2024-08-11_15-08-33", "timestamp": 1723403313, "time_this_iter_s": 10.43366003036499, "time_total_s": 825.0974171161652, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a1aee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 825.0974171161652, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 66.32666666666667, "ram_util_percent": 83.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5169809027264516, "cur_kl_coeff": 2.235174179077148e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.450174809123079, "policy_loss": -0.002680607418733416, "vf_loss": 2.4528554186224936, "vf_explained_var": 0.9371068812906742, "kl": 0.0016756549567502944, "entropy": 0.31138067360346516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.584253413975239, "cur_kl_coeff": 0.004687499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4872216592232386, "policy_loss": -0.003499807344148091, "vf_loss": 2.490701707825065, "vf_explained_var": 0.9377456340938807, "kl": 0.004216127912926962, "entropy": 0.5187973713191847, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -61.10449463765307, "predator_policy": -17.017489273705927}, "policy_reward_max": {"prey_policy": 17.017489273705927, "predator_policy": 61.10449463765307}, "policy_reward_mean": {"prey_policy": -16.52423260444773, "predator_policy": 16.52423260444773}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.444421796305924, -41.73647351931656, -20.683202518078012, -10.362117297087227, -9.589173857025651, 5.7847094705239215, 2.6307935519212986, -9.038447818711877, 2.1750156681460577, -30.845692647540673, -20.06296456821927, 9.057032672425226, -37.444288316405164, -17.381665331703434, 5.5983098040776245, -43.15676638001032, -18.36165675827833, -5.943410804790695, -2.602868866553692, -45.601112096755294, -15.003736624420478, -17.413735566609276, -30.715066586516507, -30.428933549892804, -48.65262022168734, -15.714140095776774, -19.68751929151819, -13.514017955896332, -46.86622229218028, 5.045223794217893, -10.184717501656088, 0.5106960781609242, -29.549499032894687, -21.54961249800448, -34.13923383896072, -20.267861872345602, -5.779767059539463, 17.017489273705927, -33.301651626323434, -0.576929208964593, 2.595848647895078, -5.2442647543214544, -7.940993439291571, -33.94077239944295, -27.404500500498543, -40.438746960867974, -61.10449463765307, -37.00465661714982, -4.35451273270401, -8.652356329869962, 2.3813164066330454, -19.539532212549368, -13.580681460395828, -15.0451765759666, -29.69916883739848, -25.05726778224764, 2.4810669290015532, -13.663438157511981, -28.87139530626842, -9.672404679952695, -23.596961029652398, -22.56860825499392, 4.068459789601089, -14.408681574108613, -8.784268198900005, -24.019056352075435, -3.6799348132677836, -5.205063072795436, -28.79401274974004, -13.342206982526786, -45.3024250966902, -27.348929740187888, -18.004484505315062, -19.504278169633906, -40.295735510287216, -0.3666105221757565, -10.697471256211838, -24.65105005502165, -23.425277696040997, 5.149983693519568, -54.17708384485578, -26.186348889696006, 1.1381832732256605, -6.085886619971946, -7.212002971484608, -16.7342491940537, 1.1456195161609992, -37.475717743379846, -29.731402580307677, -3.546861531437014, -36.13234512139836, -7.063984649465776, -21.518456083624667, -17.54008297587932, -2.993239847986402, 14.56642545768056, 5.219062080254258, -12.585776551761535, 16.221263716454235, -25.41737529939035], "policy_predator_policy_reward": [9.444421796305924, 41.73647351931656, 20.683202518078012, 10.362117297087227, 9.589173857025651, -5.7847094705239215, -2.6307935519212986, 9.038447818711877, -2.1750156681460577, 30.845692647540673, 20.06296456821927, -9.057032672425226, 37.444288316405164, 17.381665331703434, -5.5983098040776245, 43.15676638001032, 18.36165675827833, 5.943410804790695, 2.602868866553692, 45.601112096755294, 15.003736624420478, 17.413735566609276, 30.715066586516507, 30.428933549892804, 48.65262022168734, 15.714140095776774, 19.68751929151819, 13.514017955896332, 46.86622229218028, -5.045223794217893, 10.184717501656088, -0.5106960781609242, 29.549499032894687, 21.54961249800448, 34.13923383896072, 20.267861872345602, 5.779767059539463, -17.017489273705927, 33.301651626323434, 0.576929208964593, -2.595848647895078, 5.2442647543214544, 7.940993439291571, 33.94077239944295, 27.404500500498543, 40.438746960867974, 61.10449463765307, 37.00465661714982, 4.35451273270401, 8.652356329869962, -2.3813164066330454, 19.539532212549368, 13.580681460395828, 15.0451765759666, 29.69916883739848, 25.05726778224764, -2.4810669290015532, 13.663438157511981, 28.87139530626842, 9.672404679952695, 23.596961029652398, 22.56860825499392, -4.068459789601089, 14.408681574108613, 8.784268198900005, 24.019056352075435, 3.6799348132677836, 5.205063072795436, 28.79401274974004, 13.342206982526786, 45.3024250966902, 27.348929740187888, 18.004484505315062, 19.504278169633906, 40.295735510287216, 0.3666105221757565, 10.697471256211838, 24.65105005502165, 23.425277696040997, -5.149983693519568, 54.17708384485578, 26.186348889696006, -1.1381832732256605, 6.085886619971946, 7.212002971484608, 16.7342491940537, -1.1456195161609992, 37.475717743379846, 29.731402580307677, 3.546861531437014, 36.13234512139836, 7.063984649465776, 21.518456083624667, 17.54008297587932, 2.993239847986402, -14.56642545768056, -5.219062080254258, 12.585776551761535, -16.221263716454235, 25.41737529939035]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5364040074978615, "mean_inference_ms": 1.878679053389786, "mean_action_processing_ms": 0.2265673064034926, "mean_env_wait_ms": 0.14214585449899808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044373273849487305, "StateBufferConnector_ms": 0.003115057945251465, "ViewRequirementAgentConnector_ms": 0.08999145030975342}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 429.9257693783528, "num_env_steps_trained_throughput_per_sec": 429.9257693783528, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 9223.425, "restore_workers_time_ms": 0.017, "training_step_time_ms": 9223.261, "sample_time_ms": 1314.273, "learn_time_ms": 7859.403, "learn_throughput": 508.945, "synch_weights_time_ms": 47.139}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "training_iteration": 85, "trial_id": "1f352_00000", "date": "2024-08-11_15-08-42", "timestamp": 1723403322, "time_this_iter_s": 9.374428033828735, "time_total_s": 834.4718451499939, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af490af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 834.4718451499939, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 61.66153846153847, "ram_util_percent": 83.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.161850901382665, "cur_kl_coeff": 1.117587089538574e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.105334488550822, "policy_loss": -0.0031192477254080586, "vf_loss": 2.108453739558657, "vf_explained_var": 0.9248781215399504, "kl": 0.00337975119804076, "entropy": 0.35930500846977037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.179307993811866, "cur_kl_coeff": 0.0023437499999999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.125400756175319, "policy_loss": -0.002941206321702339, "vf_loss": 2.128327638159196, "vf_explained_var": 0.9232390788694222, "kl": 0.00611248180043857, "entropy": 0.5149441348078351, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -61.10449463765307, "predator_policy": -17.017489273705927}, "policy_reward_max": {"prey_policy": 17.017489273705927, "predator_policy": 61.10449463765307}, "policy_reward_mean": {"prey_policy": -17.0009309188922, "predator_policy": 17.0009309188922}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.602868866553692, -45.601112096755294, -15.003736624420478, -17.413735566609276, -30.715066586516507, -30.428933549892804, -48.65262022168734, -15.714140095776774, -19.68751929151819, -13.514017955896332, -46.86622229218028, 5.045223794217893, -10.184717501656088, 0.5106960781609242, -29.549499032894687, -21.54961249800448, -34.13923383896072, -20.267861872345602, -5.779767059539463, 17.017489273705927, -33.301651626323434, -0.576929208964593, 2.595848647895078, -5.2442647543214544, -7.940993439291571, -33.94077239944295, -27.404500500498543, -40.438746960867974, -61.10449463765307, -37.00465661714982, -4.35451273270401, -8.652356329869962, 2.3813164066330454, -19.539532212549368, -13.580681460395828, -15.0451765759666, -29.69916883739848, -25.05726778224764, 2.4810669290015532, -13.663438157511981, -28.87139530626842, -9.672404679952695, -23.596961029652398, -22.56860825499392, 4.068459789601089, -14.408681574108613, -8.784268198900005, -24.019056352075435, -3.6799348132677836, -5.205063072795436, -28.79401274974004, -13.342206982526786, -45.3024250966902, -27.348929740187888, -18.004484505315062, -19.504278169633906, -40.295735510287216, -0.3666105221757565, -10.697471256211838, -24.65105005502165, -23.425277696040997, 5.149983693519568, -54.17708384485578, -26.186348889696006, 1.1381832732256605, -6.085886619971946, -7.212002971484608, -16.7342491940537, 1.1456195161609992, -37.475717743379846, -29.731402580307677, -3.546861531437014, -36.13234512139836, -7.063984649465776, -21.518456083624667, -17.54008297587932, -2.993239847986402, 14.56642545768056, 5.219062080254258, -12.585776551761535, 16.221263716454235, -25.41737529939035, -42.73667486512908, -22.502312537004325, 1.206483194540768, -48.30408897907908, -15.261391796054673, -11.516759071362923, -9.340001393728796, -18.834253852332395, 2.681371741023293, -9.563503213810552, -16.705546407299032, -4.423858063422605, -15.160213053925217, -24.044631599046063, -18.711584958386993, -2.9264405276543712, -29.73151446919158, -10.599332038963176], "policy_predator_policy_reward": [2.602868866553692, 45.601112096755294, 15.003736624420478, 17.413735566609276, 30.715066586516507, 30.428933549892804, 48.65262022168734, 15.714140095776774, 19.68751929151819, 13.514017955896332, 46.86622229218028, -5.045223794217893, 10.184717501656088, -0.5106960781609242, 29.549499032894687, 21.54961249800448, 34.13923383896072, 20.267861872345602, 5.779767059539463, -17.017489273705927, 33.301651626323434, 0.576929208964593, -2.595848647895078, 5.2442647543214544, 7.940993439291571, 33.94077239944295, 27.404500500498543, 40.438746960867974, 61.10449463765307, 37.00465661714982, 4.35451273270401, 8.652356329869962, -2.3813164066330454, 19.539532212549368, 13.580681460395828, 15.0451765759666, 29.69916883739848, 25.05726778224764, -2.4810669290015532, 13.663438157511981, 28.87139530626842, 9.672404679952695, 23.596961029652398, 22.56860825499392, -4.068459789601089, 14.408681574108613, 8.784268198900005, 24.019056352075435, 3.6799348132677836, 5.205063072795436, 28.79401274974004, 13.342206982526786, 45.3024250966902, 27.348929740187888, 18.004484505315062, 19.504278169633906, 40.295735510287216, 0.3666105221757565, 10.697471256211838, 24.65105005502165, 23.425277696040997, -5.149983693519568, 54.17708384485578, 26.186348889696006, -1.1381832732256605, 6.085886619971946, 7.212002971484608, 16.7342491940537, -1.1456195161609992, 37.475717743379846, 29.731402580307677, 3.546861531437014, 36.13234512139836, 7.063984649465776, 21.518456083624667, 17.54008297587932, 2.993239847986402, -14.56642545768056, -5.219062080254258, 12.585776551761535, -16.221263716454235, 25.41737529939035, 42.73667486512908, 22.502312537004325, -1.206483194540768, 48.30408897907908, 15.261391796054673, 11.516759071362923, 9.340001393728796, 18.834253852332395, -2.681371741023293, 9.563503213810552, 16.705546407299032, 4.423858063422605, 15.160213053925217, 24.044631599046063, 18.711584958386993, 2.9264405276543712, 29.73151446919158, 10.599332038963176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5357022455234162, "mean_inference_ms": 1.8764468519552833, "mean_action_processing_ms": 0.22651852252156812, "mean_env_wait_ms": 0.14199043937052758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004104971885681152, "StateBufferConnector_ms": 0.002948760986328125, "ViewRequirementAgentConnector_ms": 0.07581567764282227}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 443.2803454080954, "num_env_steps_trained_throughput_per_sec": 443.2803454080954, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 9285.461, "restore_workers_time_ms": 0.019, "training_step_time_ms": 9285.309, "sample_time_ms": 1306.938, "learn_time_ms": 7928.65, "learn_throughput": 504.5, "synch_weights_time_ms": 47.309}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 86, "trial_id": "1f352_00000", "date": "2024-08-11_15-08-51", "timestamp": 1723403331, "time_this_iter_s": 9.052090883255005, "time_total_s": 843.5239360332489, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1890550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 843.5239360332489, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 57.60000000000001, "ram_util_percent": 83.21538461538461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.899617368231217, "cur_kl_coeff": 5.58793544769287e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1109980545938014, "policy_loss": -0.002008035906571119, "vf_loss": 1.1130060956502954, "vf_explained_var": 0.9759856003647049, "kl": 0.014285912198658284, "entropy": 0.255149181606248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.985446588632961, "cur_kl_coeff": 0.0023437499999999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0922854653249183, "policy_loss": -0.0027120299802239362, "vf_loss": 1.0949846889823676, "vf_explained_var": 0.9771084352085988, "kl": 0.005464819650982023, "entropy": 0.48344874009490013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -61.10449463765307, "predator_policy": -16.221263716454235}, "policy_reward_max": {"prey_policy": 16.221263716454235, "predator_policy": 61.10449463765307}, "policy_reward_mean": {"prey_policy": -16.085004875885808, "predator_policy": 16.085004875885808}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-5.2442647543214544, -7.940993439291571, -33.94077239944295, -27.404500500498543, -40.438746960867974, -61.10449463765307, -37.00465661714982, -4.35451273270401, -8.652356329869962, 2.3813164066330454, -19.539532212549368, -13.580681460395828, -15.0451765759666, -29.69916883739848, -25.05726778224764, 2.4810669290015532, -13.663438157511981, -28.87139530626842, -9.672404679952695, -23.596961029652398, -22.56860825499392, 4.068459789601089, -14.408681574108613, -8.784268198900005, -24.019056352075435, -3.6799348132677836, -5.205063072795436, -28.79401274974004, -13.342206982526786, -45.3024250966902, -27.348929740187888, -18.004484505315062, -19.504278169633906, -40.295735510287216, -0.3666105221757565, -10.697471256211838, -24.65105005502165, -23.425277696040997, 5.149983693519568, -54.17708384485578, -26.186348889696006, 1.1381832732256605, -6.085886619971946, -7.212002971484608, -16.7342491940537, 1.1456195161609992, -37.475717743379846, -29.731402580307677, -3.546861531437014, -36.13234512139836, -7.063984649465776, -21.518456083624667, -17.54008297587932, -2.993239847986402, 14.56642545768056, 5.219062080254258, -12.585776551761535, 16.221263716454235, -25.41737529939035, -42.73667486512908, -22.502312537004325, 1.206483194540768, -48.30408897907908, -15.261391796054673, -11.516759071362923, -9.340001393728796, -18.834253852332395, 2.681371741023293, -9.563503213810552, -16.705546407299032, -4.423858063422605, -15.160213053925217, -24.044631599046063, -18.711584958386993, -2.9264405276543712, -29.73151446919158, -10.599332038963176, -12.658489180244478, -11.087712518226207, -1.985591000307016, -15.845000130526774, -26.92523056842914, -1.078993277410552, -13.541513372879756, -14.701770527314498, -28.433027081949295, -43.444895072115884, -17.825783705184918, 7.767036171780603, -16.262621652504038, -12.585453247675474, 10.39062136342326, -15.986954946674679, 9.646585247751675, -3.8315457998375297, -14.727729560495355, -23.406275505497455, -5.0695493998654495, -32.78460007731819, -40.40888985037538], "policy_predator_policy_reward": [5.2442647543214544, 7.940993439291571, 33.94077239944295, 27.404500500498543, 40.438746960867974, 61.10449463765307, 37.00465661714982, 4.35451273270401, 8.652356329869962, -2.3813164066330454, 19.539532212549368, 13.580681460395828, 15.0451765759666, 29.69916883739848, 25.05726778224764, -2.4810669290015532, 13.663438157511981, 28.87139530626842, 9.672404679952695, 23.596961029652398, 22.56860825499392, -4.068459789601089, 14.408681574108613, 8.784268198900005, 24.019056352075435, 3.6799348132677836, 5.205063072795436, 28.79401274974004, 13.342206982526786, 45.3024250966902, 27.348929740187888, 18.004484505315062, 19.504278169633906, 40.295735510287216, 0.3666105221757565, 10.697471256211838, 24.65105005502165, 23.425277696040997, -5.149983693519568, 54.17708384485578, 26.186348889696006, -1.1381832732256605, 6.085886619971946, 7.212002971484608, 16.7342491940537, -1.1456195161609992, 37.475717743379846, 29.731402580307677, 3.546861531437014, 36.13234512139836, 7.063984649465776, 21.518456083624667, 17.54008297587932, 2.993239847986402, -14.56642545768056, -5.219062080254258, 12.585776551761535, -16.221263716454235, 25.41737529939035, 42.73667486512908, 22.502312537004325, -1.206483194540768, 48.30408897907908, 15.261391796054673, 11.516759071362923, 9.340001393728796, 18.834253852332395, -2.681371741023293, 9.563503213810552, 16.705546407299032, 4.423858063422605, 15.160213053925217, 24.044631599046063, 18.711584958386993, 2.9264405276543712, 29.73151446919158, 10.599332038963176, 12.658489180244478, 11.087712518226207, 1.985591000307016, 15.845000130526774, 26.92523056842914, 1.078993277410552, 13.541513372879756, 14.701770527314498, 28.433027081949295, 43.444895072115884, 17.825783705184918, -7.767036171780603, 16.262621652504038, 12.585453247675474, -10.39062136342326, 15.986954946674679, -9.646585247751675, 3.8315457998375297, 14.727729560495355, 23.406275505497455, 5.0695493998654495, 32.78460007731819, 40.40888985037538]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5352724123587194, "mean_inference_ms": 1.875560054793709, "mean_action_processing_ms": 0.22654200168885588, "mean_env_wait_ms": 0.14195000515484107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041141510009765625, "StateBufferConnector_ms": 0.0037409067153930664, "ViewRequirementAgentConnector_ms": 0.08747684955596924}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 419.4202080889434, "num_env_steps_trained_throughput_per_sec": 419.4202080889434, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 9304.881, "restore_workers_time_ms": 0.018, "training_step_time_ms": 9304.631, "sample_time_ms": 1327.826, "learn_time_ms": 7927.841, "learn_throughput": 504.551, "synch_weights_time_ms": 46.962}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "training_iteration": 87, "trial_id": "1f352_00000", "date": "2024-08-11_15-09-01", "timestamp": 1723403341, "time_this_iter_s": 9.595155000686646, "time_total_s": 853.1190910339355, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b18a6c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 853.1190910339355, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 57.021428571428565, "ram_util_percent": 83.32857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6042445316910743, "cur_kl_coeff": 5.58793544769287e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9817427304883797, "policy_loss": -0.004690761474679069, "vf_loss": 2.986433494463563, "vf_explained_var": 0.9293342187379797, "kl": 0.014309098412132926, "entropy": 0.5048797049249212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5725996319825453, "cur_kl_coeff": 0.0023437499999999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9824229730914036, "policy_loss": -0.005867638440880303, "vf_loss": 2.9882532936831314, "vf_explained_var": 0.9297366154069702, "kl": 0.015922210541140507, "entropy": 0.48786409736300507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.17708384485578, "predator_policy": -16.221263716454235}, "policy_reward_max": {"prey_policy": 16.221263716454235, "predator_policy": 54.17708384485578}, "policy_reward_mean": {"prey_policy": -16.346653894630467, "predator_policy": 16.346653894630467}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.672404679952695, -23.596961029652398, -22.56860825499392, 4.068459789601089, -14.408681574108613, -8.784268198900005, -24.019056352075435, -3.6799348132677836, -5.205063072795436, -28.79401274974004, -13.342206982526786, -45.3024250966902, -27.348929740187888, -18.004484505315062, -19.504278169633906, -40.295735510287216, -0.3666105221757565, -10.697471256211838, -24.65105005502165, -23.425277696040997, 5.149983693519568, -54.17708384485578, -26.186348889696006, 1.1381832732256605, -6.085886619971946, -7.212002971484608, -16.7342491940537, 1.1456195161609992, -37.475717743379846, -29.731402580307677, -3.546861531437014, -36.13234512139836, -7.063984649465776, -21.518456083624667, -17.54008297587932, -2.993239847986402, 14.56642545768056, 5.219062080254258, -12.585776551761535, 16.221263716454235, -25.41737529939035, -42.73667486512908, -22.502312537004325, 1.206483194540768, -48.30408897907908, -15.261391796054673, -11.516759071362923, -9.340001393728796, -18.834253852332395, 2.681371741023293, -9.563503213810552, -16.705546407299032, -4.423858063422605, -15.160213053925217, -24.044631599046063, -18.711584958386993, -2.9264405276543712, -29.73151446919158, -10.599332038963176, -12.658489180244478, -11.087712518226207, -1.985591000307016, -15.845000130526774, -26.92523056842914, -1.078993277410552, -13.541513372879756, -14.701770527314498, -28.433027081949295, -43.444895072115884, -17.825783705184918, 7.767036171780603, -16.262621652504038, -12.585453247675474, 10.39062136342326, -15.986954946674679, 9.646585247751675, -3.8315457998375297, -14.727729560495355, -23.406275505497455, -5.0695493998654495, -32.78460007731819, -40.40888985037538, -5.188833920128843, -22.408261063042552, -30.756829761921853, -21.117342744034254, -0.6809990394270242, -31.357736655026017, -16.821310584066733, -24.343159643644046, -37.21374182987302, -8.911668461944197, -14.054995429436282, -31.004967283157846, -40.50023282936148, -7.365703579325599, -38.945246152153544, -35.87652107610715, 9.472849568122511, -35.76977675844127], "policy_predator_policy_reward": [9.672404679952695, 23.596961029652398, 22.56860825499392, -4.068459789601089, 14.408681574108613, 8.784268198900005, 24.019056352075435, 3.6799348132677836, 5.205063072795436, 28.79401274974004, 13.342206982526786, 45.3024250966902, 27.348929740187888, 18.004484505315062, 19.504278169633906, 40.295735510287216, 0.3666105221757565, 10.697471256211838, 24.65105005502165, 23.425277696040997, -5.149983693519568, 54.17708384485578, 26.186348889696006, -1.1381832732256605, 6.085886619971946, 7.212002971484608, 16.7342491940537, -1.1456195161609992, 37.475717743379846, 29.731402580307677, 3.546861531437014, 36.13234512139836, 7.063984649465776, 21.518456083624667, 17.54008297587932, 2.993239847986402, -14.56642545768056, -5.219062080254258, 12.585776551761535, -16.221263716454235, 25.41737529939035, 42.73667486512908, 22.502312537004325, -1.206483194540768, 48.30408897907908, 15.261391796054673, 11.516759071362923, 9.340001393728796, 18.834253852332395, -2.681371741023293, 9.563503213810552, 16.705546407299032, 4.423858063422605, 15.160213053925217, 24.044631599046063, 18.711584958386993, 2.9264405276543712, 29.73151446919158, 10.599332038963176, 12.658489180244478, 11.087712518226207, 1.985591000307016, 15.845000130526774, 26.92523056842914, 1.078993277410552, 13.541513372879756, 14.701770527314498, 28.433027081949295, 43.444895072115884, 17.825783705184918, -7.767036171780603, 16.262621652504038, 12.585453247675474, -10.39062136342326, 15.986954946674679, -9.646585247751675, 3.8315457998375297, 14.727729560495355, 23.406275505497455, 5.0695493998654495, 32.78460007731819, 40.40888985037538, 5.188833920128843, 22.408261063042552, 30.756829761921853, 21.117342744034254, 0.6809990394270242, 31.357736655026017, 16.821310584066733, 24.343159643644046, 37.21374182987302, 8.911668461944197, 14.054995429436282, 31.004967283157846, 40.50023282936148, 7.365703579325599, 38.945246152153544, 35.87652107610715, -9.472849568122511, 35.76977675844127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5351049644701176, "mean_inference_ms": 1.8748770301033177, "mean_action_processing_ms": 0.2265867192264944, "mean_env_wait_ms": 0.14193577283379483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034672021865844727, "StateBufferConnector_ms": 0.0035971403121948242, "ViewRequirementAgentConnector_ms": 0.09113514423370361}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 429.31537579479067, "num_env_steps_trained_throughput_per_sec": 429.31537579479067, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 9377.698, "restore_workers_time_ms": 0.019, "training_step_time_ms": 9377.352, "sample_time_ms": 1392.053, "learn_time_ms": 7925.361, "learn_throughput": 504.709, "synch_weights_time_ms": 57.506}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 88, "trial_id": "1f352_00000", "date": "2024-08-11_15-09-10", "timestamp": 1723403350, "time_this_iter_s": 9.393688917160034, "time_total_s": 862.5127799510956, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1af1430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 862.5127799510956, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 57.130769230769225, "ram_util_percent": 83.04615384615386}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.505954246968031, "cur_kl_coeff": 5.58793544769287e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4048934263487656, "policy_loss": -0.0036523647446301765, "vf_loss": 3.4085457923511666, "vf_explained_var": 0.888633752738436, "kl": 0.008458836027468943, "entropy": 0.4580883415415883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5963671877980232, "cur_kl_coeff": 0.0023437499999999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4159774276117485, "policy_loss": -0.0046315817953048585, "vf_loss": 3.4205998135109743, "vf_explained_var": 0.8879908201595147, "kl": 0.003929136327466074, "entropy": 0.4717115626980861, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -48.30408897907908, "predator_policy": -16.221263716454235}, "policy_reward_max": {"prey_policy": 16.221263716454235, "predator_policy": 48.30408897907908}, "policy_reward_mean": {"prey_policy": -16.045700833046777, "predator_policy": 16.045700833046777}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.186348889696006, 1.1381832732256605, -6.085886619971946, -7.212002971484608, -16.7342491940537, 1.1456195161609992, -37.475717743379846, -29.731402580307677, -3.546861531437014, -36.13234512139836, -7.063984649465776, -21.518456083624667, -17.54008297587932, -2.993239847986402, 14.56642545768056, 5.219062080254258, -12.585776551761535, 16.221263716454235, -25.41737529939035, -42.73667486512908, -22.502312537004325, 1.206483194540768, -48.30408897907908, -15.261391796054673, -11.516759071362923, -9.340001393728796, -18.834253852332395, 2.681371741023293, -9.563503213810552, -16.705546407299032, -4.423858063422605, -15.160213053925217, -24.044631599046063, -18.711584958386993, -2.9264405276543712, -29.73151446919158, -10.599332038963176, -12.658489180244478, -11.087712518226207, -1.985591000307016, -15.845000130526774, -26.92523056842914, -1.078993277410552, -13.541513372879756, -14.701770527314498, -28.433027081949295, -43.444895072115884, -17.825783705184918, 7.767036171780603, -16.262621652504038, -12.585453247675474, 10.39062136342326, -15.986954946674679, 9.646585247751675, -3.8315457998375297, -14.727729560495355, -23.406275505497455, -5.0695493998654495, -32.78460007731819, -40.40888985037538, -5.188833920128843, -22.408261063042552, -30.756829761921853, -21.117342744034254, -0.6809990394270242, -31.357736655026017, -16.821310584066733, -24.343159643644046, -37.21374182987302, -8.911668461944197, -14.054995429436282, -31.004967283157846, -40.50023282936148, -7.365703579325599, -38.945246152153544, -35.87652107610715, 9.472849568122511, -35.76977675844127, -17.39146764362996, -13.910120708201344, -16.550978998334813, -29.2145557780089, -9.594999688963453, -11.786617996321318, -12.93627915323428, -5.836446786436168, -37.793300153020084, -14.519841968126018, -7.06275092116159, -4.575463014580993, -18.886814075797645, -23.24552175837439, -19.28177775837753, -19.924753300290917, -37.83377872158483, -39.29529094420029, -11.316636980014053, -3.677403583805611, -13.596227173295405, -10.299767357184011], "policy_predator_policy_reward": [26.186348889696006, -1.1381832732256605, 6.085886619971946, 7.212002971484608, 16.7342491940537, -1.1456195161609992, 37.475717743379846, 29.731402580307677, 3.546861531437014, 36.13234512139836, 7.063984649465776, 21.518456083624667, 17.54008297587932, 2.993239847986402, -14.56642545768056, -5.219062080254258, 12.585776551761535, -16.221263716454235, 25.41737529939035, 42.73667486512908, 22.502312537004325, -1.206483194540768, 48.30408897907908, 15.261391796054673, 11.516759071362923, 9.340001393728796, 18.834253852332395, -2.681371741023293, 9.563503213810552, 16.705546407299032, 4.423858063422605, 15.160213053925217, 24.044631599046063, 18.711584958386993, 2.9264405276543712, 29.73151446919158, 10.599332038963176, 12.658489180244478, 11.087712518226207, 1.985591000307016, 15.845000130526774, 26.92523056842914, 1.078993277410552, 13.541513372879756, 14.701770527314498, 28.433027081949295, 43.444895072115884, 17.825783705184918, -7.767036171780603, 16.262621652504038, 12.585453247675474, -10.39062136342326, 15.986954946674679, -9.646585247751675, 3.8315457998375297, 14.727729560495355, 23.406275505497455, 5.0695493998654495, 32.78460007731819, 40.40888985037538, 5.188833920128843, 22.408261063042552, 30.756829761921853, 21.117342744034254, 0.6809990394270242, 31.357736655026017, 16.821310584066733, 24.343159643644046, 37.21374182987302, 8.911668461944197, 14.054995429436282, 31.004967283157846, 40.50023282936148, 7.365703579325599, 38.945246152153544, 35.87652107610715, -9.472849568122511, 35.76977675844127, 17.39146764362996, 13.910120708201344, 16.550978998334813, 29.2145557780089, 9.594999688963453, 11.786617996321318, 12.93627915323428, 5.836446786436168, 37.793300153020084, 14.519841968126018, 7.06275092116159, 4.575463014580993, 18.886814075797645, 23.24552175837439, 19.28177775837753, 19.924753300290917, 37.83377872158483, 39.29529094420029, 11.316636980014053, 3.677403583805611, 13.596227173295405, 10.299767357184011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5373844655702604, "mean_inference_ms": 1.882300801854612, "mean_action_processing_ms": 0.2279382296320983, "mean_env_wait_ms": 0.14258319068457773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035173892974853516, "StateBufferConnector_ms": 0.0035549402236938477, "ViewRequirementAgentConnector_ms": 0.08911514282226562}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 458.4272973778526, "num_env_steps_trained_throughput_per_sec": 458.4272973778526, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 712000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 712000, "timers": {"training_iteration_time_ms": 9379.612, "restore_workers_time_ms": 0.019, "training_step_time_ms": 9379.264, "sample_time_ms": 1340.034, "learn_time_ms": 7978.859, "learn_throughput": 501.325, "synch_weights_time_ms": 57.928}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "done": false, "training_iteration": 89, "trial_id": "1f352_00000", "date": "2024-08-11_15-09-19", "timestamp": 1723403359, "time_this_iter_s": 8.777659177780151, "time_total_s": 871.2904391288757, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1890550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 871.2904391288757, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 52.876923076923084, "ram_util_percent": 82.95384615384616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.518372523287932, "cur_kl_coeff": 5.58793544769287e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5569492891430854, "policy_loss": -0.003955514504438421, "vf_loss": 2.560904803375403, "vf_explained_var": 0.9466395567481717, "kl": 0.008008194022683346, "entropy": 0.4494410657323897, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.512474982999265, "cur_kl_coeff": 0.0011718749999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.602176552141706, "policy_loss": -0.0019462183823634404, "vf_loss": 2.6041182328015564, "vf_explained_var": 0.9458804618567228, "kl": 0.003870959828433988, "entropy": 0.4910402402902643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -48.30408897907908, "predator_policy": -10.39062136342326}, "policy_reward_max": {"prey_policy": 10.39062136342326, "predator_policy": 48.30408897907908}, "policy_reward_mean": {"prey_policy": -17.905913994932806, "predator_policy": 17.905913994932806}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-25.41737529939035, -42.73667486512908, -22.502312537004325, 1.206483194540768, -48.30408897907908, -15.261391796054673, -11.516759071362923, -9.340001393728796, -18.834253852332395, 2.681371741023293, -9.563503213810552, -16.705546407299032, -4.423858063422605, -15.160213053925217, -24.044631599046063, -18.711584958386993, -2.9264405276543712, -29.73151446919158, -10.599332038963176, -12.658489180244478, -11.087712518226207, -1.985591000307016, -15.845000130526774, -26.92523056842914, -1.078993277410552, -13.541513372879756, -14.701770527314498, -28.433027081949295, -43.444895072115884, -17.825783705184918, 7.767036171780603, -16.262621652504038, -12.585453247675474, 10.39062136342326, -15.986954946674679, 9.646585247751675, -3.8315457998375297, -14.727729560495355, -23.406275505497455, -5.0695493998654495, -32.78460007731819, -40.40888985037538, -5.188833920128843, -22.408261063042552, -30.756829761921853, -21.117342744034254, -0.6809990394270242, -31.357736655026017, -16.821310584066733, -24.343159643644046, -37.21374182987302, -8.911668461944197, -14.054995429436282, -31.004967283157846, -40.50023282936148, -7.365703579325599, -38.945246152153544, -35.87652107610715, 9.472849568122511, -35.76977675844127, -17.39146764362996, -13.910120708201344, -16.550978998334813, -29.2145557780089, -9.594999688963453, -11.786617996321318, -12.93627915323428, -5.836446786436168, -37.793300153020084, -14.519841968126018, -7.06275092116159, -4.575463014580993, -18.886814075797645, -23.24552175837439, -19.28177775837753, -19.924753300290917, -37.83377872158483, -39.29529094420029, -11.316636980014053, -3.677403583805611, -13.596227173295405, -10.299767357184011, -28.375883586741075, -37.17384704336488, -7.238172687246507, -24.743046896518813, -31.438370241473084, -20.010664383424114, -33.9751473772797, -23.35625296164458, -10.46490132839286, -29.563736450288403, -12.443908058620838, -12.24143418765153, -3.039348546966494, -23.702909725270995, 2.033487478915996, -24.323439801328625, -24.095601614081907, -28.38393949389564], "policy_predator_policy_reward": [25.41737529939035, 42.73667486512908, 22.502312537004325, -1.206483194540768, 48.30408897907908, 15.261391796054673, 11.516759071362923, 9.340001393728796, 18.834253852332395, -2.681371741023293, 9.563503213810552, 16.705546407299032, 4.423858063422605, 15.160213053925217, 24.044631599046063, 18.711584958386993, 2.9264405276543712, 29.73151446919158, 10.599332038963176, 12.658489180244478, 11.087712518226207, 1.985591000307016, 15.845000130526774, 26.92523056842914, 1.078993277410552, 13.541513372879756, 14.701770527314498, 28.433027081949295, 43.444895072115884, 17.825783705184918, -7.767036171780603, 16.262621652504038, 12.585453247675474, -10.39062136342326, 15.986954946674679, -9.646585247751675, 3.8315457998375297, 14.727729560495355, 23.406275505497455, 5.0695493998654495, 32.78460007731819, 40.40888985037538, 5.188833920128843, 22.408261063042552, 30.756829761921853, 21.117342744034254, 0.6809990394270242, 31.357736655026017, 16.821310584066733, 24.343159643644046, 37.21374182987302, 8.911668461944197, 14.054995429436282, 31.004967283157846, 40.50023282936148, 7.365703579325599, 38.945246152153544, 35.87652107610715, -9.472849568122511, 35.76977675844127, 17.39146764362996, 13.910120708201344, 16.550978998334813, 29.2145557780089, 9.594999688963453, 11.786617996321318, 12.93627915323428, 5.836446786436168, 37.793300153020084, 14.519841968126018, 7.06275092116159, 4.575463014580993, 18.886814075797645, 23.24552175837439, 19.28177775837753, 19.924753300290917, 37.83377872158483, 39.29529094420029, 11.316636980014053, 3.677403583805611, 13.596227173295405, 10.299767357184011, 28.375883586741075, 37.17384704336488, 7.238172687246507, 24.743046896518813, 31.438370241473084, 20.010664383424114, 33.9751473772797, 23.35625296164458, 10.46490132839286, 29.563736450288403, 12.443908058620838, 12.24143418765153, 3.039348546966494, 23.702909725270995, -2.033487478915996, 24.323439801328625, 24.095601614081907, 28.38393949389564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.534335840756231, "mean_inference_ms": 1.8708761305449242, "mean_action_processing_ms": 0.22621280379218653, "mean_env_wait_ms": 0.1416920053080825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035871267318725586, "StateBufferConnector_ms": 0.004093527793884277, "ViewRequirementAgentConnector_ms": 0.08784294128417969}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 401.0858176331666, "num_env_steps_trained_throughput_per_sec": 401.0858176331666, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 9402.178, "restore_workers_time_ms": 0.021, "training_step_time_ms": 9401.761, "sample_time_ms": 1324.681, "learn_time_ms": 8018.21, "learn_throughput": 498.864, "synch_weights_time_ms": 56.257}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 90, "trial_id": "1f352_00000", "date": "2024-08-11_15-09-29", "timestamp": 1723403369, "time_this_iter_s": 10.035810232162476, "time_total_s": 881.3262493610382, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a380d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 881.3262493610382, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 60.207142857142856, "ram_util_percent": 83.14285714285712}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9963137892385325, "cur_kl_coeff": 5.58793544769287e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1847993419816096, "policy_loss": -0.0033072289030921334, "vf_loss": 3.188106565674146, "vf_explained_var": 0.9249248552446564, "kl": 0.005463226845071034, "entropy": 0.5332966651767492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.917430683225393, "cur_kl_coeff": 0.0005859374999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.170786275466283, "policy_loss": -0.004136577415435264, "vf_loss": 3.1749181687831878, "vf_explained_var": 0.9283663267269731, "kl": 0.007976032823679318, "entropy": 0.5036657320956389, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -45.028940793696336, "predator_policy": -12.633696196002921}, "policy_reward_max": {"prey_policy": 12.633696196002921, "predator_policy": 45.028940793696336}, "policy_reward_mean": {"prey_policy": -18.894583396162496, "predator_policy": 18.894583396162496}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.92523056842914, -1.078993277410552, -13.541513372879756, -14.701770527314498, -28.433027081949295, -43.444895072115884, -17.825783705184918, 7.767036171780603, -16.262621652504038, -12.585453247675474, 10.39062136342326, -15.986954946674679, 9.646585247751675, -3.8315457998375297, -14.727729560495355, -23.406275505497455, -5.0695493998654495, -32.78460007731819, -40.40888985037538, -5.188833920128843, -22.408261063042552, -30.756829761921853, -21.117342744034254, -0.6809990394270242, -31.357736655026017, -16.821310584066733, -24.343159643644046, -37.21374182987302, -8.911668461944197, -14.054995429436282, -31.004967283157846, -40.50023282936148, -7.365703579325599, -38.945246152153544, -35.87652107610715, 9.472849568122511, -35.76977675844127, -17.39146764362996, -13.910120708201344, -16.550978998334813, -29.2145557780089, -9.594999688963453, -11.786617996321318, -12.93627915323428, -5.836446786436168, -37.793300153020084, -14.519841968126018, -7.06275092116159, -4.575463014580993, -18.886814075797645, -23.24552175837439, -19.28177775837753, -19.924753300290917, -37.83377872158483, -39.29529094420029, -11.316636980014053, -3.677403583805611, -13.596227173295405, -10.299767357184011, -28.375883586741075, -37.17384704336488, -7.238172687246507, -24.743046896518813, -31.438370241473084, -20.010664383424114, -33.9751473772797, -23.35625296164458, -10.46490132839286, -29.563736450288403, -12.443908058620838, -12.24143418765153, -3.039348546966494, -23.702909725270995, 2.033487478915996, -24.323439801328625, -24.095601614081907, -28.38393949389564, -43.58520595532474, -15.846574703213914, -6.15826245188298, -20.385571057783483, -11.446953346539422, -32.758476361921346, -14.404421480412132, -32.65888528680747, 2.1910707790517208, -4.793442642735871, -16.38854465436479, -13.070515890126824, -6.914604268295216, -4.793677151446687, -36.938181179004765, -34.68008222380893, -45.028940793696336, -37.06588492701298, -38.750378130658866, -24.272011312460176, 12.633696196002921, -24.54771290118731, -12.671800398861425], "policy_predator_policy_reward": [26.92523056842914, 1.078993277410552, 13.541513372879756, 14.701770527314498, 28.433027081949295, 43.444895072115884, 17.825783705184918, -7.767036171780603, 16.262621652504038, 12.585453247675474, -10.39062136342326, 15.986954946674679, -9.646585247751675, 3.8315457998375297, 14.727729560495355, 23.406275505497455, 5.0695493998654495, 32.78460007731819, 40.40888985037538, 5.188833920128843, 22.408261063042552, 30.756829761921853, 21.117342744034254, 0.6809990394270242, 31.357736655026017, 16.821310584066733, 24.343159643644046, 37.21374182987302, 8.911668461944197, 14.054995429436282, 31.004967283157846, 40.50023282936148, 7.365703579325599, 38.945246152153544, 35.87652107610715, -9.472849568122511, 35.76977675844127, 17.39146764362996, 13.910120708201344, 16.550978998334813, 29.2145557780089, 9.594999688963453, 11.786617996321318, 12.93627915323428, 5.836446786436168, 37.793300153020084, 14.519841968126018, 7.06275092116159, 4.575463014580993, 18.886814075797645, 23.24552175837439, 19.28177775837753, 19.924753300290917, 37.83377872158483, 39.29529094420029, 11.316636980014053, 3.677403583805611, 13.596227173295405, 10.299767357184011, 28.375883586741075, 37.17384704336488, 7.238172687246507, 24.743046896518813, 31.438370241473084, 20.010664383424114, 33.9751473772797, 23.35625296164458, 10.46490132839286, 29.563736450288403, 12.443908058620838, 12.24143418765153, 3.039348546966494, 23.702909725270995, -2.033487478915996, 24.323439801328625, 24.095601614081907, 28.38393949389564, 43.58520595532474, 15.846574703213914, 6.15826245188298, 20.385571057783483, 11.446953346539422, 32.758476361921346, 14.404421480412132, 32.65888528680747, -2.1910707790517208, 4.793442642735871, 16.38854465436479, 13.070515890126824, 6.914604268295216, 4.793677151446687, 36.938181179004765, 34.68008222380893, 45.028940793696336, 37.06588492701298, 38.750378130658866, 24.272011312460176, -12.633696196002921, 24.54771290118731, 12.671800398861425]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5352153205614114, "mean_inference_ms": 1.8702380298271997, "mean_action_processing_ms": 0.22623301184372926, "mean_env_wait_ms": 0.14163388772297675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005054116249084473, "StateBufferConnector_ms": 0.004240274429321289, "ViewRequirementAgentConnector_ms": 0.09085845947265625}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 453.48594757665063, "num_env_steps_trained_throughput_per_sec": 453.48594757665063, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 728000, "timers": {"training_iteration_time_ms": 9379.533, "restore_workers_time_ms": 0.021, "training_step_time_ms": 9379.154, "sample_time_ms": 1307.243, "learn_time_ms": 8021.538, "learn_throughput": 498.657, "synch_weights_time_ms": 47.711}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "done": false, "training_iteration": 91, "trial_id": "1f352_00000", "date": "2024-08-11_15-09-38", "timestamp": 1723403378, "time_this_iter_s": 8.850966930389404, "time_total_s": 890.1772162914276, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b188ea60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 890.1772162914276, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 52.35384615384616, "ram_util_percent": 83.34615384615384}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.586808031300704, "cur_kl_coeff": 5.58793544769287e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.908587707206607, "policy_loss": -0.0032358675908956986, "vf_loss": 2.911823569238186, "vf_explained_var": 0.9297410233567158, "kl": 0.004218473499179254, "entropy": 0.4091236276862522, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.568542156120141, "cur_kl_coeff": 0.0005859374999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.837765740851561, "policy_loss": -0.0025956689583836122, "vf_loss": 2.8403581462800505, "vf_explained_var": 0.9310658293465773, "kl": 0.005568028054733208, "entropy": 0.4837134041513006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -58.64029928563584, "predator_policy": -12.633696196002921}, "policy_reward_max": {"prey_policy": 12.633696196002921, "predator_policy": 58.64029928563584}, "policy_reward_mean": {"prey_policy": -19.873941747244096, "predator_policy": 19.873941747244096}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-40.40888985037538, -5.188833920128843, -22.408261063042552, -30.756829761921853, -21.117342744034254, -0.6809990394270242, -31.357736655026017, -16.821310584066733, -24.343159643644046, -37.21374182987302, -8.911668461944197, -14.054995429436282, -31.004967283157846, -40.50023282936148, -7.365703579325599, -38.945246152153544, -35.87652107610715, 9.472849568122511, -35.76977675844127, -17.39146764362996, -13.910120708201344, -16.550978998334813, -29.2145557780089, -9.594999688963453, -11.786617996321318, -12.93627915323428, -5.836446786436168, -37.793300153020084, -14.519841968126018, -7.06275092116159, -4.575463014580993, -18.886814075797645, -23.24552175837439, -19.28177775837753, -19.924753300290917, -37.83377872158483, -39.29529094420029, -11.316636980014053, -3.677403583805611, -13.596227173295405, -10.299767357184011, -28.375883586741075, -37.17384704336488, -7.238172687246507, -24.743046896518813, -31.438370241473084, -20.010664383424114, -33.9751473772797, -23.35625296164458, -10.46490132839286, -29.563736450288403, -12.443908058620838, -12.24143418765153, -3.039348546966494, -23.702909725270995, 2.033487478915996, -24.323439801328625, -24.095601614081907, -28.38393949389564, -43.58520595532474, -15.846574703213914, -6.15826245188298, -20.385571057783483, -11.446953346539422, -32.758476361921346, -14.404421480412132, -32.65888528680747, 2.1910707790517208, -4.793442642735871, -16.38854465436479, -13.070515890126824, -6.914604268295216, -4.793677151446687, -36.938181179004765, -34.68008222380893, -45.028940793696336, -37.06588492701298, -38.750378130658866, -24.272011312460176, 12.633696196002921, -24.54771290118731, -12.671800398861425, -33.000509360245374, -2.9387158811529925, -58.64029928563584, -18.91841702756564, -30.76381199763206, -20.042488538261015, -4.107070653960205, -42.20031572738206, -12.926156893064244, -23.472212785703363, -39.37200638198248, -19.683701081916613, -3.136340498016516, -14.114676414874117, -1.7576034148309763, -1.670348370480588, -10.986443314307936, -3.0064184933445333], "policy_predator_policy_reward": [40.40888985037538, 5.188833920128843, 22.408261063042552, 30.756829761921853, 21.117342744034254, 0.6809990394270242, 31.357736655026017, 16.821310584066733, 24.343159643644046, 37.21374182987302, 8.911668461944197, 14.054995429436282, 31.004967283157846, 40.50023282936148, 7.365703579325599, 38.945246152153544, 35.87652107610715, -9.472849568122511, 35.76977675844127, 17.39146764362996, 13.910120708201344, 16.550978998334813, 29.2145557780089, 9.594999688963453, 11.786617996321318, 12.93627915323428, 5.836446786436168, 37.793300153020084, 14.519841968126018, 7.06275092116159, 4.575463014580993, 18.886814075797645, 23.24552175837439, 19.28177775837753, 19.924753300290917, 37.83377872158483, 39.29529094420029, 11.316636980014053, 3.677403583805611, 13.596227173295405, 10.299767357184011, 28.375883586741075, 37.17384704336488, 7.238172687246507, 24.743046896518813, 31.438370241473084, 20.010664383424114, 33.9751473772797, 23.35625296164458, 10.46490132839286, 29.563736450288403, 12.443908058620838, 12.24143418765153, 3.039348546966494, 23.702909725270995, -2.033487478915996, 24.323439801328625, 24.095601614081907, 28.38393949389564, 43.58520595532474, 15.846574703213914, 6.15826245188298, 20.385571057783483, 11.446953346539422, 32.758476361921346, 14.404421480412132, 32.65888528680747, -2.1910707790517208, 4.793442642735871, 16.38854465436479, 13.070515890126824, 6.914604268295216, 4.793677151446687, 36.938181179004765, 34.68008222380893, 45.028940793696336, 37.06588492701298, 38.750378130658866, 24.272011312460176, -12.633696196002921, 24.54771290118731, 12.671800398861425, 33.000509360245374, 2.9387158811529925, 58.64029928563584, 18.91841702756564, 30.76381199763206, 20.042488538261015, 4.107070653960205, 42.20031572738206, 12.926156893064244, 23.472212785703363, 39.37200638198248, 19.683701081916613, 3.136340498016516, 14.114676414874117, 1.7576034148309763, 1.670348370480588, 10.986443314307936, 3.0064184933445333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5339463295661869, "mean_inference_ms": 1.8669080217127, "mean_action_processing_ms": 0.22578263332882498, "mean_env_wait_ms": 0.14134105572006017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007998824119567871, "StateBufferConnector_ms": 0.0033298730850219727, "ViewRequirementAgentConnector_ms": 0.08717989921569824}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.04990647781216, "num_env_steps_trained_throughput_per_sec": 440.04990647781216, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 9378.123, "restore_workers_time_ms": 0.031, "training_step_time_ms": 9377.728, "sample_time_ms": 1318.651, "learn_time_ms": 8007.324, "learn_throughput": 499.543, "synch_weights_time_ms": 48.877}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 92, "trial_id": "1f352_00000", "date": "2024-08-11_15-09-47", "timestamp": 1723403387, "time_this_iter_s": 9.118186235427856, "time_total_s": 899.2954025268555, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b188ec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 899.2954025268555, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 52.46923076923077, "ram_util_percent": 83.4230769230769}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5561320966109635, "cur_kl_coeff": 2.793967723846435e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.665169926236073, "policy_loss": -0.0017993268430776274, "vf_loss": 1.6669692554200688, "vf_explained_var": 0.9641975255062183, "kl": 0.004971922207281428, "entropy": 0.3628813571607073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.578957416738073, "cur_kl_coeff": 0.0005859374999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6628673244267702, "policy_loss": -0.0056725364117786135, "vf_loss": 1.6685362556949257, "vf_explained_var": 0.9632016728321712, "kl": 0.006153301658690695, "entropy": 0.494908735062927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -58.64029928563584, "predator_policy": -14.203393739737052}, "policy_reward_max": {"prey_policy": 14.203393739737052, "predator_policy": 58.64029928563584}, "policy_reward_mean": {"prey_policy": -18.141296988271716, "predator_policy": 18.141296988271716}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-35.76977675844127, -17.39146764362996, -13.910120708201344, -16.550978998334813, -29.2145557780089, -9.594999688963453, -11.786617996321318, -12.93627915323428, -5.836446786436168, -37.793300153020084, -14.519841968126018, -7.06275092116159, -4.575463014580993, -18.886814075797645, -23.24552175837439, -19.28177775837753, -19.924753300290917, -37.83377872158483, -39.29529094420029, -11.316636980014053, -3.677403583805611, -13.596227173295405, -10.299767357184011, -28.375883586741075, -37.17384704336488, -7.238172687246507, -24.743046896518813, -31.438370241473084, -20.010664383424114, -33.9751473772797, -23.35625296164458, -10.46490132839286, -29.563736450288403, -12.443908058620838, -12.24143418765153, -3.039348546966494, -23.702909725270995, 2.033487478915996, -24.323439801328625, -24.095601614081907, -28.38393949389564, -43.58520595532474, -15.846574703213914, -6.15826245188298, -20.385571057783483, -11.446953346539422, -32.758476361921346, -14.404421480412132, -32.65888528680747, 2.1910707790517208, -4.793442642735871, -16.38854465436479, -13.070515890126824, -6.914604268295216, -4.793677151446687, -36.938181179004765, -34.68008222380893, -45.028940793696336, -37.06588492701298, -38.750378130658866, -24.272011312460176, 12.633696196002921, -24.54771290118731, -12.671800398861425, -33.000509360245374, -2.9387158811529925, -58.64029928563584, -18.91841702756564, -30.76381199763206, -20.042488538261015, -4.107070653960205, -42.20031572738206, -12.926156893064244, -23.472212785703363, -39.37200638198248, -19.683701081916613, -3.136340498016516, -14.114676414874117, -1.7576034148309763, -1.670348370480588, -10.986443314307936, -3.0064184933445333, -1.2829038564681765, 9.179992084825038, -28.482345484894296, 14.203393739737052, -23.56621231062737, -16.902032556123984, -9.70934632004417, -16.569432090162845, -32.17013057107762, 8.794120366728512, -40.2009118620886, -8.884447903063014, 1.6506931070949875, -12.839048469473177, 9.6799503783679, -24.55614280968593, -41.49183843050845, -11.072471450200576], "policy_predator_policy_reward": [35.76977675844127, 17.39146764362996, 13.910120708201344, 16.550978998334813, 29.2145557780089, 9.594999688963453, 11.786617996321318, 12.93627915323428, 5.836446786436168, 37.793300153020084, 14.519841968126018, 7.06275092116159, 4.575463014580993, 18.886814075797645, 23.24552175837439, 19.28177775837753, 19.924753300290917, 37.83377872158483, 39.29529094420029, 11.316636980014053, 3.677403583805611, 13.596227173295405, 10.299767357184011, 28.375883586741075, 37.17384704336488, 7.238172687246507, 24.743046896518813, 31.438370241473084, 20.010664383424114, 33.9751473772797, 23.35625296164458, 10.46490132839286, 29.563736450288403, 12.443908058620838, 12.24143418765153, 3.039348546966494, 23.702909725270995, -2.033487478915996, 24.323439801328625, 24.095601614081907, 28.38393949389564, 43.58520595532474, 15.846574703213914, 6.15826245188298, 20.385571057783483, 11.446953346539422, 32.758476361921346, 14.404421480412132, 32.65888528680747, -2.1910707790517208, 4.793442642735871, 16.38854465436479, 13.070515890126824, 6.914604268295216, 4.793677151446687, 36.938181179004765, 34.68008222380893, 45.028940793696336, 37.06588492701298, 38.750378130658866, 24.272011312460176, -12.633696196002921, 24.54771290118731, 12.671800398861425, 33.000509360245374, 2.9387158811529925, 58.64029928563584, 18.91841702756564, 30.76381199763206, 20.042488538261015, 4.107070653960205, 42.20031572738206, 12.926156893064244, 23.472212785703363, 39.37200638198248, 19.683701081916613, 3.136340498016516, 14.114676414874117, 1.7576034148309763, 1.670348370480588, 10.986443314307936, 3.0064184933445333, 1.2829038564681765, -9.179992084825038, 28.482345484894296, -14.203393739737052, 23.56621231062737, 16.902032556123984, 9.70934632004417, 16.569432090162845, 32.17013057107762, -8.794120366728512, 40.2009118620886, 8.884447903063014, -1.6506931070949875, 12.839048469473177, -9.6799503783679, 24.55614280968593, 41.49183843050845, 11.072471450200576]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5332495696454937, "mean_inference_ms": 1.8634460210480812, "mean_action_processing_ms": 0.22540318483105387, "mean_env_wait_ms": 0.1410621977505281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00844573974609375, "StateBufferConnector_ms": 0.002968311309814453, "ViewRequirementAgentConnector_ms": 0.08222699165344238}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 484.4840892760682, "num_env_steps_trained_throughput_per_sec": 484.4840892760682, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 9244.609, "restore_workers_time_ms": 0.031, "training_step_time_ms": 9244.175, "sample_time_ms": 1284.324, "learn_time_ms": 7908.012, "learn_throughput": 505.816, "synch_weights_time_ms": 48.651}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "training_iteration": 93, "trial_id": "1f352_00000", "date": "2024-08-11_15-09-56", "timestamp": 1723403396, "time_this_iter_s": 8.305155992507935, "time_total_s": 907.6005585193634, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a16040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 907.6005585193634, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 49.76363636363636, "ram_util_percent": 83.12727272727271}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.316790427081287, "cur_kl_coeff": 1.3969838619232175e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.278065178791682, "policy_loss": -0.0038849964713638958, "vf_loss": 2.2819501746445896, "vf_explained_var": 0.9407253138720989, "kl": 0.0050873724049890915, "entropy": 0.41194011953969795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3536913710956773, "cur_kl_coeff": 0.0005859374999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.282002665475011, "policy_loss": -0.0036709653669580195, "vf_loss": 2.2856696832925083, "vf_explained_var": 0.9409561907251676, "kl": 0.006734668066241295, "entropy": 0.5146366684076686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -58.64029928563584, "predator_policy": -14.203393739737052}, "policy_reward_max": {"prey_policy": 14.203393739737052, "predator_policy": 58.64029928563584}, "policy_reward_mean": {"prey_policy": -19.115597015658615, "predator_policy": 19.115597015658615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.299767357184011, -28.375883586741075, -37.17384704336488, -7.238172687246507, -24.743046896518813, -31.438370241473084, -20.010664383424114, -33.9751473772797, -23.35625296164458, -10.46490132839286, -29.563736450288403, -12.443908058620838, -12.24143418765153, -3.039348546966494, -23.702909725270995, 2.033487478915996, -24.323439801328625, -24.095601614081907, -28.38393949389564, -43.58520595532474, -15.846574703213914, -6.15826245188298, -20.385571057783483, -11.446953346539422, -32.758476361921346, -14.404421480412132, -32.65888528680747, 2.1910707790517208, -4.793442642735871, -16.38854465436479, -13.070515890126824, -6.914604268295216, -4.793677151446687, -36.938181179004765, -34.68008222380893, -45.028940793696336, -37.06588492701298, -38.750378130658866, -24.272011312460176, 12.633696196002921, -24.54771290118731, -12.671800398861425, -33.000509360245374, -2.9387158811529925, -58.64029928563584, -18.91841702756564, -30.76381199763206, -20.042488538261015, -4.107070653960205, -42.20031572738206, -12.926156893064244, -23.472212785703363, -39.37200638198248, -19.683701081916613, -3.136340498016516, -14.114676414874117, -1.7576034148309763, -1.670348370480588, -10.986443314307936, -3.0064184933445333, -1.2829038564681765, 9.179992084825038, -28.482345484894296, 14.203393739737052, -23.56621231062737, -16.902032556123984, -9.70934632004417, -16.569432090162845, -32.17013057107762, 8.794120366728512, -40.2009118620886, -8.884447903063014, 1.6506931070949875, -12.839048469473177, 9.6799503783679, -24.55614280968593, -41.49183843050845, -11.072471450200576, -38.08993390960041, -15.858724002483491, -25.043861132472422, -30.812910543201266, -12.000238923705407, -30.415060038584887, -17.5875504376397, -42.633994509288115, -29.327109941602075, -4.392997201462102, -12.43470942967625, -17.3800140881553, -20.021217428494737, -38.1032469497544, -6.504184664621052, -41.33165433881693, -43.84522383536942, -6.1494671903492275, -23.158951666424535, -6.387319999453185, -10.497043352745266, -29.455393018990485], "policy_predator_policy_reward": [10.299767357184011, 28.375883586741075, 37.17384704336488, 7.238172687246507, 24.743046896518813, 31.438370241473084, 20.010664383424114, 33.9751473772797, 23.35625296164458, 10.46490132839286, 29.563736450288403, 12.443908058620838, 12.24143418765153, 3.039348546966494, 23.702909725270995, -2.033487478915996, 24.323439801328625, 24.095601614081907, 28.38393949389564, 43.58520595532474, 15.846574703213914, 6.15826245188298, 20.385571057783483, 11.446953346539422, 32.758476361921346, 14.404421480412132, 32.65888528680747, -2.1910707790517208, 4.793442642735871, 16.38854465436479, 13.070515890126824, 6.914604268295216, 4.793677151446687, 36.938181179004765, 34.68008222380893, 45.028940793696336, 37.06588492701298, 38.750378130658866, 24.272011312460176, -12.633696196002921, 24.54771290118731, 12.671800398861425, 33.000509360245374, 2.9387158811529925, 58.64029928563584, 18.91841702756564, 30.76381199763206, 20.042488538261015, 4.107070653960205, 42.20031572738206, 12.926156893064244, 23.472212785703363, 39.37200638198248, 19.683701081916613, 3.136340498016516, 14.114676414874117, 1.7576034148309763, 1.670348370480588, 10.986443314307936, 3.0064184933445333, 1.2829038564681765, -9.179992084825038, 28.482345484894296, -14.203393739737052, 23.56621231062737, 16.902032556123984, 9.70934632004417, 16.569432090162845, 32.17013057107762, -8.794120366728512, 40.2009118620886, 8.884447903063014, -1.6506931070949875, 12.839048469473177, -9.6799503783679, 24.55614280968593, 41.49183843050845, 11.072471450200576, 38.08993390960041, 15.858724002483491, 25.043861132472422, 30.812910543201266, 12.000238923705407, 30.415060038584887, 17.5875504376397, 42.633994509288115, 29.327109941602075, 4.392997201462102, 12.43470942967625, 17.3800140881553, 20.021217428494737, 38.1032469497544, 6.504184664621052, 41.33165433881693, 43.84522383536942, 6.1494671903492275, 23.158951666424535, 6.387319999453185, 10.497043352745266, 29.455393018990485]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.532622974237273, "mean_inference_ms": 1.8598265951752382, "mean_action_processing_ms": 0.2250059099662137, "mean_env_wait_ms": 0.14077489964025958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01356053352355957, "StateBufferConnector_ms": 0.003174424171447754, "ViewRequirementAgentConnector_ms": 0.08523440361022949}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 463.9862579753612, "num_env_steps_trained_throughput_per_sec": 463.9862579753612, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 9066.849, "restore_workers_time_ms": 0.031, "training_step_time_ms": 9066.415, "sample_time_ms": 1273.388, "learn_time_ms": 7740.88, "learn_throughput": 516.737, "synch_weights_time_ms": 49.063}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 94, "trial_id": "1f352_00000", "date": "2024-08-11_15-10-04", "timestamp": 1723403404, "time_this_iter_s": 8.711118698120117, "time_total_s": 916.3116772174835, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a1a430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 916.3116772174835, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 51.19230769230769, "ram_util_percent": 82.86923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.530831238627434, "cur_kl_coeff": 1.3969838619232175e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9321694372842708, "policy_loss": -0.004129613365512342, "vf_loss": 1.9362990520894527, "vf_explained_var": 0.9592321693276366, "kl": 0.003838004035355247, "entropy": 0.33445021635852756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.529744683702787, "cur_kl_coeff": 0.0005859374999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.908336180821061, "policy_loss": -0.010700880932078386, "vf_loss": 1.9190307773649693, "vf_explained_var": 0.9657204511885842, "kl": 0.010738896835275003, "entropy": 0.5348735647276044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -58.64029928563584, "predator_policy": -14.203393739737052}, "policy_reward_max": {"prey_policy": 14.203393739737052, "predator_policy": 58.64029928563584}, "policy_reward_mean": {"prey_policy": -18.319787276914468, "predator_policy": 18.319787276914468}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-28.38393949389564, -43.58520595532474, -15.846574703213914, -6.15826245188298, -20.385571057783483, -11.446953346539422, -32.758476361921346, -14.404421480412132, -32.65888528680747, 2.1910707790517208, -4.793442642735871, -16.38854465436479, -13.070515890126824, -6.914604268295216, -4.793677151446687, -36.938181179004765, -34.68008222380893, -45.028940793696336, -37.06588492701298, -38.750378130658866, -24.272011312460176, 12.633696196002921, -24.54771290118731, -12.671800398861425, -33.000509360245374, -2.9387158811529925, -58.64029928563584, -18.91841702756564, -30.76381199763206, -20.042488538261015, -4.107070653960205, -42.20031572738206, -12.926156893064244, -23.472212785703363, -39.37200638198248, -19.683701081916613, -3.136340498016516, -14.114676414874117, -1.7576034148309763, -1.670348370480588, -10.986443314307936, -3.0064184933445333, -1.2829038564681765, 9.179992084825038, -28.482345484894296, 14.203393739737052, -23.56621231062737, -16.902032556123984, -9.70934632004417, -16.569432090162845, -32.17013057107762, 8.794120366728512, -40.2009118620886, -8.884447903063014, 1.6506931070949875, -12.839048469473177, 9.6799503783679, -24.55614280968593, -41.49183843050845, -11.072471450200576, -38.08993390960041, -15.858724002483491, -25.043861132472422, -30.812910543201266, -12.000238923705407, -30.415060038584887, -17.5875504376397, -42.633994509288115, -29.327109941602075, -4.392997201462102, -12.43470942967625, -17.3800140881553, -20.021217428494737, -38.1032469497544, -6.504184664621052, -41.33165433881693, -43.84522383536942, -6.1494671903492275, -23.158951666424535, -6.387319999453185, -10.497043352745266, -29.455393018990485, -14.178431686157268, -12.062882243978736, -7.602993126895704, -5.941538869827435, -15.344668166109276, -31.9231699457003, -23.047628837209235, -13.467313297607646, -5.660275138080783, -7.453916210664794, -16.820432985590188, -8.756161802538832, 2.4022095123342293, -17.541212704627007, -7.404463777581503, -28.26955739530747, -13.837947797926958, -47.961586420679325], "policy_predator_policy_reward": [28.38393949389564, 43.58520595532474, 15.846574703213914, 6.15826245188298, 20.385571057783483, 11.446953346539422, 32.758476361921346, 14.404421480412132, 32.65888528680747, -2.1910707790517208, 4.793442642735871, 16.38854465436479, 13.070515890126824, 6.914604268295216, 4.793677151446687, 36.938181179004765, 34.68008222380893, 45.028940793696336, 37.06588492701298, 38.750378130658866, 24.272011312460176, -12.633696196002921, 24.54771290118731, 12.671800398861425, 33.000509360245374, 2.9387158811529925, 58.64029928563584, 18.91841702756564, 30.76381199763206, 20.042488538261015, 4.107070653960205, 42.20031572738206, 12.926156893064244, 23.472212785703363, 39.37200638198248, 19.683701081916613, 3.136340498016516, 14.114676414874117, 1.7576034148309763, 1.670348370480588, 10.986443314307936, 3.0064184933445333, 1.2829038564681765, -9.179992084825038, 28.482345484894296, -14.203393739737052, 23.56621231062737, 16.902032556123984, 9.70934632004417, 16.569432090162845, 32.17013057107762, -8.794120366728512, 40.2009118620886, 8.884447903063014, -1.6506931070949875, 12.839048469473177, -9.6799503783679, 24.55614280968593, 41.49183843050845, 11.072471450200576, 38.08993390960041, 15.858724002483491, 25.043861132472422, 30.812910543201266, 12.000238923705407, 30.415060038584887, 17.5875504376397, 42.633994509288115, 29.327109941602075, 4.392997201462102, 12.43470942967625, 17.3800140881553, 20.021217428494737, 38.1032469497544, 6.504184664621052, 41.33165433881693, 43.84522383536942, 6.1494671903492275, 23.158951666424535, 6.387319999453185, 10.497043352745266, 29.455393018990485, 14.178431686157268, 12.062882243978736, 7.602993126895704, 5.941538869827435, 15.344668166109276, 31.9231699457003, 23.047628837209235, 13.467313297607646, 5.660275138080783, 7.453916210664794, 16.820432985590188, 8.756161802538832, -2.4022095123342293, 17.541212704627007, 7.404463777581503, 28.26955739530747, 13.837947797926958, 47.961586420679325]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5319165354067913, "mean_inference_ms": 1.8569360431076796, "mean_action_processing_ms": 0.22470931199631902, "mean_env_wait_ms": 0.14056931898503394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014414429664611816, "StateBufferConnector_ms": 0.0027217864990234375, "ViewRequirementAgentConnector_ms": 0.07991504669189453}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 477.0030322581764, "num_env_steps_trained_throughput_per_sec": 477.0030322581764, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 8975.025, "restore_workers_time_ms": 0.031, "training_step_time_ms": 8974.557, "sample_time_ms": 1236.684, "learn_time_ms": 7691.992, "learn_throughput": 520.021, "synch_weights_time_ms": 43.06}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "done": false, "training_iteration": 95, "trial_id": "1f352_00000", "date": "2024-08-11_15-10-13", "timestamp": 1723403413, "time_this_iter_s": 8.506150722503662, "time_total_s": 924.8178279399872, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a38af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 924.8178279399872, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 48.85, "ram_util_percent": 82.78333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.535434498265386, "cur_kl_coeff": 6.984919309616087e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2559060363719863, "policy_loss": -0.00018686253170017154, "vf_loss": 2.2560929008449118, "vf_explained_var": 0.938927625057598, "kl": 0.003628285248420049, "entropy": 0.35253727035596966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.408851016747455, "cur_kl_coeff": 0.0005859374999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.202482632175088, "policy_loss": -0.006433070592902368, "vf_loss": 2.2089111248652142, "vf_explained_var": 0.9406051468725006, "kl": 0.007802836548779531, "entropy": 0.5146718677133322, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -58.64029928563584, "predator_policy": -14.203393739737052}, "policy_reward_max": {"prey_policy": 14.203393739737052, "predator_policy": 58.64029928563584}, "policy_reward_mean": {"prey_policy": -17.641933383637635, "predator_policy": 17.641933383637635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.671800398861425, -33.000509360245374, -2.9387158811529925, -58.64029928563584, -18.91841702756564, -30.76381199763206, -20.042488538261015, -4.107070653960205, -42.20031572738206, -12.926156893064244, -23.472212785703363, -39.37200638198248, -19.683701081916613, -3.136340498016516, -14.114676414874117, -1.7576034148309763, -1.670348370480588, -10.986443314307936, -3.0064184933445333, -1.2829038564681765, 9.179992084825038, -28.482345484894296, 14.203393739737052, -23.56621231062737, -16.902032556123984, -9.70934632004417, -16.569432090162845, -32.17013057107762, 8.794120366728512, -40.2009118620886, -8.884447903063014, 1.6506931070949875, -12.839048469473177, 9.6799503783679, -24.55614280968593, -41.49183843050845, -11.072471450200576, -38.08993390960041, -15.858724002483491, -25.043861132472422, -30.812910543201266, -12.000238923705407, -30.415060038584887, -17.5875504376397, -42.633994509288115, -29.327109941602075, -4.392997201462102, -12.43470942967625, -17.3800140881553, -20.021217428494737, -38.1032469497544, -6.504184664621052, -41.33165433881693, -43.84522383536942, -6.1494671903492275, -23.158951666424535, -6.387319999453185, -10.497043352745266, -29.455393018990485, -14.178431686157268, -12.062882243978736, -7.602993126895704, -5.941538869827435, -15.344668166109276, -31.9231699457003, -23.047628837209235, -13.467313297607646, -5.660275138080783, -7.453916210664794, -16.820432985590188, -8.756161802538832, 2.4022095123342293, -17.541212704627007, -7.404463777581503, -28.26955739530747, -13.837947797926958, -47.961586420679325, -34.73321404902743, -0.7790373979324254, -46.67547232872268, -17.07416393921096, -40.50321404101612, -10.058984448339693, -23.638437603323837, -10.864136779864266, -55.81657082093664, -5.311161346488473, 6.423688221716803, -2.653174078309414, -11.17286052117931, -12.692417354004142, 14.158194455730643, -4.789571890262739, -14.718451850135839, -42.20706031865564, -19.629453697714904, -12.912558450560295, 0.5881376581532587, -25.67985335087949, -39.52233597887858], "policy_predator_policy_reward": [12.671800398861425, 33.000509360245374, 2.9387158811529925, 58.64029928563584, 18.91841702756564, 30.76381199763206, 20.042488538261015, 4.107070653960205, 42.20031572738206, 12.926156893064244, 23.472212785703363, 39.37200638198248, 19.683701081916613, 3.136340498016516, 14.114676414874117, 1.7576034148309763, 1.670348370480588, 10.986443314307936, 3.0064184933445333, 1.2829038564681765, -9.179992084825038, 28.482345484894296, -14.203393739737052, 23.56621231062737, 16.902032556123984, 9.70934632004417, 16.569432090162845, 32.17013057107762, -8.794120366728512, 40.2009118620886, 8.884447903063014, -1.6506931070949875, 12.839048469473177, -9.6799503783679, 24.55614280968593, 41.49183843050845, 11.072471450200576, 38.08993390960041, 15.858724002483491, 25.043861132472422, 30.812910543201266, 12.000238923705407, 30.415060038584887, 17.5875504376397, 42.633994509288115, 29.327109941602075, 4.392997201462102, 12.43470942967625, 17.3800140881553, 20.021217428494737, 38.1032469497544, 6.504184664621052, 41.33165433881693, 43.84522383536942, 6.1494671903492275, 23.158951666424535, 6.387319999453185, 10.497043352745266, 29.455393018990485, 14.178431686157268, 12.062882243978736, 7.602993126895704, 5.941538869827435, 15.344668166109276, 31.9231699457003, 23.047628837209235, 13.467313297607646, 5.660275138080783, 7.453916210664794, 16.820432985590188, 8.756161802538832, -2.4022095123342293, 17.541212704627007, 7.404463777581503, 28.26955739530747, 13.837947797926958, 47.961586420679325, 34.73321404902743, 0.7790373979324254, 46.67547232872268, 17.07416393921096, 40.50321404101612, 10.058984448339693, 23.638437603323837, 10.864136779864266, 55.81657082093664, 5.311161346488473, -6.423688221716803, 2.653174078309414, 11.17286052117931, 12.692417354004142, -14.158194455730643, 4.789571890262739, 14.718451850135839, 42.20706031865564, 19.629453697714904, 12.912558450560295, -0.5881376581532587, 25.67985335087949, 39.52233597887858]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5305673958012396, "mean_inference_ms": 1.8518356476687412, "mean_action_processing_ms": 0.2241903936291644, "mean_env_wait_ms": 0.1402013649617404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01301729679107666, "StateBufferConnector_ms": 0.00316011905670166, "ViewRequirementAgentConnector_ms": 0.07676029205322266}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 476.09146116539006, "num_env_steps_trained_throughput_per_sec": 476.09146116539006, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 8912.835, "restore_workers_time_ms": 0.031, "training_step_time_ms": 8912.368, "sample_time_ms": 1228.205, "learn_time_ms": 7638.528, "learn_throughput": 523.661, "synch_weights_time_ms": 42.718}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 96, "trial_id": "1f352_00000", "date": "2024-08-11_15-10-21", "timestamp": 1723403421, "time_this_iter_s": 8.465412139892578, "time_total_s": 933.2832400798798, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a5b0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 933.2832400798798, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 48.724999999999994, "ram_util_percent": 82.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4591978039592504, "cur_kl_coeff": 3.4924596548080437e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5976198400060335, "policy_loss": -0.001800790064347287, "vf_loss": 2.5994206268340347, "vf_explained_var": 0.9244074411690235, "kl": 0.005945021036206469, "entropy": 0.42403757212062676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5778167322278023, "cur_kl_coeff": 0.0005859374999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6026468936974805, "policy_loss": -0.007976243411152002, "vf_loss": 2.6106153427312773, "vf_explained_var": 0.9245592505981525, "kl": 0.013295269355247823, "entropy": 0.5202595512072246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.81657082093664, "predator_policy": -14.203393739737052}, "policy_reward_max": {"prey_policy": 14.203393739737052, "predator_policy": 55.81657082093664}, "policy_reward_mean": {"prey_policy": -17.3475058747239, "predator_policy": 17.3475058747239}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.0064184933445333, -1.2829038564681765, 9.179992084825038, -28.482345484894296, 14.203393739737052, -23.56621231062737, -16.902032556123984, -9.70934632004417, -16.569432090162845, -32.17013057107762, 8.794120366728512, -40.2009118620886, -8.884447903063014, 1.6506931070949875, -12.839048469473177, 9.6799503783679, -24.55614280968593, -41.49183843050845, -11.072471450200576, -38.08993390960041, -15.858724002483491, -25.043861132472422, -30.812910543201266, -12.000238923705407, -30.415060038584887, -17.5875504376397, -42.633994509288115, -29.327109941602075, -4.392997201462102, -12.43470942967625, -17.3800140881553, -20.021217428494737, -38.1032469497544, -6.504184664621052, -41.33165433881693, -43.84522383536942, -6.1494671903492275, -23.158951666424535, -6.387319999453185, -10.497043352745266, -29.455393018990485, -14.178431686157268, -12.062882243978736, -7.602993126895704, -5.941538869827435, -15.344668166109276, -31.9231699457003, -23.047628837209235, -13.467313297607646, -5.660275138080783, -7.453916210664794, -16.820432985590188, -8.756161802538832, 2.4022095123342293, -17.541212704627007, -7.404463777581503, -28.26955739530747, -13.837947797926958, -47.961586420679325, -34.73321404902743, -0.7790373979324254, -46.67547232872268, -17.07416393921096, -40.50321404101612, -10.058984448339693, -23.638437603323837, -10.864136779864266, -55.81657082093664, -5.311161346488473, 6.423688221716803, -2.653174078309414, -11.17286052117931, -12.692417354004142, 14.158194455730643, -4.789571890262739, -14.718451850135839, -42.20706031865564, -19.629453697714904, -12.912558450560295, 0.5881376581532587, -25.67985335087949, -39.52233597887858, -40.74992502509729, -4.635030306713579, 11.242430144314355, -28.5048218145789, -28.85444019581479, -16.31667639537102, -13.870352612931207, -17.01245387952023, -20.313833234146323, -27.962501197684617, -1.5805179671611107, -31.275893200021727, -25.73464158256109, -3.1121599656215047, -24.808381783124705, 7.71339964207929, -13.836458850604627, -41.347908909940884], "policy_predator_policy_reward": [3.0064184933445333, 1.2829038564681765, -9.179992084825038, 28.482345484894296, -14.203393739737052, 23.56621231062737, 16.902032556123984, 9.70934632004417, 16.569432090162845, 32.17013057107762, -8.794120366728512, 40.2009118620886, 8.884447903063014, -1.6506931070949875, 12.839048469473177, -9.6799503783679, 24.55614280968593, 41.49183843050845, 11.072471450200576, 38.08993390960041, 15.858724002483491, 25.043861132472422, 30.812910543201266, 12.000238923705407, 30.415060038584887, 17.5875504376397, 42.633994509288115, 29.327109941602075, 4.392997201462102, 12.43470942967625, 17.3800140881553, 20.021217428494737, 38.1032469497544, 6.504184664621052, 41.33165433881693, 43.84522383536942, 6.1494671903492275, 23.158951666424535, 6.387319999453185, 10.497043352745266, 29.455393018990485, 14.178431686157268, 12.062882243978736, 7.602993126895704, 5.941538869827435, 15.344668166109276, 31.9231699457003, 23.047628837209235, 13.467313297607646, 5.660275138080783, 7.453916210664794, 16.820432985590188, 8.756161802538832, -2.4022095123342293, 17.541212704627007, 7.404463777581503, 28.26955739530747, 13.837947797926958, 47.961586420679325, 34.73321404902743, 0.7790373979324254, 46.67547232872268, 17.07416393921096, 40.50321404101612, 10.058984448339693, 23.638437603323837, 10.864136779864266, 55.81657082093664, 5.311161346488473, -6.423688221716803, 2.653174078309414, 11.17286052117931, 12.692417354004142, -14.158194455730643, 4.789571890262739, 14.718451850135839, 42.20706031865564, 19.629453697714904, 12.912558450560295, -0.5881376581532587, 25.67985335087949, 39.52233597887858, 40.74992502509729, 4.635030306713579, -11.242430144314355, 28.5048218145789, 28.85444019581479, 16.31667639537102, 13.870352612931207, 17.01245387952023, 20.313833234146323, 27.962501197684617, 1.5805179671611107, 31.275893200021727, 25.73464158256109, 3.1121599656215047, 24.808381783124705, -7.71339964207929, 13.836458850604627, 41.347908909940884]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5292263403251845, "mean_inference_ms": 1.8467730975560397, "mean_action_processing_ms": 0.22368222796922993, "mean_env_wait_ms": 0.13981964031153682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009648442268371582, "StateBufferConnector_ms": 0.0032219886779785156, "ViewRequirementAgentConnector_ms": 0.06467437744140625}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 407.54716027797286, "num_env_steps_trained_throughput_per_sec": 407.54716027797286, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 776000, "timers": {"training_iteration_time_ms": 8940.618, "restore_workers_time_ms": 0.031, "training_step_time_ms": 8940.052, "sample_time_ms": 1156.05, "learn_time_ms": 7732.192, "learn_throughput": 517.318, "synch_weights_time_ms": 48.825}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000}, "done": false, "training_iteration": 97, "trial_id": "1f352_00000", "date": "2024-08-11_15-10-31", "timestamp": 1723403431, "time_this_iter_s": 9.881009817123413, "time_total_s": 943.1642498970032, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a1a4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 943.1642498970032, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 57.135714285714286, "ram_util_percent": 82.88571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5245632865776617, "cur_kl_coeff": 3.4924596548080437e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9224758863449096, "policy_loss": -0.00102195601114848, "vf_loss": 1.923497842500607, "vf_explained_var": 0.9563107843200366, "kl": 0.0029538142209623772, "entropy": 0.31977829441117744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.470932947471738, "cur_kl_coeff": 0.0005859374999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9219248959794641, "policy_loss": -0.005957005875825416, "vf_loss": 1.9278776527692874, "vf_explained_var": 0.9559355045979222, "kl": 0.0072485717463417285, "entropy": 0.5265919657113651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.81657082093664, "predator_policy": -14.158194455730643}, "policy_reward_max": {"prey_policy": 14.158194455730643, "predator_policy": 55.81657082093664}, "policy_reward_mean": {"prey_policy": -17.610586405864886, "predator_policy": 17.610586405864886}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-30.812910543201266, -12.000238923705407, -30.415060038584887, -17.5875504376397, -42.633994509288115, -29.327109941602075, -4.392997201462102, -12.43470942967625, -17.3800140881553, -20.021217428494737, -38.1032469497544, -6.504184664621052, -41.33165433881693, -43.84522383536942, -6.1494671903492275, -23.158951666424535, -6.387319999453185, -10.497043352745266, -29.455393018990485, -14.178431686157268, -12.062882243978736, -7.602993126895704, -5.941538869827435, -15.344668166109276, -31.9231699457003, -23.047628837209235, -13.467313297607646, -5.660275138080783, -7.453916210664794, -16.820432985590188, -8.756161802538832, 2.4022095123342293, -17.541212704627007, -7.404463777581503, -28.26955739530747, -13.837947797926958, -47.961586420679325, -34.73321404902743, -0.7790373979324254, -46.67547232872268, -17.07416393921096, -40.50321404101612, -10.058984448339693, -23.638437603323837, -10.864136779864266, -55.81657082093664, -5.311161346488473, 6.423688221716803, -2.653174078309414, -11.17286052117931, -12.692417354004142, 14.158194455730643, -4.789571890262739, -14.718451850135839, -42.20706031865564, -19.629453697714904, -12.912558450560295, 0.5881376581532587, -25.67985335087949, -39.52233597887858, -40.74992502509729, -4.635030306713579, 11.242430144314355, -28.5048218145789, -28.85444019581479, -16.31667639537102, -13.870352612931207, -17.01245387952023, -20.313833234146323, -27.962501197684617, -1.5805179671611107, -31.275893200021727, -25.73464158256109, -3.1121599656215047, -24.808381783124705, 7.71339964207929, -13.836458850604627, -41.347908909940884, 1.8866880740833452, -13.684567644963973, -36.88161374513931, -34.445128757155004, -29.984711036457625, -18.918075133432012, -0.8983123532707846, -42.62649384290157, -17.28020208139286, -21.835847683512153, -35.11079260492707, 9.514595764486264, -9.058214090304546, -16.77451049152469, -10.261274773701793, -19.21423812226977, -1.0477931233945315, -19.423374081166244, -19.28077360300265, -1.5310661265477883, 3.3752220060985714, 0.9543783607323961], "policy_predator_policy_reward": [30.812910543201266, 12.000238923705407, 30.415060038584887, 17.5875504376397, 42.633994509288115, 29.327109941602075, 4.392997201462102, 12.43470942967625, 17.3800140881553, 20.021217428494737, 38.1032469497544, 6.504184664621052, 41.33165433881693, 43.84522383536942, 6.1494671903492275, 23.158951666424535, 6.387319999453185, 10.497043352745266, 29.455393018990485, 14.178431686157268, 12.062882243978736, 7.602993126895704, 5.941538869827435, 15.344668166109276, 31.9231699457003, 23.047628837209235, 13.467313297607646, 5.660275138080783, 7.453916210664794, 16.820432985590188, 8.756161802538832, -2.4022095123342293, 17.541212704627007, 7.404463777581503, 28.26955739530747, 13.837947797926958, 47.961586420679325, 34.73321404902743, 0.7790373979324254, 46.67547232872268, 17.07416393921096, 40.50321404101612, 10.058984448339693, 23.638437603323837, 10.864136779864266, 55.81657082093664, 5.311161346488473, -6.423688221716803, 2.653174078309414, 11.17286052117931, 12.692417354004142, -14.158194455730643, 4.789571890262739, 14.718451850135839, 42.20706031865564, 19.629453697714904, 12.912558450560295, -0.5881376581532587, 25.67985335087949, 39.52233597887858, 40.74992502509729, 4.635030306713579, -11.242430144314355, 28.5048218145789, 28.85444019581479, 16.31667639537102, 13.870352612931207, 17.01245387952023, 20.313833234146323, 27.962501197684617, 1.5805179671611107, 31.275893200021727, 25.73464158256109, 3.1121599656215047, 24.808381783124705, -7.71339964207929, 13.836458850604627, 41.347908909940884, -1.8866880740833452, 13.684567644963973, 36.88161374513931, 34.445128757155004, 29.984711036457625, 18.918075133432012, 0.8983123532707846, 42.62649384290157, 17.28020208139286, 21.835847683512153, 35.11079260492707, -9.514595764486264, 9.058214090304546, 16.77451049152469, 10.261274773701793, 19.21423812226977, 1.0477931233945315, 19.423374081166244, 19.28077360300265, 1.5310661265477883, -3.3752220060985714, -0.9543783607323961]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5303045070811243, "mean_inference_ms": 1.8494927798283305, "mean_action_processing_ms": 0.22441087810656357, "mean_env_wait_ms": 0.1400367530671916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008648157119750977, "StateBufferConnector_ms": 0.003209710121154785, "ViewRequirementAgentConnector_ms": 0.06669533252716064}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.6838320576247, "num_env_steps_trained_throughput_per_sec": 440.6838320576247, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 8916.581, "restore_workers_time_ms": 0.03, "training_step_time_ms": 8916.097, "sample_time_ms": 1075.212, "learn_time_ms": 7801.98, "learn_throughput": 512.69, "synch_weights_time_ms": 36.388}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 98, "trial_id": "1f352_00000", "date": "2024-08-11_15-10-40", "timestamp": 1723403440, "time_this_iter_s": 9.138417959213257, "time_total_s": 952.3026678562164, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a38430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 952.3026678562164, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 52.54615384615385, "ram_util_percent": 82.5153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1574277512108284, "cur_kl_coeff": 1.7462298274040218e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8974703008929887, "policy_loss": 0.0001964350167933541, "vf_loss": 1.8972738747795423, "vf_explained_var": 0.9287287065759301, "kl": 0.0023725726118088023, "entropy": 0.3151170806804051, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.070517011235158, "cur_kl_coeff": 0.0005859374999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8729460577790935, "policy_loss": -0.005144475638129128, "vf_loss": 1.8780864412585894, "vf_explained_var": 0.9284645710140467, "kl": 0.00698917481189017, "entropy": 0.5172359618668755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.81657082093664, "predator_policy": -14.158194455730643}, "policy_reward_max": {"prey_policy": 14.158194455730643, "predator_policy": 55.81657082093664}, "policy_reward_mean": {"prey_policy": -15.898832289109372, "predator_policy": 15.898832289109372}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-29.455393018990485, -14.178431686157268, -12.062882243978736, -7.602993126895704, -5.941538869827435, -15.344668166109276, -31.9231699457003, -23.047628837209235, -13.467313297607646, -5.660275138080783, -7.453916210664794, -16.820432985590188, -8.756161802538832, 2.4022095123342293, -17.541212704627007, -7.404463777581503, -28.26955739530747, -13.837947797926958, -47.961586420679325, -34.73321404902743, -0.7790373979324254, -46.67547232872268, -17.07416393921096, -40.50321404101612, -10.058984448339693, -23.638437603323837, -10.864136779864266, -55.81657082093664, -5.311161346488473, 6.423688221716803, -2.653174078309414, -11.17286052117931, -12.692417354004142, 14.158194455730643, -4.789571890262739, -14.718451850135839, -42.20706031865564, -19.629453697714904, -12.912558450560295, 0.5881376581532587, -25.67985335087949, -39.52233597887858, -40.74992502509729, -4.635030306713579, 11.242430144314355, -28.5048218145789, -28.85444019581479, -16.31667639537102, -13.870352612931207, -17.01245387952023, -20.313833234146323, -27.962501197684617, -1.5805179671611107, -31.275893200021727, -25.73464158256109, -3.1121599656215047, -24.808381783124705, 7.71339964207929, -13.836458850604627, -41.347908909940884, 1.8866880740833452, -13.684567644963973, -36.88161374513931, -34.445128757155004, -29.984711036457625, -18.918075133432012, -0.8983123532707846, -42.62649384290157, -17.28020208139286, -21.835847683512153, -35.11079260492707, 9.514595764486264, -9.058214090304546, -16.77451049152469, -10.261274773701793, -19.21423812226977, -1.0477931233945315, -19.423374081166244, -19.28077360300265, -1.5310661265477883, 3.3752220060985714, 0.9543783607323961, -35.98189110119638, -0.6092648016249029, -24.941552802488577, -4.550039641306151, -27.02275054886941, -8.293092310133009, -12.938274265921118, -10.517377968836165, -9.44220406472485, -17.797242280327954, -4.550488144196502, 5.121792553436071, -1.135574808351672, -0.022827036671474232, -45.24032823369143, 1.282494531706453, -10.68579366470433, -14.48306827589131], "policy_predator_policy_reward": [29.455393018990485, 14.178431686157268, 12.062882243978736, 7.602993126895704, 5.941538869827435, 15.344668166109276, 31.9231699457003, 23.047628837209235, 13.467313297607646, 5.660275138080783, 7.453916210664794, 16.820432985590188, 8.756161802538832, -2.4022095123342293, 17.541212704627007, 7.404463777581503, 28.26955739530747, 13.837947797926958, 47.961586420679325, 34.73321404902743, 0.7790373979324254, 46.67547232872268, 17.07416393921096, 40.50321404101612, 10.058984448339693, 23.638437603323837, 10.864136779864266, 55.81657082093664, 5.311161346488473, -6.423688221716803, 2.653174078309414, 11.17286052117931, 12.692417354004142, -14.158194455730643, 4.789571890262739, 14.718451850135839, 42.20706031865564, 19.629453697714904, 12.912558450560295, -0.5881376581532587, 25.67985335087949, 39.52233597887858, 40.74992502509729, 4.635030306713579, -11.242430144314355, 28.5048218145789, 28.85444019581479, 16.31667639537102, 13.870352612931207, 17.01245387952023, 20.313833234146323, 27.962501197684617, 1.5805179671611107, 31.275893200021727, 25.73464158256109, 3.1121599656215047, 24.808381783124705, -7.71339964207929, 13.836458850604627, 41.347908909940884, -1.8866880740833452, 13.684567644963973, 36.88161374513931, 34.445128757155004, 29.984711036457625, 18.918075133432012, 0.8983123532707846, 42.62649384290157, 17.28020208139286, 21.835847683512153, 35.11079260492707, -9.514595764486264, 9.058214090304546, 16.77451049152469, 10.261274773701793, 19.21423812226977, 1.0477931233945315, 19.423374081166244, 19.28077360300265, 1.5310661265477883, -3.3752220060985714, -0.9543783607323961, 35.98189110119638, 0.6092648016249029, 24.941552802488577, 4.550039641306151, 27.02275054886941, 8.293092310133009, 12.938274265921118, 10.517377968836165, 9.44220406472485, 17.797242280327954, 4.550488144196502, -5.121792553436071, 1.135574808351672, 0.022827036671474232, 45.24032823369143, -1.282494531706453, 10.68579366470433, 14.48306827589131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5263730440594891, "mean_inference_ms": 1.8361006927208572, "mean_action_processing_ms": 0.22257196513923674, "mean_env_wait_ms": 0.13900688533364722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003996729850769043, "StateBufferConnector_ms": 0.0030881166458129883, "ViewRequirementAgentConnector_ms": 0.06783556938171387}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 416.99914901156046, "num_env_steps_trained_throughput_per_sec": 416.99914901156046, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 9003.268, "restore_workers_time_ms": 0.03, "training_step_time_ms": 9002.774, "sample_time_ms": 1134.706, "learn_time_ms": 7827.779, "learn_throughput": 511.001, "synch_weights_time_ms": 37.644}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "training_iteration": 99, "trial_id": "1f352_00000", "date": "2024-08-11_15-10-50", "timestamp": 1723403450, "time_this_iter_s": 9.670284032821655, "time_total_s": 961.9729518890381, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a1a430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 961.9729518890381, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 53.728571428571435, "ram_util_percent": 82.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3017795512452723, "cur_kl_coeff": 8.731149137020109e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0240452392647663, "policy_loss": -0.0017234532342020733, "vf_loss": 2.0257686857134103, "vf_explained_var": 0.9605461118742824, "kl": 0.003978201075947914, "entropy": 0.3370136951406797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.236289294064045, "cur_kl_coeff": 0.0005859374999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9860576985403895, "policy_loss": -0.0038670989495585674, "vf_loss": 1.9899206761891644, "vf_explained_var": 0.9616008191059033, "kl": 0.007034516608745366, "entropy": 0.47810572953894737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.81657082093664, "predator_policy": -14.158194455730643}, "policy_reward_max": {"prey_policy": 14.158194455730643, "predator_policy": 55.81657082093664}, "policy_reward_mean": {"prey_policy": -16.248851756986163, "predator_policy": 16.248851756986163}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-40.50321404101612, -10.058984448339693, -23.638437603323837, -10.864136779864266, -55.81657082093664, -5.311161346488473, 6.423688221716803, -2.653174078309414, -11.17286052117931, -12.692417354004142, 14.158194455730643, -4.789571890262739, -14.718451850135839, -42.20706031865564, -19.629453697714904, -12.912558450560295, 0.5881376581532587, -25.67985335087949, -39.52233597887858, -40.74992502509729, -4.635030306713579, 11.242430144314355, -28.5048218145789, -28.85444019581479, -16.31667639537102, -13.870352612931207, -17.01245387952023, -20.313833234146323, -27.962501197684617, -1.5805179671611107, -31.275893200021727, -25.73464158256109, -3.1121599656215047, -24.808381783124705, 7.71339964207929, -13.836458850604627, -41.347908909940884, 1.8866880740833452, -13.684567644963973, -36.88161374513931, -34.445128757155004, -29.984711036457625, -18.918075133432012, -0.8983123532707846, -42.62649384290157, -17.28020208139286, -21.835847683512153, -35.11079260492707, 9.514595764486264, -9.058214090304546, -16.77451049152469, -10.261274773701793, -19.21423812226977, -1.0477931233945315, -19.423374081166244, -19.28077360300265, -1.5310661265477883, 3.3752220060985714, 0.9543783607323961, -35.98189110119638, -0.6092648016249029, -24.941552802488577, -4.550039641306151, -27.02275054886941, -8.293092310133009, -12.938274265921118, -10.517377968836165, -9.44220406472485, -17.797242280327954, -4.550488144196502, 5.121792553436071, -1.135574808351672, -0.022827036671474232, -45.24032823369143, 1.282494531706453, -10.68579366470433, -14.48306827589131, -7.486811616775167, -29.068996474589685, -18.649417249784687, -29.882012239302586, -2.232671188279289, -23.36986412798261, -15.22391859526643, -40.54956546209458, -24.847895141716272, -36.83435620202191, -31.531540708737552, -17.999524781280023, -20.097462279680578, -21.94666845265977, 1.9938926067934224, -4.1007493474155545, -29.346805845877967, -10.136813204576285, 1.4716811012647177, -7.035760843584832, -6.296113449959169, -19.01453152919401, -46.40529338299058], "policy_predator_policy_reward": [40.50321404101612, 10.058984448339693, 23.638437603323837, 10.864136779864266, 55.81657082093664, 5.311161346488473, -6.423688221716803, 2.653174078309414, 11.17286052117931, 12.692417354004142, -14.158194455730643, 4.789571890262739, 14.718451850135839, 42.20706031865564, 19.629453697714904, 12.912558450560295, -0.5881376581532587, 25.67985335087949, 39.52233597887858, 40.74992502509729, 4.635030306713579, -11.242430144314355, 28.5048218145789, 28.85444019581479, 16.31667639537102, 13.870352612931207, 17.01245387952023, 20.313833234146323, 27.962501197684617, 1.5805179671611107, 31.275893200021727, 25.73464158256109, 3.1121599656215047, 24.808381783124705, -7.71339964207929, 13.836458850604627, 41.347908909940884, -1.8866880740833452, 13.684567644963973, 36.88161374513931, 34.445128757155004, 29.984711036457625, 18.918075133432012, 0.8983123532707846, 42.62649384290157, 17.28020208139286, 21.835847683512153, 35.11079260492707, -9.514595764486264, 9.058214090304546, 16.77451049152469, 10.261274773701793, 19.21423812226977, 1.0477931233945315, 19.423374081166244, 19.28077360300265, 1.5310661265477883, -3.3752220060985714, -0.9543783607323961, 35.98189110119638, 0.6092648016249029, 24.941552802488577, 4.550039641306151, 27.02275054886941, 8.293092310133009, 12.938274265921118, 10.517377968836165, 9.44220406472485, 17.797242280327954, 4.550488144196502, -5.121792553436071, 1.135574808351672, 0.022827036671474232, 45.24032823369143, -1.282494531706453, 10.68579366470433, 14.48306827589131, 7.486811616775167, 29.068996474589685, 18.649417249784687, 29.882012239302586, 2.232671188279289, 23.36986412798261, 15.22391859526643, 40.54956546209458, 24.847895141716272, 36.83435620202191, 31.531540708737552, 17.999524781280023, 20.097462279680578, 21.94666845265977, -1.9938926067934224, 4.1007493474155545, 29.346805845877967, 10.136813204576285, -1.4716811012647177, 7.035760843584832, 6.296113449959169, 19.01453152919401, 46.40529338299058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5257658281887382, "mean_inference_ms": 1.8319247387002215, "mean_action_processing_ms": 0.22224432025832805, "mean_env_wait_ms": 0.1386766803605414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035059452056884766, "StateBufferConnector_ms": 0.003009200096130371, "ViewRequirementAgentConnector_ms": 0.06807780265808105}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.7738475836629, "num_env_steps_trained_throughput_per_sec": 435.7738475836629, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 8923.883, "restore_workers_time_ms": 0.028, "training_step_time_ms": 8923.454, "sample_time_ms": 1110.387, "learn_time_ms": 7770.13, "learn_throughput": 514.792, "synch_weights_time_ms": 40.51}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 100, "trial_id": "1f352_00000", "date": "2024-08-11_15-10-59", "timestamp": 1723403459, "time_this_iter_s": 9.243844747543335, "time_total_s": 971.2167966365814, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1890ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 971.2167966365814, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 52.03076923076923, "ram_util_percent": 82.71538461538464}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4895975994567077, "cur_kl_coeff": 4.3655745685100546e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.323706434418758, "policy_loss": -0.0019197550932100664, "vf_loss": 2.3256261866539716, "vf_explained_var": 0.9549014093975227, "kl": 0.00397433681006995, "entropy": 0.3244842049355308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 96480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5970931850373744, "cur_kl_coeff": 0.0005859374999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.344699501991272, "policy_loss": -0.00619010787292306, "vf_loss": 2.3508844576776027, "vf_explained_var": 0.9540293803438544, "kl": 0.008800699116462833, "entropy": 0.5101938610586028, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 96480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.40529338299058, "predator_policy": -11.242430144314355}, "policy_reward_max": {"prey_policy": 11.242430144314355, "predator_policy": 46.40529338299058}, "policy_reward_mean": {"prey_policy": -17.73652846525198, "predator_policy": 17.73652846525198}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-39.52233597887858, -40.74992502509729, -4.635030306713579, 11.242430144314355, -28.5048218145789, -28.85444019581479, -16.31667639537102, -13.870352612931207, -17.01245387952023, -20.313833234146323, -27.962501197684617, -1.5805179671611107, -31.275893200021727, -25.73464158256109, -3.1121599656215047, -24.808381783124705, 7.71339964207929, -13.836458850604627, -41.347908909940884, 1.8866880740833452, -13.684567644963973, -36.88161374513931, -34.445128757155004, -29.984711036457625, -18.918075133432012, -0.8983123532707846, -42.62649384290157, -17.28020208139286, -21.835847683512153, -35.11079260492707, 9.514595764486264, -9.058214090304546, -16.77451049152469, -10.261274773701793, -19.21423812226977, -1.0477931233945315, -19.423374081166244, -19.28077360300265, -1.5310661265477883, 3.3752220060985714, 0.9543783607323961, -35.98189110119638, -0.6092648016249029, -24.941552802488577, -4.550039641306151, -27.02275054886941, -8.293092310133009, -12.938274265921118, -10.517377968836165, -9.44220406472485, -17.797242280327954, -4.550488144196502, 5.121792553436071, -1.135574808351672, -0.022827036671474232, -45.24032823369143, 1.282494531706453, -10.68579366470433, -14.48306827589131, -7.486811616775167, -29.068996474589685, -18.649417249784687, -29.882012239302586, -2.232671188279289, -23.36986412798261, -15.22391859526643, -40.54956546209458, -24.847895141716272, -36.83435620202191, -31.531540708737552, -17.999524781280023, -20.097462279680578, -21.94666845265977, 1.9938926067934224, -4.1007493474155545, -29.346805845877967, -10.136813204576285, 1.4716811012647177, -7.035760843584832, -6.296113449959169, -19.01453152919401, -46.40529338299058, -20.998494364686568, -30.863302710639395, 1.023102153865791, -28.0438991709457, -32.835944590239755, -24.359004018212616, -21.857445583481358, -31.48252779186775, -17.17174539698664, -30.468301798038613, -29.390255538600165, -17.87058979299177, -7.242579869965473, -23.26751032160633, -20.25054853397498, -15.760028636020055, -41.85777192401959, -27.548709154240484], "policy_predator_policy_reward": [39.52233597887858, 40.74992502509729, 4.635030306713579, -11.242430144314355, 28.5048218145789, 28.85444019581479, 16.31667639537102, 13.870352612931207, 17.01245387952023, 20.313833234146323, 27.962501197684617, 1.5805179671611107, 31.275893200021727, 25.73464158256109, 3.1121599656215047, 24.808381783124705, -7.71339964207929, 13.836458850604627, 41.347908909940884, -1.8866880740833452, 13.684567644963973, 36.88161374513931, 34.445128757155004, 29.984711036457625, 18.918075133432012, 0.8983123532707846, 42.62649384290157, 17.28020208139286, 21.835847683512153, 35.11079260492707, -9.514595764486264, 9.058214090304546, 16.77451049152469, 10.261274773701793, 19.21423812226977, 1.0477931233945315, 19.423374081166244, 19.28077360300265, 1.5310661265477883, -3.3752220060985714, -0.9543783607323961, 35.98189110119638, 0.6092648016249029, 24.941552802488577, 4.550039641306151, 27.02275054886941, 8.293092310133009, 12.938274265921118, 10.517377968836165, 9.44220406472485, 17.797242280327954, 4.550488144196502, -5.121792553436071, 1.135574808351672, 0.022827036671474232, 45.24032823369143, -1.282494531706453, 10.68579366470433, 14.48306827589131, 7.486811616775167, 29.068996474589685, 18.649417249784687, 29.882012239302586, 2.232671188279289, 23.36986412798261, 15.22391859526643, 40.54956546209458, 24.847895141716272, 36.83435620202191, 31.531540708737552, 17.999524781280023, 20.097462279680578, 21.94666845265977, -1.9938926067934224, 4.1007493474155545, 29.346805845877967, 10.136813204576285, -1.4716811012647177, 7.035760843584832, 6.296113449959169, 19.01453152919401, 46.40529338299058, 20.998494364686568, 30.863302710639395, -1.023102153865791, 28.0438991709457, 32.835944590239755, 24.359004018212616, 21.857445583481358, 31.48252779186775, 17.17174539698664, 30.468301798038613, 29.390255538600165, 17.87058979299177, 7.242579869965473, 23.26751032160633, 20.25054853397498, 15.760028636020055, 41.85777192401959, 27.548709154240484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5238754650978517, "mean_inference_ms": 1.827776402560034, "mean_action_processing_ms": 0.22172227554918167, "mean_env_wait_ms": 0.13834586078847755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034886598587036133, "StateBufferConnector_ms": 0.002435922622680664, "ViewRequirementAgentConnector_ms": 0.06741845607757568}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 438.09461040111006, "num_env_steps_trained_throughput_per_sec": 438.09461040111006, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 808000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 808000, "timers": {"training_iteration_time_ms": 8954.87, "restore_workers_time_ms": 0.028, "training_step_time_ms": 8954.448, "sample_time_ms": 1090.507, "learn_time_ms": 7822.709, "learn_throughput": 511.332, "synch_weights_time_ms": 39.411}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000}, "done": false, "training_iteration": 101, "trial_id": "1f352_00000", "date": "2024-08-11_15-11-09", "timestamp": 1723403469, "time_this_iter_s": 9.161435842514038, "time_total_s": 980.3782324790955, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1af1e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 980.3782324790955, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 54.57692307692308, "ram_util_percent": 83.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9380982094133894, "cur_kl_coeff": 2.1827872842550273e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3278290497759977, "policy_loss": -0.002730778598440035, "vf_loss": 1.3305598311747113, "vf_explained_var": 0.9711172248547276, "kl": 0.004145222773437022, "entropy": 0.3304829258626948, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 97440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0491270069032907, "cur_kl_coeff": 0.0005859374999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3360549508283535, "policy_loss": -0.002661248235866272, "vf_loss": 1.3387138172363242, "vf_explained_var": 0.9708281210934122, "kl": 0.004065599377890757, "entropy": 0.4587782451262077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 97440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.40529338299058, "predator_policy": -13.043196862068422}, "policy_reward_max": {"prey_policy": 13.043196862068422, "predator_policy": 46.40529338299058}, "policy_reward_mean": {"prey_policy": -17.66803208660527, "predator_policy": 17.66803208660527}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-41.347908909940884, 1.8866880740833452, -13.684567644963973, -36.88161374513931, -34.445128757155004, -29.984711036457625, -18.918075133432012, -0.8983123532707846, -42.62649384290157, -17.28020208139286, -21.835847683512153, -35.11079260492707, 9.514595764486264, -9.058214090304546, -16.77451049152469, -10.261274773701793, -19.21423812226977, -1.0477931233945315, -19.423374081166244, -19.28077360300265, -1.5310661265477883, 3.3752220060985714, 0.9543783607323961, -35.98189110119638, -0.6092648016249029, -24.941552802488577, -4.550039641306151, -27.02275054886941, -8.293092310133009, -12.938274265921118, -10.517377968836165, -9.44220406472485, -17.797242280327954, -4.550488144196502, 5.121792553436071, -1.135574808351672, -0.022827036671474232, -45.24032823369143, 1.282494531706453, -10.68579366470433, -14.48306827589131, -7.486811616775167, -29.068996474589685, -18.649417249784687, -29.882012239302586, -2.232671188279289, -23.36986412798261, -15.22391859526643, -40.54956546209458, -24.847895141716272, -36.83435620202191, -31.531540708737552, -17.999524781280023, -20.097462279680578, -21.94666845265977, 1.9938926067934224, -4.1007493474155545, -29.346805845877967, -10.136813204576285, 1.4716811012647177, -7.035760843584832, -6.296113449959169, -19.01453152919401, -46.40529338299058, -20.998494364686568, -30.863302710639395, 1.023102153865791, -28.0438991709457, -32.835944590239755, -24.359004018212616, -21.857445583481358, -31.48252779186775, -17.17174539698664, -30.468301798038613, -29.390255538600165, -17.87058979299177, -7.242579869965473, -23.26751032160633, -20.25054853397498, -15.760028636020055, -41.85777192401959, -27.548709154240484, -25.713117836500313, -17.279583130041562, -20.10833212100836, -16.9461435566364, -25.39740626989289, 0.3880868743799244, 13.043196862068422, -17.253056717056506, -42.48660332747943, -22.99853726528108, -33.32563014406665, 0.03163602521974607, -20.741727009830672, -9.024208388216886, -8.194114974837916, -34.96274632728468, -42.11595818972736, 10.799289157425891], "policy_predator_policy_reward": [41.347908909940884, -1.8866880740833452, 13.684567644963973, 36.88161374513931, 34.445128757155004, 29.984711036457625, 18.918075133432012, 0.8983123532707846, 42.62649384290157, 17.28020208139286, 21.835847683512153, 35.11079260492707, -9.514595764486264, 9.058214090304546, 16.77451049152469, 10.261274773701793, 19.21423812226977, 1.0477931233945315, 19.423374081166244, 19.28077360300265, 1.5310661265477883, -3.3752220060985714, -0.9543783607323961, 35.98189110119638, 0.6092648016249029, 24.941552802488577, 4.550039641306151, 27.02275054886941, 8.293092310133009, 12.938274265921118, 10.517377968836165, 9.44220406472485, 17.797242280327954, 4.550488144196502, -5.121792553436071, 1.135574808351672, 0.022827036671474232, 45.24032823369143, -1.282494531706453, 10.68579366470433, 14.48306827589131, 7.486811616775167, 29.068996474589685, 18.649417249784687, 29.882012239302586, 2.232671188279289, 23.36986412798261, 15.22391859526643, 40.54956546209458, 24.847895141716272, 36.83435620202191, 31.531540708737552, 17.999524781280023, 20.097462279680578, 21.94666845265977, -1.9938926067934224, 4.1007493474155545, 29.346805845877967, 10.136813204576285, -1.4716811012647177, 7.035760843584832, 6.296113449959169, 19.01453152919401, 46.40529338299058, 20.998494364686568, 30.863302710639395, -1.023102153865791, 28.0438991709457, 32.835944590239755, 24.359004018212616, 21.857445583481358, 31.48252779186775, 17.17174539698664, 30.468301798038613, 29.390255538600165, 17.87058979299177, 7.242579869965473, 23.26751032160633, 20.25054853397498, 15.760028636020055, 41.85777192401959, 27.548709154240484, 25.713117836500313, 17.279583130041562, 20.10833212100836, 16.9461435566364, 25.39740626989289, -0.3880868743799244, -13.043196862068422, 17.253056717056506, 42.48660332747943, 22.99853726528108, 33.32563014406665, -0.03163602521974607, 20.741727009830672, 9.024208388216886, 8.194114974837916, 34.96274632728468, 42.11595818972736, -10.799289157425891]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.523237956300013, "mean_inference_ms": 1.8259636446648937, "mean_action_processing_ms": 0.22152938897394667, "mean_env_wait_ms": 0.1381844304510546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037993192672729492, "StateBufferConnector_ms": 0.0033550262451171875, "ViewRequirementAgentConnector_ms": 0.07503139972686768}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 481.546255342233, "num_env_steps_trained_throughput_per_sec": 481.546255342233, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 8876.538, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8876.131, "sample_time_ms": 1105.342, "learn_time_ms": 7730.136, "learn_throughput": 517.455, "synch_weights_time_ms": 39.042}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 102, "trial_id": "1f352_00000", "date": "2024-08-11_15-11-17", "timestamp": 1723403477, "time_this_iter_s": 8.351587057113647, "time_total_s": 988.7298195362091, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a5bb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 988.7298195362091, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 48.73333333333333, "ram_util_percent": 82.60833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9046408854424954, "cur_kl_coeff": 1.0913936421275136e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1973731932540734, "policy_loss": -0.002435951430137114, "vf_loss": 1.1998091482246915, "vf_explained_var": 0.9638890937591592, "kl": 0.004364859460267093, "entropy": 0.2491239770160367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 98400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8948149867355824, "cur_kl_coeff": 0.00029296874999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.182426591279606, "policy_loss": -0.007564666346297599, "vf_loss": 1.1899886064231395, "vf_explained_var": 0.9637734704961379, "kl": 0.009044914224993879, "entropy": 0.4605394197317461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 98400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.40529338299058, "predator_policy": -13.043196862068422}, "policy_reward_max": {"prey_policy": 13.043196862068422, "predator_policy": 46.40529338299058}, "policy_reward_mean": {"prey_policy": -17.42952590136465, "predator_policy": 17.42952590136465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.9543783607323961, -35.98189110119638, -0.6092648016249029, -24.941552802488577, -4.550039641306151, -27.02275054886941, -8.293092310133009, -12.938274265921118, -10.517377968836165, -9.44220406472485, -17.797242280327954, -4.550488144196502, 5.121792553436071, -1.135574808351672, -0.022827036671474232, -45.24032823369143, 1.282494531706453, -10.68579366470433, -14.48306827589131, -7.486811616775167, -29.068996474589685, -18.649417249784687, -29.882012239302586, -2.232671188279289, -23.36986412798261, -15.22391859526643, -40.54956546209458, -24.847895141716272, -36.83435620202191, -31.531540708737552, -17.999524781280023, -20.097462279680578, -21.94666845265977, 1.9938926067934224, -4.1007493474155545, -29.346805845877967, -10.136813204576285, 1.4716811012647177, -7.035760843584832, -6.296113449959169, -19.01453152919401, -46.40529338299058, -20.998494364686568, -30.863302710639395, 1.023102153865791, -28.0438991709457, -32.835944590239755, -24.359004018212616, -21.857445583481358, -31.48252779186775, -17.17174539698664, -30.468301798038613, -29.390255538600165, -17.87058979299177, -7.242579869965473, -23.26751032160633, -20.25054853397498, -15.760028636020055, -41.85777192401959, -27.548709154240484, -25.713117836500313, -17.279583130041562, -20.10833212100836, -16.9461435566364, -25.39740626989289, 0.3880868743799244, 13.043196862068422, -17.253056717056506, -42.48660332747943, -22.99853726528108, -33.32563014406665, 0.03163602521974607, -20.741727009830672, -9.024208388216886, -8.194114974837916, -34.96274632728468, -42.11595818972736, 10.799289157425891, -6.083051994319234, -15.630292288912738, 1.409531055730481, -11.666314126377642, -18.91543942107709, -22.842692203934263, -24.817748322618485, -9.703381688535712, 5.671154352320622, -24.433385426923508, -7.330972817217884, 3.5273776629025053, -40.0705023713581, -12.468271087461417, -12.152666687419282, -0.5879534664259527, -40.737030172865644, -37.39943725887271, -32.67772547912972, 1.097389403425007, -38.86425477878685, -6.302106718417984], "policy_predator_policy_reward": [-0.9543783607323961, 35.98189110119638, 0.6092648016249029, 24.941552802488577, 4.550039641306151, 27.02275054886941, 8.293092310133009, 12.938274265921118, 10.517377968836165, 9.44220406472485, 17.797242280327954, 4.550488144196502, -5.121792553436071, 1.135574808351672, 0.022827036671474232, 45.24032823369143, -1.282494531706453, 10.68579366470433, 14.48306827589131, 7.486811616775167, 29.068996474589685, 18.649417249784687, 29.882012239302586, 2.232671188279289, 23.36986412798261, 15.22391859526643, 40.54956546209458, 24.847895141716272, 36.83435620202191, 31.531540708737552, 17.999524781280023, 20.097462279680578, 21.94666845265977, -1.9938926067934224, 4.1007493474155545, 29.346805845877967, 10.136813204576285, -1.4716811012647177, 7.035760843584832, 6.296113449959169, 19.01453152919401, 46.40529338299058, 20.998494364686568, 30.863302710639395, -1.023102153865791, 28.0438991709457, 32.835944590239755, 24.359004018212616, 21.857445583481358, 31.48252779186775, 17.17174539698664, 30.468301798038613, 29.390255538600165, 17.87058979299177, 7.242579869965473, 23.26751032160633, 20.25054853397498, 15.760028636020055, 41.85777192401959, 27.548709154240484, 25.713117836500313, 17.279583130041562, 20.10833212100836, 16.9461435566364, 25.39740626989289, -0.3880868743799244, -13.043196862068422, 17.253056717056506, 42.48660332747943, 22.99853726528108, 33.32563014406665, -0.03163602521974607, 20.741727009830672, 9.024208388216886, 8.194114974837916, 34.96274632728468, 42.11595818972736, -10.799289157425891, 6.083051994319234, 15.630292288912738, -1.409531055730481, 11.666314126377642, 18.91543942107709, 22.842692203934263, 24.817748322618485, 9.703381688535712, -5.671154352320622, 24.433385426923508, 7.330972817217884, -3.5273776629025053, 40.0705023713581, 12.468271087461417, 12.152666687419282, 0.5879534664259527, 40.737030172865644, 37.39943725887271, 32.67772547912972, -1.097389403425007, 38.86425477878685, 6.302106718417984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5228933201076063, "mean_inference_ms": 1.8253566648257487, "mean_action_processing_ms": 0.22146177251990182, "mean_env_wait_ms": 0.138135984000091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005949854850769043, "StateBufferConnector_ms": 0.0036902427673339844, "ViewRequirementAgentConnector_ms": 0.0907660722732544}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 447.51523678137914, "num_env_steps_trained_throughput_per_sec": 447.51523678137914, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 824000, "timers": {"training_iteration_time_ms": 8944.704, "restore_workers_time_ms": 0.019, "training_step_time_ms": 8944.349, "sample_time_ms": 1129.655, "learn_time_ms": 7775.082, "learn_throughput": 514.464, "synch_weights_time_ms": 38.368}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000}, "done": false, "training_iteration": 103, "trial_id": "1f352_00000", "date": "2024-08-11_15-11-26", "timestamp": 1723403486, "time_this_iter_s": 9.006963014602661, "time_total_s": 997.7367825508118, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a5be50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 997.7367825508118, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 50.074999999999996, "ram_util_percent": 82.49166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.172510906246801, "cur_kl_coeff": 5.456968210637568e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6783334663137794, "policy_loss": -0.002865001755223299, "vf_loss": 1.681198462098837, "vf_explained_var": 0.9483112914487719, "kl": 0.004172374135971683, "entropy": 0.3247857465408742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 99360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0925118254497646, "cur_kl_coeff": 0.00029296874999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6770547493050496, "policy_loss": -0.0017145361881072555, "vf_loss": 1.678767640950779, "vf_explained_var": 0.9490292164807518, "kl": 0.0056343066954787245, "entropy": 0.47041622971494995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 99360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.40529338299058, "predator_policy": -13.043196862068422}, "policy_reward_max": {"prey_policy": 13.043196862068422, "predator_policy": 46.40529338299058}, "policy_reward_mean": {"prey_policy": -17.749701253831365, "predator_policy": 17.749701253831365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.48306827589131, -7.486811616775167, -29.068996474589685, -18.649417249784687, -29.882012239302586, -2.232671188279289, -23.36986412798261, -15.22391859526643, -40.54956546209458, -24.847895141716272, -36.83435620202191, -31.531540708737552, -17.999524781280023, -20.097462279680578, -21.94666845265977, 1.9938926067934224, -4.1007493474155545, -29.346805845877967, -10.136813204576285, 1.4716811012647177, -7.035760843584832, -6.296113449959169, -19.01453152919401, -46.40529338299058, -20.998494364686568, -30.863302710639395, 1.023102153865791, -28.0438991709457, -32.835944590239755, -24.359004018212616, -21.857445583481358, -31.48252779186775, -17.17174539698664, -30.468301798038613, -29.390255538600165, -17.87058979299177, -7.242579869965473, -23.26751032160633, -20.25054853397498, -15.760028636020055, -41.85777192401959, -27.548709154240484, -25.713117836500313, -17.279583130041562, -20.10833212100836, -16.9461435566364, -25.39740626989289, 0.3880868743799244, 13.043196862068422, -17.253056717056506, -42.48660332747943, -22.99853726528108, -33.32563014406665, 0.03163602521974607, -20.741727009830672, -9.024208388216886, -8.194114974837916, -34.96274632728468, -42.11595818972736, 10.799289157425891, -6.083051994319234, -15.630292288912738, 1.409531055730481, -11.666314126377642, -18.91543942107709, -22.842692203934263, -24.817748322618485, -9.703381688535712, 5.671154352320622, -24.433385426923508, -7.330972817217884, 3.5273776629025053, -40.0705023713581, -12.468271087461417, -12.152666687419282, -0.5879534664259527, -40.737030172865644, -37.39943725887271, -32.67772547912972, 1.097389403425007, -38.86425477878685, -6.302106718417984, -17.11348996666625, -20.414619689290518, -33.18085218401153, -35.1255873870655, 2.097576255389022, -14.430583767041762, -22.028814307695995, -0.22923691660567158, -7.644375423657667, -0.8069793327869972, -4.889367953470253, -24.13625367752139, -12.443739315107765, -13.284620675141932, -0.9786069945939913, -19.42527474422195, -11.376343686109225, -2.9764017082406347], "policy_predator_policy_reward": [14.48306827589131, 7.486811616775167, 29.068996474589685, 18.649417249784687, 29.882012239302586, 2.232671188279289, 23.36986412798261, 15.22391859526643, 40.54956546209458, 24.847895141716272, 36.83435620202191, 31.531540708737552, 17.999524781280023, 20.097462279680578, 21.94666845265977, -1.9938926067934224, 4.1007493474155545, 29.346805845877967, 10.136813204576285, -1.4716811012647177, 7.035760843584832, 6.296113449959169, 19.01453152919401, 46.40529338299058, 20.998494364686568, 30.863302710639395, -1.023102153865791, 28.0438991709457, 32.835944590239755, 24.359004018212616, 21.857445583481358, 31.48252779186775, 17.17174539698664, 30.468301798038613, 29.390255538600165, 17.87058979299177, 7.242579869965473, 23.26751032160633, 20.25054853397498, 15.760028636020055, 41.85777192401959, 27.548709154240484, 25.713117836500313, 17.279583130041562, 20.10833212100836, 16.9461435566364, 25.39740626989289, -0.3880868743799244, -13.043196862068422, 17.253056717056506, 42.48660332747943, 22.99853726528108, 33.32563014406665, -0.03163602521974607, 20.741727009830672, 9.024208388216886, 8.194114974837916, 34.96274632728468, 42.11595818972736, -10.799289157425891, 6.083051994319234, 15.630292288912738, -1.409531055730481, 11.666314126377642, 18.91543942107709, 22.842692203934263, 24.817748322618485, 9.703381688535712, -5.671154352320622, 24.433385426923508, 7.330972817217884, -3.5273776629025053, 40.0705023713581, 12.468271087461417, 12.152666687419282, 0.5879534664259527, 40.737030172865644, 37.39943725887271, 32.67772547912972, -1.097389403425007, 38.86425477878685, 6.302106718417984, 17.11348996666625, 20.414619689290518, 33.18085218401153, 35.1255873870655, -2.097576255389022, 14.430583767041762, 22.028814307695995, 0.22923691660567158, 7.644375423657667, 0.8069793327869972, 4.889367953470253, 24.13625367752139, 12.443739315107765, 13.284620675141932, 0.9786069945939913, 19.42527474422195, 11.376343686109225, 2.9764017082406347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5221950278779104, "mean_inference_ms": 1.8229971873863176, "mean_action_processing_ms": 0.22119300692353158, "mean_env_wait_ms": 0.13794781312148577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005888223648071289, "StateBufferConnector_ms": 0.003666400909423828, "ViewRequirementAgentConnector_ms": 0.08623611927032471}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 474.14887529078584, "num_env_steps_trained_throughput_per_sec": 474.14887529078584, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 8926.229, "restore_workers_time_ms": 0.025, "training_step_time_ms": 8925.846, "sample_time_ms": 1101.147, "learn_time_ms": 7782.295, "learn_throughput": 513.987, "synch_weights_time_ms": 41.026}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 104, "trial_id": "1f352_00000", "date": "2024-08-11_15-11-35", "timestamp": 1723403495, "time_this_iter_s": 8.481093883514404, "time_total_s": 1006.2178764343262, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1af1790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1006.2178764343262, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 49.70833333333334, "ram_util_percent": 82.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0921107654770217, "cur_kl_coeff": 2.728484105318784e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5396191709364453, "policy_loss": -0.0027903373974064987, "vf_loss": 1.542409506253898, "vf_explained_var": 0.9517027567451198, "kl": 0.002986190508740728, "entropy": 0.2826833277164648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 100320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.012821864274641, "cur_kl_coeff": 0.00029296874999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.546495387951533, "policy_loss": -0.00473246353212744, "vf_loss": 1.5512257199113568, "vf_explained_var": 0.9515251371388634, "kl": 0.007258675170530143, "entropy": 0.4633900482207537, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 100320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.40529338299058, "predator_policy": -13.043196862068422}, "policy_reward_max": {"prey_policy": 13.043196862068422, "predator_policy": 46.40529338299058}, "policy_reward_mean": {"prey_policy": -16.46144511292712, "predator_policy": 16.46144511292712}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-46.40529338299058, -20.998494364686568, -30.863302710639395, 1.023102153865791, -28.0438991709457, -32.835944590239755, -24.359004018212616, -21.857445583481358, -31.48252779186775, -17.17174539698664, -30.468301798038613, -29.390255538600165, -17.87058979299177, -7.242579869965473, -23.26751032160633, -20.25054853397498, -15.760028636020055, -41.85777192401959, -27.548709154240484, -25.713117836500313, -17.279583130041562, -20.10833212100836, -16.9461435566364, -25.39740626989289, 0.3880868743799244, 13.043196862068422, -17.253056717056506, -42.48660332747943, -22.99853726528108, -33.32563014406665, 0.03163602521974607, -20.741727009830672, -9.024208388216886, -8.194114974837916, -34.96274632728468, -42.11595818972736, 10.799289157425891, -6.083051994319234, -15.630292288912738, 1.409531055730481, -11.666314126377642, -18.91543942107709, -22.842692203934263, -24.817748322618485, -9.703381688535712, 5.671154352320622, -24.433385426923508, -7.330972817217884, 3.5273776629025053, -40.0705023713581, -12.468271087461417, -12.152666687419282, -0.5879534664259527, -40.737030172865644, -37.39943725887271, -32.67772547912972, 1.097389403425007, -38.86425477878685, -6.302106718417984, -17.11348996666625, -20.414619689290518, -33.18085218401153, -35.1255873870655, 2.097576255389022, -14.430583767041762, -22.028814307695995, -0.22923691660567158, -7.644375423657667, -0.8069793327869972, -4.889367953470253, -24.13625367752139, -12.443739315107765, -13.284620675141932, -0.9786069945939913, -19.42527474422195, -11.376343686109225, -2.9764017082406347, -22.304513418742395, -13.88098354910585, -15.819711349221286, -26.22726538968687, -20.082476781609465, -2.1913864417477473, 0.9508118911237098, -2.010150969222228, -24.677851286630244, -14.564281517345307, -12.906655058438847, -7.950378612317884, -23.258478772923976, -10.117229283726703, -25.336637874498418, -2.985581750302712, -8.956531163289117, -16.12122911217711, -2.7774075350824834, -2.887529220365627, -2.8076061924475955, -10.159373425441904, -10.770912404987751], "policy_predator_policy_reward": [46.40529338299058, 20.998494364686568, 30.863302710639395, -1.023102153865791, 28.0438991709457, 32.835944590239755, 24.359004018212616, 21.857445583481358, 31.48252779186775, 17.17174539698664, 30.468301798038613, 29.390255538600165, 17.87058979299177, 7.242579869965473, 23.26751032160633, 20.25054853397498, 15.760028636020055, 41.85777192401959, 27.548709154240484, 25.713117836500313, 17.279583130041562, 20.10833212100836, 16.9461435566364, 25.39740626989289, -0.3880868743799244, -13.043196862068422, 17.253056717056506, 42.48660332747943, 22.99853726528108, 33.32563014406665, -0.03163602521974607, 20.741727009830672, 9.024208388216886, 8.194114974837916, 34.96274632728468, 42.11595818972736, -10.799289157425891, 6.083051994319234, 15.630292288912738, -1.409531055730481, 11.666314126377642, 18.91543942107709, 22.842692203934263, 24.817748322618485, 9.703381688535712, -5.671154352320622, 24.433385426923508, 7.330972817217884, -3.5273776629025053, 40.0705023713581, 12.468271087461417, 12.152666687419282, 0.5879534664259527, 40.737030172865644, 37.39943725887271, 32.67772547912972, -1.097389403425007, 38.86425477878685, 6.302106718417984, 17.11348996666625, 20.414619689290518, 33.18085218401153, 35.1255873870655, -2.097576255389022, 14.430583767041762, 22.028814307695995, 0.22923691660567158, 7.644375423657667, 0.8069793327869972, 4.889367953470253, 24.13625367752139, 12.443739315107765, 13.284620675141932, 0.9786069945939913, 19.42527474422195, 11.376343686109225, 2.9764017082406347, 22.304513418742395, 13.88098354910585, 15.819711349221286, 26.22726538968687, 20.082476781609465, 2.1913864417477473, -0.9508118911237098, 2.010150969222228, 24.677851286630244, 14.564281517345307, 12.906655058438847, 7.950378612317884, 23.258478772923976, 10.117229283726703, 25.336637874498418, 2.985581750302712, 8.956531163289117, 16.12122911217711, 2.7774075350824834, 2.887529220365627, 2.8076061924475955, 10.159373425441904, 10.770912404987751]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5213251404241057, "mean_inference_ms": 1.819710560050264, "mean_action_processing_ms": 0.22078978124827495, "mean_env_wait_ms": 0.13766681979512038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005493283271789551, "StateBufferConnector_ms": 0.003718852996826172, "ViewRequirementAgentConnector_ms": 0.08740198612213135}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 502.5007604655211, "num_env_steps_trained_throughput_per_sec": 502.5007604655211, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 8883.683, "restore_workers_time_ms": 0.025, "training_step_time_ms": 8883.285, "sample_time_ms": 1090.634, "learn_time_ms": 7755.456, "learn_throughput": 515.766, "synch_weights_time_ms": 35.685}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 105, "trial_id": "1f352_00000", "date": "2024-08-11_15-11-43", "timestamp": 1723403503, "time_this_iter_s": 7.991944074630737, "time_total_s": 1014.2098205089569, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1af10d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1014.2098205089569, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 50.15833333333333, "ram_util_percent": 82.30833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2686664004499715, "cur_kl_coeff": 1.364242052659392e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.219943217684825, "policy_loss": -0.004960705391325367, "vf_loss": 2.224903922714293, "vf_explained_var": 0.9359631891672809, "kl": 0.004507443800286435, "entropy": 0.37174409385770557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 101280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2863744678596656, "cur_kl_coeff": 0.00029296874999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2235923937211433, "policy_loss": -0.004079831137884563, "vf_loss": 2.2276704429338374, "vf_explained_var": 0.9350559875989953, "kl": 0.006117250189281312, "entropy": 0.4645003172879418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 101280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -42.48660332747943, "predator_policy": -13.043196862068422}, "policy_reward_max": {"prey_policy": 13.043196862068422, "predator_policy": 42.48660332747943}, "policy_reward_mean": {"prey_policy": -14.068681400224794, "predator_policy": 14.068681400224794}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-27.548709154240484, -25.713117836500313, -17.279583130041562, -20.10833212100836, -16.9461435566364, -25.39740626989289, 0.3880868743799244, 13.043196862068422, -17.253056717056506, -42.48660332747943, -22.99853726528108, -33.32563014406665, 0.03163602521974607, -20.741727009830672, -9.024208388216886, -8.194114974837916, -34.96274632728468, -42.11595818972736, 10.799289157425891, -6.083051994319234, -15.630292288912738, 1.409531055730481, -11.666314126377642, -18.91543942107709, -22.842692203934263, -24.817748322618485, -9.703381688535712, 5.671154352320622, -24.433385426923508, -7.330972817217884, 3.5273776629025053, -40.0705023713581, -12.468271087461417, -12.152666687419282, -0.5879534664259527, -40.737030172865644, -37.39943725887271, -32.67772547912972, 1.097389403425007, -38.86425477878685, -6.302106718417984, -17.11348996666625, -20.414619689290518, -33.18085218401153, -35.1255873870655, 2.097576255389022, -14.430583767041762, -22.028814307695995, -0.22923691660567158, -7.644375423657667, -0.8069793327869972, -4.889367953470253, -24.13625367752139, -12.443739315107765, -13.284620675141932, -0.9786069945939913, -19.42527474422195, -11.376343686109225, -2.9764017082406347, -22.304513418742395, -13.88098354910585, -15.819711349221286, -26.22726538968687, -20.082476781609465, -2.1913864417477473, 0.9508118911237098, -2.010150969222228, -24.677851286630244, -14.564281517345307, -12.906655058438847, -7.950378612317884, -23.258478772923976, -10.117229283726703, -25.336637874498418, -2.985581750302712, -8.956531163289117, -16.12122911217711, -2.7774075350824834, -2.887529220365627, -2.8076061924475955, -10.159373425441904, -10.770912404987751, -3.9351564892597217, -23.766671785784443, -24.866226068242863, -13.063577055041133, -37.9992680114373, -10.453977648055332, 10.496316203809764, 7.662180908890527, -10.65991363470615, -16.188978669975967, -13.971227247206224, 4.807465689917331, -1.4174907316229337, -14.073635376134066, -23.222031917284433, 2.981429748754623, -12.532944698370853, -19.622063219419758], "policy_predator_policy_reward": [27.548709154240484, 25.713117836500313, 17.279583130041562, 20.10833212100836, 16.9461435566364, 25.39740626989289, -0.3880868743799244, -13.043196862068422, 17.253056717056506, 42.48660332747943, 22.99853726528108, 33.32563014406665, -0.03163602521974607, 20.741727009830672, 9.024208388216886, 8.194114974837916, 34.96274632728468, 42.11595818972736, -10.799289157425891, 6.083051994319234, 15.630292288912738, -1.409531055730481, 11.666314126377642, 18.91543942107709, 22.842692203934263, 24.817748322618485, 9.703381688535712, -5.671154352320622, 24.433385426923508, 7.330972817217884, -3.5273776629025053, 40.0705023713581, 12.468271087461417, 12.152666687419282, 0.5879534664259527, 40.737030172865644, 37.39943725887271, 32.67772547912972, -1.097389403425007, 38.86425477878685, 6.302106718417984, 17.11348996666625, 20.414619689290518, 33.18085218401153, 35.1255873870655, -2.097576255389022, 14.430583767041762, 22.028814307695995, 0.22923691660567158, 7.644375423657667, 0.8069793327869972, 4.889367953470253, 24.13625367752139, 12.443739315107765, 13.284620675141932, 0.9786069945939913, 19.42527474422195, 11.376343686109225, 2.9764017082406347, 22.304513418742395, 13.88098354910585, 15.819711349221286, 26.22726538968687, 20.082476781609465, 2.1913864417477473, -0.9508118911237098, 2.010150969222228, 24.677851286630244, 14.564281517345307, 12.906655058438847, 7.950378612317884, 23.258478772923976, 10.117229283726703, 25.336637874498418, 2.985581750302712, 8.956531163289117, 16.12122911217711, 2.7774075350824834, 2.887529220365627, 2.8076061924475955, 10.159373425441904, 10.770912404987751, 3.9351564892597217, 23.766671785784443, 24.866226068242863, 13.063577055041133, 37.9992680114373, 10.453977648055332, -10.496316203809764, -7.662180908890527, 10.65991363470615, 16.188978669975967, 13.971227247206224, -4.807465689917331, 1.4174907316229337, 14.073635376134066, 23.222031917284433, -2.981429748754623, 12.532944698370853, 19.622063219419758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5205671417084957, "mean_inference_ms": 1.816181310206472, "mean_action_processing_ms": 0.22039164905712674, "mean_env_wait_ms": 0.1374085505264742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005487322807312012, "StateBufferConnector_ms": 0.0037469863891601562, "ViewRequirementAgentConnector_ms": 0.08756422996520996}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.835715184279, "num_env_steps_trained_throughput_per_sec": 496.835715184279, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 8848.604, "restore_workers_time_ms": 0.026, "training_step_time_ms": 8848.207, "sample_time_ms": 1096.77, "learn_time_ms": 7714.868, "learn_throughput": 518.479, "synch_weights_time_ms": 35.169}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 106, "trial_id": "1f352_00000", "date": "2024-08-11_15-11-51", "timestamp": 1723403511, "time_this_iter_s": 8.058030843734741, "time_total_s": 1022.2678513526917, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1af1820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1022.2678513526917, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 48.14545454545455, "ram_util_percent": 82.30909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.245864404179156, "cur_kl_coeff": 6.82121026329696e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1736389873238902, "policy_loss": -0.0016641042042465416, "vf_loss": 1.175303088252743, "vf_explained_var": 0.9747686682889859, "kl": 0.0021741776593405186, "entropy": 0.2503855851168434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 102240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1612574689090254, "cur_kl_coeff": 0.00029296874999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2095351846888662, "policy_loss": -0.0073511772042062756, "vf_loss": 1.2168839511771996, "vf_explained_var": 0.9716212579359611, "kl": 0.008242224403537664, "entropy": 0.4520755024937292, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 102240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -40.737030172865644, "predator_policy": -11.522085947949986}, "policy_reward_max": {"prey_policy": 11.522085947949986, "predator_policy": 40.737030172865644}, "policy_reward_mean": {"prey_policy": -13.656220538589155, "predator_policy": 13.656220538589155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.666314126377642, -18.91543942107709, -22.842692203934263, -24.817748322618485, -9.703381688535712, 5.671154352320622, -24.433385426923508, -7.330972817217884, 3.5273776629025053, -40.0705023713581, -12.468271087461417, -12.152666687419282, -0.5879534664259527, -40.737030172865644, -37.39943725887271, -32.67772547912972, 1.097389403425007, -38.86425477878685, -6.302106718417984, -17.11348996666625, -20.414619689290518, -33.18085218401153, -35.1255873870655, 2.097576255389022, -14.430583767041762, -22.028814307695995, -0.22923691660567158, -7.644375423657667, -0.8069793327869972, -4.889367953470253, -24.13625367752139, -12.443739315107765, -13.284620675141932, -0.9786069945939913, -19.42527474422195, -11.376343686109225, -2.9764017082406347, -22.304513418742395, -13.88098354910585, -15.819711349221286, -26.22726538968687, -20.082476781609465, -2.1913864417477473, 0.9508118911237098, -2.010150969222228, -24.677851286630244, -14.564281517345307, -12.906655058438847, -7.950378612317884, -23.258478772923976, -10.117229283726703, -25.336637874498418, -2.985581750302712, -8.956531163289117, -16.12122911217711, -2.7774075350824834, -2.887529220365627, -2.8076061924475955, -10.159373425441904, -10.770912404987751, -3.9351564892597217, -23.766671785784443, -24.866226068242863, -13.063577055041133, -37.9992680114373, -10.453977648055332, 10.496316203809764, 7.662180908890527, -10.65991363470615, -16.188978669975967, -13.971227247206224, 4.807465689917331, -1.4174907316229337, -14.073635376134066, -23.222031917284433, 2.981429748754623, -12.532944698370853, -19.622063219419758, -31.482274706683253, 0.9414951393678095, -9.215346975758443, 5.2948413738204145, -24.877201165683303, -24.43187909484081, -32.82087631231471, -9.423576416957287, -30.23330937447244, -19.10688371392167, -16.805928411891184, -14.669424651560735, -38.79904448073079, 11.522085947949986, 5.632929976652775, -15.548782140549768, -38.02319771978267, -0.6005143677124707, -2.1129397331260105, -3.199882464210301, -7.322948246056431, -23.60873501848321], "policy_predator_policy_reward": [11.666314126377642, 18.91543942107709, 22.842692203934263, 24.817748322618485, 9.703381688535712, -5.671154352320622, 24.433385426923508, 7.330972817217884, -3.5273776629025053, 40.0705023713581, 12.468271087461417, 12.152666687419282, 0.5879534664259527, 40.737030172865644, 37.39943725887271, 32.67772547912972, -1.097389403425007, 38.86425477878685, 6.302106718417984, 17.11348996666625, 20.414619689290518, 33.18085218401153, 35.1255873870655, -2.097576255389022, 14.430583767041762, 22.028814307695995, 0.22923691660567158, 7.644375423657667, 0.8069793327869972, 4.889367953470253, 24.13625367752139, 12.443739315107765, 13.284620675141932, 0.9786069945939913, 19.42527474422195, 11.376343686109225, 2.9764017082406347, 22.304513418742395, 13.88098354910585, 15.819711349221286, 26.22726538968687, 20.082476781609465, 2.1913864417477473, -0.9508118911237098, 2.010150969222228, 24.677851286630244, 14.564281517345307, 12.906655058438847, 7.950378612317884, 23.258478772923976, 10.117229283726703, 25.336637874498418, 2.985581750302712, 8.956531163289117, 16.12122911217711, 2.7774075350824834, 2.887529220365627, 2.8076061924475955, 10.159373425441904, 10.770912404987751, 3.9351564892597217, 23.766671785784443, 24.866226068242863, 13.063577055041133, 37.9992680114373, 10.453977648055332, -10.496316203809764, -7.662180908890527, 10.65991363470615, 16.188978669975967, 13.971227247206224, -4.807465689917331, 1.4174907316229337, 14.073635376134066, 23.222031917284433, -2.981429748754623, 12.532944698370853, 19.622063219419758, 31.482274706683253, -0.9414951393678095, 9.215346975758443, -5.2948413738204145, 24.877201165683303, 24.43187909484081, 32.82087631231471, 9.423576416957287, 30.23330937447244, 19.10688371392167, 16.805928411891184, 14.669424651560735, 38.79904448073079, -11.522085947949986, -5.632929976652775, 15.548782140549768, 38.02319771978267, 0.6005143677124707, 2.1129397331260105, 3.199882464210301, 7.322948246056431, 23.60873501848321]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5219206681604321, "mean_inference_ms": 1.8195375063800847, "mean_action_processing_ms": 0.22113587501402507, "mean_env_wait_ms": 0.1376685279622771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005087733268737793, "StateBufferConnector_ms": 0.002631664276123047, "ViewRequirementAgentConnector_ms": 0.07883429527282715}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 482.2788588596047, "num_env_steps_trained_throughput_per_sec": 482.2788588596047, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 856000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 856000, "timers": {"training_iteration_time_ms": 8696.518, "restore_workers_time_ms": 0.025, "training_step_time_ms": 8696.301, "sample_time_ms": 1092.706, "learn_time_ms": 7573.947, "learn_throughput": 528.126, "synch_weights_time_ms": 28.47}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000}, "done": false, "training_iteration": 107, "trial_id": "1f352_00000", "date": "2024-08-11_15-11-59", "timestamp": 1723403519, "time_this_iter_s": 8.42621111869812, "time_total_s": 1030.6940624713898, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1890a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1030.6940624713898, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 46.633333333333326, "ram_util_percent": 82.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4789187680309017, "cur_kl_coeff": 3.41060513164848e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2270773110290367, "policy_loss": -0.0019369280300452374, "vf_loss": 2.229014245172342, "vf_explained_var": 0.9516998390977581, "kl": 0.004942451845632936, "entropy": 0.3898392808778832, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 103200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3908302741125227, "cur_kl_coeff": 0.00029296874999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2370567940796415, "policy_loss": -0.003432027389741658, "vf_loss": 2.240487191826105, "vf_explained_var": 0.950932200315098, "kl": 0.0055742247940740565, "entropy": 0.46429386821885904, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 103200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -47.10420126138322, "predator_policy": -11.522085947949986}, "policy_reward_max": {"prey_policy": 11.522085947949986, "predator_policy": 47.10420126138322}, "policy_reward_mean": {"prey_policy": -14.7831398847597, "predator_policy": 14.7831398847597}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.302106718417984, -17.11348996666625, -20.414619689290518, -33.18085218401153, -35.1255873870655, 2.097576255389022, -14.430583767041762, -22.028814307695995, -0.22923691660567158, -7.644375423657667, -0.8069793327869972, -4.889367953470253, -24.13625367752139, -12.443739315107765, -13.284620675141932, -0.9786069945939913, -19.42527474422195, -11.376343686109225, -2.9764017082406347, -22.304513418742395, -13.88098354910585, -15.819711349221286, -26.22726538968687, -20.082476781609465, -2.1913864417477473, 0.9508118911237098, -2.010150969222228, -24.677851286630244, -14.564281517345307, -12.906655058438847, -7.950378612317884, -23.258478772923976, -10.117229283726703, -25.336637874498418, -2.985581750302712, -8.956531163289117, -16.12122911217711, -2.7774075350824834, -2.887529220365627, -2.8076061924475955, -10.159373425441904, -10.770912404987751, -3.9351564892597217, -23.766671785784443, -24.866226068242863, -13.063577055041133, -37.9992680114373, -10.453977648055332, 10.496316203809764, 7.662180908890527, -10.65991363470615, -16.188978669975967, -13.971227247206224, 4.807465689917331, -1.4174907316229337, -14.073635376134066, -23.222031917284433, 2.981429748754623, -12.532944698370853, -19.622063219419758, -31.482274706683253, 0.9414951393678095, -9.215346975758443, 5.2948413738204145, -24.877201165683303, -24.43187909484081, -32.82087631231471, -9.423576416957287, -30.23330937447244, -19.10688371392167, -16.805928411891184, -14.669424651560735, -38.79904448073079, 11.522085947949986, 5.632929976652775, -15.548782140549768, -38.02319771978267, -0.6005143677124707, -2.1129397331260105, -3.199882464210301, -7.322948246056431, -23.60873501848321, -17.548911851375394, -42.61697691953917, -43.94185594937864, -14.861779251992456, -15.738651370930762, -17.37425753984882, -7.9449185485418425, -29.548551462573034, -47.10420126138322, -25.351606867445522, -31.14740203279079, -13.03867801031988, -15.712825328301827, -26.322525515273853, -2.912528543998371, -39.24069506753615, -27.599563641686707, -19.05785934449427], "policy_predator_policy_reward": [6.302106718417984, 17.11348996666625, 20.414619689290518, 33.18085218401153, 35.1255873870655, -2.097576255389022, 14.430583767041762, 22.028814307695995, 0.22923691660567158, 7.644375423657667, 0.8069793327869972, 4.889367953470253, 24.13625367752139, 12.443739315107765, 13.284620675141932, 0.9786069945939913, 19.42527474422195, 11.376343686109225, 2.9764017082406347, 22.304513418742395, 13.88098354910585, 15.819711349221286, 26.22726538968687, 20.082476781609465, 2.1913864417477473, -0.9508118911237098, 2.010150969222228, 24.677851286630244, 14.564281517345307, 12.906655058438847, 7.950378612317884, 23.258478772923976, 10.117229283726703, 25.336637874498418, 2.985581750302712, 8.956531163289117, 16.12122911217711, 2.7774075350824834, 2.887529220365627, 2.8076061924475955, 10.159373425441904, 10.770912404987751, 3.9351564892597217, 23.766671785784443, 24.866226068242863, 13.063577055041133, 37.9992680114373, 10.453977648055332, -10.496316203809764, -7.662180908890527, 10.65991363470615, 16.188978669975967, 13.971227247206224, -4.807465689917331, 1.4174907316229337, 14.073635376134066, 23.222031917284433, -2.981429748754623, 12.532944698370853, 19.622063219419758, 31.482274706683253, -0.9414951393678095, 9.215346975758443, -5.2948413738204145, 24.877201165683303, 24.43187909484081, 32.82087631231471, 9.423576416957287, 30.23330937447244, 19.10688371392167, 16.805928411891184, 14.669424651560735, 38.79904448073079, -11.522085947949986, -5.632929976652775, 15.548782140549768, 38.02319771978267, 0.6005143677124707, 2.1129397331260105, 3.199882464210301, 7.322948246056431, 23.60873501848321, 17.548911851375394, 42.61697691953917, 43.94185594937864, 14.861779251992456, 15.738651370930762, 17.37425753984882, 7.9449185485418425, 29.548551462573034, 47.10420126138322, 25.351606867445522, 31.14740203279079, 13.03867801031988, 15.712825328301827, 26.322525515273853, 2.912528543998371, 39.24069506753615, 27.599563641686707, 19.05785934449427]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5179897780392295, "mean_inference_ms": 1.8049622907972316, "mean_action_processing_ms": 0.2191746883755429, "mean_env_wait_ms": 0.13653732189229562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035529136657714844, "StateBufferConnector_ms": 0.002503037452697754, "ViewRequirementAgentConnector_ms": 0.06781423091888428}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 484.1184948226362, "num_env_steps_trained_throughput_per_sec": 484.1184948226362, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 8615.081, "restore_workers_time_ms": 0.025, "training_step_time_ms": 8614.884, "sample_time_ms": 1127.473, "learn_time_ms": 7458.687, "learn_throughput": 536.287, "synch_weights_time_ms": 27.645}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 108, "trial_id": "1f352_00000", "date": "2024-08-11_15-12-08", "timestamp": 1723403528, "time_this_iter_s": 8.308093070983887, "time_total_s": 1039.0021555423737, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a38dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1039.0021555423737, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 51.76666666666666, "ram_util_percent": 82.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6296438962221145, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.098041246086359, "policy_loss": -0.002381910169303107, "vf_loss": 2.1004231462876004, "vf_explained_var": 0.9586549096430341, "kl": 0.00467836856027759, "entropy": 0.350094792774568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 104160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.53860196446379, "cur_kl_coeff": 0.00029296874999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1079629539201656, "policy_loss": -0.006387301743961871, "vf_loss": 2.1143472420672578, "vf_explained_var": 0.9588758357490103, "kl": 0.010264266087434552, "entropy": 0.4623551501892507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 104160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -47.10420126138322, "predator_policy": -11.522085947949986}, "policy_reward_max": {"prey_policy": 11.522085947949986, "predator_policy": 47.10420126138322}, "policy_reward_mean": {"prey_policy": -16.51707933247502, "predator_policy": 16.51707933247502}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.9764017082406347, -22.304513418742395, -13.88098354910585, -15.819711349221286, -26.22726538968687, -20.082476781609465, -2.1913864417477473, 0.9508118911237098, -2.010150969222228, -24.677851286630244, -14.564281517345307, -12.906655058438847, -7.950378612317884, -23.258478772923976, -10.117229283726703, -25.336637874498418, -2.985581750302712, -8.956531163289117, -16.12122911217711, -2.7774075350824834, -2.887529220365627, -2.8076061924475955, -10.159373425441904, -10.770912404987751, -3.9351564892597217, -23.766671785784443, -24.866226068242863, -13.063577055041133, -37.9992680114373, -10.453977648055332, 10.496316203809764, 7.662180908890527, -10.65991363470615, -16.188978669975967, -13.971227247206224, 4.807465689917331, -1.4174907316229337, -14.073635376134066, -23.222031917284433, 2.981429748754623, -12.532944698370853, -19.622063219419758, -31.482274706683253, 0.9414951393678095, -9.215346975758443, 5.2948413738204145, -24.877201165683303, -24.43187909484081, -32.82087631231471, -9.423576416957287, -30.23330937447244, -19.10688371392167, -16.805928411891184, -14.669424651560735, -38.79904448073079, 11.522085947949986, 5.632929976652775, -15.548782140549768, -38.02319771978267, -0.6005143677124707, -2.1129397331260105, -3.199882464210301, -7.322948246056431, -23.60873501848321, -17.548911851375394, -42.61697691953917, -43.94185594937864, -14.861779251992456, -15.738651370930762, -17.37425753984882, -7.9449185485418425, -29.548551462573034, -47.10420126138322, -25.351606867445522, -31.14740203279079, -13.03867801031988, -15.712825328301827, -26.322525515273853, -2.912528543998371, -39.24069506753615, -27.599563641686707, -19.05785934449427, -17.089170886200893, -7.312656757452453, -25.373062908235177, -35.52881875744127, -22.658717468997036, -9.506085668386211, -20.714896045499785, -38.67748944551968, -22.347306006986223, -8.590992548189273, -11.114024960591015, -25.643866361482626, -40.273016807277195, -37.332158445612286, -9.083142763857278, -38.51008568688657, -41.96075212405838, -3.390977612875684], "policy_predator_policy_reward": [2.9764017082406347, 22.304513418742395, 13.88098354910585, 15.819711349221286, 26.22726538968687, 20.082476781609465, 2.1913864417477473, -0.9508118911237098, 2.010150969222228, 24.677851286630244, 14.564281517345307, 12.906655058438847, 7.950378612317884, 23.258478772923976, 10.117229283726703, 25.336637874498418, 2.985581750302712, 8.956531163289117, 16.12122911217711, 2.7774075350824834, 2.887529220365627, 2.8076061924475955, 10.159373425441904, 10.770912404987751, 3.9351564892597217, 23.766671785784443, 24.866226068242863, 13.063577055041133, 37.9992680114373, 10.453977648055332, -10.496316203809764, -7.662180908890527, 10.65991363470615, 16.188978669975967, 13.971227247206224, -4.807465689917331, 1.4174907316229337, 14.073635376134066, 23.222031917284433, -2.981429748754623, 12.532944698370853, 19.622063219419758, 31.482274706683253, -0.9414951393678095, 9.215346975758443, -5.2948413738204145, 24.877201165683303, 24.43187909484081, 32.82087631231471, 9.423576416957287, 30.23330937447244, 19.10688371392167, 16.805928411891184, 14.669424651560735, 38.79904448073079, -11.522085947949986, -5.632929976652775, 15.548782140549768, 38.02319771978267, 0.6005143677124707, 2.1129397331260105, 3.199882464210301, 7.322948246056431, 23.60873501848321, 17.548911851375394, 42.61697691953917, 43.94185594937864, 14.861779251992456, 15.738651370930762, 17.37425753984882, 7.9449185485418425, 29.548551462573034, 47.10420126138322, 25.351606867445522, 31.14740203279079, 13.03867801031988, 15.712825328301827, 26.322525515273853, 2.912528543998371, 39.24069506753615, 27.599563641686707, 19.05785934449427, 17.089170886200893, 7.312656757452453, 25.373062908235177, 35.52881875744127, 22.658717468997036, 9.506085668386211, 20.714896045499785, 38.67748944551968, 22.347306006986223, 8.590992548189273, 11.114024960591015, 25.643866361482626, 40.273016807277195, 37.332158445612286, 9.083142763857278, 38.51008568688657, 41.96075212405838, 3.390977612875684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5170592103138008, "mean_inference_ms": 1.8008702029869312, "mean_action_processing_ms": 0.2187947060918072, "mean_env_wait_ms": 0.1362014456026019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035303831100463867, "StateBufferConnector_ms": 0.0024448633193969727, "ViewRequirementAgentConnector_ms": 0.06971871852874756}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 475.67301392912674, "num_env_steps_trained_throughput_per_sec": 475.67301392912674, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 872000, "timers": {"training_iteration_time_ms": 8496.758, "restore_workers_time_ms": 0.025, "training_step_time_ms": 8496.568, "sample_time_ms": 1109.358, "learn_time_ms": 7357.705, "learn_throughput": 543.648, "synch_weights_time_ms": 28.496}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000}, "done": false, "training_iteration": 109, "trial_id": "1f352_00000", "date": "2024-08-11_15-12-16", "timestamp": 1723403536, "time_this_iter_s": 8.472588062286377, "time_total_s": 1047.47474360466, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1aba550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1047.47474360466, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 48.324999999999996, "ram_util_percent": 82.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2182015902052323, "cur_kl_coeff": 8.5265128291212e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4532190265754859, "policy_loss": -0.0029292940778153326, "vf_loss": 1.4561483167732756, "vf_explained_var": 0.9719510795548558, "kl": 0.002190033093080975, "entropy": 0.29194578607566657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 105120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.271210394613445, "cur_kl_coeff": 0.00029296874999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.468665147634844, "policy_loss": -0.0027913575861020943, "vf_loss": 1.4714550625532865, "vf_explained_var": 0.9712874363486965, "kl": 0.00492246877051078, "entropy": 0.43770282439266645, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 105120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.35270534457543, "predator_policy": -19.611621008603652}, "policy_reward_max": {"prey_policy": 19.611621008603652, "predator_policy": 52.35270534457543}, "policy_reward_mean": {"prey_policy": -18.289630367062813, "predator_policy": 18.289630367062813}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.770912404987751, -3.9351564892597217, -23.766671785784443, -24.866226068242863, -13.063577055041133, -37.9992680114373, -10.453977648055332, 10.496316203809764, 7.662180908890527, -10.65991363470615, -16.188978669975967, -13.971227247206224, 4.807465689917331, -1.4174907316229337, -14.073635376134066, -23.222031917284433, 2.981429748754623, -12.532944698370853, -19.622063219419758, -31.482274706683253, 0.9414951393678095, -9.215346975758443, 5.2948413738204145, -24.877201165683303, -24.43187909484081, -32.82087631231471, -9.423576416957287, -30.23330937447244, -19.10688371392167, -16.805928411891184, -14.669424651560735, -38.79904448073079, 11.522085947949986, 5.632929976652775, -15.548782140549768, -38.02319771978267, -0.6005143677124707, -2.1129397331260105, -3.199882464210301, -7.322948246056431, -23.60873501848321, -17.548911851375394, -42.61697691953917, -43.94185594937864, -14.861779251992456, -15.738651370930762, -17.37425753984882, -7.9449185485418425, -29.548551462573034, -47.10420126138322, -25.351606867445522, -31.14740203279079, -13.03867801031988, -15.712825328301827, -26.322525515273853, -2.912528543998371, -39.24069506753615, -27.599563641686707, -19.05785934449427, -17.089170886200893, -7.312656757452453, -25.373062908235177, -35.52881875744127, -22.658717468997036, -9.506085668386211, -20.714896045499785, -38.67748944551968, -22.347306006986223, -8.590992548189273, -11.114024960591015, -25.643866361482626, -40.273016807277195, -37.332158445612286, -9.083142763857278, -38.51008568688657, -41.96075212405838, -3.390977612875684, -29.409228780941127, -52.35270534457543, -24.91509259267474, -35.435518777781375, -17.327693911157553, -12.379113584685266, 19.611621008603652, -17.42424613864099, -27.90135655326313, 4.745921911252015, -28.159146248960518, -32.57746835968746, -12.809825260701146, -12.028615088259341, -23.002549409756135, -5.397754201540485, -39.147931031966216, 12.047721203641547, -18.99061731842646, -24.87785366804223, -43.14912871314165, -16.95776481802266, -9.465606301493782], "policy_predator_policy_reward": [10.770912404987751, 3.9351564892597217, 23.766671785784443, 24.866226068242863, 13.063577055041133, 37.9992680114373, 10.453977648055332, -10.496316203809764, -7.662180908890527, 10.65991363470615, 16.188978669975967, 13.971227247206224, -4.807465689917331, 1.4174907316229337, 14.073635376134066, 23.222031917284433, -2.981429748754623, 12.532944698370853, 19.622063219419758, 31.482274706683253, -0.9414951393678095, 9.215346975758443, -5.2948413738204145, 24.877201165683303, 24.43187909484081, 32.82087631231471, 9.423576416957287, 30.23330937447244, 19.10688371392167, 16.805928411891184, 14.669424651560735, 38.79904448073079, -11.522085947949986, -5.632929976652775, 15.548782140549768, 38.02319771978267, 0.6005143677124707, 2.1129397331260105, 3.199882464210301, 7.322948246056431, 23.60873501848321, 17.548911851375394, 42.61697691953917, 43.94185594937864, 14.861779251992456, 15.738651370930762, 17.37425753984882, 7.9449185485418425, 29.548551462573034, 47.10420126138322, 25.351606867445522, 31.14740203279079, 13.03867801031988, 15.712825328301827, 26.322525515273853, 2.912528543998371, 39.24069506753615, 27.599563641686707, 19.05785934449427, 17.089170886200893, 7.312656757452453, 25.373062908235177, 35.52881875744127, 22.658717468997036, 9.506085668386211, 20.714896045499785, 38.67748944551968, 22.347306006986223, 8.590992548189273, 11.114024960591015, 25.643866361482626, 40.273016807277195, 37.332158445612286, 9.083142763857278, 38.51008568688657, 41.96075212405838, 3.390977612875684, 29.409228780941127, 52.35270534457543, 24.91509259267474, 35.435518777781375, 17.327693911157553, 12.379113584685266, -19.611621008603652, 17.42424613864099, 27.90135655326313, -4.745921911252015, 28.159146248960518, 32.57746835968746, 12.809825260701146, 12.028615088259341, 23.002549409756135, 5.397754201540485, 39.147931031966216, -12.047721203641547, 18.99061731842646, 24.87785366804223, 43.14912871314165, 16.95776481802266, 9.465606301493782]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5159838712655069, "mean_inference_ms": 1.7961326898759977, "mean_action_processing_ms": 0.21833178718435356, "mean_env_wait_ms": 0.13581445822836005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00415492057800293, "StateBufferConnector_ms": 0.002859950065612793, "ViewRequirementAgentConnector_ms": 0.09171903133392334}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 436.13220263631337, "num_env_steps_trained_throughput_per_sec": 436.13220263631337, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 8496.005, "restore_workers_time_ms": 0.025, "training_step_time_ms": 8494.655, "sample_time_ms": 1113.854, "learn_time_ms": 7339.64, "learn_throughput": 544.986, "synch_weights_time_ms": 35.596}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 110, "trial_id": "1f352_00000", "date": "2024-08-11_15-12-26", "timestamp": 1723403546, "time_this_iter_s": 9.452991008758545, "time_total_s": 1056.9277346134186, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a7f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1056.9277346134186, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 53.32857142857142, "ram_util_percent": 82.87857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5568557313332954, "cur_kl_coeff": 4.2632564145606e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8190998766571282, "policy_loss": -0.0005661247904451254, "vf_loss": 1.8196660065402588, "vf_explained_var": 0.9556821352491777, "kl": 0.0017552056948040037, "entropy": 0.3296697889609883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 106080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5912991077949603, "cur_kl_coeff": 0.00014648437499999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8050285221387943, "policy_loss": -0.005593677803214329, "vf_loss": 1.8106211060037216, "vf_explained_var": 0.9560070067023237, "kl": 0.007467436066564361, "entropy": 0.433731974195689, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 106080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.35270534457543, "predator_policy": -19.611621008603652}, "policy_reward_max": {"prey_policy": 19.611621008603652, "predator_policy": 52.35270534457543}, "policy_reward_mean": {"prey_policy": -19.45241577896541, "predator_policy": 19.45241577896541}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-19.622063219419758, -31.482274706683253, 0.9414951393678095, -9.215346975758443, 5.2948413738204145, -24.877201165683303, -24.43187909484081, -32.82087631231471, -9.423576416957287, -30.23330937447244, -19.10688371392167, -16.805928411891184, -14.669424651560735, -38.79904448073079, 11.522085947949986, 5.632929976652775, -15.548782140549768, -38.02319771978267, -0.6005143677124707, -2.1129397331260105, -3.199882464210301, -7.322948246056431, -23.60873501848321, -17.548911851375394, -42.61697691953917, -43.94185594937864, -14.861779251992456, -15.738651370930762, -17.37425753984882, -7.9449185485418425, -29.548551462573034, -47.10420126138322, -25.351606867445522, -31.14740203279079, -13.03867801031988, -15.712825328301827, -26.322525515273853, -2.912528543998371, -39.24069506753615, -27.599563641686707, -19.05785934449427, -17.089170886200893, -7.312656757452453, -25.373062908235177, -35.52881875744127, -22.658717468997036, -9.506085668386211, -20.714896045499785, -38.67748944551968, -22.347306006986223, -8.590992548189273, -11.114024960591015, -25.643866361482626, -40.273016807277195, -37.332158445612286, -9.083142763857278, -38.51008568688657, -41.96075212405838, -3.390977612875684, -29.409228780941127, -52.35270534457543, -24.91509259267474, -35.435518777781375, -17.327693911157553, -12.379113584685266, 19.611621008603652, -17.42424613864099, -27.90135655326313, 4.745921911252015, -28.159146248960518, -32.57746835968746, -12.809825260701146, -12.028615088259341, -23.002549409756135, -5.397754201540485, -39.147931031966216, 12.047721203641547, -18.99061731842646, -24.87785366804223, -43.14912871314165, -16.95776481802266, -9.465606301493782, -27.661344675448014, 4.234952537599816, -23.16976522515656, -33.2738423074671, -1.7221824027490449, -27.38616698542752, -32.18068021614697, -15.882272990366088, -2.1935350368224498, -39.28292152033261, -16.953875760577787, -25.070978079137884, -10.530147278368098, -4.4964199738609, -4.374199055835145, 8.237972097197181, -33.584939815246244, -21.962813688851398], "policy_predator_policy_reward": [19.622063219419758, 31.482274706683253, -0.9414951393678095, 9.215346975758443, -5.2948413738204145, 24.877201165683303, 24.43187909484081, 32.82087631231471, 9.423576416957287, 30.23330937447244, 19.10688371392167, 16.805928411891184, 14.669424651560735, 38.79904448073079, -11.522085947949986, -5.632929976652775, 15.548782140549768, 38.02319771978267, 0.6005143677124707, 2.1129397331260105, 3.199882464210301, 7.322948246056431, 23.60873501848321, 17.548911851375394, 42.61697691953917, 43.94185594937864, 14.861779251992456, 15.738651370930762, 17.37425753984882, 7.9449185485418425, 29.548551462573034, 47.10420126138322, 25.351606867445522, 31.14740203279079, 13.03867801031988, 15.712825328301827, 26.322525515273853, 2.912528543998371, 39.24069506753615, 27.599563641686707, 19.05785934449427, 17.089170886200893, 7.312656757452453, 25.373062908235177, 35.52881875744127, 22.658717468997036, 9.506085668386211, 20.714896045499785, 38.67748944551968, 22.347306006986223, 8.590992548189273, 11.114024960591015, 25.643866361482626, 40.273016807277195, 37.332158445612286, 9.083142763857278, 38.51008568688657, 41.96075212405838, 3.390977612875684, 29.409228780941127, 52.35270534457543, 24.91509259267474, 35.435518777781375, 17.327693911157553, 12.379113584685266, -19.611621008603652, 17.42424613864099, 27.90135655326313, -4.745921911252015, 28.159146248960518, 32.57746835968746, 12.809825260701146, 12.028615088259341, 23.002549409756135, 5.397754201540485, 39.147931031966216, -12.047721203641547, 18.99061731842646, 24.87785366804223, 43.14912871314165, 16.95776481802266, 9.465606301493782, 27.661344675448014, -4.234952537599816, 23.16976522515656, 33.2738423074671, 1.7221824027490449, 27.38616698542752, 32.18068021614697, 15.882272990366088, 2.1935350368224498, 39.28292152033261, 16.953875760577787, 25.070978079137884, 10.530147278368098, 4.4964199738609, 4.374199055835145, -8.237972097197181, 33.584939815246244, 21.962813688851398]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.515441641473386, "mean_inference_ms": 1.7941548924104456, "mean_action_processing_ms": 0.2181764848435433, "mean_env_wait_ms": 0.13560582097804041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004403352737426758, "StateBufferConnector_ms": 0.002926945686340332, "ViewRequirementAgentConnector_ms": 0.11655867099761963}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 426.160810957554, "num_env_steps_trained_throughput_per_sec": 426.160810957554, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 8521.574, "restore_workers_time_ms": 0.026, "training_step_time_ms": 8520.222, "sample_time_ms": 1158.392, "learn_time_ms": 7320.719, "learn_throughput": 546.394, "synch_weights_time_ms": 35.472}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "training_iteration": 111, "trial_id": "1f352_00000", "date": "2024-08-11_15-12-35", "timestamp": 1723403555, "time_this_iter_s": 9.42565107345581, "time_total_s": 1066.3533856868744, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b188e820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1066.3533856868744, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 55.76153846153845, "ram_util_percent": 82.85384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.255022223293781, "cur_kl_coeff": 2.1316282072803e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.906852485984564, "policy_loss": -0.0029300794512285696, "vf_loss": 1.9097825647642215, "vf_explained_var": 0.9615414661044875, "kl": 0.004610969294842681, "entropy": 0.3504024027846754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 107040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.279849432595074, "cur_kl_coeff": 0.00014648437499999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.910314592408637, "policy_loss": -0.005458885864694215, "vf_loss": 1.9157726507633925, "vf_explained_var": 0.9615548631797234, "kl": 0.005625297989434099, "entropy": 0.43531354945153, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 107040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.35270534457543, "predator_policy": -19.611621008603652}, "policy_reward_max": {"prey_policy": 19.611621008603652, "predator_policy": 52.35270534457543}, "policy_reward_mean": {"prey_policy": -20.056155295743846, "predator_policy": 20.056155295743846}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-23.60873501848321, -17.548911851375394, -42.61697691953917, -43.94185594937864, -14.861779251992456, -15.738651370930762, -17.37425753984882, -7.9449185485418425, -29.548551462573034, -47.10420126138322, -25.351606867445522, -31.14740203279079, -13.03867801031988, -15.712825328301827, -26.322525515273853, -2.912528543998371, -39.24069506753615, -27.599563641686707, -19.05785934449427, -17.089170886200893, -7.312656757452453, -25.373062908235177, -35.52881875744127, -22.658717468997036, -9.506085668386211, -20.714896045499785, -38.67748944551968, -22.347306006986223, -8.590992548189273, -11.114024960591015, -25.643866361482626, -40.273016807277195, -37.332158445612286, -9.083142763857278, -38.51008568688657, -41.96075212405838, -3.390977612875684, -29.409228780941127, -52.35270534457543, -24.91509259267474, -35.435518777781375, -17.327693911157553, -12.379113584685266, 19.611621008603652, -17.42424613864099, -27.90135655326313, 4.745921911252015, -28.159146248960518, -32.57746835968746, -12.809825260701146, -12.028615088259341, -23.002549409756135, -5.397754201540485, -39.147931031966216, 12.047721203641547, -18.99061731842646, -24.87785366804223, -43.14912871314165, -16.95776481802266, -9.465606301493782, -27.661344675448014, 4.234952537599816, -23.16976522515656, -33.2738423074671, -1.7221824027490449, -27.38616698542752, -32.18068021614697, -15.882272990366088, -2.1935350368224498, -39.28292152033261, -16.953875760577787, -25.070978079137884, -10.530147278368098, -4.4964199738609, -4.374199055835145, 8.237972097197181, -33.584939815246244, -21.962813688851398, -10.875124632920521, -15.22884055009123, -7.939664686790009, -24.84092455056938, -19.428992125300066, -30.849739652148187, -30.414033899593026, -17.028822976674157, -28.747214849240535, -30.563239151681387, -36.73541985286246, -8.951250190709198, 8.410355325024934, -7.887845874094984, -6.776293633728537, -26.945867868802186, -22.301678549009434, 2.960641808754689, -31.00497121132588, -9.49069476028881, -6.328192955980493, -14.310857597693214], "policy_predator_policy_reward": [23.60873501848321, 17.548911851375394, 42.61697691953917, 43.94185594937864, 14.861779251992456, 15.738651370930762, 17.37425753984882, 7.9449185485418425, 29.548551462573034, 47.10420126138322, 25.351606867445522, 31.14740203279079, 13.03867801031988, 15.712825328301827, 26.322525515273853, 2.912528543998371, 39.24069506753615, 27.599563641686707, 19.05785934449427, 17.089170886200893, 7.312656757452453, 25.373062908235177, 35.52881875744127, 22.658717468997036, 9.506085668386211, 20.714896045499785, 38.67748944551968, 22.347306006986223, 8.590992548189273, 11.114024960591015, 25.643866361482626, 40.273016807277195, 37.332158445612286, 9.083142763857278, 38.51008568688657, 41.96075212405838, 3.390977612875684, 29.409228780941127, 52.35270534457543, 24.91509259267474, 35.435518777781375, 17.327693911157553, 12.379113584685266, -19.611621008603652, 17.42424613864099, 27.90135655326313, -4.745921911252015, 28.159146248960518, 32.57746835968746, 12.809825260701146, 12.028615088259341, 23.002549409756135, 5.397754201540485, 39.147931031966216, -12.047721203641547, 18.99061731842646, 24.87785366804223, 43.14912871314165, 16.95776481802266, 9.465606301493782, 27.661344675448014, -4.234952537599816, 23.16976522515656, 33.2738423074671, 1.7221824027490449, 27.38616698542752, 32.18068021614697, 15.882272990366088, 2.1935350368224498, 39.28292152033261, 16.953875760577787, 25.070978079137884, 10.530147278368098, 4.4964199738609, 4.374199055835145, -8.237972097197181, 33.584939815246244, 21.962813688851398, 10.875124632920521, 15.22884055009123, 7.939664686790009, 24.84092455056938, 19.428992125300066, 30.849739652148187, 30.414033899593026, 17.028822976674157, 28.747214849240535, 30.563239151681387, 36.73541985286246, 8.951250190709198, -8.410355325024934, 7.887845874094984, 6.776293633728537, 26.945867868802186, 22.301678549009434, -2.960641808754689, 31.00497121132588, 9.49069476028881, 6.328192955980493, 14.310857597693214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.514887978013366, "mean_inference_ms": 1.791997014316977, "mean_action_processing_ms": 0.2180420888585926, "mean_env_wait_ms": 0.13537275782532393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00450444221496582, "StateBufferConnector_ms": 0.0030709505081176758, "ViewRequirementAgentConnector_ms": 0.11934781074523926}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.42928209504373, "num_env_steps_trained_throughput_per_sec": 441.42928209504373, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 8597.063, "restore_workers_time_ms": 0.026, "training_step_time_ms": 8595.712, "sample_time_ms": 1107.256, "learn_time_ms": 7445.311, "learn_throughput": 537.251, "synch_weights_time_ms": 37.428}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 112, "trial_id": "1f352_00000", "date": "2024-08-11_15-12-44", "timestamp": 1723403564, "time_this_iter_s": 9.121503114700317, "time_total_s": 1075.4748888015747, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b188e790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1075.4748888015747, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 51.92307692307692, "ram_util_percent": 82.56153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8439980361610653, "cur_kl_coeff": 1.06581410364015e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.413728195677201, "policy_loss": -0.002227526677112716, "vf_loss": 2.4159557105352483, "vf_explained_var": 0.9463249926144878, "kl": 0.003222309733641519, "entropy": 0.3634778921181957, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8865489123389123, "cur_kl_coeff": 0.00014648437499999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4495799517879884, "policy_loss": -0.004526377931082, "vf_loss": 2.454105328892668, "vf_explained_var": 0.9453767255569497, "kl": 0.0068772301271907265, "entropy": 0.44430656752859554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.35270534457543, "predator_policy": -19.611621008603652}, "policy_reward_max": {"prey_policy": 19.611621008603652, "predator_policy": 52.35270534457543}, "policy_reward_mean": {"prey_policy": -19.92300772319879, "predator_policy": 19.92300772319879}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-19.05785934449427, -17.089170886200893, -7.312656757452453, -25.373062908235177, -35.52881875744127, -22.658717468997036, -9.506085668386211, -20.714896045499785, -38.67748944551968, -22.347306006986223, -8.590992548189273, -11.114024960591015, -25.643866361482626, -40.273016807277195, -37.332158445612286, -9.083142763857278, -38.51008568688657, -41.96075212405838, -3.390977612875684, -29.409228780941127, -52.35270534457543, -24.91509259267474, -35.435518777781375, -17.327693911157553, -12.379113584685266, 19.611621008603652, -17.42424613864099, -27.90135655326313, 4.745921911252015, -28.159146248960518, -32.57746835968746, -12.809825260701146, -12.028615088259341, -23.002549409756135, -5.397754201540485, -39.147931031966216, 12.047721203641547, -18.99061731842646, -24.87785366804223, -43.14912871314165, -16.95776481802266, -9.465606301493782, -27.661344675448014, 4.234952537599816, -23.16976522515656, -33.2738423074671, -1.7221824027490449, -27.38616698542752, -32.18068021614697, -15.882272990366088, -2.1935350368224498, -39.28292152033261, -16.953875760577787, -25.070978079137884, -10.530147278368098, -4.4964199738609, -4.374199055835145, 8.237972097197181, -33.584939815246244, -21.962813688851398, -10.875124632920521, -15.22884055009123, -7.939664686790009, -24.84092455056938, -19.428992125300066, -30.849739652148187, -30.414033899593026, -17.028822976674157, -28.747214849240535, -30.563239151681387, -36.73541985286246, -8.951250190709198, 8.410355325024934, -7.887845874094984, -6.776293633728537, -26.945867868802186, -22.301678549009434, 2.960641808754689, -31.00497121132588, -9.49069476028881, -6.328192955980493, -14.310857597693214, -37.15340554641801, -26.928144562004302, -43.61922870043355, -12.25625281754696, -43.28337419048016, -19.97399203190966, -17.11192074157188, -25.320583283896458, -37.84090058751782, 6.639072207315177, -36.56412117188029, -18.133508387417734, -44.225338818116136, -13.77464490863741, -1.2484273121862097, 5.375846599962285, -38.13708476734592, -24.743897906809174], "policy_predator_policy_reward": [19.05785934449427, 17.089170886200893, 7.312656757452453, 25.373062908235177, 35.52881875744127, 22.658717468997036, 9.506085668386211, 20.714896045499785, 38.67748944551968, 22.347306006986223, 8.590992548189273, 11.114024960591015, 25.643866361482626, 40.273016807277195, 37.332158445612286, 9.083142763857278, 38.51008568688657, 41.96075212405838, 3.390977612875684, 29.409228780941127, 52.35270534457543, 24.91509259267474, 35.435518777781375, 17.327693911157553, 12.379113584685266, -19.611621008603652, 17.42424613864099, 27.90135655326313, -4.745921911252015, 28.159146248960518, 32.57746835968746, 12.809825260701146, 12.028615088259341, 23.002549409756135, 5.397754201540485, 39.147931031966216, -12.047721203641547, 18.99061731842646, 24.87785366804223, 43.14912871314165, 16.95776481802266, 9.465606301493782, 27.661344675448014, -4.234952537599816, 23.16976522515656, 33.2738423074671, 1.7221824027490449, 27.38616698542752, 32.18068021614697, 15.882272990366088, 2.1935350368224498, 39.28292152033261, 16.953875760577787, 25.070978079137884, 10.530147278368098, 4.4964199738609, 4.374199055835145, -8.237972097197181, 33.584939815246244, 21.962813688851398, 10.875124632920521, 15.22884055009123, 7.939664686790009, 24.84092455056938, 19.428992125300066, 30.849739652148187, 30.414033899593026, 17.028822976674157, 28.747214849240535, 30.563239151681387, 36.73541985286246, 8.951250190709198, -8.410355325024934, 7.887845874094984, 6.776293633728537, 26.945867868802186, 22.301678549009434, -2.960641808754689, 31.00497121132588, 9.49069476028881, 6.328192955980493, 14.310857597693214, 37.15340554641801, 26.928144562004302, 43.61922870043355, 12.25625281754696, 43.28337419048016, 19.97399203190966, 17.11192074157188, 25.320583283896458, 37.84090058751782, -6.639072207315177, 36.56412117188029, 18.133508387417734, 44.225338818116136, 13.77464490863741, 1.2484273121862097, -5.375846599962285, 38.13708476734592, 24.743897906809174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5147838128653381, "mean_inference_ms": 1.7913365191871702, "mean_action_processing_ms": 0.21802082015277666, "mean_env_wait_ms": 0.13527600086130295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044667720794677734, "StateBufferConnector_ms": 0.003895878791809082, "ViewRequirementAgentConnector_ms": 0.13315176963806152}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 398.7118851186513, "num_env_steps_trained_throughput_per_sec": 398.7118851186513, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 904000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 904000, "timers": {"training_iteration_time_ms": 8706.467, "restore_workers_time_ms": 0.025, "training_step_time_ms": 8705.119, "sample_time_ms": 1128.817, "learn_time_ms": 7533.24, "learn_throughput": 530.98, "synch_weights_time_ms": 37.314}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000}, "done": false, "training_iteration": 113, "trial_id": "1f352_00000", "date": "2024-08-11_15-12-54", "timestamp": 1723403574, "time_this_iter_s": 10.09827184677124, "time_total_s": 1085.573160648346, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1af1790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1085.573160648346, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 55.221428571428575, "ram_util_percent": 83.08571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.950322436913848, "cur_kl_coeff": 5.32907051820075e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.625178674484293, "policy_loss": -0.0021345684789897254, "vf_loss": 2.6273132553944984, "vf_explained_var": 0.9419773884738485, "kl": 0.00358319461706742, "entropy": 0.33733088718727233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.967858772786955, "cur_kl_coeff": 0.00014648437499999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.595361007253329, "policy_loss": -0.0030089792771226106, "vf_loss": 2.5983689560244483, "vf_explained_var": 0.9428219397862753, "kl": 0.007081311042781083, "entropy": 0.42341435377796494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -48.5185202653751, "predator_policy": -19.611621008603652}, "policy_reward_max": {"prey_policy": 19.611621008603652, "predator_policy": 48.5185202653751}, "policy_reward_mean": {"prey_policy": -18.376142821468378, "predator_policy": 18.376142821468378}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.327693911157553, -12.379113584685266, 19.611621008603652, -17.42424613864099, -27.90135655326313, 4.745921911252015, -28.159146248960518, -32.57746835968746, -12.809825260701146, -12.028615088259341, -23.002549409756135, -5.397754201540485, -39.147931031966216, 12.047721203641547, -18.99061731842646, -24.87785366804223, -43.14912871314165, -16.95776481802266, -9.465606301493782, -27.661344675448014, 4.234952537599816, -23.16976522515656, -33.2738423074671, -1.7221824027490449, -27.38616698542752, -32.18068021614697, -15.882272990366088, -2.1935350368224498, -39.28292152033261, -16.953875760577787, -25.070978079137884, -10.530147278368098, -4.4964199738609, -4.374199055835145, 8.237972097197181, -33.584939815246244, -21.962813688851398, -10.875124632920521, -15.22884055009123, -7.939664686790009, -24.84092455056938, -19.428992125300066, -30.849739652148187, -30.414033899593026, -17.028822976674157, -28.747214849240535, -30.563239151681387, -36.73541985286246, -8.951250190709198, 8.410355325024934, -7.887845874094984, -6.776293633728537, -26.945867868802186, -22.301678549009434, 2.960641808754689, -31.00497121132588, -9.49069476028881, -6.328192955980493, -14.310857597693214, -37.15340554641801, -26.928144562004302, -43.61922870043355, -12.25625281754696, -43.28337419048016, -19.97399203190966, -17.11192074157188, -25.320583283896458, -37.84090058751782, 6.639072207315177, -36.56412117188029, -18.133508387417734, -44.225338818116136, -13.77464490863741, -1.2484273121862097, 5.375846599962285, -38.13708476734592, -24.743897906809174, -20.570790970289313, -27.23668602666087, -20.452224154112685, -12.04024476240617, -9.538828502158186, -30.769577705249414, -30.55265173376673, -21.91292121721954, -8.065964809654178, -20.936465268189448, -39.043934087541956, -36.25626854284762, 9.770627604725114, -4.542398297686333, -5.994891619198727, -12.577645375402799, -2.675668632714043, -27.864694589489673, -48.5185202653751, -12.166270053197051, -1.4826197005812176, -2.23061809575767, -35.93187911820132], "policy_predator_policy_reward": [17.327693911157553, 12.379113584685266, -19.611621008603652, 17.42424613864099, 27.90135655326313, -4.745921911252015, 28.159146248960518, 32.57746835968746, 12.809825260701146, 12.028615088259341, 23.002549409756135, 5.397754201540485, 39.147931031966216, -12.047721203641547, 18.99061731842646, 24.87785366804223, 43.14912871314165, 16.95776481802266, 9.465606301493782, 27.661344675448014, -4.234952537599816, 23.16976522515656, 33.2738423074671, 1.7221824027490449, 27.38616698542752, 32.18068021614697, 15.882272990366088, 2.1935350368224498, 39.28292152033261, 16.953875760577787, 25.070978079137884, 10.530147278368098, 4.4964199738609, 4.374199055835145, -8.237972097197181, 33.584939815246244, 21.962813688851398, 10.875124632920521, 15.22884055009123, 7.939664686790009, 24.84092455056938, 19.428992125300066, 30.849739652148187, 30.414033899593026, 17.028822976674157, 28.747214849240535, 30.563239151681387, 36.73541985286246, 8.951250190709198, -8.410355325024934, 7.887845874094984, 6.776293633728537, 26.945867868802186, 22.301678549009434, -2.960641808754689, 31.00497121132588, 9.49069476028881, 6.328192955980493, 14.310857597693214, 37.15340554641801, 26.928144562004302, 43.61922870043355, 12.25625281754696, 43.28337419048016, 19.97399203190966, 17.11192074157188, 25.320583283896458, 37.84090058751782, -6.639072207315177, 36.56412117188029, 18.133508387417734, 44.225338818116136, 13.77464490863741, 1.2484273121862097, -5.375846599962285, 38.13708476734592, 24.743897906809174, 20.570790970289313, 27.23668602666087, 20.452224154112685, 12.04024476240617, 9.538828502158186, 30.769577705249414, 30.55265173376673, 21.91292121721954, 8.065964809654178, 20.936465268189448, 39.043934087541956, 36.25626854284762, -9.770627604725114, 4.542398297686333, 5.994891619198727, 12.577645375402799, 2.675668632714043, 27.864694589489673, 48.5185202653751, 12.166270053197051, 1.4826197005812176, 2.23061809575767, 35.93187911820132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5154827820787472, "mean_inference_ms": 1.79190704304969, "mean_action_processing_ms": 0.21811891038524236, "mean_env_wait_ms": 0.13522661184553464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004637479782104492, "StateBufferConnector_ms": 0.004010915756225586, "ViewRequirementAgentConnector_ms": 0.14008712768554688}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 388.1290353147763, "num_env_steps_trained_throughput_per_sec": 388.1290353147763, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 8893.433, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8892.016, "sample_time_ms": 1201.58, "learn_time_ms": 7648.41, "learn_throughput": 522.985, "synch_weights_time_ms": 36.064}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 114, "trial_id": "1f352_00000", "date": "2024-08-11_15-13-05", "timestamp": 1723403585, "time_this_iter_s": 10.370264053344727, "time_total_s": 1095.9434247016907, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a5b8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1095.9434247016907, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 56.120000000000005, "ram_util_percent": 82.49999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.703871128770212, "cur_kl_coeff": 2.664535259100375e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.729606500454247, "policy_loss": -0.00290795831339589, "vf_loss": 2.732514456473291, "vf_explained_var": 0.9245983911057313, "kl": 0.004644654821054647, "entropy": 0.3037303994099299, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 109920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7722448612252872, "cur_kl_coeff": 0.00014648437499999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.709495356678963, "policy_loss": -0.00894233244713784, "vf_loss": 2.718436180676023, "vf_explained_var": 0.9246836914991339, "kl": 0.01034598852679089, "entropy": 0.4528576787561178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 109920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -48.5185202653751, "predator_policy": -9.770627604725114}, "policy_reward_max": {"prey_policy": 9.770627604725114, "predator_policy": 48.5185202653751}, "policy_reward_mean": {"prey_policy": -18.876855537158633, "predator_policy": 18.876855537158633}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.465606301493782, -27.661344675448014, 4.234952537599816, -23.16976522515656, -33.2738423074671, -1.7221824027490449, -27.38616698542752, -32.18068021614697, -15.882272990366088, -2.1935350368224498, -39.28292152033261, -16.953875760577787, -25.070978079137884, -10.530147278368098, -4.4964199738609, -4.374199055835145, 8.237972097197181, -33.584939815246244, -21.962813688851398, -10.875124632920521, -15.22884055009123, -7.939664686790009, -24.84092455056938, -19.428992125300066, -30.849739652148187, -30.414033899593026, -17.028822976674157, -28.747214849240535, -30.563239151681387, -36.73541985286246, -8.951250190709198, 8.410355325024934, -7.887845874094984, -6.776293633728537, -26.945867868802186, -22.301678549009434, 2.960641808754689, -31.00497121132588, -9.49069476028881, -6.328192955980493, -14.310857597693214, -37.15340554641801, -26.928144562004302, -43.61922870043355, -12.25625281754696, -43.28337419048016, -19.97399203190966, -17.11192074157188, -25.320583283896458, -37.84090058751782, 6.639072207315177, -36.56412117188029, -18.133508387417734, -44.225338818116136, -13.77464490863741, -1.2484273121862097, 5.375846599962285, -38.13708476734592, -24.743897906809174, -20.570790970289313, -27.23668602666087, -20.452224154112685, -12.04024476240617, -9.538828502158186, -30.769577705249414, -30.55265173376673, -21.91292121721954, -8.065964809654178, -20.936465268189448, -39.043934087541956, -36.25626854284762, 9.770627604725114, -4.542398297686333, -5.994891619198727, -12.577645375402799, -2.675668632714043, -27.864694589489673, -48.5185202653751, -12.166270053197051, -1.4826197005812176, -2.23061809575767, -35.93187911820132, -22.02117188441268, -9.414658227794053, -14.22685008842923, -8.908730025286484, -12.249081144867791, -4.9667674007804, -25.165319192501848, -17.896890913704304, -38.09273218658815, 2.6856292512160405, -9.331767669168128, -41.171977805097015, -35.762094501470315, -20.50252924925543, -24.31984988745306, -13.873478779554357, -20.85794160340889, -29.720860443223465], "policy_predator_policy_reward": [9.465606301493782, 27.661344675448014, -4.234952537599816, 23.16976522515656, 33.2738423074671, 1.7221824027490449, 27.38616698542752, 32.18068021614697, 15.882272990366088, 2.1935350368224498, 39.28292152033261, 16.953875760577787, 25.070978079137884, 10.530147278368098, 4.4964199738609, 4.374199055835145, -8.237972097197181, 33.584939815246244, 21.962813688851398, 10.875124632920521, 15.22884055009123, 7.939664686790009, 24.84092455056938, 19.428992125300066, 30.849739652148187, 30.414033899593026, 17.028822976674157, 28.747214849240535, 30.563239151681387, 36.73541985286246, 8.951250190709198, -8.410355325024934, 7.887845874094984, 6.776293633728537, 26.945867868802186, 22.301678549009434, -2.960641808754689, 31.00497121132588, 9.49069476028881, 6.328192955980493, 14.310857597693214, 37.15340554641801, 26.928144562004302, 43.61922870043355, 12.25625281754696, 43.28337419048016, 19.97399203190966, 17.11192074157188, 25.320583283896458, 37.84090058751782, -6.639072207315177, 36.56412117188029, 18.133508387417734, 44.225338818116136, 13.77464490863741, 1.2484273121862097, -5.375846599962285, 38.13708476734592, 24.743897906809174, 20.570790970289313, 27.23668602666087, 20.452224154112685, 12.04024476240617, 9.538828502158186, 30.769577705249414, 30.55265173376673, 21.91292121721954, 8.065964809654178, 20.936465268189448, 39.043934087541956, 36.25626854284762, -9.770627604725114, 4.542398297686333, 5.994891619198727, 12.577645375402799, 2.675668632714043, 27.864694589489673, 48.5185202653751, 12.166270053197051, 1.4826197005812176, 2.23061809575767, 35.93187911820132, 22.02117188441268, 9.414658227794053, 14.22685008842923, 8.908730025286484, 12.249081144867791, 4.9667674007804, 25.165319192501848, 17.896890913704304, 38.09273218658815, -2.6856292512160405, 9.331767669168128, 41.171977805097015, 35.762094501470315, 20.50252924925543, 24.31984988745306, 13.873478779554357, 20.85794160340889, 29.720860443223465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5147014396491052, "mean_inference_ms": 1.7916804547131908, "mean_action_processing_ms": 0.21800357155374195, "mean_env_wait_ms": 0.1352142709246477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044062137603759766, "StateBufferConnector_ms": 0.003645777702331543, "ViewRequirementAgentConnector_ms": 0.12426495552062988}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 416.67716397134296, "num_env_steps_trained_throughput_per_sec": 416.67716397134296, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 920000, "timers": {"training_iteration_time_ms": 9057.389, "restore_workers_time_ms": 0.02, "training_step_time_ms": 9056.014, "sample_time_ms": 1230.823, "learn_time_ms": 7784.024, "learn_throughput": 513.873, "synch_weights_time_ms": 35.234}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "done": false, "training_iteration": 115, "trial_id": "1f352_00000", "date": "2024-08-11_15-13-14", "timestamp": 1723403594, "time_this_iter_s": 9.621747016906738, "time_total_s": 1105.5651717185974, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a7f4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1105.5651717185974, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 55.23571428571429, "ram_util_percent": 83.03571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.403766847526034, "cur_kl_coeff": 1.3322676295501876e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4320242115606865, "policy_loss": -0.001479131773521658, "vf_loss": 1.433503343909979, "vf_explained_var": 0.9732747395833333, "kl": 0.001858376197410035, "entropy": 0.22189816476311536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 110880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.414001556796332, "cur_kl_coeff": 0.00014648437499999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.443822287147244, "policy_loss": -0.003291483802119425, "vf_loss": 1.447112740452091, "vf_explained_var": 0.9724039006357391, "kl": 0.007069635862574823, "entropy": 0.3926631348828475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 110880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -48.5185202653751, "predator_policy": -9.770627604725114}, "policy_reward_max": {"prey_policy": 9.770627604725114, "predator_policy": 48.5185202653751}, "policy_reward_mean": {"prey_policy": -18.90589100104201, "predator_policy": 18.90589100104201}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.84092455056938, -19.428992125300066, -30.849739652148187, -30.414033899593026, -17.028822976674157, -28.747214849240535, -30.563239151681387, -36.73541985286246, -8.951250190709198, 8.410355325024934, -7.887845874094984, -6.776293633728537, -26.945867868802186, -22.301678549009434, 2.960641808754689, -31.00497121132588, -9.49069476028881, -6.328192955980493, -14.310857597693214, -37.15340554641801, -26.928144562004302, -43.61922870043355, -12.25625281754696, -43.28337419048016, -19.97399203190966, -17.11192074157188, -25.320583283896458, -37.84090058751782, 6.639072207315177, -36.56412117188029, -18.133508387417734, -44.225338818116136, -13.77464490863741, -1.2484273121862097, 5.375846599962285, -38.13708476734592, -24.743897906809174, -20.570790970289313, -27.23668602666087, -20.452224154112685, -12.04024476240617, -9.538828502158186, -30.769577705249414, -30.55265173376673, -21.91292121721954, -8.065964809654178, -20.936465268189448, -39.043934087541956, -36.25626854284762, 9.770627604725114, -4.542398297686333, -5.994891619198727, -12.577645375402799, -2.675668632714043, -27.864694589489673, -48.5185202653751, -12.166270053197051, -1.4826197005812176, -2.23061809575767, -35.93187911820132, -22.02117188441268, -9.414658227794053, -14.22685008842923, -8.908730025286484, -12.249081144867791, -4.9667674007804, -25.165319192501848, -17.896890913704304, -38.09273218658815, 2.6856292512160405, -9.331767669168128, -41.171977805097015, -35.762094501470315, -20.50252924925543, -24.31984988745306, -13.873478779554357, -20.85794160340889, -29.720860443223465, -9.610541803874113, -6.700708802604712, 4.593413607353595, -16.868452837313438, -8.594355106937673, -27.229682955967697, -48.32749694318702, -15.459147560386146, -31.752172629073947, -15.607690112343322, -6.363285531203649, -28.050782538090186, -14.073777626058853, -23.22125800980527, -4.719257006257639, -24.497902497273756, -3.519215609828663, -3.5336878727368433, -19.463212015090882, -19.674498210575777, -15.662234186821099, -15.32999668855293], "policy_predator_policy_reward": [24.84092455056938, 19.428992125300066, 30.849739652148187, 30.414033899593026, 17.028822976674157, 28.747214849240535, 30.563239151681387, 36.73541985286246, 8.951250190709198, -8.410355325024934, 7.887845874094984, 6.776293633728537, 26.945867868802186, 22.301678549009434, -2.960641808754689, 31.00497121132588, 9.49069476028881, 6.328192955980493, 14.310857597693214, 37.15340554641801, 26.928144562004302, 43.61922870043355, 12.25625281754696, 43.28337419048016, 19.97399203190966, 17.11192074157188, 25.320583283896458, 37.84090058751782, -6.639072207315177, 36.56412117188029, 18.133508387417734, 44.225338818116136, 13.77464490863741, 1.2484273121862097, -5.375846599962285, 38.13708476734592, 24.743897906809174, 20.570790970289313, 27.23668602666087, 20.452224154112685, 12.04024476240617, 9.538828502158186, 30.769577705249414, 30.55265173376673, 21.91292121721954, 8.065964809654178, 20.936465268189448, 39.043934087541956, 36.25626854284762, -9.770627604725114, 4.542398297686333, 5.994891619198727, 12.577645375402799, 2.675668632714043, 27.864694589489673, 48.5185202653751, 12.166270053197051, 1.4826197005812176, 2.23061809575767, 35.93187911820132, 22.02117188441268, 9.414658227794053, 14.22685008842923, 8.908730025286484, 12.249081144867791, 4.9667674007804, 25.165319192501848, 17.896890913704304, 38.09273218658815, -2.6856292512160405, 9.331767669168128, 41.171977805097015, 35.762094501470315, 20.50252924925543, 24.31984988745306, 13.873478779554357, 20.85794160340889, 29.720860443223465, 9.610541803874113, 6.700708802604712, -4.593413607353595, 16.868452837313438, 8.594355106937673, 27.229682955967697, 48.32749694318702, 15.459147560386146, 31.752172629073947, 15.607690112343322, 6.363285531203649, 28.050782538090186, 14.073777626058853, 23.22125800980527, 4.719257006257639, 24.497902497273756, 3.519215609828663, 3.5336878727368433, 19.463212015090882, 19.674498210575777, 15.662234186821099, 15.32999668855293]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5175422437522726, "mean_inference_ms": 1.8018089285058903, "mean_action_processing_ms": 0.21956124266202853, "mean_env_wait_ms": 0.1360705408483769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004403352737426758, "StateBufferConnector_ms": 0.0036296844482421875, "ViewRequirementAgentConnector_ms": 0.10547280311584473}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 345.6164473159037, "num_env_steps_trained_throughput_per_sec": 345.6164473159037, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 9409.677, "restore_workers_time_ms": 0.021, "training_step_time_ms": 9408.243, "sample_time_ms": 1303.933, "learn_time_ms": 8061.112, "learn_throughput": 496.209, "synch_weights_time_ms": 36.857}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 116, "trial_id": "1f352_00000", "date": "2024-08-11_15-13-26", "timestamp": 1723403606, "time_this_iter_s": 11.61841106414795, "time_total_s": 1117.1835827827454, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a5d670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1117.1835827827454, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 61.95, "ram_util_percent": 83.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1721902222683034, "cur_kl_coeff": 6.661338147750938e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.552656631420056, "policy_loss": -0.003412208310328424, "vf_loss": 1.5560688432306051, "vf_explained_var": 0.9664468535532554, "kl": 0.003871133744308025, "entropy": 0.2578641054841379, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 111840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.020815919401745, "cur_kl_coeff": 0.00014648437499999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5321473200495044, "policy_loss": -0.006891622621333226, "vf_loss": 1.5390378543486198, "vf_explained_var": 0.9666614818076292, "kl": 0.007406988440839063, "entropy": 0.42859943754350144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 111840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -48.5185202653751, "predator_policy": -9.770627604725114}, "policy_reward_max": {"prey_policy": 9.770627604725114, "predator_policy": 48.5185202653751}, "policy_reward_mean": {"prey_policy": -19.4910828290071, "predator_policy": 19.4910828290071}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.310857597693214, -37.15340554641801, -26.928144562004302, -43.61922870043355, -12.25625281754696, -43.28337419048016, -19.97399203190966, -17.11192074157188, -25.320583283896458, -37.84090058751782, 6.639072207315177, -36.56412117188029, -18.133508387417734, -44.225338818116136, -13.77464490863741, -1.2484273121862097, 5.375846599962285, -38.13708476734592, -24.743897906809174, -20.570790970289313, -27.23668602666087, -20.452224154112685, -12.04024476240617, -9.538828502158186, -30.769577705249414, -30.55265173376673, -21.91292121721954, -8.065964809654178, -20.936465268189448, -39.043934087541956, -36.25626854284762, 9.770627604725114, -4.542398297686333, -5.994891619198727, -12.577645375402799, -2.675668632714043, -27.864694589489673, -48.5185202653751, -12.166270053197051, -1.4826197005812176, -2.23061809575767, -35.93187911820132, -22.02117188441268, -9.414658227794053, -14.22685008842923, -8.908730025286484, -12.249081144867791, -4.9667674007804, -25.165319192501848, -17.896890913704304, -38.09273218658815, 2.6856292512160405, -9.331767669168128, -41.171977805097015, -35.762094501470315, -20.50252924925543, -24.31984988745306, -13.873478779554357, -20.85794160340889, -29.720860443223465, -9.610541803874113, -6.700708802604712, 4.593413607353595, -16.868452837313438, -8.594355106937673, -27.229682955967697, -48.32749694318702, -15.459147560386146, -31.752172629073947, -15.607690112343322, -6.363285531203649, -28.050782538090186, -14.073777626058853, -23.22125800980527, -4.719257006257639, -24.497902497273756, -3.519215609828663, -3.5336878727368433, -19.463212015090882, -19.674498210575777, -15.662234186821099, -15.32999668855293, -17.096897901523295, -35.56939528375808, -36.82707606163754, -30.011305109003196, -8.21106223691201, -41.69623726575684, -3.1286382885044226, -21.697263611640924, -41.73030874175635, -5.172790125758702, -26.799001541753885, -11.925833790567317, 4.706649204707527, -43.867386873228966, -46.64606671560728, -14.10281062509103, -10.216619487347845, 4.5486766904018054], "policy_predator_policy_reward": [14.310857597693214, 37.15340554641801, 26.928144562004302, 43.61922870043355, 12.25625281754696, 43.28337419048016, 19.97399203190966, 17.11192074157188, 25.320583283896458, 37.84090058751782, -6.639072207315177, 36.56412117188029, 18.133508387417734, 44.225338818116136, 13.77464490863741, 1.2484273121862097, -5.375846599962285, 38.13708476734592, 24.743897906809174, 20.570790970289313, 27.23668602666087, 20.452224154112685, 12.04024476240617, 9.538828502158186, 30.769577705249414, 30.55265173376673, 21.91292121721954, 8.065964809654178, 20.936465268189448, 39.043934087541956, 36.25626854284762, -9.770627604725114, 4.542398297686333, 5.994891619198727, 12.577645375402799, 2.675668632714043, 27.864694589489673, 48.5185202653751, 12.166270053197051, 1.4826197005812176, 2.23061809575767, 35.93187911820132, 22.02117188441268, 9.414658227794053, 14.22685008842923, 8.908730025286484, 12.249081144867791, 4.9667674007804, 25.165319192501848, 17.896890913704304, 38.09273218658815, -2.6856292512160405, 9.331767669168128, 41.171977805097015, 35.762094501470315, 20.50252924925543, 24.31984988745306, 13.873478779554357, 20.85794160340889, 29.720860443223465, 9.610541803874113, 6.700708802604712, -4.593413607353595, 16.868452837313438, 8.594355106937673, 27.229682955967697, 48.32749694318702, 15.459147560386146, 31.752172629073947, 15.607690112343322, 6.363285531203649, 28.050782538090186, 14.073777626058853, 23.22125800980527, 4.719257006257639, 24.497902497273756, 3.519215609828663, 3.5336878727368433, 19.463212015090882, 19.674498210575777, 15.662234186821099, 15.32999668855293, 17.096897901523295, 35.56939528375808, 36.82707606163754, 30.011305109003196, 8.21106223691201, 41.69623726575684, 3.1286382885044226, 21.697263611640924, 41.73030874175635, 5.172790125758702, 26.799001541753885, 11.925833790567317, -4.706649204707527, 43.867386873228966, 46.64606671560728, 14.10281062509103, 10.216619487347845, -4.5486766904018054]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5151820742077944, "mean_inference_ms": 1.7939875954905116, "mean_action_processing_ms": 0.21834104498972656, "mean_env_wait_ms": 0.13557459453994206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041741132736206055, "StateBufferConnector_ms": 0.003468632698059082, "ViewRequirementAgentConnector_ms": 0.11324286460876465}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.076358471334, "num_env_steps_trained_throughput_per_sec": 417.076358471334, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 9539.345, "restore_workers_time_ms": 0.037, "training_step_time_ms": 9537.894, "sample_time_ms": 1336.266, "learn_time_ms": 8155.338, "learn_throughput": 490.476, "synch_weights_time_ms": 39.577}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "training_iteration": 117, "trial_id": "1f352_00000", "date": "2024-08-11_15-13-36", "timestamp": 1723403616, "time_this_iter_s": 9.632349014282227, "time_total_s": 1126.8159317970276, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a7f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1126.8159317970276, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 53.17142857142857, "ram_util_percent": 83.20714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.775333758878211, "cur_kl_coeff": 3.330669073875469e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6879233716676634, "policy_loss": -0.002688657859592543, "vf_loss": 2.6906120316435893, "vf_explained_var": 0.9333785944307844, "kl": 0.0046743453790772565, "entropy": 0.3608184860398372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 112800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6652847327291966, "cur_kl_coeff": 0.00014648437499999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.681708356862267, "policy_loss": -0.004736143538805967, "vf_loss": 2.6864435880134505, "vf_explained_var": 0.9333730949088931, "kl": 0.006269233317514159, "entropy": 0.40935782908151547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 112800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.60095523283073, "predator_policy": -9.770627604725114}, "policy_reward_max": {"prey_policy": 9.770627604725114, "predator_policy": 52.60095523283073}, "policy_reward_mean": {"prey_policy": -19.149517543185283, "predator_policy": 19.149517543185283}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.743897906809174, -20.570790970289313, -27.23668602666087, -20.452224154112685, -12.04024476240617, -9.538828502158186, -30.769577705249414, -30.55265173376673, -21.91292121721954, -8.065964809654178, -20.936465268189448, -39.043934087541956, -36.25626854284762, 9.770627604725114, -4.542398297686333, -5.994891619198727, -12.577645375402799, -2.675668632714043, -27.864694589489673, -48.5185202653751, -12.166270053197051, -1.4826197005812176, -2.23061809575767, -35.93187911820132, -22.02117188441268, -9.414658227794053, -14.22685008842923, -8.908730025286484, -12.249081144867791, -4.9667674007804, -25.165319192501848, -17.896890913704304, -38.09273218658815, 2.6856292512160405, -9.331767669168128, -41.171977805097015, -35.762094501470315, -20.50252924925543, -24.31984988745306, -13.873478779554357, -20.85794160340889, -29.720860443223465, -9.610541803874113, -6.700708802604712, 4.593413607353595, -16.868452837313438, -8.594355106937673, -27.229682955967697, -48.32749694318702, -15.459147560386146, -31.752172629073947, -15.607690112343322, -6.363285531203649, -28.050782538090186, -14.073777626058853, -23.22125800980527, -4.719257006257639, -24.497902497273756, -3.519215609828663, -3.5336878727368433, -19.463212015090882, -19.674498210575777, -15.662234186821099, -15.32999668855293, -17.096897901523295, -35.56939528375808, -36.82707606163754, -30.011305109003196, -8.21106223691201, -41.69623726575684, -3.1286382885044226, -21.697263611640924, -41.73030874175635, -5.172790125758702, -26.799001541753885, -11.925833790567317, 4.706649204707527, -43.867386873228966, -46.64606671560728, -14.10281062509103, -10.216619487347845, 4.5486766904018054, 6.372293085287202, -16.13915756569285, -25.821223634492405, -19.21728836997089, -32.287930989673995, -52.60095523283073, -13.193605613427243, -21.23141198994611, -22.277424726384886, -10.943219867449978, -30.881441079464132, -47.03841043998481, -1.6037747043275647, 2.184591588873152, -21.778920266519407, -26.376615203712614, -22.79675755277003, -28.079085473108954], "policy_predator_policy_reward": [24.743897906809174, 20.570790970289313, 27.23668602666087, 20.452224154112685, 12.04024476240617, 9.538828502158186, 30.769577705249414, 30.55265173376673, 21.91292121721954, 8.065964809654178, 20.936465268189448, 39.043934087541956, 36.25626854284762, -9.770627604725114, 4.542398297686333, 5.994891619198727, 12.577645375402799, 2.675668632714043, 27.864694589489673, 48.5185202653751, 12.166270053197051, 1.4826197005812176, 2.23061809575767, 35.93187911820132, 22.02117188441268, 9.414658227794053, 14.22685008842923, 8.908730025286484, 12.249081144867791, 4.9667674007804, 25.165319192501848, 17.896890913704304, 38.09273218658815, -2.6856292512160405, 9.331767669168128, 41.171977805097015, 35.762094501470315, 20.50252924925543, 24.31984988745306, 13.873478779554357, 20.85794160340889, 29.720860443223465, 9.610541803874113, 6.700708802604712, -4.593413607353595, 16.868452837313438, 8.594355106937673, 27.229682955967697, 48.32749694318702, 15.459147560386146, 31.752172629073947, 15.607690112343322, 6.363285531203649, 28.050782538090186, 14.073777626058853, 23.22125800980527, 4.719257006257639, 24.497902497273756, 3.519215609828663, 3.5336878727368433, 19.463212015090882, 19.674498210575777, 15.662234186821099, 15.32999668855293, 17.096897901523295, 35.56939528375808, 36.82707606163754, 30.011305109003196, 8.21106223691201, 41.69623726575684, 3.1286382885044226, 21.697263611640924, 41.73030874175635, 5.172790125758702, 26.799001541753885, 11.925833790567317, -4.706649204707527, 43.867386873228966, 46.64606671560728, 14.10281062509103, 10.216619487347845, -4.5486766904018054, -6.372293085287202, 16.13915756569285, 25.821223634492405, 19.21728836997089, 32.287930989673995, 52.60095523283073, 13.193605613427243, 21.23141198994611, 22.277424726384886, 10.943219867449978, 30.881441079464132, 47.03841043998481, 1.6037747043275647, -2.184591588873152, 21.778920266519407, 26.376615203712614, 22.79675755277003, 28.079085473108954]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5149604295517017, "mean_inference_ms": 1.7937946571100083, "mean_action_processing_ms": 0.21836703335112126, "mean_env_wait_ms": 0.13565020819074614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00413358211517334, "StateBufferConnector_ms": 0.0025728940963745117, "ViewRequirementAgentConnector_ms": 0.09496414661407471}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 460.8403755686713, "num_env_steps_trained_throughput_per_sec": 460.8403755686713, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 9581.081, "restore_workers_time_ms": 0.037, "training_step_time_ms": 9579.63, "sample_time_ms": 1299.18, "learn_time_ms": 8234.034, "learn_throughput": 485.789, "synch_weights_time_ms": 39.697}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 118, "trial_id": "1f352_00000", "date": "2024-08-11_15-13-45", "timestamp": 1723403625, "time_this_iter_s": 8.733484029769897, "time_total_s": 1135.5494158267975, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a7ff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1135.5494158267975, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 52.2, "ram_util_percent": 82.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6214639775455, "cur_kl_coeff": 1.6653345369377344e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4077567386130494, "policy_loss": -0.0015652999267331325, "vf_loss": 2.409322031959891, "vf_explained_var": 0.9501810293023785, "kl": 0.0033250991946999044, "entropy": 0.353503531202053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 113760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7589680158222714, "cur_kl_coeff": 0.00014648437499999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4009025186300277, "policy_loss": -0.005419791334134061, "vf_loss": 2.4063209084173045, "vf_explained_var": 0.950046664228042, "kl": 0.009608617665964303, "entropy": 0.4124700574204326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 113760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.60095523283073, "predator_policy": -6.372293085287202}, "policy_reward_max": {"prey_policy": 6.372293085287202, "predator_policy": 52.60095523283073}, "policy_reward_mean": {"prey_policy": -19.338102409897115, "predator_policy": 19.338102409897115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-35.93187911820132, -22.02117188441268, -9.414658227794053, -14.22685008842923, -8.908730025286484, -12.249081144867791, -4.9667674007804, -25.165319192501848, -17.896890913704304, -38.09273218658815, 2.6856292512160405, -9.331767669168128, -41.171977805097015, -35.762094501470315, -20.50252924925543, -24.31984988745306, -13.873478779554357, -20.85794160340889, -29.720860443223465, -9.610541803874113, -6.700708802604712, 4.593413607353595, -16.868452837313438, -8.594355106937673, -27.229682955967697, -48.32749694318702, -15.459147560386146, -31.752172629073947, -15.607690112343322, -6.363285531203649, -28.050782538090186, -14.073777626058853, -23.22125800980527, -4.719257006257639, -24.497902497273756, -3.519215609828663, -3.5336878727368433, -19.463212015090882, -19.674498210575777, -15.662234186821099, -15.32999668855293, -17.096897901523295, -35.56939528375808, -36.82707606163754, -30.011305109003196, -8.21106223691201, -41.69623726575684, -3.1286382885044226, -21.697263611640924, -41.73030874175635, -5.172790125758702, -26.799001541753885, -11.925833790567317, 4.706649204707527, -43.867386873228966, -46.64606671560728, -14.10281062509103, -10.216619487347845, 4.5486766904018054, 6.372293085287202, -16.13915756569285, -25.821223634492405, -19.21728836997089, -32.287930989673995, -52.60095523283073, -13.193605613427243, -21.23141198994611, -22.277424726384886, -10.943219867449978, -30.881441079464132, -47.03841043998481, -1.6037747043275647, 2.184591588873152, -21.778920266519407, -26.376615203712614, -22.79675755277003, -28.079085473108954, -3.205509244609667, -35.27180078262962, -33.18771633004656, 3.125724459251958, -10.94975870521865, -13.291036640252928, -9.748633921895932, -13.634457435017762, -15.564405203745672, -18.87028891076328, -8.512424284549466, -9.308760738905303, -51.35391575794181, -28.274393198120666, -15.94459492938519, -5.329150407041652, -7.773076452341492, -14.428654865490074, -41.7986047704605, -41.81248914992598, -33.23396938990455, -18.861603100760696, -2.0321216230105055], "policy_predator_policy_reward": [35.93187911820132, 22.02117188441268, 9.414658227794053, 14.22685008842923, 8.908730025286484, 12.249081144867791, 4.9667674007804, 25.165319192501848, 17.896890913704304, 38.09273218658815, -2.6856292512160405, 9.331767669168128, 41.171977805097015, 35.762094501470315, 20.50252924925543, 24.31984988745306, 13.873478779554357, 20.85794160340889, 29.720860443223465, 9.610541803874113, 6.700708802604712, -4.593413607353595, 16.868452837313438, 8.594355106937673, 27.229682955967697, 48.32749694318702, 15.459147560386146, 31.752172629073947, 15.607690112343322, 6.363285531203649, 28.050782538090186, 14.073777626058853, 23.22125800980527, 4.719257006257639, 24.497902497273756, 3.519215609828663, 3.5336878727368433, 19.463212015090882, 19.674498210575777, 15.662234186821099, 15.32999668855293, 17.096897901523295, 35.56939528375808, 36.82707606163754, 30.011305109003196, 8.21106223691201, 41.69623726575684, 3.1286382885044226, 21.697263611640924, 41.73030874175635, 5.172790125758702, 26.799001541753885, 11.925833790567317, -4.706649204707527, 43.867386873228966, 46.64606671560728, 14.10281062509103, 10.216619487347845, -4.5486766904018054, -6.372293085287202, 16.13915756569285, 25.821223634492405, 19.21728836997089, 32.287930989673995, 52.60095523283073, 13.193605613427243, 21.23141198994611, 22.277424726384886, 10.943219867449978, 30.881441079464132, 47.03841043998481, 1.6037747043275647, -2.184591588873152, 21.778920266519407, 26.376615203712614, 22.79675755277003, 28.079085473108954, 3.205509244609667, 35.27180078262962, 33.18771633004656, -3.125724459251958, 10.94975870521865, 13.291036640252928, 9.748633921895932, 13.634457435017762, 15.564405203745672, 18.87028891076328, 8.512424284549466, 9.308760738905303, 51.35391575794181, 28.274393198120666, 15.94459492938519, 5.329150407041652, 7.773076452341492, 14.428654865490074, 41.7986047704605, 41.81248914992598, 33.23396938990455, 18.861603100760696, 2.0321216230105055]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5146757681175882, "mean_inference_ms": 1.792499067338565, "mean_action_processing_ms": 0.2183342967974481, "mean_env_wait_ms": 0.1356779146446211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00395357608795166, "StateBufferConnector_ms": 0.0028978586196899414, "ViewRequirementAgentConnector_ms": 0.09146153926849365}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.5922524415587, "num_env_steps_trained_throughput_per_sec": 446.5922524415587, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 952000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 952000, "timers": {"training_iteration_time_ms": 9635.839, "restore_workers_time_ms": 0.037, "training_step_time_ms": 9634.387, "sample_time_ms": 1303.307, "learn_time_ms": 8283.777, "learn_throughput": 482.872, "synch_weights_time_ms": 40.581}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000}, "done": false, "training_iteration": 119, "trial_id": "1f352_00000", "date": "2024-08-11_15-13-54", "timestamp": 1723403634, "time_this_iter_s": 9.012149810791016, "time_total_s": 1144.5615656375885, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a5bdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1144.5615656375885, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 51.4, "ram_util_percent": 83.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.381437661498785, "cur_kl_coeff": 8.326672684688672e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0473130230481424, "policy_loss": -0.002500457110969971, "vf_loss": 2.0498134831587476, "vf_explained_var": 0.935382878780365, "kl": 0.0031871764143832247, "entropy": 0.2927760319939504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 114720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3818841970836124, "cur_kl_coeff": 0.00014648437499999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0721213995168606, "policy_loss": -0.003852243294143894, "vf_loss": 2.0759729468574126, "vf_explained_var": 0.9332700882107019, "kl": 0.004860537968908337, "entropy": 0.41855025875071683, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 114720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.60095523283073, "predator_policy": -12.872132534653181}, "policy_reward_max": {"prey_policy": 12.872132534653181, "predator_policy": 52.60095523283073}, "policy_reward_mean": {"prey_policy": -18.629138355361246, "predator_policy": 18.629138355361246}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.868452837313438, -8.594355106937673, -27.229682955967697, -48.32749694318702, -15.459147560386146, -31.752172629073947, -15.607690112343322, -6.363285531203649, -28.050782538090186, -14.073777626058853, -23.22125800980527, -4.719257006257639, -24.497902497273756, -3.519215609828663, -3.5336878727368433, -19.463212015090882, -19.674498210575777, -15.662234186821099, -15.32999668855293, -17.096897901523295, -35.56939528375808, -36.82707606163754, -30.011305109003196, -8.21106223691201, -41.69623726575684, -3.1286382885044226, -21.697263611640924, -41.73030874175635, -5.172790125758702, -26.799001541753885, -11.925833790567317, 4.706649204707527, -43.867386873228966, -46.64606671560728, -14.10281062509103, -10.216619487347845, 4.5486766904018054, 6.372293085287202, -16.13915756569285, -25.821223634492405, -19.21728836997089, -32.287930989673995, -52.60095523283073, -13.193605613427243, -21.23141198994611, -22.277424726384886, -10.943219867449978, -30.881441079464132, -47.03841043998481, -1.6037747043275647, 2.184591588873152, -21.778920266519407, -26.376615203712614, -22.79675755277003, -28.079085473108954, -3.205509244609667, -35.27180078262962, -33.18771633004656, 3.125724459251958, -10.94975870521865, -13.291036640252928, -9.748633921895932, -13.634457435017762, -15.564405203745672, -18.87028891076328, -8.512424284549466, -9.308760738905303, -51.35391575794181, -28.274393198120666, -15.94459492938519, -5.329150407041652, -7.773076452341492, -14.428654865490074, -41.7986047704605, -41.81248914992598, -33.23396938990455, -18.861603100760696, -2.0321216230105055, -20.59587140942369, 4.652468033888099, -26.797365817060133, -32.33516368265186, -33.422540121385346, -4.351446481799618, -26.44050218712757, -35.01309040064298, -12.962202218897527, -0.3133284457995513, -21.27892919700932, -5.310001149903121, -9.662223688988039, 12.872132534653181, -24.64727779460497, 1.8903722099996703, -11.565121143759375, -17.178542006594668, -23.856838781297036, -15.227892452461564, -4.820389341146013, -16.186628873507434], "policy_predator_policy_reward": [16.868452837313438, 8.594355106937673, 27.229682955967697, 48.32749694318702, 15.459147560386146, 31.752172629073947, 15.607690112343322, 6.363285531203649, 28.050782538090186, 14.073777626058853, 23.22125800980527, 4.719257006257639, 24.497902497273756, 3.519215609828663, 3.5336878727368433, 19.463212015090882, 19.674498210575777, 15.662234186821099, 15.32999668855293, 17.096897901523295, 35.56939528375808, 36.82707606163754, 30.011305109003196, 8.21106223691201, 41.69623726575684, 3.1286382885044226, 21.697263611640924, 41.73030874175635, 5.172790125758702, 26.799001541753885, 11.925833790567317, -4.706649204707527, 43.867386873228966, 46.64606671560728, 14.10281062509103, 10.216619487347845, -4.5486766904018054, -6.372293085287202, 16.13915756569285, 25.821223634492405, 19.21728836997089, 32.287930989673995, 52.60095523283073, 13.193605613427243, 21.23141198994611, 22.277424726384886, 10.943219867449978, 30.881441079464132, 47.03841043998481, 1.6037747043275647, -2.184591588873152, 21.778920266519407, 26.376615203712614, 22.79675755277003, 28.079085473108954, 3.205509244609667, 35.27180078262962, 33.18771633004656, -3.125724459251958, 10.94975870521865, 13.291036640252928, 9.748633921895932, 13.634457435017762, 15.564405203745672, 18.87028891076328, 8.512424284549466, 9.308760738905303, 51.35391575794181, 28.274393198120666, 15.94459492938519, 5.329150407041652, 7.773076452341492, 14.428654865490074, 41.7986047704605, 41.81248914992598, 33.23396938990455, 18.861603100760696, 2.0321216230105055, 20.59587140942369, -4.652468033888099, 26.797365817060133, 32.33516368265186, 33.422540121385346, 4.351446481799618, 26.44050218712757, 35.01309040064298, 12.962202218897527, 0.3133284457995513, 21.27892919700932, 5.310001149903121, 9.662223688988039, -12.872132534653181, 24.64727779460497, -1.8903722099996703, 11.565121143759375, 17.178542006594668, 23.856838781297036, 15.227892452461564, 4.820389341146013, 16.186628873507434]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5170922132277507, "mean_inference_ms": 1.8001518522719397, "mean_action_processing_ms": 0.21956997489152572, "mean_env_wait_ms": 0.1363613391737491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003646254539489746, "StateBufferConnector_ms": 0.0031120777130126953, "ViewRequirementAgentConnector_ms": 0.08750832080841064}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 482.175195154571, "num_env_steps_trained_throughput_per_sec": 482.175195154571, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 9548.258, "restore_workers_time_ms": 0.038, "training_step_time_ms": 9547.98, "sample_time_ms": 1321.789, "learn_time_ms": 8191.212, "learn_throughput": 488.328, "synch_weights_time_ms": 32.849}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 120, "trial_id": "1f352_00000", "date": "2024-08-11_15-14-02", "timestamp": 1723403642, "time_this_iter_s": 8.370914936065674, "time_total_s": 1152.9324805736542, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b187baf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1152.9324805736542, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 51.80000000000001, "ram_util_percent": 82.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.630878834053874, "cur_kl_coeff": 4.163336342344336e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3677460726350548, "policy_loss": -0.010065562754364994, "vf_loss": 2.3778116336713233, "vf_explained_var": 0.9496228228633602, "kl": 0.02804722301646263, "entropy": 0.41146515814277035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 115680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6510439892609914, "cur_kl_coeff": 7.324218749999998e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3856833855311077, "policy_loss": -0.002786285269151752, "vf_loss": 2.3884691863010326, "vf_explained_var": 0.9492157304038604, "kl": 0.006753819188511446, "entropy": 0.4555058678301672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 115680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.92290791622254, "predator_policy": -12.872132534653181}, "policy_reward_max": {"prey_policy": 12.872132534653181, "predator_policy": 54.92290791622254}, "policy_reward_mean": {"prey_policy": -19.31748899580183, "predator_policy": 19.31748899580183}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-15.32999668855293, -17.096897901523295, -35.56939528375808, -36.82707606163754, -30.011305109003196, -8.21106223691201, -41.69623726575684, -3.1286382885044226, -21.697263611640924, -41.73030874175635, -5.172790125758702, -26.799001541753885, -11.925833790567317, 4.706649204707527, -43.867386873228966, -46.64606671560728, -14.10281062509103, -10.216619487347845, 4.5486766904018054, 6.372293085287202, -16.13915756569285, -25.821223634492405, -19.21728836997089, -32.287930989673995, -52.60095523283073, -13.193605613427243, -21.23141198994611, -22.277424726384886, -10.943219867449978, -30.881441079464132, -47.03841043998481, -1.6037747043275647, 2.184591588873152, -21.778920266519407, -26.376615203712614, -22.79675755277003, -28.079085473108954, -3.205509244609667, -35.27180078262962, -33.18771633004656, 3.125724459251958, -10.94975870521865, -13.291036640252928, -9.748633921895932, -13.634457435017762, -15.564405203745672, -18.87028891076328, -8.512424284549466, -9.308760738905303, -51.35391575794181, -28.274393198120666, -15.94459492938519, -5.329150407041652, -7.773076452341492, -14.428654865490074, -41.7986047704605, -41.81248914992598, -33.23396938990455, -18.861603100760696, -2.0321216230105055, -20.59587140942369, 4.652468033888099, -26.797365817060133, -32.33516368265186, -33.422540121385346, -4.351446481799618, -26.44050218712757, -35.01309040064298, -12.962202218897527, -0.3133284457995513, -21.27892919700932, -5.310001149903121, -9.662223688988039, 12.872132534653181, -24.64727779460497, 1.8903722099996703, -11.565121143759375, -17.178542006594668, -23.856838781297036, -15.227892452461564, -4.820389341146013, -16.186628873507434, -54.92290791622254, -16.170644924594306, 0.3389291676646762, -18.900416685558113, -23.517047080657743, -5.1286483804534555, 0.32239358074742697, -12.561635931054237, -25.981248562558747, -30.60208306993528, -17.477844576518244, -47.30052298249301, -20.6838520253364, -21.89549530619266, -19.584396537310298, -36.26230208879558, -32.90554268925332, -12.2199072844889], "policy_predator_policy_reward": [15.32999668855293, 17.096897901523295, 35.56939528375808, 36.82707606163754, 30.011305109003196, 8.21106223691201, 41.69623726575684, 3.1286382885044226, 21.697263611640924, 41.73030874175635, 5.172790125758702, 26.799001541753885, 11.925833790567317, -4.706649204707527, 43.867386873228966, 46.64606671560728, 14.10281062509103, 10.216619487347845, -4.5486766904018054, -6.372293085287202, 16.13915756569285, 25.821223634492405, 19.21728836997089, 32.287930989673995, 52.60095523283073, 13.193605613427243, 21.23141198994611, 22.277424726384886, 10.943219867449978, 30.881441079464132, 47.03841043998481, 1.6037747043275647, -2.184591588873152, 21.778920266519407, 26.376615203712614, 22.79675755277003, 28.079085473108954, 3.205509244609667, 35.27180078262962, 33.18771633004656, -3.125724459251958, 10.94975870521865, 13.291036640252928, 9.748633921895932, 13.634457435017762, 15.564405203745672, 18.87028891076328, 8.512424284549466, 9.308760738905303, 51.35391575794181, 28.274393198120666, 15.94459492938519, 5.329150407041652, 7.773076452341492, 14.428654865490074, 41.7986047704605, 41.81248914992598, 33.23396938990455, 18.861603100760696, 2.0321216230105055, 20.59587140942369, -4.652468033888099, 26.797365817060133, 32.33516368265186, 33.422540121385346, 4.351446481799618, 26.44050218712757, 35.01309040064298, 12.962202218897527, 0.3133284457995513, 21.27892919700932, 5.310001149903121, 9.662223688988039, -12.872132534653181, 24.64727779460497, -1.8903722099996703, 11.565121143759375, 17.178542006594668, 23.856838781297036, 15.227892452461564, 4.820389341146013, 16.186628873507434, 54.92290791622254, 16.170644924594306, -0.3389291676646762, 18.900416685558113, 23.517047080657743, 5.1286483804534555, -0.32239358074742697, 12.561635931054237, 25.981248562558747, 30.60208306993528, 17.477844576518244, 47.30052298249301, 20.6838520253364, 21.89549530619266, 19.584396537310298, 36.26230208879558, 32.90554268925332, 12.2199072844889]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5139870679035057, "mean_inference_ms": 1.7887132410747524, "mean_action_processing_ms": 0.2180153778873748, "mean_env_wait_ms": 0.13553795236847843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003366231918334961, "StateBufferConnector_ms": 0.002977728843688965, "ViewRequirementAgentConnector_ms": 0.08121001720428467}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 481.5376861460604, "num_env_steps_trained_throughput_per_sec": 481.5376861460604, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 968000, "timers": {"training_iteration_time_ms": 9440.319, "restore_workers_time_ms": 0.036, "training_step_time_ms": 9440.019, "sample_time_ms": 1260.178, "learn_time_ms": 8143.844, "learn_throughput": 491.169, "synch_weights_time_ms": 33.817}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000}, "done": false, "training_iteration": 121, "trial_id": "1f352_00000", "date": "2024-08-11_15-14-10", "timestamp": 1723403650, "time_this_iter_s": 8.351036071777344, "time_total_s": 1161.2835166454315, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a1a820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1161.2835166454315, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 50.10833333333333, "ram_util_percent": 82.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.475062406000992, "cur_kl_coeff": 6.245004513516507e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.332436654592554, "policy_loss": -0.0032919510330733223, "vf_loss": 2.3357286119212706, "vf_explained_var": 0.9310184719661871, "kl": 0.00703877201784732, "entropy": 0.40308386407171687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 116640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.455771887799104, "cur_kl_coeff": 7.324218749999998e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3253040101379154, "policy_loss": -0.004791892396557766, "vf_loss": 2.330095197757085, "vf_explained_var": 0.930600615652899, "kl": 0.00967381453797002, "entropy": 0.44769438831135633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 116640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.92290791622254, "predator_policy": -12.872132534653181}, "policy_reward_max": {"prey_policy": 12.872132534653181, "predator_policy": 54.92290791622254}, "policy_reward_mean": {"prey_policy": -18.580882468851765, "predator_policy": 18.580882468851765}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4.5486766904018054, 6.372293085287202, -16.13915756569285, -25.821223634492405, -19.21728836997089, -32.287930989673995, -52.60095523283073, -13.193605613427243, -21.23141198994611, -22.277424726384886, -10.943219867449978, -30.881441079464132, -47.03841043998481, -1.6037747043275647, 2.184591588873152, -21.778920266519407, -26.376615203712614, -22.79675755277003, -28.079085473108954, -3.205509244609667, -35.27180078262962, -33.18771633004656, 3.125724459251958, -10.94975870521865, -13.291036640252928, -9.748633921895932, -13.634457435017762, -15.564405203745672, -18.87028891076328, -8.512424284549466, -9.308760738905303, -51.35391575794181, -28.274393198120666, -15.94459492938519, -5.329150407041652, -7.773076452341492, -14.428654865490074, -41.7986047704605, -41.81248914992598, -33.23396938990455, -18.861603100760696, -2.0321216230105055, -20.59587140942369, 4.652468033888099, -26.797365817060133, -32.33516368265186, -33.422540121385346, -4.351446481799618, -26.44050218712757, -35.01309040064298, -12.962202218897527, -0.3133284457995513, -21.27892919700932, -5.310001149903121, -9.662223688988039, 12.872132534653181, -24.64727779460497, 1.8903722099996703, -11.565121143759375, -17.178542006594668, -23.856838781297036, -15.227892452461564, -4.820389341146013, -16.186628873507434, -54.92290791622254, -16.170644924594306, 0.3389291676646762, -18.900416685558113, -23.517047080657743, -5.1286483804534555, 0.32239358074742697, -12.561635931054237, -25.981248562558747, -30.60208306993528, -17.477844576518244, -47.30052298249301, -20.6838520253364, -21.89549530619266, -19.584396537310298, -36.26230208879558, -32.90554268925332, -12.2199072844889, -16.84136936825886, -8.796617401238827, -34.28308436608373, 0.4096399901364105, -11.140025914647135, -42.16487494460945, -4.827678625131744, 3.3114558639360867, -30.528906862970352, -14.545372140498547, -15.836514984183136, -34.14361194676703, -21.960100494695574, -25.13478257068266, -42.710951358295574, -17.488263882934277, 8.465177376597284, -23.44550681835963], "policy_predator_policy_reward": [-4.5486766904018054, -6.372293085287202, 16.13915756569285, 25.821223634492405, 19.21728836997089, 32.287930989673995, 52.60095523283073, 13.193605613427243, 21.23141198994611, 22.277424726384886, 10.943219867449978, 30.881441079464132, 47.03841043998481, 1.6037747043275647, -2.184591588873152, 21.778920266519407, 26.376615203712614, 22.79675755277003, 28.079085473108954, 3.205509244609667, 35.27180078262962, 33.18771633004656, -3.125724459251958, 10.94975870521865, 13.291036640252928, 9.748633921895932, 13.634457435017762, 15.564405203745672, 18.87028891076328, 8.512424284549466, 9.308760738905303, 51.35391575794181, 28.274393198120666, 15.94459492938519, 5.329150407041652, 7.773076452341492, 14.428654865490074, 41.7986047704605, 41.81248914992598, 33.23396938990455, 18.861603100760696, 2.0321216230105055, 20.59587140942369, -4.652468033888099, 26.797365817060133, 32.33516368265186, 33.422540121385346, 4.351446481799618, 26.44050218712757, 35.01309040064298, 12.962202218897527, 0.3133284457995513, 21.27892919700932, 5.310001149903121, 9.662223688988039, -12.872132534653181, 24.64727779460497, -1.8903722099996703, 11.565121143759375, 17.178542006594668, 23.856838781297036, 15.227892452461564, 4.820389341146013, 16.186628873507434, 54.92290791622254, 16.170644924594306, -0.3389291676646762, 18.900416685558113, 23.517047080657743, 5.1286483804534555, -0.32239358074742697, 12.561635931054237, 25.981248562558747, 30.60208306993528, 17.477844576518244, 47.30052298249301, 20.6838520253364, 21.89549530619266, 19.584396537310298, 36.26230208879558, 32.90554268925332, 12.2199072844889, 16.84136936825886, 8.796617401238827, 34.28308436608373, -0.4096399901364105, 11.140025914647135, 42.16487494460945, 4.827678625131744, -3.3114558639360867, 30.528906862970352, 14.545372140498547, 15.836514984183136, 34.14361194676703, 21.960100494695574, 25.13478257068266, 42.710951358295574, 17.488263882934277, -8.465177376597284, 23.44550681835963]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5132729000789973, "mean_inference_ms": 1.7856698498606036, "mean_action_processing_ms": 0.21769465765876003, "mean_env_wait_ms": 0.13533330379476052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033261775970458984, "StateBufferConnector_ms": 0.002939462661743164, "ViewRequirementAgentConnector_ms": 0.06851756572723389}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.78950118491593, "num_env_steps_trained_throughput_per_sec": 500.78950118491593, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 9332.912, "restore_workers_time_ms": 0.037, "training_step_time_ms": 9332.607, "sample_time_ms": 1252.937, "learn_time_ms": 8047.1, "learn_throughput": 497.073, "synch_weights_time_ms": 30.468}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 122, "trial_id": "1f352_00000", "date": "2024-08-11_15-14-18", "timestamp": 1723403658, "time_this_iter_s": 8.020810842514038, "time_total_s": 1169.3043274879456, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c1d280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1169.3043274879456, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 48.59166666666666, "ram_util_percent": 82.17500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3829615372543533, "cur_kl_coeff": 6.245004513516507e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9033700646211704, "policy_loss": -0.003976492799605088, "vf_loss": 1.9073465493818125, "vf_explained_var": 0.9605610441416502, "kl": 0.0049608684483712214, "entropy": 0.3386919121257961, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 117600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2845635960499444, "cur_kl_coeff": 7.324218749999998e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8884046460191408, "policy_loss": -0.0038438377727288754, "vf_loss": 1.892247938985626, "vf_explained_var": 0.9611587276061376, "kl": 0.007602275045158856, "entropy": 0.43986944102992614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 117600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.92290791622254, "predator_policy": -12.872132534653181}, "policy_reward_max": {"prey_policy": 12.872132534653181, "predator_policy": 54.92290791622254}, "policy_reward_mean": {"prey_policy": -17.952227760049364, "predator_policy": 17.952227760049364}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.94975870521865, -13.291036640252928, -9.748633921895932, -13.634457435017762, -15.564405203745672, -18.87028891076328, -8.512424284549466, -9.308760738905303, -51.35391575794181, -28.274393198120666, -15.94459492938519, -5.329150407041652, -7.773076452341492, -14.428654865490074, -41.7986047704605, -41.81248914992598, -33.23396938990455, -18.861603100760696, -2.0321216230105055, -20.59587140942369, 4.652468033888099, -26.797365817060133, -32.33516368265186, -33.422540121385346, -4.351446481799618, -26.44050218712757, -35.01309040064298, -12.962202218897527, -0.3133284457995513, -21.27892919700932, -5.310001149903121, -9.662223688988039, 12.872132534653181, -24.64727779460497, 1.8903722099996703, -11.565121143759375, -17.178542006594668, -23.856838781297036, -15.227892452461564, -4.820389341146013, -16.186628873507434, -54.92290791622254, -16.170644924594306, 0.3389291676646762, -18.900416685558113, -23.517047080657743, -5.1286483804534555, 0.32239358074742697, -12.561635931054237, -25.981248562558747, -30.60208306993528, -17.477844576518244, -47.30052298249301, -20.6838520253364, -21.89549530619266, -19.584396537310298, -36.26230208879558, -32.90554268925332, -12.2199072844889, -16.84136936825886, -8.796617401238827, -34.28308436608373, 0.4096399901364105, -11.140025914647135, -42.16487494460945, -4.827678625131744, 3.3114558639360867, -30.528906862970352, -14.545372140498547, -15.836514984183136, -34.14361194676703, -21.960100494695574, -25.13478257068266, -42.710951358295574, -17.488263882934277, 8.465177376597284, -23.44550681835963, -1.3141762690708454, -22.40085527291341, -10.830437616381904, -44.22276070332072, -20.3967466956531, -41.82486095784347, -1.3641542957412431, -14.814618705264953, -23.293605806037924, -8.585519334436801, -16.106663835167762, -2.168933656302775, -5.736773456314436, -38.39271393424153, -20.79495709387611, -14.945145187883167, -22.50901257606753, -12.135969969272576, -39.02581918300327, -0.08394752525420301, -12.9583783892223, 5.104758324000356, -16.034200223718546], "policy_predator_policy_reward": [10.94975870521865, 13.291036640252928, 9.748633921895932, 13.634457435017762, 15.564405203745672, 18.87028891076328, 8.512424284549466, 9.308760738905303, 51.35391575794181, 28.274393198120666, 15.94459492938519, 5.329150407041652, 7.773076452341492, 14.428654865490074, 41.7986047704605, 41.81248914992598, 33.23396938990455, 18.861603100760696, 2.0321216230105055, 20.59587140942369, -4.652468033888099, 26.797365817060133, 32.33516368265186, 33.422540121385346, 4.351446481799618, 26.44050218712757, 35.01309040064298, 12.962202218897527, 0.3133284457995513, 21.27892919700932, 5.310001149903121, 9.662223688988039, -12.872132534653181, 24.64727779460497, -1.8903722099996703, 11.565121143759375, 17.178542006594668, 23.856838781297036, 15.227892452461564, 4.820389341146013, 16.186628873507434, 54.92290791622254, 16.170644924594306, -0.3389291676646762, 18.900416685558113, 23.517047080657743, 5.1286483804534555, -0.32239358074742697, 12.561635931054237, 25.981248562558747, 30.60208306993528, 17.477844576518244, 47.30052298249301, 20.6838520253364, 21.89549530619266, 19.584396537310298, 36.26230208879558, 32.90554268925332, 12.2199072844889, 16.84136936825886, 8.796617401238827, 34.28308436608373, -0.4096399901364105, 11.140025914647135, 42.16487494460945, 4.827678625131744, -3.3114558639360867, 30.528906862970352, 14.545372140498547, 15.836514984183136, 34.14361194676703, 21.960100494695574, 25.13478257068266, 42.710951358295574, 17.488263882934277, -8.465177376597284, 23.44550681835963, 1.3141762690708454, 22.40085527291341, 10.830437616381904, 44.22276070332072, 20.3967466956531, 41.82486095784347, 1.3641542957412431, 14.814618705264953, 23.293605806037924, 8.585519334436801, 16.106663835167762, 2.168933656302775, 5.736773456314436, 38.39271393424153, 20.79495709387611, 14.945145187883167, 22.50901257606753, 12.135969969272576, 39.02581918300327, 0.08394752525420301, 12.9583783892223, -5.104758324000356, 16.034200223718546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5129579386765534, "mean_inference_ms": 1.7819438567212742, "mean_action_processing_ms": 0.21731808700424188, "mean_env_wait_ms": 0.13501180468836188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003226161003112793, "StateBufferConnector_ms": 0.0029342174530029297, "ViewRequirementAgentConnector_ms": 0.06618034839630127}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 463.16479352411363, "num_env_steps_trained_throughput_per_sec": 463.16479352411363, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 9193.304, "restore_workers_time_ms": 0.036, "training_step_time_ms": 9193.001, "sample_time_ms": 1176.627, "learn_time_ms": 7984.018, "learn_throughput": 501.001, "synch_weights_time_ms": 30.248}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "training_iteration": 123, "trial_id": "1f352_00000", "date": "2024-08-11_15-14-27", "timestamp": 1723403667, "time_this_iter_s": 8.684133052825928, "time_total_s": 1177.9884605407715, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c1dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1177.9884605407715, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 51.291666666666664, "ram_util_percent": 81.97500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2558820875361563, "cur_kl_coeff": 3.1225022567582536e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6747344225645064, "policy_loss": -0.00295431497215759, "vf_loss": 1.6776887346679965, "vf_explained_var": 0.9680076933776339, "kl": 0.002699582957912435, "entropy": 0.325694663869217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 118560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3103052666410804, "cur_kl_coeff": 7.324218749999998e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6641515290364624, "policy_loss": -0.0047182844529743305, "vf_loss": 1.6688690884038806, "vf_explained_var": 0.9684952503691117, "kl": 0.00992915560871097, "entropy": 0.4143073379993439, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 118560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.92290791622254, "predator_policy": -12.872132534653181}, "policy_reward_max": {"prey_policy": 12.872132534653181, "predator_policy": 54.92290791622254}, "policy_reward_mean": {"prey_policy": -17.959376160169658, "predator_policy": 17.959376160169658}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0321216230105055, -20.59587140942369, 4.652468033888099, -26.797365817060133, -32.33516368265186, -33.422540121385346, -4.351446481799618, -26.44050218712757, -35.01309040064298, -12.962202218897527, -0.3133284457995513, -21.27892919700932, -5.310001149903121, -9.662223688988039, 12.872132534653181, -24.64727779460497, 1.8903722099996703, -11.565121143759375, -17.178542006594668, -23.856838781297036, -15.227892452461564, -4.820389341146013, -16.186628873507434, -54.92290791622254, -16.170644924594306, 0.3389291676646762, -18.900416685558113, -23.517047080657743, -5.1286483804534555, 0.32239358074742697, -12.561635931054237, -25.981248562558747, -30.60208306993528, -17.477844576518244, -47.30052298249301, -20.6838520253364, -21.89549530619266, -19.584396537310298, -36.26230208879558, -32.90554268925332, -12.2199072844889, -16.84136936825886, -8.796617401238827, -34.28308436608373, 0.4096399901364105, -11.140025914647135, -42.16487494460945, -4.827678625131744, 3.3114558639360867, -30.528906862970352, -14.545372140498547, -15.836514984183136, -34.14361194676703, -21.960100494695574, -25.13478257068266, -42.710951358295574, -17.488263882934277, 8.465177376597284, -23.44550681835963, -1.3141762690708454, -22.40085527291341, -10.830437616381904, -44.22276070332072, -20.3967466956531, -41.82486095784347, -1.3641542957412431, -14.814618705264953, -23.293605806037924, -8.585519334436801, -16.106663835167762, -2.168933656302775, -5.736773456314436, -38.39271393424153, -20.79495709387611, -14.945145187883167, -22.50901257606753, -12.135969969272576, -39.02581918300327, -0.08394752525420301, -12.9583783892223, 5.104758324000356, -16.034200223718546, -13.944438748084284, -4.148179546399761, -36.38851235883086, -46.003464321860115, -42.27692227020598, -10.329311141011926, -13.742369238680556, -7.642746273515387, 1.5433992440030249, -36.65090541633775, -26.266370988497297, -23.584360043077908, -11.598543748090313, -27.913203410082502, -25.917110843049457, -9.552132417749235, -24.773663019561624, -0.2162233327187213], "policy_predator_policy_reward": [2.0321216230105055, 20.59587140942369, -4.652468033888099, 26.797365817060133, 32.33516368265186, 33.422540121385346, 4.351446481799618, 26.44050218712757, 35.01309040064298, 12.962202218897527, 0.3133284457995513, 21.27892919700932, 5.310001149903121, 9.662223688988039, -12.872132534653181, 24.64727779460497, -1.8903722099996703, 11.565121143759375, 17.178542006594668, 23.856838781297036, 15.227892452461564, 4.820389341146013, 16.186628873507434, 54.92290791622254, 16.170644924594306, -0.3389291676646762, 18.900416685558113, 23.517047080657743, 5.1286483804534555, -0.32239358074742697, 12.561635931054237, 25.981248562558747, 30.60208306993528, 17.477844576518244, 47.30052298249301, 20.6838520253364, 21.89549530619266, 19.584396537310298, 36.26230208879558, 32.90554268925332, 12.2199072844889, 16.84136936825886, 8.796617401238827, 34.28308436608373, -0.4096399901364105, 11.140025914647135, 42.16487494460945, 4.827678625131744, -3.3114558639360867, 30.528906862970352, 14.545372140498547, 15.836514984183136, 34.14361194676703, 21.960100494695574, 25.13478257068266, 42.710951358295574, 17.488263882934277, -8.465177376597284, 23.44550681835963, 1.3141762690708454, 22.40085527291341, 10.830437616381904, 44.22276070332072, 20.3967466956531, 41.82486095784347, 1.3641542957412431, 14.814618705264953, 23.293605806037924, 8.585519334436801, 16.106663835167762, 2.168933656302775, 5.736773456314436, 38.39271393424153, 20.79495709387611, 14.945145187883167, 22.50901257606753, 12.135969969272576, 39.02581918300327, 0.08394752525420301, 12.9583783892223, -5.104758324000356, 16.034200223718546, 13.944438748084284, 4.148179546399761, 36.38851235883086, 46.003464321860115, 42.27692227020598, 10.329311141011926, 13.742369238680556, 7.642746273515387, -1.5433992440030249, 36.65090541633775, 26.266370988497297, 23.584360043077908, 11.598543748090313, 27.913203410082502, 25.917110843049457, 9.552132417749235, 24.773663019561624, 0.2162233327187213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5113773425374799, "mean_inference_ms": 1.778298404297455, "mean_action_processing_ms": 0.2168746809908579, "mean_env_wait_ms": 0.13480369970108952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030176639556884766, "StateBufferConnector_ms": 0.0025783777236938477, "ViewRequirementAgentConnector_ms": 0.059590697288513184}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.73664972903055, "num_env_steps_trained_throughput_per_sec": 500.73664972903055, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 8961.54, "restore_workers_time_ms": 0.036, "training_step_time_ms": 8961.333, "sample_time_ms": 1145.242, "learn_time_ms": 7785.469, "learn_throughput": 513.778, "synch_weights_time_ms": 28.934}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 124, "trial_id": "1f352_00000", "date": "2024-08-11_15-14-35", "timestamp": 1723403675, "time_this_iter_s": 7.994591951370239, "time_total_s": 1185.9830524921417, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1aba0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1185.9830524921417, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 47.24545454545454, "ram_util_percent": 82.03636363636365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3109506404648226, "cur_kl_coeff": 1.5612511283791268e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7247871761520703, "policy_loss": -0.0019453454292185294, "vf_loss": 1.7267325223733982, "vf_explained_var": 0.9595275873939196, "kl": 0.004023675638367561, "entropy": 0.3066568677468846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 119520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2485878630851706, "cur_kl_coeff": 7.324218749999998e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7281730828185877, "policy_loss": -0.006828446234188353, "vf_loss": 1.7350007663791378, "vf_explained_var": 0.9593829641118645, "kl": 0.010362387634646865, "entropy": 0.3899926021695137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 119520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.92290791622254, "predator_policy": -8.465177376597284}, "policy_reward_max": {"prey_policy": 8.465177376597284, "predator_policy": 54.92290791622254}, "policy_reward_mean": {"prey_policy": -18.590874100731465, "predator_policy": 18.590874100731465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.186628873507434, -54.92290791622254, -16.170644924594306, 0.3389291676646762, -18.900416685558113, -23.517047080657743, -5.1286483804534555, 0.32239358074742697, -12.561635931054237, -25.981248562558747, -30.60208306993528, -17.477844576518244, -47.30052298249301, -20.6838520253364, -21.89549530619266, -19.584396537310298, -36.26230208879558, -32.90554268925332, -12.2199072844889, -16.84136936825886, -8.796617401238827, -34.28308436608373, 0.4096399901364105, -11.140025914647135, -42.16487494460945, -4.827678625131744, 3.3114558639360867, -30.528906862970352, -14.545372140498547, -15.836514984183136, -34.14361194676703, -21.960100494695574, -25.13478257068266, -42.710951358295574, -17.488263882934277, 8.465177376597284, -23.44550681835963, -1.3141762690708454, -22.40085527291341, -10.830437616381904, -44.22276070332072, -20.3967466956531, -41.82486095784347, -1.3641542957412431, -14.814618705264953, -23.293605806037924, -8.585519334436801, -16.106663835167762, -2.168933656302775, -5.736773456314436, -38.39271393424153, -20.79495709387611, -14.945145187883167, -22.50901257606753, -12.135969969272576, -39.02581918300327, -0.08394752525420301, -12.9583783892223, 5.104758324000356, -16.034200223718546, -13.944438748084284, -4.148179546399761, -36.38851235883086, -46.003464321860115, -42.27692227020598, -10.329311141011926, -13.742369238680556, -7.642746273515387, 1.5433992440030249, -36.65090541633775, -26.266370988497297, -23.584360043077908, -11.598543748090313, -27.913203410082502, -25.917110843049457, -9.552132417749235, -24.773663019561624, -0.2162233327187213, 1.8688237351681218, -12.450599013827809, -12.767986735806797, -13.540007049730137, -7.022633136215697, -7.091294623462572, -18.9362364125233, -18.462597694805588, -38.85124362052106, -32.60796423946623, 0.23333398338338718, -23.255615098989793, -50.74732229809086, -8.29565261576884, -7.72773205058864, 1.1763678297800446, 7.226871732460985, -4.261895060666756, -37.31538610117303, -15.828691407150957, -44.14120855509634, -28.747000788110917], "policy_predator_policy_reward": [16.186628873507434, 54.92290791622254, 16.170644924594306, -0.3389291676646762, 18.900416685558113, 23.517047080657743, 5.1286483804534555, -0.32239358074742697, 12.561635931054237, 25.981248562558747, 30.60208306993528, 17.477844576518244, 47.30052298249301, 20.6838520253364, 21.89549530619266, 19.584396537310298, 36.26230208879558, 32.90554268925332, 12.2199072844889, 16.84136936825886, 8.796617401238827, 34.28308436608373, -0.4096399901364105, 11.140025914647135, 42.16487494460945, 4.827678625131744, -3.3114558639360867, 30.528906862970352, 14.545372140498547, 15.836514984183136, 34.14361194676703, 21.960100494695574, 25.13478257068266, 42.710951358295574, 17.488263882934277, -8.465177376597284, 23.44550681835963, 1.3141762690708454, 22.40085527291341, 10.830437616381904, 44.22276070332072, 20.3967466956531, 41.82486095784347, 1.3641542957412431, 14.814618705264953, 23.293605806037924, 8.585519334436801, 16.106663835167762, 2.168933656302775, 5.736773456314436, 38.39271393424153, 20.79495709387611, 14.945145187883167, 22.50901257606753, 12.135969969272576, 39.02581918300327, 0.08394752525420301, 12.9583783892223, -5.104758324000356, 16.034200223718546, 13.944438748084284, 4.148179546399761, 36.38851235883086, 46.003464321860115, 42.27692227020598, 10.329311141011926, 13.742369238680556, 7.642746273515387, -1.5433992440030249, 36.65090541633775, 26.266370988497297, 23.584360043077908, 11.598543748090313, 27.913203410082502, 25.917110843049457, 9.552132417749235, 24.773663019561624, 0.2162233327187213, -1.8688237351681218, 12.450599013827809, 12.767986735806797, 13.540007049730137, 7.022633136215697, 7.091294623462572, 18.9362364125233, 18.462597694805588, 38.85124362052106, 32.60796423946623, -0.23333398338338718, 23.255615098989793, 50.74732229809086, 8.29565261576884, 7.72773205058864, -1.1763678297800446, -7.226871732460985, 4.261895060666756, 37.31538610117303, 15.828691407150957, 44.14120855509634, 28.747000788110917]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5100716964000077, "mean_inference_ms": 1.7732742980096805, "mean_action_processing_ms": 0.21630772246470648, "mean_env_wait_ms": 0.13441458775380194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029053688049316406, "StateBufferConnector_ms": 0.002379298210144043, "ViewRequirementAgentConnector_ms": 0.053212523460388184}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 461.7380237261539, "num_env_steps_trained_throughput_per_sec": 461.7380237261539, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 1000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1000000, "timers": {"training_iteration_time_ms": 8867.853, "restore_workers_time_ms": 0.035, "training_step_time_ms": 8867.658, "sample_time_ms": 1104.138, "learn_time_ms": 7732.896, "learn_throughput": 517.271, "synch_weights_time_ms": 29.08}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "done": false, "training_iteration": 125, "trial_id": "1f352_00000", "date": "2024-08-11_15-14-44", "timestamp": 1723403684, "time_this_iter_s": 8.72347116470337, "time_total_s": 1194.706523656845, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1abac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1194.706523656845, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 48.85384615384615, "ram_util_percent": 82.77692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2947796034937102, "cur_kl_coeff": 7.806255641895634e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.324222006648779, "policy_loss": -0.003133412150782533, "vf_loss": 2.327355425680677, "vf_explained_var": 0.9422040903319915, "kl": 0.005150404728405593, "entropy": 0.35007488960400224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 120480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3048126079762974, "cur_kl_coeff": 7.324218749999998e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.347776814053456, "policy_loss": -0.005451619639158404, "vf_loss": 2.3532279781997203, "vf_explained_var": 0.9413898567979534, "kl": 0.00624096538709516, "entropy": 0.4659054851159453, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 120480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.74732229809086, "predator_policy": -10.365749605535175}, "policy_reward_max": {"prey_policy": 10.365749605535175, "predator_policy": 50.74732229809086}, "policy_reward_mean": {"prey_policy": -17.640359279048802, "predator_policy": 17.640359279048802}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.2199072844889, -16.84136936825886, -8.796617401238827, -34.28308436608373, 0.4096399901364105, -11.140025914647135, -42.16487494460945, -4.827678625131744, 3.3114558639360867, -30.528906862970352, -14.545372140498547, -15.836514984183136, -34.14361194676703, -21.960100494695574, -25.13478257068266, -42.710951358295574, -17.488263882934277, 8.465177376597284, -23.44550681835963, -1.3141762690708454, -22.40085527291341, -10.830437616381904, -44.22276070332072, -20.3967466956531, -41.82486095784347, -1.3641542957412431, -14.814618705264953, -23.293605806037924, -8.585519334436801, -16.106663835167762, -2.168933656302775, -5.736773456314436, -38.39271393424153, -20.79495709387611, -14.945145187883167, -22.50901257606753, -12.135969969272576, -39.02581918300327, -0.08394752525420301, -12.9583783892223, 5.104758324000356, -16.034200223718546, -13.944438748084284, -4.148179546399761, -36.38851235883086, -46.003464321860115, -42.27692227020598, -10.329311141011926, -13.742369238680556, -7.642746273515387, 1.5433992440030249, -36.65090541633775, -26.266370988497297, -23.584360043077908, -11.598543748090313, -27.913203410082502, -25.917110843049457, -9.552132417749235, -24.773663019561624, -0.2162233327187213, 1.8688237351681218, -12.450599013827809, -12.767986735806797, -13.540007049730137, -7.022633136215697, -7.091294623462572, -18.9362364125233, -18.462597694805588, -38.85124362052106, -32.60796423946623, 0.23333398338338718, -23.255615098989793, -50.74732229809086, -8.29565261576884, -7.72773205058864, 1.1763678297800446, 7.226871732460985, -4.261895060666756, -37.31538610117303, -15.828691407150957, -44.14120855509634, -28.747000788110917, -13.315715225111823, 6.905863770014943, -12.200715330425307, -34.126234052889764, -2.5135248635403684, -35.7390726719201, -3.1669571818482414, -25.270416150174167, -24.32383867865513, -25.2920931516456, -4.740648803051723, -24.13991466949449, 10.365749605535175, -5.602090010252186, -42.95582278739147, -4.679550596338496, -32.81143430821869, -30.761997608355678], "policy_predator_policy_reward": [12.2199072844889, 16.84136936825886, 8.796617401238827, 34.28308436608373, -0.4096399901364105, 11.140025914647135, 42.16487494460945, 4.827678625131744, -3.3114558639360867, 30.528906862970352, 14.545372140498547, 15.836514984183136, 34.14361194676703, 21.960100494695574, 25.13478257068266, 42.710951358295574, 17.488263882934277, -8.465177376597284, 23.44550681835963, 1.3141762690708454, 22.40085527291341, 10.830437616381904, 44.22276070332072, 20.3967466956531, 41.82486095784347, 1.3641542957412431, 14.814618705264953, 23.293605806037924, 8.585519334436801, 16.106663835167762, 2.168933656302775, 5.736773456314436, 38.39271393424153, 20.79495709387611, 14.945145187883167, 22.50901257606753, 12.135969969272576, 39.02581918300327, 0.08394752525420301, 12.9583783892223, -5.104758324000356, 16.034200223718546, 13.944438748084284, 4.148179546399761, 36.38851235883086, 46.003464321860115, 42.27692227020598, 10.329311141011926, 13.742369238680556, 7.642746273515387, -1.5433992440030249, 36.65090541633775, 26.266370988497297, 23.584360043077908, 11.598543748090313, 27.913203410082502, 25.917110843049457, 9.552132417749235, 24.773663019561624, 0.2162233327187213, -1.8688237351681218, 12.450599013827809, 12.767986735806797, 13.540007049730137, 7.022633136215697, 7.091294623462572, 18.9362364125233, 18.462597694805588, 38.85124362052106, 32.60796423946623, -0.23333398338338718, 23.255615098989793, 50.74732229809086, 8.29565261576884, 7.72773205058864, -1.1763678297800446, -7.226871732460985, 4.261895060666756, 37.31538610117303, 15.828691407150957, 44.14120855509634, 28.747000788110917, 13.315715225111823, -6.905863770014943, 12.200715330425307, 34.126234052889764, 2.5135248635403684, 35.7390726719201, 3.1669571818482414, 25.270416150174167, 24.32383867865513, 25.2920931516456, 4.740648803051723, 24.13991466949449, -10.365749605535175, 5.602090010252186, 42.95582278739147, 4.679550596338496, 32.81143430821869, 30.761997608355678]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5090520903528902, "mean_inference_ms": 1.7696744028172042, "mean_action_processing_ms": 0.21594049366120532, "mean_env_wait_ms": 0.13411755784761226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029767751693725586, "StateBufferConnector_ms": 0.0028685331344604492, "ViewRequirementAgentConnector_ms": 0.057012081146240234}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 425.1052253012217, "num_env_steps_trained_throughput_per_sec": 425.1052253012217, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 8651.412, "restore_workers_time_ms": 0.033, "training_step_time_ms": 8651.266, "sample_time_ms": 1064.801, "learn_time_ms": 7556.929, "learn_throughput": 529.316, "synch_weights_time_ms": 28.339}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 126, "trial_id": "1f352_00000", "date": "2024-08-11_15-14-53", "timestamp": 1723403693, "time_this_iter_s": 9.442095756530762, "time_total_s": 1204.1486194133759, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a5bc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1204.1486194133759, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 54.8076923076923, "ram_util_percent": 82.27692307692307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.689175390514235, "cur_kl_coeff": 7.806255641895634e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1840071820964417, "policy_loss": -0.003659601892286446, "vf_loss": 2.187666787331303, "vf_explained_var": 0.9493173419808348, "kl": 0.004104856279543299, "entropy": 0.2878919938423981, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 121440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.749884099885821, "cur_kl_coeff": 7.324218749999998e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.178609777055681, "policy_loss": -0.004052324756533683, "vf_loss": 2.1826616508265335, "vf_explained_var": 0.9498428366457422, "kl": 0.006258063282620367, "entropy": 0.45058389014254013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 121440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.74732229809086, "predator_policy": -10.365749605535175}, "policy_reward_max": {"prey_policy": 10.365749605535175, "predator_policy": 50.74732229809086}, "policy_reward_mean": {"prey_policy": -17.22315196626291, "predator_policy": 17.22315196626291}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-23.44550681835963, -1.3141762690708454, -22.40085527291341, -10.830437616381904, -44.22276070332072, -20.3967466956531, -41.82486095784347, -1.3641542957412431, -14.814618705264953, -23.293605806037924, -8.585519334436801, -16.106663835167762, -2.168933656302775, -5.736773456314436, -38.39271393424153, -20.79495709387611, -14.945145187883167, -22.50901257606753, -12.135969969272576, -39.02581918300327, -0.08394752525420301, -12.9583783892223, 5.104758324000356, -16.034200223718546, -13.944438748084284, -4.148179546399761, -36.38851235883086, -46.003464321860115, -42.27692227020598, -10.329311141011926, -13.742369238680556, -7.642746273515387, 1.5433992440030249, -36.65090541633775, -26.266370988497297, -23.584360043077908, -11.598543748090313, -27.913203410082502, -25.917110843049457, -9.552132417749235, -24.773663019561624, -0.2162233327187213, 1.8688237351681218, -12.450599013827809, -12.767986735806797, -13.540007049730137, -7.022633136215697, -7.091294623462572, -18.9362364125233, -18.462597694805588, -38.85124362052106, -32.60796423946623, 0.23333398338338718, -23.255615098989793, -50.74732229809086, -8.29565261576884, -7.72773205058864, 1.1763678297800446, 7.226871732460985, -4.261895060666756, -37.31538610117303, -15.828691407150957, -44.14120855509634, -28.747000788110917, -13.315715225111823, 6.905863770014943, -12.200715330425307, -34.126234052889764, -2.5135248635403684, -35.7390726719201, -3.1669571818482414, -25.270416150174167, -24.32383867865513, -25.2920931516456, -4.740648803051723, -24.13991466949449, 10.365749605535175, -5.602090010252186, -42.95582278739147, -4.679550596338496, -32.81143430821869, -30.761997608355678, -19.981509441811564, -9.018788813271653, -10.828691615822331, -13.500424897459547, 0.3028885260046712, -8.922332548137174, -17.16921958735508, -25.245607641454317, -17.471891900693663, -1.881469655187125, -38.74931310213193, 8.029588807936351, -32.82769369149915, -27.439666271540787, -0.6590570081071161, -26.26420015751262, -17.109696146290673, -19.977972491892984], "policy_predator_policy_reward": [23.44550681835963, 1.3141762690708454, 22.40085527291341, 10.830437616381904, 44.22276070332072, 20.3967466956531, 41.82486095784347, 1.3641542957412431, 14.814618705264953, 23.293605806037924, 8.585519334436801, 16.106663835167762, 2.168933656302775, 5.736773456314436, 38.39271393424153, 20.79495709387611, 14.945145187883167, 22.50901257606753, 12.135969969272576, 39.02581918300327, 0.08394752525420301, 12.9583783892223, -5.104758324000356, 16.034200223718546, 13.944438748084284, 4.148179546399761, 36.38851235883086, 46.003464321860115, 42.27692227020598, 10.329311141011926, 13.742369238680556, 7.642746273515387, -1.5433992440030249, 36.65090541633775, 26.266370988497297, 23.584360043077908, 11.598543748090313, 27.913203410082502, 25.917110843049457, 9.552132417749235, 24.773663019561624, 0.2162233327187213, -1.8688237351681218, 12.450599013827809, 12.767986735806797, 13.540007049730137, 7.022633136215697, 7.091294623462572, 18.9362364125233, 18.462597694805588, 38.85124362052106, 32.60796423946623, -0.23333398338338718, 23.255615098989793, 50.74732229809086, 8.29565261576884, 7.72773205058864, -1.1763678297800446, -7.226871732460985, 4.261895060666756, 37.31538610117303, 15.828691407150957, 44.14120855509634, 28.747000788110917, 13.315715225111823, -6.905863770014943, 12.200715330425307, 34.126234052889764, 2.5135248635403684, 35.7390726719201, 3.1669571818482414, 25.270416150174167, 24.32383867865513, 25.2920931516456, 4.740648803051723, 24.13991466949449, -10.365749605535175, 5.602090010252186, 42.95582278739147, 4.679550596338496, 32.81143430821869, 30.761997608355678, 19.981509441811564, 9.018788813271653, 10.828691615822331, 13.500424897459547, -0.3028885260046712, 8.922332548137174, 17.16921958735508, 25.245607641454317, 17.471891900693663, 1.881469655187125, 38.74931310213193, -8.029588807936351, 32.82769369149915, 27.439666271540787, 0.6590570081071161, 26.26420015751262, 17.109696146290673, 19.977972491892984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5083136471211372, "mean_inference_ms": 1.767055801697461, "mean_action_processing_ms": 0.21567397520811876, "mean_env_wait_ms": 0.13388273948577248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00367891788482666, "StateBufferConnector_ms": 0.002993941307067871, "ViewRequirementAgentConnector_ms": 0.06323075294494629}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.2067666261371, "num_env_steps_trained_throughput_per_sec": 441.2067666261371, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 1016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1016000, "timers": {"training_iteration_time_ms": 8598.95, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8598.833, "sample_time_ms": 1082.566, "learn_time_ms": 7485.571, "learn_throughput": 534.361, "synch_weights_time_ms": 29.786}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000}, "done": false, "training_iteration": 127, "trial_id": "1f352_00000", "date": "2024-08-11_15-15-03", "timestamp": 1723403703, "time_this_iter_s": 9.141000032424927, "time_total_s": 1213.2896194458008, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a7f040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1213.2896194458008, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 53.04615384615384, "ram_util_percent": 82.45384615384614}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.534596293295423, "cur_kl_coeff": 3.903127820947817e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.040962842727701, "policy_loss": -0.003136027129464007, "vf_loss": 2.0440988646199307, "vf_explained_var": 0.9629232461874684, "kl": 0.004519810907937268, "entropy": 0.2672701241293301, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 122400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5315571705500286, "cur_kl_coeff": 7.324218749999998e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0206879659245414, "policy_loss": -0.008932062282595628, "vf_loss": 2.0296194987371563, "vf_explained_var": 0.9634135531882445, "kl": 0.007246675213244273, "entropy": 0.4592872431812187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 122400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.980547661507565, "predator_policy": -10.365749605535175}, "policy_reward_max": {"prey_policy": 10.365749605535175, "predator_policy": 54.980547661507565}, "policy_reward_mean": {"prey_policy": -16.961239998979853, "predator_policy": 16.961239998979853}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.034200223718546, -13.944438748084284, -4.148179546399761, -36.38851235883086, -46.003464321860115, -42.27692227020598, -10.329311141011926, -13.742369238680556, -7.642746273515387, 1.5433992440030249, -36.65090541633775, -26.266370988497297, -23.584360043077908, -11.598543748090313, -27.913203410082502, -25.917110843049457, -9.552132417749235, -24.773663019561624, -0.2162233327187213, 1.8688237351681218, -12.450599013827809, -12.767986735806797, -13.540007049730137, -7.022633136215697, -7.091294623462572, -18.9362364125233, -18.462597694805588, -38.85124362052106, -32.60796423946623, 0.23333398338338718, -23.255615098989793, -50.74732229809086, -8.29565261576884, -7.72773205058864, 1.1763678297800446, 7.226871732460985, -4.261895060666756, -37.31538610117303, -15.828691407150957, -44.14120855509634, -28.747000788110917, -13.315715225111823, 6.905863770014943, -12.200715330425307, -34.126234052889764, -2.5135248635403684, -35.7390726719201, -3.1669571818482414, -25.270416150174167, -24.32383867865513, -25.2920931516456, -4.740648803051723, -24.13991466949449, 10.365749605535175, -5.602090010252186, -42.95582278739147, -4.679550596338496, -32.81143430821869, -30.761997608355678, -19.981509441811564, -9.018788813271653, -10.828691615822331, -13.500424897459547, 0.3028885260046712, -8.922332548137174, -17.16921958735508, -25.245607641454317, -17.471891900693663, -1.881469655187125, -38.74931310213193, 8.029588807936351, -32.82769369149915, -27.439666271540787, -0.6590570081071161, -26.26420015751262, -17.109696146290673, -19.977972491892984, -20.709833591794506, -36.31768726852644, -42.46714734207959, 1.398182882745786, -12.693152642719168, -37.68270068819484, -5.332962692973717, -2.4893318887210203, -9.442883626362104, -8.325480370574638, -1.1246418702973315, 0.3399916401092753, 1.56418751158885, -30.040834731843226, -16.60791959740289, -1.5571616891799245, -34.81702561759912, -15.362223250809759, -54.980547661507565, -28.77500867268673, 1.034075498843496, 5.890012437943646, -17.55550899728225], "policy_predator_policy_reward": [16.034200223718546, 13.944438748084284, 4.148179546399761, 36.38851235883086, 46.003464321860115, 42.27692227020598, 10.329311141011926, 13.742369238680556, 7.642746273515387, -1.5433992440030249, 36.65090541633775, 26.266370988497297, 23.584360043077908, 11.598543748090313, 27.913203410082502, 25.917110843049457, 9.552132417749235, 24.773663019561624, 0.2162233327187213, -1.8688237351681218, 12.450599013827809, 12.767986735806797, 13.540007049730137, 7.022633136215697, 7.091294623462572, 18.9362364125233, 18.462597694805588, 38.85124362052106, 32.60796423946623, -0.23333398338338718, 23.255615098989793, 50.74732229809086, 8.29565261576884, 7.72773205058864, -1.1763678297800446, -7.226871732460985, 4.261895060666756, 37.31538610117303, 15.828691407150957, 44.14120855509634, 28.747000788110917, 13.315715225111823, -6.905863770014943, 12.200715330425307, 34.126234052889764, 2.5135248635403684, 35.7390726719201, 3.1669571818482414, 25.270416150174167, 24.32383867865513, 25.2920931516456, 4.740648803051723, 24.13991466949449, -10.365749605535175, 5.602090010252186, 42.95582278739147, 4.679550596338496, 32.81143430821869, 30.761997608355678, 19.981509441811564, 9.018788813271653, 10.828691615822331, 13.500424897459547, -0.3028885260046712, 8.922332548137174, 17.16921958735508, 25.245607641454317, 17.471891900693663, 1.881469655187125, 38.74931310213193, -8.029588807936351, 32.82769369149915, 27.439666271540787, 0.6590570081071161, 26.26420015751262, 17.109696146290673, 19.977972491892984, 20.709833591794506, 36.31768726852644, 42.46714734207959, -1.398182882745786, 12.693152642719168, 37.68270068819484, 5.332962692973717, 2.4893318887210203, 9.442883626362104, 8.325480370574638, 1.1246418702973315, -0.3399916401092753, -1.56418751158885, 30.040834731843226, 16.60791959740289, 1.5571616891799245, 34.81702561759912, 15.362223250809759, 54.980547661507565, 28.77500867268673, -1.034075498843496, -5.890012437943646, 17.55550899728225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5074899425831154, "mean_inference_ms": 1.7642356971833988, "mean_action_processing_ms": 0.21538398894343533, "mean_env_wait_ms": 0.13363516143804843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003733038902282715, "StateBufferConnector_ms": 0.0029528141021728516, "ViewRequirementAgentConnector_ms": 0.06793403625488281}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 433.63211184209575, "num_env_steps_trained_throughput_per_sec": 433.63211184209575, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 8653.411, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8653.288, "sample_time_ms": 1091.957, "learn_time_ms": 7530.255, "learn_throughput": 531.191, "synch_weights_time_ms": 29.954}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 128, "trial_id": "1f352_00000", "date": "2024-08-11_15-15-12", "timestamp": 1723403712, "time_this_iter_s": 9.288082361221313, "time_total_s": 1222.577701807022, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1abac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1222.577701807022, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 52.96428571428572, "ram_util_percent": 82.50714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.257438551696638, "cur_kl_coeff": 1.9515639104739085e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.081259399900834, "policy_loss": -0.002345429822647323, "vf_loss": 2.0836048307518165, "vf_explained_var": 0.9332791403556864, "kl": 0.003798809169488654, "entropy": 0.25746854869648816, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 123360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.323668981343508, "cur_kl_coeff": 7.324218749999998e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0859066851437094, "policy_loss": -0.004559344265241331, "vf_loss": 2.0904654725144307, "vf_explained_var": 0.9337365667025248, "kl": 0.007532169606415136, "entropy": 0.4558713432401419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 123360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.980547661507565, "predator_policy": -10.365749605535175}, "policy_reward_max": {"prey_policy": 10.365749605535175, "predator_policy": 54.980547661507565}, "policy_reward_mean": {"prey_policy": -16.618394173932295, "predator_policy": 16.618394173932295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.540007049730137, -7.022633136215697, -7.091294623462572, -18.9362364125233, -18.462597694805588, -38.85124362052106, -32.60796423946623, 0.23333398338338718, -23.255615098989793, -50.74732229809086, -8.29565261576884, -7.72773205058864, 1.1763678297800446, 7.226871732460985, -4.261895060666756, -37.31538610117303, -15.828691407150957, -44.14120855509634, -28.747000788110917, -13.315715225111823, 6.905863770014943, -12.200715330425307, -34.126234052889764, -2.5135248635403684, -35.7390726719201, -3.1669571818482414, -25.270416150174167, -24.32383867865513, -25.2920931516456, -4.740648803051723, -24.13991466949449, 10.365749605535175, -5.602090010252186, -42.95582278739147, -4.679550596338496, -32.81143430821869, -30.761997608355678, -19.981509441811564, -9.018788813271653, -10.828691615822331, -13.500424897459547, 0.3028885260046712, -8.922332548137174, -17.16921958735508, -25.245607641454317, -17.471891900693663, -1.881469655187125, -38.74931310213193, 8.029588807936351, -32.82769369149915, -27.439666271540787, -0.6590570081071161, -26.26420015751262, -17.109696146290673, -19.977972491892984, -20.709833591794506, -36.31768726852644, -42.46714734207959, 1.398182882745786, -12.693152642719168, -37.68270068819484, -5.332962692973717, -2.4893318887210203, -9.442883626362104, -8.325480370574638, -1.1246418702973315, 0.3399916401092753, 1.56418751158885, -30.040834731843226, -16.60791959740289, -1.5571616891799245, -34.81702561759912, -15.362223250809759, -54.980547661507565, -28.77500867268673, 1.034075498843496, 5.890012437943646, -17.55550899728225, -26.655105243698348, -11.602117069874579, -27.584027665398395, -3.047671504980466, -18.966520451542635, 1.7020994596830867, -10.992009863876552, -21.63636079928865, -9.306014753929126, -22.128028898236256, 3.0699334127908013, -26.15561908397404, -11.403240203755368, -4.993347440252399, -7.398515397991817, -31.053573116199082, -47.81786876002434, -2.098082177895268, -14.576246797479108, -33.60929285860123, -11.812277811171127, -26.440550581484455], "policy_predator_policy_reward": [13.540007049730137, 7.022633136215697, 7.091294623462572, 18.9362364125233, 18.462597694805588, 38.85124362052106, 32.60796423946623, -0.23333398338338718, 23.255615098989793, 50.74732229809086, 8.29565261576884, 7.72773205058864, -1.1763678297800446, -7.226871732460985, 4.261895060666756, 37.31538610117303, 15.828691407150957, 44.14120855509634, 28.747000788110917, 13.315715225111823, -6.905863770014943, 12.200715330425307, 34.126234052889764, 2.5135248635403684, 35.7390726719201, 3.1669571818482414, 25.270416150174167, 24.32383867865513, 25.2920931516456, 4.740648803051723, 24.13991466949449, -10.365749605535175, 5.602090010252186, 42.95582278739147, 4.679550596338496, 32.81143430821869, 30.761997608355678, 19.981509441811564, 9.018788813271653, 10.828691615822331, 13.500424897459547, -0.3028885260046712, 8.922332548137174, 17.16921958735508, 25.245607641454317, 17.471891900693663, 1.881469655187125, 38.74931310213193, -8.029588807936351, 32.82769369149915, 27.439666271540787, 0.6590570081071161, 26.26420015751262, 17.109696146290673, 19.977972491892984, 20.709833591794506, 36.31768726852644, 42.46714734207959, -1.398182882745786, 12.693152642719168, 37.68270068819484, 5.332962692973717, 2.4893318887210203, 9.442883626362104, 8.325480370574638, 1.1246418702973315, -0.3399916401092753, -1.56418751158885, 30.040834731843226, 16.60791959740289, 1.5571616891799245, 34.81702561759912, 15.362223250809759, 54.980547661507565, 28.77500867268673, -1.034075498843496, -5.890012437943646, 17.55550899728225, 26.655105243698348, 11.602117069874579, 27.584027665398395, 3.047671504980466, 18.966520451542635, -1.7020994596830867, 10.992009863876552, 21.63636079928865, 9.306014753929126, 22.128028898236256, -3.0699334127908013, 26.15561908397404, 11.403240203755368, 4.993347440252399, 7.398515397991817, 31.053573116199082, 47.81786876002434, 2.098082177895268, 14.576246797479108, 33.60929285860123, 11.812277811171127, 26.440550581484455]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5097034947355855, "mean_inference_ms": 1.7718680244418505, "mean_action_processing_ms": 0.21663000457938478, "mean_env_wait_ms": 0.1341200549315818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004087209701538086, "StateBufferConnector_ms": 0.0030099153518676758, "ViewRequirementAgentConnector_ms": 0.10048353672027588}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.1320774409683, "num_env_steps_trained_throughput_per_sec": 428.1320774409683, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 1032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 8692.03, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8691.905, "sample_time_ms": 1111.529, "learn_time_ms": 7549.591, "learn_throughput": 529.83, "synch_weights_time_ms": 29.62}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "training_iteration": 129, "trial_id": "1f352_00000", "date": "2024-08-11_15-15-21", "timestamp": 1723403721, "time_this_iter_s": 9.399901866912842, "time_total_s": 1231.977603673935, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c3a550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1231.977603673935, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 53.92307692307691, "ram_util_percent": 82.7923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4450586415206392, "cur_kl_coeff": 9.757819552369543e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.428015253817042, "policy_loss": -0.0028759586821252014, "vf_loss": 2.4308912041286628, "vf_explained_var": 0.9322016508628924, "kl": 0.005013496268024013, "entropy": 0.2590286227408797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 124320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3948846213519572, "cur_kl_coeff": 7.324218749999998e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.388615596542756, "policy_loss": -0.014019933820721538, "vf_loss": 2.402633794521292, "vf_explained_var": 0.9325703694174687, "kl": 0.023882275703727134, "entropy": 0.44162197451417645, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 124320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.980547661507565, "predator_policy": -10.365749605535175}, "policy_reward_max": {"prey_policy": 10.365749605535175, "predator_policy": 54.980547661507565}, "policy_reward_mean": {"prey_policy": -16.048564789657334, "predator_policy": 16.048564789657334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-28.747000788110917, -13.315715225111823, 6.905863770014943, -12.200715330425307, -34.126234052889764, -2.5135248635403684, -35.7390726719201, -3.1669571818482414, -25.270416150174167, -24.32383867865513, -25.2920931516456, -4.740648803051723, -24.13991466949449, 10.365749605535175, -5.602090010252186, -42.95582278739147, -4.679550596338496, -32.81143430821869, -30.761997608355678, -19.981509441811564, -9.018788813271653, -10.828691615822331, -13.500424897459547, 0.3028885260046712, -8.922332548137174, -17.16921958735508, -25.245607641454317, -17.471891900693663, -1.881469655187125, -38.74931310213193, 8.029588807936351, -32.82769369149915, -27.439666271540787, -0.6590570081071161, -26.26420015751262, -17.109696146290673, -19.977972491892984, -20.709833591794506, -36.31768726852644, -42.46714734207959, 1.398182882745786, -12.693152642719168, -37.68270068819484, -5.332962692973717, -2.4893318887210203, -9.442883626362104, -8.325480370574638, -1.1246418702973315, 0.3399916401092753, 1.56418751158885, -30.040834731843226, -16.60791959740289, -1.5571616891799245, -34.81702561759912, -15.362223250809759, -54.980547661507565, -28.77500867268673, 1.034075498843496, 5.890012437943646, -17.55550899728225, -26.655105243698348, -11.602117069874579, -27.584027665398395, -3.047671504980466, -18.966520451542635, 1.7020994596830867, -10.992009863876552, -21.63636079928865, -9.306014753929126, -22.128028898236256, 3.0699334127908013, -26.15561908397404, -11.403240203755368, -4.993347440252399, -7.398515397991817, -31.053573116199082, -47.81786876002434, -2.098082177895268, -14.576246797479108, -33.60929285860123, -11.812277811171127, -26.440550581484455, -16.484962571162868, -1.3224753226228483, -11.244143767493366, -21.5317857411626, -15.757864596596379, -10.996473966897575, -14.418926550116312, 0.4420731873989219, -14.877002664598916, -30.745322458172062, -6.148460661808777, -39.575556326018166, -1.7578669156249571, -41.05691392696571, -5.235679899920601, -3.57196676066231, -3.306990011589674, -24.87564903711552], "policy_predator_policy_reward": [28.747000788110917, 13.315715225111823, -6.905863770014943, 12.200715330425307, 34.126234052889764, 2.5135248635403684, 35.7390726719201, 3.1669571818482414, 25.270416150174167, 24.32383867865513, 25.2920931516456, 4.740648803051723, 24.13991466949449, -10.365749605535175, 5.602090010252186, 42.95582278739147, 4.679550596338496, 32.81143430821869, 30.761997608355678, 19.981509441811564, 9.018788813271653, 10.828691615822331, 13.500424897459547, -0.3028885260046712, 8.922332548137174, 17.16921958735508, 25.245607641454317, 17.471891900693663, 1.881469655187125, 38.74931310213193, -8.029588807936351, 32.82769369149915, 27.439666271540787, 0.6590570081071161, 26.26420015751262, 17.109696146290673, 19.977972491892984, 20.709833591794506, 36.31768726852644, 42.46714734207959, -1.398182882745786, 12.693152642719168, 37.68270068819484, 5.332962692973717, 2.4893318887210203, 9.442883626362104, 8.325480370574638, 1.1246418702973315, -0.3399916401092753, -1.56418751158885, 30.040834731843226, 16.60791959740289, 1.5571616891799245, 34.81702561759912, 15.362223250809759, 54.980547661507565, 28.77500867268673, -1.034075498843496, -5.890012437943646, 17.55550899728225, 26.655105243698348, 11.602117069874579, 27.584027665398395, 3.047671504980466, 18.966520451542635, -1.7020994596830867, 10.992009863876552, 21.63636079928865, 9.306014753929126, 22.128028898236256, -3.0699334127908013, 26.15561908397404, 11.403240203755368, 4.993347440252399, 7.398515397991817, 31.053573116199082, 47.81786876002434, 2.098082177895268, 14.576246797479108, 33.60929285860123, 11.812277811171127, 26.440550581484455, 16.484962571162868, 1.3224753226228483, 11.244143767493366, 21.5317857411626, 15.757864596596379, 10.996473966897575, 14.418926550116312, -0.4420731873989219, 14.877002664598916, 30.745322458172062, 6.148460661808777, 39.575556326018166, 1.7578669156249571, 41.05691392696571, 5.235679899920601, 3.57196676066231, 3.306990011589674, 24.87564903711552]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5069181922338444, "mean_inference_ms": 1.7622562682993068, "mean_action_processing_ms": 0.21537360917148723, "mean_env_wait_ms": 0.13337699462714872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004121065139770508, "StateBufferConnector_ms": 0.0030798912048339844, "ViewRequirementAgentConnector_ms": 0.1044912338256836}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 416.3066017828621, "num_env_steps_trained_throughput_per_sec": 416.3066017828621, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 8823.286, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8823.162, "sample_time_ms": 1104.613, "learn_time_ms": 7689.339, "learn_throughput": 520.201, "synch_weights_time_ms": 28.03}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 130, "trial_id": "1f352_00000", "date": "2024-08-11_15-15-31", "timestamp": 1723403731, "time_this_iter_s": 9.676609992980957, "time_total_s": 1241.654213666916, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cdf430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1241.654213666916, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 54.714285714285715, "ram_util_percent": 82.50714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8815272013346354, "cur_kl_coeff": 9.757819552369543e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.841809041549762, "policy_loss": -0.001239211748179514, "vf_loss": 2.843048251544436, "vf_explained_var": 0.9306572043647369, "kl": 0.003722681504520727, "entropy": 0.3826576449908316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 125280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7146769211317103, "cur_kl_coeff": 0.00010986328125000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.791798907890916, "policy_loss": -0.005761201984326666, "vf_loss": 2.7975593877335387, "vf_explained_var": 0.9311223004634182, "kl": 0.006463647483461316, "entropy": 0.4846976895506183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 125280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.980547661507565, "predator_policy": -8.029588807936351}, "policy_reward_max": {"prey_policy": 8.029588807936351, "predator_policy": 54.980547661507565}, "policy_reward_mean": {"prey_policy": -16.120186549139568, "predator_policy": 16.120186549139568}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-30.761997608355678, -19.981509441811564, -9.018788813271653, -10.828691615822331, -13.500424897459547, 0.3028885260046712, -8.922332548137174, -17.16921958735508, -25.245607641454317, -17.471891900693663, -1.881469655187125, -38.74931310213193, 8.029588807936351, -32.82769369149915, -27.439666271540787, -0.6590570081071161, -26.26420015751262, -17.109696146290673, -19.977972491892984, -20.709833591794506, -36.31768726852644, -42.46714734207959, 1.398182882745786, -12.693152642719168, -37.68270068819484, -5.332962692973717, -2.4893318887210203, -9.442883626362104, -8.325480370574638, -1.1246418702973315, 0.3399916401092753, 1.56418751158885, -30.040834731843226, -16.60791959740289, -1.5571616891799245, -34.81702561759912, -15.362223250809759, -54.980547661507565, -28.77500867268673, 1.034075498843496, 5.890012437943646, -17.55550899728225, -26.655105243698348, -11.602117069874579, -27.584027665398395, -3.047671504980466, -18.966520451542635, 1.7020994596830867, -10.992009863876552, -21.63636079928865, -9.306014753929126, -22.128028898236256, 3.0699334127908013, -26.15561908397404, -11.403240203755368, -4.993347440252399, -7.398515397991817, -31.053573116199082, -47.81786876002434, -2.098082177895268, -14.576246797479108, -33.60929285860123, -11.812277811171127, -26.440550581484455, -16.484962571162868, -1.3224753226228483, -11.244143767493366, -21.5317857411626, -15.757864596596379, -10.996473966897575, -14.418926550116312, 0.4420731873989219, -14.877002664598916, -30.745322458172062, -6.148460661808777, -39.575556326018166, -1.7578669156249571, -41.05691392696571, -5.235679899920601, -3.57196676066231, -3.306990011589674, -24.87564903711552, -22.891123138818806, 5.446803863495198, -39.62642838139571, -34.72751883838956, -21.61550526916423, -54.37720626136225, -25.275226600849347, -17.55934860114672, 6.775847505156145, -9.78063995326621, -4.46372477388841, -11.239714575275451, -23.412225231897995, 5.2807834366246595, 0.21422223755854652, -48.377096343161284, -7.652179548110597, -6.23531136784934], "policy_predator_policy_reward": [30.761997608355678, 19.981509441811564, 9.018788813271653, 10.828691615822331, 13.500424897459547, -0.3028885260046712, 8.922332548137174, 17.16921958735508, 25.245607641454317, 17.471891900693663, 1.881469655187125, 38.74931310213193, -8.029588807936351, 32.82769369149915, 27.439666271540787, 0.6590570081071161, 26.26420015751262, 17.109696146290673, 19.977972491892984, 20.709833591794506, 36.31768726852644, 42.46714734207959, -1.398182882745786, 12.693152642719168, 37.68270068819484, 5.332962692973717, 2.4893318887210203, 9.442883626362104, 8.325480370574638, 1.1246418702973315, -0.3399916401092753, -1.56418751158885, 30.040834731843226, 16.60791959740289, 1.5571616891799245, 34.81702561759912, 15.362223250809759, 54.980547661507565, 28.77500867268673, -1.034075498843496, -5.890012437943646, 17.55550899728225, 26.655105243698348, 11.602117069874579, 27.584027665398395, 3.047671504980466, 18.966520451542635, -1.7020994596830867, 10.992009863876552, 21.63636079928865, 9.306014753929126, 22.128028898236256, -3.0699334127908013, 26.15561908397404, 11.403240203755368, 4.993347440252399, 7.398515397991817, 31.053573116199082, 47.81786876002434, 2.098082177895268, 14.576246797479108, 33.60929285860123, 11.812277811171127, 26.440550581484455, 16.484962571162868, 1.3224753226228483, 11.244143767493366, 21.5317857411626, 15.757864596596379, 10.996473966897575, 14.418926550116312, -0.4420731873989219, 14.877002664598916, 30.745322458172062, 6.148460661808777, 39.575556326018166, 1.7578669156249571, 41.05691392696571, 5.235679899920601, 3.57196676066231, 3.306990011589674, 24.87564903711552, 22.891123138818806, -5.446803863495198, 39.62642838139571, 34.72751883838956, 21.61550526916423, 54.37720626136225, 25.275226600849347, 17.55934860114672, -6.775847505156145, 9.78063995326621, 4.46372477388841, 11.239714575275451, 23.412225231897995, -5.2807834366246595, -0.21422223755854652, 48.377096343161284, 7.652179548110597, 6.23531136784934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5066115456359664, "mean_inference_ms": 1.7607852118086287, "mean_action_processing_ms": 0.21529195553389402, "mean_env_wait_ms": 0.1332346795819494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004076480865478516, "StateBufferConnector_ms": 0.002530217170715332, "ViewRequirementAgentConnector_ms": 0.1012793779373169}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 401.6386415782642, "num_env_steps_trained_throughput_per_sec": 401.6386415782642, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 1048000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1048000, "timers": {"training_iteration_time_ms": 8988.531, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8988.388, "sample_time_ms": 1093.236, "learn_time_ms": 7862.701, "learn_throughput": 508.731, "synch_weights_time_ms": 31.33}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000}, "done": false, "training_iteration": 131, "trial_id": "1f352_00000", "date": "2024-08-11_15-15-41", "timestamp": 1723403741, "time_this_iter_s": 10.009660005569458, "time_total_s": 1251.6638736724854, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a7fd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1251.6638736724854, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 60.728571428571435, "ram_util_percent": 83.20714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.63871267127494, "cur_kl_coeff": 4.878909776184771e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.599296795700987, "policy_loss": -0.004575731854129117, "vf_loss": 2.603872516627113, "vf_explained_var": 0.8999854036917289, "kl": 0.0037278737961607467, "entropy": 0.37251035006095967, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 126240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6026141891876855, "cur_kl_coeff": 0.00010986328125000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5716223342965048, "policy_loss": -0.0012000191006033372, "vf_loss": 2.572821726401647, "vf_explained_var": 0.9008433896427354, "kl": 0.005611090461885804, "entropy": 0.47180975570032996, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 126240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.980547661507565, "predator_policy": -6.775847505156145}, "policy_reward_max": {"prey_policy": 6.775847505156145, "predator_policy": 54.980547661507565}, "policy_reward_mean": {"prey_policy": -15.025845464254601, "predator_policy": 15.025845464254601}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.693152642719168, -37.68270068819484, -5.332962692973717, -2.4893318887210203, -9.442883626362104, -8.325480370574638, -1.1246418702973315, 0.3399916401092753, 1.56418751158885, -30.040834731843226, -16.60791959740289, -1.5571616891799245, -34.81702561759912, -15.362223250809759, -54.980547661507565, -28.77500867268673, 1.034075498843496, 5.890012437943646, -17.55550899728225, -26.655105243698348, -11.602117069874579, -27.584027665398395, -3.047671504980466, -18.966520451542635, 1.7020994596830867, -10.992009863876552, -21.63636079928865, -9.306014753929126, -22.128028898236256, 3.0699334127908013, -26.15561908397404, -11.403240203755368, -4.993347440252399, -7.398515397991817, -31.053573116199082, -47.81786876002434, -2.098082177895268, -14.576246797479108, -33.60929285860123, -11.812277811171127, -26.440550581484455, -16.484962571162868, -1.3224753226228483, -11.244143767493366, -21.5317857411626, -15.757864596596379, -10.996473966897575, -14.418926550116312, 0.4420731873989219, -14.877002664598916, -30.745322458172062, -6.148460661808777, -39.575556326018166, -1.7578669156249571, -41.05691392696571, -5.235679899920601, -3.57196676066231, -3.306990011589674, -24.87564903711552, -22.891123138818806, 5.446803863495198, -39.62642838139571, -34.72751883838956, -21.61550526916423, -54.37720626136225, -25.275226600849347, -17.55934860114672, 6.775847505156145, -9.78063995326621, -4.46372477388841, -11.239714575275451, -23.412225231897995, 5.2807834366246595, 0.21422223755854652, -48.377096343161284, -7.652179548110597, -6.23531136784934, -3.235134014180833, -0.5517536529062319, -23.254570893805965, -2.2241161560485434, -11.875796747775574, -31.561892381695884, -1.7191720411131577, -12.179433235546671, -5.154133467616994, -15.9279628128808, -23.032218913185524, -12.167585758246592, -8.553290715221763, -17.62244038572362, -30.262631744973277, -3.751536856366512, -33.47463458576456, -12.038856081654322, -18.294388062976616, -16.984764771445093, -5.695799195669233, -0.9138011162801485, -7.663518484662763], "policy_predator_policy_reward": [12.693152642719168, 37.68270068819484, 5.332962692973717, 2.4893318887210203, 9.442883626362104, 8.325480370574638, 1.1246418702973315, -0.3399916401092753, -1.56418751158885, 30.040834731843226, 16.60791959740289, 1.5571616891799245, 34.81702561759912, 15.362223250809759, 54.980547661507565, 28.77500867268673, -1.034075498843496, -5.890012437943646, 17.55550899728225, 26.655105243698348, 11.602117069874579, 27.584027665398395, 3.047671504980466, 18.966520451542635, -1.7020994596830867, 10.992009863876552, 21.63636079928865, 9.306014753929126, 22.128028898236256, -3.0699334127908013, 26.15561908397404, 11.403240203755368, 4.993347440252399, 7.398515397991817, 31.053573116199082, 47.81786876002434, 2.098082177895268, 14.576246797479108, 33.60929285860123, 11.812277811171127, 26.440550581484455, 16.484962571162868, 1.3224753226228483, 11.244143767493366, 21.5317857411626, 15.757864596596379, 10.996473966897575, 14.418926550116312, -0.4420731873989219, 14.877002664598916, 30.745322458172062, 6.148460661808777, 39.575556326018166, 1.7578669156249571, 41.05691392696571, 5.235679899920601, 3.57196676066231, 3.306990011589674, 24.87564903711552, 22.891123138818806, -5.446803863495198, 39.62642838139571, 34.72751883838956, 21.61550526916423, 54.37720626136225, 25.275226600849347, 17.55934860114672, -6.775847505156145, 9.78063995326621, 4.46372477388841, 11.239714575275451, 23.412225231897995, -5.2807834366246595, -0.21422223755854652, 48.377096343161284, 7.652179548110597, 6.23531136784934, 3.235134014180833, 0.5517536529062319, 23.254570893805965, 2.2241161560485434, 11.875796747775574, 31.561892381695884, 1.7191720411131577, 12.179433235546671, 5.154133467616994, 15.9279628128808, 23.032218913185524, 12.167585758246592, 8.553290715221763, 17.62244038572362, 30.262631744973277, 3.751536856366512, 33.47463458576456, 12.038856081654322, 18.294388062976616, 16.984764771445093, 5.695799195669233, 0.9138011162801485, 7.663518484662763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5066129026661151, "mean_inference_ms": 1.7583000595871032, "mean_action_processing_ms": 0.21512872983519757, "mean_env_wait_ms": 0.13296060708422847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003382444381713867, "StateBufferConnector_ms": 0.002504110336303711, "ViewRequirementAgentConnector_ms": 0.09453558921813965}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 458.5100105955798, "num_env_steps_trained_throughput_per_sec": 458.5100105955798, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 9062.184, "restore_workers_time_ms": 0.017, "training_step_time_ms": 9062.045, "sample_time_ms": 1107.216, "learn_time_ms": 7922.164, "learn_throughput": 504.913, "synch_weights_time_ms": 31.553}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 132, "trial_id": "1f352_00000", "date": "2024-08-11_15-15-50", "timestamp": 1723403750, "time_this_iter_s": 8.731673240661621, "time_total_s": 1260.395546913147, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a7f4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1260.395546913147, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 53.40833333333333, "ram_util_percent": 81.72500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.396904233346383, "cur_kl_coeff": 2.4394548880923856e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8501215354849894, "policy_loss": -0.0025881121274627123, "vf_loss": 2.852709647019704, "vf_explained_var": 0.8875857518985868, "kl": 0.004210765949065032, "entropy": 0.30825710237647097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 127200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4213116930176812, "cur_kl_coeff": 0.00010986328125000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.837512196476261, "policy_loss": -0.004218627005563273, "vf_loss": 2.8417300156007212, "vf_explained_var": 0.8875145144139727, "kl": 0.007358929453926063, "entropy": 0.46190825992574297, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 127200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.37720626136225, "predator_policy": -8.428450277208002}, "policy_reward_max": {"prey_policy": 8.428450277208002, "predator_policy": 54.37720626136225}, "policy_reward_mean": {"prey_policy": -15.23382421125754, "predator_policy": 15.23382421125754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.55550899728225, -26.655105243698348, -11.602117069874579, -27.584027665398395, -3.047671504980466, -18.966520451542635, 1.7020994596830867, -10.992009863876552, -21.63636079928865, -9.306014753929126, -22.128028898236256, 3.0699334127908013, -26.15561908397404, -11.403240203755368, -4.993347440252399, -7.398515397991817, -31.053573116199082, -47.81786876002434, -2.098082177895268, -14.576246797479108, -33.60929285860123, -11.812277811171127, -26.440550581484455, -16.484962571162868, -1.3224753226228483, -11.244143767493366, -21.5317857411626, -15.757864596596379, -10.996473966897575, -14.418926550116312, 0.4420731873989219, -14.877002664598916, -30.745322458172062, -6.148460661808777, -39.575556326018166, -1.7578669156249571, -41.05691392696571, -5.235679899920601, -3.57196676066231, -3.306990011589674, -24.87564903711552, -22.891123138818806, 5.446803863495198, -39.62642838139571, -34.72751883838956, -21.61550526916423, -54.37720626136225, -25.275226600849347, -17.55934860114672, 6.775847505156145, -9.78063995326621, -4.46372477388841, -11.239714575275451, -23.412225231897995, 5.2807834366246595, 0.21422223755854652, -48.377096343161284, -7.652179548110597, -6.23531136784934, -3.235134014180833, -0.5517536529062319, -23.254570893805965, -2.2241161560485434, -11.875796747775574, -31.561892381695884, -1.7191720411131577, -12.179433235546671, -5.154133467616994, -15.9279628128808, -23.032218913185524, -12.167585758246592, -8.553290715221763, -17.62244038572362, -30.262631744973277, -3.751536856366512, -33.47463458576456, -12.038856081654322, -18.294388062976616, -16.984764771445093, -5.695799195669233, -0.9138011162801485, -7.663518484662763, -24.557165588133632, 2.653328189570896, -14.375520453727361, 8.428450277208002, -4.948491237231043, -24.156991003208397, -43.247056903264095, -23.035092172844216, -9.13224942560371, -29.28020115975003, -8.337641350670884, -13.119073395502307, -23.829587873602268, -0.7948262235904613, -18.53710621103759, -15.325829522909437, -30.308169927914776, 0.7017413695309074], "policy_predator_policy_reward": [17.55550899728225, 26.655105243698348, 11.602117069874579, 27.584027665398395, 3.047671504980466, 18.966520451542635, -1.7020994596830867, 10.992009863876552, 21.63636079928865, 9.306014753929126, 22.128028898236256, -3.0699334127908013, 26.15561908397404, 11.403240203755368, 4.993347440252399, 7.398515397991817, 31.053573116199082, 47.81786876002434, 2.098082177895268, 14.576246797479108, 33.60929285860123, 11.812277811171127, 26.440550581484455, 16.484962571162868, 1.3224753226228483, 11.244143767493366, 21.5317857411626, 15.757864596596379, 10.996473966897575, 14.418926550116312, -0.4420731873989219, 14.877002664598916, 30.745322458172062, 6.148460661808777, 39.575556326018166, 1.7578669156249571, 41.05691392696571, 5.235679899920601, 3.57196676066231, 3.306990011589674, 24.87564903711552, 22.891123138818806, -5.446803863495198, 39.62642838139571, 34.72751883838956, 21.61550526916423, 54.37720626136225, 25.275226600849347, 17.55934860114672, -6.775847505156145, 9.78063995326621, 4.46372477388841, 11.239714575275451, 23.412225231897995, -5.2807834366246595, -0.21422223755854652, 48.377096343161284, 7.652179548110597, 6.23531136784934, 3.235134014180833, 0.5517536529062319, 23.254570893805965, 2.2241161560485434, 11.875796747775574, 31.561892381695884, 1.7191720411131577, 12.179433235546671, 5.154133467616994, 15.9279628128808, 23.032218913185524, 12.167585758246592, 8.553290715221763, 17.62244038572362, 30.262631744973277, 3.751536856366512, 33.47463458576456, 12.038856081654322, 18.294388062976616, 16.984764771445093, 5.695799195669233, 0.9138011162801485, 7.663518484662763, 24.557165588133632, -2.653328189570896, 14.375520453727361, -8.428450277208002, 4.948491237231043, 24.156991003208397, 43.247056903264095, 23.035092172844216, 9.13224942560371, 29.28020115975003, 8.337641350670884, 13.119073395502307, 23.829587873602268, 0.7948262235904613, 18.53710621103759, 15.325829522909437, 30.308169927914776, -0.7017413695309074]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5056756081361163, "mean_inference_ms": 1.7563813534533255, "mean_action_processing_ms": 0.21499401559728945, "mean_env_wait_ms": 0.13284347269386843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003531813621520996, "StateBufferConnector_ms": 0.0025974512100219727, "ViewRequirementAgentConnector_ms": 0.10398435592651367}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 481.0946737222487, "num_env_steps_trained_throughput_per_sec": 481.0946737222487, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 1064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1064000, "timers": {"training_iteration_time_ms": 9029.997, "restore_workers_time_ms": 0.018, "training_step_time_ms": 9029.858, "sample_time_ms": 1142.094, "learn_time_ms": 7854.889, "learn_throughput": 509.237, "synch_weights_time_ms": 31.768}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000}, "done": false, "training_iteration": 133, "trial_id": "1f352_00000", "date": "2024-08-11_15-15-58", "timestamp": 1723403758, "time_this_iter_s": 8.321364879608154, "time_total_s": 1268.7169117927551, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a38af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1268.7169117927551, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 50.291666666666664, "ram_util_percent": 81.70833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2565321408212187, "cur_kl_coeff": 1.2197274440461928e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.761111581325531, "policy_loss": -0.0038909706051830045, "vf_loss": 2.7650025424857936, "vf_explained_var": 0.8751016393303871, "kl": 0.005255610125864738, "entropy": 0.28851833442846936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 128160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2781829236696165, "cur_kl_coeff": 0.00010986328125000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.734090308720867, "policy_loss": -0.006118527369593115, "vf_loss": 2.7402080149700243, "vf_explained_var": 0.8753225364411871, "kl": 0.0074614841511779035, "entropy": 0.44141595360512537, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 128160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.37720626136225, "predator_policy": -8.428450277208002}, "policy_reward_max": {"prey_policy": 8.428450277208002, "predator_policy": 54.37720626136225}, "policy_reward_mean": {"prey_policy": -15.306625668307227, "predator_policy": 15.306625668307227}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.440550581484455, -16.484962571162868, -1.3224753226228483, -11.244143767493366, -21.5317857411626, -15.757864596596379, -10.996473966897575, -14.418926550116312, 0.4420731873989219, -14.877002664598916, -30.745322458172062, -6.148460661808777, -39.575556326018166, -1.7578669156249571, -41.05691392696571, -5.235679899920601, -3.57196676066231, -3.306990011589674, -24.87564903711552, -22.891123138818806, 5.446803863495198, -39.62642838139571, -34.72751883838956, -21.61550526916423, -54.37720626136225, -25.275226600849347, -17.55934860114672, 6.775847505156145, -9.78063995326621, -4.46372477388841, -11.239714575275451, -23.412225231897995, 5.2807834366246595, 0.21422223755854652, -48.377096343161284, -7.652179548110597, -6.23531136784934, -3.235134014180833, -0.5517536529062319, -23.254570893805965, -2.2241161560485434, -11.875796747775574, -31.561892381695884, -1.7191720411131577, -12.179433235546671, -5.154133467616994, -15.9279628128808, -23.032218913185524, -12.167585758246592, -8.553290715221763, -17.62244038572362, -30.262631744973277, -3.751536856366512, -33.47463458576456, -12.038856081654322, -18.294388062976616, -16.984764771445093, -5.695799195669233, -0.9138011162801485, -7.663518484662763, -24.557165588133632, 2.653328189570896, -14.375520453727361, 8.428450277208002, -4.948491237231043, -24.156991003208397, -43.247056903264095, -23.035092172844216, -9.13224942560371, -29.28020115975003, -8.337641350670884, -13.119073395502307, -23.829587873602268, -0.7948262235904613, -18.53710621103759, -15.325829522909437, -30.308169927914776, 0.7017413695309074, -19.627580342242453, -28.949061403589077, -15.645661467702801, -16.98834189130534, -17.893253793251148, -3.2149798902920077, -3.669052541582972, -32.157588311422295, -16.88331163947572, -42.677751529503624, -24.722171287904438, 0.17552848548794664, -20.227155283097744, 1.476922971173182, -25.320851905186306, -9.389096012482973, 7.899246950613669, -12.878238832182143, -33.156538761831094, -27.058008701912918, -10.126449482083082, -11.86614705817258], "policy_predator_policy_reward": [26.440550581484455, 16.484962571162868, 1.3224753226228483, 11.244143767493366, 21.5317857411626, 15.757864596596379, 10.996473966897575, 14.418926550116312, -0.4420731873989219, 14.877002664598916, 30.745322458172062, 6.148460661808777, 39.575556326018166, 1.7578669156249571, 41.05691392696571, 5.235679899920601, 3.57196676066231, 3.306990011589674, 24.87564903711552, 22.891123138818806, -5.446803863495198, 39.62642838139571, 34.72751883838956, 21.61550526916423, 54.37720626136225, 25.275226600849347, 17.55934860114672, -6.775847505156145, 9.78063995326621, 4.46372477388841, 11.239714575275451, 23.412225231897995, -5.2807834366246595, -0.21422223755854652, 48.377096343161284, 7.652179548110597, 6.23531136784934, 3.235134014180833, 0.5517536529062319, 23.254570893805965, 2.2241161560485434, 11.875796747775574, 31.561892381695884, 1.7191720411131577, 12.179433235546671, 5.154133467616994, 15.9279628128808, 23.032218913185524, 12.167585758246592, 8.553290715221763, 17.62244038572362, 30.262631744973277, 3.751536856366512, 33.47463458576456, 12.038856081654322, 18.294388062976616, 16.984764771445093, 5.695799195669233, 0.9138011162801485, 7.663518484662763, 24.557165588133632, -2.653328189570896, 14.375520453727361, -8.428450277208002, 4.948491237231043, 24.156991003208397, 43.247056903264095, 23.035092172844216, 9.13224942560371, 29.28020115975003, 8.337641350670884, 13.119073395502307, 23.829587873602268, 0.7948262235904613, 18.53710621103759, 15.325829522909437, 30.308169927914776, -0.7017413695309074, 19.627580342242453, 28.949061403589077, 15.645661467702801, 16.98834189130534, 17.893253793251148, 3.2149798902920077, 3.669052541582972, 32.157588311422295, 16.88331163947572, 42.677751529503624, 24.722171287904438, -0.17552848548794664, 20.227155283097744, -1.476922971173182, 25.320851905186306, 9.389096012482973, -7.899246950613669, 12.878238832182143, 33.156538761831094, 27.058008701912918, 10.126449482083082, 11.86614705817258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5051031075973189, "mean_inference_ms": 1.753857487021657, "mean_action_processing_ms": 0.2147607387631085, "mean_env_wait_ms": 0.13262365519308747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003483891487121582, "StateBufferConnector_ms": 0.0025440454483032227, "ViewRequirementAgentConnector_ms": 0.10152578353881836}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 420.258708902311, "num_env_steps_trained_throughput_per_sec": 420.258708902311, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 9182.968, "restore_workers_time_ms": 0.018, "training_step_time_ms": 9182.828, "sample_time_ms": 1167.516, "learn_time_ms": 7982.603, "learn_throughput": 501.09, "synch_weights_time_ms": 31.579}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 134, "trial_id": "1f352_00000", "date": "2024-08-11_15-16-08", "timestamp": 1723403768, "time_this_iter_s": 9.595714092254639, "time_total_s": 1278.3126258850098, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c1df70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1278.3126258850098, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 56.935714285714276, "ram_util_percent": 82.49285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7314990440383555, "cur_kl_coeff": 1.2197274440461928e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.448891469091177, "policy_loss": -0.001889384830913817, "vf_loss": 2.4507808572302263, "vf_explained_var": 0.9382674547533194, "kl": 0.0048401247155073586, "entropy": 0.2647106080005566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 129120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5855972609172264, "cur_kl_coeff": 0.00010986328125000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.451524215191603, "policy_loss": -0.002570326128625311, "vf_loss": 2.4540941623349983, "vf_explained_var": 0.9384585039069255, "kl": 0.003426628793245001, "entropy": 0.3765488115760187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 129120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.37720626136225, "predator_policy": -12.946213131059697}, "policy_reward_max": {"prey_policy": 12.946213131059697, "predator_policy": 54.37720626136225}, "policy_reward_mean": {"prey_policy": -15.553864523265847, "predator_policy": 15.553864523265847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.87564903711552, -22.891123138818806, 5.446803863495198, -39.62642838139571, -34.72751883838956, -21.61550526916423, -54.37720626136225, -25.275226600849347, -17.55934860114672, 6.775847505156145, -9.78063995326621, -4.46372477388841, -11.239714575275451, -23.412225231897995, 5.2807834366246595, 0.21422223755854652, -48.377096343161284, -7.652179548110597, -6.23531136784934, -3.235134014180833, -0.5517536529062319, -23.254570893805965, -2.2241161560485434, -11.875796747775574, -31.561892381695884, -1.7191720411131577, -12.179433235546671, -5.154133467616994, -15.9279628128808, -23.032218913185524, -12.167585758246592, -8.553290715221763, -17.62244038572362, -30.262631744973277, -3.751536856366512, -33.47463458576456, -12.038856081654322, -18.294388062976616, -16.984764771445093, -5.695799195669233, -0.9138011162801485, -7.663518484662763, -24.557165588133632, 2.653328189570896, -14.375520453727361, 8.428450277208002, -4.948491237231043, -24.156991003208397, -43.247056903264095, -23.035092172844216, -9.13224942560371, -29.28020115975003, -8.337641350670884, -13.119073395502307, -23.829587873602268, -0.7948262235904613, -18.53710621103759, -15.325829522909437, -30.308169927914776, 0.7017413695309074, -19.627580342242453, -28.949061403589077, -15.645661467702801, -16.98834189130534, -17.893253793251148, -3.2149798902920077, -3.669052541582972, -32.157588311422295, -16.88331163947572, -42.677751529503624, -24.722171287904438, 0.17552848548794664, -20.227155283097744, 1.476922971173182, -25.320851905186306, -9.389096012482973, 7.899246950613669, -12.878238832182143, -33.156538761831094, -27.058008701912918, -10.126449482083082, -11.86614705817258, -21.8323265440347, -11.911921046345578, -32.231068662967374, -20.34457373222827, -10.065759139176446, -12.673289892502533, -5.965013602338866, 4.890506321084258, -9.55344713720756, -38.89653046603032, 12.946213131059697, -12.932124493751555, -18.912962858715698, -31.46727178970376, 1.1715816380831008, -20.843711192401855, -16.0147791617663, -44.11827640241711], "policy_predator_policy_reward": [24.87564903711552, 22.891123138818806, -5.446803863495198, 39.62642838139571, 34.72751883838956, 21.61550526916423, 54.37720626136225, 25.275226600849347, 17.55934860114672, -6.775847505156145, 9.78063995326621, 4.46372477388841, 11.239714575275451, 23.412225231897995, -5.2807834366246595, -0.21422223755854652, 48.377096343161284, 7.652179548110597, 6.23531136784934, 3.235134014180833, 0.5517536529062319, 23.254570893805965, 2.2241161560485434, 11.875796747775574, 31.561892381695884, 1.7191720411131577, 12.179433235546671, 5.154133467616994, 15.9279628128808, 23.032218913185524, 12.167585758246592, 8.553290715221763, 17.62244038572362, 30.262631744973277, 3.751536856366512, 33.47463458576456, 12.038856081654322, 18.294388062976616, 16.984764771445093, 5.695799195669233, 0.9138011162801485, 7.663518484662763, 24.557165588133632, -2.653328189570896, 14.375520453727361, -8.428450277208002, 4.948491237231043, 24.156991003208397, 43.247056903264095, 23.035092172844216, 9.13224942560371, 29.28020115975003, 8.337641350670884, 13.119073395502307, 23.829587873602268, 0.7948262235904613, 18.53710621103759, 15.325829522909437, 30.308169927914776, -0.7017413695309074, 19.627580342242453, 28.949061403589077, 15.645661467702801, 16.98834189130534, 17.893253793251148, 3.2149798902920077, 3.669052541582972, 32.157588311422295, 16.88331163947572, 42.677751529503624, 24.722171287904438, -0.17552848548794664, 20.227155283097744, -1.476922971173182, 25.320851905186306, 9.389096012482973, -7.899246950613669, 12.878238832182143, 33.156538761831094, 27.058008701912918, 10.126449482083082, 11.86614705817258, 21.8323265440347, 11.911921046345578, 32.231068662967374, 20.34457373222827, 10.065759139176446, 12.673289892502533, 5.965013602338866, -4.890506321084258, 9.55344713720756, 38.89653046603032, -12.946213131059697, 12.932124493751555, 18.912962858715698, 31.46727178970376, -1.1715816380831008, 20.843711192401855, 16.0147791617663, 44.11827640241711]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5044666924851628, "mean_inference_ms": 1.7514017226950727, "mean_action_processing_ms": 0.21447801798697377, "mean_env_wait_ms": 0.13242108105069808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006641745567321777, "StateBufferConnector_ms": 0.0029867887496948242, "ViewRequirementAgentConnector_ms": 0.07478046417236328}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 447.87151781508356, "num_env_steps_trained_throughput_per_sec": 447.87151781508356, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 9209.847, "restore_workers_time_ms": 0.018, "training_step_time_ms": 9209.649, "sample_time_ms": 1179.991, "learn_time_ms": 7997.337, "learn_throughput": 500.166, "synch_weights_time_ms": 31.154}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 135, "trial_id": "1f352_00000", "date": "2024-08-11_15-16-17", "timestamp": 1723403777, "time_this_iter_s": 8.983719110488892, "time_total_s": 1287.2963449954987, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cdf550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1287.2963449954987, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 52.4076923076923, "ram_util_percent": 82.04615384615386}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4299171869953473, "cur_kl_coeff": 6.098637220230964e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.716431247939666, "policy_loss": -0.0013347527055884711, "vf_loss": 2.7177660072843235, "vf_explained_var": 0.9221445626889666, "kl": 0.004071358411834443, "entropy": 0.32138049043715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 130080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.471505132690072, "cur_kl_coeff": 5.4931640625000015e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7137770682573317, "policy_loss": -0.003658053219745246, "vf_loss": 2.7174348372966053, "vf_explained_var": 0.9223337169115742, "kl": 0.005511251148081411, "entropy": 0.4370674824342132, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 130080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -51.967674196812524, "predator_policy": -16.797742482471058}, "policy_reward_max": {"prey_policy": 16.797742482471058, "predator_policy": 51.967674196812524}, "policy_reward_mean": {"prey_policy": -16.369500828047823, "predator_policy": 16.369500828047823}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.23531136784934, -3.235134014180833, -0.5517536529062319, -23.254570893805965, -2.2241161560485434, -11.875796747775574, -31.561892381695884, -1.7191720411131577, -12.179433235546671, -5.154133467616994, -15.9279628128808, -23.032218913185524, -12.167585758246592, -8.553290715221763, -17.62244038572362, -30.262631744973277, -3.751536856366512, -33.47463458576456, -12.038856081654322, -18.294388062976616, -16.984764771445093, -5.695799195669233, -0.9138011162801485, -7.663518484662763, -24.557165588133632, 2.653328189570896, -14.375520453727361, 8.428450277208002, -4.948491237231043, -24.156991003208397, -43.247056903264095, -23.035092172844216, -9.13224942560371, -29.28020115975003, -8.337641350670884, -13.119073395502307, -23.829587873602268, -0.7948262235904613, -18.53710621103759, -15.325829522909437, -30.308169927914776, 0.7017413695309074, -19.627580342242453, -28.949061403589077, -15.645661467702801, -16.98834189130534, -17.893253793251148, -3.2149798902920077, -3.669052541582972, -32.157588311422295, -16.88331163947572, -42.677751529503624, -24.722171287904438, 0.17552848548794664, -20.227155283097744, 1.476922971173182, -25.320851905186306, -9.389096012482973, 7.899246950613669, -12.878238832182143, -33.156538761831094, -27.058008701912918, -10.126449482083082, -11.86614705817258, -21.8323265440347, -11.911921046345578, -32.231068662967374, -20.34457373222827, -10.065759139176446, -12.673289892502533, -5.965013602338866, 4.890506321084258, -9.55344713720756, -38.89653046603032, 12.946213131059697, -12.932124493751555, -18.912962858715698, -31.46727178970376, 1.1715816380831008, -20.843711192401855, -16.0147791617663, -44.11827640241711, 3.8176658049944745, -42.67413876094093, -32.793823291445364, -13.368856848417563, -14.351568338277099, -8.464044868649804, -23.891889328764908, -26.112785649042817, -51.967674196812524, -2.282591486716261, -22.523827975965364, -51.82104798645059, -29.444140722135167, -16.50011118762575, -30.897717671752627, -28.84674596097147, 16.797742482471058, -34.3940040027023], "policy_predator_policy_reward": [6.23531136784934, 3.235134014180833, 0.5517536529062319, 23.254570893805965, 2.2241161560485434, 11.875796747775574, 31.561892381695884, 1.7191720411131577, 12.179433235546671, 5.154133467616994, 15.9279628128808, 23.032218913185524, 12.167585758246592, 8.553290715221763, 17.62244038572362, 30.262631744973277, 3.751536856366512, 33.47463458576456, 12.038856081654322, 18.294388062976616, 16.984764771445093, 5.695799195669233, 0.9138011162801485, 7.663518484662763, 24.557165588133632, -2.653328189570896, 14.375520453727361, -8.428450277208002, 4.948491237231043, 24.156991003208397, 43.247056903264095, 23.035092172844216, 9.13224942560371, 29.28020115975003, 8.337641350670884, 13.119073395502307, 23.829587873602268, 0.7948262235904613, 18.53710621103759, 15.325829522909437, 30.308169927914776, -0.7017413695309074, 19.627580342242453, 28.949061403589077, 15.645661467702801, 16.98834189130534, 17.893253793251148, 3.2149798902920077, 3.669052541582972, 32.157588311422295, 16.88331163947572, 42.677751529503624, 24.722171287904438, -0.17552848548794664, 20.227155283097744, -1.476922971173182, 25.320851905186306, 9.389096012482973, -7.899246950613669, 12.878238832182143, 33.156538761831094, 27.058008701912918, 10.126449482083082, 11.86614705817258, 21.8323265440347, 11.911921046345578, 32.231068662967374, 20.34457373222827, 10.065759139176446, 12.673289892502533, 5.965013602338866, -4.890506321084258, 9.55344713720756, 38.89653046603032, -12.946213131059697, 12.932124493751555, 18.912962858715698, 31.46727178970376, -1.1715816380831008, 20.843711192401855, 16.0147791617663, 44.11827640241711, -3.8176658049944745, 42.67413876094093, 32.793823291445364, 13.368856848417563, 14.351568338277099, 8.464044868649804, 23.891889328764908, 26.112785649042817, 51.967674196812524, 2.282591486716261, 22.523827975965364, 51.82104798645059, 29.444140722135167, 16.50011118762575, 30.897717671752627, 28.84674596097147, -16.797742482471058, 34.3940040027023]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5040525504101263, "mean_inference_ms": 1.7499830975888597, "mean_action_processing_ms": 0.21429418673050185, "mean_env_wait_ms": 0.13229342854855455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007605075836181641, "StateBufferConnector_ms": 0.003148674964904785, "ViewRequirementAgentConnector_ms": 0.08131253719329834}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 423.0381859855862, "num_env_steps_trained_throughput_per_sec": 423.0381859855862, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 9214.446, "restore_workers_time_ms": 0.018, "training_step_time_ms": 9214.24, "sample_time_ms": 1193.076, "learn_time_ms": 7988.826, "learn_throughput": 500.699, "synch_weights_time_ms": 30.967}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 136, "trial_id": "1f352_00000", "date": "2024-08-11_15-16-27", "timestamp": 1723403787, "time_this_iter_s": 9.511804819107056, "time_total_s": 1296.8081498146057, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1acb670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1296.8081498146057, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 57.93846153846153, "ram_util_percent": 82.45384615384614}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.735277721906702, "cur_kl_coeff": 3.049318610115482e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.698094485948483, "policy_loss": -0.00176476165894807, "vf_loss": 2.699859244997303, "vf_explained_var": 0.9342840135097503, "kl": 0.003360757963175968, "entropy": 0.2702768369112164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 131040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6994740126033623, "cur_kl_coeff": 5.4931640625000015e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6987052665402493, "policy_loss": -0.005285473229256847, "vf_loss": 2.7039902848502, "vf_explained_var": 0.9328103688855965, "kl": 0.008092773779535307, "entropy": 0.3645450096577406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 131040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.928568016810274, "predator_policy": -16.797742482471058}, "policy_reward_max": {"prey_policy": 16.797742482471058, "predator_policy": 55.928568016810274}, "policy_reward_mean": {"prey_policy": -17.521450544135238, "predator_policy": 17.521450544135238}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-7.663518484662763, -24.557165588133632, 2.653328189570896, -14.375520453727361, 8.428450277208002, -4.948491237231043, -24.156991003208397, -43.247056903264095, -23.035092172844216, -9.13224942560371, -29.28020115975003, -8.337641350670884, -13.119073395502307, -23.829587873602268, -0.7948262235904613, -18.53710621103759, -15.325829522909437, -30.308169927914776, 0.7017413695309074, -19.627580342242453, -28.949061403589077, -15.645661467702801, -16.98834189130534, -17.893253793251148, -3.2149798902920077, -3.669052541582972, -32.157588311422295, -16.88331163947572, -42.677751529503624, -24.722171287904438, 0.17552848548794664, -20.227155283097744, 1.476922971173182, -25.320851905186306, -9.389096012482973, 7.899246950613669, -12.878238832182143, -33.156538761831094, -27.058008701912918, -10.126449482083082, -11.86614705817258, -21.8323265440347, -11.911921046345578, -32.231068662967374, -20.34457373222827, -10.065759139176446, -12.673289892502533, -5.965013602338866, 4.890506321084258, -9.55344713720756, -38.89653046603032, 12.946213131059697, -12.932124493751555, -18.912962858715698, -31.46727178970376, 1.1715816380831008, -20.843711192401855, -16.0147791617663, -44.11827640241711, 3.8176658049944745, -42.67413876094093, -32.793823291445364, -13.368856848417563, -14.351568338277099, -8.464044868649804, -23.891889328764908, -26.112785649042817, -51.967674196812524, -2.282591486716261, -22.523827975965364, -51.82104798645059, -29.444140722135167, -16.50011118762575, -30.897717671752627, -28.84674596097147, 16.797742482471058, -34.3940040027023, -15.91194086936732, -12.220580598055399, -15.243364100729174, 1.4069611390305905, -6.885083760329125, -1.1141439033072436, -17.456230392657336, -10.743222903401863, -7.302664583246105, -32.13649020039703, -34.30996549669464, -55.928568016810274, -19.24269444103189, -20.689748722812503, -9.6320651872998, -41.35469912578218, -31.353533213356076, 4.540442070353048, -9.149093634804208, -35.617696599419915, -8.388790864622734, -5.860129411620109, -27.312893751307303], "policy_predator_policy_reward": [7.663518484662763, 24.557165588133632, -2.653328189570896, 14.375520453727361, -8.428450277208002, 4.948491237231043, 24.156991003208397, 43.247056903264095, 23.035092172844216, 9.13224942560371, 29.28020115975003, 8.337641350670884, 13.119073395502307, 23.829587873602268, 0.7948262235904613, 18.53710621103759, 15.325829522909437, 30.308169927914776, -0.7017413695309074, 19.627580342242453, 28.949061403589077, 15.645661467702801, 16.98834189130534, 17.893253793251148, 3.2149798902920077, 3.669052541582972, 32.157588311422295, 16.88331163947572, 42.677751529503624, 24.722171287904438, -0.17552848548794664, 20.227155283097744, -1.476922971173182, 25.320851905186306, 9.389096012482973, -7.899246950613669, 12.878238832182143, 33.156538761831094, 27.058008701912918, 10.126449482083082, 11.86614705817258, 21.8323265440347, 11.911921046345578, 32.231068662967374, 20.34457373222827, 10.065759139176446, 12.673289892502533, 5.965013602338866, -4.890506321084258, 9.55344713720756, 38.89653046603032, -12.946213131059697, 12.932124493751555, 18.912962858715698, 31.46727178970376, -1.1715816380831008, 20.843711192401855, 16.0147791617663, 44.11827640241711, -3.8176658049944745, 42.67413876094093, 32.793823291445364, 13.368856848417563, 14.351568338277099, 8.464044868649804, 23.891889328764908, 26.112785649042817, 51.967674196812524, 2.282591486716261, 22.523827975965364, 51.82104798645059, 29.444140722135167, 16.50011118762575, 30.897717671752627, 28.84674596097147, -16.797742482471058, 34.3940040027023, 15.91194086936732, 12.220580598055399, 15.243364100729174, -1.4069611390305905, 6.885083760329125, 1.1141439033072436, 17.456230392657336, 10.743222903401863, 7.302664583246105, 32.13649020039703, 34.30996549669464, 55.928568016810274, 19.24269444103189, 20.689748722812503, 9.6320651872998, 41.35469912578218, 31.353533213356076, -4.540442070353048, 9.149093634804208, 35.617696599419915, 8.388790864622734, 5.860129411620109, 27.312893751307303]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5038270149050496, "mean_inference_ms": 1.7492133257152989, "mean_action_processing_ms": 0.21419595502447344, "mean_env_wait_ms": 0.1322092498522835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009573817253112793, "StateBufferConnector_ms": 0.0038497447967529297, "ViewRequirementAgentConnector_ms": 0.08896219730377197}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 450.2923333087662, "num_env_steps_trained_throughput_per_sec": 450.2923333087662, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 1096000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1096000, "timers": {"training_iteration_time_ms": 9196.153, "restore_workers_time_ms": 0.018, "training_step_time_ms": 9195.953, "sample_time_ms": 1211.995, "learn_time_ms": 7956.261, "learn_throughput": 502.749, "synch_weights_time_ms": 26.403}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000}, "done": false, "training_iteration": 137, "trial_id": "1f352_00000", "date": "2024-08-11_15-16-36", "timestamp": 1723403796, "time_this_iter_s": 8.949186086654663, "time_total_s": 1305.7573359012604, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cdf670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1305.7573359012604, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 51.653846153846146, "ram_util_percent": 82.23076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3976971906920275, "cur_kl_coeff": 1.524659305057741e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3432648222893477, "policy_loss": -0.0006667335956687263, "vf_loss": 2.3439315600941577, "vf_explained_var": 0.9264852012197177, "kl": 0.004417850020239783, "entropy": 0.2750623328921696, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3574231795966627, "cur_kl_coeff": 5.4931640625000015e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3580694153904913, "policy_loss": -0.004865765786962584, "vf_loss": 2.362934736410777, "vf_explained_var": 0.9266851305961609, "kl": 0.008096372486979317, "entropy": 0.372484273960193, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.928568016810274, "predator_policy": -16.797742482471058}, "policy_reward_max": {"prey_policy": 16.797742482471058, "predator_policy": 55.928568016810274}, "policy_reward_mean": {"prey_policy": -16.918953703148034, "predator_policy": 16.918953703148034}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.98834189130534, -17.893253793251148, -3.2149798902920077, -3.669052541582972, -32.157588311422295, -16.88331163947572, -42.677751529503624, -24.722171287904438, 0.17552848548794664, -20.227155283097744, 1.476922971173182, -25.320851905186306, -9.389096012482973, 7.899246950613669, -12.878238832182143, -33.156538761831094, -27.058008701912918, -10.126449482083082, -11.86614705817258, -21.8323265440347, -11.911921046345578, -32.231068662967374, -20.34457373222827, -10.065759139176446, -12.673289892502533, -5.965013602338866, 4.890506321084258, -9.55344713720756, -38.89653046603032, 12.946213131059697, -12.932124493751555, -18.912962858715698, -31.46727178970376, 1.1715816380831008, -20.843711192401855, -16.0147791617663, -44.11827640241711, 3.8176658049944745, -42.67413876094093, -32.793823291445364, -13.368856848417563, -14.351568338277099, -8.464044868649804, -23.891889328764908, -26.112785649042817, -51.967674196812524, -2.282591486716261, -22.523827975965364, -51.82104798645059, -29.444140722135167, -16.50011118762575, -30.897717671752627, -28.84674596097147, 16.797742482471058, -34.3940040027023, -15.91194086936732, -12.220580598055399, -15.243364100729174, 1.4069611390305905, -6.885083760329125, -1.1141439033072436, -17.456230392657336, -10.743222903401863, -7.302664583246105, -32.13649020039703, -34.30996549669464, -55.928568016810274, -19.24269444103189, -20.689748722812503, -9.6320651872998, -41.35469912578218, -31.353533213356076, 4.540442070353048, -9.149093634804208, -35.617696599419915, -8.388790864622734, -5.860129411620109, -27.312893751307303, 1.0077677803655787, -6.358088819542088, -3.62957746426785, -15.31686712549309, -8.132965534628756, -37.655811321811406, -24.24405737669433, -20.938764344455375, 8.332178854629674, -11.02091662370506, -25.614497643738794, -3.6667734648695145, -24.962435211527943, -0.6476166995222838, -24.400536003811258, -11.56431404029438, -16.167494860216785, -16.26825663378969, -3.2409845289623096, -27.805099679321565, -1.5768926057458161, -8.9656168647541], "policy_predator_policy_reward": [16.98834189130534, 17.893253793251148, 3.2149798902920077, 3.669052541582972, 32.157588311422295, 16.88331163947572, 42.677751529503624, 24.722171287904438, -0.17552848548794664, 20.227155283097744, -1.476922971173182, 25.320851905186306, 9.389096012482973, -7.899246950613669, 12.878238832182143, 33.156538761831094, 27.058008701912918, 10.126449482083082, 11.86614705817258, 21.8323265440347, 11.911921046345578, 32.231068662967374, 20.34457373222827, 10.065759139176446, 12.673289892502533, 5.965013602338866, -4.890506321084258, 9.55344713720756, 38.89653046603032, -12.946213131059697, 12.932124493751555, 18.912962858715698, 31.46727178970376, -1.1715816380831008, 20.843711192401855, 16.0147791617663, 44.11827640241711, -3.8176658049944745, 42.67413876094093, 32.793823291445364, 13.368856848417563, 14.351568338277099, 8.464044868649804, 23.891889328764908, 26.112785649042817, 51.967674196812524, 2.282591486716261, 22.523827975965364, 51.82104798645059, 29.444140722135167, 16.50011118762575, 30.897717671752627, 28.84674596097147, -16.797742482471058, 34.3940040027023, 15.91194086936732, 12.220580598055399, 15.243364100729174, -1.4069611390305905, 6.885083760329125, 1.1141439033072436, 17.456230392657336, 10.743222903401863, 7.302664583246105, 32.13649020039703, 34.30996549669464, 55.928568016810274, 19.24269444103189, 20.689748722812503, 9.6320651872998, 41.35469912578218, 31.353533213356076, -4.540442070353048, 9.149093634804208, 35.617696599419915, 8.388790864622734, 5.860129411620109, 27.312893751307303, -1.0077677803655787, 6.358088819542088, 3.62957746426785, 15.31686712549309, 8.132965534628756, 37.655811321811406, 24.24405737669433, 20.938764344455375, -8.332178854629674, 11.02091662370506, 25.614497643738794, 3.6667734648695145, 24.962435211527943, 0.6476166995222838, 24.400536003811258, 11.56431404029438, 16.167494860216785, 16.26825663378969, 3.2409845289623096, 27.805099679321565, 1.5768926057458161, 8.9656168647541]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5063455690839112, "mean_inference_ms": 1.757846132223416, "mean_action_processing_ms": 0.21551243438824497, "mean_env_wait_ms": 0.13278936320964718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010755181312561035, "StateBufferConnector_ms": 0.0038677453994750977, "ViewRequirementAgentConnector_ms": 0.11572432518005371}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 438.8841253833712, "num_env_steps_trained_throughput_per_sec": 438.8841253833712, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 9185.114, "restore_workers_time_ms": 0.016, "training_step_time_ms": 9184.914, "sample_time_ms": 1247.465, "learn_time_ms": 7909.618, "learn_throughput": 505.713, "synch_weights_time_ms": 26.707}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 138, "trial_id": "1f352_00000", "date": "2024-08-11_15-16-45", "timestamp": 1723403805, "time_this_iter_s": 9.124358892440796, "time_total_s": 1314.8816947937012, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cdf1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1314.8816947937012, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 53.11538461538463, "ram_util_percent": 81.84615384615384}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3129127861311036, "cur_kl_coeff": 7.623296525288705e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.607628619670868, "policy_loss": -0.003096688343794085, "vf_loss": 1.610725304360191, "vf_explained_var": 0.9699062248691916, "kl": 0.0032018232050404533, "entropy": 0.23129552779719234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.321274343940119, "cur_kl_coeff": 5.4931640625000015e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.65736132748425, "policy_loss": -0.00504949274181854, "vf_loss": 1.6624104511613647, "vf_explained_var": 0.9683485881114999, "kl": 0.006732879813886384, "entropy": 0.36334887482225897, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.928568016810274, "predator_policy": -16.797742482471058}, "policy_reward_max": {"prey_policy": 16.797742482471058, "predator_policy": 55.928568016810274}, "policy_reward_mean": {"prey_policy": -17.82450163237042, "predator_policy": 17.82450163237042}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.86614705817258, -21.8323265440347, -11.911921046345578, -32.231068662967374, -20.34457373222827, -10.065759139176446, -12.673289892502533, -5.965013602338866, 4.890506321084258, -9.55344713720756, -38.89653046603032, 12.946213131059697, -12.932124493751555, -18.912962858715698, -31.46727178970376, 1.1715816380831008, -20.843711192401855, -16.0147791617663, -44.11827640241711, 3.8176658049944745, -42.67413876094093, -32.793823291445364, -13.368856848417563, -14.351568338277099, -8.464044868649804, -23.891889328764908, -26.112785649042817, -51.967674196812524, -2.282591486716261, -22.523827975965364, -51.82104798645059, -29.444140722135167, -16.50011118762575, -30.897717671752627, -28.84674596097147, 16.797742482471058, -34.3940040027023, -15.91194086936732, -12.220580598055399, -15.243364100729174, 1.4069611390305905, -6.885083760329125, -1.1141439033072436, -17.456230392657336, -10.743222903401863, -7.302664583246105, -32.13649020039703, -34.30996549669464, -55.928568016810274, -19.24269444103189, -20.689748722812503, -9.6320651872998, -41.35469912578218, -31.353533213356076, 4.540442070353048, -9.149093634804208, -35.617696599419915, -8.388790864622734, -5.860129411620109, -27.312893751307303, 1.0077677803655787, -6.358088819542088, -3.62957746426785, -15.31686712549309, -8.132965534628756, -37.655811321811406, -24.24405737669433, -20.938764344455375, 8.332178854629674, -11.02091662370506, -25.614497643738794, -3.6667734648695145, -24.962435211527943, -0.6476166995222838, -24.400536003811258, -11.56431404029438, -16.167494860216785, -16.26825663378969, -3.2409845289623096, -27.805099679321565, -1.5768926057458161, -8.9656168647541, -30.53113298182867, -17.835091629985584, -1.5602435352824227, -16.42616369211103, 11.392410343307812, -20.515718987442604, -0.6558538796459275, -23.73745181219362, -29.663158001978243, -38.02103872455248, -19.44675422354853, -32.4559305251659, -22.246981796266226, -16.88273319801001, -25.9062329882586, -36.235479394391575, -39.26866712375133, -17.36966222737275], "policy_predator_policy_reward": [11.86614705817258, 21.8323265440347, 11.911921046345578, 32.231068662967374, 20.34457373222827, 10.065759139176446, 12.673289892502533, 5.965013602338866, -4.890506321084258, 9.55344713720756, 38.89653046603032, -12.946213131059697, 12.932124493751555, 18.912962858715698, 31.46727178970376, -1.1715816380831008, 20.843711192401855, 16.0147791617663, 44.11827640241711, -3.8176658049944745, 42.67413876094093, 32.793823291445364, 13.368856848417563, 14.351568338277099, 8.464044868649804, 23.891889328764908, 26.112785649042817, 51.967674196812524, 2.282591486716261, 22.523827975965364, 51.82104798645059, 29.444140722135167, 16.50011118762575, 30.897717671752627, 28.84674596097147, -16.797742482471058, 34.3940040027023, 15.91194086936732, 12.220580598055399, 15.243364100729174, -1.4069611390305905, 6.885083760329125, 1.1141439033072436, 17.456230392657336, 10.743222903401863, 7.302664583246105, 32.13649020039703, 34.30996549669464, 55.928568016810274, 19.24269444103189, 20.689748722812503, 9.6320651872998, 41.35469912578218, 31.353533213356076, -4.540442070353048, 9.149093634804208, 35.617696599419915, 8.388790864622734, 5.860129411620109, 27.312893751307303, -1.0077677803655787, 6.358088819542088, 3.62957746426785, 15.31686712549309, 8.132965534628756, 37.655811321811406, 24.24405737669433, 20.938764344455375, -8.332178854629674, 11.02091662370506, 25.614497643738794, 3.6667734648695145, 24.962435211527943, 0.6476166995222838, 24.400536003811258, 11.56431404029438, 16.167494860216785, 16.26825663378969, 3.2409845289623096, 27.805099679321565, 1.5768926057458161, 8.9656168647541, 30.53113298182867, 17.835091629985584, 1.5602435352824227, 16.42616369211103, -11.392410343307812, 20.515718987442604, 0.6558538796459275, 23.73745181219362, 29.663158001978243, 38.02103872455248, 19.44675422354853, 32.4559305251659, 22.246981796266226, 16.88273319801001, 25.9062329882586, 36.235479394391575, 39.26866712375133, 17.36966222737275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5035192407216182, "mean_inference_ms": 1.748414813714878, "mean_action_processing_ms": 0.21417461249963474, "mean_env_wait_ms": 0.13208988625305465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010933518409729004, "StateBufferConnector_ms": 0.0038532018661499023, "ViewRequirementAgentConnector_ms": 0.10908722877502441}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 464.5689531544025, "num_env_steps_trained_throughput_per_sec": 464.5689531544025, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 1112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1112000, "timers": {"training_iteration_time_ms": 9111.856, "restore_workers_time_ms": 0.019, "training_step_time_ms": 9111.552, "sample_time_ms": 1212.47, "learn_time_ms": 7871.997, "learn_throughput": 508.13, "synch_weights_time_ms": 25.97}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000}, "done": false, "training_iteration": 139, "trial_id": "1f352_00000", "date": "2024-08-11_15-16-53", "timestamp": 1723403813, "time_this_iter_s": 8.699437141418457, "time_total_s": 1323.5811319351196, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a5be50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1323.5811319351196, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 49.833333333333336, "ram_util_percent": 81.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.036452082420389, "cur_kl_coeff": 3.8116482626443526e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.138880587120851, "policy_loss": -0.0018329065627767705, "vf_loss": 1.1407134963820378, "vf_explained_var": 0.9769391225030025, "kl": 0.0018959960729621195, "entropy": 0.22458443945894638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 133920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.029469324958821, "cur_kl_coeff": 5.4931640625000015e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.14891698686406, "policy_loss": -0.006982421019832448, "vf_loss": 1.1558991705998778, "vf_explained_var": 0.9765969361489018, "kl": 0.004334623391229285, "entropy": 0.37272964098180333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 133920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.928568016810274, "predator_policy": -16.797742482471058}, "policy_reward_max": {"prey_policy": 16.797742482471058, "predator_policy": 55.928568016810274}, "policy_reward_mean": {"prey_policy": -19.044829552329954, "predator_policy": 19.044829552329954}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-44.11827640241711, 3.8176658049944745, -42.67413876094093, -32.793823291445364, -13.368856848417563, -14.351568338277099, -8.464044868649804, -23.891889328764908, -26.112785649042817, -51.967674196812524, -2.282591486716261, -22.523827975965364, -51.82104798645059, -29.444140722135167, -16.50011118762575, -30.897717671752627, -28.84674596097147, 16.797742482471058, -34.3940040027023, -15.91194086936732, -12.220580598055399, -15.243364100729174, 1.4069611390305905, -6.885083760329125, -1.1141439033072436, -17.456230392657336, -10.743222903401863, -7.302664583246105, -32.13649020039703, -34.30996549669464, -55.928568016810274, -19.24269444103189, -20.689748722812503, -9.6320651872998, -41.35469912578218, -31.353533213356076, 4.540442070353048, -9.149093634804208, -35.617696599419915, -8.388790864622734, -5.860129411620109, -27.312893751307303, 1.0077677803655787, -6.358088819542088, -3.62957746426785, -15.31686712549309, -8.132965534628756, -37.655811321811406, -24.24405737669433, -20.938764344455375, 8.332178854629674, -11.02091662370506, -25.614497643738794, -3.6667734648695145, -24.962435211527943, -0.6476166995222838, -24.400536003811258, -11.56431404029438, -16.167494860216785, -16.26825663378969, -3.2409845289623096, -27.805099679321565, -1.5768926057458161, -8.9656168647541, -30.53113298182867, -17.835091629985584, -1.5602435352824227, -16.42616369211103, 11.392410343307812, -20.515718987442604, -0.6558538796459275, -23.73745181219362, -29.663158001978243, -38.02103872455248, -19.44675422354853, -32.4559305251659, -22.246981796266226, -16.88273319801001, -25.9062329882586, -36.235479394391575, -39.26866712375133, -17.36966222737275, -31.327591151698734, -36.88354752168958, -22.85337076732747, -16.570692676070973, -47.226859659614426, -4.864878690181589, -7.361925958194217, -14.89381084282226, -6.835897033826981, -31.858694886440155, -19.545808358922567, 2.366752162684488, -31.434389185342837, 7.410600536429522, -27.066108817908944, -36.593918366536414, -39.342996468621756, -13.652279996985119], "policy_predator_policy_reward": [44.11827640241711, -3.8176658049944745, 42.67413876094093, 32.793823291445364, 13.368856848417563, 14.351568338277099, 8.464044868649804, 23.891889328764908, 26.112785649042817, 51.967674196812524, 2.282591486716261, 22.523827975965364, 51.82104798645059, 29.444140722135167, 16.50011118762575, 30.897717671752627, 28.84674596097147, -16.797742482471058, 34.3940040027023, 15.91194086936732, 12.220580598055399, 15.243364100729174, -1.4069611390305905, 6.885083760329125, 1.1141439033072436, 17.456230392657336, 10.743222903401863, 7.302664583246105, 32.13649020039703, 34.30996549669464, 55.928568016810274, 19.24269444103189, 20.689748722812503, 9.6320651872998, 41.35469912578218, 31.353533213356076, -4.540442070353048, 9.149093634804208, 35.617696599419915, 8.388790864622734, 5.860129411620109, 27.312893751307303, -1.0077677803655787, 6.358088819542088, 3.62957746426785, 15.31686712549309, 8.132965534628756, 37.655811321811406, 24.24405737669433, 20.938764344455375, -8.332178854629674, 11.02091662370506, 25.614497643738794, 3.6667734648695145, 24.962435211527943, 0.6476166995222838, 24.400536003811258, 11.56431404029438, 16.167494860216785, 16.26825663378969, 3.2409845289623096, 27.805099679321565, 1.5768926057458161, 8.9656168647541, 30.53113298182867, 17.835091629985584, 1.5602435352824227, 16.42616369211103, -11.392410343307812, 20.515718987442604, 0.6558538796459275, 23.73745181219362, 29.663158001978243, 38.02103872455248, 19.44675422354853, 32.4559305251659, 22.246981796266226, 16.88273319801001, 25.9062329882586, 36.235479394391575, 39.26866712375133, 17.36966222737275, 31.327591151698734, 36.88354752168958, 22.85337076732747, 16.570692676070973, 47.226859659614426, 4.864878690181589, 7.361925958194217, 14.89381084282226, 6.835897033826981, 31.858694886440155, 19.545808358922567, -2.366752162684488, 31.434389185342837, -7.410600536429522, 27.066108817908944, 36.593918366536414, 39.342996468621756, 13.652279996985119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5034389725520743, "mean_inference_ms": 1.748236765903731, "mean_action_processing_ms": 0.21414790843653925, "mean_env_wait_ms": 0.1320532129421969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01169276237487793, "StateBufferConnector_ms": 0.0034371614456176758, "ViewRequirementAgentConnector_ms": 0.11418461799621582}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 439.73928621406384, "num_env_steps_trained_throughput_per_sec": 439.73928621406384, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 9060.657, "restore_workers_time_ms": 0.02, "training_step_time_ms": 9060.352, "sample_time_ms": 1208.113, "learn_time_ms": 7826.551, "learn_throughput": 511.081, "synch_weights_time_ms": 24.584}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 140, "trial_id": "1f352_00000", "date": "2024-08-11_15-17-03", "timestamp": 1723403823, "time_this_iter_s": 9.143546104431152, "time_total_s": 1332.7246780395508, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cdf670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1332.7246780395508, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 54.12142857142857, "ram_util_percent": 82.22142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.658420508168638, "cur_kl_coeff": 1.9058241313221763e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0900104168181617, "policy_loss": -0.004350992029746218, "vf_loss": 2.0943614079927406, "vf_explained_var": 0.9516598594064514, "kl": 0.005485176771117147, "entropy": 0.2849711309031894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 134880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6275152238706747, "cur_kl_coeff": 2.7465820312500007e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0606466950227817, "policy_loss": -0.0049099588504759595, "vf_loss": 2.065556433796883, "vf_explained_var": 0.9525402309373021, "kl": 0.008012045593101988, "entropy": 0.3811414631083608, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 134880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.928568016810274, "predator_policy": -11.392410343307812}, "policy_reward_max": {"prey_policy": 11.392410343307812, "predator_policy": 55.928568016810274}, "policy_reward_mean": {"prey_policy": -18.225206191613076, "predator_policy": 18.225206191613076}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.885083760329125, -1.1141439033072436, -17.456230392657336, -10.743222903401863, -7.302664583246105, -32.13649020039703, -34.30996549669464, -55.928568016810274, -19.24269444103189, -20.689748722812503, -9.6320651872998, -41.35469912578218, -31.353533213356076, 4.540442070353048, -9.149093634804208, -35.617696599419915, -8.388790864622734, -5.860129411620109, -27.312893751307303, 1.0077677803655787, -6.358088819542088, -3.62957746426785, -15.31686712549309, -8.132965534628756, -37.655811321811406, -24.24405737669433, -20.938764344455375, 8.332178854629674, -11.02091662370506, -25.614497643738794, -3.6667734648695145, -24.962435211527943, -0.6476166995222838, -24.400536003811258, -11.56431404029438, -16.167494860216785, -16.26825663378969, -3.2409845289623096, -27.805099679321565, -1.5768926057458161, -8.9656168647541, -30.53113298182867, -17.835091629985584, -1.5602435352824227, -16.42616369211103, 11.392410343307812, -20.515718987442604, -0.6558538796459275, -23.73745181219362, -29.663158001978243, -38.02103872455248, -19.44675422354853, -32.4559305251659, -22.246981796266226, -16.88273319801001, -25.9062329882586, -36.235479394391575, -39.26866712375133, -17.36966222737275, -31.327591151698734, -36.88354752168958, -22.85337076732747, -16.570692676070973, -47.226859659614426, -4.864878690181589, -7.361925958194217, -14.89381084282226, -6.835897033826981, -31.858694886440155, -19.545808358922567, 2.366752162684488, -31.434389185342837, 7.410600536429522, -27.066108817908944, -36.593918366536414, -39.342996468621756, -13.652279996985119, -0.8313763158952128, -33.56108120945688, 7.025320377546036, -25.167952848304928, -25.06647073604528, -7.199886957448463, -29.057195206061877, -9.410732612274266, -3.8718808435142513, -23.13465466452307, -40.033320158541216, -11.907784208436693, -48.43640989940297, -4.5055078925419245, -20.719664845319123, -32.39852190658004, -19.66626188746963, -29.659541996899755, -1.9701006692263041, -1.655715243298698, -28.010684330600156, -13.376972625102795, -11.2280280696583], "policy_predator_policy_reward": [6.885083760329125, 1.1141439033072436, 17.456230392657336, 10.743222903401863, 7.302664583246105, 32.13649020039703, 34.30996549669464, 55.928568016810274, 19.24269444103189, 20.689748722812503, 9.6320651872998, 41.35469912578218, 31.353533213356076, -4.540442070353048, 9.149093634804208, 35.617696599419915, 8.388790864622734, 5.860129411620109, 27.312893751307303, -1.0077677803655787, 6.358088819542088, 3.62957746426785, 15.31686712549309, 8.132965534628756, 37.655811321811406, 24.24405737669433, 20.938764344455375, -8.332178854629674, 11.02091662370506, 25.614497643738794, 3.6667734648695145, 24.962435211527943, 0.6476166995222838, 24.400536003811258, 11.56431404029438, 16.167494860216785, 16.26825663378969, 3.2409845289623096, 27.805099679321565, 1.5768926057458161, 8.9656168647541, 30.53113298182867, 17.835091629985584, 1.5602435352824227, 16.42616369211103, -11.392410343307812, 20.515718987442604, 0.6558538796459275, 23.73745181219362, 29.663158001978243, 38.02103872455248, 19.44675422354853, 32.4559305251659, 22.246981796266226, 16.88273319801001, 25.9062329882586, 36.235479394391575, 39.26866712375133, 17.36966222737275, 31.327591151698734, 36.88354752168958, 22.85337076732747, 16.570692676070973, 47.226859659614426, 4.864878690181589, 7.361925958194217, 14.89381084282226, 6.835897033826981, 31.858694886440155, 19.545808358922567, -2.366752162684488, 31.434389185342837, -7.410600536429522, 27.066108817908944, 36.593918366536414, 39.342996468621756, 13.652279996985119, 0.8313763158952128, 33.56108120945688, -7.025320377546036, 25.167952848304928, 25.06647073604528, 7.199886957448463, 29.057195206061877, 9.410732612274266, 3.8718808435142513, 23.13465466452307, 40.033320158541216, 11.907784208436693, 48.43640989940297, 4.5055078925419245, 20.719664845319123, 32.39852190658004, 19.66626188746963, 29.659541996899755, 1.9701006692263041, 1.655715243298698, 28.010684330600156, 13.376972625102795, 11.2280280696583]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5037930907150368, "mean_inference_ms": 1.7474644860555804, "mean_action_processing_ms": 0.21405806213643555, "mean_env_wait_ms": 0.13191798822014167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010741710662841797, "StateBufferConnector_ms": 0.0034286975860595703, "ViewRequirementAgentConnector_ms": 0.11457014083862305}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 465.6832088710107, "num_env_steps_trained_throughput_per_sec": 465.6832088710107, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 1128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 8923.704, "restore_workers_time_ms": 0.02, "training_step_time_ms": 8923.405, "sample_time_ms": 1244.176, "learn_time_ms": 7655.421, "learn_throughput": 522.506, "synch_weights_time_ms": 22.658}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "training_iteration": 141, "trial_id": "1f352_00000", "date": "2024-08-11_15-17-11", "timestamp": 1723403831, "time_this_iter_s": 8.63336706161499, "time_total_s": 1341.3580451011658, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a7f160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1341.3580451011658, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 51.68333333333334, "ram_util_percent": 81.94166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4356770157193144, "cur_kl_coeff": 1.9058241313221763e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4417956028754513, "policy_loss": -0.0015365763717757849, "vf_loss": 1.4433321793253222, "vf_explained_var": 0.9706910494714975, "kl": 0.002390715498648297, "entropy": 0.20148615705935904, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 135840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.349533092044294, "cur_kl_coeff": 2.7465820312500007e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.407390414054195, "policy_loss": -0.0037066898881069695, "vf_loss": 1.4110969714820385, "vf_explained_var": 0.9706282346198957, "kl": 0.005200055420562788, "entropy": 0.34775826167315244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 135840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -48.43640989940297, "predator_policy": -11.392410343307812}, "policy_reward_max": {"prey_policy": 11.392410343307812, "predator_policy": 48.43640989940297}, "policy_reward_mean": {"prey_policy": -17.12694439915579, "predator_policy": 17.12694439915579}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-27.312893751307303, 1.0077677803655787, -6.358088819542088, -3.62957746426785, -15.31686712549309, -8.132965534628756, -37.655811321811406, -24.24405737669433, -20.938764344455375, 8.332178854629674, -11.02091662370506, -25.614497643738794, -3.6667734648695145, -24.962435211527943, -0.6476166995222838, -24.400536003811258, -11.56431404029438, -16.167494860216785, -16.26825663378969, -3.2409845289623096, -27.805099679321565, -1.5768926057458161, -8.9656168647541, -30.53113298182867, -17.835091629985584, -1.5602435352824227, -16.42616369211103, 11.392410343307812, -20.515718987442604, -0.6558538796459275, -23.73745181219362, -29.663158001978243, -38.02103872455248, -19.44675422354853, -32.4559305251659, -22.246981796266226, -16.88273319801001, -25.9062329882586, -36.235479394391575, -39.26866712375133, -17.36966222737275, -31.327591151698734, -36.88354752168958, -22.85337076732747, -16.570692676070973, -47.226859659614426, -4.864878690181589, -7.361925958194217, -14.89381084282226, -6.835897033826981, -31.858694886440155, -19.545808358922567, 2.366752162684488, -31.434389185342837, 7.410600536429522, -27.066108817908944, -36.593918366536414, -39.342996468621756, -13.652279996985119, -0.8313763158952128, -33.56108120945688, 7.025320377546036, -25.167952848304928, -25.06647073604528, -7.199886957448463, -29.057195206061877, -9.410732612274266, -3.8718808435142513, -23.13465466452307, -40.033320158541216, -11.907784208436693, -48.43640989940297, -4.5055078925419245, -20.719664845319123, -32.39852190658004, -19.66626188746963, -29.659541996899755, -1.9701006692263041, -1.655715243298698, -28.010684330600156, -13.376972625102795, -11.2280280696583, -6.034671612242825, 5.087495525106645, -2.7667722797631455, -22.258876750052366, -11.928136587768588, -22.99060006027826, -0.39525647087178406, 0.03161685259309266, -5.698813805338492, -28.4260643393945, -5.994039482902519, -10.052488109239041, -10.328461597775378, -5.611715977085476, -17.149775163831652, -24.752703937287173, -41.29861891999837, -22.2303164253812], "policy_predator_policy_reward": [27.312893751307303, -1.0077677803655787, 6.358088819542088, 3.62957746426785, 15.31686712549309, 8.132965534628756, 37.655811321811406, 24.24405737669433, 20.938764344455375, -8.332178854629674, 11.02091662370506, 25.614497643738794, 3.6667734648695145, 24.962435211527943, 0.6476166995222838, 24.400536003811258, 11.56431404029438, 16.167494860216785, 16.26825663378969, 3.2409845289623096, 27.805099679321565, 1.5768926057458161, 8.9656168647541, 30.53113298182867, 17.835091629985584, 1.5602435352824227, 16.42616369211103, -11.392410343307812, 20.515718987442604, 0.6558538796459275, 23.73745181219362, 29.663158001978243, 38.02103872455248, 19.44675422354853, 32.4559305251659, 22.246981796266226, 16.88273319801001, 25.9062329882586, 36.235479394391575, 39.26866712375133, 17.36966222737275, 31.327591151698734, 36.88354752168958, 22.85337076732747, 16.570692676070973, 47.226859659614426, 4.864878690181589, 7.361925958194217, 14.89381084282226, 6.835897033826981, 31.858694886440155, 19.545808358922567, -2.366752162684488, 31.434389185342837, -7.410600536429522, 27.066108817908944, 36.593918366536414, 39.342996468621756, 13.652279996985119, 0.8313763158952128, 33.56108120945688, -7.025320377546036, 25.167952848304928, 25.06647073604528, 7.199886957448463, 29.057195206061877, 9.410732612274266, 3.8718808435142513, 23.13465466452307, 40.033320158541216, 11.907784208436693, 48.43640989940297, 4.5055078925419245, 20.719664845319123, 32.39852190658004, 19.66626188746963, 29.659541996899755, 1.9701006692263041, 1.655715243298698, 28.010684330600156, 13.376972625102795, 11.2280280696583, 6.034671612242825, -5.087495525106645, 2.7667722797631455, 22.258876750052366, 11.928136587768588, 22.99060006027826, 0.39525647087178406, -0.03161685259309266, 5.698813805338492, 28.4260643393945, 5.994039482902519, 10.052488109239041, 10.328461597775378, 5.611715977085476, 17.149775163831652, 24.752703937287173, 41.29861891999837, 22.2303164253812]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.50319469107272, "mean_inference_ms": 1.7471602105362518, "mean_action_processing_ms": 0.21404196341228018, "mean_env_wait_ms": 0.13191707339783346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009221673011779785, "StateBufferConnector_ms": 0.0037037134170532227, "ViewRequirementAgentConnector_ms": 0.10994982719421387}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 449.7620248804709, "num_env_steps_trained_throughput_per_sec": 449.7620248804709, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 8940.67, "restore_workers_time_ms": 0.02, "training_step_time_ms": 8940.359, "sample_time_ms": 1288.775, "learn_time_ms": 7627.742, "learn_throughput": 524.402, "synch_weights_time_ms": 22.66}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 142, "trial_id": "1f352_00000", "date": "2024-08-11_15-17-20", "timestamp": 1723403840, "time_this_iter_s": 8.994653940200806, "time_total_s": 1350.3526990413666, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c36160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1350.3526990413666, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 49.792307692307695, "ram_util_percent": 81.97692307692309}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.20161620285362, "cur_kl_coeff": 9.529120656610881e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6610011649007599, "policy_loss": -0.004041457560864122, "vf_loss": 1.6650426285962263, "vf_explained_var": 0.9701266493027408, "kl": 0.003318862382027702, "entropy": 0.2249043015530333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 136800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.366807773336768, "cur_kl_coeff": 2.7465820312500007e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6730917983998854, "policy_loss": -0.0038295421334623827, "vf_loss": 1.6769212426617741, "vf_explained_var": 0.9704284044603507, "kl": 0.0035042810325050327, "entropy": 0.387584963037322, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 136800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.62224854517348, "predator_policy": -11.392410343307812}, "policy_reward_max": {"prey_policy": 11.392410343307812, "predator_policy": 54.62224854517348}, "policy_reward_mean": {"prey_policy": -19.099967124275267, "predator_policy": 19.099967124275267}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.9656168647541, -30.53113298182867, -17.835091629985584, -1.5602435352824227, -16.42616369211103, 11.392410343307812, -20.515718987442604, -0.6558538796459275, -23.73745181219362, -29.663158001978243, -38.02103872455248, -19.44675422354853, -32.4559305251659, -22.246981796266226, -16.88273319801001, -25.9062329882586, -36.235479394391575, -39.26866712375133, -17.36966222737275, -31.327591151698734, -36.88354752168958, -22.85337076732747, -16.570692676070973, -47.226859659614426, -4.864878690181589, -7.361925958194217, -14.89381084282226, -6.835897033826981, -31.858694886440155, -19.545808358922567, 2.366752162684488, -31.434389185342837, 7.410600536429522, -27.066108817908944, -36.593918366536414, -39.342996468621756, -13.652279996985119, -0.8313763158952128, -33.56108120945688, 7.025320377546036, -25.167952848304928, -25.06647073604528, -7.199886957448463, -29.057195206061877, -9.410732612274266, -3.8718808435142513, -23.13465466452307, -40.033320158541216, -11.907784208436693, -48.43640989940297, -4.5055078925419245, -20.719664845319123, -32.39852190658004, -19.66626188746963, -29.659541996899755, -1.9701006692263041, -1.655715243298698, -28.010684330600156, -13.376972625102795, -11.2280280696583, -6.034671612242825, 5.087495525106645, -2.7667722797631455, -22.258876750052366, -11.928136587768588, -22.99060006027826, -0.39525647087178406, 0.03161685259309266, -5.698813805338492, -28.4260643393945, -5.994039482902519, -10.052488109239041, -10.328461597775378, -5.611715977085476, -17.149775163831652, -24.752703937287173, -41.29861891999837, -22.2303164253812, -25.39035741095816, -0.38093212328495696, -23.531415127295475, -35.20074864707674, -31.998476389400757, -29.965707194710102, -25.172252118079882, -20.440976103797368, -33.3597299013289, -25.15914451701091, -16.660716499593978, -45.87850481570193, -6.327467243275798, -28.504180119227428, -7.116100608663842, -10.202490822122321, -8.48712469750904, -12.290217781617073, -33.497194130463015, -54.62224854517348, -3.9666609492658313, -20.334523865100827], "policy_predator_policy_reward": [8.9656168647541, 30.53113298182867, 17.835091629985584, 1.5602435352824227, 16.42616369211103, -11.392410343307812, 20.515718987442604, 0.6558538796459275, 23.73745181219362, 29.663158001978243, 38.02103872455248, 19.44675422354853, 32.4559305251659, 22.246981796266226, 16.88273319801001, 25.9062329882586, 36.235479394391575, 39.26866712375133, 17.36966222737275, 31.327591151698734, 36.88354752168958, 22.85337076732747, 16.570692676070973, 47.226859659614426, 4.864878690181589, 7.361925958194217, 14.89381084282226, 6.835897033826981, 31.858694886440155, 19.545808358922567, -2.366752162684488, 31.434389185342837, -7.410600536429522, 27.066108817908944, 36.593918366536414, 39.342996468621756, 13.652279996985119, 0.8313763158952128, 33.56108120945688, -7.025320377546036, 25.167952848304928, 25.06647073604528, 7.199886957448463, 29.057195206061877, 9.410732612274266, 3.8718808435142513, 23.13465466452307, 40.033320158541216, 11.907784208436693, 48.43640989940297, 4.5055078925419245, 20.719664845319123, 32.39852190658004, 19.66626188746963, 29.659541996899755, 1.9701006692263041, 1.655715243298698, 28.010684330600156, 13.376972625102795, 11.2280280696583, 6.034671612242825, -5.087495525106645, 2.7667722797631455, 22.258876750052366, 11.928136587768588, 22.99060006027826, 0.39525647087178406, -0.03161685259309266, 5.698813805338492, 28.4260643393945, 5.994039482902519, 10.052488109239041, 10.328461597775378, 5.611715977085476, 17.149775163831652, 24.752703937287173, 41.29861891999837, 22.2303164253812, 25.39035741095816, 0.38093212328495696, 23.531415127295475, 35.20074864707674, 31.998476389400757, 29.965707194710102, 25.172252118079882, 20.440976103797368, 33.3597299013289, 25.15914451701091, 16.660716499593978, 45.87850481570193, 6.327467243275798, 28.504180119227428, 7.116100608663842, 10.202490822122321, 8.48712469750904, 12.290217781617073, 33.497194130463015, 54.62224854517348, 3.9666609492658313, 20.334523865100827]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5028533381745395, "mean_inference_ms": 1.7456065698390921, "mean_action_processing_ms": 0.21386038127829984, "mean_env_wait_ms": 0.13179443290176848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008669853210449219, "StateBufferConnector_ms": 0.003935456275939941, "ViewRequirementAgentConnector_ms": 0.07910680770874023}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 433.07737173406963, "num_env_steps_trained_throughput_per_sec": 433.07737173406963, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 1144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1144000, "timers": {"training_iteration_time_ms": 9032.855, "restore_workers_time_ms": 0.02, "training_step_time_ms": 9032.54, "sample_time_ms": 1259.027, "learn_time_ms": 7748.533, "learn_throughput": 516.227, "synch_weights_time_ms": 23.794}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000}, "done": false, "training_iteration": 143, "trial_id": "1f352_00000", "date": "2024-08-11_15-17-30", "timestamp": 1723403850, "time_this_iter_s": 9.28679609298706, "time_total_s": 1359.6394951343536, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c36b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1359.6394951343536, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 54.384615384615394, "ram_util_percent": 82.26923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.148895505319039, "cur_kl_coeff": 4.7645603283054407e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2287914250046015, "policy_loss": -0.001963851315182789, "vf_loss": 1.2307552746186654, "vf_explained_var": 0.9754608239978552, "kl": 0.002538450258909852, "entropy": 0.20226664571091532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 137760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.099072982184589, "cur_kl_coeff": 1.3732910156250004e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2347068970402082, "policy_loss": -0.004448504759542023, "vf_loss": 1.2391553337996204, "vf_explained_var": 0.975210933573544, "kl": 0.00446062706825467, "entropy": 0.34745918260887265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 137760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.62224854517348, "predator_policy": -10.961283916147615}, "policy_reward_max": {"prey_policy": 10.961283916147615, "predator_policy": 54.62224854517348}, "policy_reward_mean": {"prey_policy": -17.430929934387816, "predator_policy": 17.430929934387816}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.36966222737275, -31.327591151698734, -36.88354752168958, -22.85337076732747, -16.570692676070973, -47.226859659614426, -4.864878690181589, -7.361925958194217, -14.89381084282226, -6.835897033826981, -31.858694886440155, -19.545808358922567, 2.366752162684488, -31.434389185342837, 7.410600536429522, -27.066108817908944, -36.593918366536414, -39.342996468621756, -13.652279996985119, -0.8313763158952128, -33.56108120945688, 7.025320377546036, -25.167952848304928, -25.06647073604528, -7.199886957448463, -29.057195206061877, -9.410732612274266, -3.8718808435142513, -23.13465466452307, -40.033320158541216, -11.907784208436693, -48.43640989940297, -4.5055078925419245, -20.719664845319123, -32.39852190658004, -19.66626188746963, -29.659541996899755, -1.9701006692263041, -1.655715243298698, -28.010684330600156, -13.376972625102795, -11.2280280696583, -6.034671612242825, 5.087495525106645, -2.7667722797631455, -22.258876750052366, -11.928136587768588, -22.99060006027826, -0.39525647087178406, 0.03161685259309266, -5.698813805338492, -28.4260643393945, -5.994039482902519, -10.052488109239041, -10.328461597775378, -5.611715977085476, -17.149775163831652, -24.752703937287173, -41.29861891999837, -22.2303164253812, -25.39035741095816, -0.38093212328495696, -23.531415127295475, -35.20074864707674, -31.998476389400757, -29.965707194710102, -25.172252118079882, -20.440976103797368, -33.3597299013289, -25.15914451701091, -16.660716499593978, -45.87850481570193, -6.327467243275798, -28.504180119227428, -7.116100608663842, -10.202490822122321, -8.48712469750904, -12.290217781617073, -33.497194130463015, -54.62224854517348, -3.9666609492658313, -20.334523865100827, -4.65733313349564, -22.29563129301684, -5.925357745628253, -16.437224926030318, 3.3523021029193654, 3.009007638464583, -38.85997230893279, -30.264612613408705, 6.532845525305213, -36.970083656418936, -0.8250209921536591, 10.961283916147615, -18.05064457626587, 1.984176389631621, -0.8538408905306447, -13.16240123015445, -9.13525859216227, -30.460353641383918], "policy_predator_policy_reward": [17.36966222737275, 31.327591151698734, 36.88354752168958, 22.85337076732747, 16.570692676070973, 47.226859659614426, 4.864878690181589, 7.361925958194217, 14.89381084282226, 6.835897033826981, 31.858694886440155, 19.545808358922567, -2.366752162684488, 31.434389185342837, -7.410600536429522, 27.066108817908944, 36.593918366536414, 39.342996468621756, 13.652279996985119, 0.8313763158952128, 33.56108120945688, -7.025320377546036, 25.167952848304928, 25.06647073604528, 7.199886957448463, 29.057195206061877, 9.410732612274266, 3.8718808435142513, 23.13465466452307, 40.033320158541216, 11.907784208436693, 48.43640989940297, 4.5055078925419245, 20.719664845319123, 32.39852190658004, 19.66626188746963, 29.659541996899755, 1.9701006692263041, 1.655715243298698, 28.010684330600156, 13.376972625102795, 11.2280280696583, 6.034671612242825, -5.087495525106645, 2.7667722797631455, 22.258876750052366, 11.928136587768588, 22.99060006027826, 0.39525647087178406, -0.03161685259309266, 5.698813805338492, 28.4260643393945, 5.994039482902519, 10.052488109239041, 10.328461597775378, 5.611715977085476, 17.149775163831652, 24.752703937287173, 41.29861891999837, 22.2303164253812, 25.39035741095816, 0.38093212328495696, 23.531415127295475, 35.20074864707674, 31.998476389400757, 29.965707194710102, 25.172252118079882, 20.440976103797368, 33.3597299013289, 25.15914451701091, 16.660716499593978, 45.87850481570193, 6.327467243275798, 28.504180119227428, 7.116100608663842, 10.202490822122321, 8.48712469750904, 12.290217781617073, 33.497194130463015, 54.62224854517348, 3.9666609492658313, 20.334523865100827, 4.65733313349564, 22.29563129301684, 5.925357745628253, 16.437224926030318, -3.3523021029193654, -3.009007638464583, 38.85997230893279, 30.264612613408705, -6.532845525305213, 36.970083656418936, 0.8250209921536591, -10.961283916147615, 18.05064457626587, -1.984176389631621, 0.8538408905306447, 13.16240123015445, 9.13525859216227, 30.460353641383918]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5026110559399639, "mean_inference_ms": 1.7448762988736244, "mean_action_processing_ms": 0.21380459547794836, "mean_env_wait_ms": 0.13173848029130836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008534908294677734, "StateBufferConnector_ms": 0.004006862640380859, "ViewRequirementAgentConnector_ms": 0.08442771434783936}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 433.3207680451679, "num_env_steps_trained_throughput_per_sec": 433.3207680451679, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 9004.166, "restore_workers_time_ms": 0.021, "training_step_time_ms": 9003.827, "sample_time_ms": 1252.77, "learn_time_ms": 7725.984, "learn_throughput": 517.733, "synch_weights_time_ms": 23.864}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 144, "trial_id": "1f352_00000", "date": "2024-08-11_15-17-39", "timestamp": 1723403859, "time_this_iter_s": 9.271318912506104, "time_total_s": 1368.9108140468597, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c3aca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1368.9108140468597, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 54.71538461538462, "ram_util_percent": 82.26923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1547932288299005, "cur_kl_coeff": 2.3822801641527204e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.352524904968838, "policy_loss": -0.0022054949125352627, "vf_loss": 1.3547304057516159, "vf_explained_var": 0.9723543743913372, "kl": 0.003285672887904201, "entropy": 0.21417908670846372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 138720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1553541559726, "cur_kl_coeff": 6.866455078125002e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3247295193374158, "policy_loss": -0.004054222801642027, "vf_loss": 1.3287837382405996, "vf_explained_var": 0.9726188046236833, "kl": 0.005289223015066882, "entropy": 0.3402033291136225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 138720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.62224854517348, "predator_policy": -10.961283916147615}, "policy_reward_max": {"prey_policy": 10.961283916147615, "predator_policy": 54.62224854517348}, "policy_reward_mean": {"prey_policy": -17.18142367100121, "predator_policy": 17.18142367100121}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.652279996985119, -0.8313763158952128, -33.56108120945688, 7.025320377546036, -25.167952848304928, -25.06647073604528, -7.199886957448463, -29.057195206061877, -9.410732612274266, -3.8718808435142513, -23.13465466452307, -40.033320158541216, -11.907784208436693, -48.43640989940297, -4.5055078925419245, -20.719664845319123, -32.39852190658004, -19.66626188746963, -29.659541996899755, -1.9701006692263041, -1.655715243298698, -28.010684330600156, -13.376972625102795, -11.2280280696583, -6.034671612242825, 5.087495525106645, -2.7667722797631455, -22.258876750052366, -11.928136587768588, -22.99060006027826, -0.39525647087178406, 0.03161685259309266, -5.698813805338492, -28.4260643393945, -5.994039482902519, -10.052488109239041, -10.328461597775378, -5.611715977085476, -17.149775163831652, -24.752703937287173, -41.29861891999837, -22.2303164253812, -25.39035741095816, -0.38093212328495696, -23.531415127295475, -35.20074864707674, -31.998476389400757, -29.965707194710102, -25.172252118079882, -20.440976103797368, -33.3597299013289, -25.15914451701091, -16.660716499593978, -45.87850481570193, -6.327467243275798, -28.504180119227428, -7.116100608663842, -10.202490822122321, -8.48712469750904, -12.290217781617073, -33.497194130463015, -54.62224854517348, -3.9666609492658313, -20.334523865100827, -4.65733313349564, -22.29563129301684, -5.925357745628253, -16.437224926030318, 3.3523021029193654, 3.009007638464583, -38.85997230893279, -30.264612613408705, 6.532845525305213, -36.970083656418936, -0.8250209921536591, 10.961283916147615, -18.05064457626587, 1.984176389631621, -0.8538408905306447, -13.16240123015445, -9.13525859216227, -30.460353641383918, -17.663069069026005, -30.379056223942925, -21.861502295634956, -22.83182024095924, -15.64561060287614, -43.60342247429825, -15.111872130197863, -14.891975523262973, -15.343445644761161, -18.944533250517978, -24.512167514327324, -23.434591037483482, -11.508999381334498, -10.828630939125645, -18.66816995147771, -44.552624898554356, -13.073209607715961, 5.552527210699052], "policy_predator_policy_reward": [13.652279996985119, 0.8313763158952128, 33.56108120945688, -7.025320377546036, 25.167952848304928, 25.06647073604528, 7.199886957448463, 29.057195206061877, 9.410732612274266, 3.8718808435142513, 23.13465466452307, 40.033320158541216, 11.907784208436693, 48.43640989940297, 4.5055078925419245, 20.719664845319123, 32.39852190658004, 19.66626188746963, 29.659541996899755, 1.9701006692263041, 1.655715243298698, 28.010684330600156, 13.376972625102795, 11.2280280696583, 6.034671612242825, -5.087495525106645, 2.7667722797631455, 22.258876750052366, 11.928136587768588, 22.99060006027826, 0.39525647087178406, -0.03161685259309266, 5.698813805338492, 28.4260643393945, 5.994039482902519, 10.052488109239041, 10.328461597775378, 5.611715977085476, 17.149775163831652, 24.752703937287173, 41.29861891999837, 22.2303164253812, 25.39035741095816, 0.38093212328495696, 23.531415127295475, 35.20074864707674, 31.998476389400757, 29.965707194710102, 25.172252118079882, 20.440976103797368, 33.3597299013289, 25.15914451701091, 16.660716499593978, 45.87850481570193, 6.327467243275798, 28.504180119227428, 7.116100608663842, 10.202490822122321, 8.48712469750904, 12.290217781617073, 33.497194130463015, 54.62224854517348, 3.9666609492658313, 20.334523865100827, 4.65733313349564, 22.29563129301684, 5.925357745628253, 16.437224926030318, -3.3523021029193654, -3.009007638464583, 38.85997230893279, 30.264612613408705, -6.532845525305213, 36.970083656418936, 0.8250209921536591, -10.961283916147615, 18.05064457626587, -1.984176389631621, 0.8538408905306447, 13.16240123015445, 9.13525859216227, 30.460353641383918, 17.663069069026005, 30.379056223942925, 21.861502295634956, 22.83182024095924, 15.64561060287614, 43.60342247429825, 15.111872130197863, 14.891975523262973, 15.343445644761161, 18.944533250517978, 24.512167514327324, 23.434591037483482, 11.508999381334498, 10.828630939125645, 18.66816995147771, 44.552624898554356, 13.073209607715961, -5.552527210699052]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5022411093344528, "mean_inference_ms": 1.743675958405876, "mean_action_processing_ms": 0.21371434737218578, "mean_env_wait_ms": 0.1316518973877308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00451052188873291, "StateBufferConnector_ms": 0.005525708198547363, "ViewRequirementAgentConnector_ms": 0.07744240760803223}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.06329334589793, "num_env_steps_trained_throughput_per_sec": 356.06329334589793, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 1160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1160000, "timers": {"training_iteration_time_ms": 9234.392, "restore_workers_time_ms": 0.021, "training_step_time_ms": 9234.11, "sample_time_ms": 1246.112, "learn_time_ms": 7962.654, "learn_throughput": 502.345, "synch_weights_time_ms": 24.17}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "done": false, "training_iteration": 145, "trial_id": "1f352_00000", "date": "2024-08-11_15-17-50", "timestamp": 1723403870, "time_this_iter_s": 11.302752017974854, "time_total_s": 1380.2135660648346, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c3ad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1380.2135660648346, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 65.4375, "ram_util_percent": 82.73125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8141483484456935, "cur_kl_coeff": 1.1911400820763602e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3522251752515635, "policy_loss": -0.003352218444827789, "vf_loss": 1.3555773970360556, "vf_explained_var": 0.9670120344186822, "kl": 0.004733239887610837, "entropy": 0.23382741717311242, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 139680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7910377574463685, "cur_kl_coeff": 6.866455078125002e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.348033146498104, "policy_loss": -0.0026142643231044835, "vf_loss": 1.3506474055970707, "vf_explained_var": 0.9672476030265291, "kl": 0.005051905583828592, "entropy": 0.3500961704179645, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 139680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.62224854517348, "predator_policy": -10.961283916147615}, "policy_reward_max": {"prey_policy": 10.961283916147615, "predator_policy": 54.62224854517348}, "policy_reward_mean": {"prey_policy": -16.9091735566523, "predator_policy": 16.9091735566523}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.2280280696583, -6.034671612242825, 5.087495525106645, -2.7667722797631455, -22.258876750052366, -11.928136587768588, -22.99060006027826, -0.39525647087178406, 0.03161685259309266, -5.698813805338492, -28.4260643393945, -5.994039482902519, -10.052488109239041, -10.328461597775378, -5.611715977085476, -17.149775163831652, -24.752703937287173, -41.29861891999837, -22.2303164253812, -25.39035741095816, -0.38093212328495696, -23.531415127295475, -35.20074864707674, -31.998476389400757, -29.965707194710102, -25.172252118079882, -20.440976103797368, -33.3597299013289, -25.15914451701091, -16.660716499593978, -45.87850481570193, -6.327467243275798, -28.504180119227428, -7.116100608663842, -10.202490822122321, -8.48712469750904, -12.290217781617073, -33.497194130463015, -54.62224854517348, -3.9666609492658313, -20.334523865100827, -4.65733313349564, -22.29563129301684, -5.925357745628253, -16.437224926030318, 3.3523021029193654, 3.009007638464583, -38.85997230893279, -30.264612613408705, 6.532845525305213, -36.970083656418936, -0.8250209921536591, 10.961283916147615, -18.05064457626587, 1.984176389631621, -0.8538408905306447, -13.16240123015445, -9.13525859216227, -30.460353641383918, -17.663069069026005, -30.379056223942925, -21.861502295634956, -22.83182024095924, -15.64561060287614, -43.60342247429825, -15.111872130197863, -14.891975523262973, -15.343445644761161, -18.944533250517978, -24.512167514327324, -23.434591037483482, -11.508999381334498, -10.828630939125645, -18.66816995147771, -44.552624898554356, -13.073209607715961, 5.552527210699052, -27.65735693873318, -33.990212594286504, -11.635953573829124, 7.313822569098489, 5.352347157140191, -23.21290236738772, -20.86328175983654, -17.098050416262097, 2.916946290731053, -10.406136608310245, -31.92700537471517, -24.18761610764291, -19.81896533762828, -2.178657950325274, -19.479904216136653, -14.526477795470523, -14.422596215221727, -1.5155237586419164, -45.00215346534992, -33.93401553395906, -34.47021584069725, 1.956425238169805, -20.256180642196725], "policy_predator_policy_reward": [11.2280280696583, 6.034671612242825, -5.087495525106645, 2.7667722797631455, 22.258876750052366, 11.928136587768588, 22.99060006027826, 0.39525647087178406, -0.03161685259309266, 5.698813805338492, 28.4260643393945, 5.994039482902519, 10.052488109239041, 10.328461597775378, 5.611715977085476, 17.149775163831652, 24.752703937287173, 41.29861891999837, 22.2303164253812, 25.39035741095816, 0.38093212328495696, 23.531415127295475, 35.20074864707674, 31.998476389400757, 29.965707194710102, 25.172252118079882, 20.440976103797368, 33.3597299013289, 25.15914451701091, 16.660716499593978, 45.87850481570193, 6.327467243275798, 28.504180119227428, 7.116100608663842, 10.202490822122321, 8.48712469750904, 12.290217781617073, 33.497194130463015, 54.62224854517348, 3.9666609492658313, 20.334523865100827, 4.65733313349564, 22.29563129301684, 5.925357745628253, 16.437224926030318, -3.3523021029193654, -3.009007638464583, 38.85997230893279, 30.264612613408705, -6.532845525305213, 36.970083656418936, 0.8250209921536591, -10.961283916147615, 18.05064457626587, -1.984176389631621, 0.8538408905306447, 13.16240123015445, 9.13525859216227, 30.460353641383918, 17.663069069026005, 30.379056223942925, 21.861502295634956, 22.83182024095924, 15.64561060287614, 43.60342247429825, 15.111872130197863, 14.891975523262973, 15.343445644761161, 18.944533250517978, 24.512167514327324, 23.434591037483482, 11.508999381334498, 10.828630939125645, 18.66816995147771, 44.552624898554356, 13.073209607715961, -5.552527210699052, 27.65735693873318, 33.990212594286504, 11.635953573829124, -7.313822569098489, -5.352347157140191, 23.21290236738772, 20.86328175983654, 17.098050416262097, -2.916946290731053, 10.406136608310245, 31.92700537471517, 24.18761610764291, 19.81896533762828, 2.178657950325274, 19.479904216136653, 14.526477795470523, 14.422596215221727, 1.5155237586419164, 45.00215346534992, 33.93401553395906, 34.47021584069725, -1.956425238169805, 20.256180642196725]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5018575821416549, "mean_inference_ms": 1.742144918710516, "mean_action_processing_ms": 0.21369734466267304, "mean_env_wait_ms": 0.1315569974677283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004483699798583984, "StateBufferConnector_ms": 0.005417823791503906, "ViewRequirementAgentConnector_ms": 0.07570624351501465}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.78380670693167, "num_env_steps_trained_throughput_per_sec": 406.78380670693167, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 9272.178, "restore_workers_time_ms": 0.021, "training_step_time_ms": 9271.846, "sample_time_ms": 1245.353, "learn_time_ms": 7997.205, "learn_throughput": 500.175, "synch_weights_time_ms": 27.965}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 146, "trial_id": "1f352_00000", "date": "2024-08-11_15-18-00", "timestamp": 1723403880, "time_this_iter_s": 9.898746967315674, "time_total_s": 1390.1123130321503, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1aba550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1390.1123130321503, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 61.5142857142857, "ram_util_percent": 82.98571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2936459733794132, "cur_kl_coeff": 5.955700410381801e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6543199233710766, "policy_loss": -0.001693664598375714, "vf_loss": 1.6560135897248984, "vf_explained_var": 0.9639044874658187, "kl": 0.0047041136098581755, "entropy": 0.23654248857249816, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 140640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.271951910853386, "cur_kl_coeff": 6.866455078125002e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6676236731931566, "policy_loss": -0.0061247670033480976, "vf_loss": 1.6737484381223717, "vf_explained_var": 0.9628120688100655, "kl": 0.004047914636274423, "entropy": 0.33831358859315513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 140640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.62224854517348, "predator_policy": -10.961283916147615}, "policy_reward_max": {"prey_policy": 10.961283916147615, "predator_policy": 54.62224854517348}, "policy_reward_mean": {"prey_policy": -18.08241886657571, "predator_policy": 18.08241886657571}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-35.20074864707674, -31.998476389400757, -29.965707194710102, -25.172252118079882, -20.440976103797368, -33.3597299013289, -25.15914451701091, -16.660716499593978, -45.87850481570193, -6.327467243275798, -28.504180119227428, -7.116100608663842, -10.202490822122321, -8.48712469750904, -12.290217781617073, -33.497194130463015, -54.62224854517348, -3.9666609492658313, -20.334523865100827, -4.65733313349564, -22.29563129301684, -5.925357745628253, -16.437224926030318, 3.3523021029193654, 3.009007638464583, -38.85997230893279, -30.264612613408705, 6.532845525305213, -36.970083656418936, -0.8250209921536591, 10.961283916147615, -18.05064457626587, 1.984176389631621, -0.8538408905306447, -13.16240123015445, -9.13525859216227, -30.460353641383918, -17.663069069026005, -30.379056223942925, -21.861502295634956, -22.83182024095924, -15.64561060287614, -43.60342247429825, -15.111872130197863, -14.891975523262973, -15.343445644761161, -18.944533250517978, -24.512167514327324, -23.434591037483482, -11.508999381334498, -10.828630939125645, -18.66816995147771, -44.552624898554356, -13.073209607715961, 5.552527210699052, -27.65735693873318, -33.990212594286504, -11.635953573829124, 7.313822569098489, 5.352347157140191, -23.21290236738772, -20.86328175983654, -17.098050416262097, 2.916946290731053, -10.406136608310245, -31.92700537471517, -24.18761610764291, -19.81896533762828, -2.178657950325274, -19.479904216136653, -14.526477795470523, -14.422596215221727, -1.5155237586419164, -45.00215346534992, -33.93401553395906, -34.47021584069725, 1.956425238169805, -20.256180642196725, -21.558782605847483, -28.71422301824888, -12.434651025514857, -3.8540459918807626, -24.264993392124534, -3.8487426484764873, -2.637827702760003, -39.571668583903275, -10.282120739758724, -4.863706936121483, -23.40120793064706, -3.986496222770233, -2.176376285729356, -10.48471605324523, -21.829526915832947, 2.951241799503517, -32.63414256857371, -29.616335780445016, -39.18714107907431, -38.245051708874584, -15.521784896864151, -44.49116257785993], "policy_predator_policy_reward": [35.20074864707674, 31.998476389400757, 29.965707194710102, 25.172252118079882, 20.440976103797368, 33.3597299013289, 25.15914451701091, 16.660716499593978, 45.87850481570193, 6.327467243275798, 28.504180119227428, 7.116100608663842, 10.202490822122321, 8.48712469750904, 12.290217781617073, 33.497194130463015, 54.62224854517348, 3.9666609492658313, 20.334523865100827, 4.65733313349564, 22.29563129301684, 5.925357745628253, 16.437224926030318, -3.3523021029193654, -3.009007638464583, 38.85997230893279, 30.264612613408705, -6.532845525305213, 36.970083656418936, 0.8250209921536591, -10.961283916147615, 18.05064457626587, -1.984176389631621, 0.8538408905306447, 13.16240123015445, 9.13525859216227, 30.460353641383918, 17.663069069026005, 30.379056223942925, 21.861502295634956, 22.83182024095924, 15.64561060287614, 43.60342247429825, 15.111872130197863, 14.891975523262973, 15.343445644761161, 18.944533250517978, 24.512167514327324, 23.434591037483482, 11.508999381334498, 10.828630939125645, 18.66816995147771, 44.552624898554356, 13.073209607715961, -5.552527210699052, 27.65735693873318, 33.990212594286504, 11.635953573829124, -7.313822569098489, -5.352347157140191, 23.21290236738772, 20.86328175983654, 17.098050416262097, -2.916946290731053, 10.406136608310245, 31.92700537471517, 24.18761610764291, 19.81896533762828, 2.178657950325274, 19.479904216136653, 14.526477795470523, 14.422596215221727, 1.5155237586419164, 45.00215346534992, 33.93401553395906, 34.47021584069725, -1.956425238169805, 20.256180642196725, 21.558782605847483, 28.71422301824888, 12.434651025514857, 3.8540459918807626, 24.264993392124534, 3.8487426484764873, 2.637827702760003, 39.571668583903275, 10.282120739758724, 4.863706936121483, 23.40120793064706, 3.986496222770233, 2.176376285729356, 10.48471605324523, 21.829526915832947, -2.951241799503517, 32.63414256857371, 29.616335780445016, 39.18714107907431, 38.245051708874584, 15.521784896864151, 44.49116257785993]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5040615980827483, "mean_inference_ms": 1.749353364593545, "mean_action_processing_ms": 0.21500253165758842, "mean_env_wait_ms": 0.1320866953511847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042504072189331055, "StateBufferConnector_ms": 0.004325509071350098, "ViewRequirementAgentConnector_ms": 0.09358584880828857}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 389.99141992729847, "num_env_steps_trained_throughput_per_sec": 389.99141992729847, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 1176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 9409.531, "restore_workers_time_ms": 0.022, "training_step_time_ms": 9409.196, "sample_time_ms": 1211.737, "learn_time_ms": 8168.061, "learn_throughput": 489.712, "synch_weights_time_ms": 28.106}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "training_iteration": 147, "trial_id": "1f352_00000", "date": "2024-08-11_15-18-11", "timestamp": 1723403891, "time_this_iter_s": 10.305813074111938, "time_total_s": 1400.4181261062622, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cdf3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1400.4181261062622, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 60.24666666666667, "ram_util_percent": 83.32666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1834459436436493, "cur_kl_coeff": 2.9778502051909004e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4567397318780422, "policy_loss": -0.0020471712399739773, "vf_loss": 1.4587868990376591, "vf_explained_var": 0.9612168503925205, "kl": 0.003778157441637849, "entropy": 0.22302982290275394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 141600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0976375667999188, "cur_kl_coeff": 3.433227539062501e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5065036503287652, "policy_loss": -0.0030173338018357754, "vf_loss": 1.5095209782322248, "vf_explained_var": 0.9591951221227646, "kl": 0.0038820526937933058, "entropy": 0.344368808157742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 141600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -45.295036182849735, "predator_policy": -10.961283916147615}, "policy_reward_max": {"prey_policy": 10.961283916147615, "predator_policy": 45.295036182849735}, "policy_reward_mean": {"prey_policy": -16.5186842394806, "predator_policy": 16.5186842394806}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.334523865100827, -4.65733313349564, -22.29563129301684, -5.925357745628253, -16.437224926030318, 3.3523021029193654, 3.009007638464583, -38.85997230893279, -30.264612613408705, 6.532845525305213, -36.970083656418936, -0.8250209921536591, 10.961283916147615, -18.05064457626587, 1.984176389631621, -0.8538408905306447, -13.16240123015445, -9.13525859216227, -30.460353641383918, -17.663069069026005, -30.379056223942925, -21.861502295634956, -22.83182024095924, -15.64561060287614, -43.60342247429825, -15.111872130197863, -14.891975523262973, -15.343445644761161, -18.944533250517978, -24.512167514327324, -23.434591037483482, -11.508999381334498, -10.828630939125645, -18.66816995147771, -44.552624898554356, -13.073209607715961, 5.552527210699052, -27.65735693873318, -33.990212594286504, -11.635953573829124, 7.313822569098489, 5.352347157140191, -23.21290236738772, -20.86328175983654, -17.098050416262097, 2.916946290731053, -10.406136608310245, -31.92700537471517, -24.18761610764291, -19.81896533762828, -2.178657950325274, -19.479904216136653, -14.526477795470523, -14.422596215221727, -1.5155237586419164, -45.00215346534992, -33.93401553395906, -34.47021584069725, 1.956425238169805, -20.256180642196725, -21.558782605847483, -28.71422301824888, -12.434651025514857, -3.8540459918807626, -24.264993392124534, -3.8487426484764873, -2.637827702760003, -39.571668583903275, -10.282120739758724, -4.863706936121483, -23.40120793064706, -3.986496222770233, -2.176376285729356, -10.48471605324523, -21.829526915832947, 2.951241799503517, -32.63414256857371, -29.616335780445016, -39.18714107907431, -38.245051708874584, -15.521784896864151, -44.49116257785993, -18.749780861721813, -35.352137502320595, -7.593347503159915, -29.850339919632802, -4.822148931029332, -3.644707583884104, -4.306340776443154, -5.777157126480244, -16.7757489290945, -8.31388603569532, -14.648060042445199, -22.98464062660346, 0.4469879906090437, 8.351098975338948, -7.588707778947949, -45.295036182849735, -23.485631928255728, -32.08689361189094], "policy_predator_policy_reward": [20.334523865100827, 4.65733313349564, 22.29563129301684, 5.925357745628253, 16.437224926030318, -3.3523021029193654, -3.009007638464583, 38.85997230893279, 30.264612613408705, -6.532845525305213, 36.970083656418936, 0.8250209921536591, -10.961283916147615, 18.05064457626587, -1.984176389631621, 0.8538408905306447, 13.16240123015445, 9.13525859216227, 30.460353641383918, 17.663069069026005, 30.379056223942925, 21.861502295634956, 22.83182024095924, 15.64561060287614, 43.60342247429825, 15.111872130197863, 14.891975523262973, 15.343445644761161, 18.944533250517978, 24.512167514327324, 23.434591037483482, 11.508999381334498, 10.828630939125645, 18.66816995147771, 44.552624898554356, 13.073209607715961, -5.552527210699052, 27.65735693873318, 33.990212594286504, 11.635953573829124, -7.313822569098489, -5.352347157140191, 23.21290236738772, 20.86328175983654, 17.098050416262097, -2.916946290731053, 10.406136608310245, 31.92700537471517, 24.18761610764291, 19.81896533762828, 2.178657950325274, 19.479904216136653, 14.526477795470523, 14.422596215221727, 1.5155237586419164, 45.00215346534992, 33.93401553395906, 34.47021584069725, -1.956425238169805, 20.256180642196725, 21.558782605847483, 28.71422301824888, 12.434651025514857, 3.8540459918807626, 24.264993392124534, 3.8487426484764873, 2.637827702760003, 39.571668583903275, 10.282120739758724, 4.863706936121483, 23.40120793064706, 3.986496222770233, 2.176376285729356, 10.48471605324523, 21.829526915832947, -2.951241799503517, 32.63414256857371, 29.616335780445016, 39.18714107907431, 38.245051708874584, 15.521784896864151, 44.49116257785993, 18.749780861721813, 35.352137502320595, 7.593347503159915, 29.850339919632802, 4.822148931029332, 3.644707583884104, 4.306340776443154, 5.777157126480244, 16.7757489290945, 8.31388603569532, 14.648060042445199, 22.98464062660346, -0.4469879906090437, -8.351098975338948, 7.588707778947949, 45.295036182849735, 23.485631928255728, 32.08689361189094]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5011549078337844, "mean_inference_ms": 1.7395349545668535, "mean_action_processing_ms": 0.2137035565100198, "mean_env_wait_ms": 0.13142601837733425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035094022750854492, "StateBufferConnector_ms": 0.004180908203125, "ViewRequirementAgentConnector_ms": 0.08769047260284424}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 389.3628018332237, "num_env_steps_trained_throughput_per_sec": 389.3628018332237, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 9525.454, "restore_workers_time_ms": 0.022, "training_step_time_ms": 9525.089, "sample_time_ms": 1188.891, "learn_time_ms": 8301.699, "learn_throughput": 481.829, "synch_weights_time_ms": 32.994}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 148, "trial_id": "1f352_00000", "date": "2024-08-11_15-18-21", "timestamp": 1723403901, "time_this_iter_s": 10.37334394454956, "time_total_s": 1410.7914700508118, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1d3e3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1410.7914700508118, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 60.13999999999999, "ram_util_percent": 82.49333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.373936988475422, "cur_kl_coeff": 1.4889251025954502e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.771201604170104, "policy_loss": -0.0021244646472041496, "vf_loss": 1.7733260632803043, "vf_explained_var": 0.9601868739972512, "kl": 0.0034847172035670226, "entropy": 0.26280439153003193, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 142560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.251240323918561, "cur_kl_coeff": 1.7166137695312505e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7881632373978695, "policy_loss": -0.0038187319349769194, "vf_loss": 1.791981967786948, "vf_explained_var": 0.9575413821265102, "kl": 0.0033753423138402163, "entropy": 0.3281501156743616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 142560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1192000, "num_agent_steps_trained": 1192000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.92870529366202, "predator_policy": -8.351098975338948}, "policy_reward_max": {"prey_policy": 8.351098975338948, "predator_policy": 49.92870529366202}, "policy_reward_mean": {"prey_policy": -17.4618676787335, "predator_policy": 17.4618676787335}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-30.460353641383918, -17.663069069026005, -30.379056223942925, -21.861502295634956, -22.83182024095924, -15.64561060287614, -43.60342247429825, -15.111872130197863, -14.891975523262973, -15.343445644761161, -18.944533250517978, -24.512167514327324, -23.434591037483482, -11.508999381334498, -10.828630939125645, -18.66816995147771, -44.552624898554356, -13.073209607715961, 5.552527210699052, -27.65735693873318, -33.990212594286504, -11.635953573829124, 7.313822569098489, 5.352347157140191, -23.21290236738772, -20.86328175983654, -17.098050416262097, 2.916946290731053, -10.406136608310245, -31.92700537471517, -24.18761610764291, -19.81896533762828, -2.178657950325274, -19.479904216136653, -14.526477795470523, -14.422596215221727, -1.5155237586419164, -45.00215346534992, -33.93401553395906, -34.47021584069725, 1.956425238169805, -20.256180642196725, -21.558782605847483, -28.71422301824888, -12.434651025514857, -3.8540459918807626, -24.264993392124534, -3.8487426484764873, -2.637827702760003, -39.571668583903275, -10.282120739758724, -4.863706936121483, -23.40120793064706, -3.986496222770233, -2.176376285729356, -10.48471605324523, -21.829526915832947, 2.951241799503517, -32.63414256857371, -29.616335780445016, -39.18714107907431, -38.245051708874584, -15.521784896864151, -44.49116257785993, -18.749780861721813, -35.352137502320595, -7.593347503159915, -29.850339919632802, -4.822148931029332, -3.644707583884104, -4.306340776443154, -5.777157126480244, -16.7757489290945, -8.31388603569532, -14.648060042445199, -22.98464062660346, 0.4469879906090437, 8.351098975338948, -7.588707778947949, -45.295036182849735, -23.485631928255728, -32.08689361189094, -1.7498681500603013, -19.94525925420459, -3.934053126695038, -32.92270648019688, -6.991286843687297, -18.887382290987066, -16.648907390033038, -20.578792962092304, 1.882117656030048, -34.772127749679996, -5.789686567471955, -49.92870529366202, -21.147682407156836, 0.9218409485563877, -20.658649839703607, 3.967598842956125, -21.98933227386443, -17.077750994168248], "policy_predator_policy_reward": [30.460353641383918, 17.663069069026005, 30.379056223942925, 21.861502295634956, 22.83182024095924, 15.64561060287614, 43.60342247429825, 15.111872130197863, 14.891975523262973, 15.343445644761161, 18.944533250517978, 24.512167514327324, 23.434591037483482, 11.508999381334498, 10.828630939125645, 18.66816995147771, 44.552624898554356, 13.073209607715961, -5.552527210699052, 27.65735693873318, 33.990212594286504, 11.635953573829124, -7.313822569098489, -5.352347157140191, 23.21290236738772, 20.86328175983654, 17.098050416262097, -2.916946290731053, 10.406136608310245, 31.92700537471517, 24.18761610764291, 19.81896533762828, 2.178657950325274, 19.479904216136653, 14.526477795470523, 14.422596215221727, 1.5155237586419164, 45.00215346534992, 33.93401553395906, 34.47021584069725, -1.956425238169805, 20.256180642196725, 21.558782605847483, 28.71422301824888, 12.434651025514857, 3.8540459918807626, 24.264993392124534, 3.8487426484764873, 2.637827702760003, 39.571668583903275, 10.282120739758724, 4.863706936121483, 23.40120793064706, 3.986496222770233, 2.176376285729356, 10.48471605324523, 21.829526915832947, -2.951241799503517, 32.63414256857371, 29.616335780445016, 39.18714107907431, 38.245051708874584, 15.521784896864151, 44.49116257785993, 18.749780861721813, 35.352137502320595, 7.593347503159915, 29.850339919632802, 4.822148931029332, 3.644707583884104, 4.306340776443154, 5.777157126480244, 16.7757489290945, 8.31388603569532, 14.648060042445199, 22.98464062660346, -0.4469879906090437, -8.351098975338948, 7.588707778947949, 45.295036182849735, 23.485631928255728, 32.08689361189094, 1.7498681500603013, 19.94525925420459, 3.934053126695038, 32.92270648019688, 6.991286843687297, 18.887382290987066, 16.648907390033038, 20.578792962092304, -1.882117656030048, 34.772127749679996, 5.789686567471955, 49.92870529366202, 21.147682407156836, -0.9218409485563877, 20.658649839703607, -3.967598842956125, 21.98933227386443, 17.077750994168248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5006284363045522, "mean_inference_ms": 1.7375901845911776, "mean_action_processing_ms": 0.2135848671918664, "mean_env_wait_ms": 0.13132049193790082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003200531005859375, "StateBufferConnector_ms": 0.004056692123413086, "ViewRequirementAgentConnector_ms": 0.08215892314910889}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1192000, "num_agent_steps_trained": 1192000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 363.4602871617761, "num_env_steps_trained_throughput_per_sec": 363.4602871617761, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 1192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1192000, "timers": {"training_iteration_time_ms": 9764.958, "restore_workers_time_ms": 0.02, "training_step_time_ms": 9764.652, "sample_time_ms": 1155.758, "learn_time_ms": 8575.038, "learn_throughput": 466.47, "synch_weights_time_ms": 32.325}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1192000, "num_agent_steps_trained": 1192000}, "done": false, "training_iteration": 149, "trial_id": "1f352_00000", "date": "2024-08-11_15-18-32", "timestamp": 1723403912, "time_this_iter_s": 11.043479919433594, "time_total_s": 1421.8349499702454, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1d3ef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1421.8349499702454, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 64.9, "ram_util_percent": 82.63333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1919473831231397, "cur_kl_coeff": 7.444625512977251e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6435022746523222, "policy_loss": -0.0010484907509332212, "vf_loss": 1.6445507637535532, "vf_explained_var": 0.954637710750103, "kl": 0.0014662954325415625, "entropy": 0.24349891019519418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 143520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1587389251838127, "cur_kl_coeff": 8.583068847656252e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.605094939780732, "policy_loss": -0.00550495118368417, "vf_loss": 1.6105998910963535, "vf_explained_var": 0.9553415893266598, "kl": 0.004388683280390289, "entropy": 0.3470679537082712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 143520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.92870529366202, "predator_policy": -9.130432367159047}, "policy_reward_max": {"prey_policy": 9.130432367159047, "predator_policy": 49.92870529366202}, "policy_reward_mean": {"prey_policy": -16.612629775110484, "predator_policy": 16.612629775110484}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.352347157140191, -23.21290236738772, -20.86328175983654, -17.098050416262097, 2.916946290731053, -10.406136608310245, -31.92700537471517, -24.18761610764291, -19.81896533762828, -2.178657950325274, -19.479904216136653, -14.526477795470523, -14.422596215221727, -1.5155237586419164, -45.00215346534992, -33.93401553395906, -34.47021584069725, 1.956425238169805, -20.256180642196725, -21.558782605847483, -28.71422301824888, -12.434651025514857, -3.8540459918807626, -24.264993392124534, -3.8487426484764873, -2.637827702760003, -39.571668583903275, -10.282120739758724, -4.863706936121483, -23.40120793064706, -3.986496222770233, -2.176376285729356, -10.48471605324523, -21.829526915832947, 2.951241799503517, -32.63414256857371, -29.616335780445016, -39.18714107907431, -38.245051708874584, -15.521784896864151, -44.49116257785993, -18.749780861721813, -35.352137502320595, -7.593347503159915, -29.850339919632802, -4.822148931029332, -3.644707583884104, -4.306340776443154, -5.777157126480244, -16.7757489290945, -8.31388603569532, -14.648060042445199, -22.98464062660346, 0.4469879906090437, 8.351098975338948, -7.588707778947949, -45.295036182849735, -23.485631928255728, -32.08689361189094, -1.7498681500603013, -19.94525925420459, -3.934053126695038, -32.92270648019688, -6.991286843687297, -18.887382290987066, -16.648907390033038, -20.578792962092304, 1.882117656030048, -34.772127749679996, -5.789686567471955, -49.92870529366202, -21.147682407156836, 0.9218409485563877, -20.658649839703607, 3.967598842956125, -21.98933227386443, -17.077750994168248, -26.387630751055276, -12.86030302748576, -40.77955584902734, -38.7700710274259, -7.193126351306194, 9.130432367159047, -15.561866177102132, -30.12994947843664, -25.793674625385737, -28.254838318434594, -0.7837429878145965, -3.9110949501367553, -2.9661814122306662, -25.940069878840625, -35.891580453917584, -15.627726897852856, -21.14010023778814, -15.796076680666093, 7.239319593116541, 1.733859140907395, -10.166655271779927, -24.433954530025858, -4.523849586100573], "policy_predator_policy_reward": [-5.352347157140191, 23.21290236738772, 20.86328175983654, 17.098050416262097, -2.916946290731053, 10.406136608310245, 31.92700537471517, 24.18761610764291, 19.81896533762828, 2.178657950325274, 19.479904216136653, 14.526477795470523, 14.422596215221727, 1.5155237586419164, 45.00215346534992, 33.93401553395906, 34.47021584069725, -1.956425238169805, 20.256180642196725, 21.558782605847483, 28.71422301824888, 12.434651025514857, 3.8540459918807626, 24.264993392124534, 3.8487426484764873, 2.637827702760003, 39.571668583903275, 10.282120739758724, 4.863706936121483, 23.40120793064706, 3.986496222770233, 2.176376285729356, 10.48471605324523, 21.829526915832947, -2.951241799503517, 32.63414256857371, 29.616335780445016, 39.18714107907431, 38.245051708874584, 15.521784896864151, 44.49116257785993, 18.749780861721813, 35.352137502320595, 7.593347503159915, 29.850339919632802, 4.822148931029332, 3.644707583884104, 4.306340776443154, 5.777157126480244, 16.7757489290945, 8.31388603569532, 14.648060042445199, 22.98464062660346, -0.4469879906090437, -8.351098975338948, 7.588707778947949, 45.295036182849735, 23.485631928255728, 32.08689361189094, 1.7498681500603013, 19.94525925420459, 3.934053126695038, 32.92270648019688, 6.991286843687297, 18.887382290987066, 16.648907390033038, 20.578792962092304, -1.882117656030048, 34.772127749679996, 5.789686567471955, 49.92870529366202, 21.147682407156836, -0.9218409485563877, 20.658649839703607, -3.967598842956125, 21.98933227386443, 17.077750994168248, 26.387630751055276, 12.86030302748576, 40.77955584902734, 38.7700710274259, 7.193126351306194, -9.130432367159047, 15.561866177102132, 30.12994947843664, 25.793674625385737, 28.254838318434594, 0.7837429878145965, 3.9110949501367553, 2.9661814122306662, 25.940069878840625, 35.891580453917584, 15.627726897852856, 21.14010023778814, 15.796076680666093, -7.239319593116541, -1.733859140907395, 10.166655271779927, 24.433954530025858, 4.523849586100573]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.500883227991174, "mean_inference_ms": 1.7375513318583435, "mean_action_processing_ms": 0.21349375090422507, "mean_env_wait_ms": 0.13125702609741047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036886930465698242, "StateBufferConnector_ms": 0.0028612613677978516, "ViewRequirementAgentConnector_ms": 0.10685479640960693}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 398.32436685712327, "num_env_steps_trained_throughput_per_sec": 398.32436685712327, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 9859.534, "restore_workers_time_ms": 0.019, "training_step_time_ms": 9859.225, "sample_time_ms": 1248.586, "learn_time_ms": 8576.431, "learn_throughput": 466.394, "synch_weights_time_ms": 32.581}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 150, "trial_id": "1f352_00000", "date": "2024-08-11_15-18-42", "timestamp": 1723403922, "time_this_iter_s": 10.076932907104492, "time_total_s": 1431.9118828773499, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1acbe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1431.9118828773499, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 58.54666666666667, "ram_util_percent": 82.87333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4935758403191963, "cur_kl_coeff": 3.7223127564886255e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3518101944277685, "policy_loss": -0.004004380394568822, "vf_loss": 2.355814576148987, "vf_explained_var": 0.9552921649068594, "kl": 0.004971275738659141, "entropy": 0.2954202381893992, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 144480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5105758340408406, "cur_kl_coeff": 4.291534423828126e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3300526722644768, "policy_loss": -0.005580280344778051, "vf_loss": 2.335632953296105, "vf_explained_var": 0.9560412698735793, "kl": 0.005855421892308555, "entropy": 0.3322782459979256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 144480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1208000, "num_agent_steps_trained": 1208000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.72855907158587, "predator_policy": -9.130432367159047}, "policy_reward_max": {"prey_policy": 9.130432367159047, "predator_policy": 52.72855907158587}, "policy_reward_mean": {"prey_policy": -16.74627535412966, "predator_policy": 16.74627535412966}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.256180642196725, -21.558782605847483, -28.71422301824888, -12.434651025514857, -3.8540459918807626, -24.264993392124534, -3.8487426484764873, -2.637827702760003, -39.571668583903275, -10.282120739758724, -4.863706936121483, -23.40120793064706, -3.986496222770233, -2.176376285729356, -10.48471605324523, -21.829526915832947, 2.951241799503517, -32.63414256857371, -29.616335780445016, -39.18714107907431, -38.245051708874584, -15.521784896864151, -44.49116257785993, -18.749780861721813, -35.352137502320595, -7.593347503159915, -29.850339919632802, -4.822148931029332, -3.644707583884104, -4.306340776443154, -5.777157126480244, -16.7757489290945, -8.31388603569532, -14.648060042445199, -22.98464062660346, 0.4469879906090437, 8.351098975338948, -7.588707778947949, -45.295036182849735, -23.485631928255728, -32.08689361189094, -1.7498681500603013, -19.94525925420459, -3.934053126695038, -32.92270648019688, -6.991286843687297, -18.887382290987066, -16.648907390033038, -20.578792962092304, 1.882117656030048, -34.772127749679996, -5.789686567471955, -49.92870529366202, -21.147682407156836, 0.9218409485563877, -20.658649839703607, 3.967598842956125, -21.98933227386443, -17.077750994168248, -26.387630751055276, -12.86030302748576, -40.77955584902734, -38.7700710274259, -7.193126351306194, 9.130432367159047, -15.561866177102132, -30.12994947843664, -25.793674625385737, -28.254838318434594, -0.7837429878145965, -3.9110949501367553, -2.9661814122306662, -25.940069878840625, -35.891580453917584, -15.627726897852856, -21.14010023778814, -15.796076680666093, 7.239319593116541, 1.733859140907395, -10.166655271779927, -24.433954530025858, -4.523849586100573, -7.211183946081876, 5.1932175825820455, -25.529055856957367, -17.538367688947478, -13.211768590014827, -7.863140339177688, -27.48708709087041, -15.856184956284128, -6.427717500645547, -13.400410579341578, -13.554357369008981, -6.91607280621715, -52.72855907158587, -3.5015296836857273, -17.39540525267371, -43.701774895660165, -38.454907463397916, -10.598036455493345], "policy_predator_policy_reward": [20.256180642196725, 21.558782605847483, 28.71422301824888, 12.434651025514857, 3.8540459918807626, 24.264993392124534, 3.8487426484764873, 2.637827702760003, 39.571668583903275, 10.282120739758724, 4.863706936121483, 23.40120793064706, 3.986496222770233, 2.176376285729356, 10.48471605324523, 21.829526915832947, -2.951241799503517, 32.63414256857371, 29.616335780445016, 39.18714107907431, 38.245051708874584, 15.521784896864151, 44.49116257785993, 18.749780861721813, 35.352137502320595, 7.593347503159915, 29.850339919632802, 4.822148931029332, 3.644707583884104, 4.306340776443154, 5.777157126480244, 16.7757489290945, 8.31388603569532, 14.648060042445199, 22.98464062660346, -0.4469879906090437, -8.351098975338948, 7.588707778947949, 45.295036182849735, 23.485631928255728, 32.08689361189094, 1.7498681500603013, 19.94525925420459, 3.934053126695038, 32.92270648019688, 6.991286843687297, 18.887382290987066, 16.648907390033038, 20.578792962092304, -1.882117656030048, 34.772127749679996, 5.789686567471955, 49.92870529366202, 21.147682407156836, -0.9218409485563877, 20.658649839703607, -3.967598842956125, 21.98933227386443, 17.077750994168248, 26.387630751055276, 12.86030302748576, 40.77955584902734, 38.7700710274259, 7.193126351306194, -9.130432367159047, 15.561866177102132, 30.12994947843664, 25.793674625385737, 28.254838318434594, 0.7837429878145965, 3.9110949501367553, 2.9661814122306662, 25.940069878840625, 35.891580453917584, 15.627726897852856, 21.14010023778814, 15.796076680666093, -7.239319593116541, -1.733859140907395, 10.166655271779927, 24.433954530025858, 4.523849586100573, 7.211183946081876, -5.1932175825820455, 25.529055856957367, 17.538367688947478, 13.211768590014827, 7.863140339177688, 27.48708709087041, 15.856184956284128, 6.427717500645547, 13.400410579341578, 13.554357369008981, 6.91607280621715, 52.72855907158587, 3.5015296836857273, 17.39540525267371, 43.701774895660165, 38.454907463397916, 10.598036455493345]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.50031343960187, "mean_inference_ms": 1.7375899462365527, "mean_action_processing_ms": 0.21350656685254865, "mean_env_wait_ms": 0.13128007369465095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004076361656188965, "StateBufferConnector_ms": 0.0029511451721191406, "ViewRequirementAgentConnector_ms": 0.1074068546295166}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1208000, "num_agent_steps_trained": 1208000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 460.09884771637235, "num_env_steps_trained_throughput_per_sec": 460.09884771637235, "timesteps_total": 604000, "num_env_steps_sampled_lifetime": 604000, "num_agent_steps_sampled_lifetime": 1208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1208000, "timers": {"training_iteration_time_ms": 9869.948, "restore_workers_time_ms": 0.02, "training_step_time_ms": 9869.67, "sample_time_ms": 1245.124, "learn_time_ms": 8591.7, "learn_throughput": 465.566, "synch_weights_time_ms": 31.219}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1208000, "num_agent_steps_trained": 1208000}, "done": false, "training_iteration": 151, "trial_id": "1f352_00000", "date": "2024-08-11_15-18-51", "timestamp": 1723403931, "time_this_iter_s": 8.764272212982178, "time_total_s": 1440.676155090332, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c1dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1440.676155090332, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 49.93333333333334, "ram_util_percent": 82.21666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.71275755725801, "cur_kl_coeff": 1.8611563782443128e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3505102584759396, "policy_loss": -0.0016951491750660352, "vf_loss": 2.3522054022798935, "vf_explained_var": 0.93988475240767, "kl": 0.0032586489364899874, "entropy": 0.29449652465991677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 145440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.643424645314614, "cur_kl_coeff": 4.291534423828126e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.347097996870677, "policy_loss": -0.0022662182008692374, "vf_loss": 2.349364212031166, "vf_explained_var": 0.9384746770064036, "kl": 0.005387347426660648, "entropy": 0.3240810915206869, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 145440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.72855907158587, "predator_policy": -15.130224321103704}, "policy_reward_max": {"prey_policy": 15.130224321103704, "predator_policy": 52.72855907158587}, "policy_reward_mean": {"prey_policy": -16.82265127131337, "predator_policy": 16.82265127131337}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-44.49116257785993, -18.749780861721813, -35.352137502320595, -7.593347503159915, -29.850339919632802, -4.822148931029332, -3.644707583884104, -4.306340776443154, -5.777157126480244, -16.7757489290945, -8.31388603569532, -14.648060042445199, -22.98464062660346, 0.4469879906090437, 8.351098975338948, -7.588707778947949, -45.295036182849735, -23.485631928255728, -32.08689361189094, -1.7498681500603013, -19.94525925420459, -3.934053126695038, -32.92270648019688, -6.991286843687297, -18.887382290987066, -16.648907390033038, -20.578792962092304, 1.882117656030048, -34.772127749679996, -5.789686567471955, -49.92870529366202, -21.147682407156836, 0.9218409485563877, -20.658649839703607, 3.967598842956125, -21.98933227386443, -17.077750994168248, -26.387630751055276, -12.86030302748576, -40.77955584902734, -38.7700710274259, -7.193126351306194, 9.130432367159047, -15.561866177102132, -30.12994947843664, -25.793674625385737, -28.254838318434594, -0.7837429878145965, -3.9110949501367553, -2.9661814122306662, -25.940069878840625, -35.891580453917584, -15.627726897852856, -21.14010023778814, -15.796076680666093, 7.239319593116541, 1.733859140907395, -10.166655271779927, -24.433954530025858, -4.523849586100573, -7.211183946081876, 5.1932175825820455, -25.529055856957367, -17.538367688947478, -13.211768590014827, -7.863140339177688, -27.48708709087041, -15.856184956284128, -6.427717500645547, -13.400410579341578, -13.554357369008981, -6.91607280621715, -52.72855907158587, -3.5015296836857273, -17.39540525267371, -43.701774895660165, -38.454907463397916, -10.598036455493345, -30.646435828711404, -40.32512747295937, -0.7788569311719264, -16.184248618134482, -27.200779306987755, 15.130224321103704, -34.59922605482302, -35.957703832492925, -2.8577294714234585, -23.91806278017988, -21.62040737864687, -21.227797532697842, 8.618353305883208, -29.525184307531415, -38.08062581867094, -20.55866825463359, -13.932551438632542, -22.868097447594103, 1.2479185602732272, -1.1068524795334866, -35.09094386217606, -2.573270018016382], "policy_predator_policy_reward": [44.49116257785993, 18.749780861721813, 35.352137502320595, 7.593347503159915, 29.850339919632802, 4.822148931029332, 3.644707583884104, 4.306340776443154, 5.777157126480244, 16.7757489290945, 8.31388603569532, 14.648060042445199, 22.98464062660346, -0.4469879906090437, -8.351098975338948, 7.588707778947949, 45.295036182849735, 23.485631928255728, 32.08689361189094, 1.7498681500603013, 19.94525925420459, 3.934053126695038, 32.92270648019688, 6.991286843687297, 18.887382290987066, 16.648907390033038, 20.578792962092304, -1.882117656030048, 34.772127749679996, 5.789686567471955, 49.92870529366202, 21.147682407156836, -0.9218409485563877, 20.658649839703607, -3.967598842956125, 21.98933227386443, 17.077750994168248, 26.387630751055276, 12.86030302748576, 40.77955584902734, 38.7700710274259, 7.193126351306194, -9.130432367159047, 15.561866177102132, 30.12994947843664, 25.793674625385737, 28.254838318434594, 0.7837429878145965, 3.9110949501367553, 2.9661814122306662, 25.940069878840625, 35.891580453917584, 15.627726897852856, 21.14010023778814, 15.796076680666093, -7.239319593116541, -1.733859140907395, 10.166655271779927, 24.433954530025858, 4.523849586100573, 7.211183946081876, -5.1932175825820455, 25.529055856957367, 17.538367688947478, 13.211768590014827, 7.863140339177688, 27.48708709087041, 15.856184956284128, 6.427717500645547, 13.400410579341578, 13.554357369008981, 6.91607280621715, 52.72855907158587, 3.5015296836857273, 17.39540525267371, 43.701774895660165, 38.454907463397916, 10.598036455493345, 30.646435828711404, 40.32512747295937, 0.7788569311719264, 16.184248618134482, 27.200779306987755, -15.130224321103704, 34.59922605482302, 35.957703832492925, 2.8577294714234585, 23.91806278017988, 21.62040737864687, 21.227797532697842, -8.618353305883208, 29.525184307531415, 38.08062581867094, 20.55866825463359, 13.932551438632542, 22.868097447594103, -1.2479185602732272, 1.1068524795334866, 35.09094386217606, 2.573270018016382]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.500297373508058, "mean_inference_ms": 1.7379961302445208, "mean_action_processing_ms": 0.2134147691849337, "mean_env_wait_ms": 0.13129142685162504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004445075988769531, "StateBufferConnector_ms": 0.0039980411529541016, "ViewRequirementAgentConnector_ms": 0.09487354755401611}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 412.4650612639299, "num_env_steps_trained_throughput_per_sec": 412.4650612639299, "timesteps_total": 608000, "num_env_steps_sampled_lifetime": 608000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 9950.369, "restore_workers_time_ms": 0.02, "training_step_time_ms": 9950.106, "sample_time_ms": 1255.073, "learn_time_ms": 8663.435, "learn_throughput": 461.711, "synch_weights_time_ms": 30.019}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 152, "trial_id": "1f352_00000", "date": "2024-08-11_15-19-01", "timestamp": 1723403941, "time_this_iter_s": 9.75596809387207, "time_total_s": 1450.432123184204, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1a5be50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1450.432123184204, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 57.17857142857144, "ram_util_percent": 83.22142857142855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.558733317752679, "cur_kl_coeff": 9.305781891221564e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3445857763290405, "policy_loss": -0.001641087997268187, "vf_loss": 2.346226867536704, "vf_explained_var": 0.9309543649976452, "kl": 0.0028850730387992613, "entropy": 0.27678877253395817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 146400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.465354673440258, "cur_kl_coeff": 4.291534423828126e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3342140602568784, "policy_loss": -0.00250244496758872, "vf_loss": 2.3367165063818294, "vf_explained_var": 0.9331795510525505, "kl": 0.007088187515995306, "entropy": 0.35369362294053036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 146400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.72855907158587, "predator_policy": -15.130224321103704}, "policy_reward_max": {"prey_policy": 15.130224321103704, "predator_policy": 52.72855907158587}, "policy_reward_mean": {"prey_policy": -16.56780743227971, "predator_policy": 16.56780743227971}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-32.08689361189094, -1.7498681500603013, -19.94525925420459, -3.934053126695038, -32.92270648019688, -6.991286843687297, -18.887382290987066, -16.648907390033038, -20.578792962092304, 1.882117656030048, -34.772127749679996, -5.789686567471955, -49.92870529366202, -21.147682407156836, 0.9218409485563877, -20.658649839703607, 3.967598842956125, -21.98933227386443, -17.077750994168248, -26.387630751055276, -12.86030302748576, -40.77955584902734, -38.7700710274259, -7.193126351306194, 9.130432367159047, -15.561866177102132, -30.12994947843664, -25.793674625385737, -28.254838318434594, -0.7837429878145965, -3.9110949501367553, -2.9661814122306662, -25.940069878840625, -35.891580453917584, -15.627726897852856, -21.14010023778814, -15.796076680666093, 7.239319593116541, 1.733859140907395, -10.166655271779927, -24.433954530025858, -4.523849586100573, -7.211183946081876, 5.1932175825820455, -25.529055856957367, -17.538367688947478, -13.211768590014827, -7.863140339177688, -27.48708709087041, -15.856184956284128, -6.427717500645547, -13.400410579341578, -13.554357369008981, -6.91607280621715, -52.72855907158587, -3.5015296836857273, -17.39540525267371, -43.701774895660165, -38.454907463397916, -10.598036455493345, -30.646435828711404, -40.32512747295937, -0.7788569311719264, -16.184248618134482, -27.200779306987755, 15.130224321103704, -34.59922605482302, -35.957703832492925, -2.8577294714234585, -23.91806278017988, -21.62040737864687, -21.227797532697842, 8.618353305883208, -29.525184307531415, -38.08062581867094, -20.55866825463359, -13.932551438632542, -22.868097447594103, 1.2479185602732272, -1.1068524795334866, -35.09094386217606, -2.573270018016382, -25.314647537936864, -22.779601068426558, -8.800864548302496, -29.648614359484263, -37.42162574790048, -16.691035689391583, -20.413026672745776, -0.8800125685431262, -3.540693596322657, -5.9344536016959175, -4.056324552297938, -16.068275605476263, -1.8118211690504236, -8.336827228041699, -18.893801231909286, 8.53668506095468, -28.27876550175727, -19.062657818781958], "policy_predator_policy_reward": [32.08689361189094, 1.7498681500603013, 19.94525925420459, 3.934053126695038, 32.92270648019688, 6.991286843687297, 18.887382290987066, 16.648907390033038, 20.578792962092304, -1.882117656030048, 34.772127749679996, 5.789686567471955, 49.92870529366202, 21.147682407156836, -0.9218409485563877, 20.658649839703607, -3.967598842956125, 21.98933227386443, 17.077750994168248, 26.387630751055276, 12.86030302748576, 40.77955584902734, 38.7700710274259, 7.193126351306194, -9.130432367159047, 15.561866177102132, 30.12994947843664, 25.793674625385737, 28.254838318434594, 0.7837429878145965, 3.9110949501367553, 2.9661814122306662, 25.940069878840625, 35.891580453917584, 15.627726897852856, 21.14010023778814, 15.796076680666093, -7.239319593116541, -1.733859140907395, 10.166655271779927, 24.433954530025858, 4.523849586100573, 7.211183946081876, -5.1932175825820455, 25.529055856957367, 17.538367688947478, 13.211768590014827, 7.863140339177688, 27.48708709087041, 15.856184956284128, 6.427717500645547, 13.400410579341578, 13.554357369008981, 6.91607280621715, 52.72855907158587, 3.5015296836857273, 17.39540525267371, 43.701774895660165, 38.454907463397916, 10.598036455493345, 30.646435828711404, 40.32512747295937, 0.7788569311719264, 16.184248618134482, 27.200779306987755, -15.130224321103704, 34.59922605482302, 35.957703832492925, 2.8577294714234585, 23.91806278017988, 21.62040737864687, 21.227797532697842, -8.618353305883208, 29.525184307531415, 38.08062581867094, 20.55866825463359, 13.932551438632542, 22.868097447594103, -1.2479185602732272, 1.1068524795334866, 35.09094386217606, 2.573270018016382, 25.314647537936864, 22.779601068426558, 8.800864548302496, 29.648614359484263, 37.42162574790048, 16.691035689391583, 20.413026672745776, 0.8800125685431262, 3.540693596322657, 5.9344536016959175, 4.056324552297938, 16.068275605476263, 1.8118211690504236, 8.336827228041699, 18.893801231909286, -8.53668506095468, 28.27876550175727, 19.062657818781958]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5004345225259371, "mean_inference_ms": 1.7389494657915565, "mean_action_processing_ms": 0.2134512519553122, "mean_env_wait_ms": 0.13134051814469264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005924701690673828, "StateBufferConnector_ms": 0.0043947696685791016, "ViewRequirementAgentConnector_ms": 0.09923195838928223}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.95134333741396, "num_env_steps_trained_throughput_per_sec": 417.95134333741396, "timesteps_total": 612000, "num_env_steps_sampled_lifetime": 612000, "num_agent_steps_sampled_lifetime": 1224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 9983.796, "restore_workers_time_ms": 0.019, "training_step_time_ms": 9983.475, "sample_time_ms": 1315.947, "learn_time_ms": 8636.346, "learn_throughput": 463.159, "synch_weights_time_ms": 29.468}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "training_iteration": 153, "trial_id": "1f352_00000", "date": "2024-08-11_15-19-11", "timestamp": 1723403951, "time_this_iter_s": 9.604593992233276, "time_total_s": 1460.0367171764374, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c36040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1460.0367171764374, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 57.75714285714285, "ram_util_percent": 82.65714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.464333216845989, "cur_kl_coeff": 4.652890945610782e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4815293192863463, "policy_loss": -0.002944523379361878, "vf_loss": 2.4844738379120828, "vf_explained_var": 0.9268134532496333, "kl": 0.00406912380221763, "entropy": 0.2541285922129949, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 147360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4745368527869385, "cur_kl_coeff": 4.291534423828126e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4148812015851338, "policy_loss": -0.0008446985472498151, "vf_loss": 2.415725898121794, "vf_explained_var": 0.9352505469694734, "kl": 0.003219171933549029, "entropy": 0.3394216226413846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 147360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.72855907158587, "predator_policy": -15.130224321103704}, "policy_reward_max": {"prey_policy": 15.130224321103704, "predator_policy": 52.72855907158587}, "policy_reward_mean": {"prey_policy": -16.850971754317037, "predator_policy": 16.850971754317037}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.077750994168248, -26.387630751055276, -12.86030302748576, -40.77955584902734, -38.7700710274259, -7.193126351306194, 9.130432367159047, -15.561866177102132, -30.12994947843664, -25.793674625385737, -28.254838318434594, -0.7837429878145965, -3.9110949501367553, -2.9661814122306662, -25.940069878840625, -35.891580453917584, -15.627726897852856, -21.14010023778814, -15.796076680666093, 7.239319593116541, 1.733859140907395, -10.166655271779927, -24.433954530025858, -4.523849586100573, -7.211183946081876, 5.1932175825820455, -25.529055856957367, -17.538367688947478, -13.211768590014827, -7.863140339177688, -27.48708709087041, -15.856184956284128, -6.427717500645547, -13.400410579341578, -13.554357369008981, -6.91607280621715, -52.72855907158587, -3.5015296836857273, -17.39540525267371, -43.701774895660165, -38.454907463397916, -10.598036455493345, -30.646435828711404, -40.32512747295937, -0.7788569311719264, -16.184248618134482, -27.200779306987755, 15.130224321103704, -34.59922605482302, -35.957703832492925, -2.8577294714234585, -23.91806278017988, -21.62040737864687, -21.227797532697842, 8.618353305883208, -29.525184307531415, -38.08062581867094, -20.55866825463359, -13.932551438632542, -22.868097447594103, 1.2479185602732272, -1.1068524795334866, -35.09094386217606, -2.573270018016382, -25.314647537936864, -22.779601068426558, -8.800864548302496, -29.648614359484263, -37.42162574790048, -16.691035689391583, -20.413026672745776, -0.8800125685431262, -3.540693596322657, -5.9344536016959175, -4.056324552297938, -16.068275605476263, -1.8118211690504236, -8.336827228041699, -18.893801231909286, 8.53668506095468, -28.27876550175727, -19.062657818781958, -38.32863005413975, -24.687521193560084, -3.51756657760286, -1.7131797391939, -8.506334341423303, -5.900339868926885, -23.688384817855276, -20.674545640456998, -16.459067513708874, -7.475012890401417, -42.241304355271836, -6.433062022275706, -33.585710695376065, -27.15818130473015, 0.6208086743092198, -24.017442410181744, -31.22095462693312, -14.589779619847832], "policy_predator_policy_reward": [17.077750994168248, 26.387630751055276, 12.86030302748576, 40.77955584902734, 38.7700710274259, 7.193126351306194, -9.130432367159047, 15.561866177102132, 30.12994947843664, 25.793674625385737, 28.254838318434594, 0.7837429878145965, 3.9110949501367553, 2.9661814122306662, 25.940069878840625, 35.891580453917584, 15.627726897852856, 21.14010023778814, 15.796076680666093, -7.239319593116541, -1.733859140907395, 10.166655271779927, 24.433954530025858, 4.523849586100573, 7.211183946081876, -5.1932175825820455, 25.529055856957367, 17.538367688947478, 13.211768590014827, 7.863140339177688, 27.48708709087041, 15.856184956284128, 6.427717500645547, 13.400410579341578, 13.554357369008981, 6.91607280621715, 52.72855907158587, 3.5015296836857273, 17.39540525267371, 43.701774895660165, 38.454907463397916, 10.598036455493345, 30.646435828711404, 40.32512747295937, 0.7788569311719264, 16.184248618134482, 27.200779306987755, -15.130224321103704, 34.59922605482302, 35.957703832492925, 2.8577294714234585, 23.91806278017988, 21.62040737864687, 21.227797532697842, -8.618353305883208, 29.525184307531415, 38.08062581867094, 20.55866825463359, 13.932551438632542, 22.868097447594103, -1.2479185602732272, 1.1068524795334866, 35.09094386217606, 2.573270018016382, 25.314647537936864, 22.779601068426558, 8.800864548302496, 29.648614359484263, 37.42162574790048, 16.691035689391583, 20.413026672745776, 0.8800125685431262, 3.540693596322657, 5.9344536016959175, 4.056324552297938, 16.068275605476263, 1.8118211690504236, 8.336827228041699, 18.893801231909286, -8.53668506095468, 28.27876550175727, 19.062657818781958, 38.32863005413975, 24.687521193560084, 3.51756657760286, 1.7131797391939, 8.506334341423303, 5.900339868926885, 23.688384817855276, 20.674545640456998, 16.459067513708874, 7.475012890401417, 42.241304355271836, 6.433062022275706, 33.585710695376065, 27.15818130473015, -0.6208086743092198, 24.017442410181744, 31.22095462693312, 14.589779619847832]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5007663792963595, "mean_inference_ms": 1.7404585817499112, "mean_action_processing_ms": 0.21355245777598497, "mean_env_wait_ms": 0.13142651356905322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006481528282165527, "StateBufferConnector_ms": 0.0050661563873291016, "ViewRequirementAgentConnector_ms": 0.10261106491088867}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 431.46177635286614, "num_env_steps_trained_throughput_per_sec": 431.46177635286614, "timesteps_total": 616000, "num_env_steps_sampled_lifetime": 616000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 9987.786, "restore_workers_time_ms": 0.02, "training_step_time_ms": 9987.477, "sample_time_ms": 1309.877, "learn_time_ms": 8640.401, "learn_throughput": 462.941, "synch_weights_time_ms": 35.528}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 154, "trial_id": "1f352_00000", "date": "2024-08-11_15-19-20", "timestamp": 1723403960, "time_this_iter_s": 9.318657159805298, "time_total_s": 1469.3553743362427, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cb6c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1469.3553743362427, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 54.0, "ram_util_percent": 82.37692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.615615322502951, "cur_kl_coeff": 2.326445472805391e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6709060666461784, "policy_loss": -0.0017177577147473736, "vf_loss": 2.6726238215963045, "vf_explained_var": 0.9160029025127491, "kl": 0.0038940683660288484, "entropy": 0.3075677971976499, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 148320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4869119775791964, "cur_kl_coeff": 2.145767211914063e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6874328829968968, "policy_loss": -0.006953736320429016, "vf_loss": 2.6943866213783623, "vf_explained_var": 0.9203155372912685, "kl": 0.008442871925259332, "entropy": 0.348968355016162, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 148320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.72855907158587, "predator_policy": -15.130224321103704}, "policy_reward_max": {"prey_policy": 15.130224321103704, "predator_policy": 52.72855907158587}, "policy_reward_mean": {"prey_policy": -17.274197294702528, "predator_policy": 17.274197294702528}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.523849586100573, -7.211183946081876, 5.1932175825820455, -25.529055856957367, -17.538367688947478, -13.211768590014827, -7.863140339177688, -27.48708709087041, -15.856184956284128, -6.427717500645547, -13.400410579341578, -13.554357369008981, -6.91607280621715, -52.72855907158587, -3.5015296836857273, -17.39540525267371, -43.701774895660165, -38.454907463397916, -10.598036455493345, -30.646435828711404, -40.32512747295937, -0.7788569311719264, -16.184248618134482, -27.200779306987755, 15.130224321103704, -34.59922605482302, -35.957703832492925, -2.8577294714234585, -23.91806278017988, -21.62040737864687, -21.227797532697842, 8.618353305883208, -29.525184307531415, -38.08062581867094, -20.55866825463359, -13.932551438632542, -22.868097447594103, 1.2479185602732272, -1.1068524795334866, -35.09094386217606, -2.573270018016382, -25.314647537936864, -22.779601068426558, -8.800864548302496, -29.648614359484263, -37.42162574790048, -16.691035689391583, -20.413026672745776, -0.8800125685431262, -3.540693596322657, -5.9344536016959175, -4.056324552297938, -16.068275605476263, -1.8118211690504236, -8.336827228041699, -18.893801231909286, 8.53668506095468, -28.27876550175727, -19.062657818781958, -38.32863005413975, -24.687521193560084, -3.51756657760286, -1.7131797391939, -8.506334341423303, -5.900339868926885, -23.688384817855276, -20.674545640456998, -16.459067513708874, -7.475012890401417, -42.241304355271836, -6.433062022275706, -33.585710695376065, -27.15818130473015, 0.6208086743092198, -24.017442410181744, -31.22095462693312, -14.589779619847832, -15.387507974523889, -16.35915486013922, -37.10832539303152, -11.62711585783589, -25.230882253873645, -15.647904678994516, -8.258817570937644, -14.679420608791395, -33.877633795614344, 5.11236409302043, -18.918952475158, -31.384336758124, -31.698705320014234, -1.9197337695717795, -27.494767814404952, -24.749067155659137, -38.381232074499124, -37.77051233754271, 8.510007712150493, -9.837385678034092, -39.26992969985124, 7.879203858807941, -5.585082425624169], "policy_predator_policy_reward": [4.523849586100573, 7.211183946081876, -5.1932175825820455, 25.529055856957367, 17.538367688947478, 13.211768590014827, 7.863140339177688, 27.48708709087041, 15.856184956284128, 6.427717500645547, 13.400410579341578, 13.554357369008981, 6.91607280621715, 52.72855907158587, 3.5015296836857273, 17.39540525267371, 43.701774895660165, 38.454907463397916, 10.598036455493345, 30.646435828711404, 40.32512747295937, 0.7788569311719264, 16.184248618134482, 27.200779306987755, -15.130224321103704, 34.59922605482302, 35.957703832492925, 2.8577294714234585, 23.91806278017988, 21.62040737864687, 21.227797532697842, -8.618353305883208, 29.525184307531415, 38.08062581867094, 20.55866825463359, 13.932551438632542, 22.868097447594103, -1.2479185602732272, 1.1068524795334866, 35.09094386217606, 2.573270018016382, 25.314647537936864, 22.779601068426558, 8.800864548302496, 29.648614359484263, 37.42162574790048, 16.691035689391583, 20.413026672745776, 0.8800125685431262, 3.540693596322657, 5.9344536016959175, 4.056324552297938, 16.068275605476263, 1.8118211690504236, 8.336827228041699, 18.893801231909286, -8.53668506095468, 28.27876550175727, 19.062657818781958, 38.32863005413975, 24.687521193560084, 3.51756657760286, 1.7131797391939, 8.506334341423303, 5.900339868926885, 23.688384817855276, 20.674545640456998, 16.459067513708874, 7.475012890401417, 42.241304355271836, 6.433062022275706, 33.585710695376065, 27.15818130473015, -0.6208086743092198, 24.017442410181744, 31.22095462693312, 14.589779619847832, 15.387507974523889, 16.35915486013922, 37.10832539303152, 11.62711585783589, 25.230882253873645, 15.647904678994516, 8.258817570937644, 14.679420608791395, 33.877633795614344, -5.11236409302043, 18.918952475158, 31.384336758124, 31.698705320014234, 1.9197337695717795, 27.494767814404952, 24.749067155659137, 38.381232074499124, 37.77051233754271, -8.510007712150493, 9.837385678034092, 39.26992969985124, -7.879203858807941, 5.585082425624169]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5006007751833783, "mean_inference_ms": 1.7396237273145505, "mean_action_processing_ms": 0.21349658636519286, "mean_env_wait_ms": 0.1313839510940251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064771175384521484, "StateBufferConnector_ms": 0.004576921463012695, "ViewRequirementAgentConnector_ms": 0.07959258556365967}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 452.5107943621285, "num_env_steps_trained_throughput_per_sec": 452.5107943621285, "timesteps_total": 620000, "num_env_steps_sampled_lifetime": 620000, "num_agent_steps_sampled_lifetime": 1240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1240000, "timers": {"training_iteration_time_ms": 9748.351, "restore_workers_time_ms": 0.019, "training_step_time_ms": 9747.761, "sample_time_ms": 1296.381, "learn_time_ms": 8411.152, "learn_throughput": 475.559, "synch_weights_time_ms": 38.005}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "done": false, "training_iteration": 155, "trial_id": "1f352_00000", "date": "2024-08-11_15-19-29", "timestamp": 1723403969, "time_this_iter_s": 8.866384983062744, "time_total_s": 1478.2217593193054, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c891f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1478.2217593193054, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 51.44166666666667, "ram_util_percent": 81.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4528646606951954, "cur_kl_coeff": 1.1632227364026955e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.406440844635169, "policy_loss": -0.0026755338850004287, "vf_loss": 2.409116381779313, "vf_explained_var": 0.9440086374680201, "kl": 0.0041443280473389184, "entropy": 0.2731720042337353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 149280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.278650311939418, "cur_kl_coeff": 2.145767211914063e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4558789804577827, "policy_loss": -0.005332408418568472, "vf_loss": 2.4612113868196803, "vf_explained_var": 0.9467288963496685, "kl": 0.017070994036345828, "entropy": 0.35305764389534794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 149280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -43.22904391361846, "predator_policy": -15.130224321103704}, "policy_reward_max": {"prey_policy": 15.130224321103704, "predator_policy": 43.22904391361846}, "policy_reward_mean": {"prey_policy": -18.38096971521635, "predator_policy": 18.38096971521635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.184248618134482, -27.200779306987755, 15.130224321103704, -34.59922605482302, -35.957703832492925, -2.8577294714234585, -23.91806278017988, -21.62040737864687, -21.227797532697842, 8.618353305883208, -29.525184307531415, -38.08062581867094, -20.55866825463359, -13.932551438632542, -22.868097447594103, 1.2479185602732272, -1.1068524795334866, -35.09094386217606, -2.573270018016382, -25.314647537936864, -22.779601068426558, -8.800864548302496, -29.648614359484263, -37.42162574790048, -16.691035689391583, -20.413026672745776, -0.8800125685431262, -3.540693596322657, -5.9344536016959175, -4.056324552297938, -16.068275605476263, -1.8118211690504236, -8.336827228041699, -18.893801231909286, 8.53668506095468, -28.27876550175727, -19.062657818781958, -38.32863005413975, -24.687521193560084, -3.51756657760286, -1.7131797391939, -8.506334341423303, -5.900339868926885, -23.688384817855276, -20.674545640456998, -16.459067513708874, -7.475012890401417, -42.241304355271836, -6.433062022275706, -33.585710695376065, -27.15818130473015, 0.6208086743092198, -24.017442410181744, -31.22095462693312, -14.589779619847832, -15.387507974523889, -16.35915486013922, -37.10832539303152, -11.62711585783589, -25.230882253873645, -15.647904678994516, -8.258817570937644, -14.679420608791395, -33.877633795614344, 5.11236409302043, -18.918952475158, -31.384336758124, -31.698705320014234, -1.9197337695717795, -27.494767814404952, -24.749067155659137, -38.381232074499124, -37.77051233754271, 8.510007712150493, -9.837385678034092, -39.26992969985124, 7.879203858807941, -5.585082425624169, -12.372928078063325, -43.22904391361846, -6.1927797856772155, 6.422140095895921, -13.689143841803787, -30.38978967024414, -31.008757468362752, -32.455117135999224, -38.72565481890459, -23.561430455020858, -17.851644239171986, -19.004287749997196, -33.18742310844578, -38.79928633891344, -20.57949345284627, -33.755161805004334, -2.1666420286159944, -17.66353851840525, -18.91770585445394, -39.942082803147976, 4.492304629631573, -40.55638749261796], "policy_predator_policy_reward": [16.184248618134482, 27.200779306987755, -15.130224321103704, 34.59922605482302, 35.957703832492925, 2.8577294714234585, 23.91806278017988, 21.62040737864687, 21.227797532697842, -8.618353305883208, 29.525184307531415, 38.08062581867094, 20.55866825463359, 13.932551438632542, 22.868097447594103, -1.2479185602732272, 1.1068524795334866, 35.09094386217606, 2.573270018016382, 25.314647537936864, 22.779601068426558, 8.800864548302496, 29.648614359484263, 37.42162574790048, 16.691035689391583, 20.413026672745776, 0.8800125685431262, 3.540693596322657, 5.9344536016959175, 4.056324552297938, 16.068275605476263, 1.8118211690504236, 8.336827228041699, 18.893801231909286, -8.53668506095468, 28.27876550175727, 19.062657818781958, 38.32863005413975, 24.687521193560084, 3.51756657760286, 1.7131797391939, 8.506334341423303, 5.900339868926885, 23.688384817855276, 20.674545640456998, 16.459067513708874, 7.475012890401417, 42.241304355271836, 6.433062022275706, 33.585710695376065, 27.15818130473015, -0.6208086743092198, 24.017442410181744, 31.22095462693312, 14.589779619847832, 15.387507974523889, 16.35915486013922, 37.10832539303152, 11.62711585783589, 25.230882253873645, 15.647904678994516, 8.258817570937644, 14.679420608791395, 33.877633795614344, -5.11236409302043, 18.918952475158, 31.384336758124, 31.698705320014234, 1.9197337695717795, 27.494767814404952, 24.749067155659137, 38.381232074499124, 37.77051233754271, -8.510007712150493, 9.837385678034092, 39.26992969985124, -7.879203858807941, 5.585082425624169, 12.372928078063325, 43.22904391361846, 6.1927797856772155, -6.422140095895921, 13.689143841803787, 30.38978967024414, 31.008757468362752, 32.455117135999224, 38.72565481890459, 23.561430455020858, 17.851644239171986, 19.004287749997196, 33.18742310844578, 38.79928633891344, 20.57949345284627, 33.755161805004334, 2.1666420286159944, 17.66353851840525, 18.91770585445394, 39.942082803147976, -4.492304629631573, 40.55638749261796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5033228989531963, "mean_inference_ms": 1.7490137449687193, "mean_action_processing_ms": 0.21493156707485156, "mean_env_wait_ms": 0.13210161347571275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006892561912536621, "StateBufferConnector_ms": 0.006978750228881836, "ViewRequirementAgentConnector_ms": 0.09320724010467529}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.2523924605334, "num_env_steps_trained_throughput_per_sec": 442.2523924605334, "timesteps_total": 624000, "num_env_steps_sampled_lifetime": 624000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 9669.491, "restore_workers_time_ms": 0.021, "training_step_time_ms": 9668.95, "sample_time_ms": 1334.62, "learn_time_ms": 8295.698, "learn_throughput": 482.178, "synch_weights_time_ms": 35.882}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 156, "trial_id": "1f352_00000", "date": "2024-08-11_15-19-38", "timestamp": 1723403978, "time_this_iter_s": 9.11441683769226, "time_total_s": 1487.3361761569977, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c36c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1487.3361761569977, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 58.34999999999999, "ram_util_percent": 82.21428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.905569779748718, "cur_kl_coeff": 5.8161136820134774e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3395295046269893, "policy_loss": -0.0029936339633422904, "vf_loss": 2.3425231263041497, "vf_explained_var": 0.9525021255637208, "kl": 0.0025307017110379935, "entropy": 0.24108037546587488, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 150240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8835164049019415, "cur_kl_coeff": 2.145767211914063e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3227606606359283, "policy_loss": -0.0039444487056850145, "vf_loss": 2.3267051092038553, "vf_explained_var": 0.9556070678556959, "kl": 0.007955991666562913, "entropy": 0.3638888041799267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 150240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1256000, "num_agent_steps_trained": 1256000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.20074982587666, "predator_policy": -10.47554776551462}, "policy_reward_max": {"prey_policy": 10.47554776551462, "predator_policy": 52.20074982587666}, "policy_reward_mean": {"prey_policy": -18.71817134020102, "predator_policy": 18.71817134020102}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.573270018016382, -25.314647537936864, -22.779601068426558, -8.800864548302496, -29.648614359484263, -37.42162574790048, -16.691035689391583, -20.413026672745776, -0.8800125685431262, -3.540693596322657, -5.9344536016959175, -4.056324552297938, -16.068275605476263, -1.8118211690504236, -8.336827228041699, -18.893801231909286, 8.53668506095468, -28.27876550175727, -19.062657818781958, -38.32863005413975, -24.687521193560084, -3.51756657760286, -1.7131797391939, -8.506334341423303, -5.900339868926885, -23.688384817855276, -20.674545640456998, -16.459067513708874, -7.475012890401417, -42.241304355271836, -6.433062022275706, -33.585710695376065, -27.15818130473015, 0.6208086743092198, -24.017442410181744, -31.22095462693312, -14.589779619847832, -15.387507974523889, -16.35915486013922, -37.10832539303152, -11.62711585783589, -25.230882253873645, -15.647904678994516, -8.258817570937644, -14.679420608791395, -33.877633795614344, 5.11236409302043, -18.918952475158, -31.384336758124, -31.698705320014234, -1.9197337695717795, -27.494767814404952, -24.749067155659137, -38.381232074499124, -37.77051233754271, 8.510007712150493, -9.837385678034092, -39.26992969985124, 7.879203858807941, -5.585082425624169, -12.372928078063325, -43.22904391361846, -6.1927797856772155, 6.422140095895921, -13.689143841803787, -30.38978967024414, -31.008757468362752, -32.455117135999224, -38.72565481890459, -23.561430455020858, -17.851644239171986, -19.004287749997196, -33.18742310844578, -38.79928633891344, -20.57949345284627, -33.755161805004334, -2.1666420286159944, -17.66353851840525, -18.91770585445394, -39.942082803147976, 4.492304629631573, -40.55638749261796, -29.107486684957962, -26.284600316750247, -9.560415746893753, 10.47554776551462, -4.124920212147904, -23.06476500340695, -46.25895573258551, -52.20074982587666, -44.25522563112408, -1.312260496708511, 5.1934351171861834, 8.467612859733215, -33.97391148043957, -28.030473169512454, -22.74315871154721, -29.150675285255858, 2.4362375286556084, -29.957779869248732], "policy_predator_policy_reward": [2.573270018016382, 25.314647537936864, 22.779601068426558, 8.800864548302496, 29.648614359484263, 37.42162574790048, 16.691035689391583, 20.413026672745776, 0.8800125685431262, 3.540693596322657, 5.9344536016959175, 4.056324552297938, 16.068275605476263, 1.8118211690504236, 8.336827228041699, 18.893801231909286, -8.53668506095468, 28.27876550175727, 19.062657818781958, 38.32863005413975, 24.687521193560084, 3.51756657760286, 1.7131797391939, 8.506334341423303, 5.900339868926885, 23.688384817855276, 20.674545640456998, 16.459067513708874, 7.475012890401417, 42.241304355271836, 6.433062022275706, 33.585710695376065, 27.15818130473015, -0.6208086743092198, 24.017442410181744, 31.22095462693312, 14.589779619847832, 15.387507974523889, 16.35915486013922, 37.10832539303152, 11.62711585783589, 25.230882253873645, 15.647904678994516, 8.258817570937644, 14.679420608791395, 33.877633795614344, -5.11236409302043, 18.918952475158, 31.384336758124, 31.698705320014234, 1.9197337695717795, 27.494767814404952, 24.749067155659137, 38.381232074499124, 37.77051233754271, -8.510007712150493, 9.837385678034092, 39.26992969985124, -7.879203858807941, 5.585082425624169, 12.372928078063325, 43.22904391361846, 6.1927797856772155, -6.422140095895921, 13.689143841803787, 30.38978967024414, 31.008757468362752, 32.455117135999224, 38.72565481890459, 23.561430455020858, 17.851644239171986, 19.004287749997196, 33.18742310844578, 38.79928633891344, 20.57949345284627, 33.755161805004334, 2.1666420286159944, 17.66353851840525, 18.91770585445394, 39.942082803147976, -4.492304629631573, 40.55638749261796, 29.107486684957962, 26.284600316750247, 9.560415746893753, -10.47554776551462, 4.124920212147904, 23.06476500340695, 46.25895573258551, 52.20074982587666, 44.25522563112408, 1.312260496708511, -5.1934351171861834, -8.467612859733215, 33.97391148043957, 28.030473169512454, 22.74315871154721, 29.150675285255858, -2.4362375286556084, 29.957779869248732]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.501015919385295, "mean_inference_ms": 1.7408629205756072, "mean_action_processing_ms": 0.21374754938926388, "mean_env_wait_ms": 0.13157301430109825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006633400917053223, "StateBufferConnector_ms": 0.006426811218261719, "ViewRequirementAgentConnector_ms": 0.0859755277633667}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1256000, "num_agent_steps_trained": 1256000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 448.46275778190613, "num_env_steps_trained_throughput_per_sec": 448.46275778190613, "timesteps_total": 628000, "num_env_steps_sampled_lifetime": 628000, "num_agent_steps_sampled_lifetime": 1256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1256000, "timers": {"training_iteration_time_ms": 9535.763, "restore_workers_time_ms": 0.021, "training_step_time_ms": 9535.216, "sample_time_ms": 1388.809, "learn_time_ms": 8108.013, "learn_throughput": 493.339, "synch_weights_time_ms": 35.6}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1256000, "num_agent_steps_trained": 1256000}, "done": false, "training_iteration": 157, "trial_id": "1f352_00000", "date": "2024-08-11_15-19-47", "timestamp": 1723403987, "time_this_iter_s": 8.96217393875122, "time_total_s": 1496.298350095749, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c36ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1496.298350095749, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 52.73333333333333, "ram_util_percent": 82.40833333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.453423575684428, "cur_kl_coeff": 2.9080568410067387e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5735459060718615, "policy_loss": -0.0009772579661027217, "vf_loss": 1.5745231645802658, "vf_explained_var": 0.9594033046935996, "kl": 0.0028233694523940663, "entropy": 0.25339947526032724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 151200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4509324256951612, "cur_kl_coeff": 2.145767211914063e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6715815097714464, "policy_loss": -0.005587701761396602, "vf_loss": 1.6771692133198182, "vf_explained_var": 0.9577078465993206, "kl": 0.008661068822437628, "entropy": 0.3430796352835993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 151200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.20074982587666, "predator_policy": -10.47554776551462}, "policy_reward_max": {"prey_policy": 10.47554776551462, "predator_policy": 52.20074982587666}, "policy_reward_mean": {"prey_policy": -19.263839642727568, "predator_policy": 19.263839642727568}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-19.062657818781958, -38.32863005413975, -24.687521193560084, -3.51756657760286, -1.7131797391939, -8.506334341423303, -5.900339868926885, -23.688384817855276, -20.674545640456998, -16.459067513708874, -7.475012890401417, -42.241304355271836, -6.433062022275706, -33.585710695376065, -27.15818130473015, 0.6208086743092198, -24.017442410181744, -31.22095462693312, -14.589779619847832, -15.387507974523889, -16.35915486013922, -37.10832539303152, -11.62711585783589, -25.230882253873645, -15.647904678994516, -8.258817570937644, -14.679420608791395, -33.877633795614344, 5.11236409302043, -18.918952475158, -31.384336758124, -31.698705320014234, -1.9197337695717795, -27.494767814404952, -24.749067155659137, -38.381232074499124, -37.77051233754271, 8.510007712150493, -9.837385678034092, -39.26992969985124, 7.879203858807941, -5.585082425624169, -12.372928078063325, -43.22904391361846, -6.1927797856772155, 6.422140095895921, -13.689143841803787, -30.38978967024414, -31.008757468362752, -32.455117135999224, -38.72565481890459, -23.561430455020858, -17.851644239171986, -19.004287749997196, -33.18742310844578, -38.79928633891344, -20.57949345284627, -33.755161805004334, -2.1666420286159944, -17.66353851840525, -18.91770585445394, -39.942082803147976, 4.492304629631573, -40.55638749261796, -29.107486684957962, -26.284600316750247, -9.560415746893753, 10.47554776551462, -4.124920212147904, -23.06476500340695, -46.25895573258551, -52.20074982587666, -44.25522563112408, -1.312260496708511, 5.1934351171861834, 8.467612859733215, -33.97391148043957, -28.030473169512454, -22.74315871154721, -29.150675285255858, 2.4362375286556084, -29.957779869248732, -21.401991561417418, 2.711549130849873, -34.7934091865399, -20.866379054689492, -12.979645099184841, -15.451307018574806, -28.458926955680756, -17.102534649661724, -18.74490355797582, -27.556672445605916, 7.465273127113491, -2.354382633279119, -18.700244831239303, 0.8487251028847012, -28.85704975938399, -19.644435422090172, -8.563263358415984, -33.02420771610793], "policy_predator_policy_reward": [19.062657818781958, 38.32863005413975, 24.687521193560084, 3.51756657760286, 1.7131797391939, 8.506334341423303, 5.900339868926885, 23.688384817855276, 20.674545640456998, 16.459067513708874, 7.475012890401417, 42.241304355271836, 6.433062022275706, 33.585710695376065, 27.15818130473015, -0.6208086743092198, 24.017442410181744, 31.22095462693312, 14.589779619847832, 15.387507974523889, 16.35915486013922, 37.10832539303152, 11.62711585783589, 25.230882253873645, 15.647904678994516, 8.258817570937644, 14.679420608791395, 33.877633795614344, -5.11236409302043, 18.918952475158, 31.384336758124, 31.698705320014234, 1.9197337695717795, 27.494767814404952, 24.749067155659137, 38.381232074499124, 37.77051233754271, -8.510007712150493, 9.837385678034092, 39.26992969985124, -7.879203858807941, 5.585082425624169, 12.372928078063325, 43.22904391361846, 6.1927797856772155, -6.422140095895921, 13.689143841803787, 30.38978967024414, 31.008757468362752, 32.455117135999224, 38.72565481890459, 23.561430455020858, 17.851644239171986, 19.004287749997196, 33.18742310844578, 38.79928633891344, 20.57949345284627, 33.755161805004334, 2.1666420286159944, 17.66353851840525, 18.91770585445394, 39.942082803147976, -4.492304629631573, 40.55638749261796, 29.107486684957962, 26.284600316750247, 9.560415746893753, -10.47554776551462, 4.124920212147904, 23.06476500340695, 46.25895573258551, 52.20074982587666, 44.25522563112408, 1.312260496708511, -5.1934351171861834, -8.467612859733215, 33.97391148043957, 28.030473169512454, 22.74315871154721, 29.150675285255858, -2.4362375286556084, 29.957779869248732, 21.401991561417418, -2.711549130849873, 34.7934091865399, 20.866379054689492, 12.979645099184841, 15.451307018574806, 28.458926955680756, 17.102534649661724, 18.74490355797582, 27.556672445605916, -7.465273127113491, 2.354382633279119, 18.700244831239303, -0.8487251028847012, 28.85704975938399, 19.644435422090172, 8.563263358415984, 33.02420771610793]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5011486942544603, "mean_inference_ms": 1.740944817767291, "mean_action_processing_ms": 0.2138104083350251, "mean_env_wait_ms": 0.13161953849715943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005318760871887207, "StateBufferConnector_ms": 0.006084561347961426, "ViewRequirementAgentConnector_ms": 0.08384919166564941}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 488.15076340914146, "num_env_steps_trained_throughput_per_sec": 488.15076340914146, "timesteps_total": 632000, "num_env_steps_sampled_lifetime": 632000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 9327.856, "restore_workers_time_ms": 0.021, "training_step_time_ms": 9327.341, "sample_time_ms": 1396.517, "learn_time_ms": 7897.429, "learn_throughput": 506.494, "synch_weights_time_ms": 30.826}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 158, "trial_id": "1f352_00000", "date": "2024-08-11_15-19-55", "timestamp": 1723403995, "time_this_iter_s": 8.214491844177246, "time_total_s": 1504.5128419399261, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cdff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1504.5128419399261, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 48.98333333333334, "ram_util_percent": 82.25833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4706978200624388, "cur_kl_coeff": 1.4540284205033694e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6249022855733832, "policy_loss": -0.00032842186750106823, "vf_loss": 1.6252307057380677, "vf_explained_var": 0.9519000580534339, "kl": 0.00266811997998166, "entropy": 0.2288765964874377, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 152160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.242683641798794, "cur_kl_coeff": 2.145767211914063e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6426885837068161, "policy_loss": -0.004891637099111297, "vf_loss": 1.6475802193706235, "vf_explained_var": 0.9497816590592265, "kl": 0.005278494069718794, "entropy": 0.37274894751608373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 152160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.20074982587666, "predator_policy": -10.47554776551462}, "policy_reward_max": {"prey_policy": 10.47554776551462, "predator_policy": 52.20074982587666}, "policy_reward_mean": {"prey_policy": -19.11654780342069, "predator_policy": 19.11654780342069}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.589779619847832, -15.387507974523889, -16.35915486013922, -37.10832539303152, -11.62711585783589, -25.230882253873645, -15.647904678994516, -8.258817570937644, -14.679420608791395, -33.877633795614344, 5.11236409302043, -18.918952475158, -31.384336758124, -31.698705320014234, -1.9197337695717795, -27.494767814404952, -24.749067155659137, -38.381232074499124, -37.77051233754271, 8.510007712150493, -9.837385678034092, -39.26992969985124, 7.879203858807941, -5.585082425624169, -12.372928078063325, -43.22904391361846, -6.1927797856772155, 6.422140095895921, -13.689143841803787, -30.38978967024414, -31.008757468362752, -32.455117135999224, -38.72565481890459, -23.561430455020858, -17.851644239171986, -19.004287749997196, -33.18742310844578, -38.79928633891344, -20.57949345284627, -33.755161805004334, -2.1666420286159944, -17.66353851840525, -18.91770585445394, -39.942082803147976, 4.492304629631573, -40.55638749261796, -29.107486684957962, -26.284600316750247, -9.560415746893753, 10.47554776551462, -4.124920212147904, -23.06476500340695, -46.25895573258551, -52.20074982587666, -44.25522563112408, -1.312260496708511, 5.1934351171861834, 8.467612859733215, -33.97391148043957, -28.030473169512454, -22.74315871154721, -29.150675285255858, 2.4362375286556084, -29.957779869248732, -21.401991561417418, 2.711549130849873, -34.7934091865399, -20.866379054689492, -12.979645099184841, -15.451307018574806, -28.458926955680756, -17.102534649661724, -18.74490355797582, -27.556672445605916, 7.465273127113491, -2.354382633279119, -18.700244831239303, 0.8487251028847012, -28.85704975938399, -19.644435422090172, -8.563263358415984, -33.02420771610793, -36.16201752752957, -8.637151811763802, -39.8213191602765, -6.704715743738886, -12.73685349755652, -23.12933562428942, 9.446873071178917, -17.72756614702807, -17.21820720511427, -1.6582595429735338, -16.62967961195976, -11.337836760787331, -5.008135005152561, -12.016592615373513, -36.86338146205269, -27.353942346589307, -21.732754302051024, -34.029027972765185], "policy_predator_policy_reward": [14.589779619847832, 15.387507974523889, 16.35915486013922, 37.10832539303152, 11.62711585783589, 25.230882253873645, 15.647904678994516, 8.258817570937644, 14.679420608791395, 33.877633795614344, -5.11236409302043, 18.918952475158, 31.384336758124, 31.698705320014234, 1.9197337695717795, 27.494767814404952, 24.749067155659137, 38.381232074499124, 37.77051233754271, -8.510007712150493, 9.837385678034092, 39.26992969985124, -7.879203858807941, 5.585082425624169, 12.372928078063325, 43.22904391361846, 6.1927797856772155, -6.422140095895921, 13.689143841803787, 30.38978967024414, 31.008757468362752, 32.455117135999224, 38.72565481890459, 23.561430455020858, 17.851644239171986, 19.004287749997196, 33.18742310844578, 38.79928633891344, 20.57949345284627, 33.755161805004334, 2.1666420286159944, 17.66353851840525, 18.91770585445394, 39.942082803147976, -4.492304629631573, 40.55638749261796, 29.107486684957962, 26.284600316750247, 9.560415746893753, -10.47554776551462, 4.124920212147904, 23.06476500340695, 46.25895573258551, 52.20074982587666, 44.25522563112408, 1.312260496708511, -5.1934351171861834, -8.467612859733215, 33.97391148043957, 28.030473169512454, 22.74315871154721, 29.150675285255858, -2.4362375286556084, 29.957779869248732, 21.401991561417418, -2.711549130849873, 34.7934091865399, 20.866379054689492, 12.979645099184841, 15.451307018574806, 28.458926955680756, 17.102534649661724, 18.74490355797582, 27.556672445605916, -7.465273127113491, 2.354382633279119, 18.700244831239303, -0.8487251028847012, 28.85704975938399, 19.644435422090172, 8.563263358415984, 33.02420771610793, 36.16201752752957, 8.637151811763802, 39.8213191602765, 6.704715743738886, 12.73685349755652, 23.12933562428942, -9.446873071178917, 17.72756614702807, 17.21820720511427, 1.6582595429735338, 16.62967961195976, 11.337836760787331, 5.008135005152561, 12.016592615373513, 36.86338146205269, 27.353942346589307, 21.732754302051024, 34.029027972765185]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5011484178619401, "mean_inference_ms": 1.740614606891193, "mean_action_processing_ms": 0.21381984995919923, "mean_env_wait_ms": 0.1316285320710615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004724025726318359, "StateBufferConnector_ms": 0.00539088249206543, "ViewRequirementAgentConnector_ms": 0.0839918851852417}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 472.0912062727527, "num_env_steps_trained_throughput_per_sec": 472.0912062727527, "timesteps_total": 636000, "num_env_steps_sampled_lifetime": 636000, "num_agent_steps_sampled_lifetime": 1272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 9074.614, "restore_workers_time_ms": 0.021, "training_step_time_ms": 9074.15, "sample_time_ms": 1405.802, "learn_time_ms": 7636.65, "learn_throughput": 523.79, "synch_weights_time_ms": 29.256}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "training_iteration": 159, "trial_id": "1f352_00000", "date": "2024-08-11_15-20-04", "timestamp": 1723404004, "time_this_iter_s": 8.495858907699585, "time_total_s": 1513.0087008476257, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c36c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1513.0087008476257, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 50.550000000000004, "ram_util_percent": 82.34166666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.537478785216808, "cur_kl_coeff": 7.270142102516847e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1709607572605214, "policy_loss": -0.0008979777053658229, "vf_loss": 2.171858736127615, "vf_explained_var": 0.9402866691971818, "kl": 0.0038509367869418534, "entropy": 0.27327489043430736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 153120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.523833607695997, "cur_kl_coeff": 2.145767211914063e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1871403455734253, "policy_loss": -0.004709782014348699, "vf_loss": 2.191850125292937, "vf_explained_var": 0.9417267672717571, "kl": 0.007916064424354942, "entropy": 0.36126152087623875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 153120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.20074982587666, "predator_policy": -10.47554776551462}, "policy_reward_max": {"prey_policy": 10.47554776551462, "predator_policy": 52.20074982587666}, "policy_reward_mean": {"prey_policy": -18.727963172150474, "predator_policy": 18.727963172150474}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6.422140095895921, -13.689143841803787, -30.38978967024414, -31.008757468362752, -32.455117135999224, -38.72565481890459, -23.561430455020858, -17.851644239171986, -19.004287749997196, -33.18742310844578, -38.79928633891344, -20.57949345284627, -33.755161805004334, -2.1666420286159944, -17.66353851840525, -18.91770585445394, -39.942082803147976, 4.492304629631573, -40.55638749261796, -29.107486684957962, -26.284600316750247, -9.560415746893753, 10.47554776551462, -4.124920212147904, -23.06476500340695, -46.25895573258551, -52.20074982587666, -44.25522563112408, -1.312260496708511, 5.1934351171861834, 8.467612859733215, -33.97391148043957, -28.030473169512454, -22.74315871154721, -29.150675285255858, 2.4362375286556084, -29.957779869248732, -21.401991561417418, 2.711549130849873, -34.7934091865399, -20.866379054689492, -12.979645099184841, -15.451307018574806, -28.458926955680756, -17.102534649661724, -18.74490355797582, -27.556672445605916, 7.465273127113491, -2.354382633279119, -18.700244831239303, 0.8487251028847012, -28.85704975938399, -19.644435422090172, -8.563263358415984, -33.02420771610793, -36.16201752752957, -8.637151811763802, -39.8213191602765, -6.704715743738886, -12.73685349755652, -23.12933562428942, 9.446873071178917, -17.72756614702807, -17.21820720511427, -1.6582595429735338, -16.62967961195976, -11.337836760787331, -5.008135005152561, -12.016592615373513, -36.86338146205269, -27.353942346589307, -21.732754302051024, -34.029027972765185, -2.1540296900769107, -1.6778314364114353, -23.590570721291108, -16.352047125006873, 2.421109953066912, -25.07829683243625, -20.543370760582103, -19.721693505769256, -10.821236972908299, -12.774066030822409, -38.54174857314378, -0.0201342663484656, -14.226691039399086, -17.332405473849317, -28.886004729413543, -23.78829295004293, -34.38372967737766, -31.10960975827045, -8.010048431113832, 2.4474266139771625, -1.576436677381567, -27.185791675686826, -22.331149998144745, -18.998533745773173, -27.477712665616956, -38.0300896911207, -1.4679752474877983], "policy_predator_policy_reward": [-6.422140095895921, 13.689143841803787, 30.38978967024414, 31.008757468362752, 32.455117135999224, 38.72565481890459, 23.561430455020858, 17.851644239171986, 19.004287749997196, 33.18742310844578, 38.79928633891344, 20.57949345284627, 33.755161805004334, 2.1666420286159944, 17.66353851840525, 18.91770585445394, 39.942082803147976, -4.492304629631573, 40.55638749261796, 29.107486684957962, 26.284600316750247, 9.560415746893753, -10.47554776551462, 4.124920212147904, 23.06476500340695, 46.25895573258551, 52.20074982587666, 44.25522563112408, 1.312260496708511, -5.1934351171861834, -8.467612859733215, 33.97391148043957, 28.030473169512454, 22.74315871154721, 29.150675285255858, -2.4362375286556084, 29.957779869248732, 21.401991561417418, -2.711549130849873, 34.7934091865399, 20.866379054689492, 12.979645099184841, 15.451307018574806, 28.458926955680756, 17.102534649661724, 18.74490355797582, 27.556672445605916, -7.465273127113491, 2.354382633279119, 18.700244831239303, -0.8487251028847012, 28.85704975938399, 19.644435422090172, 8.563263358415984, 33.02420771610793, 36.16201752752957, 8.637151811763802, 39.8213191602765, 6.704715743738886, 12.73685349755652, 23.12933562428942, -9.446873071178917, 17.72756614702807, 17.21820720511427, 1.6582595429735338, 16.62967961195976, 11.337836760787331, 5.008135005152561, 12.016592615373513, 36.86338146205269, 27.353942346589307, 21.732754302051024, 34.029027972765185, 2.1540296900769107, 1.6778314364114353, 23.590570721291108, 16.352047125006873, -2.421109953066912, 25.07829683243625, 20.543370760582103, 19.721693505769256, 10.821236972908299, 12.774066030822409, 38.54174857314378, 0.0201342663484656, 14.226691039399086, 17.332405473849317, 28.886004729413543, 23.78829295004293, 34.38372967737766, 31.10960975827045, 8.010048431113832, -2.4474266139771625, 1.576436677381567, 27.185791675686826, 22.331149998144745, 18.998533745773173, 27.477712665616956, 38.0300896911207, 1.4679752474877983]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5044025312056509, "mean_inference_ms": 1.7509891788337637, "mean_action_processing_ms": 0.21541135629894878, "mean_env_wait_ms": 0.13237252450400624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04593491554260254, "StateBufferConnector_ms": 0.0061991214752197266, "ViewRequirementAgentConnector_ms": 0.13548612594604492}, "num_episodes": 27, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 405.6788504567848, "num_env_steps_trained_throughput_per_sec": 405.6788504567848, "timesteps_total": 640000, "num_env_steps_sampled_lifetime": 640000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 9056.416, "restore_workers_time_ms": 0.021, "training_step_time_ms": 9055.942, "sample_time_ms": 1375.201, "learn_time_ms": 7648.846, "learn_throughput": 522.955, "synch_weights_time_ms": 29.492}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 160, "trial_id": "1f352_00000", "date": "2024-08-11_15-20-14", "timestamp": 1723404014, "time_this_iter_s": 9.892124891281128, "time_total_s": 1522.9008257389069, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1d3eee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1522.9008257389069, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 60.89285714285715, "ram_util_percent": 82.33571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5959940732767186, "cur_kl_coeff": 3.6350710512584234e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2623150223245223, "policy_loss": -0.0023394913519344603, "vf_loss": 2.264654515621563, "vf_explained_var": 0.9383488338440656, "kl": 0.002992878813682087, "entropy": 0.27029365046570697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 154080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5650684269766013, "cur_kl_coeff": 2.145767211914063e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.293357727800806, "policy_loss": -0.005212569817861852, "vf_loss": 2.2985703046123187, "vf_explained_var": 0.9422781256958842, "kl": 0.006515165680456109, "entropy": 0.35341325799624124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 154080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1288000, "num_agent_steps_trained": 1288000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.20074982587666, "predator_policy": -10.47554776551462}, "policy_reward_max": {"prey_policy": 10.47554776551462, "predator_policy": 52.20074982587666}, "policy_reward_mean": {"prey_policy": -17.644304331685543, "predator_policy": 17.644304331685543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-40.55638749261796, -29.107486684957962, -26.284600316750247, -9.560415746893753, 10.47554776551462, -4.124920212147904, -23.06476500340695, -46.25895573258551, -52.20074982587666, -44.25522563112408, -1.312260496708511, 5.1934351171861834, 8.467612859733215, -33.97391148043957, -28.030473169512454, -22.74315871154721, -29.150675285255858, 2.4362375286556084, -29.957779869248732, -21.401991561417418, 2.711549130849873, -34.7934091865399, -20.866379054689492, -12.979645099184841, -15.451307018574806, -28.458926955680756, -17.102534649661724, -18.74490355797582, -27.556672445605916, 7.465273127113491, -2.354382633279119, -18.700244831239303, 0.8487251028847012, -28.85704975938399, -19.644435422090172, -8.563263358415984, -33.02420771610793, -36.16201752752957, -8.637151811763802, -39.8213191602765, -6.704715743738886, -12.73685349755652, -23.12933562428942, 9.446873071178917, -17.72756614702807, -17.21820720511427, -1.6582595429735338, -16.62967961195976, -11.337836760787331, -5.008135005152561, -12.016592615373513, -36.86338146205269, -27.353942346589307, -21.732754302051024, -34.029027972765185, -2.1540296900769107, -1.6778314364114353, -23.590570721291108, -16.352047125006873, 2.421109953066912, -25.07829683243625, -20.543370760582103, -19.721693505769256, -10.821236972908299, -12.774066030822409, -38.54174857314378, -0.0201342663484656, -14.226691039399086, -17.332405473849317, -28.886004729413543, -23.78829295004293, -34.38372967737766, -31.10960975827045, -8.010048431113832, 2.4474266139771625, -1.576436677381567, -27.185791675686826, -22.331149998144745, -18.998533745773173, -27.477712665616956, -38.0300896911207, -1.4679752474877983, -20.40461658927777, -18.643620710729454, -28.22759340333112, -24.89089869833737, -1.602939992160291, -15.741840828195905, -11.827435383413032, -8.602915840664881, 2.1261540297627484, -4.5827494805005795, 7.961857543029451, -27.173267472692366, -18.11503940424445, -29.54937379758798, -37.11116271102775, -32.19104233874772, -1.407896661061593, -22.43244877813682], "policy_predator_policy_reward": [40.55638749261796, 29.107486684957962, 26.284600316750247, 9.560415746893753, -10.47554776551462, 4.124920212147904, 23.06476500340695, 46.25895573258551, 52.20074982587666, 44.25522563112408, 1.312260496708511, -5.1934351171861834, -8.467612859733215, 33.97391148043957, 28.030473169512454, 22.74315871154721, 29.150675285255858, -2.4362375286556084, 29.957779869248732, 21.401991561417418, -2.711549130849873, 34.7934091865399, 20.866379054689492, 12.979645099184841, 15.451307018574806, 28.458926955680756, 17.102534649661724, 18.74490355797582, 27.556672445605916, -7.465273127113491, 2.354382633279119, 18.700244831239303, -0.8487251028847012, 28.85704975938399, 19.644435422090172, 8.563263358415984, 33.02420771610793, 36.16201752752957, 8.637151811763802, 39.8213191602765, 6.704715743738886, 12.73685349755652, 23.12933562428942, -9.446873071178917, 17.72756614702807, 17.21820720511427, 1.6582595429735338, 16.62967961195976, 11.337836760787331, 5.008135005152561, 12.016592615373513, 36.86338146205269, 27.353942346589307, 21.732754302051024, 34.029027972765185, 2.1540296900769107, 1.6778314364114353, 23.590570721291108, 16.352047125006873, -2.421109953066912, 25.07829683243625, 20.543370760582103, 19.721693505769256, 10.821236972908299, 12.774066030822409, 38.54174857314378, 0.0201342663484656, 14.226691039399086, 17.332405473849317, 28.886004729413543, 23.78829295004293, 34.38372967737766, 31.10960975827045, 8.010048431113832, -2.4474266139771625, 1.576436677381567, 27.185791675686826, 22.331149998144745, 18.998533745773173, 27.477712665616956, 38.0300896911207, 1.4679752474877983, 20.40461658927777, 18.643620710729454, 28.22759340333112, 24.89089869833737, 1.602939992160291, 15.741840828195905, 11.827435383413032, 8.602915840664881, -2.1261540297627484, 4.5827494805005795, -7.961857543029451, 27.173267472692366, 18.11503940424445, 29.54937379758798, 37.11116271102775, 32.19104233874772, 1.407896661061593, 22.43244877813682]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.50216279954061, "mean_inference_ms": 1.7426016770005486, "mean_action_processing_ms": 0.2142087867922352, "mean_env_wait_ms": 0.13182077730957928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04531264305114746, "StateBufferConnector_ms": 0.004337310791015625, "ViewRequirementAgentConnector_ms": 0.12317109107971191}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1288000, "num_agent_steps_trained": 1288000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 453.4444591743752, "num_env_steps_trained_throughput_per_sec": 453.4444591743752, "timesteps_total": 644000, "num_env_steps_sampled_lifetime": 644000, "num_agent_steps_sampled_lifetime": 1288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1288000, "timers": {"training_iteration_time_ms": 9069.175, "restore_workers_time_ms": 0.021, "training_step_time_ms": 9068.694, "sample_time_ms": 1391.247, "learn_time_ms": 7645.535, "learn_throughput": 523.181, "synch_weights_time_ms": 29.533}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1288000, "num_agent_steps_trained": 1288000}, "done": false, "training_iteration": 161, "trial_id": "1f352_00000", "date": "2024-08-11_15-20-23", "timestamp": 1723404023, "time_this_iter_s": 8.867148876190186, "time_total_s": 1531.767974615097, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c89f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1531.767974615097, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 57.24615384615385, "ram_util_percent": 82.63846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2848513911788664, "cur_kl_coeff": 1.8175355256292117e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.117072240139047, "policy_loss": -0.002497347338551966, "vf_loss": 2.119569585348169, "vf_explained_var": 0.9213997123142084, "kl": 0.0026762092652544544, "entropy": 0.21682460106288393, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 155040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.356102001667023, "cur_kl_coeff": 2.145767211914063e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1307412025829158, "policy_loss": -0.002859853308958312, "vf_loss": 2.1336010581503313, "vf_explained_var": 0.9260385102281968, "kl": 0.005671497853325746, "entropy": 0.3642709727709492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 155040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.023885940754546, "predator_policy": -9.446873071178917}, "policy_reward_max": {"prey_policy": 9.446873071178917, "predator_policy": 54.023885940754546}, "policy_reward_mean": {"prey_policy": -17.600359818562865, "predator_policy": 17.600359818562865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-29.957779869248732, -21.401991561417418, 2.711549130849873, -34.7934091865399, -20.866379054689492, -12.979645099184841, -15.451307018574806, -28.458926955680756, -17.102534649661724, -18.74490355797582, -27.556672445605916, 7.465273127113491, -2.354382633279119, -18.700244831239303, 0.8487251028847012, -28.85704975938399, -19.644435422090172, -8.563263358415984, -33.02420771610793, -36.16201752752957, -8.637151811763802, -39.8213191602765, -6.704715743738886, -12.73685349755652, -23.12933562428942, 9.446873071178917, -17.72756614702807, -17.21820720511427, -1.6582595429735338, -16.62967961195976, -11.337836760787331, -5.008135005152561, -12.016592615373513, -36.86338146205269, -27.353942346589307, -21.732754302051024, -34.029027972765185, -2.1540296900769107, -1.6778314364114353, -23.590570721291108, -16.352047125006873, 2.421109953066912, -25.07829683243625, -20.543370760582103, -19.721693505769256, -10.821236972908299, -12.774066030822409, -38.54174857314378, -0.0201342663484656, -14.226691039399086, -17.332405473849317, -28.886004729413543, -23.78829295004293, -34.38372967737766, -31.10960975827045, -8.010048431113832, 2.4474266139771625, -1.576436677381567, -27.185791675686826, -22.331149998144745, -18.998533745773173, -27.477712665616956, -38.0300896911207, -1.4679752474877983, -20.40461658927777, -18.643620710729454, -28.22759340333112, -24.89089869833737, -1.602939992160291, -15.741840828195905, -11.827435383413032, -8.602915840664881, 2.1261540297627484, -4.5827494805005795, 7.961857543029451, -27.173267472692366, -18.11503940424445, -29.54937379758798, -37.11116271102775, -32.19104233874772, -1.407896661061593, -22.43244877813682, -0.2743485236179648, -7.019140539097329, -1.8340109476022093, -17.542318540582304, -30.392553538554385, -28.45346955533019, -6.759725602915039, -22.818063085622622, -54.023885940754546, -18.972969703805372, -18.116906252518213, -11.8079791579735, -8.477173750390055, -23.183357077789356, -35.54869896460547, -16.41233761526619, -40.963093711595434, -17.056668698447627], "policy_predator_policy_reward": [29.957779869248732, 21.401991561417418, -2.711549130849873, 34.7934091865399, 20.866379054689492, 12.979645099184841, 15.451307018574806, 28.458926955680756, 17.102534649661724, 18.74490355797582, 27.556672445605916, -7.465273127113491, 2.354382633279119, 18.700244831239303, -0.8487251028847012, 28.85704975938399, 19.644435422090172, 8.563263358415984, 33.02420771610793, 36.16201752752957, 8.637151811763802, 39.8213191602765, 6.704715743738886, 12.73685349755652, 23.12933562428942, -9.446873071178917, 17.72756614702807, 17.21820720511427, 1.6582595429735338, 16.62967961195976, 11.337836760787331, 5.008135005152561, 12.016592615373513, 36.86338146205269, 27.353942346589307, 21.732754302051024, 34.029027972765185, 2.1540296900769107, 1.6778314364114353, 23.590570721291108, 16.352047125006873, -2.421109953066912, 25.07829683243625, 20.543370760582103, 19.721693505769256, 10.821236972908299, 12.774066030822409, 38.54174857314378, 0.0201342663484656, 14.226691039399086, 17.332405473849317, 28.886004729413543, 23.78829295004293, 34.38372967737766, 31.10960975827045, 8.010048431113832, -2.4474266139771625, 1.576436677381567, 27.185791675686826, 22.331149998144745, 18.998533745773173, 27.477712665616956, 38.0300896911207, 1.4679752474877983, 20.40461658927777, 18.643620710729454, 28.22759340333112, 24.89089869833737, 1.602939992160291, 15.741840828195905, 11.827435383413032, 8.602915840664881, -2.1261540297627484, 4.5827494805005795, -7.961857543029451, 27.173267472692366, 18.11503940424445, 29.54937379758798, 37.11116271102775, 32.19104233874772, 1.407896661061593, 22.43244877813682, 0.2743485236179648, 7.019140539097329, 1.8340109476022093, 17.542318540582304, 30.392553538554385, 28.45346955533019, 6.759725602915039, 22.818063085622622, 54.023885940754546, 18.972969703805372, 18.116906252518213, 11.8079791579735, 8.477173750390055, 23.183357077789356, 35.54869896460547, 16.41233761526619, 40.963093711595434, 17.056668698447627]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5022615020136909, "mean_inference_ms": 1.7424714418184604, "mean_action_processing_ms": 0.21422093992685676, "mean_env_wait_ms": 0.13182306101263477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045186400413513184, "StateBufferConnector_ms": 0.003957033157348633, "ViewRequirementAgentConnector_ms": 0.12107443809509277}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.2324958666774, "num_env_steps_trained_throughput_per_sec": 446.2324958666774, "timesteps_total": 648000, "num_env_steps_sampled_lifetime": 648000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 8995.789, "restore_workers_time_ms": 0.021, "training_step_time_ms": 8995.309, "sample_time_ms": 1365.098, "learn_time_ms": 7598.039, "learn_throughput": 526.452, "synch_weights_time_ms": 29.701}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 162, "trial_id": "1f352_00000", "date": "2024-08-11_15-20-32", "timestamp": 1723404032, "time_this_iter_s": 9.015596866607666, "time_total_s": 1540.7835714817047, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c77940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1540.7835714817047, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 58.76923076923077, "ram_util_percent": 82.86153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3776663068681954, "cur_kl_coeff": 9.087677628146058e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.059029830992222, "policy_loss": -0.0016506577012478374, "vf_loss": 2.060680492098133, "vf_explained_var": 0.9443354197467367, "kl": 0.0037050238323682373, "entropy": 0.272125905752182, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3352614192912977, "cur_kl_coeff": 2.145767211914063e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.103477279034754, "policy_loss": -0.005462402408981385, "vf_loss": 2.1089396794637043, "vf_explained_var": 0.9474347485850255, "kl": 0.005842173888107094, "entropy": 0.3735588513314724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1304000, "num_agent_steps_trained": 1304000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.023885940754546, "predator_policy": -12.391282275727214}, "policy_reward_max": {"prey_policy": 12.391282275727214, "predator_policy": 54.023885940754546}, "policy_reward_mean": {"prey_policy": -17.525958096713637, "predator_policy": 17.525958096713637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-33.02420771610793, -36.16201752752957, -8.637151811763802, -39.8213191602765, -6.704715743738886, -12.73685349755652, -23.12933562428942, 9.446873071178917, -17.72756614702807, -17.21820720511427, -1.6582595429735338, -16.62967961195976, -11.337836760787331, -5.008135005152561, -12.016592615373513, -36.86338146205269, -27.353942346589307, -21.732754302051024, -34.029027972765185, -2.1540296900769107, -1.6778314364114353, -23.590570721291108, -16.352047125006873, 2.421109953066912, -25.07829683243625, -20.543370760582103, -19.721693505769256, -10.821236972908299, -12.774066030822409, -38.54174857314378, -0.0201342663484656, -14.226691039399086, -17.332405473849317, -28.886004729413543, -23.78829295004293, -34.38372967737766, -31.10960975827045, -8.010048431113832, 2.4474266139771625, -1.576436677381567, -27.185791675686826, -22.331149998144745, -18.998533745773173, -27.477712665616956, -38.0300896911207, -1.4679752474877983, -20.40461658927777, -18.643620710729454, -28.22759340333112, -24.89089869833737, -1.602939992160291, -15.741840828195905, -11.827435383413032, -8.602915840664881, 2.1261540297627484, -4.5827494805005795, 7.961857543029451, -27.173267472692366, -18.11503940424445, -29.54937379758798, -37.11116271102775, -32.19104233874772, -1.407896661061593, -22.43244877813682, -0.2743485236179648, -7.019140539097329, -1.8340109476022093, -17.542318540582304, -30.392553538554385, -28.45346955533019, -6.759725602915039, -22.818063085622622, -54.023885940754546, -18.972969703805372, -18.116906252518213, -11.8079791579735, -8.477173750390055, -23.183357077789356, -35.54869896460547, -16.41233761526619, -40.963093711595434, -17.056668698447627, -21.12160016043672, -9.835054957121066, -22.82047283614358, -24.020425749382838, 2.7318458200365843, -41.7181589024491, -30.7434569421578, -3.3353930076629545, -0.14490324956685008, 12.391282275727214, -25.531935670082593, -31.035759267244856, 5.077987676392864, -31.49573802999986, 3.707865054108355, -24.292428227307685, -26.348292870181233, -18.432566813744796], "policy_predator_policy_reward": [33.02420771610793, 36.16201752752957, 8.637151811763802, 39.8213191602765, 6.704715743738886, 12.73685349755652, 23.12933562428942, -9.446873071178917, 17.72756614702807, 17.21820720511427, 1.6582595429735338, 16.62967961195976, 11.337836760787331, 5.008135005152561, 12.016592615373513, 36.86338146205269, 27.353942346589307, 21.732754302051024, 34.029027972765185, 2.1540296900769107, 1.6778314364114353, 23.590570721291108, 16.352047125006873, -2.421109953066912, 25.07829683243625, 20.543370760582103, 19.721693505769256, 10.821236972908299, 12.774066030822409, 38.54174857314378, 0.0201342663484656, 14.226691039399086, 17.332405473849317, 28.886004729413543, 23.78829295004293, 34.38372967737766, 31.10960975827045, 8.010048431113832, -2.4474266139771625, 1.576436677381567, 27.185791675686826, 22.331149998144745, 18.998533745773173, 27.477712665616956, 38.0300896911207, 1.4679752474877983, 20.40461658927777, 18.643620710729454, 28.22759340333112, 24.89089869833737, 1.602939992160291, 15.741840828195905, 11.827435383413032, 8.602915840664881, -2.1261540297627484, 4.5827494805005795, -7.961857543029451, 27.173267472692366, 18.11503940424445, 29.54937379758798, 37.11116271102775, 32.19104233874772, 1.407896661061593, 22.43244877813682, 0.2743485236179648, 7.019140539097329, 1.8340109476022093, 17.542318540582304, 30.392553538554385, 28.45346955533019, 6.759725602915039, 22.818063085622622, 54.023885940754546, 18.972969703805372, 18.116906252518213, 11.8079791579735, 8.477173750390055, 23.183357077789356, 35.54869896460547, 16.41233761526619, 40.963093711595434, 17.056668698447627, 21.12160016043672, 9.835054957121066, 22.82047283614358, 24.020425749382838, -2.7318458200365843, 41.7181589024491, 30.7434569421578, 3.3353930076629545, 0.14490324956685008, -12.391282275727214, 25.531935670082593, 31.035759267244856, -5.077987676392864, 31.49573802999986, -3.707865054108355, 24.292428227307685, 26.348292870181233, 18.432566813744796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5024409597645384, "mean_inference_ms": 1.742477410512081, "mean_action_processing_ms": 0.21425674506114448, "mean_env_wait_ms": 0.13183441165187193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045134782791137695, "StateBufferConnector_ms": 0.005410194396972656, "ViewRequirementAgentConnector_ms": 0.12236166000366211}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1304000, "num_agent_steps_trained": 1304000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 476.49600195265134, "num_env_steps_trained_throughput_per_sec": 476.49600195265134, "timesteps_total": 652000, "num_env_steps_sampled_lifetime": 652000, "num_agent_steps_sampled_lifetime": 1304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1304000, "timers": {"training_iteration_time_ms": 8878.201, "restore_workers_time_ms": 0.021, "training_step_time_ms": 8877.782, "sample_time_ms": 1349.776, "learn_time_ms": 7495.835, "learn_throughput": 533.63, "synch_weights_time_ms": 29.829}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1304000, "num_agent_steps_trained": 1304000}, "done": false, "training_iteration": 163, "trial_id": "1f352_00000", "date": "2024-08-11_15-20-40", "timestamp": 1723404040, "time_this_iter_s": 8.465490102767944, "time_total_s": 1549.2490615844727, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c890d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1549.2490615844727, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 55.1, "ram_util_percent": 82.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1305313407133024, "cur_kl_coeff": 4.543838814073029e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.333459626759092, "policy_loss": -0.0026046850990193585, "vf_loss": 2.336064316953222, "vf_explained_var": 0.8741271002218127, "kl": 0.002782657682586758, "entropy": 0.23812312982045114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0826550856853525, "cur_kl_coeff": 2.145767211914063e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.360847557087739, "policy_loss": -0.005984252764998625, "vf_loss": 2.3668318116416533, "vf_explained_var": 0.880504421889782, "kl": 0.010641789143190524, "entropy": 0.3735048446804285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.023885940754546, "predator_policy": -16.801867854742085}, "policy_reward_max": {"prey_policy": 16.801867854742085, "predator_policy": 54.023885940754546}, "policy_reward_mean": {"prey_policy": -17.37038513808037, "predator_policy": 17.37038513808037}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.421109953066912, -25.07829683243625, -20.543370760582103, -19.721693505769256, -10.821236972908299, -12.774066030822409, -38.54174857314378, -0.0201342663484656, -14.226691039399086, -17.332405473849317, -28.886004729413543, -23.78829295004293, -34.38372967737766, -31.10960975827045, -8.010048431113832, 2.4474266139771625, -1.576436677381567, -27.185791675686826, -22.331149998144745, -18.998533745773173, -27.477712665616956, -38.0300896911207, -1.4679752474877983, -20.40461658927777, -18.643620710729454, -28.22759340333112, -24.89089869833737, -1.602939992160291, -15.741840828195905, -11.827435383413032, -8.602915840664881, 2.1261540297627484, -4.5827494805005795, 7.961857543029451, -27.173267472692366, -18.11503940424445, -29.54937379758798, -37.11116271102775, -32.19104233874772, -1.407896661061593, -22.43244877813682, -0.2743485236179648, -7.019140539097329, -1.8340109476022093, -17.542318540582304, -30.392553538554385, -28.45346955533019, -6.759725602915039, -22.818063085622622, -54.023885940754546, -18.972969703805372, -18.116906252518213, -11.8079791579735, -8.477173750390055, -23.183357077789356, -35.54869896460547, -16.41233761526619, -40.963093711595434, -17.056668698447627, -21.12160016043672, -9.835054957121066, -22.82047283614358, -24.020425749382838, 2.7318458200365843, -41.7181589024491, -30.7434569421578, -3.3353930076629545, -0.14490324956685008, 12.391282275727214, -25.531935670082593, -31.035759267244856, 5.077987676392864, -31.49573802999986, 3.707865054108355, -24.292428227307685, -26.348292870181233, -18.432566813744796, -15.979719179292122, -22.03000628818969, -50.03487071933007, -25.32524532934517, -30.67787875607033, 1.6469005733113224, 16.801867854742085, -31.00046586981596, -25.96045279329182, -10.918749751171294, 7.3121922386368965, -21.75078354327006, -6.329520900557514, -34.002301358093625, -25.528859756510016, -21.748188902374174, -4.513346364193524, -16.168310046857865, -8.572042446317496, -3.891232814225094, -32.76662805902785, -2.88476546256282, -16.238886417584197], "policy_predator_policy_reward": [-2.421109953066912, 25.07829683243625, 20.543370760582103, 19.721693505769256, 10.821236972908299, 12.774066030822409, 38.54174857314378, 0.0201342663484656, 14.226691039399086, 17.332405473849317, 28.886004729413543, 23.78829295004293, 34.38372967737766, 31.10960975827045, 8.010048431113832, -2.4474266139771625, 1.576436677381567, 27.185791675686826, 22.331149998144745, 18.998533745773173, 27.477712665616956, 38.0300896911207, 1.4679752474877983, 20.40461658927777, 18.643620710729454, 28.22759340333112, 24.89089869833737, 1.602939992160291, 15.741840828195905, 11.827435383413032, 8.602915840664881, -2.1261540297627484, 4.5827494805005795, -7.961857543029451, 27.173267472692366, 18.11503940424445, 29.54937379758798, 37.11116271102775, 32.19104233874772, 1.407896661061593, 22.43244877813682, 0.2743485236179648, 7.019140539097329, 1.8340109476022093, 17.542318540582304, 30.392553538554385, 28.45346955533019, 6.759725602915039, 22.818063085622622, 54.023885940754546, 18.972969703805372, 18.116906252518213, 11.8079791579735, 8.477173750390055, 23.183357077789356, 35.54869896460547, 16.41233761526619, 40.963093711595434, 17.056668698447627, 21.12160016043672, 9.835054957121066, 22.82047283614358, 24.020425749382838, -2.7318458200365843, 41.7181589024491, 30.7434569421578, 3.3353930076629545, 0.14490324956685008, -12.391282275727214, 25.531935670082593, 31.035759267244856, -5.077987676392864, 31.49573802999986, -3.707865054108355, 24.292428227307685, 26.348292870181233, 18.432566813744796, 15.979719179292122, 22.03000628818969, 50.03487071933007, 25.32524532934517, 30.67787875607033, -1.6469005733113224, -16.801867854742085, 31.00046586981596, 25.96045279329182, 10.918749751171294, -7.3121922386368965, 21.75078354327006, 6.329520900557514, 34.002301358093625, 25.528859756510016, 21.748188902374174, 4.513346364193524, 16.168310046857865, 8.572042446317496, 3.891232814225094, 32.76662805902785, 2.88476546256282, 16.238886417584197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5039536784880458, "mean_inference_ms": 1.7468418019632046, "mean_action_processing_ms": 0.2148192239910896, "mean_env_wait_ms": 0.13214590605996654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04477524757385254, "StateBufferConnector_ms": 0.005515575408935547, "ViewRequirementAgentConnector_ms": 0.12765014171600342}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 407.1954591191653, "num_env_steps_trained_throughput_per_sec": 407.1954591191653, "timesteps_total": 656000, "num_env_steps_sampled_lifetime": 656000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 8933.435, "restore_workers_time_ms": 0.02, "training_step_time_ms": 8933.031, "sample_time_ms": 1408.706, "learn_time_ms": 7498.767, "learn_throughput": 533.421, "synch_weights_time_ms": 23.065}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 164, "trial_id": "1f352_00000", "date": "2024-08-11_15-20-50", "timestamp": 1723404050, "time_this_iter_s": 9.872701168060303, "time_total_s": 1559.121762752533, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c89ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1559.121762752533, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 58.55000000000001, "ram_util_percent": 83.07857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2628646733860176, "cur_kl_coeff": 2.2719194070365146e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.648642605791489, "policy_loss": -0.00044454741679752867, "vf_loss": 2.6490871498982114, "vf_explained_var": 0.9101408108447989, "kl": 0.002793436763095856, "entropy": 0.2520508576417342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 157920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.234436792259415, "cur_kl_coeff": 2.145767211914063e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7310201402753593, "policy_loss": -0.0061746023947004385, "vf_loss": 2.7371947441250084, "vf_explained_var": 0.9129687794173758, "kl": 0.00817967245479111, "entropy": 0.3881446322736641, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 157920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.023885940754546, "predator_policy": -16.801867854742085}, "policy_reward_max": {"prey_policy": 16.801867854742085, "predator_policy": 54.023885940754546}, "policy_reward_mean": {"prey_policy": -16.810077310699242, "predator_policy": 16.810077310699242}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1.4679752474877983, -20.40461658927777, -18.643620710729454, -28.22759340333112, -24.89089869833737, -1.602939992160291, -15.741840828195905, -11.827435383413032, -8.602915840664881, 2.1261540297627484, -4.5827494805005795, 7.961857543029451, -27.173267472692366, -18.11503940424445, -29.54937379758798, -37.11116271102775, -32.19104233874772, -1.407896661061593, -22.43244877813682, -0.2743485236179648, -7.019140539097329, -1.8340109476022093, -17.542318540582304, -30.392553538554385, -28.45346955533019, -6.759725602915039, -22.818063085622622, -54.023885940754546, -18.972969703805372, -18.116906252518213, -11.8079791579735, -8.477173750390055, -23.183357077789356, -35.54869896460547, -16.41233761526619, -40.963093711595434, -17.056668698447627, -21.12160016043672, -9.835054957121066, -22.82047283614358, -24.020425749382838, 2.7318458200365843, -41.7181589024491, -30.7434569421578, -3.3353930076629545, -0.14490324956685008, 12.391282275727214, -25.531935670082593, -31.035759267244856, 5.077987676392864, -31.49573802999986, 3.707865054108355, -24.292428227307685, -26.348292870181233, -18.432566813744796, -15.979719179292122, -22.03000628818969, -50.03487071933007, -25.32524532934517, -30.67787875607033, 1.6469005733113224, 16.801867854742085, -31.00046586981596, -25.96045279329182, -10.918749751171294, 7.3121922386368965, -21.75078354327006, -6.329520900557514, -34.002301358093625, -25.528859756510016, -21.748188902374174, -4.513346364193524, -16.168310046857865, -8.572042446317496, -3.891232814225094, -32.76662805902785, -2.88476546256282, -16.238886417584197, -12.293273086772494, -4.886269294513623, -28.45562911859055, -10.973914344938827, -6.934878081267179, 5.908600340733647, -12.401394179353789, -17.587344761035737, -25.647702918319304, -18.54215188616153, -37.85464345864252, -8.089732966730002, -23.86446656987561, -32.89175039218982, 3.8517550568866348, -40.071930976167096, -5.437968492705037, -18.77951178608988, -7.508058935601589, -6.231984748431002, -6.218878675217427, -45.02659487506179], "policy_predator_policy_reward": [1.4679752474877983, 20.40461658927777, 18.643620710729454, 28.22759340333112, 24.89089869833737, 1.602939992160291, 15.741840828195905, 11.827435383413032, 8.602915840664881, -2.1261540297627484, 4.5827494805005795, -7.961857543029451, 27.173267472692366, 18.11503940424445, 29.54937379758798, 37.11116271102775, 32.19104233874772, 1.407896661061593, 22.43244877813682, 0.2743485236179648, 7.019140539097329, 1.8340109476022093, 17.542318540582304, 30.392553538554385, 28.45346955533019, 6.759725602915039, 22.818063085622622, 54.023885940754546, 18.972969703805372, 18.116906252518213, 11.8079791579735, 8.477173750390055, 23.183357077789356, 35.54869896460547, 16.41233761526619, 40.963093711595434, 17.056668698447627, 21.12160016043672, 9.835054957121066, 22.82047283614358, 24.020425749382838, -2.7318458200365843, 41.7181589024491, 30.7434569421578, 3.3353930076629545, 0.14490324956685008, -12.391282275727214, 25.531935670082593, 31.035759267244856, -5.077987676392864, 31.49573802999986, -3.707865054108355, 24.292428227307685, 26.348292870181233, 18.432566813744796, 15.979719179292122, 22.03000628818969, 50.03487071933007, 25.32524532934517, 30.67787875607033, -1.6469005733113224, -16.801867854742085, 31.00046586981596, 25.96045279329182, 10.918749751171294, -7.3121922386368965, 21.75078354327006, 6.329520900557514, 34.002301358093625, 25.528859756510016, 21.748188902374174, 4.513346364193524, 16.168310046857865, 8.572042446317496, 3.891232814225094, 32.76662805902785, 2.88476546256282, 16.238886417584197, 12.293273086772494, 4.886269294513623, 28.45562911859055, 10.973914344938827, 6.934878081267179, -5.908600340733647, 12.401394179353789, 17.587344761035737, 25.647702918319304, 18.54215188616153, 37.85464345864252, 8.089732966730002, 23.86446656987561, 32.89175039218982, -3.8517550568866348, 40.071930976167096, 5.437968492705037, 18.77951178608988, 7.508058935601589, 6.231984748431002, 6.218878675217427, 45.02659487506179]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5030908284917764, "mean_inference_ms": 1.7451303196977808, "mean_action_processing_ms": 0.21451629341328843, "mean_env_wait_ms": 0.13217172501938548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003723740577697754, "StateBufferConnector_ms": 0.005994439125061035, "ViewRequirementAgentConnector_ms": 0.08879673480987549}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.07028946066276, "num_env_steps_trained_throughput_per_sec": 487.07028946066276, "timesteps_total": 660000, "num_env_steps_sampled_lifetime": 660000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 8870.729, "restore_workers_time_ms": 0.02, "training_step_time_ms": 8870.555, "sample_time_ms": 1445.635, "learn_time_ms": 7402.5, "learn_throughput": 540.358, "synch_weights_time_ms": 20.355}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 165, "trial_id": "1f352_00000", "date": "2024-08-11_15-20-58", "timestamp": 1723404058, "time_this_iter_s": 8.263213872909546, "time_total_s": 1567.3849766254425, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c89040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1567.3849766254425, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 50.82727272727273, "ram_util_percent": 82.2090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2204566755021613, "cur_kl_coeff": 1.1359597035182573e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6693713239704568, "policy_loss": -0.005407611376479811, "vf_loss": 1.6747789355615774, "vf_explained_var": 0.9312529994174839, "kl": 0.0035001651083582403, "entropy": 0.21276824499169986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 158880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1089829061180354, "cur_kl_coeff": 2.145767211914063e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7502853364994129, "policy_loss": -0.0016936267818285463, "vf_loss": 1.7519789670904478, "vf_explained_var": 0.9329360812902451, "kl": 0.003672792611835385, "entropy": 0.3463215672721465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 158880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -54.023885940754546, "predator_policy": -16.801867854742085}, "policy_reward_max": {"prey_policy": 16.801867854742085, "predator_policy": 54.023885940754546}, "policy_reward_mean": {"prey_policy": -16.900885557948467, "predator_policy": 16.900885557948467}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.43244877813682, -0.2743485236179648, -7.019140539097329, -1.8340109476022093, -17.542318540582304, -30.392553538554385, -28.45346955533019, -6.759725602915039, -22.818063085622622, -54.023885940754546, -18.972969703805372, -18.116906252518213, -11.8079791579735, -8.477173750390055, -23.183357077789356, -35.54869896460547, -16.41233761526619, -40.963093711595434, -17.056668698447627, -21.12160016043672, -9.835054957121066, -22.82047283614358, -24.020425749382838, 2.7318458200365843, -41.7181589024491, -30.7434569421578, -3.3353930076629545, -0.14490324956685008, 12.391282275727214, -25.531935670082593, -31.035759267244856, 5.077987676392864, -31.49573802999986, 3.707865054108355, -24.292428227307685, -26.348292870181233, -18.432566813744796, -15.979719179292122, -22.03000628818969, -50.03487071933007, -25.32524532934517, -30.67787875607033, 1.6469005733113224, 16.801867854742085, -31.00046586981596, -25.96045279329182, -10.918749751171294, 7.3121922386368965, -21.75078354327006, -6.329520900557514, -34.002301358093625, -25.528859756510016, -21.748188902374174, -4.513346364193524, -16.168310046857865, -8.572042446317496, -3.891232814225094, -32.76662805902785, -2.88476546256282, -16.238886417584197, -12.293273086772494, -4.886269294513623, -28.45562911859055, -10.973914344938827, -6.934878081267179, 5.908600340733647, -12.401394179353789, -17.587344761035737, -25.647702918319304, -18.54215188616153, -37.85464345864252, -8.089732966730002, -23.86446656987561, -32.89175039218982, 3.8517550568866348, -40.071930976167096, -5.437968492705037, -18.77951178608988, -7.508058935601589, -6.231984748431002, -6.218878675217427, -45.02659487506179, -16.017689081130257, 1.6452458006530226, -9.75628401440633, 1.8951188419113993, -25.43500371250854, -20.987375718254633, -27.945920254471083, 0.6454744929465441, -11.496944089212628, -9.468099528403052, -46.77930365165551, -12.393784654006573, -24.596476510353313, -15.175400890095165, 6.232241926903821, -18.211059636976962, -30.974693670605415, -21.713227361925597], "policy_predator_policy_reward": [22.43244877813682, 0.2743485236179648, 7.019140539097329, 1.8340109476022093, 17.542318540582304, 30.392553538554385, 28.45346955533019, 6.759725602915039, 22.818063085622622, 54.023885940754546, 18.972969703805372, 18.116906252518213, 11.8079791579735, 8.477173750390055, 23.183357077789356, 35.54869896460547, 16.41233761526619, 40.963093711595434, 17.056668698447627, 21.12160016043672, 9.835054957121066, 22.82047283614358, 24.020425749382838, -2.7318458200365843, 41.7181589024491, 30.7434569421578, 3.3353930076629545, 0.14490324956685008, -12.391282275727214, 25.531935670082593, 31.035759267244856, -5.077987676392864, 31.49573802999986, -3.707865054108355, 24.292428227307685, 26.348292870181233, 18.432566813744796, 15.979719179292122, 22.03000628818969, 50.03487071933007, 25.32524532934517, 30.67787875607033, -1.6469005733113224, -16.801867854742085, 31.00046586981596, 25.96045279329182, 10.918749751171294, -7.3121922386368965, 21.75078354327006, 6.329520900557514, 34.002301358093625, 25.528859756510016, 21.748188902374174, 4.513346364193524, 16.168310046857865, 8.572042446317496, 3.891232814225094, 32.76662805902785, 2.88476546256282, 16.238886417584197, 12.293273086772494, 4.886269294513623, 28.45562911859055, 10.973914344938827, 6.934878081267179, -5.908600340733647, 12.401394179353789, 17.587344761035737, 25.647702918319304, 18.54215188616153, 37.85464345864252, 8.089732966730002, 23.86446656987561, 32.89175039218982, -3.8517550568866348, 40.071930976167096, 5.437968492705037, 18.77951178608988, 7.508058935601589, 6.231984748431002, 6.218878675217427, 45.02659487506179, 16.017689081130257, -1.6452458006530226, 9.75628401440633, -1.8951188419113993, 25.43500371250854, 20.987375718254633, 27.945920254471083, -0.6454744929465441, 11.496944089212628, 9.468099528403052, 46.77930365165551, 12.393784654006573, 24.596476510353313, 15.175400890095165, -6.232241926903821, 18.211059636976962, 30.974693670605415, 21.713227361925597]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5032094717111963, "mean_inference_ms": 1.7459439925080715, "mean_action_processing_ms": 0.21458101828506457, "mean_env_wait_ms": 0.13229159885918282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037006139755249023, "StateBufferConnector_ms": 0.006078958511352539, "ViewRequirementAgentConnector_ms": 0.0916513204574585}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 461.710576445815, "num_env_steps_trained_throughput_per_sec": 461.710576445815, "timesteps_total": 664000, "num_env_steps_sampled_lifetime": 664000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 8832.607, "restore_workers_time_ms": 0.019, "training_step_time_ms": 8832.435, "sample_time_ms": 1414.831, "learn_time_ms": 7396.916, "learn_throughput": 540.766, "synch_weights_time_ms": 19.34}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 166, "trial_id": "1f352_00000", "date": "2024-08-11_15-21-07", "timestamp": 1723404067, "time_this_iter_s": 8.753481149673462, "time_total_s": 1576.138457775116, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1acbf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1576.138457775116, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 51.900000000000006, "ram_util_percent": 82.45384615384616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3908528786152603, "cur_kl_coeff": 5.6797985175912865e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.377526762895286, "policy_loss": -0.00492468291001084, "vf_loss": 2.382451445236802, "vf_explained_var": 0.8949285260091225, "kl": 0.005020294294154002, "entropy": 0.17321246434779217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 159840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.283741776831448, "cur_kl_coeff": 1.0728836059570315e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3466971132283407, "policy_loss": -0.0009434185975502866, "vf_loss": 2.34764053132385, "vf_explained_var": 0.904272279329598, "kl": 0.004979697697286139, "entropy": 0.39039099688331286, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 159840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 1336000, "num_agent_steps_trained": 1336000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.03487071933007, "predator_policy": -16.801867854742085}, "policy_reward_max": {"prey_policy": 16.801867854742085, "predator_policy": 50.03487071933007}, "policy_reward_mean": {"prey_policy": -16.07906685490512, "predator_policy": 16.07906685490512}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.056668698447627, -21.12160016043672, -9.835054957121066, -22.82047283614358, -24.020425749382838, 2.7318458200365843, -41.7181589024491, -30.7434569421578, -3.3353930076629545, -0.14490324956685008, 12.391282275727214, -25.531935670082593, -31.035759267244856, 5.077987676392864, -31.49573802999986, 3.707865054108355, -24.292428227307685, -26.348292870181233, -18.432566813744796, -15.979719179292122, -22.03000628818969, -50.03487071933007, -25.32524532934517, -30.67787875607033, 1.6469005733113224, 16.801867854742085, -31.00046586981596, -25.96045279329182, -10.918749751171294, 7.3121922386368965, -21.75078354327006, -6.329520900557514, -34.002301358093625, -25.528859756510016, -21.748188902374174, -4.513346364193524, -16.168310046857865, -8.572042446317496, -3.891232814225094, -32.76662805902785, -2.88476546256282, -16.238886417584197, -12.293273086772494, -4.886269294513623, -28.45562911859055, -10.973914344938827, -6.934878081267179, 5.908600340733647, -12.401394179353789, -17.587344761035737, -25.647702918319304, -18.54215188616153, -37.85464345864252, -8.089732966730002, -23.86446656987561, -32.89175039218982, 3.8517550568866348, -40.071930976167096, -5.437968492705037, -18.77951178608988, -7.508058935601589, -6.231984748431002, -6.218878675217427, -45.02659487506179, -16.017689081130257, 1.6452458006530226, -9.75628401440633, 1.8951188419113993, -25.43500371250854, -20.987375718254633, -27.945920254471083, 0.6454744929465441, -11.496944089212628, -9.468099528403052, -46.77930365165551, -12.393784654006573, -24.596476510353313, -15.175400890095165, 6.232241926903821, -18.211059636976962, -30.974693670605415, -21.713227361925597, -30.957125927878153, -6.980181037166227, -14.300606997548938, -20.140028793869725, -41.70324758104291, -22.493638039788124, -32.54662433978849, -15.06121515447189, -17.139293532311513, 0.9555036650851871, -0.5886606919302437, -2.638625037052954, -7.374924608157494, -21.41907068684648, 3.8083381350722165, -30.647101202640094, -0.6833207800512859, -22.94078837143521], "policy_predator_policy_reward": [17.056668698447627, 21.12160016043672, 9.835054957121066, 22.82047283614358, 24.020425749382838, -2.7318458200365843, 41.7181589024491, 30.7434569421578, 3.3353930076629545, 0.14490324956685008, -12.391282275727214, 25.531935670082593, 31.035759267244856, -5.077987676392864, 31.49573802999986, -3.707865054108355, 24.292428227307685, 26.348292870181233, 18.432566813744796, 15.979719179292122, 22.03000628818969, 50.03487071933007, 25.32524532934517, 30.67787875607033, -1.6469005733113224, -16.801867854742085, 31.00046586981596, 25.96045279329182, 10.918749751171294, -7.3121922386368965, 21.75078354327006, 6.329520900557514, 34.002301358093625, 25.528859756510016, 21.748188902374174, 4.513346364193524, 16.168310046857865, 8.572042446317496, 3.891232814225094, 32.76662805902785, 2.88476546256282, 16.238886417584197, 12.293273086772494, 4.886269294513623, 28.45562911859055, 10.973914344938827, 6.934878081267179, -5.908600340733647, 12.401394179353789, 17.587344761035737, 25.647702918319304, 18.54215188616153, 37.85464345864252, 8.089732966730002, 23.86446656987561, 32.89175039218982, -3.8517550568866348, 40.071930976167096, 5.437968492705037, 18.77951178608988, 7.508058935601589, 6.231984748431002, 6.218878675217427, 45.02659487506179, 16.017689081130257, -1.6452458006530226, 9.75628401440633, -1.8951188419113993, 25.43500371250854, 20.987375718254633, 27.945920254471083, -0.6454744929465441, 11.496944089212628, 9.468099528403052, 46.77930365165551, 12.393784654006573, 24.596476510353313, 15.175400890095165, -6.232241926903821, 18.211059636976962, 30.974693670605415, 21.713227361925597, 30.957125927878153, 6.980181037166227, 14.300606997548938, 20.140028793869725, 41.70324758104291, 22.493638039788124, 32.54662433978849, 15.06121515447189, 17.139293532311513, -0.9555036650851871, 0.5886606919302437, 2.638625037052954, 7.374924608157494, 21.41907068684648, -3.8083381350722165, 30.647101202640094, 0.6833207800512859, 22.94078837143521]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5033337951732277, "mean_inference_ms": 1.7468363620992369, "mean_action_processing_ms": 0.2146859351973635, "mean_env_wait_ms": 0.1324243606811183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037778615951538086, "StateBufferConnector_ms": 0.006104230880737305, "ViewRequirementAgentConnector_ms": 0.09466898441314697}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1336000, "num_agent_steps_trained": 1336000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 437.0966671241572, "num_env_steps_trained_throughput_per_sec": 437.0966671241572, "timesteps_total": 668000, "num_env_steps_sampled_lifetime": 668000, "num_agent_steps_sampled_lifetime": 1336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1336000, "timers": {"training_iteration_time_ms": 8855.8, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8855.627, "sample_time_ms": 1370.043, "learn_time_ms": 7464.879, "learn_throughput": 535.843, "synch_weights_time_ms": 19.408}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 1336000, "num_agent_steps_trained": 1336000}, "done": false, "training_iteration": 167, "trial_id": "1f352_00000", "date": "2024-08-11_15-21-16", "timestamp": 1723404076, "time_this_iter_s": 9.165668964385986, "time_total_s": 1585.304126739502, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c36310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1585.304126739502, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 53.423076923076934, "ram_util_percent": 82.62307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.511657732476791, "cur_kl_coeff": 5.6797985175912865e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2282711004217464, "policy_loss": 0.00022219929475492489, "vf_loss": 2.22804889852802, "vf_explained_var": 0.9260614483927687, "kl": 0.0018543896946584888, "entropy": 0.22992047966302684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.389458939495186, "cur_kl_coeff": 5.364418029785158e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.328732116520405, "policy_loss": -0.0031709663805183177, "vf_loss": 2.331903075426817, "vf_explained_var": 0.9253780119121074, "kl": 0.005171625808787539, "entropy": 0.3991079731844366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.03487071933007, "predator_policy": -16.801867854742085}, "policy_reward_max": {"prey_policy": 16.801867854742085, "predator_policy": 50.03487071933007}, "policy_reward_mean": {"prey_policy": -15.145764347140787, "predator_policy": 15.145764347140787}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.432566813744796, -15.979719179292122, -22.03000628818969, -50.03487071933007, -25.32524532934517, -30.67787875607033, 1.6469005733113224, 16.801867854742085, -31.00046586981596, -25.96045279329182, -10.918749751171294, 7.3121922386368965, -21.75078354327006, -6.329520900557514, -34.002301358093625, -25.528859756510016, -21.748188902374174, -4.513346364193524, -16.168310046857865, -8.572042446317496, -3.891232814225094, -32.76662805902785, -2.88476546256282, -16.238886417584197, -12.293273086772494, -4.886269294513623, -28.45562911859055, -10.973914344938827, -6.934878081267179, 5.908600340733647, -12.401394179353789, -17.587344761035737, -25.647702918319304, -18.54215188616153, -37.85464345864252, -8.089732966730002, -23.86446656987561, -32.89175039218982, 3.8517550568866348, -40.071930976167096, -5.437968492705037, -18.77951178608988, -7.508058935601589, -6.231984748431002, -6.218878675217427, -45.02659487506179, -16.017689081130257, 1.6452458006530226, -9.75628401440633, 1.8951188419113993, -25.43500371250854, -20.987375718254633, -27.945920254471083, 0.6454744929465441, -11.496944089212628, -9.468099528403052, -46.77930365165551, -12.393784654006573, -24.596476510353313, -15.175400890095165, 6.232241926903821, -18.211059636976962, -30.974693670605415, -21.713227361925597, -30.957125927878153, -6.980181037166227, -14.300606997548938, -20.140028793869725, -41.70324758104291, -22.493638039788124, -32.54662433978849, -15.06121515447189, -17.139293532311513, 0.9555036650851871, -0.5886606919302437, -2.638625037052954, -7.374924608157494, -21.41907068684648, 3.8083381350722165, -30.647101202640094, -0.6833207800512859, -22.94078837143521, 1.8836829295539488, -22.102813085699687, -25.955022963067783, -8.619532294599166, -8.546800220854058, -21.925307071230716, -3.4919677126326008, -20.636009484492135, 2.4341023374879054, -19.97177339078902, -14.848361976517403, 9.159370210043427, -2.950521804132812, -4.12009344760402, 8.762990991152263, -19.870904509805374, -20.916597318916928, -20.545498153382113], "policy_predator_policy_reward": [18.432566813744796, 15.979719179292122, 22.03000628818969, 50.03487071933007, 25.32524532934517, 30.67787875607033, -1.6469005733113224, -16.801867854742085, 31.00046586981596, 25.96045279329182, 10.918749751171294, -7.3121922386368965, 21.75078354327006, 6.329520900557514, 34.002301358093625, 25.528859756510016, 21.748188902374174, 4.513346364193524, 16.168310046857865, 8.572042446317496, 3.891232814225094, 32.76662805902785, 2.88476546256282, 16.238886417584197, 12.293273086772494, 4.886269294513623, 28.45562911859055, 10.973914344938827, 6.934878081267179, -5.908600340733647, 12.401394179353789, 17.587344761035737, 25.647702918319304, 18.54215188616153, 37.85464345864252, 8.089732966730002, 23.86446656987561, 32.89175039218982, -3.8517550568866348, 40.071930976167096, 5.437968492705037, 18.77951178608988, 7.508058935601589, 6.231984748431002, 6.218878675217427, 45.02659487506179, 16.017689081130257, -1.6452458006530226, 9.75628401440633, -1.8951188419113993, 25.43500371250854, 20.987375718254633, 27.945920254471083, -0.6454744929465441, 11.496944089212628, 9.468099528403052, 46.77930365165551, 12.393784654006573, 24.596476510353313, 15.175400890095165, -6.232241926903821, 18.211059636976962, 30.974693670605415, 21.713227361925597, 30.957125927878153, 6.980181037166227, 14.300606997548938, 20.140028793869725, 41.70324758104291, 22.493638039788124, 32.54662433978849, 15.06121515447189, 17.139293532311513, -0.9555036650851871, 0.5886606919302437, 2.638625037052954, 7.374924608157494, 21.41907068684648, -3.8083381350722165, 30.647101202640094, 0.6833207800512859, 22.94078837143521, -1.8836829295539488, 22.102813085699687, 25.955022963067783, 8.619532294599166, 8.546800220854058, 21.925307071230716, 3.4919677126326008, 20.636009484492135, -2.4341023374879054, 19.97177339078902, 14.848361976517403, -9.159370210043427, 2.950521804132812, 4.12009344760402, -8.762990991152263, 19.870904509805374, 20.916597318916928, 20.545498153382113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5033873242465526, "mean_inference_ms": 1.7475772158248, "mean_action_processing_ms": 0.21476145133912605, "mean_env_wait_ms": 0.13253769460526066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003985881805419922, "StateBufferConnector_ms": 0.004662871360778809, "ViewRequirementAgentConnector_ms": 0.09602391719818115}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.0632221372131, "num_env_steps_trained_throughput_per_sec": 417.0632221372131, "timesteps_total": 672000, "num_env_steps_sampled_lifetime": 672000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 8995.473, "restore_workers_time_ms": 0.022, "training_step_time_ms": 8995.292, "sample_time_ms": 1369.494, "learn_time_ms": 7602.141, "learn_throughput": 526.168, "synch_weights_time_ms": 22.329}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 168, "trial_id": "1f352_00000", "date": "2024-08-11_15-21-26", "timestamp": 1723404086, "time_this_iter_s": 9.79357385635376, "time_total_s": 1595.0977005958557, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1db9dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1595.0977005958557, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 55.95, "ram_util_percent": 82.68571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2257125129302344, "cur_kl_coeff": 2.8398992587956433e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.237736489251256, "policy_loss": -0.0026966006014845336, "vf_loss": 2.240433088193337, "vf_explained_var": 0.9152463157350819, "kl": 0.006502046358527242, "entropy": 0.22202419838868082, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 161760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1438191581517456, "cur_kl_coeff": 5.364418029785158e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2424170380458235, "policy_loss": -0.004878974626869119, "vf_loss": 2.2472960259765387, "vf_explained_var": 0.9198711728677154, "kl": 0.006745362431156454, "entropy": 0.3638644909175734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 161760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 1352000, "num_agent_steps_trained": 1352000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.77930365165551, "predator_policy": -9.159370210043427}, "policy_reward_max": {"prey_policy": 9.159370210043427, "predator_policy": 46.77930365165551}, "policy_reward_mean": {"prey_policy": -17.15267007854988, "predator_policy": 17.15267007854988}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.973914344938827, -6.934878081267179, 5.908600340733647, -12.401394179353789, -17.587344761035737, -25.647702918319304, -18.54215188616153, -37.85464345864252, -8.089732966730002, -23.86446656987561, -32.89175039218982, 3.8517550568866348, -40.071930976167096, -5.437968492705037, -18.77951178608988, -7.508058935601589, -6.231984748431002, -6.218878675217427, -45.02659487506179, -16.017689081130257, 1.6452458006530226, -9.75628401440633, 1.8951188419113993, -25.43500371250854, -20.987375718254633, -27.945920254471083, 0.6454744929465441, -11.496944089212628, -9.468099528403052, -46.77930365165551, -12.393784654006573, -24.596476510353313, -15.175400890095165, 6.232241926903821, -18.211059636976962, -30.974693670605415, -21.713227361925597, -30.957125927878153, -6.980181037166227, -14.300606997548938, -20.140028793869725, -41.70324758104291, -22.493638039788124, -32.54662433978849, -15.06121515447189, -17.139293532311513, 0.9555036650851871, -0.5886606919302437, -2.638625037052954, -7.374924608157494, -21.41907068684648, 3.8083381350722165, -30.647101202640094, -0.6833207800512859, -22.94078837143521, 1.8836829295539488, -22.102813085699687, -25.955022963067783, -8.619532294599166, -8.546800220854058, -21.925307071230716, -3.4919677126326008, -20.636009484492135, 2.4341023374879054, -19.97177339078902, -14.848361976517403, 9.159370210043427, -2.950521804132812, -4.12009344760402, 8.762990991152263, -19.870904509805374, -20.916597318916928, -20.545498153382113, -28.860472159808833, -36.7694094207851, -18.14142589168707, -34.14379609716865, -36.051838850235946, -11.821784210084626, -17.18306319306091, -3.30116060936726, -13.829480906988948, -17.88956850867494, -3.575012223294591, -20.44129713782704, -35.65559491320863, -18.478907398195215, -37.70101848872697, -29.442215585717115, -44.54546859755137, -22.84255405188522, -34.2683622898511, -32.64722941949413, -18.46553657490859, -27.98454357851351, -29.700569006158148, -24.12733461347627, -19.52465665805267, -28.517144133996055, 0.589838972797935], "policy_predator_policy_reward": [10.973914344938827, 6.934878081267179, -5.908600340733647, 12.401394179353789, 17.587344761035737, 25.647702918319304, 18.54215188616153, 37.85464345864252, 8.089732966730002, 23.86446656987561, 32.89175039218982, -3.8517550568866348, 40.071930976167096, 5.437968492705037, 18.77951178608988, 7.508058935601589, 6.231984748431002, 6.218878675217427, 45.02659487506179, 16.017689081130257, -1.6452458006530226, 9.75628401440633, -1.8951188419113993, 25.43500371250854, 20.987375718254633, 27.945920254471083, -0.6454744929465441, 11.496944089212628, 9.468099528403052, 46.77930365165551, 12.393784654006573, 24.596476510353313, 15.175400890095165, -6.232241926903821, 18.211059636976962, 30.974693670605415, 21.713227361925597, 30.957125927878153, 6.980181037166227, 14.300606997548938, 20.140028793869725, 41.70324758104291, 22.493638039788124, 32.54662433978849, 15.06121515447189, 17.139293532311513, -0.9555036650851871, 0.5886606919302437, 2.638625037052954, 7.374924608157494, 21.41907068684648, -3.8083381350722165, 30.647101202640094, 0.6833207800512859, 22.94078837143521, -1.8836829295539488, 22.102813085699687, 25.955022963067783, 8.619532294599166, 8.546800220854058, 21.925307071230716, 3.4919677126326008, 20.636009484492135, -2.4341023374879054, 19.97177339078902, 14.848361976517403, -9.159370210043427, 2.950521804132812, 4.12009344760402, -8.762990991152263, 19.870904509805374, 20.916597318916928, 20.545498153382113, 28.860472159808833, 36.7694094207851, 18.14142589168707, 34.14379609716865, 36.051838850235946, 11.821784210084626, 17.18306319306091, 3.30116060936726, 13.829480906988948, 17.88956850867494, 3.575012223294591, 20.44129713782704, 35.65559491320863, 18.478907398195215, 37.70101848872697, 29.442215585717115, 44.54546859755137, 22.84255405188522, 34.2683622898511, 32.64722941949413, 18.46553657490859, 27.98454357851351, 29.700569006158148, 24.12733461347627, 19.52465665805267, 28.517144133996055, -0.589838972797935]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.506383931325293, "mean_inference_ms": 1.7572051862933344, "mean_action_processing_ms": 0.21625053009851414, "mean_env_wait_ms": 0.133303892671788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068618059158325195, "StateBufferConnector_ms": 0.005759835243225098, "ViewRequirementAgentConnector_ms": 0.1331578493118286}, "num_episodes": 27, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1352000, "num_agent_steps_trained": 1352000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 421.9389430496394, "num_env_steps_trained_throughput_per_sec": 421.9389430496394, "timesteps_total": 676000, "num_env_steps_sampled_lifetime": 676000, "num_agent_steps_sampled_lifetime": 1352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1352000, "timers": {"training_iteration_time_ms": 9096.184, "restore_workers_time_ms": 0.023, "training_step_time_ms": 9096.002, "sample_time_ms": 1473.641, "learn_time_ms": 7598.537, "learn_throughput": 526.417, "synch_weights_time_ms": 22.483}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 1352000, "num_agent_steps_trained": 1352000}, "done": false, "training_iteration": 169, "trial_id": "1f352_00000", "date": "2024-08-11_15-21-36", "timestamp": 1723404096, "time_this_iter_s": 9.538229942321777, "time_total_s": 1604.6359305381775, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1db9430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1604.6359305381775, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 54.87692307692308, "ram_util_percent": 82.95384615384616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0880409620702265, "cur_kl_coeff": 2.8398992587956433e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.902315517142415, "policy_loss": -0.00364531103950867, "vf_loss": 1.905960831232369, "vf_explained_var": 0.9097260265300672, "kl": 0.002138328589191896, "entropy": 0.21157851515260215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 162720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1528657988955575, "cur_kl_coeff": 5.364418029785158e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.973882406267027, "policy_loss": -0.0037125694446634347, "vf_loss": 1.9775949764996767, "vf_explained_var": 0.9151683894296487, "kl": 0.006231812326373169, "entropy": 0.36186610780035455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 162720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.77930365165551, "predator_policy": -9.159370210043427}, "policy_reward_max": {"prey_policy": 9.159370210043427, "predator_policy": 46.77930365165551}, "policy_reward_mean": {"prey_policy": -16.454915627245988, "predator_policy": 16.454915627245988}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-45.02659487506179, -16.017689081130257, 1.6452458006530226, -9.75628401440633, 1.8951188419113993, -25.43500371250854, -20.987375718254633, -27.945920254471083, 0.6454744929465441, -11.496944089212628, -9.468099528403052, -46.77930365165551, -12.393784654006573, -24.596476510353313, -15.175400890095165, 6.232241926903821, -18.211059636976962, -30.974693670605415, -21.713227361925597, -30.957125927878153, -6.980181037166227, -14.300606997548938, -20.140028793869725, -41.70324758104291, -22.493638039788124, -32.54662433978849, -15.06121515447189, -17.139293532311513, 0.9555036650851871, -0.5886606919302437, -2.638625037052954, -7.374924608157494, -21.41907068684648, 3.8083381350722165, -30.647101202640094, -0.6833207800512859, -22.94078837143521, 1.8836829295539488, -22.102813085699687, -25.955022963067783, -8.619532294599166, -8.546800220854058, -21.925307071230716, -3.4919677126326008, -20.636009484492135, 2.4341023374879054, -19.97177339078902, -14.848361976517403, 9.159370210043427, -2.950521804132812, -4.12009344760402, 8.762990991152263, -19.870904509805374, -20.916597318916928, -20.545498153382113, -28.860472159808833, -36.7694094207851, -18.14142589168707, -34.14379609716865, -36.051838850235946, -11.821784210084626, -17.18306319306091, -3.30116060936726, -13.829480906988948, -17.88956850867494, -3.575012223294591, -20.44129713782704, -35.65559491320863, -18.478907398195215, -37.70101848872697, -29.442215585717115, -44.54546859755137, -22.84255405188522, -34.2683622898511, -32.64722941949413, -18.46553657490859, -27.98454357851351, -29.700569006158148, -24.12733461347627, -19.52465665805267, -28.517144133996055, 0.589838972797935, -22.674974292880734, 9.06450559688779, 0.31617746391039425, -16.001405285163408, -12.133189238805993, -28.0931259644178, -2.94248527215529, -10.204034947458961, 8.134373929543907, -3.4487647021456542, -44.54561679844642, -27.492997071438435, 1.5611477789505752, 7.247480567353243, -2.2069639596394595, -43.81859199178308, -8.420853022508407, -3.8411954345193866], "policy_predator_policy_reward": [45.02659487506179, 16.017689081130257, -1.6452458006530226, 9.75628401440633, -1.8951188419113993, 25.43500371250854, 20.987375718254633, 27.945920254471083, -0.6454744929465441, 11.496944089212628, 9.468099528403052, 46.77930365165551, 12.393784654006573, 24.596476510353313, 15.175400890095165, -6.232241926903821, 18.211059636976962, 30.974693670605415, 21.713227361925597, 30.957125927878153, 6.980181037166227, 14.300606997548938, 20.140028793869725, 41.70324758104291, 22.493638039788124, 32.54662433978849, 15.06121515447189, 17.139293532311513, -0.9555036650851871, 0.5886606919302437, 2.638625037052954, 7.374924608157494, 21.41907068684648, -3.8083381350722165, 30.647101202640094, 0.6833207800512859, 22.94078837143521, -1.8836829295539488, 22.102813085699687, 25.955022963067783, 8.619532294599166, 8.546800220854058, 21.925307071230716, 3.4919677126326008, 20.636009484492135, -2.4341023374879054, 19.97177339078902, 14.848361976517403, -9.159370210043427, 2.950521804132812, 4.12009344760402, -8.762990991152263, 19.870904509805374, 20.916597318916928, 20.545498153382113, 28.860472159808833, 36.7694094207851, 18.14142589168707, 34.14379609716865, 36.051838850235946, 11.821784210084626, 17.18306319306091, 3.30116060936726, 13.829480906988948, 17.88956850867494, 3.575012223294591, 20.44129713782704, 35.65559491320863, 18.478907398195215, 37.70101848872697, 29.442215585717115, 44.54546859755137, 22.84255405188522, 34.2683622898511, 32.64722941949413, 18.46553657490859, 27.98454357851351, 29.700569006158148, 24.12733461347627, 19.52465665805267, 28.517144133996055, -0.589838972797935, 22.674974292880734, -9.06450559688779, -0.31617746391039425, 16.001405285163408, 12.133189238805993, 28.0931259644178, 2.94248527215529, 10.204034947458961, -8.134373929543907, 3.4487647021456542, 44.54561679844642, 27.492997071438435, -1.5611477789505752, -7.247480567353243, 2.2069639596394595, 43.81859199178308, 8.420853022508407, 3.8411954345193866]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5038146989160218, "mean_inference_ms": 1.748756679314396, "mean_action_processing_ms": 0.2150013652099458, "mean_env_wait_ms": 0.13276994869411854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066487789154052734, "StateBufferConnector_ms": 0.004707694053649902, "ViewRequirementAgentConnector_ms": 0.11539971828460693}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 472.63529817629694, "num_env_steps_trained_throughput_per_sec": 472.63529817629694, "timesteps_total": 680000, "num_env_steps_sampled_lifetime": 680000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 8956.494, "restore_workers_time_ms": 0.022, "training_step_time_ms": 8956.316, "sample_time_ms": 1389.248, "learn_time_ms": 7542.911, "learn_throughput": 530.299, "synch_weights_time_ms": 22.805}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 170, "trial_id": "1f352_00000", "date": "2024-08-11_15-21-44", "timestamp": 1723404104, "time_this_iter_s": 8.526936769485474, "time_total_s": 1613.162867307663, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1db9d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1613.162867307663, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 50.4076923076923, "ram_util_percent": 82.02307692307691}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1593534376472237, "cur_kl_coeff": 1.4199496293978216e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2988526089737813, "policy_loss": -0.003327208247113352, "vf_loss": 2.302179818227887, "vf_explained_var": 0.8811079710101087, "kl": 0.006593560764265513, "entropy": 0.27403710765453676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 163680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.966735134770473, "cur_kl_coeff": 5.364418029785158e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.350247063736121, "policy_loss": -3.612596968499323e-05, "vf_loss": 2.35028318973879, "vf_explained_var": 0.8789216985926032, "kl": 0.007216690928869696, "entropy": 0.3963729903412362, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 163680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.54561679844642, "predator_policy": -9.159370210043427}, "policy_reward_max": {"prey_policy": 9.159370210043427, "predator_policy": 44.54561679844642}, "policy_reward_mean": {"prey_policy": -16.951443704363136, "predator_policy": 16.951443704363136}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-21.713227361925597, -30.957125927878153, -6.980181037166227, -14.300606997548938, -20.140028793869725, -41.70324758104291, -22.493638039788124, -32.54662433978849, -15.06121515447189, -17.139293532311513, 0.9555036650851871, -0.5886606919302437, -2.638625037052954, -7.374924608157494, -21.41907068684648, 3.8083381350722165, -30.647101202640094, -0.6833207800512859, -22.94078837143521, 1.8836829295539488, -22.102813085699687, -25.955022963067783, -8.619532294599166, -8.546800220854058, -21.925307071230716, -3.4919677126326008, -20.636009484492135, 2.4341023374879054, -19.97177339078902, -14.848361976517403, 9.159370210043427, -2.950521804132812, -4.12009344760402, 8.762990991152263, -19.870904509805374, -20.916597318916928, -20.545498153382113, -28.860472159808833, -36.7694094207851, -18.14142589168707, -34.14379609716865, -36.051838850235946, -11.821784210084626, -17.18306319306091, -3.30116060936726, -13.829480906988948, -17.88956850867494, -3.575012223294591, -20.44129713782704, -35.65559491320863, -18.478907398195215, -37.70101848872697, -29.442215585717115, -44.54546859755137, -22.84255405188522, -34.2683622898511, -32.64722941949413, -18.46553657490859, -27.98454357851351, -29.700569006158148, -24.12733461347627, -19.52465665805267, -28.517144133996055, 0.589838972797935, -22.674974292880734, 9.06450559688779, 0.31617746391039425, -16.001405285163408, -12.133189238805993, -28.0931259644178, -2.94248527215529, -10.204034947458961, 8.134373929543907, -3.4487647021456542, -44.54561679844642, -27.492997071438435, 1.5611477789505752, 7.247480567353243, -2.2069639596394595, -43.81859199178308, -8.420853022508407, -3.8411954345193866, -18.034004152722552, -28.667162243224872, -27.56629358270736, -19.56885741429567, -31.28255834473917, -12.779167972235548, -35.799922876571266, -30.96818822333193, -1.1115563320062742, -27.042116987369667, -12.607934414746783, -5.466049354986559, -8.052352203550656, -11.663718123582868, -17.667670416152077, -33.23505147836023, -11.37509407960503, -20.611658736252792], "policy_predator_policy_reward": [21.713227361925597, 30.957125927878153, 6.980181037166227, 14.300606997548938, 20.140028793869725, 41.70324758104291, 22.493638039788124, 32.54662433978849, 15.06121515447189, 17.139293532311513, -0.9555036650851871, 0.5886606919302437, 2.638625037052954, 7.374924608157494, 21.41907068684648, -3.8083381350722165, 30.647101202640094, 0.6833207800512859, 22.94078837143521, -1.8836829295539488, 22.102813085699687, 25.955022963067783, 8.619532294599166, 8.546800220854058, 21.925307071230716, 3.4919677126326008, 20.636009484492135, -2.4341023374879054, 19.97177339078902, 14.848361976517403, -9.159370210043427, 2.950521804132812, 4.12009344760402, -8.762990991152263, 19.870904509805374, 20.916597318916928, 20.545498153382113, 28.860472159808833, 36.7694094207851, 18.14142589168707, 34.14379609716865, 36.051838850235946, 11.821784210084626, 17.18306319306091, 3.30116060936726, 13.829480906988948, 17.88956850867494, 3.575012223294591, 20.44129713782704, 35.65559491320863, 18.478907398195215, 37.70101848872697, 29.442215585717115, 44.54546859755137, 22.84255405188522, 34.2683622898511, 32.64722941949413, 18.46553657490859, 27.98454357851351, 29.700569006158148, 24.12733461347627, 19.52465665805267, 28.517144133996055, -0.589838972797935, 22.674974292880734, -9.06450559688779, -0.31617746391039425, 16.001405285163408, 12.133189238805993, 28.0931259644178, 2.94248527215529, 10.204034947458961, -8.134373929543907, 3.4487647021456542, 44.54561679844642, 27.492997071438435, -1.5611477789505752, -7.247480567353243, 2.2069639596394595, 43.81859199178308, 8.420853022508407, 3.8411954345193866, 18.034004152722552, 28.667162243224872, 27.56629358270736, 19.56885741429567, 31.28255834473917, 12.779167972235548, 35.799922876571266, 30.96818822333193, 1.1115563320062742, 27.042116987369667, 12.607934414746783, 5.466049354986559, 8.052352203550656, 11.663718123582868, 17.667670416152077, 33.23505147836023, 11.37509407960503, 20.611658736252792]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5037592178482668, "mean_inference_ms": 1.7484077859107805, "mean_action_processing_ms": 0.21497560911951893, "mean_env_wait_ms": 0.132799594777519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006451129913330078, "StateBufferConnector_ms": 0.004037618637084961, "ViewRequirementAgentConnector_ms": 0.10766410827636719}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 479.4373546303616, "num_env_steps_trained_throughput_per_sec": 479.4373546303616, "timesteps_total": 684000, "num_env_steps_sampled_lifetime": 684000, "num_agent_steps_sampled_lifetime": 1368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 8908.668, "restore_workers_time_ms": 0.023, "training_step_time_ms": 8908.496, "sample_time_ms": 1362.445, "learn_time_ms": 7523.134, "learn_throughput": 531.693, "synch_weights_time_ms": 21.66}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "training_iteration": 171, "trial_id": "1f352_00000", "date": "2024-08-11_15-21-53", "timestamp": 1723404113, "time_this_iter_s": 8.385092973709106, "time_total_s": 1621.547960281372, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1db9160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1621.547960281372, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 49.11666666666667, "ram_util_percent": 82.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.39749625424544, "cur_kl_coeff": 1.4199496293978216e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5264958361784617, "policy_loss": -0.0021541373377355435, "vf_loss": 2.5286499708890915, "vf_explained_var": 0.8723059520746271, "kl": 0.0034132044763051485, "entropy": 0.27651631090169154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 164640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3400520871703825, "cur_kl_coeff": 5.364418029785158e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.677717473730445, "policy_loss": -0.005246409174772756, "vf_loss": 2.6829638871053856, "vf_explained_var": 0.8714214702447255, "kl": 0.010798789139470698, "entropy": 0.3859788309161862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 164640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.54561679844642, "predator_policy": -9.159370210043427}, "policy_reward_max": {"prey_policy": 9.159370210043427, "predator_policy": 44.54561679844642}, "policy_reward_mean": {"prey_policy": -17.43275212402774, "predator_policy": 17.43275212402774}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.94078837143521, 1.8836829295539488, -22.102813085699687, -25.955022963067783, -8.619532294599166, -8.546800220854058, -21.925307071230716, -3.4919677126326008, -20.636009484492135, 2.4341023374879054, -19.97177339078902, -14.848361976517403, 9.159370210043427, -2.950521804132812, -4.12009344760402, 8.762990991152263, -19.870904509805374, -20.916597318916928, -20.545498153382113, -28.860472159808833, -36.7694094207851, -18.14142589168707, -34.14379609716865, -36.051838850235946, -11.821784210084626, -17.18306319306091, -3.30116060936726, -13.829480906988948, -17.88956850867494, -3.575012223294591, -20.44129713782704, -35.65559491320863, -18.478907398195215, -37.70101848872697, -29.442215585717115, -44.54546859755137, -22.84255405188522, -34.2683622898511, -32.64722941949413, -18.46553657490859, -27.98454357851351, -29.700569006158148, -24.12733461347627, -19.52465665805267, -28.517144133996055, 0.589838972797935, -22.674974292880734, 9.06450559688779, 0.31617746391039425, -16.001405285163408, -12.133189238805993, -28.0931259644178, -2.94248527215529, -10.204034947458961, 8.134373929543907, -3.4487647021456542, -44.54561679844642, -27.492997071438435, 1.5611477789505752, 7.247480567353243, -2.2069639596394595, -43.81859199178308, -8.420853022508407, -3.8411954345193866, -18.034004152722552, -28.667162243224872, -27.56629358270736, -19.56885741429567, -31.28255834473917, -12.779167972235548, -35.799922876571266, -30.96818822333193, -1.1115563320062742, -27.042116987369667, -12.607934414746783, -5.466049354986559, -8.052352203550656, -11.663718123582868, -17.667670416152077, -33.23505147836023, -11.37509407960503, -20.611658736252792, -11.699703374164066, -2.1343940368838403, -19.225716860482358, -35.57172533346571, -6.532098209062239, -37.11108657502116, 0.3159735842559712, -5.824227012584158, -19.925105226914766, -6.869982041510379, -37.648991367258034, -20.629469434469748, -39.938859443551344, -43.118812292108856, 6.196989840961891, -29.98417394646129, -8.467419970445661, -11.58509023960714], "policy_predator_policy_reward": [22.94078837143521, -1.8836829295539488, 22.102813085699687, 25.955022963067783, 8.619532294599166, 8.546800220854058, 21.925307071230716, 3.4919677126326008, 20.636009484492135, -2.4341023374879054, 19.97177339078902, 14.848361976517403, -9.159370210043427, 2.950521804132812, 4.12009344760402, -8.762990991152263, 19.870904509805374, 20.916597318916928, 20.545498153382113, 28.860472159808833, 36.7694094207851, 18.14142589168707, 34.14379609716865, 36.051838850235946, 11.821784210084626, 17.18306319306091, 3.30116060936726, 13.829480906988948, 17.88956850867494, 3.575012223294591, 20.44129713782704, 35.65559491320863, 18.478907398195215, 37.70101848872697, 29.442215585717115, 44.54546859755137, 22.84255405188522, 34.2683622898511, 32.64722941949413, 18.46553657490859, 27.98454357851351, 29.700569006158148, 24.12733461347627, 19.52465665805267, 28.517144133996055, -0.589838972797935, 22.674974292880734, -9.06450559688779, -0.31617746391039425, 16.001405285163408, 12.133189238805993, 28.0931259644178, 2.94248527215529, 10.204034947458961, -8.134373929543907, 3.4487647021456542, 44.54561679844642, 27.492997071438435, -1.5611477789505752, -7.247480567353243, 2.2069639596394595, 43.81859199178308, 8.420853022508407, 3.8411954345193866, 18.034004152722552, 28.667162243224872, 27.56629358270736, 19.56885741429567, 31.28255834473917, 12.779167972235548, 35.799922876571266, 30.96818822333193, 1.1115563320062742, 27.042116987369667, 12.607934414746783, 5.466049354986559, 8.052352203550656, 11.663718123582868, 17.667670416152077, 33.23505147836023, 11.37509407960503, 20.611658736252792, 11.699703374164066, 2.1343940368838403, 19.225716860482358, 35.57172533346571, 6.532098209062239, 37.11108657502116, -0.3159735842559712, 5.824227012584158, 19.925105226914766, 6.869982041510379, 37.648991367258034, 20.629469434469748, 39.938859443551344, 43.118812292108856, -6.196989840961891, 29.98417394646129, 8.467419970445661, 11.58509023960714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.503683123106119, "mean_inference_ms": 1.747826875459088, "mean_action_processing_ms": 0.21493212612418539, "mean_env_wait_ms": 0.1327814195181923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006371259689331055, "StateBufferConnector_ms": 0.0040056705474853516, "ViewRequirementAgentConnector_ms": 0.10711324214935303}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 467.03727222343764, "num_env_steps_trained_throughput_per_sec": 467.03727222343764, "timesteps_total": 688000, "num_env_steps_sampled_lifetime": 688000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 8868.736, "restore_workers_time_ms": 0.022, "training_step_time_ms": 8868.563, "sample_time_ms": 1361.109, "learn_time_ms": 7483.84, "learn_throughput": 534.485, "synch_weights_time_ms": 22.379}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 172, "trial_id": "1f352_00000", "date": "2024-08-11_15-22-01", "timestamp": 1723404121, "time_this_iter_s": 8.600239753723145, "time_total_s": 1630.1482000350952, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1d3e820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1630.1482000350952, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 52.025000000000006, "ram_util_percent": 81.85833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.538074633975824, "cur_kl_coeff": 7.099748146989108e-31, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6781007753064237, "policy_loss": -0.002173061162951247, "vf_loss": 2.680273840824763, "vf_explained_var": 0.905631538045903, "kl": 0.0020595309842028303, "entropy": 0.20270947264507413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 165600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.336111555310587, "cur_kl_coeff": 5.364418029785158e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.723046386986971, "policy_loss": -0.00344455661882724, "vf_loss": 2.726490948970119, "vf_explained_var": 0.9103949095432957, "kl": 0.007982271655123831, "entropy": 0.37962500083570677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 165600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 1384000, "num_agent_steps_trained": 1384000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.54561679844642, "predator_policy": -9.06450559688779}, "policy_reward_max": {"prey_policy": 9.06450559688779, "predator_policy": 44.54561679844642}, "policy_reward_mean": {"prey_policy": -18.001273639164214, "predator_policy": 18.001273639164214}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-36.051838850235946, -11.821784210084626, -17.18306319306091, -3.30116060936726, -13.829480906988948, -17.88956850867494, -3.575012223294591, -20.44129713782704, -35.65559491320863, -18.478907398195215, -37.70101848872697, -29.442215585717115, -44.54546859755137, -22.84255405188522, -34.2683622898511, -32.64722941949413, -18.46553657490859, -27.98454357851351, -29.700569006158148, -24.12733461347627, -19.52465665805267, -28.517144133996055, 0.589838972797935, -22.674974292880734, 9.06450559688779, 0.31617746391039425, -16.001405285163408, -12.133189238805993, -28.0931259644178, -2.94248527215529, -10.204034947458961, 8.134373929543907, -3.4487647021456542, -44.54561679844642, -27.492997071438435, 1.5611477789505752, 7.247480567353243, -2.2069639596394595, -43.81859199178308, -8.420853022508407, -3.8411954345193866, -18.034004152722552, -28.667162243224872, -27.56629358270736, -19.56885741429567, -31.28255834473917, -12.779167972235548, -35.799922876571266, -30.96818822333193, -1.1115563320062742, -27.042116987369667, -12.607934414746783, -5.466049354986559, -8.052352203550656, -11.663718123582868, -17.667670416152077, -33.23505147836023, -11.37509407960503, -20.611658736252792, -11.699703374164066, -2.1343940368838403, -19.225716860482358, -35.57172533346571, -6.532098209062239, -37.11108657502116, 0.3159735842559712, -5.824227012584158, -19.925105226914766, -6.869982041510379, -37.648991367258034, -20.629469434469748, -39.938859443551344, -43.118812292108856, 6.196989840961891, -29.98417394646129, -8.467419970445661, -11.58509023960714, -12.9763928486285, 5.058899297626805, -33.72435602367609, -30.466109791120488, 4.575436194260364, -40.272971087265866, -4.243383485570112, -0.24803047943478163, -25.03561990534156, -43.94960891984785, 1.6067965215404207, -7.1964359632560715, -13.878678893557204, -43.79896091272911, -10.795814520641308, -27.524675204680186, -27.894113939376908, -0.30312588340338786, 2.353523693324507, -43.64687351215143, -13.63642570752265, -14.207858032062054, -9.764321016505358], "policy_predator_policy_reward": [36.051838850235946, 11.821784210084626, 17.18306319306091, 3.30116060936726, 13.829480906988948, 17.88956850867494, 3.575012223294591, 20.44129713782704, 35.65559491320863, 18.478907398195215, 37.70101848872697, 29.442215585717115, 44.54546859755137, 22.84255405188522, 34.2683622898511, 32.64722941949413, 18.46553657490859, 27.98454357851351, 29.700569006158148, 24.12733461347627, 19.52465665805267, 28.517144133996055, -0.589838972797935, 22.674974292880734, -9.06450559688779, -0.31617746391039425, 16.001405285163408, 12.133189238805993, 28.0931259644178, 2.94248527215529, 10.204034947458961, -8.134373929543907, 3.4487647021456542, 44.54561679844642, 27.492997071438435, -1.5611477789505752, -7.247480567353243, 2.2069639596394595, 43.81859199178308, 8.420853022508407, 3.8411954345193866, 18.034004152722552, 28.667162243224872, 27.56629358270736, 19.56885741429567, 31.28255834473917, 12.779167972235548, 35.799922876571266, 30.96818822333193, 1.1115563320062742, 27.042116987369667, 12.607934414746783, 5.466049354986559, 8.052352203550656, 11.663718123582868, 17.667670416152077, 33.23505147836023, 11.37509407960503, 20.611658736252792, 11.699703374164066, 2.1343940368838403, 19.225716860482358, 35.57172533346571, 6.532098209062239, 37.11108657502116, -0.3159735842559712, 5.824227012584158, 19.925105226914766, 6.869982041510379, 37.648991367258034, 20.629469434469748, 39.938859443551344, 43.118812292108856, -6.196989840961891, 29.98417394646129, 8.467419970445661, 11.58509023960714, 12.9763928486285, -5.058899297626805, 33.72435602367609, 30.466109791120488, -4.575436194260364, 40.272971087265866, 4.243383485570112, 0.24803047943478163, 25.03561990534156, 43.94960891984785, -1.6067965215404207, 7.1964359632560715, 13.878678893557204, 43.79896091272911, 10.795814520641308, 27.524675204680186, 27.894113939376908, 0.30312588340338786, -2.353523693324507, 43.64687351215143, 13.63642570752265, 14.207858032062054, 9.764321016505358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.504467569001248, "mean_inference_ms": 1.7496123480627848, "mean_action_processing_ms": 0.21526894496969043, "mean_env_wait_ms": 0.13289017832174874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006493091583251953, "StateBufferConnector_ms": 0.004290103912353516, "ViewRequirementAgentConnector_ms": 0.13293027877807617}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1384000, "num_agent_steps_trained": 1384000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 508.2925419959301, "num_env_steps_trained_throughput_per_sec": 508.2925419959301, "timesteps_total": 692000, "num_env_steps_sampled_lifetime": 692000, "num_agent_steps_sampled_lifetime": 1384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1384000, "timers": {"training_iteration_time_ms": 8816.241, "restore_workers_time_ms": 0.036, "training_step_time_ms": 8816.036, "sample_time_ms": 1356.191, "learn_time_ms": 7436.488, "learn_throughput": 537.888, "synch_weights_time_ms": 22.168}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 1384000, "num_agent_steps_trained": 1384000}, "done": false, "training_iteration": 173, "trial_id": "1f352_00000", "date": "2024-08-11_15-22-09", "timestamp": 1723404129, "time_this_iter_s": 7.876650333404541, "time_total_s": 1638.0248503684998, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c77af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1638.0248503684998, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 46.56363636363637, "ram_util_percent": 81.79090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.568447565038999, "cur_kl_coeff": 3.549874073494554e-31, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3219968092938266, "policy_loss": -0.0025723566626159786, "vf_loss": 2.3245691558967034, "vf_explained_var": 0.9271498565251629, "kl": 0.002355345188375449, "entropy": 0.20042144054702174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 166560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.374779754628738, "cur_kl_coeff": 5.364418029785158e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.223313604295254, "policy_loss": -0.0013454164858558216, "vf_loss": 2.224659015983343, "vf_explained_var": 0.9352477654193838, "kl": 0.004045447455708469, "entropy": 0.3689577476121485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 166560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.54561679844642, "predator_policy": -13.021382262110857}, "policy_reward_max": {"prey_policy": 13.021382262110857, "predator_policy": 44.54561679844642}, "policy_reward_mean": {"prey_policy": -15.71288878040629, "predator_policy": 15.71288878040629}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.589838972797935, -22.674974292880734, 9.06450559688779, 0.31617746391039425, -16.001405285163408, -12.133189238805993, -28.0931259644178, -2.94248527215529, -10.204034947458961, 8.134373929543907, -3.4487647021456542, -44.54561679844642, -27.492997071438435, 1.5611477789505752, 7.247480567353243, -2.2069639596394595, -43.81859199178308, -8.420853022508407, -3.8411954345193866, -18.034004152722552, -28.667162243224872, -27.56629358270736, -19.56885741429567, -31.28255834473917, -12.779167972235548, -35.799922876571266, -30.96818822333193, -1.1115563320062742, -27.042116987369667, -12.607934414746783, -5.466049354986559, -8.052352203550656, -11.663718123582868, -17.667670416152077, -33.23505147836023, -11.37509407960503, -20.611658736252792, -11.699703374164066, -2.1343940368838403, -19.225716860482358, -35.57172533346571, -6.532098209062239, -37.11108657502116, 0.3159735842559712, -5.824227012584158, -19.925105226914766, -6.869982041510379, -37.648991367258034, -20.629469434469748, -39.938859443551344, -43.118812292108856, 6.196989840961891, -29.98417394646129, -8.467419970445661, -11.58509023960714, -12.9763928486285, 5.058899297626805, -33.72435602367609, -30.466109791120488, 4.575436194260364, -40.272971087265866, -4.243383485570112, -0.24803047943478163, -25.03561990534156, -43.94960891984785, 1.6067965215404207, -7.1964359632560715, -13.878678893557204, -43.79896091272911, -10.795814520641308, -27.524675204680186, -27.894113939376908, -0.30312588340338786, 2.353523693324507, -43.64687351215143, -13.63642570752265, -14.207858032062054, -9.764321016505358, -9.43036315046892, -31.93984620003269, -21.365204229865043, -3.113280090613376, -25.43353030101588, 13.021382262110857, -19.614280219066238, -21.62449657189241, -25.299425181954714, -0.5742048663648589, 2.5541719975032287, -15.988720496775858, -21.7672293446877, -14.974798150567668, 1.5427156441835876, -1.2729476896121614, 12.113608577072261, -12.022142666899878, -21.132285806437817, -11.01864100669016, -40.90562804710472, -30.910709534296707], "policy_predator_policy_reward": [-0.589838972797935, 22.674974292880734, -9.06450559688779, -0.31617746391039425, 16.001405285163408, 12.133189238805993, 28.0931259644178, 2.94248527215529, 10.204034947458961, -8.134373929543907, 3.4487647021456542, 44.54561679844642, 27.492997071438435, -1.5611477789505752, -7.247480567353243, 2.2069639596394595, 43.81859199178308, 8.420853022508407, 3.8411954345193866, 18.034004152722552, 28.667162243224872, 27.56629358270736, 19.56885741429567, 31.28255834473917, 12.779167972235548, 35.799922876571266, 30.96818822333193, 1.1115563320062742, 27.042116987369667, 12.607934414746783, 5.466049354986559, 8.052352203550656, 11.663718123582868, 17.667670416152077, 33.23505147836023, 11.37509407960503, 20.611658736252792, 11.699703374164066, 2.1343940368838403, 19.225716860482358, 35.57172533346571, 6.532098209062239, 37.11108657502116, -0.3159735842559712, 5.824227012584158, 19.925105226914766, 6.869982041510379, 37.648991367258034, 20.629469434469748, 39.938859443551344, 43.118812292108856, -6.196989840961891, 29.98417394646129, 8.467419970445661, 11.58509023960714, 12.9763928486285, -5.058899297626805, 33.72435602367609, 30.466109791120488, -4.575436194260364, 40.272971087265866, 4.243383485570112, 0.24803047943478163, 25.03561990534156, 43.94960891984785, -1.6067965215404207, 7.1964359632560715, 13.878678893557204, 43.79896091272911, 10.795814520641308, 27.524675204680186, 27.894113939376908, 0.30312588340338786, -2.353523693324507, 43.64687351215143, 13.63642570752265, 14.207858032062054, 9.764321016505358, 9.43036315046892, 31.93984620003269, 21.365204229865043, 3.113280090613376, 25.43353030101588, -13.021382262110857, 19.614280219066238, 21.62449657189241, 25.299425181954714, 0.5742048663648589, -2.5541719975032287, 15.988720496775858, 21.7672293446877, 14.974798150567668, -1.5427156441835876, 1.2729476896121614, -12.113608577072261, 12.022142666899878, 21.132285806437817, 11.01864100669016, 40.90562804710472, 30.910709534296707]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5030556497708095, "mean_inference_ms": 1.7459220404886713, "mean_action_processing_ms": 0.21476592906820058, "mean_env_wait_ms": 0.1326800992294911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038378238677978516, "StateBufferConnector_ms": 0.0027501583099365234, "ViewRequirementAgentConnector_ms": 0.10688400268554688}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 476.33127938401907, "num_env_steps_trained_throughput_per_sec": 476.33127938401907, "timesteps_total": 696000, "num_env_steps_sampled_lifetime": 696000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 8673.663, "restore_workers_time_ms": 0.035, "training_step_time_ms": 8673.458, "sample_time_ms": 1301.046, "learn_time_ms": 7348.549, "learn_throughput": 544.325, "synch_weights_time_ms": 22.769}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 174, "trial_id": "1f352_00000", "date": "2024-08-11_15-22-18", "timestamp": 1723404138, "time_this_iter_s": 8.46697187423706, "time_total_s": 1646.4918222427368, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1ca95e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1646.4918222427368, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 47.800000000000004, "ram_util_percent": 82.03333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2217816622306903, "cur_kl_coeff": 1.774937036747277e-31, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4243590460469326, "policy_loss": -0.006102587456795542, "vf_loss": 1.4304616312806806, "vf_explained_var": 0.965034471390148, "kl": 0.007548329119069237, "entropy": 0.16369114436674864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 167520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.265081310396393, "cur_kl_coeff": 2.682209014892579e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4159659836441278, "policy_loss": -0.004027712216823905, "vf_loss": 1.4199936914568145, "vf_explained_var": 0.9672094029684861, "kl": 0.00743346658872518, "entropy": 0.38879212851946554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 167520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.78416179188855, "predator_policy": -13.021382262110857}, "policy_reward_max": {"prey_policy": 13.021382262110857, "predator_policy": 46.78416179188855}, "policy_reward_mean": {"prey_policy": -17.63786041920586, "predator_policy": 17.63786041920586}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.8411954345193866, -18.034004152722552, -28.667162243224872, -27.56629358270736, -19.56885741429567, -31.28255834473917, -12.779167972235548, -35.799922876571266, -30.96818822333193, -1.1115563320062742, -27.042116987369667, -12.607934414746783, -5.466049354986559, -8.052352203550656, -11.663718123582868, -17.667670416152077, -33.23505147836023, -11.37509407960503, -20.611658736252792, -11.699703374164066, -2.1343940368838403, -19.225716860482358, -35.57172533346571, -6.532098209062239, -37.11108657502116, 0.3159735842559712, -5.824227012584158, -19.925105226914766, -6.869982041510379, -37.648991367258034, -20.629469434469748, -39.938859443551344, -43.118812292108856, 6.196989840961891, -29.98417394646129, -8.467419970445661, -11.58509023960714, -12.9763928486285, 5.058899297626805, -33.72435602367609, -30.466109791120488, 4.575436194260364, -40.272971087265866, -4.243383485570112, -0.24803047943478163, -25.03561990534156, -43.94960891984785, 1.6067965215404207, -7.1964359632560715, -13.878678893557204, -43.79896091272911, -10.795814520641308, -27.524675204680186, -27.894113939376908, -0.30312588340338786, 2.353523693324507, -43.64687351215143, -13.63642570752265, -14.207858032062054, -9.764321016505358, -9.43036315046892, -31.93984620003269, -21.365204229865043, -3.113280090613376, -25.43353030101588, 13.021382262110857, -19.614280219066238, -21.62449657189241, -25.299425181954714, -0.5742048663648589, 2.5541719975032287, -15.988720496775858, -21.7672293446877, -14.974798150567668, 1.5427156441835876, -1.2729476896121614, 12.113608577072261, -12.022142666899878, -21.132285806437817, -11.01864100669016, -40.90562804710472, -30.910709534296707, -46.78416179188855, -19.274260750102126, -22.250030059088758, -22.98082803593909, -15.540787758425505, -16.402754288369664, -11.132476564758669, -21.258736150316764, -3.729341709130564, -30.483115551054134, -34.51789033853261, -31.37419892443456, -21.30392749693203, -17.34462623235697, 1.4621464116660015, -23.772239280917617, -24.467599258251262, -26.411814338523897], "policy_predator_policy_reward": [3.8411954345193866, 18.034004152722552, 28.667162243224872, 27.56629358270736, 19.56885741429567, 31.28255834473917, 12.779167972235548, 35.799922876571266, 30.96818822333193, 1.1115563320062742, 27.042116987369667, 12.607934414746783, 5.466049354986559, 8.052352203550656, 11.663718123582868, 17.667670416152077, 33.23505147836023, 11.37509407960503, 20.611658736252792, 11.699703374164066, 2.1343940368838403, 19.225716860482358, 35.57172533346571, 6.532098209062239, 37.11108657502116, -0.3159735842559712, 5.824227012584158, 19.925105226914766, 6.869982041510379, 37.648991367258034, 20.629469434469748, 39.938859443551344, 43.118812292108856, -6.196989840961891, 29.98417394646129, 8.467419970445661, 11.58509023960714, 12.9763928486285, -5.058899297626805, 33.72435602367609, 30.466109791120488, -4.575436194260364, 40.272971087265866, 4.243383485570112, 0.24803047943478163, 25.03561990534156, 43.94960891984785, -1.6067965215404207, 7.1964359632560715, 13.878678893557204, 43.79896091272911, 10.795814520641308, 27.524675204680186, 27.894113939376908, 0.30312588340338786, -2.353523693324507, 43.64687351215143, 13.63642570752265, 14.207858032062054, 9.764321016505358, 9.43036315046892, 31.93984620003269, 21.365204229865043, 3.113280090613376, 25.43353030101588, -13.021382262110857, 19.614280219066238, 21.62449657189241, 25.299425181954714, 0.5742048663648589, -2.5541719975032287, 15.988720496775858, 21.7672293446877, 14.974798150567668, -1.5427156441835876, 1.2729476896121614, -12.113608577072261, 12.022142666899878, 21.132285806437817, 11.01864100669016, 40.90562804710472, 30.910709534296707, 46.78416179188855, 19.274260750102126, 22.250030059088758, 22.98082803593909, 15.540787758425505, 16.402754288369664, 11.132476564758669, 21.258736150316764, 3.729341709130564, 30.483115551054134, 34.51789033853261, 31.37419892443456, 21.30392749693203, 17.34462623235697, -1.4621464116660015, 23.772239280917617, 24.467599258251262, 26.411814338523897]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5027932956766733, "mean_inference_ms": 1.7452021479674658, "mean_action_processing_ms": 0.21471263411122635, "mean_env_wait_ms": 0.13262488868626032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039288997650146484, "StateBufferConnector_ms": 0.0028673410415649414, "ViewRequirementAgentConnector_ms": 0.10828697681427002}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 459.8051045629992, "num_env_steps_trained_throughput_per_sec": 459.8051045629992, "timesteps_total": 700000, "num_env_steps_sampled_lifetime": 700000, "num_agent_steps_sampled_lifetime": 1400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1400000, "timers": {"training_iteration_time_ms": 8722.34, "restore_workers_time_ms": 0.035, "training_step_time_ms": 8722.185, "sample_time_ms": 1304.559, "learn_time_ms": 7392.315, "learn_throughput": 541.102, "synch_weights_time_ms": 24.305}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "done": false, "training_iteration": 175, "trial_id": "1f352_00000", "date": "2024-08-11_15-22-27", "timestamp": 1723404147, "time_this_iter_s": 8.801405906677246, "time_total_s": 1655.293228149414, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c6b1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1655.293228149414, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 49.82307692307693, "ram_util_percent": 81.87692307692306}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.410894103596608, "cur_kl_coeff": 1.774937036747277e-31, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3640107514336706, "policy_loss": -0.0031498814416409003, "vf_loss": 1.3671606324613095, "vf_explained_var": 0.9686283132682244, "kl": 0.0037508629182653784, "entropy": 0.1997416161854441, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 168480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4010172486305237, "cur_kl_coeff": 2.682209014892579e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.460170134374251, "policy_loss": -0.0031804524740437047, "vf_loss": 1.4633505938574671, "vf_explained_var": 0.9658773133531213, "kl": 0.005058952317228257, "entropy": 0.35347971034546694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 168480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.78416179188855, "predator_policy": -13.021382262110857}, "policy_reward_max": {"prey_policy": 13.021382262110857, "predator_policy": 46.78416179188855}, "policy_reward_mean": {"prey_policy": -17.558309874211574, "predator_policy": 17.558309874211574}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.611658736252792, -11.699703374164066, -2.1343940368838403, -19.225716860482358, -35.57172533346571, -6.532098209062239, -37.11108657502116, 0.3159735842559712, -5.824227012584158, -19.925105226914766, -6.869982041510379, -37.648991367258034, -20.629469434469748, -39.938859443551344, -43.118812292108856, 6.196989840961891, -29.98417394646129, -8.467419970445661, -11.58509023960714, -12.9763928486285, 5.058899297626805, -33.72435602367609, -30.466109791120488, 4.575436194260364, -40.272971087265866, -4.243383485570112, -0.24803047943478163, -25.03561990534156, -43.94960891984785, 1.6067965215404207, -7.1964359632560715, -13.878678893557204, -43.79896091272911, -10.795814520641308, -27.524675204680186, -27.894113939376908, -0.30312588340338786, 2.353523693324507, -43.64687351215143, -13.63642570752265, -14.207858032062054, -9.764321016505358, -9.43036315046892, -31.93984620003269, -21.365204229865043, -3.113280090613376, -25.43353030101588, 13.021382262110857, -19.614280219066238, -21.62449657189241, -25.299425181954714, -0.5742048663648589, 2.5541719975032287, -15.988720496775858, -21.7672293446877, -14.974798150567668, 1.5427156441835876, -1.2729476896121614, 12.113608577072261, -12.022142666899878, -21.132285806437817, -11.01864100669016, -40.90562804710472, -30.910709534296707, -46.78416179188855, -19.274260750102126, -22.250030059088758, -22.98082803593909, -15.540787758425505, -16.402754288369664, -11.132476564758669, -21.258736150316764, -3.729341709130564, -30.483115551054134, -34.51789033853261, -31.37419892443456, -21.30392749693203, -17.34462623235697, 1.4621464116660015, -23.772239280917617, -24.467599258251262, -26.411814338523897, -9.413852348267422, -24.344505683366464, -30.54620735826087, -10.875153615901038, -8.07404973214351, -12.336708968870013, -17.9636002980593, -34.631891048790536, -21.34763760739068, -0.5426787951516712, -17.079426685410517, -29.633130893024223, 3.9233222875275224, -26.48978981506631, -27.438193662772164, -21.25237547975672, -29.102786720009117, -11.625172710566183], "policy_predator_policy_reward": [20.611658736252792, 11.699703374164066, 2.1343940368838403, 19.225716860482358, 35.57172533346571, 6.532098209062239, 37.11108657502116, -0.3159735842559712, 5.824227012584158, 19.925105226914766, 6.869982041510379, 37.648991367258034, 20.629469434469748, 39.938859443551344, 43.118812292108856, -6.196989840961891, 29.98417394646129, 8.467419970445661, 11.58509023960714, 12.9763928486285, -5.058899297626805, 33.72435602367609, 30.466109791120488, -4.575436194260364, 40.272971087265866, 4.243383485570112, 0.24803047943478163, 25.03561990534156, 43.94960891984785, -1.6067965215404207, 7.1964359632560715, 13.878678893557204, 43.79896091272911, 10.795814520641308, 27.524675204680186, 27.894113939376908, 0.30312588340338786, -2.353523693324507, 43.64687351215143, 13.63642570752265, 14.207858032062054, 9.764321016505358, 9.43036315046892, 31.93984620003269, 21.365204229865043, 3.113280090613376, 25.43353030101588, -13.021382262110857, 19.614280219066238, 21.62449657189241, 25.299425181954714, 0.5742048663648589, -2.5541719975032287, 15.988720496775858, 21.7672293446877, 14.974798150567668, -1.5427156441835876, 1.2729476896121614, -12.113608577072261, 12.022142666899878, 21.132285806437817, 11.01864100669016, 40.90562804710472, 30.910709534296707, 46.78416179188855, 19.274260750102126, 22.250030059088758, 22.98082803593909, 15.540787758425505, 16.402754288369664, 11.132476564758669, 21.258736150316764, 3.729341709130564, 30.483115551054134, 34.51789033853261, 31.37419892443456, 21.30392749693203, 17.34462623235697, -1.4621464116660015, 23.772239280917617, 24.467599258251262, 26.411814338523897, 9.413852348267422, 24.344505683366464, 30.54620735826087, 10.875153615901038, 8.07404973214351, 12.336708968870013, 17.9636002980593, 34.631891048790536, 21.34763760739068, 0.5426787951516712, 17.079426685410517, 29.633130893024223, -3.9233222875275224, 26.48978981506631, 27.438193662772164, 21.25237547975672, 29.102786720009117, 11.625172710566183]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.502526615777303, "mean_inference_ms": 1.7444356329259483, "mean_action_processing_ms": 0.21465407978819498, "mean_env_wait_ms": 0.13256921519705125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038808584213256836, "StateBufferConnector_ms": 0.002866387367248535, "ViewRequirementAgentConnector_ms": 0.10731279850006104}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 466.41295855716925, "num_env_steps_trained_throughput_per_sec": 466.41295855716925, "timesteps_total": 704000, "num_env_steps_sampled_lifetime": 704000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 8713.693, "restore_workers_time_ms": 0.059, "training_step_time_ms": 8713.44, "sample_time_ms": 1264.621, "learn_time_ms": 7425.169, "learn_throughput": 538.708, "synch_weights_time_ms": 22.86}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 176, "trial_id": "1f352_00000", "date": "2024-08-11_15-22-35", "timestamp": 1723404155, "time_this_iter_s": 8.599446058273315, "time_total_s": 1663.8926742076874, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1ca90d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1663.8926742076874, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 49.525, "ram_util_percent": 82.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.997000100215276, "cur_kl_coeff": 8.874685183736385e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.399446602165699, "policy_loss": -0.0018321533447306138, "vf_loss": 2.4012787522127232, "vf_explained_var": 0.9122909989828865, "kl": 0.00391926065381772, "entropy": 0.2488686423593511, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 169440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.826439503952861, "cur_kl_coeff": 2.682209014892579e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3844049870967865, "policy_loss": -0.00498272945478675, "vf_loss": 2.389387726162871, "vf_explained_var": 0.9122930138061444, "kl": 0.008454716895732383, "entropy": 0.40202718721702696, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 169440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.78416179188855, "predator_policy": -16.688134814955145}, "policy_reward_max": {"prey_policy": 16.688134814955145, "predator_policy": 46.78416179188855}, "policy_reward_mean": {"prey_policy": -16.25681315969092, "predator_policy": 16.25681315969092}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.58509023960714, -12.9763928486285, 5.058899297626805, -33.72435602367609, -30.466109791120488, 4.575436194260364, -40.272971087265866, -4.243383485570112, -0.24803047943478163, -25.03561990534156, -43.94960891984785, 1.6067965215404207, -7.1964359632560715, -13.878678893557204, -43.79896091272911, -10.795814520641308, -27.524675204680186, -27.894113939376908, -0.30312588340338786, 2.353523693324507, -43.64687351215143, -13.63642570752265, -14.207858032062054, -9.764321016505358, -9.43036315046892, -31.93984620003269, -21.365204229865043, -3.113280090613376, -25.43353030101588, 13.021382262110857, -19.614280219066238, -21.62449657189241, -25.299425181954714, -0.5742048663648589, 2.5541719975032287, -15.988720496775858, -21.7672293446877, -14.974798150567668, 1.5427156441835876, -1.2729476896121614, 12.113608577072261, -12.022142666899878, -21.132285806437817, -11.01864100669016, -40.90562804710472, -30.910709534296707, -46.78416179188855, -19.274260750102126, -22.250030059088758, -22.98082803593909, -15.540787758425505, -16.402754288369664, -11.132476564758669, -21.258736150316764, -3.729341709130564, -30.483115551054134, -34.51789033853261, -31.37419892443456, -21.30392749693203, -17.34462623235697, 1.4621464116660015, -23.772239280917617, -24.467599258251262, -26.411814338523897, -9.413852348267422, -24.344505683366464, -30.54620735826087, -10.875153615901038, -8.07404973214351, -12.336708968870013, -17.9636002980593, -34.631891048790536, -21.34763760739068, -0.5426787951516712, -17.079426685410517, -29.633130893024223, 3.9233222875275224, -26.48978981506631, -27.438193662772164, -21.25237547975672, -29.102786720009117, -11.625172710566183, -25.263183630623356, 6.6416690359939174, -4.621181383158059, -15.09932184061047, -12.70654622091661, -17.940112742531504, -17.57199629505229, -17.675670881730106, 16.688134814955145, -9.781697799509494, -28.28294164623102, -2.457334123962987, 4.054262387990157, -32.463110793166514, -16.96563848305498, -2.1478106550759444, -28.1688747952052, -4.869433931463764], "policy_predator_policy_reward": [11.58509023960714, 12.9763928486285, -5.058899297626805, 33.72435602367609, 30.466109791120488, -4.575436194260364, 40.272971087265866, 4.243383485570112, 0.24803047943478163, 25.03561990534156, 43.94960891984785, -1.6067965215404207, 7.1964359632560715, 13.878678893557204, 43.79896091272911, 10.795814520641308, 27.524675204680186, 27.894113939376908, 0.30312588340338786, -2.353523693324507, 43.64687351215143, 13.63642570752265, 14.207858032062054, 9.764321016505358, 9.43036315046892, 31.93984620003269, 21.365204229865043, 3.113280090613376, 25.43353030101588, -13.021382262110857, 19.614280219066238, 21.62449657189241, 25.299425181954714, 0.5742048663648589, -2.5541719975032287, 15.988720496775858, 21.7672293446877, 14.974798150567668, -1.5427156441835876, 1.2729476896121614, -12.113608577072261, 12.022142666899878, 21.132285806437817, 11.01864100669016, 40.90562804710472, 30.910709534296707, 46.78416179188855, 19.274260750102126, 22.250030059088758, 22.98082803593909, 15.540787758425505, 16.402754288369664, 11.132476564758669, 21.258736150316764, 3.729341709130564, 30.483115551054134, 34.51789033853261, 31.37419892443456, 21.30392749693203, 17.34462623235697, -1.4621464116660015, 23.772239280917617, 24.467599258251262, 26.411814338523897, 9.413852348267422, 24.344505683366464, 30.54620735826087, 10.875153615901038, 8.07404973214351, 12.336708968870013, 17.9636002980593, 34.631891048790536, 21.34763760739068, 0.5426787951516712, 17.079426685410517, 29.633130893024223, -3.9233222875275224, 26.48978981506631, 27.438193662772164, 21.25237547975672, 29.102786720009117, 11.625172710566183, 25.263183630623356, -6.6416690359939174, 4.621181383158059, 15.09932184061047, 12.70654622091661, 17.940112742531504, 17.57199629505229, 17.675670881730106, -16.688134814955145, 9.781697799509494, 28.28294164623102, 2.457334123962987, -4.054262387990157, 32.463110793166514, 16.96563848305498, 2.1478106550759444, 28.1688747952052, 4.869433931463764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5022113270068577, "mean_inference_ms": 1.7435550723833142, "mean_action_processing_ms": 0.21457020386759773, "mean_env_wait_ms": 0.13250844419586477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003854513168334961, "StateBufferConnector_ms": 0.0028575658798217773, "ViewRequirementAgentConnector_ms": 0.10608088970184326}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 514.4703778565625, "num_env_steps_trained_throughput_per_sec": 514.4703778565625, "timesteps_total": 708000, "num_env_steps_sampled_lifetime": 708000, "num_agent_steps_sampled_lifetime": 1416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 8576.061, "restore_workers_time_ms": 0.058, "training_step_time_ms": 8575.816, "sample_time_ms": 1244.643, "learn_time_ms": 7306.908, "learn_throughput": 547.427, "synch_weights_time_ms": 23.463}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "training_iteration": 177, "trial_id": "1f352_00000", "date": "2024-08-11_15-22-43", "timestamp": 1723404163, "time_this_iter_s": 7.786200046539307, "time_total_s": 1671.6788742542267, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c89ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1671.6788742542267, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 44.57272727272727, "ram_util_percent": 82.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.614464181040724, "cur_kl_coeff": 4.4373425918681926e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6820323127011458, "policy_loss": -0.0011476276323567922, "vf_loss": 1.6831799430151781, "vf_explained_var": 0.9638281558950742, "kl": 0.0025145964554032694, "entropy": 0.23127519691673418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 170400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.527861972277363, "cur_kl_coeff": 2.682209014892579e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7399628122026722, "policy_loss": -0.003663109482052581, "vf_loss": 1.7436259197692077, "vf_explained_var": 0.960974388445417, "kl": 0.004719934281655552, "entropy": 0.34677315801382064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 170400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.78416179188855, "predator_policy": -16.688134814955145}, "policy_reward_max": {"prey_policy": 16.688134814955145, "predator_policy": 46.78416179188855}, "policy_reward_mean": {"prey_policy": -17.107295836264772, "predator_policy": 17.107295836264772}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.113280090613376, -25.43353030101588, 13.021382262110857, -19.614280219066238, -21.62449657189241, -25.299425181954714, -0.5742048663648589, 2.5541719975032287, -15.988720496775858, -21.7672293446877, -14.974798150567668, 1.5427156441835876, -1.2729476896121614, 12.113608577072261, -12.022142666899878, -21.132285806437817, -11.01864100669016, -40.90562804710472, -30.910709534296707, -46.78416179188855, -19.274260750102126, -22.250030059088758, -22.98082803593909, -15.540787758425505, -16.402754288369664, -11.132476564758669, -21.258736150316764, -3.729341709130564, -30.483115551054134, -34.51789033853261, -31.37419892443456, -21.30392749693203, -17.34462623235697, 1.4621464116660015, -23.772239280917617, -24.467599258251262, -26.411814338523897, -9.413852348267422, -24.344505683366464, -30.54620735826087, -10.875153615901038, -8.07404973214351, -12.336708968870013, -17.9636002980593, -34.631891048790536, -21.34763760739068, -0.5426787951516712, -17.079426685410517, -29.633130893024223, 3.9233222875275224, -26.48978981506631, -27.438193662772164, -21.25237547975672, -29.102786720009117, -11.625172710566183, -25.263183630623356, 6.6416690359939174, -4.621181383158059, -15.09932184061047, -12.70654622091661, -17.940112742531504, -17.57199629505229, -17.675670881730106, 16.688134814955145, -9.781697799509494, -28.28294164623102, -2.457334123962987, 4.054262387990157, -32.463110793166514, -16.96563848305498, -2.1478106550759444, -28.1688747952052, -4.869433931463764, -16.65211333586501, 2.229776665853633, -27.887070920511576, 3.0286570785873046, -31.188145617363936, -29.364962277906113, -10.651548947891904, -13.554017066994078, -20.041422356053182, -25.740599248529378, -14.052746786513794, -43.22062536346321, -5.6444901589656595, -9.453526693673659, -29.349411942797687, -11.374426183788554, -29.016463256449462, -16.727412018682756, -35.08405700580458, -34.64851305815723, 7.587431214656803, -11.633258988684268, -24.25850760704812, -14.34614428798317, -30.79017633737942, -39.43993257834515, -38.064164817623244], "policy_predator_policy_reward": [3.113280090613376, 25.43353030101588, -13.021382262110857, 19.614280219066238, 21.62449657189241, 25.299425181954714, 0.5742048663648589, -2.5541719975032287, 15.988720496775858, 21.7672293446877, 14.974798150567668, -1.5427156441835876, 1.2729476896121614, -12.113608577072261, 12.022142666899878, 21.132285806437817, 11.01864100669016, 40.90562804710472, 30.910709534296707, 46.78416179188855, 19.274260750102126, 22.250030059088758, 22.98082803593909, 15.540787758425505, 16.402754288369664, 11.132476564758669, 21.258736150316764, 3.729341709130564, 30.483115551054134, 34.51789033853261, 31.37419892443456, 21.30392749693203, 17.34462623235697, -1.4621464116660015, 23.772239280917617, 24.467599258251262, 26.411814338523897, 9.413852348267422, 24.344505683366464, 30.54620735826087, 10.875153615901038, 8.07404973214351, 12.336708968870013, 17.9636002980593, 34.631891048790536, 21.34763760739068, 0.5426787951516712, 17.079426685410517, 29.633130893024223, -3.9233222875275224, 26.48978981506631, 27.438193662772164, 21.25237547975672, 29.102786720009117, 11.625172710566183, 25.263183630623356, -6.6416690359939174, 4.621181383158059, 15.09932184061047, 12.70654622091661, 17.940112742531504, 17.57199629505229, 17.675670881730106, -16.688134814955145, 9.781697799509494, 28.28294164623102, 2.457334123962987, -4.054262387990157, 32.463110793166514, 16.96563848305498, 2.1478106550759444, 28.1688747952052, 4.869433931463764, 16.65211333586501, -2.229776665853633, 27.887070920511576, -3.0286570785873046, 31.188145617363936, 29.364962277906113, 10.651548947891904, 13.554017066994078, 20.041422356053182, 25.740599248529378, 14.052746786513794, 43.22062536346321, 5.6444901589656595, 9.453526693673659, 29.349411942797687, 11.374426183788554, 29.016463256449462, 16.727412018682756, 35.08405700580458, 34.64851305815723, -7.587431214656803, 11.633258988684268, 24.25850760704812, 14.34614428798317, 30.79017633737942, 39.43993257834515, 38.064164817623244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5041397209576133, "mean_inference_ms": 1.7498993512271586, "mean_action_processing_ms": 0.21564139153964615, "mean_env_wait_ms": 0.1329380775964619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003224015235900879, "StateBufferConnector_ms": 0.002530217170715332, "ViewRequirementAgentConnector_ms": 0.0746544599533081}, "num_episodes": 27, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 489.6060943953183, "num_env_steps_trained_throughput_per_sec": 489.6060943953183, "timesteps_total": 712000, "num_env_steps_sampled_lifetime": 712000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 8433.954, "restore_workers_time_ms": 0.055, "training_step_time_ms": 8433.714, "sample_time_ms": 1210.752, "learn_time_ms": 7201.274, "learn_throughput": 555.457, "synch_weights_time_ms": 20.875}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 178, "trial_id": "1f352_00000", "date": "2024-08-11_15-22-51", "timestamp": 1723404171, "time_this_iter_s": 8.197705268859863, "time_total_s": 1679.8765795230865, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c891f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1679.8765795230865, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 46.633333333333326, "ram_util_percent": 82.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3409017687042555, "cur_kl_coeff": 2.2186712959340963e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.409599198276798, "policy_loss": -0.003387719585831898, "vf_loss": 2.4129869263619184, "vf_explained_var": 0.9080727934837342, "kl": 0.004638639359921844, "entropy": 0.2230210762936622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 171360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.168555823837717, "cur_kl_coeff": 1.3411045074462894e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.409218859982987, "policy_loss": -0.005668193260013747, "vf_loss": 2.414887057989836, "vf_explained_var": 0.9072366863489151, "kl": 0.007285392081347381, "entropy": 0.34519057578096785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 171360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 1432000, "num_agent_steps_trained": 1432000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.78416179188855, "predator_policy": -16.688134814955145}, "policy_reward_max": {"prey_policy": 16.688134814955145, "predator_policy": 46.78416179188855}, "policy_reward_mean": {"prey_policy": -17.862348108562635, "predator_policy": 17.862348108562635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-30.910709534296707, -46.78416179188855, -19.274260750102126, -22.250030059088758, -22.98082803593909, -15.540787758425505, -16.402754288369664, -11.132476564758669, -21.258736150316764, -3.729341709130564, -30.483115551054134, -34.51789033853261, -31.37419892443456, -21.30392749693203, -17.34462623235697, 1.4621464116660015, -23.772239280917617, -24.467599258251262, -26.411814338523897, -9.413852348267422, -24.344505683366464, -30.54620735826087, -10.875153615901038, -8.07404973214351, -12.336708968870013, -17.9636002980593, -34.631891048790536, -21.34763760739068, -0.5426787951516712, -17.079426685410517, -29.633130893024223, 3.9233222875275224, -26.48978981506631, -27.438193662772164, -21.25237547975672, -29.102786720009117, -11.625172710566183, -25.263183630623356, 6.6416690359939174, -4.621181383158059, -15.09932184061047, -12.70654622091661, -17.940112742531504, -17.57199629505229, -17.675670881730106, 16.688134814955145, -9.781697799509494, -28.28294164623102, -2.457334123962987, 4.054262387990157, -32.463110793166514, -16.96563848305498, -2.1478106550759444, -28.1688747952052, -4.869433931463764, -16.65211333586501, 2.229776665853633, -27.887070920511576, 3.0286570785873046, -31.188145617363936, -29.364962277906113, -10.651548947891904, -13.554017066994078, -20.041422356053182, -25.740599248529378, -14.052746786513794, -43.22062536346321, -5.6444901589656595, -9.453526693673659, -29.349411942797687, -11.374426183788554, -29.016463256449462, -16.727412018682756, -35.08405700580458, -34.64851305815723, 7.587431214656803, -11.633258988684268, -24.25850760704812, -14.34614428798317, -30.79017633737942, -39.43993257834515, -38.064164817623244, -1.1934039841332682, -9.859282883064516, -11.940557259743358, -10.43927911722074, -13.006776663199762, -8.079562336269355, -19.237372768432007, -43.2113164335487, -27.81410164977907, -10.712981592024352, -20.411807923792132, -19.22343475531192, -31.42345849738916, -17.176186012365775, -2.786782894102277, -8.133712755764604, -18.783368386302, -7.581573276157133], "policy_predator_policy_reward": [30.910709534296707, 46.78416179188855, 19.274260750102126, 22.250030059088758, 22.98082803593909, 15.540787758425505, 16.402754288369664, 11.132476564758669, 21.258736150316764, 3.729341709130564, 30.483115551054134, 34.51789033853261, 31.37419892443456, 21.30392749693203, 17.34462623235697, -1.4621464116660015, 23.772239280917617, 24.467599258251262, 26.411814338523897, 9.413852348267422, 24.344505683366464, 30.54620735826087, 10.875153615901038, 8.07404973214351, 12.336708968870013, 17.9636002980593, 34.631891048790536, 21.34763760739068, 0.5426787951516712, 17.079426685410517, 29.633130893024223, -3.9233222875275224, 26.48978981506631, 27.438193662772164, 21.25237547975672, 29.102786720009117, 11.625172710566183, 25.263183630623356, -6.6416690359939174, 4.621181383158059, 15.09932184061047, 12.70654622091661, 17.940112742531504, 17.57199629505229, 17.675670881730106, -16.688134814955145, 9.781697799509494, 28.28294164623102, 2.457334123962987, -4.054262387990157, 32.463110793166514, 16.96563848305498, 2.1478106550759444, 28.1688747952052, 4.869433931463764, 16.65211333586501, -2.229776665853633, 27.887070920511576, -3.0286570785873046, 31.188145617363936, 29.364962277906113, 10.651548947891904, 13.554017066994078, 20.041422356053182, 25.740599248529378, 14.052746786513794, 43.22062536346321, 5.6444901589656595, 9.453526693673659, 29.349411942797687, 11.374426183788554, 29.016463256449462, 16.727412018682756, 35.08405700580458, 34.64851305815723, -7.587431214656803, 11.633258988684268, 24.25850760704812, 14.34614428798317, 30.79017633737942, 39.43993257834515, 38.064164817623244, 1.1934039841332682, 9.859282883064516, 11.940557259743358, 10.43927911722074, 13.006776663199762, 8.079562336269355, 19.237372768432007, 43.2113164335487, 27.81410164977907, 10.712981592024352, 20.411807923792132, 19.22343475531192, 31.42345849738916, 17.176186012365775, 2.786782894102277, 8.133712755764604, 18.783368386302, 7.581573276157133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5008642042194787, "mean_inference_ms": 1.738717835433777, "mean_action_processing_ms": 0.2140483633992585, "mean_env_wait_ms": 0.1321359210468401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028276443481445312, "StateBufferConnector_ms": 0.0024394989013671875, "ViewRequirementAgentConnector_ms": 0.06495535373687744}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1432000, "num_agent_steps_trained": 1432000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 480.90504493481967, "num_env_steps_trained_throughput_per_sec": 480.90504493481967, "timesteps_total": 716000, "num_env_steps_sampled_lifetime": 716000, "num_agent_steps_sampled_lifetime": 1432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1432000, "timers": {"training_iteration_time_ms": 8317.714, "restore_workers_time_ms": 0.054, "training_step_time_ms": 8317.476, "sample_time_ms": 1098.367, "learn_time_ms": 7197.339, "learn_throughput": 555.761, "synch_weights_time_ms": 20.932}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 1432000, "num_agent_steps_trained": 1432000}, "done": false, "training_iteration": 179, "trial_id": "1f352_00000", "date": "2024-08-11_15-23-00", "timestamp": 1723404180, "time_this_iter_s": 8.353916883468628, "time_total_s": 1688.2304964065552, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c36310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1688.2304964065552, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 47.916666666666664, "ram_util_percent": 82.54166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3251822907477617, "cur_kl_coeff": 1.1093356479670482e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.272520304719607, "policy_loss": -0.0041960519651183855, "vf_loss": 2.276716366286079, "vf_explained_var": 0.9269311319415768, "kl": 0.0049417125723524675, "entropy": 0.23131290900055318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 172320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.215637835736076, "cur_kl_coeff": 1.3411045074462894e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3503383747612436, "policy_loss": -0.0029210127625750224, "vf_loss": 2.3532593922689555, "vf_explained_var": 0.9247514483829339, "kl": 0.004091717984759422, "entropy": 0.3298243538476527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 172320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -43.22062536346321, "predator_policy": -16.688134814955145}, "policy_reward_max": {"prey_policy": 16.688134814955145, "predator_policy": 43.22062536346321}, "policy_reward_mean": {"prey_policy": -18.10826631682713, "predator_policy": 18.10826631682713}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.411814338523897, -9.413852348267422, -24.344505683366464, -30.54620735826087, -10.875153615901038, -8.07404973214351, -12.336708968870013, -17.9636002980593, -34.631891048790536, -21.34763760739068, -0.5426787951516712, -17.079426685410517, -29.633130893024223, 3.9233222875275224, -26.48978981506631, -27.438193662772164, -21.25237547975672, -29.102786720009117, -11.625172710566183, -25.263183630623356, 6.6416690359939174, -4.621181383158059, -15.09932184061047, -12.70654622091661, -17.940112742531504, -17.57199629505229, -17.675670881730106, 16.688134814955145, -9.781697799509494, -28.28294164623102, -2.457334123962987, 4.054262387990157, -32.463110793166514, -16.96563848305498, -2.1478106550759444, -28.1688747952052, -4.869433931463764, -16.65211333586501, 2.229776665853633, -27.887070920511576, 3.0286570785873046, -31.188145617363936, -29.364962277906113, -10.651548947891904, -13.554017066994078, -20.041422356053182, -25.740599248529378, -14.052746786513794, -43.22062536346321, -5.6444901589656595, -9.453526693673659, -29.349411942797687, -11.374426183788554, -29.016463256449462, -16.727412018682756, -35.08405700580458, -34.64851305815723, 7.587431214656803, -11.633258988684268, -24.25850760704812, -14.34614428798317, -30.79017633737942, -39.43993257834515, -38.064164817623244, -1.1934039841332682, -9.859282883064516, -11.940557259743358, -10.43927911722074, -13.006776663199762, -8.079562336269355, -19.237372768432007, -43.2113164335487, -27.81410164977907, -10.712981592024352, -20.411807923792132, -19.22343475531192, -31.42345849738916, -17.176186012365775, -2.786782894102277, -8.133712755764604, -18.783368386302, -7.581573276157133, -14.478586058691663, -29.448657073936534, 2.772519751728641, -26.816162323202725, -9.339217734312124, -29.812419809805363, -24.819023332286125, -9.013995522843132, -40.19692017436173, -41.5512652946123, -6.710079006153811, -32.49319478454479, -18.977620329084917, -29.184444749985055, -36.46716759700232, -15.125910629112276, -38.04944731177604, -16.945766159596868], "policy_predator_policy_reward": [26.411814338523897, 9.413852348267422, 24.344505683366464, 30.54620735826087, 10.875153615901038, 8.07404973214351, 12.336708968870013, 17.9636002980593, 34.631891048790536, 21.34763760739068, 0.5426787951516712, 17.079426685410517, 29.633130893024223, -3.9233222875275224, 26.48978981506631, 27.438193662772164, 21.25237547975672, 29.102786720009117, 11.625172710566183, 25.263183630623356, -6.6416690359939174, 4.621181383158059, 15.09932184061047, 12.70654622091661, 17.940112742531504, 17.57199629505229, 17.675670881730106, -16.688134814955145, 9.781697799509494, 28.28294164623102, 2.457334123962987, -4.054262387990157, 32.463110793166514, 16.96563848305498, 2.1478106550759444, 28.1688747952052, 4.869433931463764, 16.65211333586501, -2.229776665853633, 27.887070920511576, -3.0286570785873046, 31.188145617363936, 29.364962277906113, 10.651548947891904, 13.554017066994078, 20.041422356053182, 25.740599248529378, 14.052746786513794, 43.22062536346321, 5.6444901589656595, 9.453526693673659, 29.349411942797687, 11.374426183788554, 29.016463256449462, 16.727412018682756, 35.08405700580458, 34.64851305815723, -7.587431214656803, 11.633258988684268, 24.25850760704812, 14.34614428798317, 30.79017633737942, 39.43993257834515, 38.064164817623244, 1.1934039841332682, 9.859282883064516, 11.940557259743358, 10.43927911722074, 13.006776663199762, 8.079562336269355, 19.237372768432007, 43.2113164335487, 27.81410164977907, 10.712981592024352, 20.411807923792132, 19.22343475531192, 31.42345849738916, 17.176186012365775, 2.786782894102277, 8.133712755764604, 18.783368386302, 7.581573276157133, 14.478586058691663, 29.448657073936534, -2.772519751728641, 26.816162323202725, 9.339217734312124, 29.812419809805363, 24.819023332286125, 9.013995522843132, 40.19692017436173, 41.5512652946123, 6.710079006153811, 32.49319478454479, 18.977620329084917, 29.184444749985055, 36.46716759700232, 15.125910629112276, 38.04944731177604, 16.945766159596868]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5002624243901186, "mean_inference_ms": 1.7364311469170017, "mean_action_processing_ms": 0.21379911884259353, "mean_env_wait_ms": 0.13196475658466966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034334659576416016, "StateBufferConnector_ms": 0.002488374710083008, "ViewRequirementAgentConnector_ms": 0.06512832641601562}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 482.4816995353632, "num_env_steps_trained_throughput_per_sec": 482.4816995353632, "timesteps_total": 720000, "num_env_steps_sampled_lifetime": 720000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 8300.443, "restore_workers_time_ms": 0.054, "training_step_time_ms": 8300.201, "sample_time_ms": 1142.733, "learn_time_ms": 7135.164, "learn_throughput": 560.604, "synch_weights_time_ms": 21.487}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 180, "trial_id": "1f352_00000", "date": "2024-08-11_15-23-08", "timestamp": 1723404188, "time_this_iter_s": 8.344315767288208, "time_total_s": 1696.5748121738434, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c6b1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1696.5748121738434, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 50.94166666666666, "ram_util_percent": 82.65833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4372235406190157, "cur_kl_coeff": 5.546678239835241e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9272132714589436, "policy_loss": -0.0051142176242137795, "vf_loss": 1.9323274878164132, "vf_explained_var": 0.9378856488193075, "kl": 0.0038459584444363692, "entropy": 0.16329097335692494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 173280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1456826624150076, "cur_kl_coeff": 6.705522537231447e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9823655830696225, "policy_loss": -0.0062755759337354295, "vf_loss": 1.9886411607265473, "vf_explained_var": 0.9338965033491452, "kl": 0.007510489884861115, "entropy": 0.3535831562553843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 173280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 1448000, "num_agent_steps_trained": 1448000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.94253234521935, "predator_policy": -16.688134814955145}, "policy_reward_max": {"prey_policy": 16.688134814955145, "predator_policy": 49.94253234521935}, "policy_reward_mean": {"prey_policy": -19.04972118541555, "predator_policy": 19.04972118541555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.625172710566183, -25.263183630623356, 6.6416690359939174, -4.621181383158059, -15.09932184061047, -12.70654622091661, -17.940112742531504, -17.57199629505229, -17.675670881730106, 16.688134814955145, -9.781697799509494, -28.28294164623102, -2.457334123962987, 4.054262387990157, -32.463110793166514, -16.96563848305498, -2.1478106550759444, -28.1688747952052, -4.869433931463764, -16.65211333586501, 2.229776665853633, -27.887070920511576, 3.0286570785873046, -31.188145617363936, -29.364962277906113, -10.651548947891904, -13.554017066994078, -20.041422356053182, -25.740599248529378, -14.052746786513794, -43.22062536346321, -5.6444901589656595, -9.453526693673659, -29.349411942797687, -11.374426183788554, -29.016463256449462, -16.727412018682756, -35.08405700580458, -34.64851305815723, 7.587431214656803, -11.633258988684268, -24.25850760704812, -14.34614428798317, -30.79017633737942, -39.43993257834515, -38.064164817623244, -1.1934039841332682, -9.859282883064516, -11.940557259743358, -10.43927911722074, -13.006776663199762, -8.079562336269355, -19.237372768432007, -43.2113164335487, -27.81410164977907, -10.712981592024352, -20.411807923792132, -19.22343475531192, -31.42345849738916, -17.176186012365775, -2.786782894102277, -8.133712755764604, -18.783368386302, -7.581573276157133, -14.478586058691663, -29.448657073936534, 2.772519751728641, -26.816162323202725, -9.339217734312124, -29.812419809805363, -24.819023332286125, -9.013995522843132, -40.19692017436173, -41.5512652946123, -6.710079006153811, -32.49319478454479, -18.977620329084917, -29.184444749985055, -36.46716759700232, -15.125910629112276, -38.04944731177604, -16.945766159596868, -28.657910369876124, -10.339820047505711, -36.95171691528347, -24.414143539791034, -41.73243917376801, -21.372621145504603, -25.84036187889729, -2.922612691457301, -17.126590588525335, -28.469183202242185, -12.092838891405775, -14.934086823418376, -29.732151929350405, -49.94253234521935, -32.92685490357759, -26.178804967999696, -36.47215980316413, 2.4008615949071306], "policy_predator_policy_reward": [11.625172710566183, 25.263183630623356, -6.6416690359939174, 4.621181383158059, 15.09932184061047, 12.70654622091661, 17.940112742531504, 17.57199629505229, 17.675670881730106, -16.688134814955145, 9.781697799509494, 28.28294164623102, 2.457334123962987, -4.054262387990157, 32.463110793166514, 16.96563848305498, 2.1478106550759444, 28.1688747952052, 4.869433931463764, 16.65211333586501, -2.229776665853633, 27.887070920511576, -3.0286570785873046, 31.188145617363936, 29.364962277906113, 10.651548947891904, 13.554017066994078, 20.041422356053182, 25.740599248529378, 14.052746786513794, 43.22062536346321, 5.6444901589656595, 9.453526693673659, 29.349411942797687, 11.374426183788554, 29.016463256449462, 16.727412018682756, 35.08405700580458, 34.64851305815723, -7.587431214656803, 11.633258988684268, 24.25850760704812, 14.34614428798317, 30.79017633737942, 39.43993257834515, 38.064164817623244, 1.1934039841332682, 9.859282883064516, 11.940557259743358, 10.43927911722074, 13.006776663199762, 8.079562336269355, 19.237372768432007, 43.2113164335487, 27.81410164977907, 10.712981592024352, 20.411807923792132, 19.22343475531192, 31.42345849738916, 17.176186012365775, 2.786782894102277, 8.133712755764604, 18.783368386302, 7.581573276157133, 14.478586058691663, 29.448657073936534, -2.772519751728641, 26.816162323202725, 9.339217734312124, 29.812419809805363, 24.819023332286125, 9.013995522843132, 40.19692017436173, 41.5512652946123, 6.710079006153811, 32.49319478454479, 18.977620329084917, 29.184444749985055, 36.46716759700232, 15.125910629112276, 38.04944731177604, 16.945766159596868, 28.657910369876124, 10.339820047505711, 36.95171691528347, 24.414143539791034, 41.73243917376801, 21.372621145504603, 25.84036187889729, 2.922612691457301, 17.126590588525335, 28.469183202242185, 12.092838891405775, 14.934086823418376, 29.732151929350405, 49.94253234521935, 32.92685490357759, 26.178804967999696, 36.47215980316413, -2.4008615949071306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49980698688679304, "mean_inference_ms": 1.7345126441093663, "mean_action_processing_ms": 0.21364978521158576, "mean_env_wait_ms": 0.13183172752379385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054168701171875, "StateBufferConnector_ms": 0.002563953399658203, "ViewRequirementAgentConnector_ms": 0.07167446613311768}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1448000, "num_agent_steps_trained": 1448000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.86764206280907, "num_env_steps_trained_throughput_per_sec": 442.86764206280907, "timesteps_total": 724000, "num_env_steps_sampled_lifetime": 724000, "num_agent_steps_sampled_lifetime": 1448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1448000, "timers": {"training_iteration_time_ms": 8369.342, "restore_workers_time_ms": 0.054, "training_step_time_ms": 8369.082, "sample_time_ms": 1161.794, "learn_time_ms": 7183.879, "learn_throughput": 556.802, "synch_weights_time_ms": 22.561}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 1448000, "num_agent_steps_trained": 1448000}, "done": false, "training_iteration": 181, "trial_id": "1f352_00000", "date": "2024-08-11_15-23-17", "timestamp": 1723404197, "time_this_iter_s": 9.08665919303894, "time_total_s": 1705.6614713668823, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c6be50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1705.6614713668823, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 51.95384615384616, "ram_util_percent": 82.73076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5544667854905128, "cur_kl_coeff": 2.7733391199176204e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6601102560758592, "policy_loss": -0.0025499684076445797, "vf_loss": 1.6626602208862702, "vf_explained_var": 0.9603658995901545, "kl": 0.0033808384268076714, "entropy": 0.1996070672137042, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 174240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.371561196198066, "cur_kl_coeff": 6.705522537231447e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.684903229214251, "policy_loss": -0.0044854164889936024, "vf_loss": 1.6893886469304562, "vf_explained_var": 0.9599567009136081, "kl": 0.005638276377697969, "entropy": 0.36121316213781635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 174240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.94253234521935, "predator_policy": -11.928700563698909}, "policy_reward_max": {"prey_policy": 11.928700563698909, "predator_policy": 49.94253234521935}, "policy_reward_mean": {"prey_policy": -20.4010387443317, "predator_policy": 20.4010387443317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-31.188145617363936, -29.364962277906113, -10.651548947891904, -13.554017066994078, -20.041422356053182, -25.740599248529378, -14.052746786513794, -43.22062536346321, -5.6444901589656595, -9.453526693673659, -29.349411942797687, -11.374426183788554, -29.016463256449462, -16.727412018682756, -35.08405700580458, -34.64851305815723, 7.587431214656803, -11.633258988684268, -24.25850760704812, -14.34614428798317, -30.79017633737942, -39.43993257834515, -38.064164817623244, -1.1934039841332682, -9.859282883064516, -11.940557259743358, -10.43927911722074, -13.006776663199762, -8.079562336269355, -19.237372768432007, -43.2113164335487, -27.81410164977907, -10.712981592024352, -20.411807923792132, -19.22343475531192, -31.42345849738916, -17.176186012365775, -2.786782894102277, -8.133712755764604, -18.783368386302, -7.581573276157133, -14.478586058691663, -29.448657073936534, 2.772519751728641, -26.816162323202725, -9.339217734312124, -29.812419809805363, -24.819023332286125, -9.013995522843132, -40.19692017436173, -41.5512652946123, -6.710079006153811, -32.49319478454479, -18.977620329084917, -29.184444749985055, -36.46716759700232, -15.125910629112276, -38.04944731177604, -16.945766159596868, -28.657910369876124, -10.339820047505711, -36.95171691528347, -24.414143539791034, -41.73243917376801, -21.372621145504603, -25.84036187889729, -2.922612691457301, -17.126590588525335, -28.469183202242185, -12.092838891405775, -14.934086823418376, -29.732151929350405, -49.94253234521935, -32.92685490357759, -26.178804967999696, -36.47215980316413, 2.4008615949071306, -16.233507497861517, -24.04821338496736, -20.256939645751018, -18.54210546606306, -35.22070279317542, -15.681506382133712, -25.143665455915, -38.08028876041267, -28.252708821000518, 11.928700563698909, -46.46079738862277, -12.733051831737438, -22.137302958969023, -19.731523791844772, -24.503772152488793, 3.0295649836672354, -9.87386613028692, 5.168119481177808, -7.244589474102778, -24.60991104055792, 5.8685172419757645, -22.563572979700027, -9.345344412398907], "policy_predator_policy_reward": [31.188145617363936, 29.364962277906113, 10.651548947891904, 13.554017066994078, 20.041422356053182, 25.740599248529378, 14.052746786513794, 43.22062536346321, 5.6444901589656595, 9.453526693673659, 29.349411942797687, 11.374426183788554, 29.016463256449462, 16.727412018682756, 35.08405700580458, 34.64851305815723, -7.587431214656803, 11.633258988684268, 24.25850760704812, 14.34614428798317, 30.79017633737942, 39.43993257834515, 38.064164817623244, 1.1934039841332682, 9.859282883064516, 11.940557259743358, 10.43927911722074, 13.006776663199762, 8.079562336269355, 19.237372768432007, 43.2113164335487, 27.81410164977907, 10.712981592024352, 20.411807923792132, 19.22343475531192, 31.42345849738916, 17.176186012365775, 2.786782894102277, 8.133712755764604, 18.783368386302, 7.581573276157133, 14.478586058691663, 29.448657073936534, -2.772519751728641, 26.816162323202725, 9.339217734312124, 29.812419809805363, 24.819023332286125, 9.013995522843132, 40.19692017436173, 41.5512652946123, 6.710079006153811, 32.49319478454479, 18.977620329084917, 29.184444749985055, 36.46716759700232, 15.125910629112276, 38.04944731177604, 16.945766159596868, 28.657910369876124, 10.339820047505711, 36.95171691528347, 24.414143539791034, 41.73243917376801, 21.372621145504603, 25.84036187889729, 2.922612691457301, 17.126590588525335, 28.469183202242185, 12.092838891405775, 14.934086823418376, 29.732151929350405, 49.94253234521935, 32.92685490357759, 26.178804967999696, 36.47215980316413, -2.4008615949071306, 16.233507497861517, 24.04821338496736, 20.256939645751018, 18.54210546606306, 35.22070279317542, 15.681506382133712, 25.143665455915, 38.08028876041267, 28.252708821000518, -11.928700563698909, 46.46079738862277, 12.733051831737438, 22.137302958969023, 19.731523791844772, 24.503772152488793, -3.0295649836672354, 9.87386613028692, -5.168119481177808, 7.244589474102778, 24.60991104055792, -5.8685172419757645, 22.563572979700027, 9.345344412398907]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5001217623996854, "mean_inference_ms": 1.7343354217876565, "mean_action_processing_ms": 0.2138069271398453, "mean_env_wait_ms": 0.13178575858765057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006526827812194824, "StateBufferConnector_ms": 0.0025222301483154297, "ViewRequirementAgentConnector_ms": 0.07034635543823242}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 464.0019262317513, "num_env_steps_trained_throughput_per_sec": 464.0019262317513, "timesteps_total": 728000, "num_env_steps_sampled_lifetime": 728000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 8374.947, "restore_workers_time_ms": 0.054, "training_step_time_ms": 8374.676, "sample_time_ms": 1138.177, "learn_time_ms": 7212.897, "learn_throughput": 554.562, "synch_weights_time_ms": 22.631}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 182, "trial_id": "1f352_00000", "date": "2024-08-11_15-23-26", "timestamp": 1723404206, "time_this_iter_s": 8.666452884674072, "time_total_s": 1714.3279242515564, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c36310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1714.3279242515564, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 52.74999999999999, "ram_util_percent": 82.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0902300691852966, "cur_kl_coeff": 1.3866695599588102e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0808055165223778, "policy_loss": -0.0025980892845836935, "vf_loss": 1.0834036040119828, "vf_explained_var": 0.9781203658630451, "kl": 0.003145207476161582, "entropy": 0.18029828077803056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 175200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9244329471761983, "cur_kl_coeff": 6.705522537231447e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9917155143183967, "policy_loss": -0.005244584784425872, "vf_loss": 0.9969601015870769, "vf_explained_var": 0.9791540139044325, "kl": 0.005885012059432694, "entropy": 0.33557968800887467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 175200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.94253234521935, "predator_policy": -11.928700563698909}, "policy_reward_max": {"prey_policy": 11.928700563698909, "predator_policy": 49.94253234521935}, "policy_reward_mean": {"prey_policy": -19.40592458904608, "predator_policy": 19.40592458904608}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-38.064164817623244, -1.1934039841332682, -9.859282883064516, -11.940557259743358, -10.43927911722074, -13.006776663199762, -8.079562336269355, -19.237372768432007, -43.2113164335487, -27.81410164977907, -10.712981592024352, -20.411807923792132, -19.22343475531192, -31.42345849738916, -17.176186012365775, -2.786782894102277, -8.133712755764604, -18.783368386302, -7.581573276157133, -14.478586058691663, -29.448657073936534, 2.772519751728641, -26.816162323202725, -9.339217734312124, -29.812419809805363, -24.819023332286125, -9.013995522843132, -40.19692017436173, -41.5512652946123, -6.710079006153811, -32.49319478454479, -18.977620329084917, -29.184444749985055, -36.46716759700232, -15.125910629112276, -38.04944731177604, -16.945766159596868, -28.657910369876124, -10.339820047505711, -36.95171691528347, -24.414143539791034, -41.73243917376801, -21.372621145504603, -25.84036187889729, -2.922612691457301, -17.126590588525335, -28.469183202242185, -12.092838891405775, -14.934086823418376, -29.732151929350405, -49.94253234521935, -32.92685490357759, -26.178804967999696, -36.47215980316413, 2.4008615949071306, -16.233507497861517, -24.04821338496736, -20.256939645751018, -18.54210546606306, -35.22070279317542, -15.681506382133712, -25.143665455915, -38.08028876041267, -28.252708821000518, 11.928700563698909, -46.46079738862277, -12.733051831737438, -22.137302958969023, -19.731523791844772, -24.503772152488793, 3.0295649836672354, -9.87386613028692, 5.168119481177808, -7.244589474102778, -24.60991104055792, 5.8685172419757645, -22.563572979700027, -9.345344412398907, -36.09886190338958, -29.481332935820117, -15.274659521720757, -23.45239197411665, -11.06159169277053, -4.2513781008589255, -39.32312824098285, -18.91786257560855, -9.943735801146286, -0.4930236454045751, -18.060053537972827, -47.36566850625736, -6.700957448584635, -25.71872377246501, 4.843594038334196, -13.255215632498022, -18.790499985836867, -12.30507242819227, -28.371967167439138, -13.012024326485875, -10.545576442245283, 5.098590562205704], "policy_predator_policy_reward": [38.064164817623244, 1.1934039841332682, 9.859282883064516, 11.940557259743358, 10.43927911722074, 13.006776663199762, 8.079562336269355, 19.237372768432007, 43.2113164335487, 27.81410164977907, 10.712981592024352, 20.411807923792132, 19.22343475531192, 31.42345849738916, 17.176186012365775, 2.786782894102277, 8.133712755764604, 18.783368386302, 7.581573276157133, 14.478586058691663, 29.448657073936534, -2.772519751728641, 26.816162323202725, 9.339217734312124, 29.812419809805363, 24.819023332286125, 9.013995522843132, 40.19692017436173, 41.5512652946123, 6.710079006153811, 32.49319478454479, 18.977620329084917, 29.184444749985055, 36.46716759700232, 15.125910629112276, 38.04944731177604, 16.945766159596868, 28.657910369876124, 10.339820047505711, 36.95171691528347, 24.414143539791034, 41.73243917376801, 21.372621145504603, 25.84036187889729, 2.922612691457301, 17.126590588525335, 28.469183202242185, 12.092838891405775, 14.934086823418376, 29.732151929350405, 49.94253234521935, 32.92685490357759, 26.178804967999696, 36.47215980316413, -2.4008615949071306, 16.233507497861517, 24.04821338496736, 20.256939645751018, 18.54210546606306, 35.22070279317542, 15.681506382133712, 25.143665455915, 38.08028876041267, 28.252708821000518, -11.928700563698909, 46.46079738862277, 12.733051831737438, 22.137302958969023, 19.731523791844772, 24.503772152488793, -3.0295649836672354, 9.87386613028692, -5.168119481177808, 7.244589474102778, 24.60991104055792, -5.8685172419757645, 22.563572979700027, 9.345344412398907, 36.09886190338958, 29.481332935820117, 15.274659521720757, 23.45239197411665, 11.06159169277053, 4.2513781008589255, 39.32312824098285, 18.91786257560855, 9.943735801146286, 0.4930236454045751, 18.060053537972827, 47.36566850625736, 6.700957448584635, 25.71872377246501, -4.843594038334196, 13.255215632498022, 18.790499985836867, 12.30507242819227, 28.371967167439138, 13.012024326485875, 10.545576442245283, -5.098590562205704]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49883550769255236, "mean_inference_ms": 1.7303642434176314, "mean_action_processing_ms": 0.21337126583755062, "mean_env_wait_ms": 0.13157734145588074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012063980102539062, "StateBufferConnector_ms": 0.002925276756286621, "ViewRequirementAgentConnector_ms": 0.07455730438232422}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 458.3626835670829, "num_env_steps_trained_throughput_per_sec": 458.3626835670829, "timesteps_total": 732000, "num_env_steps_sampled_lifetime": 732000, "num_agent_steps_sampled_lifetime": 1464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 8460.654, "restore_workers_time_ms": 0.041, "training_step_time_ms": 8460.289, "sample_time_ms": 1144.629, "learn_time_ms": 7290.099, "learn_throughput": 548.689, "synch_weights_time_ms": 23.994}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "training_iteration": 183, "trial_id": "1f352_00000", "date": "2024-08-11_15-23-35", "timestamp": 1723404215, "time_this_iter_s": 8.753193855285645, "time_total_s": 1723.081118106842, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c658b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1723.081118106842, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 50.650000000000006, "ram_util_percent": 82.425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8065144843732317, "cur_kl_coeff": 6.933347799794051e-34, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8345955849004288, "policy_loss": -0.001999841589956001, "vf_loss": 0.8365954260031382, "vf_explained_var": 0.9875253062695265, "kl": 0.0031089853109976437, "entropy": 0.1988301326792377, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 176160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.703860398878654, "cur_kl_coeff": 6.705522537231447e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7670865199218194, "policy_loss": -0.004876604495802894, "vf_loss": 0.7719631221145391, "vf_explained_var": 0.9885922750458122, "kl": 0.00715455847197255, "entropy": 0.29580962914042175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 176160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.94253234521935, "predator_policy": -11.928700563698909}, "policy_reward_max": {"prey_policy": 11.928700563698909, "predator_policy": 49.94253234521935}, "policy_reward_mean": {"prey_policy": -19.953876591859135, "predator_policy": 19.953876591859135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-7.581573276157133, -14.478586058691663, -29.448657073936534, 2.772519751728641, -26.816162323202725, -9.339217734312124, -29.812419809805363, -24.819023332286125, -9.013995522843132, -40.19692017436173, -41.5512652946123, -6.710079006153811, -32.49319478454479, -18.977620329084917, -29.184444749985055, -36.46716759700232, -15.125910629112276, -38.04944731177604, -16.945766159596868, -28.657910369876124, -10.339820047505711, -36.95171691528347, -24.414143539791034, -41.73243917376801, -21.372621145504603, -25.84036187889729, -2.922612691457301, -17.126590588525335, -28.469183202242185, -12.092838891405775, -14.934086823418376, -29.732151929350405, -49.94253234521935, -32.92685490357759, -26.178804967999696, -36.47215980316413, 2.4008615949071306, -16.233507497861517, -24.04821338496736, -20.256939645751018, -18.54210546606306, -35.22070279317542, -15.681506382133712, -25.143665455915, -38.08028876041267, -28.252708821000518, 11.928700563698909, -46.46079738862277, -12.733051831737438, -22.137302958969023, -19.731523791844772, -24.503772152488793, 3.0295649836672354, -9.87386613028692, 5.168119481177808, -7.244589474102778, -24.60991104055792, 5.8685172419757645, -22.563572979700027, -9.345344412398907, -36.09886190338958, -29.481332935820117, -15.274659521720757, -23.45239197411665, -11.06159169277053, -4.2513781008589255, -39.32312824098285, -18.91786257560855, -9.943735801146286, -0.4930236454045751, -18.060053537972827, -47.36566850625736, -6.700957448584635, -25.71872377246501, 4.843594038334196, -13.255215632498022, -18.790499985836867, -12.30507242819227, -28.371967167439138, -13.012024326485875, -10.545576442245283, 5.098590562205704, -25.751171558133144, -36.572966575841434, -5.772090922788635, -16.018428692182823, -35.47991306574652, -34.438717385656254, -15.843162490802541, -37.852416482783184, -7.28331918433137, -5.306119709411515, -11.266626578956302, -11.708254998461616, -16.52463169736766, -41.796305606834245, -16.424624239132392, -5.220070684771741, -1.7930298456835727, -41.24090129248671], "policy_predator_policy_reward": [7.581573276157133, 14.478586058691663, 29.448657073936534, -2.772519751728641, 26.816162323202725, 9.339217734312124, 29.812419809805363, 24.819023332286125, 9.013995522843132, 40.19692017436173, 41.5512652946123, 6.710079006153811, 32.49319478454479, 18.977620329084917, 29.184444749985055, 36.46716759700232, 15.125910629112276, 38.04944731177604, 16.945766159596868, 28.657910369876124, 10.339820047505711, 36.95171691528347, 24.414143539791034, 41.73243917376801, 21.372621145504603, 25.84036187889729, 2.922612691457301, 17.126590588525335, 28.469183202242185, 12.092838891405775, 14.934086823418376, 29.732151929350405, 49.94253234521935, 32.92685490357759, 26.178804967999696, 36.47215980316413, -2.4008615949071306, 16.233507497861517, 24.04821338496736, 20.256939645751018, 18.54210546606306, 35.22070279317542, 15.681506382133712, 25.143665455915, 38.08028876041267, 28.252708821000518, -11.928700563698909, 46.46079738862277, 12.733051831737438, 22.137302958969023, 19.731523791844772, 24.503772152488793, -3.0295649836672354, 9.87386613028692, -5.168119481177808, 7.244589474102778, 24.60991104055792, -5.8685172419757645, 22.563572979700027, 9.345344412398907, 36.09886190338958, 29.481332935820117, 15.274659521720757, 23.45239197411665, 11.06159169277053, 4.2513781008589255, 39.32312824098285, 18.91786257560855, 9.943735801146286, 0.4930236454045751, 18.060053537972827, 47.36566850625736, 6.700957448584635, 25.71872377246501, -4.843594038334196, 13.255215632498022, 18.790499985836867, 12.30507242819227, 28.371967167439138, 13.012024326485875, 10.545576442245283, -5.098590562205704, 25.751171558133144, 36.572966575841434, 5.772090922788635, 16.018428692182823, 35.47991306574652, 34.438717385656254, 15.843162490802541, 37.852416482783184, 7.28331918433137, 5.306119709411515, 11.266626578956302, 11.708254998461616, 16.52463169736766, 41.796305606834245, 16.424624239132392, 5.220070684771741, 1.7930298456835727, 41.24090129248671]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4987002780289774, "mean_inference_ms": 1.7297020837200199, "mean_action_processing_ms": 0.21336162784163862, "mean_env_wait_ms": 0.13155613267684965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012683749198913574, "StateBufferConnector_ms": 0.0044127702713012695, "ViewRequirementAgentConnector_ms": 0.07775115966796875}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 452.06469003654115, "num_env_steps_trained_throughput_per_sec": 452.06469003654115, "timesteps_total": 736000, "num_env_steps_sampled_lifetime": 736000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 8505.747, "restore_workers_time_ms": 0.042, "training_step_time_ms": 8505.126, "sample_time_ms": 1147.821, "learn_time_ms": 7331.465, "learn_throughput": 545.594, "synch_weights_time_ms": 24.168}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 184, "trial_id": "1f352_00000", "date": "2024-08-11_15-23-44", "timestamp": 1723404224, "time_this_iter_s": 8.916560173034668, "time_total_s": 1731.9976782798767, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c6baf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1731.9976782798767, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 48.71538461538462, "ram_util_percent": 82.38461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.140877622862657, "cur_kl_coeff": 3.4666738998970255e-34, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.151094941298167, "policy_loss": -0.0027495569884194992, "vf_loss": 2.1538444896539053, "vf_explained_var": 0.9404331843058268, "kl": 0.004829894811672897, "entropy": 0.31046819761395456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 177120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.022045024173955, "cur_kl_coeff": 6.705522537231447e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.159096798176567, "policy_loss": -0.0018911043172314143, "vf_loss": 2.1609879040469724, "vf_explained_var": 0.9419651485358675, "kl": 0.0025092199876273055, "entropy": 0.37085599803055325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 177120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.94253234521935, "predator_policy": -18.549042398579417}, "policy_reward_max": {"prey_policy": 18.549042398579417, "predator_policy": 49.94253234521935}, "policy_reward_mean": {"prey_policy": -19.4111362967135, "predator_policy": 19.4111362967135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.945766159596868, -28.657910369876124, -10.339820047505711, -36.95171691528347, -24.414143539791034, -41.73243917376801, -21.372621145504603, -25.84036187889729, -2.922612691457301, -17.126590588525335, -28.469183202242185, -12.092838891405775, -14.934086823418376, -29.732151929350405, -49.94253234521935, -32.92685490357759, -26.178804967999696, -36.47215980316413, 2.4008615949071306, -16.233507497861517, -24.04821338496736, -20.256939645751018, -18.54210546606306, -35.22070279317542, -15.681506382133712, -25.143665455915, -38.08028876041267, -28.252708821000518, 11.928700563698909, -46.46079738862277, -12.733051831737438, -22.137302958969023, -19.731523791844772, -24.503772152488793, 3.0295649836672354, -9.87386613028692, 5.168119481177808, -7.244589474102778, -24.60991104055792, 5.8685172419757645, -22.563572979700027, -9.345344412398907, -36.09886190338958, -29.481332935820117, -15.274659521720757, -23.45239197411665, -11.06159169277053, -4.2513781008589255, -39.32312824098285, -18.91786257560855, -9.943735801146286, -0.4930236454045751, -18.060053537972827, -47.36566850625736, -6.700957448584635, -25.71872377246501, 4.843594038334196, -13.255215632498022, -18.790499985836867, -12.30507242819227, -28.371967167439138, -13.012024326485875, -10.545576442245283, 5.098590562205704, -25.751171558133144, -36.572966575841434, -5.772090922788635, -16.018428692182823, -35.47991306574652, -34.438717385656254, -15.843162490802541, -37.852416482783184, -7.28331918433137, -5.306119709411515, -11.266626578956302, -11.708254998461616, -16.52463169736766, -41.796305606834245, -16.424624239132392, -5.220070684771741, -1.7930298456835727, -41.24090129248671, -20.387063119739544, -31.653284736190074, -26.75745841584946, -4.528108593616986, -23.87517834833774, -19.38867038469219, -41.062148050657335, -27.98388564708604, -23.27816065662807, -11.079475353074628, -26.73179417090366, -38.26820470382274, 18.549042398579417, -2.252743627044691, -23.0125063174222, -7.045770005927695, -20.251504740901158, -24.012221268261545], "policy_predator_policy_reward": [16.945766159596868, 28.657910369876124, 10.339820047505711, 36.95171691528347, 24.414143539791034, 41.73243917376801, 21.372621145504603, 25.84036187889729, 2.922612691457301, 17.126590588525335, 28.469183202242185, 12.092838891405775, 14.934086823418376, 29.732151929350405, 49.94253234521935, 32.92685490357759, 26.178804967999696, 36.47215980316413, -2.4008615949071306, 16.233507497861517, 24.04821338496736, 20.256939645751018, 18.54210546606306, 35.22070279317542, 15.681506382133712, 25.143665455915, 38.08028876041267, 28.252708821000518, -11.928700563698909, 46.46079738862277, 12.733051831737438, 22.137302958969023, 19.731523791844772, 24.503772152488793, -3.0295649836672354, 9.87386613028692, -5.168119481177808, 7.244589474102778, 24.60991104055792, -5.8685172419757645, 22.563572979700027, 9.345344412398907, 36.09886190338958, 29.481332935820117, 15.274659521720757, 23.45239197411665, 11.06159169277053, 4.2513781008589255, 39.32312824098285, 18.91786257560855, 9.943735801146286, 0.4930236454045751, 18.060053537972827, 47.36566850625736, 6.700957448584635, 25.71872377246501, -4.843594038334196, 13.255215632498022, 18.790499985836867, 12.30507242819227, 28.371967167439138, 13.012024326485875, 10.545576442245283, -5.098590562205704, 25.751171558133144, 36.572966575841434, 5.772090922788635, 16.018428692182823, 35.47991306574652, 34.438717385656254, 15.843162490802541, 37.852416482783184, 7.28331918433137, 5.306119709411515, 11.266626578956302, 11.708254998461616, 16.52463169736766, 41.796305606834245, 16.424624239132392, 5.220070684771741, 1.7930298456835727, 41.24090129248671, 20.387063119739544, 31.653284736190074, 26.75745841584946, 4.528108593616986, 23.87517834833774, 19.38867038469219, 41.062148050657335, 27.98388564708604, 23.27816065662807, 11.079475353074628, 26.73179417090366, 38.26820470382274, -18.549042398579417, 2.252743627044691, 23.0125063174222, 7.045770005927695, 20.251504740901158, 24.012221268261545]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4983735471974948, "mean_inference_ms": 1.728393901720484, "mean_action_processing_ms": 0.2132736893901694, "mean_env_wait_ms": 0.13148287710210108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01318347454071045, "StateBufferConnector_ms": 0.004849672317504883, "ViewRequirementAgentConnector_ms": 0.07530999183654785}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.12685987952295, "num_env_steps_trained_throughput_per_sec": 498.12685987952295, "timesteps_total": 740000, "num_env_steps_sampled_lifetime": 740000, "num_agent_steps_sampled_lifetime": 1480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1480000, "timers": {"training_iteration_time_ms": 8438.823, "restore_workers_time_ms": 0.043, "training_step_time_ms": 8438.204, "sample_time_ms": 1101.051, "learn_time_ms": 7312.03, "learn_throughput": 547.044, "synch_weights_time_ms": 23.477}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "done": false, "training_iteration": 185, "trial_id": "1f352_00000", "date": "2024-08-11_15-23-52", "timestamp": 1723404232, "time_this_iter_s": 8.03608226776123, "time_total_s": 1740.033760547638, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c6bee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1740.033760547638, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 46.08333333333334, "ram_util_percent": 82.27499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9568123862147333, "cur_kl_coeff": 1.7333369499485127e-34, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.426957981412609, "policy_loss": -0.003996741049923003, "vf_loss": 2.430954727033774, "vf_explained_var": 0.9316097610940536, "kl": 0.0028928422114165475, "entropy": 0.2868038285213212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 178080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.883894122640292, "cur_kl_coeff": 3.3527612686157236e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4583611467232305, "policy_loss": -0.007859326497903869, "vf_loss": 2.4662204743673404, "vf_explained_var": 0.9325905594353875, "kl": 0.009514357684943475, "entropy": 0.33481795620173216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 178080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.31947454233754, "predator_policy": -18.549042398579417}, "policy_reward_max": {"prey_policy": 18.549042398579417, "predator_policy": 50.31947454233754}, "policy_reward_mean": {"prey_policy": -17.74338659284691, "predator_policy": 17.74338659284691}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.4008615949071306, -16.233507497861517, -24.04821338496736, -20.256939645751018, -18.54210546606306, -35.22070279317542, -15.681506382133712, -25.143665455915, -38.08028876041267, -28.252708821000518, 11.928700563698909, -46.46079738862277, -12.733051831737438, -22.137302958969023, -19.731523791844772, -24.503772152488793, 3.0295649836672354, -9.87386613028692, 5.168119481177808, -7.244589474102778, -24.60991104055792, 5.8685172419757645, -22.563572979700027, -9.345344412398907, -36.09886190338958, -29.481332935820117, -15.274659521720757, -23.45239197411665, -11.06159169277053, -4.2513781008589255, -39.32312824098285, -18.91786257560855, -9.943735801146286, -0.4930236454045751, -18.060053537972827, -47.36566850625736, -6.700957448584635, -25.71872377246501, 4.843594038334196, -13.255215632498022, -18.790499985836867, -12.30507242819227, -28.371967167439138, -13.012024326485875, -10.545576442245283, 5.098590562205704, -25.751171558133144, -36.572966575841434, -5.772090922788635, -16.018428692182823, -35.47991306574652, -34.438717385656254, -15.843162490802541, -37.852416482783184, -7.28331918433137, -5.306119709411515, -11.266626578956302, -11.708254998461616, -16.52463169736766, -41.796305606834245, -16.424624239132392, -5.220070684771741, -1.7930298456835727, -41.24090129248671, -20.387063119739544, -31.653284736190074, -26.75745841584946, -4.528108593616986, -23.87517834833774, -19.38867038469219, -41.062148050657335, -27.98388564708604, -23.27816065662807, -11.079475353074628, -26.73179417090366, -38.26820470382274, 18.549042398579417, -2.252743627044691, -23.0125063174222, -7.045770005927695, -20.251504740901158, -24.012221268261545, -16.031440675259688, -36.02717513925825, -13.098839335024202, -41.156109013771584, -26.615883406949287, -2.7310121397934193, 0.5254644688759136, -7.891619312968777, -10.523809603891475, -29.307155979079536, -10.876214857292487, -34.43246820324939, -13.31995981359056, -6.250493407490065, -50.31947454233754, -10.68773394759787, 12.745319212815328, 5.720980705938938], "policy_predator_policy_reward": [-2.4008615949071306, 16.233507497861517, 24.04821338496736, 20.256939645751018, 18.54210546606306, 35.22070279317542, 15.681506382133712, 25.143665455915, 38.08028876041267, 28.252708821000518, -11.928700563698909, 46.46079738862277, 12.733051831737438, 22.137302958969023, 19.731523791844772, 24.503772152488793, -3.0295649836672354, 9.87386613028692, -5.168119481177808, 7.244589474102778, 24.60991104055792, -5.8685172419757645, 22.563572979700027, 9.345344412398907, 36.09886190338958, 29.481332935820117, 15.274659521720757, 23.45239197411665, 11.06159169277053, 4.2513781008589255, 39.32312824098285, 18.91786257560855, 9.943735801146286, 0.4930236454045751, 18.060053537972827, 47.36566850625736, 6.700957448584635, 25.71872377246501, -4.843594038334196, 13.255215632498022, 18.790499985836867, 12.30507242819227, 28.371967167439138, 13.012024326485875, 10.545576442245283, -5.098590562205704, 25.751171558133144, 36.572966575841434, 5.772090922788635, 16.018428692182823, 35.47991306574652, 34.438717385656254, 15.843162490802541, 37.852416482783184, 7.28331918433137, 5.306119709411515, 11.266626578956302, 11.708254998461616, 16.52463169736766, 41.796305606834245, 16.424624239132392, 5.220070684771741, 1.7930298456835727, 41.24090129248671, 20.387063119739544, 31.653284736190074, 26.75745841584946, 4.528108593616986, 23.87517834833774, 19.38867038469219, 41.062148050657335, 27.98388564708604, 23.27816065662807, 11.079475353074628, 26.73179417090366, 38.26820470382274, -18.549042398579417, 2.252743627044691, 23.0125063174222, 7.045770005927695, 20.251504740901158, 24.012221268261545, 16.031440675259688, 36.02717513925825, 13.098839335024202, 41.156109013771584, 26.615883406949287, 2.7310121397934193, -0.5254644688759136, 7.891619312968777, 10.523809603891475, 29.307155979079536, 10.876214857292487, 34.43246820324939, 13.31995981359056, 6.250493407490065, 50.31947454233754, 10.68773394759787, -12.745319212815328, -5.720980705938938]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4978629730086746, "mean_inference_ms": 1.7265376290276038, "mean_action_processing_ms": 0.2130848017176524, "mean_env_wait_ms": 0.13135225315387203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01073920726776123, "StateBufferConnector_ms": 0.004843711853027344, "ViewRequirementAgentConnector_ms": 0.0702524185180664}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 471.4425994342031, "num_env_steps_trained_throughput_per_sec": 471.4425994342031, "timesteps_total": 744000, "num_env_steps_sampled_lifetime": 744000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 8429.583, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8429.059, "sample_time_ms": 1087.075, "learn_time_ms": 7316.626, "learn_throughput": 546.7, "synch_weights_time_ms": 23.673}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 186, "trial_id": "1f352_00000", "date": "2024-08-11_15-24-00", "timestamp": 1723404240, "time_this_iter_s": 8.530364990234375, "time_total_s": 1748.5641255378723, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1db9700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1748.5641255378723, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 48.19166666666666, "ram_util_percent": 82.40833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.767337379852931, "cur_kl_coeff": 8.666684749742564e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.365082934498787, "policy_loss": -0.00023991896741790698, "vf_loss": 2.365322854494055, "vf_explained_var": 0.9369041062270601, "kl": 0.002999302662368346, "entropy": 0.24604661868264277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 179040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.676028448964159, "cur_kl_coeff": 3.3527612686157236e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.338474889472127, "policy_loss": -0.006967600934149232, "vf_loss": 2.345442500213782, "vf_explained_var": 0.938357844017446, "kl": 0.007834285290928113, "entropy": 0.3501922145485878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 179040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 1496000, "num_agent_steps_trained": 1496000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.31947454233754, "predator_policy": -18.549042398579417}, "policy_reward_max": {"prey_policy": 18.549042398579417, "predator_policy": 50.31947454233754}, "policy_reward_mean": {"prey_policy": -18.292587865612315, "predator_policy": 18.292587865612315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-23.45239197411665, -11.06159169277053, -4.2513781008589255, -39.32312824098285, -18.91786257560855, -9.943735801146286, -0.4930236454045751, -18.060053537972827, -47.36566850625736, -6.700957448584635, -25.71872377246501, 4.843594038334196, -13.255215632498022, -18.790499985836867, -12.30507242819227, -28.371967167439138, -13.012024326485875, -10.545576442245283, 5.098590562205704, -25.751171558133144, -36.572966575841434, -5.772090922788635, -16.018428692182823, -35.47991306574652, -34.438717385656254, -15.843162490802541, -37.852416482783184, -7.28331918433137, -5.306119709411515, -11.266626578956302, -11.708254998461616, -16.52463169736766, -41.796305606834245, -16.424624239132392, -5.220070684771741, -1.7930298456835727, -41.24090129248671, -20.387063119739544, -31.653284736190074, -26.75745841584946, -4.528108593616986, -23.87517834833774, -19.38867038469219, -41.062148050657335, -27.98388564708604, -23.27816065662807, -11.079475353074628, -26.73179417090366, -38.26820470382274, 18.549042398579417, -2.252743627044691, -23.0125063174222, -7.045770005927695, -20.251504740901158, -24.012221268261545, -16.031440675259688, -36.02717513925825, -13.098839335024202, -41.156109013771584, -26.615883406949287, -2.7310121397934193, 0.5254644688759136, -7.891619312968777, -10.523809603891475, -29.307155979079536, -10.876214857292487, -34.43246820324939, -13.31995981359056, -6.250493407490065, -50.31947454233754, -10.68773394759787, 12.745319212815328, 5.720980705938938, 1.7905095680784555, -5.8144048776371715, -29.439466371140174, -16.96304055157979, 1.0661384614764744, -3.1097769137682683, -20.55951609822968, -1.7748731852330772, -35.879428614494, -16.304196908484244, -11.147300446493475, -46.46830974608707, -30.262819153274638, -20.67997438910696, -8.20327244982787, -33.98469927818142, -21.206687812715487, -10.946412087975428, -14.644284004752096, -33.09764272410886, -42.0345979827985, -17.473293888056737, -8.191108916713903, -21.6603782154368, -21.72734849415221, -34.08809200773154, -25.23831105160909], "policy_predator_policy_reward": [23.45239197411665, 11.06159169277053, 4.2513781008589255, 39.32312824098285, 18.91786257560855, 9.943735801146286, 0.4930236454045751, 18.060053537972827, 47.36566850625736, 6.700957448584635, 25.71872377246501, -4.843594038334196, 13.255215632498022, 18.790499985836867, 12.30507242819227, 28.371967167439138, 13.012024326485875, 10.545576442245283, -5.098590562205704, 25.751171558133144, 36.572966575841434, 5.772090922788635, 16.018428692182823, 35.47991306574652, 34.438717385656254, 15.843162490802541, 37.852416482783184, 7.28331918433137, 5.306119709411515, 11.266626578956302, 11.708254998461616, 16.52463169736766, 41.796305606834245, 16.424624239132392, 5.220070684771741, 1.7930298456835727, 41.24090129248671, 20.387063119739544, 31.653284736190074, 26.75745841584946, 4.528108593616986, 23.87517834833774, 19.38867038469219, 41.062148050657335, 27.98388564708604, 23.27816065662807, 11.079475353074628, 26.73179417090366, 38.26820470382274, -18.549042398579417, 2.252743627044691, 23.0125063174222, 7.045770005927695, 20.251504740901158, 24.012221268261545, 16.031440675259688, 36.02717513925825, 13.098839335024202, 41.156109013771584, 26.615883406949287, 2.7310121397934193, -0.5254644688759136, 7.891619312968777, 10.523809603891475, 29.307155979079536, 10.876214857292487, 34.43246820324939, 13.31995981359056, 6.250493407490065, 50.31947454233754, 10.68773394759787, -12.745319212815328, -5.720980705938938, -1.7905095680784555, 5.8144048776371715, 29.439466371140174, 16.96304055157979, -1.0661384614764744, 3.1097769137682683, 20.55951609822968, 1.7748731852330772, 35.879428614494, 16.304196908484244, 11.147300446493475, 46.46830974608707, 30.262819153274638, 20.67997438910696, 8.20327244982787, 33.98469927818142, 21.206687812715487, 10.946412087975428, 14.644284004752096, 33.09764272410886, 42.0345979827985, 17.473293888056737, 8.191108916713903, 21.6603782154368, 21.72734849415221, 34.08809200773154, 25.23831105160909]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49993548498861295, "mean_inference_ms": 1.7328059380425713, "mean_action_processing_ms": 0.21413469540684996, "mean_env_wait_ms": 0.13179756467413262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009215712547302246, "StateBufferConnector_ms": 0.004873156547546387, "ViewRequirementAgentConnector_ms": 0.07167971134185791}, "num_episodes": 27, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1496000, "num_agent_steps_trained": 1496000, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 462.61824159903864, "num_env_steps_trained_throughput_per_sec": 462.61824159903864, "timesteps_total": 748000, "num_env_steps_sampled_lifetime": 748000, "num_agent_steps_sampled_lifetime": 1496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1496000, "timers": {"training_iteration_time_ms": 8516.744, "restore_workers_time_ms": 0.019, "training_step_time_ms": 8516.117, "sample_time_ms": 1091.195, "learn_time_ms": 7397.178, "learn_throughput": 540.747, "synch_weights_time_ms": 24.659}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 1496000, "num_agent_steps_trained": 1496000}, "done": false, "training_iteration": 187, "trial_id": "1f352_00000", "date": "2024-08-11_15-24-09", "timestamp": 1723404249, "time_this_iter_s": 8.72168779373169, "time_total_s": 1757.285813331604, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c890d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1757.285813331604, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 53.225, "ram_util_percent": 82.70833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.0166266271223625, "cur_kl_coeff": 4.333342374871282e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.235838045179844, "policy_loss": -0.003124102326304031, "vf_loss": 2.2389621425420048, "vf_explained_var": 0.934739888459444, "kl": 0.004141340313141366, "entropy": 0.23413078005736074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9668519565214715, "cur_kl_coeff": 3.3527612686157236e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.260450675835212, "policy_loss": -0.0029167271119755847, "vf_loss": 2.2633674070239067, "vf_explained_var": 0.9343482103198767, "kl": 0.004269047970125826, "entropy": 0.33292417783911027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.31947454233754, "predator_policy": -18.549042398579417}, "policy_reward_max": {"prey_policy": 18.549042398579417, "predator_policy": 50.31947454233754}, "policy_reward_mean": {"prey_policy": -18.274832776680483, "predator_policy": 18.274832776680483}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.098590562205704, -25.751171558133144, -36.572966575841434, -5.772090922788635, -16.018428692182823, -35.47991306574652, -34.438717385656254, -15.843162490802541, -37.852416482783184, -7.28331918433137, -5.306119709411515, -11.266626578956302, -11.708254998461616, -16.52463169736766, -41.796305606834245, -16.424624239132392, -5.220070684771741, -1.7930298456835727, -41.24090129248671, -20.387063119739544, -31.653284736190074, -26.75745841584946, -4.528108593616986, -23.87517834833774, -19.38867038469219, -41.062148050657335, -27.98388564708604, -23.27816065662807, -11.079475353074628, -26.73179417090366, -38.26820470382274, 18.549042398579417, -2.252743627044691, -23.0125063174222, -7.045770005927695, -20.251504740901158, -24.012221268261545, -16.031440675259688, -36.02717513925825, -13.098839335024202, -41.156109013771584, -26.615883406949287, -2.7310121397934193, 0.5254644688759136, -7.891619312968777, -10.523809603891475, -29.307155979079536, -10.876214857292487, -34.43246820324939, -13.31995981359056, -6.250493407490065, -50.31947454233754, -10.68773394759787, 12.745319212815328, 5.720980705938938, 1.7905095680784555, -5.8144048776371715, -29.439466371140174, -16.96304055157979, 1.0661384614764744, -3.1097769137682683, -20.55951609822968, -1.7748731852330772, -35.879428614494, -16.304196908484244, -11.147300446493475, -46.46830974608707, -30.262819153274638, -20.67997438910696, -8.20327244982787, -33.98469927818142, -21.206687812715487, -10.946412087975428, -14.644284004752096, -33.09764272410886, -42.0345979827985, -17.473293888056737, -8.191108916713903, -21.6603782154368, -21.72734849415221, -34.08809200773154, -25.23831105160909, -34.84345398293766, 1.2738153965339114, -7.32804188301397, -16.623607622281995, -26.71106039361853, -8.471697758011194, -16.566922167151198, -34.71070167145422, -7.455549864820757, -8.827187988136883, -33.19539803010232, -27.02598753241257, -29.03871181590767, -0.10315293804973713, -15.856739158689496, 4.4909582845545595, -9.6351142676248, -24.32121495422368], "policy_predator_policy_reward": [-5.098590562205704, 25.751171558133144, 36.572966575841434, 5.772090922788635, 16.018428692182823, 35.47991306574652, 34.438717385656254, 15.843162490802541, 37.852416482783184, 7.28331918433137, 5.306119709411515, 11.266626578956302, 11.708254998461616, 16.52463169736766, 41.796305606834245, 16.424624239132392, 5.220070684771741, 1.7930298456835727, 41.24090129248671, 20.387063119739544, 31.653284736190074, 26.75745841584946, 4.528108593616986, 23.87517834833774, 19.38867038469219, 41.062148050657335, 27.98388564708604, 23.27816065662807, 11.079475353074628, 26.73179417090366, 38.26820470382274, -18.549042398579417, 2.252743627044691, 23.0125063174222, 7.045770005927695, 20.251504740901158, 24.012221268261545, 16.031440675259688, 36.02717513925825, 13.098839335024202, 41.156109013771584, 26.615883406949287, 2.7310121397934193, -0.5254644688759136, 7.891619312968777, 10.523809603891475, 29.307155979079536, 10.876214857292487, 34.43246820324939, 13.31995981359056, 6.250493407490065, 50.31947454233754, 10.68773394759787, -12.745319212815328, -5.720980705938938, -1.7905095680784555, 5.8144048776371715, 29.439466371140174, 16.96304055157979, -1.0661384614764744, 3.1097769137682683, 20.55951609822968, 1.7748731852330772, 35.879428614494, 16.304196908484244, 11.147300446493475, 46.46830974608707, 30.262819153274638, 20.67997438910696, 8.20327244982787, 33.98469927818142, 21.206687812715487, 10.946412087975428, 14.644284004752096, 33.09764272410886, 42.0345979827985, 17.473293888056737, 8.191108916713903, 21.6603782154368, 21.72734849415221, 34.08809200773154, 25.23831105160909, 34.84345398293766, -1.2738153965339114, 7.32804188301397, 16.623607622281995, 26.71106039361853, 8.471697758011194, 16.566922167151198, 34.71070167145422, 7.455549864820757, 8.827187988136883, 33.19539803010232, 27.02598753241257, 29.03871181590767, 0.10315293804973713, 15.856739158689496, -4.4909582845545595, 9.6351142676248, 24.32121495422368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4969447228961913, "mean_inference_ms": 1.72267859902305, "mean_action_processing_ms": 0.21262679915300162, "mean_env_wait_ms": 0.13106097956196117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004505515098571777, "StateBufferConnector_ms": 0.004617810249328613, "ViewRequirementAgentConnector_ms": 0.07002902030944824}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 409.3002894633332, "num_env_steps_trained_throughput_per_sec": 409.3002894633332, "timesteps_total": 752000, "num_env_steps_sampled_lifetime": 752000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 8677.037, "restore_workers_time_ms": 0.02, "training_step_time_ms": 8676.416, "sample_time_ms": 1146.642, "learn_time_ms": 7502.167, "learn_throughput": 533.179, "synch_weights_time_ms": 24.456}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 188, "trial_id": "1f352_00000", "date": "2024-08-11_15-24-19", "timestamp": 1723404259, "time_this_iter_s": 9.831218957901001, "time_total_s": 1767.117032289505, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1ca9af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1767.117032289505, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 58.135714285714286, "ram_util_percent": 83.24999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.46428961964945, "cur_kl_coeff": 2.166671187435641e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6136837621529898, "policy_loss": -0.002726852489286102, "vf_loss": 1.6164106174061696, "vf_explained_var": 0.9605141727253794, "kl": 0.0024301361027341275, "entropy": 0.21389615138371784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2663268878435097, "cur_kl_coeff": 1.6763806343078618e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6035477453532319, "policy_loss": -0.0028320806539947323, "vf_loss": 1.6063798325136305, "vf_explained_var": 0.960576569971939, "kl": 0.005236093185946925, "entropy": 0.33775181917784114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.31947454233754, "predator_policy": -18.549042398579417}, "policy_reward_max": {"prey_policy": 18.549042398579417, "predator_policy": 50.31947454233754}, "policy_reward_mean": {"prey_policy": -17.160942879489347, "predator_policy": 17.160942879489347}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-41.24090129248671, -20.387063119739544, -31.653284736190074, -26.75745841584946, -4.528108593616986, -23.87517834833774, -19.38867038469219, -41.062148050657335, -27.98388564708604, -23.27816065662807, -11.079475353074628, -26.73179417090366, -38.26820470382274, 18.549042398579417, -2.252743627044691, -23.0125063174222, -7.045770005927695, -20.251504740901158, -24.012221268261545, -16.031440675259688, -36.02717513925825, -13.098839335024202, -41.156109013771584, -26.615883406949287, -2.7310121397934193, 0.5254644688759136, -7.891619312968777, -10.523809603891475, -29.307155979079536, -10.876214857292487, -34.43246820324939, -13.31995981359056, -6.250493407490065, -50.31947454233754, -10.68773394759787, 12.745319212815328, 5.720980705938938, 1.7905095680784555, -5.8144048776371715, -29.439466371140174, -16.96304055157979, 1.0661384614764744, -3.1097769137682683, -20.55951609822968, -1.7748731852330772, -35.879428614494, -16.304196908484244, -11.147300446493475, -46.46830974608707, -30.262819153274638, -20.67997438910696, -8.20327244982787, -33.98469927818142, -21.206687812715487, -10.946412087975428, -14.644284004752096, -33.09764272410886, -42.0345979827985, -17.473293888056737, -8.191108916713903, -21.6603782154368, -21.72734849415221, -34.08809200773154, -25.23831105160909, -34.84345398293766, 1.2738153965339114, -7.32804188301397, -16.623607622281995, -26.71106039361853, -8.471697758011194, -16.566922167151198, -34.71070167145422, -7.455549864820757, -8.827187988136883, -33.19539803010232, -27.02598753241257, -29.03871181590767, -0.10315293804973713, -15.856739158689496, 4.4909582845545595, -9.6351142676248, -24.32121495422368, -10.37673511888972, -27.131507064261363, -20.0366307889068, -1.1330230322124626, -0.8258891924355911, -9.38926389904299, -10.520617186769838, -11.698239235625566, -3.6739878739885414, -16.63693659790399, -4.519580708450796, -30.354335060352135, -15.35162588430331, -4.919798460305142, -29.878032242871157, -3.7397337086402356, -0.6258191543215652, -7.752514228284845], "policy_predator_policy_reward": [41.24090129248671, 20.387063119739544, 31.653284736190074, 26.75745841584946, 4.528108593616986, 23.87517834833774, 19.38867038469219, 41.062148050657335, 27.98388564708604, 23.27816065662807, 11.079475353074628, 26.73179417090366, 38.26820470382274, -18.549042398579417, 2.252743627044691, 23.0125063174222, 7.045770005927695, 20.251504740901158, 24.012221268261545, 16.031440675259688, 36.02717513925825, 13.098839335024202, 41.156109013771584, 26.615883406949287, 2.7310121397934193, -0.5254644688759136, 7.891619312968777, 10.523809603891475, 29.307155979079536, 10.876214857292487, 34.43246820324939, 13.31995981359056, 6.250493407490065, 50.31947454233754, 10.68773394759787, -12.745319212815328, -5.720980705938938, -1.7905095680784555, 5.8144048776371715, 29.439466371140174, 16.96304055157979, -1.0661384614764744, 3.1097769137682683, 20.55951609822968, 1.7748731852330772, 35.879428614494, 16.304196908484244, 11.147300446493475, 46.46830974608707, 30.262819153274638, 20.67997438910696, 8.20327244982787, 33.98469927818142, 21.206687812715487, 10.946412087975428, 14.644284004752096, 33.09764272410886, 42.0345979827985, 17.473293888056737, 8.191108916713903, 21.6603782154368, 21.72734849415221, 34.08809200773154, 25.23831105160909, 34.84345398293766, -1.2738153965339114, 7.32804188301397, 16.623607622281995, 26.71106039361853, 8.471697758011194, 16.566922167151198, 34.71070167145422, 7.455549864820757, 8.827187988136883, 33.19539803010232, 27.02598753241257, 29.03871181590767, 0.10315293804973713, 15.856739158689496, -4.4909582845545595, 9.6351142676248, 24.32121495422368, 10.37673511888972, 27.131507064261363, 20.0366307889068, 1.1330230322124626, 0.8258891924355911, 9.38926389904299, 10.520617186769838, 11.698239235625566, 3.6739878739885414, 16.63693659790399, 4.519580708450796, 30.354335060352135, 15.35162588430331, 4.919798460305142, 29.878032242871157, 3.7397337086402356, 0.6258191543215652, 7.752514228284845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4966119457763064, "mean_inference_ms": 1.7212739254731824, "mean_action_processing_ms": 0.21245487140382302, "mean_env_wait_ms": 0.13093846546383314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040585994720458984, "StateBufferConnector_ms": 0.003287672996520996, "ViewRequirementAgentConnector_ms": 0.07542586326599121}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 423.37701468665534, "num_env_steps_trained_throughput_per_sec": 423.37701468665534, "timesteps_total": 756000, "num_env_steps_sampled_lifetime": 756000, "num_agent_steps_sampled_lifetime": 1512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 8790.059, "restore_workers_time_ms": 0.02, "training_step_time_ms": 8789.419, "sample_time_ms": 1192.219, "learn_time_ms": 7568.709, "learn_throughput": 528.492, "synch_weights_time_ms": 25.293}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": false, "training_iteration": 189, "trial_id": "1f352_00000", "date": "2024-08-11_15-24-29", "timestamp": 1723404269, "time_this_iter_s": 9.495625972747803, "time_total_s": 1776.6126582622528, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1dfeaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1776.6126582622528, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 55.75000000000001, "ram_util_percent": 82.71428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.371951514855027, "cur_kl_coeff": 1.0833355937178205e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.533773769127826, "policy_loss": -0.0021129736123839393, "vf_loss": 1.5358867400636276, "vf_explained_var": 0.9693381722395619, "kl": 0.0026468838959386363, "entropy": 0.1938727749977261, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 181920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.472532015790542, "cur_kl_coeff": 1.6763806343078618e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5354890006283919, "policy_loss": -0.004860036793494752, "vf_loss": 1.5403490408634146, "vf_explained_var": 0.9697484998653333, "kl": 0.004898532087380179, "entropy": 0.33271171286081275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 181920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.31947454233754, "predator_policy": -12.819454419405378}, "policy_reward_max": {"prey_policy": 12.819454419405378, "predator_policy": 50.31947454233754}, "policy_reward_mean": {"prey_policy": -16.85389992078394, "predator_policy": 16.85389992078394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.012221268261545, -16.031440675259688, -36.02717513925825, -13.098839335024202, -41.156109013771584, -26.615883406949287, -2.7310121397934193, 0.5254644688759136, -7.891619312968777, -10.523809603891475, -29.307155979079536, -10.876214857292487, -34.43246820324939, -13.31995981359056, -6.250493407490065, -50.31947454233754, -10.68773394759787, 12.745319212815328, 5.720980705938938, 1.7905095680784555, -5.8144048776371715, -29.439466371140174, -16.96304055157979, 1.0661384614764744, -3.1097769137682683, -20.55951609822968, -1.7748731852330772, -35.879428614494, -16.304196908484244, -11.147300446493475, -46.46830974608707, -30.262819153274638, -20.67997438910696, -8.20327244982787, -33.98469927818142, -21.206687812715487, -10.946412087975428, -14.644284004752096, -33.09764272410886, -42.0345979827985, -17.473293888056737, -8.191108916713903, -21.6603782154368, -21.72734849415221, -34.08809200773154, -25.23831105160909, -34.84345398293766, 1.2738153965339114, -7.32804188301397, -16.623607622281995, -26.71106039361853, -8.471697758011194, -16.566922167151198, -34.71070167145422, -7.455549864820757, -8.827187988136883, -33.19539803010232, -27.02598753241257, -29.03871181590767, -0.10315293804973713, -15.856739158689496, 4.4909582845545595, -9.6351142676248, -24.32121495422368, -10.37673511888972, -27.131507064261363, -20.0366307889068, -1.1330230322124626, -0.8258891924355911, -9.38926389904299, -10.520617186769838, -11.698239235625566, -3.6739878739885414, -16.63693659790399, -4.519580708450796, -30.354335060352135, -15.35162588430331, -4.919798460305142, -29.878032242871157, -3.7397337086402356, -0.6258191543215652, -7.752514228284845, -26.20089314651687, -41.398828957697, -19.652826549938816, -9.129565901519644, -11.052347068489404, -29.053737890399237, -15.862210293842026, -38.365215582041394, -13.407414693734687, -29.287262939796367, -6.173024602382504, -1.8446883319804277, -4.9671065870867075, -43.50858302408736, -8.230082190009464, 12.819454419405378, -45.444222209865416, -8.784964345278851], "policy_predator_policy_reward": [24.012221268261545, 16.031440675259688, 36.02717513925825, 13.098839335024202, 41.156109013771584, 26.615883406949287, 2.7310121397934193, -0.5254644688759136, 7.891619312968777, 10.523809603891475, 29.307155979079536, 10.876214857292487, 34.43246820324939, 13.31995981359056, 6.250493407490065, 50.31947454233754, 10.68773394759787, -12.745319212815328, -5.720980705938938, -1.7905095680784555, 5.8144048776371715, 29.439466371140174, 16.96304055157979, -1.0661384614764744, 3.1097769137682683, 20.55951609822968, 1.7748731852330772, 35.879428614494, 16.304196908484244, 11.147300446493475, 46.46830974608707, 30.262819153274638, 20.67997438910696, 8.20327244982787, 33.98469927818142, 21.206687812715487, 10.946412087975428, 14.644284004752096, 33.09764272410886, 42.0345979827985, 17.473293888056737, 8.191108916713903, 21.6603782154368, 21.72734849415221, 34.08809200773154, 25.23831105160909, 34.84345398293766, -1.2738153965339114, 7.32804188301397, 16.623607622281995, 26.71106039361853, 8.471697758011194, 16.566922167151198, 34.71070167145422, 7.455549864820757, 8.827187988136883, 33.19539803010232, 27.02598753241257, 29.03871181590767, 0.10315293804973713, 15.856739158689496, -4.4909582845545595, 9.6351142676248, 24.32121495422368, 10.37673511888972, 27.131507064261363, 20.0366307889068, 1.1330230322124626, 0.8258891924355911, 9.38926389904299, 10.520617186769838, 11.698239235625566, 3.6739878739885414, 16.63693659790399, 4.519580708450796, 30.354335060352135, 15.35162588430331, 4.919798460305142, 29.878032242871157, 3.7397337086402356, 0.6258191543215652, 7.752514228284845, 26.20089314651687, 41.398828957697, 19.652826549938816, 9.129565901519644, 11.052347068489404, 29.053737890399237, 15.862210293842026, 38.365215582041394, 13.407414693734687, 29.287262939796367, 6.173024602382504, 1.8446883319804277, 4.9671065870867075, 43.50858302408736, 8.230082190009464, -12.819454419405378, 45.444222209865416, 8.784964345278851]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4963706188580778, "mean_inference_ms": 1.7200757763605485, "mean_action_processing_ms": 0.2123134381610089, "mean_env_wait_ms": 0.13082633911513156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004149198532104492, "StateBufferConnector_ms": 0.003978371620178223, "ViewRequirementAgentConnector_ms": 0.07744824886322021}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.03903711911727, "num_env_steps_trained_throughput_per_sec": 501.03903711911727, "timesteps_total": 760000, "num_env_steps_sampled_lifetime": 760000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 8759.366, "restore_workers_time_ms": 0.02, "training_step_time_ms": 8758.716, "sample_time_ms": 1158.116, "learn_time_ms": 7572.864, "learn_throughput": 528.202, "synch_weights_time_ms": 24.55}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 190, "trial_id": "1f352_00000", "date": "2024-08-11_15-24-37", "timestamp": 1723404277, "time_this_iter_s": 8.014728307723999, "time_total_s": 1784.6273865699768, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1dfee50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1784.6273865699768, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 50.24545454545455, "ram_util_percent": 82.87272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.454084894557794, "cur_kl_coeff": 5.416677968589102e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4668766419713697, "policy_loss": -0.0022384385233939004, "vf_loss": 1.4691150833542148, "vf_explained_var": 0.9669632996742924, "kl": 0.002475147998801693, "entropy": 0.23836941464493672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 182880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2488523018856843, "cur_kl_coeff": 8.381903171539309e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4607564095718166, "policy_loss": -0.004622389508585911, "vf_loss": 1.4653788045048715, "vf_explained_var": 0.9664196778088808, "kl": 0.004233298407442798, "entropy": 0.3186192825902253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 182880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 1528000, "num_agent_steps_trained": 1528000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.46830974608707, "predator_policy": -12.819454419405378}, "policy_reward_max": {"prey_policy": 12.819454419405378, "predator_policy": 46.46830974608707}, "policy_reward_mean": {"prey_policy": -16.376288719227897, "predator_policy": 16.376288719227897}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.0661384614764744, -3.1097769137682683, -20.55951609822968, -1.7748731852330772, -35.879428614494, -16.304196908484244, -11.147300446493475, -46.46830974608707, -30.262819153274638, -20.67997438910696, -8.20327244982787, -33.98469927818142, -21.206687812715487, -10.946412087975428, -14.644284004752096, -33.09764272410886, -42.0345979827985, -17.473293888056737, -8.191108916713903, -21.6603782154368, -21.72734849415221, -34.08809200773154, -25.23831105160909, -34.84345398293766, 1.2738153965339114, -7.32804188301397, -16.623607622281995, -26.71106039361853, -8.471697758011194, -16.566922167151198, -34.71070167145422, -7.455549864820757, -8.827187988136883, -33.19539803010232, -27.02598753241257, -29.03871181590767, -0.10315293804973713, -15.856739158689496, 4.4909582845545595, -9.6351142676248, -24.32121495422368, -10.37673511888972, -27.131507064261363, -20.0366307889068, -1.1330230322124626, -0.8258891924355911, -9.38926389904299, -10.520617186769838, -11.698239235625566, -3.6739878739885414, -16.63693659790399, -4.519580708450796, -30.354335060352135, -15.35162588430331, -4.919798460305142, -29.878032242871157, -3.7397337086402356, -0.6258191543215652, -7.752514228284845, -26.20089314651687, -41.398828957697, -19.652826549938816, -9.129565901519644, -11.052347068489404, -29.053737890399237, -15.862210293842026, -38.365215582041394, -13.407414693734687, -29.287262939796367, -6.173024602382504, -1.8446883319804277, -4.9671065870867075, -43.50858302408736, -8.230082190009464, 12.819454419405378, -45.444222209865416, -8.784964345278851, -17.980819816607344, -6.824284820419208, 1.8961187160923885, 0.62968821855074, -3.64158628272917, 12.57154009058721, -1.3380893869231922, -37.127542536720625, -31.522342473786743, -3.1892606051132866, -21.98513714890286, -30.848597593561326, -18.22755262028503, -13.901300143934733, 3.091891681000634, -43.87736922759469, -6.503343275561354, -22.269110231147756, -21.831760636465237, -25.50794921108302, -10.539083375521997, -6.851694164185879, -11.177543490547283], "policy_predator_policy_reward": [-1.0661384614764744, 3.1097769137682683, 20.55951609822968, 1.7748731852330772, 35.879428614494, 16.304196908484244, 11.147300446493475, 46.46830974608707, 30.262819153274638, 20.67997438910696, 8.20327244982787, 33.98469927818142, 21.206687812715487, 10.946412087975428, 14.644284004752096, 33.09764272410886, 42.0345979827985, 17.473293888056737, 8.191108916713903, 21.6603782154368, 21.72734849415221, 34.08809200773154, 25.23831105160909, 34.84345398293766, -1.2738153965339114, 7.32804188301397, 16.623607622281995, 26.71106039361853, 8.471697758011194, 16.566922167151198, 34.71070167145422, 7.455549864820757, 8.827187988136883, 33.19539803010232, 27.02598753241257, 29.03871181590767, 0.10315293804973713, 15.856739158689496, -4.4909582845545595, 9.6351142676248, 24.32121495422368, 10.37673511888972, 27.131507064261363, 20.0366307889068, 1.1330230322124626, 0.8258891924355911, 9.38926389904299, 10.520617186769838, 11.698239235625566, 3.6739878739885414, 16.63693659790399, 4.519580708450796, 30.354335060352135, 15.35162588430331, 4.919798460305142, 29.878032242871157, 3.7397337086402356, 0.6258191543215652, 7.752514228284845, 26.20089314651687, 41.398828957697, 19.652826549938816, 9.129565901519644, 11.052347068489404, 29.053737890399237, 15.862210293842026, 38.365215582041394, 13.407414693734687, 29.287262939796367, 6.173024602382504, 1.8446883319804277, 4.9671065870867075, 43.50858302408736, 8.230082190009464, -12.819454419405378, 45.444222209865416, 8.784964345278851, 17.980819816607344, 6.824284820419208, -1.8961187160923885, -0.62968821855074, 3.64158628272917, -12.57154009058721, 1.3380893869231922, 37.127542536720625, 31.522342473786743, 3.1892606051132866, 21.98513714890286, 30.848597593561326, 18.22755262028503, 13.901300143934733, -3.091891681000634, 43.87736922759469, 6.503343275561354, 22.269110231147756, 21.831760636465237, 25.50794921108302, 10.539083375521997, 6.851694164185879, 11.177543490547283]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.497003554325786, "mean_inference_ms": 1.7211151016787536, "mean_action_processing_ms": 0.21253169428387678, "mean_env_wait_ms": 0.13085557715858248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005333423614501953, "StateBufferConnector_ms": 0.0035631656646728516, "ViewRequirementAgentConnector_ms": 0.08043277263641357}, "num_episodes": 23, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1528000, "num_agent_steps_trained": 1528000, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.34117552649525, "num_env_steps_trained_throughput_per_sec": 485.34117552649525, "timesteps_total": 764000, "num_env_steps_sampled_lifetime": 764000, "num_agent_steps_sampled_lifetime": 1528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1528000, "timers": {"training_iteration_time_ms": 8680.317, "restore_workers_time_ms": 0.021, "training_step_time_ms": 8679.688, "sample_time_ms": 1132.427, "learn_time_ms": 7520.473, "learn_throughput": 531.881, "synch_weights_time_ms": 23.591}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 1528000, "num_agent_steps_trained": 1528000}, "done": false, "training_iteration": 191, "trial_id": "1f352_00000", "date": "2024-08-11_15-24-45", "timestamp": 1723404285, "time_this_iter_s": 8.276795148849487, "time_total_s": 1792.9041817188263, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1ca9040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1792.9041817188263, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 47.85833333333333, "ram_util_percent": 82.68333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.243900526066621, "cur_kl_coeff": 2.708338984294551e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4239070273314913, "policy_loss": -0.0027372517230105585, "vf_loss": 1.4266442756478985, "vf_explained_var": 0.9650182218601306, "kl": 0.002893269944874403, "entropy": 0.2128982050033907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 183840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.978298221093913, "cur_kl_coeff": 4.1909515857696545e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2984818841330708, "policy_loss": -0.0031447953360232836, "vf_loss": 1.3016266769419114, "vf_explained_var": 0.9690092598398526, "kl": 0.004211874142661583, "entropy": 0.29016670609513917, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 183840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -45.444222209865416, "predator_policy": -12.819454419405378}, "policy_reward_max": {"prey_policy": 12.819454419405378, "predator_policy": 45.444222209865416}, "policy_reward_mean": {"prey_policy": -15.381563628754629, "predator_policy": 15.381563628754629}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-25.23831105160909, -34.84345398293766, 1.2738153965339114, -7.32804188301397, -16.623607622281995, -26.71106039361853, -8.471697758011194, -16.566922167151198, -34.71070167145422, -7.455549864820757, -8.827187988136883, -33.19539803010232, -27.02598753241257, -29.03871181590767, -0.10315293804973713, -15.856739158689496, 4.4909582845545595, -9.6351142676248, -24.32121495422368, -10.37673511888972, -27.131507064261363, -20.0366307889068, -1.1330230322124626, -0.8258891924355911, -9.38926389904299, -10.520617186769838, -11.698239235625566, -3.6739878739885414, -16.63693659790399, -4.519580708450796, -30.354335060352135, -15.35162588430331, -4.919798460305142, -29.878032242871157, -3.7397337086402356, -0.6258191543215652, -7.752514228284845, -26.20089314651687, -41.398828957697, -19.652826549938816, -9.129565901519644, -11.052347068489404, -29.053737890399237, -15.862210293842026, -38.365215582041394, -13.407414693734687, -29.287262939796367, -6.173024602382504, -1.8446883319804277, -4.9671065870867075, -43.50858302408736, -8.230082190009464, 12.819454419405378, -45.444222209865416, -8.784964345278851, -17.980819816607344, -6.824284820419208, 1.8961187160923885, 0.62968821855074, -3.64158628272917, 12.57154009058721, -1.3380893869231922, -37.127542536720625, -31.522342473786743, -3.1892606051132866, -21.98513714890286, -30.848597593561326, -18.22755262028503, -13.901300143934733, 3.091891681000634, -43.87736922759469, -6.503343275561354, -22.269110231147756, -21.831760636465237, -25.50794921108302, -10.539083375521997, -6.851694164185879, -11.177543490547283, -37.84891244520725, -9.764834356017206, -24.05746350085525, -24.740262834197488, -10.321636503638718, 10.631873491515147, 3.66658966260683, -2.8666478033128087, -9.690580261171792, -19.842288900519016, -27.824627311910117, -18.40475964295156, -16.431404306365017, -24.897797261226692, -27.70205712410752, -29.7890227397636, -3.80928885600481, -3.21633623487949, -12.708909127179215, -28.185482408346132, -14.402960227385266, -20.69855711790201], "policy_predator_policy_reward": [25.23831105160909, 34.84345398293766, -1.2738153965339114, 7.32804188301397, 16.623607622281995, 26.71106039361853, 8.471697758011194, 16.566922167151198, 34.71070167145422, 7.455549864820757, 8.827187988136883, 33.19539803010232, 27.02598753241257, 29.03871181590767, 0.10315293804973713, 15.856739158689496, -4.4909582845545595, 9.6351142676248, 24.32121495422368, 10.37673511888972, 27.131507064261363, 20.0366307889068, 1.1330230322124626, 0.8258891924355911, 9.38926389904299, 10.520617186769838, 11.698239235625566, 3.6739878739885414, 16.63693659790399, 4.519580708450796, 30.354335060352135, 15.35162588430331, 4.919798460305142, 29.878032242871157, 3.7397337086402356, 0.6258191543215652, 7.752514228284845, 26.20089314651687, 41.398828957697, 19.652826549938816, 9.129565901519644, 11.052347068489404, 29.053737890399237, 15.862210293842026, 38.365215582041394, 13.407414693734687, 29.287262939796367, 6.173024602382504, 1.8446883319804277, 4.9671065870867075, 43.50858302408736, 8.230082190009464, -12.819454419405378, 45.444222209865416, 8.784964345278851, 17.980819816607344, 6.824284820419208, -1.8961187160923885, -0.62968821855074, 3.64158628272917, -12.57154009058721, 1.3380893869231922, 37.127542536720625, 31.522342473786743, 3.1892606051132866, 21.98513714890286, 30.848597593561326, 18.22755262028503, 13.901300143934733, -3.091891681000634, 43.87736922759469, 6.503343275561354, 22.269110231147756, 21.831760636465237, 25.50794921108302, 10.539083375521997, 6.851694164185879, 11.177543490547283, 37.84891244520725, 9.764834356017206, 24.05746350085525, 24.740262834197488, 10.321636503638718, -10.631873491515147, -3.66658966260683, 2.8666478033128087, 9.690580261171792, 19.842288900519016, 27.824627311910117, 18.40475964295156, 16.431404306365017, 24.897797261226692, 27.70205712410752, 29.7890227397636, 3.80928885600481, 3.21633623487949, 12.708909127179215, 28.185482408346132, 14.402960227385266, 20.69855711790201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49574941210950185, "mean_inference_ms": 1.717561845077031, "mean_action_processing_ms": 0.21201255780227066, "mean_env_wait_ms": 0.13059635500605477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005130648612976074, "StateBufferConnector_ms": 0.0036743879318237305, "ViewRequirementAgentConnector_ms": 0.07991743087768555}, "num_episodes": 22, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.05176574420096, "num_env_steps_trained_throughput_per_sec": 486.05176574420096, "timesteps_total": 768000, "num_env_steps_sampled_lifetime": 768000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 8641.206, "restore_workers_time_ms": 0.021, "training_step_time_ms": 8640.582, "sample_time_ms": 1135.494, "learn_time_ms": 7478.322, "learn_throughput": 534.879, "synch_weights_time_ms": 23.662}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 192, "trial_id": "1f352_00000", "date": "2024-08-11_15-24-53", "timestamp": 1723404293, "time_this_iter_s": 8.265408992767334, "time_total_s": 1801.1695907115936, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1ca9940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1801.1695907115936, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 55.14166666666667, "ram_util_percent": 82.73333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4602235134691, "cur_kl_coeff": 1.3541694921472756e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5847276794413725, "policy_loss": -0.00015871505602262914, "vf_loss": 1.5848863983526826, "vf_explained_var": 0.953616349088649, "kl": 0.0018997377814661339, "entropy": 0.2071083317666004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 184800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0245964784175157, "cur_kl_coeff": 2.0954757928848272e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5841870666791995, "policy_loss": -0.00660310285165906, "vf_loss": 1.5907901706174017, "vf_explained_var": 0.9535620850200455, "kl": 0.006569697697839002, "entropy": 0.3215087244908015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 184800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 1544000, "num_agent_steps_trained": 1544000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -45.444222209865416, "predator_policy": -12.819454419405378}, "policy_reward_max": {"prey_policy": 12.819454419405378, "predator_policy": 45.444222209865416}, "policy_reward_mean": {"prey_policy": -15.569501866684027, "predator_policy": 15.569501866684027}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.32121495422368, -10.37673511888972, -27.131507064261363, -20.0366307889068, -1.1330230322124626, -0.8258891924355911, -9.38926389904299, -10.520617186769838, -11.698239235625566, -3.6739878739885414, -16.63693659790399, -4.519580708450796, -30.354335060352135, -15.35162588430331, -4.919798460305142, -29.878032242871157, -3.7397337086402356, -0.6258191543215652, -7.752514228284845, -26.20089314651687, -41.398828957697, -19.652826549938816, -9.129565901519644, -11.052347068489404, -29.053737890399237, -15.862210293842026, -38.365215582041394, -13.407414693734687, -29.287262939796367, -6.173024602382504, -1.8446883319804277, -4.9671065870867075, -43.50858302408736, -8.230082190009464, 12.819454419405378, -45.444222209865416, -8.784964345278851, -17.980819816607344, -6.824284820419208, 1.8961187160923885, 0.62968821855074, -3.64158628272917, 12.57154009058721, -1.3380893869231922, -37.127542536720625, -31.522342473786743, -3.1892606051132866, -21.98513714890286, -30.848597593561326, -18.22755262028503, -13.901300143934733, 3.091891681000634, -43.87736922759469, -6.503343275561354, -22.269110231147756, -21.831760636465237, -25.50794921108302, -10.539083375521997, -6.851694164185879, -11.177543490547283, -37.84891244520725, -9.764834356017206, -24.05746350085525, -24.740262834197488, -10.321636503638718, 10.631873491515147, 3.66658966260683, -2.8666478033128087, -9.690580261171792, -19.842288900519016, -27.824627311910117, -18.40475964295156, -16.431404306365017, -24.897797261226692, -27.70205712410752, -29.7890227397636, -3.80928885600481, -3.21633623487949, -12.708909127179215, -28.185482408346132, -14.402960227385266, -20.69855711790201, -34.34423840622624, -23.079432037087766, -21.519702927649988, -23.07556776231863, -2.9638005206452487, 4.039708490369078, -34.02734021324981, -17.687647135096576, 0.2546988919259938, -16.480055231163796, -37.1863757730209, -7.0645995165687365, 1.0767923650449713, -21.12841740985202, -4.014646289888486, -16.804635380287685, -29.183812036145696, -31.471617345811907], "policy_predator_policy_reward": [24.32121495422368, 10.37673511888972, 27.131507064261363, 20.0366307889068, 1.1330230322124626, 0.8258891924355911, 9.38926389904299, 10.520617186769838, 11.698239235625566, 3.6739878739885414, 16.63693659790399, 4.519580708450796, 30.354335060352135, 15.35162588430331, 4.919798460305142, 29.878032242871157, 3.7397337086402356, 0.6258191543215652, 7.752514228284845, 26.20089314651687, 41.398828957697, 19.652826549938816, 9.129565901519644, 11.052347068489404, 29.053737890399237, 15.862210293842026, 38.365215582041394, 13.407414693734687, 29.287262939796367, 6.173024602382504, 1.8446883319804277, 4.9671065870867075, 43.50858302408736, 8.230082190009464, -12.819454419405378, 45.444222209865416, 8.784964345278851, 17.980819816607344, 6.824284820419208, -1.8961187160923885, -0.62968821855074, 3.64158628272917, -12.57154009058721, 1.3380893869231922, 37.127542536720625, 31.522342473786743, 3.1892606051132866, 21.98513714890286, 30.848597593561326, 18.22755262028503, 13.901300143934733, -3.091891681000634, 43.87736922759469, 6.503343275561354, 22.269110231147756, 21.831760636465237, 25.50794921108302, 10.539083375521997, 6.851694164185879, 11.177543490547283, 37.84891244520725, 9.764834356017206, 24.05746350085525, 24.740262834197488, 10.321636503638718, -10.631873491515147, -3.66658966260683, 2.8666478033128087, 9.690580261171792, 19.842288900519016, 27.824627311910117, 18.40475964295156, 16.431404306365017, 24.897797261226692, 27.70205712410752, 29.7890227397636, 3.80928885600481, 3.21633623487949, 12.708909127179215, 28.185482408346132, 14.402960227385266, 20.69855711790201, 34.34423840622624, 23.079432037087766, 21.519702927649988, 23.07556776231863, 2.9638005206452487, -4.039708490369078, 34.02734021324981, 17.687647135096576, -0.2546988919259938, 16.480055231163796, 37.1863757730209, 7.0645995165687365, -1.0767923650449713, 21.12841740985202, 4.014646289888486, 16.804635380287685, 29.183812036145696, 31.471617345811907]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49543161118413054, "mean_inference_ms": 1.7162957048844356, "mean_action_processing_ms": 0.2118708748858988, "mean_env_wait_ms": 0.1304866296506189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052034854888916016, "StateBufferConnector_ms": 0.0038535594940185547, "ViewRequirementAgentConnector_ms": 0.09155881404876709}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1544000, "num_agent_steps_trained": 1544000, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 424.023335970566, "num_env_steps_trained_throughput_per_sec": 424.023335970566, "timesteps_total": 772000, "num_env_steps_sampled_lifetime": 772000, "num_agent_steps_sampled_lifetime": 1544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1544000, "timers": {"training_iteration_time_ms": 8711.878, "restore_workers_time_ms": 0.021, "training_step_time_ms": 8711.382, "sample_time_ms": 1133.853, "learn_time_ms": 7552.882, "learn_throughput": 529.599, "synch_weights_time_ms": 22.081}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 1544000, "num_agent_steps_trained": 1544000}, "done": false, "training_iteration": 193, "trial_id": "1f352_00000", "date": "2024-08-11_15-25-03", "timestamp": 1723404303, "time_this_iter_s": 9.475247859954834, "time_total_s": 1810.6448385715485, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1db9160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1810.6448385715485, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 55.89230769230768, "ram_util_percent": 82.89230769230768}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.2882509930680195, "cur_kl_coeff": 6.770847460736378e-37, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.887396838640173, "policy_loss": -0.0011339154788098918, "vf_loss": 2.88853074721992, "vf_explained_var": 0.9348277165244023, "kl": 0.0028722231252835766, "entropy": 0.29512487923105557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 185760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.027909080435832, "cur_kl_coeff": 2.0954757928848272e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7718418036897976, "policy_loss": -0.0032587449498047744, "vf_loss": 2.7751005510489146, "vf_explained_var": 0.9406165920197964, "kl": 0.005529510647559262, "entropy": 0.3594591920884947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 185760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.85315014466977, "predator_policy": -12.819454419405378}, "policy_reward_max": {"prey_policy": 12.819454419405378, "predator_policy": 46.85315014466977}, "policy_reward_mean": {"prey_policy": -16.871541687398206, "predator_policy": 16.871541687398206}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-7.752514228284845, -26.20089314651687, -41.398828957697, -19.652826549938816, -9.129565901519644, -11.052347068489404, -29.053737890399237, -15.862210293842026, -38.365215582041394, -13.407414693734687, -29.287262939796367, -6.173024602382504, -1.8446883319804277, -4.9671065870867075, -43.50858302408736, -8.230082190009464, 12.819454419405378, -45.444222209865416, -8.784964345278851, -17.980819816607344, -6.824284820419208, 1.8961187160923885, 0.62968821855074, -3.64158628272917, 12.57154009058721, -1.3380893869231922, -37.127542536720625, -31.522342473786743, -3.1892606051132866, -21.98513714890286, -30.848597593561326, -18.22755262028503, -13.901300143934733, 3.091891681000634, -43.87736922759469, -6.503343275561354, -22.269110231147756, -21.831760636465237, -25.50794921108302, -10.539083375521997, -6.851694164185879, -11.177543490547283, -37.84891244520725, -9.764834356017206, -24.05746350085525, -24.740262834197488, -10.321636503638718, 10.631873491515147, 3.66658966260683, -2.8666478033128087, -9.690580261171792, -19.842288900519016, -27.824627311910117, -18.40475964295156, -16.431404306365017, -24.897797261226692, -27.70205712410752, -29.7890227397636, -3.80928885600481, -3.21633623487949, -12.708909127179215, -28.185482408346132, -14.402960227385266, -20.69855711790201, -34.34423840622624, -23.079432037087766, -21.519702927649988, -23.07556776231863, -2.9638005206452487, 4.039708490369078, -34.02734021324981, -17.687647135096576, 0.2546988919259938, -16.480055231163796, -37.1863757730209, -7.0645995165687365, 1.0767923650449713, -21.12841740985202, -4.014646289888486, -16.804635380287685, -29.183812036145696, -31.471617345811907, -1.7874549125056056, -1.397729076348357, 1.2367401819104025, -29.208443216590926, -31.61487460496552, -13.89261920479774, -32.90214477345277, -29.67479355307697, -6.382669217669047, -23.324561222147494, -27.459514039537396, -18.860693211787712, -3.8768467138428946, -36.21636224827345, -27.80158775727207, -10.99597599569794, -14.32427252419747, -46.85315014466977], "policy_predator_policy_reward": [7.752514228284845, 26.20089314651687, 41.398828957697, 19.652826549938816, 9.129565901519644, 11.052347068489404, 29.053737890399237, 15.862210293842026, 38.365215582041394, 13.407414693734687, 29.287262939796367, 6.173024602382504, 1.8446883319804277, 4.9671065870867075, 43.50858302408736, 8.230082190009464, -12.819454419405378, 45.444222209865416, 8.784964345278851, 17.980819816607344, 6.824284820419208, -1.8961187160923885, -0.62968821855074, 3.64158628272917, -12.57154009058721, 1.3380893869231922, 37.127542536720625, 31.522342473786743, 3.1892606051132866, 21.98513714890286, 30.848597593561326, 18.22755262028503, 13.901300143934733, -3.091891681000634, 43.87736922759469, 6.503343275561354, 22.269110231147756, 21.831760636465237, 25.50794921108302, 10.539083375521997, 6.851694164185879, 11.177543490547283, 37.84891244520725, 9.764834356017206, 24.05746350085525, 24.740262834197488, 10.321636503638718, -10.631873491515147, -3.66658966260683, 2.8666478033128087, 9.690580261171792, 19.842288900519016, 27.824627311910117, 18.40475964295156, 16.431404306365017, 24.897797261226692, 27.70205712410752, 29.7890227397636, 3.80928885600481, 3.21633623487949, 12.708909127179215, 28.185482408346132, 14.402960227385266, 20.69855711790201, 34.34423840622624, 23.079432037087766, 21.519702927649988, 23.07556776231863, 2.9638005206452487, -4.039708490369078, 34.02734021324981, 17.687647135096576, -0.2546988919259938, 16.480055231163796, 37.1863757730209, 7.0645995165687365, -1.0767923650449713, 21.12841740985202, 4.014646289888486, 16.804635380287685, 29.183812036145696, 31.471617345811907, 1.7874549125056056, 1.397729076348357, -1.2367401819104025, 29.208443216590926, 31.61487460496552, 13.89261920479774, 32.90214477345277, 29.67479355307697, 6.382669217669047, 23.324561222147494, 27.459514039537396, 18.860693211787712, 3.8768467138428946, 36.21636224827345, 27.80158775727207, 10.99597599569794, 14.32427252419747, 46.85315014466977]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4949310322244051, "mean_inference_ms": 1.7142493053065728, "mean_action_processing_ms": 0.21165165057793217, "mean_env_wait_ms": 0.130330359910705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005059242248535156, "StateBufferConnector_ms": 0.00369417667388916, "ViewRequirementAgentConnector_ms": 0.08938884735107422}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.5880669613346, "num_env_steps_trained_throughput_per_sec": 505.5880669613346, "timesteps_total": 776000, "num_env_steps_sampled_lifetime": 776000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 8618.2, "restore_workers_time_ms": 0.02, "training_step_time_ms": 8617.938, "sample_time_ms": 1068.226, "learn_time_ms": 7518.99, "learn_throughput": 531.986, "synch_weights_time_ms": 28.145}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 194, "trial_id": "1f352_00000", "date": "2024-08-11_15-25-11", "timestamp": 1723404311, "time_this_iter_s": 7.9932029247283936, "time_total_s": 1818.6380414962769, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c651f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1818.6380414962769, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 47.76666666666666, "ram_util_percent": 83.09166666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4908547018965086, "cur_kl_coeff": 3.385423730368189e-37, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7059667266284426, "policy_loss": -0.0022525468297923605, "vf_loss": 1.7082192699114482, "vf_explained_var": 0.9592387835805615, "kl": 0.003707057385130123, "entropy": 0.2230327385322501, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 186720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4364819108198086, "cur_kl_coeff": 2.0954757928848272e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7326699278006952, "policy_loss": -0.00237230584655966, "vf_loss": 1.7350422389805318, "vf_explained_var": 0.9601335549727082, "kl": 0.006592722708124891, "entropy": 0.3203427334626516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 186720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.85315014466977, "predator_policy": -12.57154009058721}, "policy_reward_max": {"prey_policy": 12.57154009058721, "predator_policy": 46.85315014466977}, "policy_reward_mean": {"prey_policy": -17.177968004186926, "predator_policy": 17.177968004186926}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.784964345278851, -17.980819816607344, -6.824284820419208, 1.8961187160923885, 0.62968821855074, -3.64158628272917, 12.57154009058721, -1.3380893869231922, -37.127542536720625, -31.522342473786743, -3.1892606051132866, -21.98513714890286, -30.848597593561326, -18.22755262028503, -13.901300143934733, 3.091891681000634, -43.87736922759469, -6.503343275561354, -22.269110231147756, -21.831760636465237, -25.50794921108302, -10.539083375521997, -6.851694164185879, -11.177543490547283, -37.84891244520725, -9.764834356017206, -24.05746350085525, -24.740262834197488, -10.321636503638718, 10.631873491515147, 3.66658966260683, -2.8666478033128087, -9.690580261171792, -19.842288900519016, -27.824627311910117, -18.40475964295156, -16.431404306365017, -24.897797261226692, -27.70205712410752, -29.7890227397636, -3.80928885600481, -3.21633623487949, -12.708909127179215, -28.185482408346132, -14.402960227385266, -20.69855711790201, -34.34423840622624, -23.079432037087766, -21.519702927649988, -23.07556776231863, -2.9638005206452487, 4.039708490369078, -34.02734021324981, -17.687647135096576, 0.2546988919259938, -16.480055231163796, -37.1863757730209, -7.0645995165687365, 1.0767923650449713, -21.12841740985202, -4.014646289888486, -16.804635380287685, -29.183812036145696, -31.471617345811907, -1.7874549125056056, -1.397729076348357, 1.2367401819104025, -29.208443216590926, -31.61487460496552, -13.89261920479774, -32.90214477345277, -29.67479355307697, -6.382669217669047, -23.324561222147494, -27.459514039537396, -18.860693211787712, -3.8768467138428946, -36.21636224827345, -27.80158775727207, -10.99597599569794, -14.32427252419747, -46.85315014466977, -1.4892659028879727, -6.590978118165314, -26.489362845813716, -26.28787825031051, -23.542720931812678, -19.73129114011219, -14.312436004786997, -33.92491022998297, -44.925251416380405, -11.607173976145905, -28.839287127102175, -25.848830829558796, -12.106459966535464, -21.203802977624573, -32.99314562769675, -11.348274754533762, 5.81411386249661, -33.72674522018531], "policy_predator_policy_reward": [8.784964345278851, 17.980819816607344, 6.824284820419208, -1.8961187160923885, -0.62968821855074, 3.64158628272917, -12.57154009058721, 1.3380893869231922, 37.127542536720625, 31.522342473786743, 3.1892606051132866, 21.98513714890286, 30.848597593561326, 18.22755262028503, 13.901300143934733, -3.091891681000634, 43.87736922759469, 6.503343275561354, 22.269110231147756, 21.831760636465237, 25.50794921108302, 10.539083375521997, 6.851694164185879, 11.177543490547283, 37.84891244520725, 9.764834356017206, 24.05746350085525, 24.740262834197488, 10.321636503638718, -10.631873491515147, -3.66658966260683, 2.8666478033128087, 9.690580261171792, 19.842288900519016, 27.824627311910117, 18.40475964295156, 16.431404306365017, 24.897797261226692, 27.70205712410752, 29.7890227397636, 3.80928885600481, 3.21633623487949, 12.708909127179215, 28.185482408346132, 14.402960227385266, 20.69855711790201, 34.34423840622624, 23.079432037087766, 21.519702927649988, 23.07556776231863, 2.9638005206452487, -4.039708490369078, 34.02734021324981, 17.687647135096576, -0.2546988919259938, 16.480055231163796, 37.1863757730209, 7.0645995165687365, -1.0767923650449713, 21.12841740985202, 4.014646289888486, 16.804635380287685, 29.183812036145696, 31.471617345811907, 1.7874549125056056, 1.397729076348357, -1.2367401819104025, 29.208443216590926, 31.61487460496552, 13.89261920479774, 32.90214477345277, 29.67479355307697, 6.382669217669047, 23.324561222147494, 27.459514039537396, 18.860693211787712, 3.8768467138428946, 36.21636224827345, 27.80158775727207, 10.99597599569794, 14.32427252419747, 46.85315014466977, 1.4892659028879727, 6.590978118165314, 26.489362845813716, 26.28787825031051, 23.542720931812678, 19.73129114011219, 14.312436004786997, 33.92491022998297, 44.925251416380405, 11.607173976145905, 28.839287127102175, 25.848830829558796, 12.106459966535464, 21.203802977624573, 32.99314562769675, 11.348274754533762, -5.81411386249661, 33.72674522018531]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49437908726027757, "mean_inference_ms": 1.7120872223586263, "mean_action_processing_ms": 0.21140910024757376, "mean_env_wait_ms": 0.13017168432862042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044820308685302734, "StateBufferConnector_ms": 0.0033768415451049805, "ViewRequirementAgentConnector_ms": 0.08926606178283691}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 467.8838033329285, "num_env_steps_trained_throughput_per_sec": 467.8838033329285, "timesteps_total": 780000, "num_env_steps_sampled_lifetime": 780000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 8670.108, "restore_workers_time_ms": 0.02, "training_step_time_ms": 8669.828, "sample_time_ms": 1077.884, "learn_time_ms": 7562.231, "learn_throughput": 528.944, "synch_weights_time_ms": 27.106}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 195, "trial_id": "1f352_00000", "date": "2024-08-11_15-25-20", "timestamp": 1723404320, "time_this_iter_s": 8.602399110794067, "time_total_s": 1827.240440607071, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28163a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1827.240440607071, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 53.758333333333326, "ram_util_percent": 83.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.048027858758966, "cur_kl_coeff": 1.6927118651840945e-37, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9170256519069273, "policy_loss": -0.00010026808449765667, "vf_loss": 2.917125924800833, "vf_explained_var": 0.9328673765684168, "kl": 0.0033399375709062557, "entropy": 0.19895620570362857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 187680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8589033825943866, "cur_kl_coeff": 2.0954757928848272e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.925117188816269, "policy_loss": -0.003071234513481613, "vf_loss": 2.9281884231915076, "vf_explained_var": 0.9312293310960134, "kl": 0.004864130442865858, "entropy": 0.33735106424428524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 187680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.85315014466977, "predator_policy": -10.631873491515147}, "policy_reward_max": {"prey_policy": 10.631873491515147, "predator_policy": 46.85315014466977}, "policy_reward_mean": {"prey_policy": -19.3259834758711, "predator_policy": 19.3259834758711}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.740262834197488, -10.321636503638718, 10.631873491515147, 3.66658966260683, -2.8666478033128087, -9.690580261171792, -19.842288900519016, -27.824627311910117, -18.40475964295156, -16.431404306365017, -24.897797261226692, -27.70205712410752, -29.7890227397636, -3.80928885600481, -3.21633623487949, -12.708909127179215, -28.185482408346132, -14.402960227385266, -20.69855711790201, -34.34423840622624, -23.079432037087766, -21.519702927649988, -23.07556776231863, -2.9638005206452487, 4.039708490369078, -34.02734021324981, -17.687647135096576, 0.2546988919259938, -16.480055231163796, -37.1863757730209, -7.0645995165687365, 1.0767923650449713, -21.12841740985202, -4.014646289888486, -16.804635380287685, -29.183812036145696, -31.471617345811907, -1.7874549125056056, -1.397729076348357, 1.2367401819104025, -29.208443216590926, -31.61487460496552, -13.89261920479774, -32.90214477345277, -29.67479355307697, -6.382669217669047, -23.324561222147494, -27.459514039537396, -18.860693211787712, -3.8768467138428946, -36.21636224827345, -27.80158775727207, -10.99597599569794, -14.32427252419747, -46.85315014466977, -1.4892659028879727, -6.590978118165314, -26.489362845813716, -26.28787825031051, -23.542720931812678, -19.73129114011219, -14.312436004786997, -33.92491022998297, -44.925251416380405, -11.607173976145905, -28.839287127102175, -25.848830829558796, -12.106459966535464, -21.203802977624573, -32.99314562769675, -11.348274754533762, 5.81411386249661, -33.72674522018531, -6.423611499538498, -21.88443793794385, -22.517741871760034, -30.530298950863617, -13.456593362797403, -14.947129041612731, -25.936292838999243, -3.762855712198099, -11.423241367669668, -35.26690515483484, -7.171329292891202, -9.119969021454287, -27.45816637241822, -39.27285608700459, -6.63952364675083, -41.36628919208996, -26.233082248432538, -8.809181360018634, -45.294223225046295, -11.79831295802871, -26.74783401500231, -40.811825737257145, -14.15307022206498, -43.93096170098047, -14.469606273916053, -31.192206757022426, -31.595304302039324], "policy_predator_policy_reward": [24.740262834197488, 10.321636503638718, -10.631873491515147, -3.66658966260683, 2.8666478033128087, 9.690580261171792, 19.842288900519016, 27.824627311910117, 18.40475964295156, 16.431404306365017, 24.897797261226692, 27.70205712410752, 29.7890227397636, 3.80928885600481, 3.21633623487949, 12.708909127179215, 28.185482408346132, 14.402960227385266, 20.69855711790201, 34.34423840622624, 23.079432037087766, 21.519702927649988, 23.07556776231863, 2.9638005206452487, -4.039708490369078, 34.02734021324981, 17.687647135096576, -0.2546988919259938, 16.480055231163796, 37.1863757730209, 7.0645995165687365, -1.0767923650449713, 21.12841740985202, 4.014646289888486, 16.804635380287685, 29.183812036145696, 31.471617345811907, 1.7874549125056056, 1.397729076348357, -1.2367401819104025, 29.208443216590926, 31.61487460496552, 13.89261920479774, 32.90214477345277, 29.67479355307697, 6.382669217669047, 23.324561222147494, 27.459514039537396, 18.860693211787712, 3.8768467138428946, 36.21636224827345, 27.80158775727207, 10.99597599569794, 14.32427252419747, 46.85315014466977, 1.4892659028879727, 6.590978118165314, 26.489362845813716, 26.28787825031051, 23.542720931812678, 19.73129114011219, 14.312436004786997, 33.92491022998297, 44.925251416380405, 11.607173976145905, 28.839287127102175, 25.848830829558796, 12.106459966535464, 21.203802977624573, 32.99314562769675, 11.348274754533762, -5.81411386249661, 33.72674522018531, 6.423611499538498, 21.88443793794385, 22.517741871760034, 30.530298950863617, 13.456593362797403, 14.947129041612731, 25.936292838999243, 3.762855712198099, 11.423241367669668, 35.26690515483484, 7.171329292891202, 9.119969021454287, 27.45816637241822, 39.27285608700459, 6.63952364675083, 41.36628919208996, 26.233082248432538, 8.809181360018634, 45.294223225046295, 11.79831295802871, 26.74783401500231, 40.811825737257145, 14.15307022206498, 43.93096170098047, 14.469606273916053, 31.192206757022426, 31.595304302039324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49627743359654697, "mean_inference_ms": 1.7179239260818158, "mean_action_processing_ms": 0.2123928711586498, "mean_env_wait_ms": 0.13062655362224881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031996965408325195, "StateBufferConnector_ms": 0.0029299259185791016, "ViewRequirementAgentConnector_ms": 0.08421003818511963}, "num_episodes": 27, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 470.4433346283421, "num_env_steps_trained_throughput_per_sec": 470.4433346283421, "timesteps_total": 784000, "num_env_steps_sampled_lifetime": 784000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 8671.912, "restore_workers_time_ms": 0.021, "training_step_time_ms": 8671.65, "sample_time_ms": 1115.353, "learn_time_ms": 7525.387, "learn_throughput": 531.534, "synch_weights_time_ms": 28.284}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 196, "trial_id": "1f352_00000", "date": "2024-08-11_15-25-28", "timestamp": 1723404328, "time_this_iter_s": 8.564043045043945, "time_total_s": 1835.8044836521149, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2816f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1835.8044836521149, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 49.699999999999996, "ram_util_percent": 82.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8399380313853424, "cur_kl_coeff": 8.463559325920472e-38, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.517863038306435, "policy_loss": -0.0011724719103464547, "vf_loss": 2.519035507986943, "vf_explained_var": 0.9203871716434757, "kl": 0.002861508317491642, "entropy": 0.29581119141851864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 188640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7748097527772186, "cur_kl_coeff": 1.0477378964424136e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.471938563634952, "policy_loss": -0.004164842993001609, "vf_loss": 2.4761034129808346, "vf_explained_var": 0.9225048443302513, "kl": 0.010760817903772613, "entropy": 0.36964082651150726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 188640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 1576000, "num_agent_steps_trained": 1576000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -60.36637776564518, "predator_policy": -5.81411386249661}, "policy_reward_max": {"prey_policy": 5.81411386249661, "predator_policy": 60.36637776564518}, "policy_reward_mean": {"prey_policy": -21.20456997345983, "predator_policy": 21.20456997345983}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.69855711790201, -34.34423840622624, -23.079432037087766, -21.519702927649988, -23.07556776231863, -2.9638005206452487, 4.039708490369078, -34.02734021324981, -17.687647135096576, 0.2546988919259938, -16.480055231163796, -37.1863757730209, -7.0645995165687365, 1.0767923650449713, -21.12841740985202, -4.014646289888486, -16.804635380287685, -29.183812036145696, -31.471617345811907, -1.7874549125056056, -1.397729076348357, 1.2367401819104025, -29.208443216590926, -31.61487460496552, -13.89261920479774, -32.90214477345277, -29.67479355307697, -6.382669217669047, -23.324561222147494, -27.459514039537396, -18.860693211787712, -3.8768467138428946, -36.21636224827345, -27.80158775727207, -10.99597599569794, -14.32427252419747, -46.85315014466977, -1.4892659028879727, -6.590978118165314, -26.489362845813716, -26.28787825031051, -23.542720931812678, -19.73129114011219, -14.312436004786997, -33.92491022998297, -44.925251416380405, -11.607173976145905, -28.839287127102175, -25.848830829558796, -12.106459966535464, -21.203802977624573, -32.99314562769675, -11.348274754533762, 5.81411386249661, -33.72674522018531, -6.423611499538498, -21.88443793794385, -22.517741871760034, -30.530298950863617, -13.456593362797403, -14.947129041612731, -25.936292838999243, -3.762855712198099, -11.423241367669668, -35.26690515483484, -7.171329292891202, -9.119969021454287, -27.45816637241822, -39.27285608700459, -6.63952364675083, -41.36628919208996, -26.233082248432538, -8.809181360018634, -45.294223225046295, -11.79831295802871, -26.74783401500231, -40.811825737257145, -14.15307022206498, -43.93096170098047, -14.469606273916053, -31.192206757022426, -31.595304302039324, -14.81998047455939, -44.919598932623245, -19.376056431261304, -29.295055961163655, -50.84213579450568, 2.5175178953242785, -27.88231111859927, -6.607241571214939, -60.36637776564518, -33.34256509549374, -6.37302051333171, -37.202832273584065, -22.8687570308536, -26.71724658396344, -25.59998297496709, -9.4940098449271, -22.15171340251576, -13.052880273825433], "policy_predator_policy_reward": [20.69855711790201, 34.34423840622624, 23.079432037087766, 21.519702927649988, 23.07556776231863, 2.9638005206452487, -4.039708490369078, 34.02734021324981, 17.687647135096576, -0.2546988919259938, 16.480055231163796, 37.1863757730209, 7.0645995165687365, -1.0767923650449713, 21.12841740985202, 4.014646289888486, 16.804635380287685, 29.183812036145696, 31.471617345811907, 1.7874549125056056, 1.397729076348357, -1.2367401819104025, 29.208443216590926, 31.61487460496552, 13.89261920479774, 32.90214477345277, 29.67479355307697, 6.382669217669047, 23.324561222147494, 27.459514039537396, 18.860693211787712, 3.8768467138428946, 36.21636224827345, 27.80158775727207, 10.99597599569794, 14.32427252419747, 46.85315014466977, 1.4892659028879727, 6.590978118165314, 26.489362845813716, 26.28787825031051, 23.542720931812678, 19.73129114011219, 14.312436004786997, 33.92491022998297, 44.925251416380405, 11.607173976145905, 28.839287127102175, 25.848830829558796, 12.106459966535464, 21.203802977624573, 32.99314562769675, 11.348274754533762, -5.81411386249661, 33.72674522018531, 6.423611499538498, 21.88443793794385, 22.517741871760034, 30.530298950863617, 13.456593362797403, 14.947129041612731, 25.936292838999243, 3.762855712198099, 11.423241367669668, 35.26690515483484, 7.171329292891202, 9.119969021454287, 27.45816637241822, 39.27285608700459, 6.63952364675083, 41.36628919208996, 26.233082248432538, 8.809181360018634, 45.294223225046295, 11.79831295802871, 26.74783401500231, 40.811825737257145, 14.15307022206498, 43.93096170098047, 14.469606273916053, 31.192206757022426, 31.595304302039324, 14.81998047455939, 44.919598932623245, 19.376056431261304, 29.295055961163655, 50.84213579450568, -2.5175178953242785, 27.88231111859927, 6.607241571214939, 60.36637776564518, 33.34256509549374, 6.37302051333171, 37.202832273584065, 22.8687570308536, 26.71724658396344, 25.59998297496709, 9.4940098449271, 22.15171340251576, 13.052880273825433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4933881169934249, "mean_inference_ms": 1.7079113733987834, "mean_action_processing_ms": 0.2109224863266267, "mean_env_wait_ms": 0.12992286194433597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007927656173706055, "StateBufferConnector_ms": 0.0029993057250976562, "ViewRequirementAgentConnector_ms": 0.10312509536743164}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1576000, "num_agent_steps_trained": 1576000, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 436.2720158573488, "num_env_steps_trained_throughput_per_sec": 436.2720158573488, "timesteps_total": 788000, "num_env_steps_sampled_lifetime": 788000, "num_agent_steps_sampled_lifetime": 1576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1576000, "timers": {"training_iteration_time_ms": 8724.112, "restore_workers_time_ms": 0.022, "training_step_time_ms": 8723.943, "sample_time_ms": 1139.637, "learn_time_ms": 7555.214, "learn_throughput": 529.436, "synch_weights_time_ms": 27.808}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 1576000, "num_agent_steps_trained": 1576000}, "done": false, "training_iteration": 197, "trial_id": "1f352_00000", "date": "2024-08-11_15-25-37", "timestamp": 1723404337, "time_this_iter_s": 9.22047734260559, "time_total_s": 1845.0249609947205, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c650d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1845.0249609947205, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 58.79230769230769, "ram_util_percent": 83.3153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2178021324177584, "cur_kl_coeff": 4.231779662960236e-38, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.294222820053498, "policy_loss": -0.0004956060273495192, "vf_loss": 2.294718418891231, "vf_explained_var": 0.8878566281249126, "kl": 0.005619704753211648, "entropy": 0.24500681115314366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 189600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.074065014968316, "cur_kl_coeff": 1.0477378964424136e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3018947545439006, "policy_loss": -0.000565241319903483, "vf_loss": 2.302460003395875, "vf_explained_var": 0.8872701490918795, "kl": 0.0049003378447433, "entropy": 0.3760935774073005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 189600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -60.36637776564518, "predator_policy": -8.217943640646789}, "policy_reward_max": {"prey_policy": 8.217943640646789, "predator_policy": 60.36637776564518}, "policy_reward_mean": {"prey_policy": -21.758822946297606, "predator_policy": 21.758822946297606}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-31.471617345811907, -1.7874549125056056, -1.397729076348357, 1.2367401819104025, -29.208443216590926, -31.61487460496552, -13.89261920479774, -32.90214477345277, -29.67479355307697, -6.382669217669047, -23.324561222147494, -27.459514039537396, -18.860693211787712, -3.8768467138428946, -36.21636224827345, -27.80158775727207, -10.99597599569794, -14.32427252419747, -46.85315014466977, -1.4892659028879727, -6.590978118165314, -26.489362845813716, -26.28787825031051, -23.542720931812678, -19.73129114011219, -14.312436004786997, -33.92491022998297, -44.925251416380405, -11.607173976145905, -28.839287127102175, -25.848830829558796, -12.106459966535464, -21.203802977624573, -32.99314562769675, -11.348274754533762, 5.81411386249661, -33.72674522018531, -6.423611499538498, -21.88443793794385, -22.517741871760034, -30.530298950863617, -13.456593362797403, -14.947129041612731, -25.936292838999243, -3.762855712198099, -11.423241367669668, -35.26690515483484, -7.171329292891202, -9.119969021454287, -27.45816637241822, -39.27285608700459, -6.63952364675083, -41.36628919208996, -26.233082248432538, -8.809181360018634, -45.294223225046295, -11.79831295802871, -26.74783401500231, -40.811825737257145, -14.15307022206498, -43.93096170098047, -14.469606273916053, -31.192206757022426, -31.595304302039324, -14.81998047455939, -44.919598932623245, -19.376056431261304, -29.295055961163655, -50.84213579450568, 2.5175178953242785, -27.88231111859927, -6.607241571214939, -60.36637776564518, -33.34256509549374, -6.37302051333171, -37.202832273584065, -22.8687570308536, -26.71724658396344, -25.59998297496709, -9.4940098449271, -22.15171340251576, -13.052880273825433, -7.819364418712737, -10.520412053919738, -31.61386395459965, -5.078753729643303, -25.655560841583466, -39.00284905217533, -33.3124488485951, -25.924144335895363, -19.608100536648664, -30.272694329252232, -42.02539082877781, -37.250698669021965, 8.217943640646789, 2.1230271434368615, -12.329569287099131, -2.5560613954308655, -32.26462265659168, -14.419361139677239], "policy_predator_policy_reward": [31.471617345811907, 1.7874549125056056, 1.397729076348357, -1.2367401819104025, 29.208443216590926, 31.61487460496552, 13.89261920479774, 32.90214477345277, 29.67479355307697, 6.382669217669047, 23.324561222147494, 27.459514039537396, 18.860693211787712, 3.8768467138428946, 36.21636224827345, 27.80158775727207, 10.99597599569794, 14.32427252419747, 46.85315014466977, 1.4892659028879727, 6.590978118165314, 26.489362845813716, 26.28787825031051, 23.542720931812678, 19.73129114011219, 14.312436004786997, 33.92491022998297, 44.925251416380405, 11.607173976145905, 28.839287127102175, 25.848830829558796, 12.106459966535464, 21.203802977624573, 32.99314562769675, 11.348274754533762, -5.81411386249661, 33.72674522018531, 6.423611499538498, 21.88443793794385, 22.517741871760034, 30.530298950863617, 13.456593362797403, 14.947129041612731, 25.936292838999243, 3.762855712198099, 11.423241367669668, 35.26690515483484, 7.171329292891202, 9.119969021454287, 27.45816637241822, 39.27285608700459, 6.63952364675083, 41.36628919208996, 26.233082248432538, 8.809181360018634, 45.294223225046295, 11.79831295802871, 26.74783401500231, 40.811825737257145, 14.15307022206498, 43.93096170098047, 14.469606273916053, 31.192206757022426, 31.595304302039324, 14.81998047455939, 44.919598932623245, 19.376056431261304, 29.295055961163655, 50.84213579450568, -2.5175178953242785, 27.88231111859927, 6.607241571214939, 60.36637776564518, 33.34256509549374, 6.37302051333171, 37.202832273584065, 22.8687570308536, 26.71724658396344, 25.59998297496709, 9.4940098449271, 22.15171340251576, 13.052880273825433, 7.819364418712737, 10.520412053919738, 31.61386395459965, 5.078753729643303, 25.655560841583466, 39.00284905217533, 33.3124488485951, 25.924144335895363, 19.608100536648664, 30.272694329252232, 42.02539082877781, 37.250698669021965, -8.217943640646789, -2.1230271434368615, 12.329569287099131, 2.5560613954308655, 32.26462265659168, 14.419361139677239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4929928226075077, "mean_inference_ms": 1.7061397909358162, "mean_action_processing_ms": 0.21071002164364538, "mean_env_wait_ms": 0.1298180014491891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00765836238861084, "StateBufferConnector_ms": 0.0026105642318725586, "ViewRequirementAgentConnector_ms": 0.08736681938171387}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 471.68904112647016, "num_env_steps_trained_throughput_per_sec": 471.68904112647016, "timesteps_total": 792000, "num_env_steps_sampled_lifetime": 792000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 8594.85, "restore_workers_time_ms": 0.021, "training_step_time_ms": 8594.684, "sample_time_ms": 1108.551, "learn_time_ms": 7458.107, "learn_throughput": 536.329, "synch_weights_time_ms": 26.868}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 198, "trial_id": "1f352_00000", "date": "2024-08-11_15-25-46", "timestamp": 1723404346, "time_this_iter_s": 8.525284051895142, "time_total_s": 1853.5502450466156, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2816e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1853.5502450466156, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 54.475, "ram_util_percent": 83.30833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8261044597874085, "cur_kl_coeff": 4.231779662960236e-38, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2259971482058365, "policy_loss": -0.0004586452545481734, "vf_loss": 3.226455779870351, "vf_explained_var": 0.881458509589235, "kl": 0.0028540198387637253, "entropy": 0.2015632142002384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 190560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7346645959963403, "cur_kl_coeff": 5.238689482212068e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2655933797359467, "policy_loss": -0.004528829688933911, "vf_loss": 3.270122202237447, "vf_explained_var": 0.8792342390244205, "kl": 0.00801844032631777, "entropy": 0.3754604210456212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 190560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 1592000, "num_agent_steps_trained": 1592000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -60.36637776564518, "predator_policy": -8.217943640646789}, "policy_reward_max": {"prey_policy": 8.217943640646789, "predator_policy": 60.36637776564518}, "policy_reward_mean": {"prey_policy": -22.016064302524427, "predator_policy": 22.016064302524427}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-46.85315014466977, -1.4892659028879727, -6.590978118165314, -26.489362845813716, -26.28787825031051, -23.542720931812678, -19.73129114011219, -14.312436004786997, -33.92491022998297, -44.925251416380405, -11.607173976145905, -28.839287127102175, -25.848830829558796, -12.106459966535464, -21.203802977624573, -32.99314562769675, -11.348274754533762, 5.81411386249661, -33.72674522018531, -6.423611499538498, -21.88443793794385, -22.517741871760034, -30.530298950863617, -13.456593362797403, -14.947129041612731, -25.936292838999243, -3.762855712198099, -11.423241367669668, -35.26690515483484, -7.171329292891202, -9.119969021454287, -27.45816637241822, -39.27285608700459, -6.63952364675083, -41.36628919208996, -26.233082248432538, -8.809181360018634, -45.294223225046295, -11.79831295802871, -26.74783401500231, -40.811825737257145, -14.15307022206498, -43.93096170098047, -14.469606273916053, -31.192206757022426, -31.595304302039324, -14.81998047455939, -44.919598932623245, -19.376056431261304, -29.295055961163655, -50.84213579450568, 2.5175178953242785, -27.88231111859927, -6.607241571214939, -60.36637776564518, -33.34256509549374, -6.37302051333171, -37.202832273584065, -22.8687570308536, -26.71724658396344, -25.59998297496709, -9.4940098449271, -22.15171340251576, -13.052880273825433, -7.819364418712737, -10.520412053919738, -31.61386395459965, -5.078753729643303, -25.655560841583466, -39.00284905217533, -33.3124488485951, -25.924144335895363, -19.608100536648664, -30.272694329252232, -42.02539082877781, -37.250698669021965, 8.217943640646789, 2.1230271434368615, -12.329569287099131, -2.5560613954308655, -32.26462265659168, -14.419361139677239, -26.69470267233922, -7.009775309815069, -4.496372565007003, -25.98060035877716, 2.421447674421195, -15.178763586985243, -28.076854716064545, -34.673492340095756, -43.10426903080941, -5.293167302676412, -41.45451082325282, -17.460030588907774, -1.4334655070212827, -35.04745554304414, -40.684967762425416, -19.041687029270733, 2.621130590616613, -25.092018187292904], "policy_predator_policy_reward": [46.85315014466977, 1.4892659028879727, 6.590978118165314, 26.489362845813716, 26.28787825031051, 23.542720931812678, 19.73129114011219, 14.312436004786997, 33.92491022998297, 44.925251416380405, 11.607173976145905, 28.839287127102175, 25.848830829558796, 12.106459966535464, 21.203802977624573, 32.99314562769675, 11.348274754533762, -5.81411386249661, 33.72674522018531, 6.423611499538498, 21.88443793794385, 22.517741871760034, 30.530298950863617, 13.456593362797403, 14.947129041612731, 25.936292838999243, 3.762855712198099, 11.423241367669668, 35.26690515483484, 7.171329292891202, 9.119969021454287, 27.45816637241822, 39.27285608700459, 6.63952364675083, 41.36628919208996, 26.233082248432538, 8.809181360018634, 45.294223225046295, 11.79831295802871, 26.74783401500231, 40.811825737257145, 14.15307022206498, 43.93096170098047, 14.469606273916053, 31.192206757022426, 31.595304302039324, 14.81998047455939, 44.919598932623245, 19.376056431261304, 29.295055961163655, 50.84213579450568, -2.5175178953242785, 27.88231111859927, 6.607241571214939, 60.36637776564518, 33.34256509549374, 6.37302051333171, 37.202832273584065, 22.8687570308536, 26.71724658396344, 25.59998297496709, 9.4940098449271, 22.15171340251576, 13.052880273825433, 7.819364418712737, 10.520412053919738, 31.61386395459965, 5.078753729643303, 25.655560841583466, 39.00284905217533, 33.3124488485951, 25.924144335895363, 19.608100536648664, 30.272694329252232, 42.02539082877781, 37.250698669021965, -8.217943640646789, -2.1230271434368615, 12.329569287099131, 2.5560613954308655, 32.26462265659168, 14.419361139677239, 26.69470267233922, 7.009775309815069, 4.496372565007003, 25.98060035877716, -2.421447674421195, 15.178763586985243, 28.076854716064545, 34.673492340095756, 43.10426903080941, 5.293167302676412, 41.45451082325282, 17.460030588907774, 1.4334655070212827, 35.04745554304414, 40.684967762425416, 19.041687029270733, -2.621130590616613, 25.092018187292904]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4928723323877104, "mean_inference_ms": 1.7050788583902703, "mean_action_processing_ms": 0.21057030700967774, "mean_env_wait_ms": 0.1297548986461092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007790923118591309, "StateBufferConnector_ms": 0.0027021169662475586, "ViewRequirementAgentConnector_ms": 0.08520257472991943}, "num_episodes": 18, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1592000, "num_agent_steps_trained": 1592000, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 447.2138750363455, "num_env_steps_trained_throughput_per_sec": 447.2138750363455, "timesteps_total": 796000, "num_env_steps_sampled_lifetime": 796000, "num_agent_steps_sampled_lifetime": 1592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1592000, "timers": {"training_iteration_time_ms": 8544.504, "restore_workers_time_ms": 0.023, "training_step_time_ms": 8544.317, "sample_time_ms": 1121.821, "learn_time_ms": 7393.166, "learn_throughput": 541.04, "synch_weights_time_ms": 27.968}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 1592000, "num_agent_steps_trained": 1592000}, "done": false, "training_iteration": 199, "trial_id": "1f352_00000", "date": "2024-08-11_15-25-55", "timestamp": 1723404355, "time_this_iter_s": 9.01477313041687, "time_total_s": 1862.5650181770325, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c658b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1862.5650181770325, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 51.22307692307691, "ram_util_percent": 83.05384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.245230155810714, "cur_kl_coeff": 2.115889831480118e-38, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.820217926303546, "policy_loss": -0.0033102193046943285, "vf_loss": 2.8235281512141226, "vf_explained_var": 0.9069392597302794, "kl": 0.00319971543025596, "entropy": 0.22377075221544754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 191520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.795684480542938, "cur_kl_coeff": 5.238689482212068e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8147370437781016, "policy_loss": -0.005213971313060029, "vf_loss": 2.819951018566887, "vf_explained_var": 0.8988906057551503, "kl": 0.009956359839070691, "entropy": 0.36720780432224276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 191520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -60.36637776564518, "predator_policy": -8.217943640646789}, "policy_reward_max": {"prey_policy": 8.217943640646789, "predator_policy": 60.36637776564518}, "policy_reward_mean": {"prey_policy": -21.03804469958735, "predator_policy": 21.03804469958735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.423241367669668, -35.26690515483484, -7.171329292891202, -9.119969021454287, -27.45816637241822, -39.27285608700459, -6.63952364675083, -41.36628919208996, -26.233082248432538, -8.809181360018634, -45.294223225046295, -11.79831295802871, -26.74783401500231, -40.811825737257145, -14.15307022206498, -43.93096170098047, -14.469606273916053, -31.192206757022426, -31.595304302039324, -14.81998047455939, -44.919598932623245, -19.376056431261304, -29.295055961163655, -50.84213579450568, 2.5175178953242785, -27.88231111859927, -6.607241571214939, -60.36637776564518, -33.34256509549374, -6.37302051333171, -37.202832273584065, -22.8687570308536, -26.71724658396344, -25.59998297496709, -9.4940098449271, -22.15171340251576, -13.052880273825433, -7.819364418712737, -10.520412053919738, -31.61386395459965, -5.078753729643303, -25.655560841583466, -39.00284905217533, -33.3124488485951, -25.924144335895363, -19.608100536648664, -30.272694329252232, -42.02539082877781, -37.250698669021965, 8.217943640646789, 2.1230271434368615, -12.329569287099131, -2.5560613954308655, -32.26462265659168, -14.419361139677239, -26.69470267233922, -7.009775309815069, -4.496372565007003, -25.98060035877716, 2.421447674421195, -15.178763586985243, -28.076854716064545, -34.673492340095756, -43.10426903080941, -5.293167302676412, -41.45451082325282, -17.460030588907774, -1.4334655070212827, -35.04745554304414, -40.684967762425416, -19.041687029270733, 2.621130590616613, -25.092018187292904, -28.22178805444812, -22.999041403280273, -35.5627628015458, -9.631965141142265, -1.9553755464875566, -7.693202170462662, 4.513043336844117, -28.25375310302772, -25.859909912201235, -13.973834826549563, 8.088224643362267, -13.52445511768477, -12.836384528512987, -25.45308927135037, -26.84493378325513, -19.20567965490311, -37.22493328629759, -8.024286673202017, -15.950198364352168, -33.07488246202052, -8.064574160386696, -5.310370776648691, -11.807074680836337, -23.157159486642897, -34.75619656810612, -1.2919780414521254, -19.587290689224137], "policy_predator_policy_reward": [11.423241367669668, 35.26690515483484, 7.171329292891202, 9.119969021454287, 27.45816637241822, 39.27285608700459, 6.63952364675083, 41.36628919208996, 26.233082248432538, 8.809181360018634, 45.294223225046295, 11.79831295802871, 26.74783401500231, 40.811825737257145, 14.15307022206498, 43.93096170098047, 14.469606273916053, 31.192206757022426, 31.595304302039324, 14.81998047455939, 44.919598932623245, 19.376056431261304, 29.295055961163655, 50.84213579450568, -2.5175178953242785, 27.88231111859927, 6.607241571214939, 60.36637776564518, 33.34256509549374, 6.37302051333171, 37.202832273584065, 22.8687570308536, 26.71724658396344, 25.59998297496709, 9.4940098449271, 22.15171340251576, 13.052880273825433, 7.819364418712737, 10.520412053919738, 31.61386395459965, 5.078753729643303, 25.655560841583466, 39.00284905217533, 33.3124488485951, 25.924144335895363, 19.608100536648664, 30.272694329252232, 42.02539082877781, 37.250698669021965, -8.217943640646789, -2.1230271434368615, 12.329569287099131, 2.5560613954308655, 32.26462265659168, 14.419361139677239, 26.69470267233922, 7.009775309815069, 4.496372565007003, 25.98060035877716, -2.421447674421195, 15.178763586985243, 28.076854716064545, 34.673492340095756, 43.10426903080941, 5.293167302676412, 41.45451082325282, 17.460030588907774, 1.4334655070212827, 35.04745554304414, 40.684967762425416, 19.041687029270733, -2.621130590616613, 25.092018187292904, 28.22178805444812, 22.999041403280273, 35.5627628015458, 9.631965141142265, 1.9553755464875566, 7.693202170462662, -4.513043336844117, 28.25375310302772, 25.859909912201235, 13.973834826549563, -8.088224643362267, 13.52445511768477, 12.836384528512987, 25.45308927135037, 26.84493378325513, 19.20567965490311, 37.22493328629759, 8.024286673202017, 15.950198364352168, 33.07488246202052, 8.064574160386696, 5.310370776648691, 11.807074680836337, 23.157159486642897, 34.75619656810612, 1.2919780414521254, 19.587290689224137]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49288083041851055, "mean_inference_ms": 1.7040858683096538, "mean_action_processing_ms": 0.21036592941232535, "mean_env_wait_ms": 0.12958613334906108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008048057556152344, "StateBufferConnector_ms": 0.0024063587188720703, "ViewRequirementAgentConnector_ms": 0.08632469177246094}, "num_episodes": 27, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 466.0160044451638, "num_env_steps_trained_throughput_per_sec": 466.0160044451638, "timesteps_total": 800000, "num_env_steps_sampled_lifetime": 800000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 8604.503, "restore_workers_time_ms": 0.023, "training_step_time_ms": 8604.265, "sample_time_ms": 1140.193, "learn_time_ms": 7433.717, "learn_throughput": 538.089, "synch_weights_time_ms": 28.826}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 200, "trial_id": "1f352_00000", "date": "2024-08-11_15-26-04", "timestamp": 1723404364, "time_this_iter_s": 8.613659858703613, "time_total_s": 1871.178678035736, "pid": 67271, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1ca9940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1871.178678035736, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 52.284615384615385, "ram_util_percent": 83.36153846153846}}
