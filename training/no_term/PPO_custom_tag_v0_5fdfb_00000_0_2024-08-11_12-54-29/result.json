{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0276221838158865, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.262703485290209, "policy_loss": -0.017026151290823084, "vf_loss": 6.276047776639461, "vf_explained_var": 0.14761359430849552, "kl": 0.018409383197169827, "entropy": 1.5916174528499445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9986920797576506, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.263750551144282, "policy_loss": -0.013050331334913306, "vf_loss": 6.273859145740668, "vf_explained_var": 0.14811570843060812, "kl": 0.014708700475234645, "entropy": 1.5949369994302591, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 632.5910943767988, "num_env_steps_trained_throughput_per_sec": 632.5910943767988, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 6323.208, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6323.123, "sample_time_ms": 1156.843, "learn_time_ms": 5153.57, "learn_throughput": 776.161, "synch_weights_time_ms": 12.209}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 1, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-54-45", "timestamp": 1723395285, "time_this_iter_s": 6.364174127578735, "time_total_s": 6.364174127578735, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78231f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6.364174127578735, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 43.870000000000005, "ram_util_percent": 83.36999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8093676102658114, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.196582629283269, "policy_loss": -0.017236281872465044, "vf_loss": 6.2101685628294945, "vf_explained_var": 0.05946884329120318, "kl": 0.01825172773944385, "entropy": 1.5469181479265293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7503977090120315, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.194963567207257, "policy_loss": -0.007305505296729583, "vf_loss": 6.20002002765735, "vf_explained_var": 0.06088224618385236, "kl": 0.011245223301332433, "entropy": 1.5735532712191342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 4500, "policy_reward_min": {"prey_policy": -19.12809493390561, "predator_policy": -24.40922595283255}, "policy_reward_max": {"prey_policy": 24.40922595283255, "predator_policy": 19.12809493390561}, "policy_reward_mean": {"prey_policy": -2.379920179646126, "predator_policy": 2.379920179646126}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [8.205758055737494, -11.220103424643497, -4.968299673585616, -3.0674765811593696, 24.40922595283255, -4.128373012780536, 4.711686589769521, -16.23360458908007, -19.12809493390561], "policy_predator_policy_reward": [-8.205758055737494, 11.220103424643497, 4.968299673585616, 3.0674765811593696, -24.40922595283255, 4.128373012780536, -4.711686589769521, 16.23360458908007, 19.12809493390561]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37266490852472933, "mean_inference_ms": 1.3470486136643058, "mean_action_processing_ms": 0.1587362930179493, "mean_env_wait_ms": 0.10777941108295191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009444024827745225, "StateBufferConnector_ms": 0.0022371610005696616, "ViewRequirementAgentConnector_ms": 0.04631678263346354}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 736.7627587271141, "num_env_steps_trained_throughput_per_sec": 736.7627587271141, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 5876.185, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5876.125, "sample_time_ms": 937.554, "learn_time_ms": 4925.807, "learn_throughput": 812.05, "synch_weights_time_ms": 12.313}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 2, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-54-52", "timestamp": 1723395292, "time_this_iter_s": 5.433803081512451, "time_total_s": 11.797977209091187, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78a94c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11.797977209091187, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 33.64, "ram_util_percent": 83.33000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2137520303949714, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.819432394206524, "policy_loss": -0.010298106273209366, "vf_loss": 6.8273316219449045, "vf_explained_var": 0.07609895393252372, "kl": 0.011994406905793262, "entropy": 1.5374761156737804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1871187357542416, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.821974740425746, "policy_loss": -0.007401237694042114, "vf_loss": 6.82774560948213, "vf_explained_var": 0.07827601823955774, "kl": 0.008151852558919195, "entropy": 1.5618720753739277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 9000, "policy_reward_min": {"prey_policy": -33.237673258431876, "predator_policy": -24.40922595283255}, "policy_reward_max": {"prey_policy": 24.40922595283255, "predator_policy": 33.237673258431876}, "policy_reward_mean": {"prey_policy": -11.68825235927182, "predator_policy": 11.68825235927182}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [8.205758055737494, -11.220103424643497, -4.968299673585616, -3.0674765811593696, 24.40922595283255, -4.128373012780536, 4.711686589769521, -16.23360458908007, -19.12809493390561, -28.912401799586277, -33.237673258431876, 0.6805179293672445, -13.129993740491777, -32.37542183531753, -28.474962569808678, -29.091419840511488, -13.063163939245225, -11.364741796052009], "policy_predator_policy_reward": [-8.205758055737494, 11.220103424643497, 4.968299673585616, 3.0674765811593696, -24.40922595283255, 4.128373012780536, -4.711686589769521, 16.23360458908007, 19.12809493390561, 28.912401799586277, 33.237673258431876, -0.6805179293672445, 13.129993740491777, 32.37542183531753, 28.474962569808678, 29.091419840511488, 13.063163939245225, 11.364741796052009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3563125721795491, "mean_inference_ms": 1.2749529958861663, "mean_action_processing_ms": 0.1526314698548242, "mean_env_wait_ms": 0.10089958411996686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038646274142795, "StateBufferConnector_ms": 0.002119938532511393, "ViewRequirementAgentConnector_ms": 0.04525515768263075}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 631.9951873001379, "num_env_steps_trained_throughput_per_sec": 631.9951873001379, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 6027.186, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6027.069, "sample_time_ms": 844.109, "learn_time_ms": 5167.592, "learn_throughput": 774.055, "synch_weights_time_ms": 14.528}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 3, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-54-59", "timestamp": 1723395299, "time_this_iter_s": 6.381309986114502, "time_total_s": 18.17928719520569, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7892ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18.17928719520569, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 47.766666666666666, "ram_util_percent": 83.44444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9988367048092186, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.238554798066616, "policy_loss": -0.012445457566839953, "vf_loss": 6.2480217908819515, "vf_explained_var": -0.054150853243966894, "kl": 0.014892212282185435, "entropy": 1.498670026535789, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.983090306694309, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.225520698726177, "policy_loss": -0.007835113863499525, "vf_loss": 6.23163367609183, "vf_explained_var": -0.0540316558132569, "kl": 0.008610601367068501, "entropy": 1.5157548148185014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 13500, "policy_reward_min": {"prey_policy": -39.27374544255493, "predator_policy": -24.40922595283255}, "policy_reward_max": {"prey_policy": 24.40922595283255, "predator_policy": 39.27374544255493}, "policy_reward_mean": {"prey_policy": -13.019576525430587, "predator_policy": 13.019576525430587}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [8.205758055737494, -11.220103424643497, -4.968299673585616, -3.0674765811593696, 24.40922595283255, -4.128373012780536, 4.711686589769521, -16.23360458908007, -19.12809493390561, -28.912401799586277, -33.237673258431876, 0.6805179293672445, -13.129993740491777, -32.37542183531753, -28.474962569808678, -29.091419840511488, -13.063163939245225, -11.364741796052009, -2.189826229972303, -20.262890803305105, -11.36775496428593, -27.502512714340035, 5.1655317332683275, -23.912637313632235, -15.675383203285325, -6.120804781625495, -39.27374544255493], "policy_predator_policy_reward": [-8.205758055737494, 11.220103424643497, 4.968299673585616, 3.0674765811593696, -24.40922595283255, 4.128373012780536, -4.711686589769521, 16.23360458908007, 19.12809493390561, 28.912401799586277, 33.237673258431876, -0.6805179293672445, 13.129993740491777, 32.37542183531753, 28.474962569808678, 29.091419840511488, 13.063163939245225, 11.364741796052009, 2.189826229972303, 20.262890803305105, 11.36775496428593, 27.502512714340035, -5.1655317332683275, 23.912637313632235, 15.675383203285325, 6.120804781625495, 39.27374544255493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3533311292459089, "mean_inference_ms": 1.2394734060049808, "mean_action_processing_ms": 0.15031509054828512, "mean_env_wait_ms": 0.09821811362828506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064297958656593605, "StateBufferConnector_ms": 0.002030531565348307, "ViewRequirementAgentConnector_ms": 0.04457058729948821}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 707.8935549731318, "num_env_steps_trained_throughput_per_sec": 707.8935549731318, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 5933.044, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5932.935, "sample_time_ms": 828.88, "learn_time_ms": 5089.874, "learn_throughput": 785.874, "synch_weights_time_ms": 13.474}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 4, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-55-04", "timestamp": 1723395304, "time_this_iter_s": 5.652943134307861, "time_total_s": 23.83223032951355, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78a9430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23.83223032951355, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 37.825, "ram_util_percent": 83.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9118705245666205, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.820062296837568, "policy_loss": -0.012843472179762708, "vf_loss": 5.830767160157363, "vf_explained_var": 0.027255282364785673, "kl": 0.010693024367443786, "entropy": 1.466903857514262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8655719910437862, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.819281202554703, "policy_loss": -0.01124033284431789, "vf_loss": 5.8285585830609, "vf_explained_var": 0.02594847877820333, "kl": 0.009814821546736147, "entropy": 1.5048592008650303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 18000, "policy_reward_min": {"prey_policy": -39.27374544255493, "predator_policy": -24.40922595283255}, "policy_reward_max": {"prey_policy": 24.40922595283255, "predator_policy": 39.27374544255493}, "policy_reward_mean": {"prey_policy": -12.964253266866347, "predator_policy": 12.964253266866347}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [8.205758055737494, -11.220103424643497, -4.968299673585616, -3.0674765811593696, 24.40922595283255, -4.128373012780536, 4.711686589769521, -16.23360458908007, -19.12809493390561, -28.912401799586277, -33.237673258431876, 0.6805179293672445, -13.129993740491777, -32.37542183531753, -28.474962569808678, -29.091419840511488, -13.063163939245225, -11.364741796052009, -2.189826229972303, -20.262890803305105, -11.36775496428593, -27.502512714340035, 5.1655317332683275, -23.912637313632235, -15.675383203285325, -6.120804781625495, -39.27374544255493, -8.361215760345624, -4.405161200550133, -18.084692105299247, 18.342452371156753, -29.204551448765095, -9.026264850000182, -7.9861485344275085, -29.79392053189393, -26.665049360437724], "policy_predator_policy_reward": [-8.205758055737494, 11.220103424643497, 4.968299673585616, 3.0674765811593696, -24.40922595283255, 4.128373012780536, -4.711686589769521, 16.23360458908007, 19.12809493390561, 28.912401799586277, 33.237673258431876, -0.6805179293672445, 13.129993740491777, 32.37542183531753, 28.474962569808678, 29.091419840511488, 13.063163939245225, 11.364741796052009, 2.189826229972303, 20.262890803305105, 11.36775496428593, 27.502512714340035, -5.1655317332683275, 23.912637313632235, 15.675383203285325, 6.120804781625495, 39.27374544255493, 8.361215760345624, 4.405161200550133, 18.084692105299247, -18.342452371156753, 29.204551448765095, 9.026264850000182, 7.9861485344275085, 29.79392053189393, 26.665049360437724]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34891430237378307, "mean_inference_ms": 1.2084611289302458, "mean_action_processing_ms": 0.14794893048986532, "mean_env_wait_ms": 0.0954686561440092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005863110224405925, "StateBufferConnector_ms": 0.0019997358322143555, "ViewRequirementAgentConnector_ms": 0.0435209936565823}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 771.7731813721368, "num_env_steps_trained_throughput_per_sec": 771.7731813721368, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 5783.01, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5782.918, "sample_time_ms": 802.887, "learn_time_ms": 4966.629, "learn_throughput": 805.375, "synch_weights_time_ms": 12.77}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 5, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-55-10", "timestamp": 1723395310, "time_this_iter_s": 5.186179161071777, "time_total_s": 29.018409490585327, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78745e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 29.018409490585327, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 28.200000000000003, "ram_util_percent": 82.575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9925466238210598, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.304191648711761, "policy_loss": -0.007617870517909371, "vf_loss": 5.309932387868563, "vf_explained_var": -0.005071517266333103, "kl": 0.009385584167374362, "entropy": 1.4421199668198823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9675952884368598, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.325739737848441, "policy_loss": -0.0036689367244737998, "vf_loss": 5.328643534084161, "vf_explained_var": -0.01370484201858441, "kl": 0.003825671421521489, "entropy": 1.498557832588752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 22500, "policy_reward_min": {"prey_policy": -39.27374544255493, "predator_policy": -24.40922595283255}, "policy_reward_max": {"prey_policy": 24.40922595283255, "predator_policy": 39.27374544255493}, "policy_reward_mean": {"prey_policy": -14.308432408975783, "predator_policy": 14.308432408975783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [8.205758055737494, -11.220103424643497, -4.968299673585616, -3.0674765811593696, 24.40922595283255, -4.128373012780536, 4.711686589769521, -16.23360458908007, -19.12809493390561, -28.912401799586277, -33.237673258431876, 0.6805179293672445, -13.129993740491777, -32.37542183531753, -28.474962569808678, -29.091419840511488, -13.063163939245225, -11.364741796052009, -2.189826229972303, -20.262890803305105, -11.36775496428593, -27.502512714340035, 5.1655317332683275, -23.912637313632235, -15.675383203285325, -6.120804781625495, -39.27374544255493, -8.361215760345624, -4.405161200550133, -18.084692105299247, 18.342452371156753, -29.204551448765095, -9.026264850000182, -7.9861485344275085, -29.79392053189393, -26.665049360437724, -34.11013274551753, 3.6503871020945518, -10.066793321427078, -38.556308230313704, -19.357591075832886, -22.917595352100975, -28.885445444472335, 1.6351934537808415, -28.558055182932527], "policy_predator_policy_reward": [-8.205758055737494, 11.220103424643497, 4.968299673585616, 3.0674765811593696, -24.40922595283255, 4.128373012780536, -4.711686589769521, 16.23360458908007, 19.12809493390561, 28.912401799586277, 33.237673258431876, -0.6805179293672445, 13.129993740491777, 32.37542183531753, 28.474962569808678, 29.091419840511488, 13.063163939245225, 11.364741796052009, 2.189826229972303, 20.262890803305105, 11.36775496428593, 27.502512714340035, -5.1655317332683275, 23.912637313632235, 15.675383203285325, 6.120804781625495, 39.27374544255493, 8.361215760345624, 4.405161200550133, 18.084692105299247, -18.342452371156753, 29.204551448765095, 9.026264850000182, 7.9861485344275085, 29.79392053189393, 26.665049360437724, 34.11013274551753, -3.6503871020945518, 10.066793321427078, 38.556308230313704, 19.357591075832886, 22.917595352100975, 28.885445444472335, -1.6351934537808415, 28.558055182932527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34516541337327766, "mean_inference_ms": 1.1854835965961068, "mean_action_processing_ms": 0.14609125222412334, "mean_env_wait_ms": 0.09323507148706882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005679660373263889, "StateBufferConnector_ms": 0.002140733930799696, "ViewRequirementAgentConnector_ms": 0.04621214336819119}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 745.6427769535927, "num_env_steps_trained_throughput_per_sec": 745.6427769535927, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 5713.259, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5713.178, "sample_time_ms": 784.957, "learn_time_ms": 4915.411, "learn_throughput": 813.767, "synch_weights_time_ms": 12.233}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 6, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-55-15", "timestamp": 1723395315, "time_this_iter_s": 5.368244886398315, "time_total_s": 34.38665437698364, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7892c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 34.38665437698364, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 33.042857142857144, "ram_util_percent": 82.2857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.137762005161494, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.758637938896815, "policy_loss": -0.006383821485360386, "vf_loss": 4.763314482569695, "vf_explained_var": 0.17817802677551905, "kl": 0.008536467404228023, "entropy": 1.4100718064854543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.05910915757219, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.802173186341921, "policy_loss": -0.008341194393869955, "vf_loss": 4.8098353082935015, "vf_explained_var": 0.16755682397633792, "kl": 0.006790702726081221, "entropy": 1.454689797759056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 27000, "policy_reward_min": {"prey_policy": -39.27374544255493, "predator_policy": -24.40922595283255}, "policy_reward_max": {"prey_policy": 24.40922595283255, "predator_policy": 39.27374544255493}, "policy_reward_mean": {"prey_policy": -14.628960660440043, "predator_policy": 14.628960660440043}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [8.205758055737494, -11.220103424643497, -4.968299673585616, -3.0674765811593696, 24.40922595283255, -4.128373012780536, 4.711686589769521, -16.23360458908007, -19.12809493390561, -28.912401799586277, -33.237673258431876, 0.6805179293672445, -13.129993740491777, -32.37542183531753, -28.474962569808678, -29.091419840511488, -13.063163939245225, -11.364741796052009, -2.189826229972303, -20.262890803305105, -11.36775496428593, -27.502512714340035, 5.1655317332683275, -23.912637313632235, -15.675383203285325, -6.120804781625495, -39.27374544255493, -8.361215760345624, -4.405161200550133, -18.084692105299247, 18.342452371156753, -29.204551448765095, -9.026264850000182, -7.9861485344275085, -29.79392053189393, -26.665049360437724, -34.11013274551753, 3.6503871020945518, -10.066793321427078, -38.556308230313704, -19.357591075832886, -22.917595352100975, -28.885445444472335, 1.6351934537808415, -28.558055182932527, -10.616019610832588, -4.907435443072677, -4.251445469020256, -35.85424903396856, -15.098825454885617, -9.833977300238047, -23.018613032840125, -36.60514481633072, -5.898707098663619], "policy_predator_policy_reward": [-8.205758055737494, 11.220103424643497, 4.968299673585616, 3.0674765811593696, -24.40922595283255, 4.128373012780536, -4.711686589769521, 16.23360458908007, 19.12809493390561, 28.912401799586277, 33.237673258431876, -0.6805179293672445, 13.129993740491777, 32.37542183531753, 28.474962569808678, 29.091419840511488, 13.063163939245225, 11.364741796052009, 2.189826229972303, 20.262890803305105, 11.36775496428593, 27.502512714340035, -5.1655317332683275, 23.912637313632235, 15.675383203285325, 6.120804781625495, 39.27374544255493, 8.361215760345624, 4.405161200550133, 18.084692105299247, -18.342452371156753, 29.204551448765095, 9.026264850000182, 7.9861485344275085, 29.79392053189393, 26.665049360437724, 34.11013274551753, -3.6503871020945518, 10.066793321427078, 38.556308230313704, 19.357591075832886, 22.917595352100975, 28.885445444472335, -1.6351934537808415, 28.558055182932527, 10.616019610832588, 4.907435443072677, 4.251445469020256, 35.85424903396856, 15.098825454885617, 9.833977300238047, 23.018613032840125, 36.60514481633072, 5.898707098663619]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3421435221725747, "mean_inference_ms": 1.1687414429024148, "mean_action_processing_ms": 0.1445659158011446, "mean_env_wait_ms": 0.09130466716858704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005531752551043475, "StateBufferConnector_ms": 0.0021219253540039062, "ViewRequirementAgentConnector_ms": 0.046073728137546115}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 716.5307630409845, "num_env_steps_trained_throughput_per_sec": 716.5307630409845, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 5694.574, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5694.498, "sample_time_ms": 787.605, "learn_time_ms": 4893.436, "learn_throughput": 817.421, "synch_weights_time_ms": 12.899}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 7, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-55-20", "timestamp": 1723395320, "time_this_iter_s": 5.587327003479004, "time_total_s": 39.97398138046265, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78873a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 39.97398138046265, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 39.55, "ram_util_percent": 82.7875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5915657933180531, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.519687212258577, "policy_loss": -0.009713173669297248, "vf_loss": 3.5273617153366406, "vf_explained_var": 0.3204761614402135, "kl": 0.0101933119451921, "entropy": 1.3598769545555114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4414803341341516, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.67139944160978, "policy_loss": -0.01690075642254669, "vf_loss": 3.6870597700277963, "vf_explained_var": 0.2679631695151329, "kl": 0.012404249912665625, "entropy": 1.4488977532833816, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 31500, "policy_reward_min": {"prey_policy": -39.27374544255493, "predator_policy": -24.40922595283255}, "policy_reward_max": {"prey_policy": 24.40922595283255, "predator_policy": 39.27374544255493}, "policy_reward_mean": {"prey_policy": -14.572166412660394, "predator_policy": 14.572166412660394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [8.205758055737494, -11.220103424643497, -4.968299673585616, -3.0674765811593696, 24.40922595283255, -4.128373012780536, 4.711686589769521, -16.23360458908007, -19.12809493390561, -28.912401799586277, -33.237673258431876, 0.6805179293672445, -13.129993740491777, -32.37542183531753, -28.474962569808678, -29.091419840511488, -13.063163939245225, -11.364741796052009, -2.189826229972303, -20.262890803305105, -11.36775496428593, -27.502512714340035, 5.1655317332683275, -23.912637313632235, -15.675383203285325, -6.120804781625495, -39.27374544255493, -8.361215760345624, -4.405161200550133, -18.084692105299247, 18.342452371156753, -29.204551448765095, -9.026264850000182, -7.9861485344275085, -29.79392053189393, -26.665049360437724, -34.11013274551753, 3.6503871020945518, -10.066793321427078, -38.556308230313704, -19.357591075832886, -22.917595352100975, -28.885445444472335, 1.6351934537808415, -28.558055182932527, -10.616019610832588, -4.907435443072677, -4.251445469020256, -35.85424903396856, -15.098825454885617, -9.833977300238047, -23.018613032840125, -36.60514481633072, -5.898707098663619, -30.212308973547977, 0.03852266177169783, -3.3346801971029927, -19.744183778063952, -3.5767481897317253, -31.736520315158312, -13.726609910186433, -19.799797839987956, -5.990281791834997], "policy_predator_policy_reward": [-8.205758055737494, 11.220103424643497, 4.968299673585616, 3.0674765811593696, -24.40922595283255, 4.128373012780536, -4.711686589769521, 16.23360458908007, 19.12809493390561, 28.912401799586277, 33.237673258431876, -0.6805179293672445, 13.129993740491777, 32.37542183531753, 28.474962569808678, 29.091419840511488, 13.063163939245225, 11.364741796052009, 2.189826229972303, 20.262890803305105, 11.36775496428593, 27.502512714340035, -5.1655317332683275, 23.912637313632235, 15.675383203285325, 6.120804781625495, 39.27374544255493, 8.361215760345624, 4.405161200550133, 18.084692105299247, -18.342452371156753, 29.204551448765095, 9.026264850000182, 7.9861485344275085, 29.79392053189393, 26.665049360437724, 34.11013274551753, -3.6503871020945518, 10.066793321427078, 38.556308230313704, 19.357591075832886, 22.917595352100975, 28.885445444472335, -1.6351934537808415, 28.558055182932527, 10.616019610832588, 4.907435443072677, 4.251445469020256, 35.85424903396856, 15.098825454885617, 9.833977300238047, 23.018613032840125, 36.60514481633072, 5.898707098663619, 30.212308973547977, -0.03852266177169783, 3.3346801971029927, 19.744183778063952, 3.5767481897317253, 31.736520315158312, 13.726609910186433, 19.799797839987956, 5.990281791834997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3389131302258254, "mean_inference_ms": 1.1530147714136134, "mean_action_processing_ms": 0.14312546357541245, "mean_env_wait_ms": 0.08957052437395555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005289486476353237, "StateBufferConnector_ms": 0.0020704572162930928, "ViewRequirementAgentConnector_ms": 0.045154208228701635}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 780.4326919543389, "num_env_steps_trained_throughput_per_sec": 780.4326919543389, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 5623.424, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5623.352, "sample_time_ms": 766.816, "learn_time_ms": 4843.438, "learn_throughput": 825.86, "synch_weights_time_ms": 12.57}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 8, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-55-26", "timestamp": 1723395326, "time_this_iter_s": 5.1280200481414795, "time_total_s": 45.102001428604126, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78745e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 45.102001428604126, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 29.0, "ram_util_percent": 82.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9069085127363603, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2823241689552862, "policy_loss": -0.008536799554228007, "vf_loss": 2.289288968841235, "vf_explained_var": 0.42717056920131047, "kl": 0.007860019062058132, "entropy": 1.3747276553263268, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7808855639770627, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6690283488482236, "policy_loss": -0.00755628260303638, "vf_loss": 2.6758471998075644, "vf_explained_var": 0.33354567835728327, "kl": 0.007374275720060222, "entropy": 1.437978128095468, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 33500, "policy_reward_min": {"prey_policy": -42.56044608866132, "predator_policy": -24.40922595283255}, "policy_reward_max": {"prey_policy": 24.40922595283255, "predator_policy": 42.56044608866132}, "policy_reward_mean": {"prey_policy": -15.741900430561746, "predator_policy": 15.741900430561746}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [8.205758055737494, -11.220103424643497, -4.968299673585616, -3.0674765811593696, 24.40922595283255, -4.128373012780536, 4.711686589769521, -16.23360458908007, -19.12809493390561, -28.912401799586277, -33.237673258431876, 0.6805179293672445, -13.129993740491777, -32.37542183531753, -28.474962569808678, -29.091419840511488, -13.063163939245225, -11.364741796052009, -2.189826229972303, -20.262890803305105, -11.36775496428593, -27.502512714340035, 5.1655317332683275, -23.912637313632235, -15.675383203285325, -6.120804781625495, -39.27374544255493, -8.361215760345624, -4.405161200550133, -18.084692105299247, 18.342452371156753, -29.204551448765095, -9.026264850000182, -7.9861485344275085, -29.79392053189393, -26.665049360437724, -34.11013274551753, 3.6503871020945518, -10.066793321427078, -38.556308230313704, -19.357591075832886, -22.917595352100975, -28.885445444472335, 1.6351934537808415, -28.558055182932527, -10.616019610832588, -4.907435443072677, -4.251445469020256, -35.85424903396856, -15.098825454885617, -9.833977300238047, -23.018613032840125, -36.60514481633072, -5.898707098663619, -30.212308973547977, 0.03852266177169783, -3.3346801971029927, -19.744183778063952, -3.5767481897317253, -31.736520315158312, -13.726609910186433, -19.799797839987956, -5.990281791834997, -37.060221087729374, -42.56044608866132, -15.316161648515395, -41.72401602512593], "policy_predator_policy_reward": [-8.205758055737494, 11.220103424643497, 4.968299673585616, 3.0674765811593696, -24.40922595283255, 4.128373012780536, -4.711686589769521, 16.23360458908007, 19.12809493390561, 28.912401799586277, 33.237673258431876, -0.6805179293672445, 13.129993740491777, 32.37542183531753, 28.474962569808678, 29.091419840511488, 13.063163939245225, 11.364741796052009, 2.189826229972303, 20.262890803305105, 11.36775496428593, 27.502512714340035, -5.1655317332683275, 23.912637313632235, 15.675383203285325, 6.120804781625495, 39.27374544255493, 8.361215760345624, 4.405161200550133, 18.084692105299247, -18.342452371156753, 29.204551448765095, 9.026264850000182, 7.9861485344275085, 29.79392053189393, 26.665049360437724, 34.11013274551753, -3.6503871020945518, 10.066793321427078, 38.556308230313704, 19.357591075832886, 22.917595352100975, 28.885445444472335, -1.6351934537808415, 28.558055182932527, 10.616019610832588, 4.907435443072677, 4.251445469020256, 35.85424903396856, 15.098825454885617, 9.833977300238047, 23.018613032840125, 36.60514481633072, 5.898707098663619, 30.212308973547977, -0.03852266177169783, 3.3346801971029927, 19.744183778063952, 3.5767481897317253, 31.736520315158312, 13.726609910186433, 19.799797839987956, 5.990281791834997, 37.060221087729374, 42.56044608866132, 15.316161648515395, 41.72401602512593]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33726100813308035, "mean_inference_ms": 1.1454422418196002, "mean_action_processing_ms": 0.14235997175589435, "mean_env_wait_ms": 0.0887432974797355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005219053866258308, "StateBufferConnector_ms": 0.0020578726014094566, "ViewRequirementAgentConnector_ms": 0.045055773720812445}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 725.1396190232832, "num_env_steps_trained_throughput_per_sec": 725.1396190232832, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 5611.508, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5611.441, "sample_time_ms": 752.394, "learn_time_ms": 4846.195, "learn_throughput": 825.39, "synch_weights_time_ms": 12.344}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 9, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-55-31", "timestamp": 1723395331, "time_this_iter_s": 5.520434856414795, "time_total_s": 50.62243628501892, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78e1280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50.62243628501892, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 38.2875, "ram_util_percent": 82.4875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4391973276622594, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.492664081106583, "policy_loss": -0.006051103673235048, "vf_loss": 2.4978059612214567, "vf_explained_var": 0.16645071196059386, "kl": 0.004546120188832615, "entropy": 1.2925718837728104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.549014651061346, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.663884743054708, "policy_loss": -0.009149885191194092, "vf_loss": 2.6724517716715734, "vf_explained_var": 0.06829464808106422, "kl": 0.005828730035280911, "entropy": 1.387273360664646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -42.73051611370174, "predator_policy": -24.40922595283255}, "policy_reward_max": {"prey_policy": 24.40922595283255, "predator_policy": 42.73051611370174}, "policy_reward_mean": {"prey_policy": -16.364659382899234, "predator_policy": 16.364659382899234}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [8.205758055737494, -11.220103424643497, -4.968299673585616, -3.0674765811593696, 24.40922595283255, -4.128373012780536, 4.711686589769521, -16.23360458908007, -19.12809493390561, -28.912401799586277, -33.237673258431876, 0.6805179293672445, -13.129993740491777, -32.37542183531753, -28.474962569808678, -29.091419840511488, -13.063163939245225, -11.364741796052009, -2.189826229972303, -20.262890803305105, -11.36775496428593, -27.502512714340035, 5.1655317332683275, -23.912637313632235, -15.675383203285325, -6.120804781625495, -39.27374544255493, -8.361215760345624, -4.405161200550133, -18.084692105299247, 18.342452371156753, -29.204551448765095, -9.026264850000182, -7.9861485344275085, -29.79392053189393, -26.665049360437724, -34.11013274551753, 3.6503871020945518, -10.066793321427078, -38.556308230313704, -19.357591075832886, -22.917595352100975, -28.885445444472335, 1.6351934537808415, -28.558055182932527, -10.616019610832588, -4.907435443072677, -4.251445469020256, -35.85424903396856, -15.098825454885617, -9.833977300238047, -23.018613032840125, -36.60514481633072, -5.898707098663619, -30.212308973547977, 0.03852266177169783, -3.3346801971029927, -19.744183778063952, -3.5767481897317253, -31.736520315158312, -13.726609910186433, -19.799797839987956, -5.990281791834997, -37.060221087729374, -42.56044608866132, -15.316161648515395, -41.72401602512593, -26.7608206075627, -13.934982948672427, -6.643002943452203, -33.47882410771861, -42.73051611370174], "policy_predator_policy_reward": [-8.205758055737494, 11.220103424643497, 4.968299673585616, 3.0674765811593696, -24.40922595283255, 4.128373012780536, -4.711686589769521, 16.23360458908007, 19.12809493390561, 28.912401799586277, 33.237673258431876, -0.6805179293672445, 13.129993740491777, 32.37542183531753, 28.474962569808678, 29.091419840511488, 13.063163939245225, 11.364741796052009, 2.189826229972303, 20.262890803305105, 11.36775496428593, 27.502512714340035, -5.1655317332683275, 23.912637313632235, 15.675383203285325, 6.120804781625495, 39.27374544255493, 8.361215760345624, 4.405161200550133, 18.084692105299247, -18.342452371156753, 29.204551448765095, 9.026264850000182, 7.9861485344275085, 29.79392053189393, 26.665049360437724, 34.11013274551753, -3.6503871020945518, 10.066793321427078, 38.556308230313704, 19.357591075832886, 22.917595352100975, 28.885445444472335, -1.6351934537808415, 28.558055182932527, 10.616019610832588, 4.907435443072677, 4.251445469020256, 35.85424903396856, 15.098825454885617, 9.833977300238047, 23.018613032840125, 36.60514481633072, 5.898707098663619, 30.212308973547977, -0.03852266177169783, 3.3346801971029927, 19.744183778063952, 3.5767481897317253, 31.736520315158312, 13.726609910186433, 19.799797839987956, 5.990281791834997, 37.060221087729374, 42.56044608866132, 15.316161648515395, 41.72401602512593, 26.7608206075627, 13.934982948672427, 6.643002943452203, 33.47882410771861, 42.73051611370174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33538844847534205, "mean_inference_ms": 1.137882319122646, "mean_action_processing_ms": 0.14175064129537832, "mean_env_wait_ms": 0.08793915788182678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005393061372968886, "StateBufferConnector_ms": 0.002074076069725884, "ViewRequirementAgentConnector_ms": 0.04558629459804959}, "num_episodes": 5, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 755.1504132951573, "num_env_steps_trained_throughput_per_sec": 755.1504132951573, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 5580.055, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5579.99, "sample_time_ms": 742.856, "learn_time_ms": 4824.436, "learn_throughput": 829.112, "synch_weights_time_ms": 12.209}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 10, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-55-37", "timestamp": 1723395337, "time_this_iter_s": 5.316189289093018, "time_total_s": 55.93862557411194, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78873a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 55.93862557411194, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 35.714285714285715, "ram_util_percent": 82.31428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4560443253877262, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5555061375101407, "policy_loss": -0.00540522512019379, "vf_loss": 1.5605856349070868, "vf_explained_var": 0.5145840736106038, "kl": 0.0032572237597850327, "entropy": 1.3246867502729098, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3843559007470807, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7549299461146195, "policy_loss": -0.008384456114436034, "vf_loss": 1.7626360030844808, "vf_explained_var": 0.5077860010166962, "kl": 0.00678392391041849, "entropy": 1.42949007426699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 40500, "policy_reward_min": {"prey_policy": -45.36064911829685, "predator_policy": -24.40922595283255}, "policy_reward_max": {"prey_policy": 24.40922595283255, "predator_policy": 45.36064911829685}, "policy_reward_mean": {"prey_policy": -17.176487595486396, "predator_policy": 17.176487595486396}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [8.205758055737494, -11.220103424643497, -4.968299673585616, -3.0674765811593696, 24.40922595283255, -4.128373012780536, 4.711686589769521, -16.23360458908007, -19.12809493390561, -28.912401799586277, -33.237673258431876, 0.6805179293672445, -13.129993740491777, -32.37542183531753, -28.474962569808678, -29.091419840511488, -13.063163939245225, -11.364741796052009, -2.189826229972303, -20.262890803305105, -11.36775496428593, -27.502512714340035, 5.1655317332683275, -23.912637313632235, -15.675383203285325, -6.120804781625495, -39.27374544255493, -8.361215760345624, -4.405161200550133, -18.084692105299247, 18.342452371156753, -29.204551448765095, -9.026264850000182, -7.9861485344275085, -29.79392053189393, -26.665049360437724, -34.11013274551753, 3.6503871020945518, -10.066793321427078, -38.556308230313704, -19.357591075832886, -22.917595352100975, -28.885445444472335, 1.6351934537808415, -28.558055182932527, -10.616019610832588, -4.907435443072677, -4.251445469020256, -35.85424903396856, -15.098825454885617, -9.833977300238047, -23.018613032840125, -36.60514481633072, -5.898707098663619, -30.212308973547977, 0.03852266177169783, -3.3346801971029927, -19.744183778063952, -3.5767481897317253, -31.736520315158312, -13.726609910186433, -19.799797839987956, -5.990281791834997, -37.060221087729374, -42.56044608866132, -15.316161648515395, -41.72401602512593, -26.7608206075627, -13.934982948672427, -6.643002943452203, -33.47882410771861, -42.73051611370174, -13.830594015690766, -10.81907349539046, -31.32990388785292, -21.372000681101298, -20.72872538537377, -19.35913454567289, -45.36064911829685, -32.397201310081435, -17.84273722619286], "policy_predator_policy_reward": [-8.205758055737494, 11.220103424643497, 4.968299673585616, 3.0674765811593696, -24.40922595283255, 4.128373012780536, -4.711686589769521, 16.23360458908007, 19.12809493390561, 28.912401799586277, 33.237673258431876, -0.6805179293672445, 13.129993740491777, 32.37542183531753, 28.474962569808678, 29.091419840511488, 13.063163939245225, 11.364741796052009, 2.189826229972303, 20.262890803305105, 11.36775496428593, 27.502512714340035, -5.1655317332683275, 23.912637313632235, 15.675383203285325, 6.120804781625495, 39.27374544255493, 8.361215760345624, 4.405161200550133, 18.084692105299247, -18.342452371156753, 29.204551448765095, 9.026264850000182, 7.9861485344275085, 29.79392053189393, 26.665049360437724, 34.11013274551753, -3.6503871020945518, 10.066793321427078, 38.556308230313704, 19.357591075832886, 22.917595352100975, 28.885445444472335, -1.6351934537808415, 28.558055182932527, 10.616019610832588, 4.907435443072677, 4.251445469020256, 35.85424903396856, 15.098825454885617, 9.833977300238047, 23.018613032840125, 36.60514481633072, 5.898707098663619, 30.212308973547977, -0.03852266177169783, 3.3346801971029927, 19.744183778063952, 3.5767481897317253, 31.736520315158312, 13.726609910186433, 19.799797839987956, 5.990281791834997, 37.060221087729374, 42.56044608866132, 15.316161648515395, 41.72401602512593, 26.7608206075627, 13.934982948672427, 6.643002943452203, 33.47882410771861, 42.73051611370174, 13.830594015690766, 10.81907349539046, 31.32990388785292, 21.372000681101298, 20.72872538537377, 19.35913454567289, 45.36064911829685, 32.397201310081435, 17.84273722619286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33208673669832256, "mean_inference_ms": 1.1243270761433364, "mean_action_processing_ms": 0.1405384047523926, "mean_env_wait_ms": 0.08650230950637017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005819179393627026, "StateBufferConnector_ms": 0.0020749774979956356, "ViewRequirementAgentConnector_ms": 0.045581805853196135}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 783.0272750600273, "num_env_steps_trained_throughput_per_sec": 783.0272750600273, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 5458.572, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5458.513, "sample_time_ms": 691.563, "learn_time_ms": 4754.465, "learn_throughput": 841.314, "synch_weights_time_ms": 12.007}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 11, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-55-42", "timestamp": 1723395342, "time_this_iter_s": 5.111554145812988, "time_total_s": 61.05017971992493, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7887670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 61.05017971992493, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 32.48571428571429, "ram_util_percent": 82.27142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2377652418799698, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.721805181975166, "policy_loss": -0.00010198836437969779, "vf_loss": 1.721794197956721, "vf_explained_var": 0.00757707729935646, "kl": 0.0022593025318748774, "entropy": 1.3481702612092097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2780234121717513, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8512004021555186, "policy_loss": -0.010066923292955228, "vf_loss": 1.860411782686909, "vf_explained_var": 0.056681089910368125, "kl": 0.008555414343449546, "entropy": 1.4533535266915958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 45000, "policy_reward_min": {"prey_policy": -52.65187085949701, "predator_policy": -24.40922595283255}, "policy_reward_max": {"prey_policy": 24.40922595283255, "predator_policy": 52.65187085949701}, "policy_reward_mean": {"prey_policy": -17.680778917657523, "predator_policy": 17.680778917657523}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [8.205758055737494, -11.220103424643497, -4.968299673585616, -3.0674765811593696, 24.40922595283255, -4.128373012780536, 4.711686589769521, -16.23360458908007, -19.12809493390561, -28.912401799586277, -33.237673258431876, 0.6805179293672445, -13.129993740491777, -32.37542183531753, -28.474962569808678, -29.091419840511488, -13.063163939245225, -11.364741796052009, -2.189826229972303, -20.262890803305105, -11.36775496428593, -27.502512714340035, 5.1655317332683275, -23.912637313632235, -15.675383203285325, -6.120804781625495, -39.27374544255493, -8.361215760345624, -4.405161200550133, -18.084692105299247, 18.342452371156753, -29.204551448765095, -9.026264850000182, -7.9861485344275085, -29.79392053189393, -26.665049360437724, -34.11013274551753, 3.6503871020945518, -10.066793321427078, -38.556308230313704, -19.357591075832886, -22.917595352100975, -28.885445444472335, 1.6351934537808415, -28.558055182932527, -10.616019610832588, -4.907435443072677, -4.251445469020256, -35.85424903396856, -15.098825454885617, -9.833977300238047, -23.018613032840125, -36.60514481633072, -5.898707098663619, -30.212308973547977, 0.03852266177169783, -3.3346801971029927, -19.744183778063952, -3.5767481897317253, -31.736520315158312, -13.726609910186433, -19.799797839987956, -5.990281791834997, -37.060221087729374, -42.56044608866132, -15.316161648515395, -41.72401602512593, -26.7608206075627, -13.934982948672427, -6.643002943452203, -33.47882410771861, -42.73051611370174, -13.830594015690766, -10.81907349539046, -31.32990388785292, -21.372000681101298, -20.72872538537377, -19.35913454567289, -45.36064911829685, -32.397201310081435, -17.84273722619286, -11.433064095255679, -39.68587477282896, -8.301616767155217, -19.438208246201746, -25.433078272584613, -11.897510033547178, -23.396382496215928, -52.65187085949701, -7.737001811492655], "policy_predator_policy_reward": [-8.205758055737494, 11.220103424643497, 4.968299673585616, 3.0674765811593696, -24.40922595283255, 4.128373012780536, -4.711686589769521, 16.23360458908007, 19.12809493390561, 28.912401799586277, 33.237673258431876, -0.6805179293672445, 13.129993740491777, 32.37542183531753, 28.474962569808678, 29.091419840511488, 13.063163939245225, 11.364741796052009, 2.189826229972303, 20.262890803305105, 11.36775496428593, 27.502512714340035, -5.1655317332683275, 23.912637313632235, 15.675383203285325, 6.120804781625495, 39.27374544255493, 8.361215760345624, 4.405161200550133, 18.084692105299247, -18.342452371156753, 29.204551448765095, 9.026264850000182, 7.9861485344275085, 29.79392053189393, 26.665049360437724, 34.11013274551753, -3.6503871020945518, 10.066793321427078, 38.556308230313704, 19.357591075832886, 22.917595352100975, 28.885445444472335, -1.6351934537808415, 28.558055182932527, 10.616019610832588, 4.907435443072677, 4.251445469020256, 35.85424903396856, 15.098825454885617, 9.833977300238047, 23.018613032840125, 36.60514481633072, 5.898707098663619, 30.212308973547977, -0.03852266177169783, 3.3346801971029927, 19.744183778063952, 3.5767481897317253, 31.736520315158312, 13.726609910186433, 19.799797839987956, 5.990281791834997, 37.060221087729374, 42.56044608866132, 15.316161648515395, 41.72401602512593, 26.7608206075627, 13.934982948672427, 6.643002943452203, 33.47882410771861, 42.73051611370174, 13.830594015690766, 10.81907349539046, 31.32990388785292, 21.372000681101298, 20.72872538537377, 19.35913454567289, 45.36064911829685, 32.397201310081435, 17.84273722619286, 11.433064095255679, 39.68587477282896, 8.301616767155217, 19.438208246201746, 25.433078272584613, 11.897510033547178, 23.396382496215928, 52.65187085949701, 7.737001811492655]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3292942167491351, "mean_inference_ms": 1.1134271071809851, "mean_action_processing_ms": 0.13959404159006628, "mean_env_wait_ms": 0.0853138302180066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057485368516710066, "StateBufferConnector_ms": 0.0021440452999538845, "ViewRequirementAgentConnector_ms": 0.04732198185390896}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 791.8965439685726, "num_env_steps_trained_throughput_per_sec": 791.8965439685726, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 5420.773, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5420.714, "sample_time_ms": 690.026, "learn_time_ms": 4718.247, "learn_throughput": 847.772, "synch_weights_time_ms": 11.967}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 12, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-55-47", "timestamp": 1723395347, "time_this_iter_s": 5.056056976318359, "time_total_s": 66.10623669624329, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78a9430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 66.10623669624329, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 37.3, "ram_util_percent": 82.2375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1316348888600867, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2369051092614731, "policy_loss": -0.003575572139622333, "vf_loss": 1.2403950684393446, "vf_explained_var": -0.02247777928908666, "kl": 0.0034246367165205347, "entropy": 1.333583022405704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.249607671890408, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3002503224648536, "policy_loss": -0.011871450402638099, "vf_loss": 1.3111290756613017, "vf_explained_var": -0.006992496798435847, "kl": 0.009926952657264195, "entropy": 1.4520452354103326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 49500, "policy_reward_min": {"prey_policy": -52.65187085949701, "predator_policy": -24.40922595283255}, "policy_reward_max": {"prey_policy": 24.40922595283255, "predator_policy": 52.65187085949701}, "policy_reward_mean": {"prey_policy": -18.479043776783513, "predator_policy": 18.479043776783513}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [8.205758055737494, -11.220103424643497, -4.968299673585616, -3.0674765811593696, 24.40922595283255, -4.128373012780536, 4.711686589769521, -16.23360458908007, -19.12809493390561, -28.912401799586277, -33.237673258431876, 0.6805179293672445, -13.129993740491777, -32.37542183531753, -28.474962569808678, -29.091419840511488, -13.063163939245225, -11.364741796052009, -2.189826229972303, -20.262890803305105, -11.36775496428593, -27.502512714340035, 5.1655317332683275, -23.912637313632235, -15.675383203285325, -6.120804781625495, -39.27374544255493, -8.361215760345624, -4.405161200550133, -18.084692105299247, 18.342452371156753, -29.204551448765095, -9.026264850000182, -7.9861485344275085, -29.79392053189393, -26.665049360437724, -34.11013274551753, 3.6503871020945518, -10.066793321427078, -38.556308230313704, -19.357591075832886, -22.917595352100975, -28.885445444472335, 1.6351934537808415, -28.558055182932527, -10.616019610832588, -4.907435443072677, -4.251445469020256, -35.85424903396856, -15.098825454885617, -9.833977300238047, -23.018613032840125, -36.60514481633072, -5.898707098663619, -30.212308973547977, 0.03852266177169783, -3.3346801971029927, -19.744183778063952, -3.5767481897317253, -31.736520315158312, -13.726609910186433, -19.799797839987956, -5.990281791834997, -37.060221087729374, -42.56044608866132, -15.316161648515395, -41.72401602512593, -26.7608206075627, -13.934982948672427, -6.643002943452203, -33.47882410771861, -42.73051611370174, -13.830594015690766, -10.81907349539046, -31.32990388785292, -21.372000681101298, -20.72872538537377, -19.35913454567289, -45.36064911829685, -32.397201310081435, -17.84273722619286, -11.433064095255679, -39.68587477282896, -8.301616767155217, -19.438208246201746, -25.433078272584613, -11.897510033547178, -23.396382496215928, -52.65187085949701, -7.737001811492655, -4.738490833884459, -10.904905894862532, -38.947951123043, -46.044139281404, -30.18454137782855, -40.766167653769116, -34.75034763037793, -21.368380615794514, -10.450306901427034], "policy_predator_policy_reward": [-8.205758055737494, 11.220103424643497, 4.968299673585616, 3.0674765811593696, -24.40922595283255, 4.128373012780536, -4.711686589769521, 16.23360458908007, 19.12809493390561, 28.912401799586277, 33.237673258431876, -0.6805179293672445, 13.129993740491777, 32.37542183531753, 28.474962569808678, 29.091419840511488, 13.063163939245225, 11.364741796052009, 2.189826229972303, 20.262890803305105, 11.36775496428593, 27.502512714340035, -5.1655317332683275, 23.912637313632235, 15.675383203285325, 6.120804781625495, 39.27374544255493, 8.361215760345624, 4.405161200550133, 18.084692105299247, -18.342452371156753, 29.204551448765095, 9.026264850000182, 7.9861485344275085, 29.79392053189393, 26.665049360437724, 34.11013274551753, -3.6503871020945518, 10.066793321427078, 38.556308230313704, 19.357591075832886, 22.917595352100975, 28.885445444472335, -1.6351934537808415, 28.558055182932527, 10.616019610832588, 4.907435443072677, 4.251445469020256, 35.85424903396856, 15.098825454885617, 9.833977300238047, 23.018613032840125, 36.60514481633072, 5.898707098663619, 30.212308973547977, -0.03852266177169783, 3.3346801971029927, 19.744183778063952, 3.5767481897317253, 31.736520315158312, 13.726609910186433, 19.799797839987956, 5.990281791834997, 37.060221087729374, 42.56044608866132, 15.316161648515395, 41.72401602512593, 26.7608206075627, 13.934982948672427, 6.643002943452203, 33.47882410771861, 42.73051611370174, 13.830594015690766, 10.81907349539046, 31.32990388785292, 21.372000681101298, 20.72872538537377, 19.35913454567289, 45.36064911829685, 32.397201310081435, 17.84273722619286, 11.433064095255679, 39.68587477282896, 8.301616767155217, 19.438208246201746, 25.433078272584613, 11.897510033547178, 23.396382496215928, 52.65187085949701, 7.737001811492655, 4.738490833884459, 10.904905894862532, 38.947951123043, 46.044139281404, 30.18454137782855, 40.766167653769116, 34.75034763037793, 21.368380615794514, 10.450306901427034]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3267645761987287, "mean_inference_ms": 1.1038136457864876, "mean_action_processing_ms": 0.1387597579672549, "mean_env_wait_ms": 0.08425986201436803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005464842825224905, "StateBufferConnector_ms": 0.002143840597133444, "ViewRequirementAgentConnector_ms": 0.047676972668580335}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 786.9374474633262, "num_env_steps_trained_throughput_per_sec": 786.9374474633262, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 5296.155, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5296.115, "sample_time_ms": 688.868, "learn_time_ms": 4595.836, "learn_throughput": 870.353, "synch_weights_time_ms": 11.066}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 13, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-55-52", "timestamp": 1723395352, "time_this_iter_s": 5.085728168487549, "time_total_s": 71.19196486473083, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78744c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 71.19196486473083, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 37.728571428571435, "ram_util_percent": 82.34285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0850396600241463, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8999616234873732, "policy_loss": -0.003356965956724404, "vf_loss": 0.9032583362422884, "vf_explained_var": 0.2763694316148758, "kl": 0.004820181681832412, "entropy": 1.3596823970476786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3381060204468667, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.041838605426407, "policy_loss": -0.008017866343046383, "vf_loss": 1.0492060399924716, "vf_explained_var": 0.2622115686535835, "kl": 0.006504290693978495, "entropy": 1.472304689263304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -58.267335207669575, "predator_policy": -18.342452371156753}, "policy_reward_max": {"prey_policy": 18.342452371156753, "predator_policy": 58.267335207669575}, "policy_reward_mean": {"prey_policy": -20.84658026687535, "predator_policy": 20.84658026687535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-19.12809493390561, -28.912401799586277, -33.237673258431876, 0.6805179293672445, -13.129993740491777, -32.37542183531753, -28.474962569808678, -29.091419840511488, -13.063163939245225, -11.364741796052009, -2.189826229972303, -20.262890803305105, -11.36775496428593, -27.502512714340035, 5.1655317332683275, -23.912637313632235, -15.675383203285325, -6.120804781625495, -39.27374544255493, -8.361215760345624, -4.405161200550133, -18.084692105299247, 18.342452371156753, -29.204551448765095, -9.026264850000182, -7.9861485344275085, -29.79392053189393, -26.665049360437724, -34.11013274551753, 3.6503871020945518, -10.066793321427078, -38.556308230313704, -19.357591075832886, -22.917595352100975, -28.885445444472335, 1.6351934537808415, -28.558055182932527, -10.616019610832588, -4.907435443072677, -4.251445469020256, -35.85424903396856, -15.098825454885617, -9.833977300238047, -23.018613032840125, -36.60514481633072, -5.898707098663619, -30.212308973547977, 0.03852266177169783, -3.3346801971029927, -19.744183778063952, -3.5767481897317253, -31.736520315158312, -13.726609910186433, -19.799797839987956, -5.990281791834997, -37.060221087729374, -42.56044608866132, -15.316161648515395, -41.72401602512593, -26.7608206075627, -13.934982948672427, -6.643002943452203, -33.47882410771861, -42.73051611370174, -13.830594015690766, -10.81907349539046, -31.32990388785292, -21.372000681101298, -20.72872538537377, -19.35913454567289, -45.36064911829685, -32.397201310081435, -17.84273722619286, -11.433064095255679, -39.68587477282896, -8.301616767155217, -19.438208246201746, -25.433078272584613, -11.897510033547178, -23.396382496215928, -52.65187085949701, -7.737001811492655, -4.738490833884459, -10.904905894862532, -38.947951123043, -46.044139281404, -30.18454137782855, -40.766167653769116, -34.75034763037793, -21.368380615794514, -10.450306901427034, -44.06827036307091, -3.987763432000672, -24.538256372231434, -28.532196014562018, -12.903365773243882, -15.807119206860929, -30.953889403343965, -38.46568369589294, -58.267335207669575], "policy_predator_policy_reward": [19.12809493390561, 28.912401799586277, 33.237673258431876, -0.6805179293672445, 13.129993740491777, 32.37542183531753, 28.474962569808678, 29.091419840511488, 13.063163939245225, 11.364741796052009, 2.189826229972303, 20.262890803305105, 11.36775496428593, 27.502512714340035, -5.1655317332683275, 23.912637313632235, 15.675383203285325, 6.120804781625495, 39.27374544255493, 8.361215760345624, 4.405161200550133, 18.084692105299247, -18.342452371156753, 29.204551448765095, 9.026264850000182, 7.9861485344275085, 29.79392053189393, 26.665049360437724, 34.11013274551753, -3.6503871020945518, 10.066793321427078, 38.556308230313704, 19.357591075832886, 22.917595352100975, 28.885445444472335, -1.6351934537808415, 28.558055182932527, 10.616019610832588, 4.907435443072677, 4.251445469020256, 35.85424903396856, 15.098825454885617, 9.833977300238047, 23.018613032840125, 36.60514481633072, 5.898707098663619, 30.212308973547977, -0.03852266177169783, 3.3346801971029927, 19.744183778063952, 3.5767481897317253, 31.736520315158312, 13.726609910186433, 19.799797839987956, 5.990281791834997, 37.060221087729374, 42.56044608866132, 15.316161648515395, 41.72401602512593, 26.7608206075627, 13.934982948672427, 6.643002943452203, 33.47882410771861, 42.73051611370174, 13.830594015690766, 10.81907349539046, 31.32990388785292, 21.372000681101298, 20.72872538537377, 19.35913454567289, 45.36064911829685, 32.397201310081435, 17.84273722619286, 11.433064095255679, 39.68587477282896, 8.301616767155217, 19.438208246201746, 25.433078272584613, 11.897510033547178, 23.396382496215928, 52.65187085949701, 7.737001811492655, 4.738490833884459, 10.904905894862532, 38.947951123043, 46.044139281404, 30.18454137782855, 40.766167653769116, 34.75034763037793, 21.368380615794514, 10.450306901427034, 44.06827036307091, 3.987763432000672, 24.538256372231434, 28.532196014562018, 12.903365773243882, 15.807119206860929, 30.953889403343965, 38.46568369589294, 58.267335207669575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32089342769461354, "mean_inference_ms": 1.074596088936577, "mean_action_processing_ms": 0.13648543903539828, "mean_env_wait_ms": 0.08170604550993503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048635005950927734, "StateBufferConnector_ms": 0.002116680145263672, "ViewRequirementAgentConnector_ms": 0.05064821243286133}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 723.8271805795056, "num_env_steps_trained_throughput_per_sec": 723.8271805795056, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 5283.713, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5283.676, "sample_time_ms": 680.195, "learn_time_ms": 4591.835, "learn_throughput": 871.112, "synch_weights_time_ms": 11.293}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 14, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-55-57", "timestamp": 1723395357, "time_this_iter_s": 5.529416084289551, "time_total_s": 76.72138094902039, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x325fea8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 76.72138094902039, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 45.95, "ram_util_percent": 82.88749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7669694429573913, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6589414674788714, "policy_loss": -0.0033206678461283447, "vf_loss": 0.6622308543029551, "vf_explained_var": 0.29166026394814254, "kl": 0.00500505576335951, "entropy": 1.3653635141750178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1804076241484533, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7049553930565404, "policy_loss": -0.009252918896527263, "vf_loss": 0.7136149195333322, "vf_explained_var": 0.24826307619611424, "kl": 0.005933918664830983, "entropy": 1.503416352843245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -58.267335207669575, "predator_policy": -18.342452371156753}, "policy_reward_max": {"prey_policy": 18.342452371156753, "predator_policy": 58.267335207669575}, "policy_reward_mean": {"prey_policy": -21.129574761652847, "predator_policy": 21.129574761652847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-11.364741796052009, -2.189826229972303, -20.262890803305105, -11.36775496428593, -27.502512714340035, 5.1655317332683275, -23.912637313632235, -15.675383203285325, -6.120804781625495, -39.27374544255493, -8.361215760345624, -4.405161200550133, -18.084692105299247, 18.342452371156753, -29.204551448765095, -9.026264850000182, -7.9861485344275085, -29.79392053189393, -26.665049360437724, -34.11013274551753, 3.6503871020945518, -10.066793321427078, -38.556308230313704, -19.357591075832886, -22.917595352100975, -28.885445444472335, 1.6351934537808415, -28.558055182932527, -10.616019610832588, -4.907435443072677, -4.251445469020256, -35.85424903396856, -15.098825454885617, -9.833977300238047, -23.018613032840125, -36.60514481633072, -5.898707098663619, -30.212308973547977, 0.03852266177169783, -3.3346801971029927, -19.744183778063952, -3.5767481897317253, -31.736520315158312, -13.726609910186433, -19.799797839987956, -5.990281791834997, -37.060221087729374, -42.56044608866132, -15.316161648515395, -41.72401602512593, -26.7608206075627, -13.934982948672427, -6.643002943452203, -33.47882410771861, -42.73051611370174, -13.830594015690766, -10.81907349539046, -31.32990388785292, -21.372000681101298, -20.72872538537377, -19.35913454567289, -45.36064911829685, -32.397201310081435, -17.84273722619286, -11.433064095255679, -39.68587477282896, -8.301616767155217, -19.438208246201746, -25.433078272584613, -11.897510033547178, -23.396382496215928, -52.65187085949701, -7.737001811492655, -4.738490833884459, -10.904905894862532, -38.947951123043, -46.044139281404, -30.18454137782855, -40.766167653769116, -34.75034763037793, -21.368380615794514, -10.450306901427034, -44.06827036307091, -3.987763432000672, -24.538256372231434, -28.532196014562018, -12.903365773243882, -15.807119206860929, -30.953889403343965, -38.46568369589294, -58.267335207669575, -35.24063598278907, -22.67892429792625, -34.626109200897154, -17.280917602790634, -37.37010355132658, -21.545309348805883, -24.012911822654676, -22.95417567108686, -9.322975987404016], "policy_predator_policy_reward": [11.364741796052009, 2.189826229972303, 20.262890803305105, 11.36775496428593, 27.502512714340035, -5.1655317332683275, 23.912637313632235, 15.675383203285325, 6.120804781625495, 39.27374544255493, 8.361215760345624, 4.405161200550133, 18.084692105299247, -18.342452371156753, 29.204551448765095, 9.026264850000182, 7.9861485344275085, 29.79392053189393, 26.665049360437724, 34.11013274551753, -3.6503871020945518, 10.066793321427078, 38.556308230313704, 19.357591075832886, 22.917595352100975, 28.885445444472335, -1.6351934537808415, 28.558055182932527, 10.616019610832588, 4.907435443072677, 4.251445469020256, 35.85424903396856, 15.098825454885617, 9.833977300238047, 23.018613032840125, 36.60514481633072, 5.898707098663619, 30.212308973547977, -0.03852266177169783, 3.3346801971029927, 19.744183778063952, 3.5767481897317253, 31.736520315158312, 13.726609910186433, 19.799797839987956, 5.990281791834997, 37.060221087729374, 42.56044608866132, 15.316161648515395, 41.72401602512593, 26.7608206075627, 13.934982948672427, 6.643002943452203, 33.47882410771861, 42.73051611370174, 13.830594015690766, 10.81907349539046, 31.32990388785292, 21.372000681101298, 20.72872538537377, 19.35913454567289, 45.36064911829685, 32.397201310081435, 17.84273722619286, 11.433064095255679, 39.68587477282896, 8.301616767155217, 19.438208246201746, 25.433078272584613, 11.897510033547178, 23.396382496215928, 52.65187085949701, 7.737001811492655, 4.738490833884459, 10.904905894862532, 38.947951123043, 46.044139281404, 30.18454137782855, 40.766167653769116, 34.75034763037793, 21.368380615794514, 10.450306901427034, 44.06827036307091, 3.987763432000672, 24.538256372231434, 28.532196014562018, 12.903365773243882, 15.807119206860929, 30.953889403343965, 38.46568369589294, 58.267335207669575, 35.24063598278907, 22.67892429792625, 34.626109200897154, 17.280917602790634, 37.37010355132658, 21.545309348805883, 24.012911822654676, 22.95417567108686, 9.322975987404016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31766997034722, "mean_inference_ms": 1.0576101931435116, "mean_action_processing_ms": 0.13512439456717068, "mean_env_wait_ms": 0.07978909359270686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004659414291381836, "StateBufferConnector_ms": 0.00214231014251709, "ViewRequirementAgentConnector_ms": 0.051500797271728516}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 720.7387466301054, "num_env_steps_trained_throughput_per_sec": 720.7387466301054, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 5320.412, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5320.375, "sample_time_ms": 709.576, "learn_time_ms": 4599.125, "learn_throughput": 869.731, "synch_weights_time_ms": 11.317}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 15, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-56-03", "timestamp": 1723395363, "time_this_iter_s": 5.554969072341919, "time_total_s": 82.2763500213623, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7874310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 82.2763500213623, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 39.7125, "ram_util_percent": 82.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8115227320697158, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9290116105539103, "policy_loss": -0.006699648954478713, "vf_loss": 0.9356209030219664, "vf_explained_var": -0.7563467862084507, "kl": 0.014457075736791846, "entropy": 1.303854733457168, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.10548672741279, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9603503026766702, "policy_loss": -0.008893810587566501, "vf_loss": 0.968771942332387, "vf_explained_var": -0.8484520306189854, "kl": 0.00472170844717821, "entropy": 1.496096353729566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -58.267335207669575, "predator_policy": -18.342452371156753}, "policy_reward_max": {"prey_policy": 18.342452371156753, "predator_policy": 58.267335207669575}, "policy_reward_mean": {"prey_policy": -21.91885877572328, "predator_policy": 21.91885877572328}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-39.27374544255493, -8.361215760345624, -4.405161200550133, -18.084692105299247, 18.342452371156753, -29.204551448765095, -9.026264850000182, -7.9861485344275085, -29.79392053189393, -26.665049360437724, -34.11013274551753, 3.6503871020945518, -10.066793321427078, -38.556308230313704, -19.357591075832886, -22.917595352100975, -28.885445444472335, 1.6351934537808415, -28.558055182932527, -10.616019610832588, -4.907435443072677, -4.251445469020256, -35.85424903396856, -15.098825454885617, -9.833977300238047, -23.018613032840125, -36.60514481633072, -5.898707098663619, -30.212308973547977, 0.03852266177169783, -3.3346801971029927, -19.744183778063952, -3.5767481897317253, -31.736520315158312, -13.726609910186433, -19.799797839987956, -5.990281791834997, -37.060221087729374, -42.56044608866132, -15.316161648515395, -41.72401602512593, -26.7608206075627, -13.934982948672427, -6.643002943452203, -33.47882410771861, -42.73051611370174, -13.830594015690766, -10.81907349539046, -31.32990388785292, -21.372000681101298, -20.72872538537377, -19.35913454567289, -45.36064911829685, -32.397201310081435, -17.84273722619286, -11.433064095255679, -39.68587477282896, -8.301616767155217, -19.438208246201746, -25.433078272584613, -11.897510033547178, -23.396382496215928, -52.65187085949701, -7.737001811492655, -4.738490833884459, -10.904905894862532, -38.947951123043, -46.044139281404, -30.18454137782855, -40.766167653769116, -34.75034763037793, -21.368380615794514, -10.450306901427034, -44.06827036307091, -3.987763432000672, -24.538256372231434, -28.532196014562018, -12.903365773243882, -15.807119206860929, -30.953889403343965, -38.46568369589294, -58.267335207669575, -35.24063598278907, -22.67892429792625, -34.626109200897154, -17.280917602790634, -37.37010355132658, -21.545309348805883, -24.012911822654676, -22.95417567108686, -9.322975987404016, -16.470583215979893, -37.60874939758933, -38.37611782981496, -20.91526153510061, -0.4033416039992437, -12.094170541535421, -44.72503417988379, -10.959355471527896, -10.606807704841735], "policy_predator_policy_reward": [39.27374544255493, 8.361215760345624, 4.405161200550133, 18.084692105299247, -18.342452371156753, 29.204551448765095, 9.026264850000182, 7.9861485344275085, 29.79392053189393, 26.665049360437724, 34.11013274551753, -3.6503871020945518, 10.066793321427078, 38.556308230313704, 19.357591075832886, 22.917595352100975, 28.885445444472335, -1.6351934537808415, 28.558055182932527, 10.616019610832588, 4.907435443072677, 4.251445469020256, 35.85424903396856, 15.098825454885617, 9.833977300238047, 23.018613032840125, 36.60514481633072, 5.898707098663619, 30.212308973547977, -0.03852266177169783, 3.3346801971029927, 19.744183778063952, 3.5767481897317253, 31.736520315158312, 13.726609910186433, 19.799797839987956, 5.990281791834997, 37.060221087729374, 42.56044608866132, 15.316161648515395, 41.72401602512593, 26.7608206075627, 13.934982948672427, 6.643002943452203, 33.47882410771861, 42.73051611370174, 13.830594015690766, 10.81907349539046, 31.32990388785292, 21.372000681101298, 20.72872538537377, 19.35913454567289, 45.36064911829685, 32.397201310081435, 17.84273722619286, 11.433064095255679, 39.68587477282896, 8.301616767155217, 19.438208246201746, 25.433078272584613, 11.897510033547178, 23.396382496215928, 52.65187085949701, 7.737001811492655, 4.738490833884459, 10.904905894862532, 38.947951123043, 46.044139281404, 30.18454137782855, 40.766167653769116, 34.75034763037793, 21.368380615794514, 10.450306901427034, 44.06827036307091, 3.987763432000672, 24.538256372231434, 28.532196014562018, 12.903365773243882, 15.807119206860929, 30.953889403343965, 38.46568369589294, 58.267335207669575, 35.24063598278907, 22.67892429792625, 34.626109200897154, 17.280917602790634, 37.37010355132658, 21.545309348805883, 24.012911822654676, 22.95417567108686, 9.322975987404016, 16.470583215979893, 37.60874939758933, 38.37611782981496, 20.91526153510061, 0.4033416039992437, 12.094170541535421, 44.72503417988379, 10.959355471527896, 10.606807704841735]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3139702770344765, "mean_inference_ms": 1.0438587475402132, "mean_action_processing_ms": 0.1341302213402578, "mean_env_wait_ms": 0.07810773163974595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043675899505615234, "StateBufferConnector_ms": 0.002135038375854492, "ViewRequirementAgentConnector_ms": 0.051178932189941406}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 765.158966718043, "num_env_steps_trained_throughput_per_sec": 765.158966718043, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 5306.729, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5306.691, "sample_time_ms": 706.653, "learn_time_ms": 4588.37, "learn_throughput": 871.769, "synch_weights_time_ms": 11.307}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 16, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-56-08", "timestamp": 1723395368, "time_this_iter_s": 5.257557153701782, "time_total_s": 87.53390717506409, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78744c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 87.53390717506409, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 37.1, "ram_util_percent": 82.68571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9385464654924969, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6670527547908326, "policy_loss": -0.0017715701008758817, "vf_loss": 0.668808230292052, "vf_explained_var": 0.5306162538627783, "kl": 0.0025753074128133293, "entropy": 1.3275589964042107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.208306642404447, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7027060738348762, "policy_loss": -0.013473631160498675, "vf_loss": 0.7155677571271857, "vf_explained_var": 0.5731239926690856, "kl": 0.0122389812585923, "entropy": 1.5319166850298642, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -60.645398070002486, "predator_policy": -3.6503871020945518}, "policy_reward_max": {"prey_policy": 3.6503871020945518, "predator_policy": 60.645398070002486}, "policy_reward_mean": {"prey_policy": -23.135334166698048, "predator_policy": 23.135334166698048}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-26.665049360437724, -34.11013274551753, 3.6503871020945518, -10.066793321427078, -38.556308230313704, -19.357591075832886, -22.917595352100975, -28.885445444472335, 1.6351934537808415, -28.558055182932527, -10.616019610832588, -4.907435443072677, -4.251445469020256, -35.85424903396856, -15.098825454885617, -9.833977300238047, -23.018613032840125, -36.60514481633072, -5.898707098663619, -30.212308973547977, 0.03852266177169783, -3.3346801971029927, -19.744183778063952, -3.5767481897317253, -31.736520315158312, -13.726609910186433, -19.799797839987956, -5.990281791834997, -37.060221087729374, -42.56044608866132, -15.316161648515395, -41.72401602512593, -26.7608206075627, -13.934982948672427, -6.643002943452203, -33.47882410771861, -42.73051611370174, -13.830594015690766, -10.81907349539046, -31.32990388785292, -21.372000681101298, -20.72872538537377, -19.35913454567289, -45.36064911829685, -32.397201310081435, -17.84273722619286, -11.433064095255679, -39.68587477282896, -8.301616767155217, -19.438208246201746, -25.433078272584613, -11.897510033547178, -23.396382496215928, -52.65187085949701, -7.737001811492655, -4.738490833884459, -10.904905894862532, -38.947951123043, -46.044139281404, -30.18454137782855, -40.766167653769116, -34.75034763037793, -21.368380615794514, -10.450306901427034, -44.06827036307091, -3.987763432000672, -24.538256372231434, -28.532196014562018, -12.903365773243882, -15.807119206860929, -30.953889403343965, -38.46568369589294, -58.267335207669575, -35.24063598278907, -22.67892429792625, -34.626109200897154, -17.280917602790634, -37.37010355132658, -21.545309348805883, -24.012911822654676, -22.95417567108686, -9.322975987404016, -16.470583215979893, -37.60874939758933, -38.37611782981496, -20.91526153510061, -0.4033416039992437, -12.094170541535421, -44.72503417988379, -10.959355471527896, -10.606807704841735, -44.74219448173387, -21.718342270490425, -60.645398070002486, -18.665612527325585, -8.49359219046609, -32.54475679370685, -33.15476936418574, -8.967783077533143, -20.508337824713063], "policy_predator_policy_reward": [26.665049360437724, 34.11013274551753, -3.6503871020945518, 10.066793321427078, 38.556308230313704, 19.357591075832886, 22.917595352100975, 28.885445444472335, -1.6351934537808415, 28.558055182932527, 10.616019610832588, 4.907435443072677, 4.251445469020256, 35.85424903396856, 15.098825454885617, 9.833977300238047, 23.018613032840125, 36.60514481633072, 5.898707098663619, 30.212308973547977, -0.03852266177169783, 3.3346801971029927, 19.744183778063952, 3.5767481897317253, 31.736520315158312, 13.726609910186433, 19.799797839987956, 5.990281791834997, 37.060221087729374, 42.56044608866132, 15.316161648515395, 41.72401602512593, 26.7608206075627, 13.934982948672427, 6.643002943452203, 33.47882410771861, 42.73051611370174, 13.830594015690766, 10.81907349539046, 31.32990388785292, 21.372000681101298, 20.72872538537377, 19.35913454567289, 45.36064911829685, 32.397201310081435, 17.84273722619286, 11.433064095255679, 39.68587477282896, 8.301616767155217, 19.438208246201746, 25.433078272584613, 11.897510033547178, 23.396382496215928, 52.65187085949701, 7.737001811492655, 4.738490833884459, 10.904905894862532, 38.947951123043, 46.044139281404, 30.18454137782855, 40.766167653769116, 34.75034763037793, 21.368380615794514, 10.450306901427034, 44.06827036307091, 3.987763432000672, 24.538256372231434, 28.532196014562018, 12.903365773243882, 15.807119206860929, 30.953889403343965, 38.46568369589294, 58.267335207669575, 35.24063598278907, 22.67892429792625, 34.626109200897154, 17.280917602790634, 37.37010355132658, 21.545309348805883, 24.012911822654676, 22.95417567108686, 9.322975987404016, 16.470583215979893, 37.60874939758933, 38.37611782981496, 20.91526153510061, 0.4033416039992437, 12.094170541535421, 44.72503417988379, 10.959355471527896, 10.606807704841735, 44.74219448173387, 21.718342270490425, 60.645398070002486, 18.665612527325585, 8.49359219046609, 32.54475679370685, 33.15476936418574, 8.967783077533143, 20.508337824713063]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3110669141774823, "mean_inference_ms": 1.034372587618515, "mean_action_processing_ms": 0.133234798601758, "mean_env_wait_ms": 0.0768717717113747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042209625244140625, "StateBufferConnector_ms": 0.0021511316299438477, "ViewRequirementAgentConnector_ms": 0.051810622215270996}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 803.3932380415329, "num_env_steps_trained_throughput_per_sec": 803.3932380415329, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 5246.372, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5246.335, "sample_time_ms": 695.56, "learn_time_ms": 4539.84, "learn_throughput": 881.088, "synch_weights_time_ms": 10.588}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 17, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-56-13", "timestamp": 1723395373, "time_this_iter_s": 4.98143196105957, "time_total_s": 92.51533913612366, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e08790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 92.51533913612366, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 35.128571428571426, "ram_util_percent": 83.05714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8070745198366542, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.21650727697609304, "policy_loss": -0.004794782754470361, "vf_loss": 0.22124602750409395, "vf_explained_var": 0.8399735918268562, "kl": 0.017930363945563094, "entropy": 1.3387050580233335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0552719459558526, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.26948898673908844, "policy_loss": -0.007112255719888102, "vf_loss": 0.276047218676346, "vf_explained_var": 0.7998514417558908, "kl": 0.011080434676897255, "entropy": 1.5392955659578245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -60.645398070002486, "predator_policy": -1.6351934537808415}, "policy_reward_max": {"prey_policy": 1.6351934537808415, "predator_policy": 60.645398070002486}, "policy_reward_mean": {"prey_policy": -23.090679227392137, "predator_policy": 23.090679227392137}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-38.556308230313704, -19.357591075832886, -22.917595352100975, -28.885445444472335, 1.6351934537808415, -28.558055182932527, -10.616019610832588, -4.907435443072677, -4.251445469020256, -35.85424903396856, -15.098825454885617, -9.833977300238047, -23.018613032840125, -36.60514481633072, -5.898707098663619, -30.212308973547977, 0.03852266177169783, -3.3346801971029927, -19.744183778063952, -3.5767481897317253, -31.736520315158312, -13.726609910186433, -19.799797839987956, -5.990281791834997, -37.060221087729374, -42.56044608866132, -15.316161648515395, -41.72401602512593, -26.7608206075627, -13.934982948672427, -6.643002943452203, -33.47882410771861, -42.73051611370174, -13.830594015690766, -10.81907349539046, -31.32990388785292, -21.372000681101298, -20.72872538537377, -19.35913454567289, -45.36064911829685, -32.397201310081435, -17.84273722619286, -11.433064095255679, -39.68587477282896, -8.301616767155217, -19.438208246201746, -25.433078272584613, -11.897510033547178, -23.396382496215928, -52.65187085949701, -7.737001811492655, -4.738490833884459, -10.904905894862532, -38.947951123043, -46.044139281404, -30.18454137782855, -40.766167653769116, -34.75034763037793, -21.368380615794514, -10.450306901427034, -44.06827036307091, -3.987763432000672, -24.538256372231434, -28.532196014562018, -12.903365773243882, -15.807119206860929, -30.953889403343965, -38.46568369589294, -58.267335207669575, -35.24063598278907, -22.67892429792625, -34.626109200897154, -17.280917602790634, -37.37010355132658, -21.545309348805883, -24.012911822654676, -22.95417567108686, -9.322975987404016, -16.470583215979893, -37.60874939758933, -38.37611782981496, -20.91526153510061, -0.4033416039992437, -12.094170541535421, -44.72503417988379, -10.959355471527896, -10.606807704841735, -44.74219448173387, -21.718342270490425, -60.645398070002486, -18.665612527325585, -8.49359219046609, -32.54475679370685, -33.15476936418574, -8.967783077533143, -20.508337824713063, -5.960104480035868, -27.08399880544844, -9.566986520322617, -20.115004588889217], "policy_predator_policy_reward": [38.556308230313704, 19.357591075832886, 22.917595352100975, 28.885445444472335, -1.6351934537808415, 28.558055182932527, 10.616019610832588, 4.907435443072677, 4.251445469020256, 35.85424903396856, 15.098825454885617, 9.833977300238047, 23.018613032840125, 36.60514481633072, 5.898707098663619, 30.212308973547977, -0.03852266177169783, 3.3346801971029927, 19.744183778063952, 3.5767481897317253, 31.736520315158312, 13.726609910186433, 19.799797839987956, 5.990281791834997, 37.060221087729374, 42.56044608866132, 15.316161648515395, 41.72401602512593, 26.7608206075627, 13.934982948672427, 6.643002943452203, 33.47882410771861, 42.73051611370174, 13.830594015690766, 10.81907349539046, 31.32990388785292, 21.372000681101298, 20.72872538537377, 19.35913454567289, 45.36064911829685, 32.397201310081435, 17.84273722619286, 11.433064095255679, 39.68587477282896, 8.301616767155217, 19.438208246201746, 25.433078272584613, 11.897510033547178, 23.396382496215928, 52.65187085949701, 7.737001811492655, 4.738490833884459, 10.904905894862532, 38.947951123043, 46.044139281404, 30.18454137782855, 40.766167653769116, 34.75034763037793, 21.368380615794514, 10.450306901427034, 44.06827036307091, 3.987763432000672, 24.538256372231434, 28.532196014562018, 12.903365773243882, 15.807119206860929, 30.953889403343965, 38.46568369589294, 58.267335207669575, 35.24063598278907, 22.67892429792625, 34.626109200897154, 17.280917602790634, 37.37010355132658, 21.545309348805883, 24.012911822654676, 22.95417567108686, 9.322975987404016, 16.470583215979893, 37.60874939758933, 38.37611782981496, 20.91526153510061, 0.4033416039992437, 12.094170541535421, 44.72503417988379, 10.959355471527896, 10.606807704841735, 44.74219448173387, 21.718342270490425, 60.645398070002486, 18.665612527325585, 8.49359219046609, 32.54475679370685, 33.15476936418574, 8.967783077533143, 20.508337824713063, 5.960104480035868, 27.08399880544844, 9.566986520322617, 20.115004588889217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.310121375641922, "mean_inference_ms": 1.0305843246897963, "mean_action_processing_ms": 0.13263033622122172, "mean_env_wait_ms": 0.07628433612922327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041533708572387695, "StateBufferConnector_ms": 0.0021528005599975586, "ViewRequirementAgentConnector_ms": 0.05192744731903076}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 739.8547994667399, "num_env_steps_trained_throughput_per_sec": 739.8547994667399, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 5274.482, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5274.445, "sample_time_ms": 698.621, "learn_time_ms": 4564.283, "learn_throughput": 876.37, "synch_weights_time_ms": 11.141}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 18, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-56-19", "timestamp": 1723395379, "time_this_iter_s": 5.413098096847534, "time_total_s": 97.92843723297119, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e088b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 97.92843723297119, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 31.762499999999996, "ram_util_percent": 82.88749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9984790852293373, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7559853923817476, "policy_loss": -0.004969325137305229, "vf_loss": 0.7609328389943888, "vf_explained_var": 0.34914621158192555, "kl": 0.007000723803560612, "entropy": 1.2635643833627304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3045050645867984, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7763328741823595, "policy_loss": -0.008660079502927449, "vf_loss": 0.7842818333301693, "vf_explained_var": 0.16981577333062886, "kl": 0.014222396737447884, "entropy": 1.5195910149564347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -60.645398070002486, "predator_policy": -0.03852266177169783}, "policy_reward_max": {"prey_policy": 0.03852266177169783, "predator_policy": 60.645398070002486}, "policy_reward_mean": {"prey_policy": -23.76023522925933, "predator_policy": 23.76023522925933}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-28.558055182932527, -10.616019610832588, -4.907435443072677, -4.251445469020256, -35.85424903396856, -15.098825454885617, -9.833977300238047, -23.018613032840125, -36.60514481633072, -5.898707098663619, -30.212308973547977, 0.03852266177169783, -3.3346801971029927, -19.744183778063952, -3.5767481897317253, -31.736520315158312, -13.726609910186433, -19.799797839987956, -5.990281791834997, -37.060221087729374, -42.56044608866132, -15.316161648515395, -41.72401602512593, -26.7608206075627, -13.934982948672427, -6.643002943452203, -33.47882410771861, -42.73051611370174, -13.830594015690766, -10.81907349539046, -31.32990388785292, -21.372000681101298, -20.72872538537377, -19.35913454567289, -45.36064911829685, -32.397201310081435, -17.84273722619286, -11.433064095255679, -39.68587477282896, -8.301616767155217, -19.438208246201746, -25.433078272584613, -11.897510033547178, -23.396382496215928, -52.65187085949701, -7.737001811492655, -4.738490833884459, -10.904905894862532, -38.947951123043, -46.044139281404, -30.18454137782855, -40.766167653769116, -34.75034763037793, -21.368380615794514, -10.450306901427034, -44.06827036307091, -3.987763432000672, -24.538256372231434, -28.532196014562018, -12.903365773243882, -15.807119206860929, -30.953889403343965, -38.46568369589294, -58.267335207669575, -35.24063598278907, -22.67892429792625, -34.626109200897154, -17.280917602790634, -37.37010355132658, -21.545309348805883, -24.012911822654676, -22.95417567108686, -9.322975987404016, -16.470583215979893, -37.60874939758933, -38.37611782981496, -20.91526153510061, -0.4033416039992437, -12.094170541535421, -44.72503417988379, -10.959355471527896, -10.606807704841735, -44.74219448173387, -21.718342270490425, -60.645398070002486, -18.665612527325585, -8.49359219046609, -32.54475679370685, -33.15476936418574, -8.967783077533143, -20.508337824713063, -5.960104480035868, -27.08399880544844, -9.566986520322617, -20.115004588889217, -27.14175195154278, -43.54108254662229, -38.66305659521164, -54.99878709818476, -10.692668644096505], "policy_predator_policy_reward": [28.558055182932527, 10.616019610832588, 4.907435443072677, 4.251445469020256, 35.85424903396856, 15.098825454885617, 9.833977300238047, 23.018613032840125, 36.60514481633072, 5.898707098663619, 30.212308973547977, -0.03852266177169783, 3.3346801971029927, 19.744183778063952, 3.5767481897317253, 31.736520315158312, 13.726609910186433, 19.799797839987956, 5.990281791834997, 37.060221087729374, 42.56044608866132, 15.316161648515395, 41.72401602512593, 26.7608206075627, 13.934982948672427, 6.643002943452203, 33.47882410771861, 42.73051611370174, 13.830594015690766, 10.81907349539046, 31.32990388785292, 21.372000681101298, 20.72872538537377, 19.35913454567289, 45.36064911829685, 32.397201310081435, 17.84273722619286, 11.433064095255679, 39.68587477282896, 8.301616767155217, 19.438208246201746, 25.433078272584613, 11.897510033547178, 23.396382496215928, 52.65187085949701, 7.737001811492655, 4.738490833884459, 10.904905894862532, 38.947951123043, 46.044139281404, 30.18454137782855, 40.766167653769116, 34.75034763037793, 21.368380615794514, 10.450306901427034, 44.06827036307091, 3.987763432000672, 24.538256372231434, 28.532196014562018, 12.903365773243882, 15.807119206860929, 30.953889403343965, 38.46568369589294, 58.267335207669575, 35.24063598278907, 22.67892429792625, 34.626109200897154, 17.280917602790634, 37.37010355132658, 21.545309348805883, 24.012911822654676, 22.95417567108686, 9.322975987404016, 16.470583215979893, 37.60874939758933, 38.37611782981496, 20.91526153510061, 0.4033416039992437, 12.094170541535421, 44.72503417988379, 10.959355471527896, 10.606807704841735, 44.74219448173387, 21.718342270490425, 60.645398070002486, 18.665612527325585, 8.49359219046609, 32.54475679370685, 33.15476936418574, 8.967783077533143, 20.508337824713063, 5.960104480035868, 27.08399880544844, 9.566986520322617, 20.115004588889217, 27.14175195154278, 43.54108254662229, 38.66305659521164, 54.99878709818476, 10.692668644096505]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3084275467608597, "mean_inference_ms": 1.026043340203663, "mean_action_processing_ms": 0.13248658259872195, "mean_env_wait_ms": 0.07586608311469377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004036903381347656, "StateBufferConnector_ms": 0.0021195411682128906, "ViewRequirementAgentConnector_ms": 0.05216872692108154}, "num_episodes": 5, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 715.139670388667, "num_env_steps_trained_throughput_per_sec": 715.139670388667, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 5282.196, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5282.159, "sample_time_ms": 700.149, "learn_time_ms": 4570.183, "learn_throughput": 875.239, "synch_weights_time_ms": 11.429}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 19, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-56-24", "timestamp": 1723395384, "time_this_iter_s": 5.598384141921997, "time_total_s": 103.52682137489319, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e08e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 103.52682137489319, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 29.575, "ram_util_percent": 82.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9938276697260638, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8006231600418687, "policy_loss": 0.00011059526829437042, "vf_loss": 0.8004997012050201, "vf_explained_var": 0.003950399595002333, "kl": 0.00411697061273106, "entropy": 1.255752241735657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.298710507247597, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.890231260494329, "policy_loss": -0.009107889384904411, "vf_loss": 0.8987540409589807, "vf_explained_var": -0.09492660139997801, "kl": 0.011702231926608698, "entropy": 1.512254118050138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -60.645398070002486, "predator_policy": -0.03852266177169783}, "policy_reward_max": {"prey_policy": 0.03852266177169783, "predator_policy": 60.645398070002486}, "policy_reward_mean": {"prey_policy": -24.513458154736064, "predator_policy": 24.513458154736064}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-5.898707098663619, -30.212308973547977, 0.03852266177169783, -3.3346801971029927, -19.744183778063952, -3.5767481897317253, -31.736520315158312, -13.726609910186433, -19.799797839987956, -5.990281791834997, -37.060221087729374, -42.56044608866132, -15.316161648515395, -41.72401602512593, -26.7608206075627, -13.934982948672427, -6.643002943452203, -33.47882410771861, -42.73051611370174, -13.830594015690766, -10.81907349539046, -31.32990388785292, -21.372000681101298, -20.72872538537377, -19.35913454567289, -45.36064911829685, -32.397201310081435, -17.84273722619286, -11.433064095255679, -39.68587477282896, -8.301616767155217, -19.438208246201746, -25.433078272584613, -11.897510033547178, -23.396382496215928, -52.65187085949701, -7.737001811492655, -4.738490833884459, -10.904905894862532, -38.947951123043, -46.044139281404, -30.18454137782855, -40.766167653769116, -34.75034763037793, -21.368380615794514, -10.450306901427034, -44.06827036307091, -3.987763432000672, -24.538256372231434, -28.532196014562018, -12.903365773243882, -15.807119206860929, -30.953889403343965, -38.46568369589294, -58.267335207669575, -35.24063598278907, -22.67892429792625, -34.626109200897154, -17.280917602790634, -37.37010355132658, -21.545309348805883, -24.012911822654676, -22.95417567108686, -9.322975987404016, -16.470583215979893, -37.60874939758933, -38.37611782981496, -20.91526153510061, -0.4033416039992437, -12.094170541535421, -44.72503417988379, -10.959355471527896, -10.606807704841735, -44.74219448173387, -21.718342270490425, -60.645398070002486, -18.665612527325585, -8.49359219046609, -32.54475679370685, -33.15476936418574, -8.967783077533143, -20.508337824713063, -5.960104480035868, -27.08399880544844, -9.566986520322617, -20.115004588889217, -27.14175195154278, -43.54108254662229, -38.66305659521164, -54.99878709818476, -10.692668644096505, -21.00024485779777, -43.41833646742541, -37.5912752431027, -24.339938155987255, -22.041753490053676, -36.674802012996196, -14.950749617513106, -25.815023612746007, -18.23393443417357], "policy_predator_policy_reward": [5.898707098663619, 30.212308973547977, -0.03852266177169783, 3.3346801971029927, 19.744183778063952, 3.5767481897317253, 31.736520315158312, 13.726609910186433, 19.799797839987956, 5.990281791834997, 37.060221087729374, 42.56044608866132, 15.316161648515395, 41.72401602512593, 26.7608206075627, 13.934982948672427, 6.643002943452203, 33.47882410771861, 42.73051611370174, 13.830594015690766, 10.81907349539046, 31.32990388785292, 21.372000681101298, 20.72872538537377, 19.35913454567289, 45.36064911829685, 32.397201310081435, 17.84273722619286, 11.433064095255679, 39.68587477282896, 8.301616767155217, 19.438208246201746, 25.433078272584613, 11.897510033547178, 23.396382496215928, 52.65187085949701, 7.737001811492655, 4.738490833884459, 10.904905894862532, 38.947951123043, 46.044139281404, 30.18454137782855, 40.766167653769116, 34.75034763037793, 21.368380615794514, 10.450306901427034, 44.06827036307091, 3.987763432000672, 24.538256372231434, 28.532196014562018, 12.903365773243882, 15.807119206860929, 30.953889403343965, 38.46568369589294, 58.267335207669575, 35.24063598278907, 22.67892429792625, 34.626109200897154, 17.280917602790634, 37.37010355132658, 21.545309348805883, 24.012911822654676, 22.95417567108686, 9.322975987404016, 16.470583215979893, 37.60874939758933, 38.37611782981496, 20.91526153510061, 0.4033416039992437, 12.094170541535421, 44.72503417988379, 10.959355471527896, 10.606807704841735, 44.74219448173387, 21.718342270490425, 60.645398070002486, 18.665612527325585, 8.49359219046609, 32.54475679370685, 33.15476936418574, 8.967783077533143, 20.508337824713063, 5.960104480035868, 27.08399880544844, 9.566986520322617, 20.115004588889217, 27.14175195154278, 43.54108254662229, 38.66305659521164, 54.99878709818476, 10.692668644096505, 21.00024485779777, 43.41833646742541, 37.5912752431027, 24.339938155987255, 22.041753490053676, 36.674802012996196, 14.950749617513106, 25.815023612746007, 18.23393443417357]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30614698433816534, "mean_inference_ms": 1.0185500043822187, "mean_action_processing_ms": 0.13191273633303754, "mean_env_wait_ms": 0.0750983034171141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038629770278930664, "StateBufferConnector_ms": 0.0021589994430541992, "ViewRequirementAgentConnector_ms": 0.053349971771240234}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 677.2904258800817, "num_env_steps_trained_throughput_per_sec": 677.2904258800817, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 5343.09, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5343.051, "sample_time_ms": 706.937, "learn_time_ms": 4623.661, "learn_throughput": 865.115, "synch_weights_time_ms": 12.046}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 20, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-56-30", "timestamp": 1723395390, "time_this_iter_s": 5.912136077880859, "time_total_s": 109.43895745277405, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e08700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 109.43895745277405, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 33.211111111111116, "ram_util_percent": 82.25555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8323153828425954, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.47968208018379904, "policy_loss": -0.0008852931964308179, "vf_loss": 0.48055973068500557, "vf_explained_var": -0.4602423344428341, "kl": 0.00489034878833387, "entropy": 1.2794604094078144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.127241022543361, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5597100836059933, "policy_loss": -0.006340734091160509, "vf_loss": 0.5656153247846911, "vf_explained_var": -0.44222837829341494, "kl": 0.008709881344382083, "entropy": 1.4993845279018083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -60.645398070002486, "predator_policy": 0.4033416039992437}, "policy_reward_max": {"prey_policy": -0.4033416039992437, "predator_policy": 60.645398070002486}, "policy_reward_mean": {"prey_policy": -25.681371397467597, "predator_policy": 25.681371397467597}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-5.990281791834997, -37.060221087729374, -42.56044608866132, -15.316161648515395, -41.72401602512593, -26.7608206075627, -13.934982948672427, -6.643002943452203, -33.47882410771861, -42.73051611370174, -13.830594015690766, -10.81907349539046, -31.32990388785292, -21.372000681101298, -20.72872538537377, -19.35913454567289, -45.36064911829685, -32.397201310081435, -17.84273722619286, -11.433064095255679, -39.68587477282896, -8.301616767155217, -19.438208246201746, -25.433078272584613, -11.897510033547178, -23.396382496215928, -52.65187085949701, -7.737001811492655, -4.738490833884459, -10.904905894862532, -38.947951123043, -46.044139281404, -30.18454137782855, -40.766167653769116, -34.75034763037793, -21.368380615794514, -10.450306901427034, -44.06827036307091, -3.987763432000672, -24.538256372231434, -28.532196014562018, -12.903365773243882, -15.807119206860929, -30.953889403343965, -38.46568369589294, -58.267335207669575, -35.24063598278907, -22.67892429792625, -34.626109200897154, -17.280917602790634, -37.37010355132658, -21.545309348805883, -24.012911822654676, -22.95417567108686, -9.322975987404016, -16.470583215979893, -37.60874939758933, -38.37611782981496, -20.91526153510061, -0.4033416039992437, -12.094170541535421, -44.72503417988379, -10.959355471527896, -10.606807704841735, -44.74219448173387, -21.718342270490425, -60.645398070002486, -18.665612527325585, -8.49359219046609, -32.54475679370685, -33.15476936418574, -8.967783077533143, -20.508337824713063, -5.960104480035868, -27.08399880544844, -9.566986520322617, -20.115004588889217, -27.14175195154278, -43.54108254662229, -38.66305659521164, -54.99878709818476, -10.692668644096505, -21.00024485779777, -43.41833646742541, -37.5912752431027, -24.339938155987255, -22.041753490053676, -36.674802012996196, -14.950749617513106, -25.815023612746007, -18.23393443417357, -19.368061404377624, -17.53864986260159, -35.12044353678397, -17.335261802387826, -15.160357954734916, -41.9220617456762, -23.144387236605017, -36.17500322636069, -39.01813114429602], "policy_predator_policy_reward": [5.990281791834997, 37.060221087729374, 42.56044608866132, 15.316161648515395, 41.72401602512593, 26.7608206075627, 13.934982948672427, 6.643002943452203, 33.47882410771861, 42.73051611370174, 13.830594015690766, 10.81907349539046, 31.32990388785292, 21.372000681101298, 20.72872538537377, 19.35913454567289, 45.36064911829685, 32.397201310081435, 17.84273722619286, 11.433064095255679, 39.68587477282896, 8.301616767155217, 19.438208246201746, 25.433078272584613, 11.897510033547178, 23.396382496215928, 52.65187085949701, 7.737001811492655, 4.738490833884459, 10.904905894862532, 38.947951123043, 46.044139281404, 30.18454137782855, 40.766167653769116, 34.75034763037793, 21.368380615794514, 10.450306901427034, 44.06827036307091, 3.987763432000672, 24.538256372231434, 28.532196014562018, 12.903365773243882, 15.807119206860929, 30.953889403343965, 38.46568369589294, 58.267335207669575, 35.24063598278907, 22.67892429792625, 34.626109200897154, 17.280917602790634, 37.37010355132658, 21.545309348805883, 24.012911822654676, 22.95417567108686, 9.322975987404016, 16.470583215979893, 37.60874939758933, 38.37611782981496, 20.91526153510061, 0.4033416039992437, 12.094170541535421, 44.72503417988379, 10.959355471527896, 10.606807704841735, 44.74219448173387, 21.718342270490425, 60.645398070002486, 18.665612527325585, 8.49359219046609, 32.54475679370685, 33.15476936418574, 8.967783077533143, 20.508337824713063, 5.960104480035868, 27.08399880544844, 9.566986520322617, 20.115004588889217, 27.14175195154278, 43.54108254662229, 38.66305659521164, 54.99878709818476, 10.692668644096505, 21.00024485779777, 43.41833646742541, 37.5912752431027, 24.339938155987255, 22.041753490053676, 36.674802012996196, 14.950749617513106, 25.815023612746007, 18.23393443417357, 19.368061404377624, 17.53864986260159, 35.12044353678397, 17.335261802387826, 15.160357954734916, 41.9220617456762, 23.144387236605017, 36.17500322636069, 39.01813114429602]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3043802798561164, "mean_inference_ms": 1.0124798980383194, "mean_action_processing_ms": 0.1314853821735572, "mean_env_wait_ms": 0.0745195245155195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00372159481048584, "StateBufferConnector_ms": 0.0021920204162597656, "ViewRequirementAgentConnector_ms": 0.053415656089782715}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 712.4345209467151, "num_env_steps_trained_throughput_per_sec": 712.4345209467151, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 5393.708, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5393.665, "sample_time_ms": 708.294, "learn_time_ms": 4672.783, "learn_throughput": 856.021, "synch_weights_time_ms": 12.137}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 21, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-56-36", "timestamp": 1723395396, "time_this_iter_s": 5.619208097457886, "time_total_s": 115.05816555023193, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e08dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 115.05816555023193, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 28.674999999999997, "ram_util_percent": 82.72500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7328533412733426, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7477072974356512, "policy_loss": -0.0017591533333567591, "vf_loss": 0.7494627733831294, "vf_explained_var": -0.30401721876114607, "kl": 0.004705197352984427, "entropy": 1.238714533423384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1556065281232197, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7837969836817744, "policy_loss": -0.014396119622688275, "vf_loss": 0.7975521373562515, "vf_explained_var": -0.25540451873093845, "kl": 0.0128192675492333, "entropy": 1.4976632338017226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -60.645398070002486, "predator_policy": 0.4033416039992437}, "policy_reward_max": {"prey_policy": -0.4033416039992437, "predator_policy": 60.645398070002486}, "policy_reward_mean": {"prey_policy": -24.828134599719295, "predator_policy": 24.828134599719295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-42.73051611370174, -13.830594015690766, -10.81907349539046, -31.32990388785292, -21.372000681101298, -20.72872538537377, -19.35913454567289, -45.36064911829685, -32.397201310081435, -17.84273722619286, -11.433064095255679, -39.68587477282896, -8.301616767155217, -19.438208246201746, -25.433078272584613, -11.897510033547178, -23.396382496215928, -52.65187085949701, -7.737001811492655, -4.738490833884459, -10.904905894862532, -38.947951123043, -46.044139281404, -30.18454137782855, -40.766167653769116, -34.75034763037793, -21.368380615794514, -10.450306901427034, -44.06827036307091, -3.987763432000672, -24.538256372231434, -28.532196014562018, -12.903365773243882, -15.807119206860929, -30.953889403343965, -38.46568369589294, -58.267335207669575, -35.24063598278907, -22.67892429792625, -34.626109200897154, -17.280917602790634, -37.37010355132658, -21.545309348805883, -24.012911822654676, -22.95417567108686, -9.322975987404016, -16.470583215979893, -37.60874939758933, -38.37611782981496, -20.91526153510061, -0.4033416039992437, -12.094170541535421, -44.72503417988379, -10.959355471527896, -10.606807704841735, -44.74219448173387, -21.718342270490425, -60.645398070002486, -18.665612527325585, -8.49359219046609, -32.54475679370685, -33.15476936418574, -8.967783077533143, -20.508337824713063, -5.960104480035868, -27.08399880544844, -9.566986520322617, -20.115004588889217, -27.14175195154278, -43.54108254662229, -38.66305659521164, -54.99878709818476, -10.692668644096505, -21.00024485779777, -43.41833646742541, -37.5912752431027, -24.339938155987255, -22.041753490053676, -36.674802012996196, -14.950749617513106, -25.815023612746007, -18.23393443417357, -19.368061404377624, -17.53864986260159, -35.12044353678397, -17.335261802387826, -15.160357954734916, -41.9220617456762, -23.144387236605017, -36.17500322636069, -39.01813114429602, -6.684246642595413, -1.928457564001391, -28.08226120942424, -7.016616888768239, -4.475499480692717, -23.285757323492692, -18.29113866751083, -26.883257270877174, -21.49784242708046], "policy_predator_policy_reward": [42.73051611370174, 13.830594015690766, 10.81907349539046, 31.32990388785292, 21.372000681101298, 20.72872538537377, 19.35913454567289, 45.36064911829685, 32.397201310081435, 17.84273722619286, 11.433064095255679, 39.68587477282896, 8.301616767155217, 19.438208246201746, 25.433078272584613, 11.897510033547178, 23.396382496215928, 52.65187085949701, 7.737001811492655, 4.738490833884459, 10.904905894862532, 38.947951123043, 46.044139281404, 30.18454137782855, 40.766167653769116, 34.75034763037793, 21.368380615794514, 10.450306901427034, 44.06827036307091, 3.987763432000672, 24.538256372231434, 28.532196014562018, 12.903365773243882, 15.807119206860929, 30.953889403343965, 38.46568369589294, 58.267335207669575, 35.24063598278907, 22.67892429792625, 34.626109200897154, 17.280917602790634, 37.37010355132658, 21.545309348805883, 24.012911822654676, 22.95417567108686, 9.322975987404016, 16.470583215979893, 37.60874939758933, 38.37611782981496, 20.91526153510061, 0.4033416039992437, 12.094170541535421, 44.72503417988379, 10.959355471527896, 10.606807704841735, 44.74219448173387, 21.718342270490425, 60.645398070002486, 18.665612527325585, 8.49359219046609, 32.54475679370685, 33.15476936418574, 8.967783077533143, 20.508337824713063, 5.960104480035868, 27.08399880544844, 9.566986520322617, 20.115004588889217, 27.14175195154278, 43.54108254662229, 38.66305659521164, 54.99878709818476, 10.692668644096505, 21.00024485779777, 43.41833646742541, 37.5912752431027, 24.339938155987255, 22.041753490053676, 36.674802012996196, 14.950749617513106, 25.815023612746007, 18.23393443417357, 19.368061404377624, 17.53864986260159, 35.12044353678397, 17.335261802387826, 15.160357954734916, 41.9220617456762, 23.144387236605017, 36.17500322636069, 39.01813114429602, 6.684246642595413, 1.928457564001391, 28.08226120942424, 7.016616888768239, 4.475499480692717, 23.285757323492692, 18.29113866751083, 26.883257270877174, 21.49784242708046]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30344505382994647, "mean_inference_ms": 1.0085966604949015, "mean_action_processing_ms": 0.13123286504637516, "mean_env_wait_ms": 0.0741333418249629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035305023193359375, "StateBufferConnector_ms": 0.0022284984588623047, "ViewRequirementAgentConnector_ms": 0.054703593254089355}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 720.6484094158072, "num_env_steps_trained_throughput_per_sec": 720.6484094158072, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 5443.647, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5443.604, "sample_time_ms": 707.397, "learn_time_ms": 4723.567, "learn_throughput": 846.818, "synch_weights_time_ms": 12.158}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 22, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-56-41", "timestamp": 1723395401, "time_this_iter_s": 5.555718898773193, "time_total_s": 120.61388444900513, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e08670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 120.61388444900513, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 30.228571428571424, "ram_util_percent": 82.77142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8040664870136728, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4808567713480443, "policy_loss": -0.0030102238262770696, "vf_loss": 0.48386389821146925, "vf_explained_var": 0.10189883330216011, "kl": 0.007929432067715026, "entropy": 1.2045870743691922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0589927850912015, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.517403628853693, "policy_loss": -0.013287360959899767, "vf_loss": 0.5303565571860721, "vf_explained_var": 0.09956522528082132, "kl": 0.006688670285202849, "entropy": 1.49138559649388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -60.645398070002486, "predator_policy": 0.4033416039992437}, "policy_reward_max": {"prey_policy": -0.4033416039992437, "predator_policy": 60.645398070002486}, "policy_reward_mean": {"prey_policy": -24.764797204296087, "predator_policy": 24.764797204296087}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-17.84273722619286, -11.433064095255679, -39.68587477282896, -8.301616767155217, -19.438208246201746, -25.433078272584613, -11.897510033547178, -23.396382496215928, -52.65187085949701, -7.737001811492655, -4.738490833884459, -10.904905894862532, -38.947951123043, -46.044139281404, -30.18454137782855, -40.766167653769116, -34.75034763037793, -21.368380615794514, -10.450306901427034, -44.06827036307091, -3.987763432000672, -24.538256372231434, -28.532196014562018, -12.903365773243882, -15.807119206860929, -30.953889403343965, -38.46568369589294, -58.267335207669575, -35.24063598278907, -22.67892429792625, -34.626109200897154, -17.280917602790634, -37.37010355132658, -21.545309348805883, -24.012911822654676, -22.95417567108686, -9.322975987404016, -16.470583215979893, -37.60874939758933, -38.37611782981496, -20.91526153510061, -0.4033416039992437, -12.094170541535421, -44.72503417988379, -10.959355471527896, -10.606807704841735, -44.74219448173387, -21.718342270490425, -60.645398070002486, -18.665612527325585, -8.49359219046609, -32.54475679370685, -33.15476936418574, -8.967783077533143, -20.508337824713063, -5.960104480035868, -27.08399880544844, -9.566986520322617, -20.115004588889217, -27.14175195154278, -43.54108254662229, -38.66305659521164, -54.99878709818476, -10.692668644096505, -21.00024485779777, -43.41833646742541, -37.5912752431027, -24.339938155987255, -22.041753490053676, -36.674802012996196, -14.950749617513106, -25.815023612746007, -18.23393443417357, -19.368061404377624, -17.53864986260159, -35.12044353678397, -17.335261802387826, -15.160357954734916, -41.9220617456762, -23.144387236605017, -36.17500322636069, -39.01813114429602, -6.684246642595413, -1.928457564001391, -28.08226120942424, -7.016616888768239, -4.475499480692717, -23.285757323492692, -18.29113866751083, -26.883257270877174, -21.49784242708046, -44.46990529189621, -17.28490263358701, -32.754993740058026, -35.58863264164731, -7.788228508526122, -14.235104888068648, -17.343951454515764, -18.28737446171094, -43.84096539083154], "policy_predator_policy_reward": [17.84273722619286, 11.433064095255679, 39.68587477282896, 8.301616767155217, 19.438208246201746, 25.433078272584613, 11.897510033547178, 23.396382496215928, 52.65187085949701, 7.737001811492655, 4.738490833884459, 10.904905894862532, 38.947951123043, 46.044139281404, 30.18454137782855, 40.766167653769116, 34.75034763037793, 21.368380615794514, 10.450306901427034, 44.06827036307091, 3.987763432000672, 24.538256372231434, 28.532196014562018, 12.903365773243882, 15.807119206860929, 30.953889403343965, 38.46568369589294, 58.267335207669575, 35.24063598278907, 22.67892429792625, 34.626109200897154, 17.280917602790634, 37.37010355132658, 21.545309348805883, 24.012911822654676, 22.95417567108686, 9.322975987404016, 16.470583215979893, 37.60874939758933, 38.37611782981496, 20.91526153510061, 0.4033416039992437, 12.094170541535421, 44.72503417988379, 10.959355471527896, 10.606807704841735, 44.74219448173387, 21.718342270490425, 60.645398070002486, 18.665612527325585, 8.49359219046609, 32.54475679370685, 33.15476936418574, 8.967783077533143, 20.508337824713063, 5.960104480035868, 27.08399880544844, 9.566986520322617, 20.115004588889217, 27.14175195154278, 43.54108254662229, 38.66305659521164, 54.99878709818476, 10.692668644096505, 21.00024485779777, 43.41833646742541, 37.5912752431027, 24.339938155987255, 22.041753490053676, 36.674802012996196, 14.950749617513106, 25.815023612746007, 18.23393443417357, 19.368061404377624, 17.53864986260159, 35.12044353678397, 17.335261802387826, 15.160357954734916, 41.9220617456762, 23.144387236605017, 36.17500322636069, 39.01813114429602, 6.684246642595413, 1.928457564001391, 28.08226120942424, 7.016616888768239, 4.475499480692717, 23.285757323492692, 18.29113866751083, 26.883257270877174, 21.49784242708046, 44.46990529189621, 17.28490263358701, 32.754993740058026, 35.58863264164731, 7.788228508526122, 14.235104888068648, 17.343951454515764, 18.28737446171094, 43.84096539083154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30286877630529285, "mean_inference_ms": 1.005764194635071, "mean_action_processing_ms": 0.1310833238314081, "mean_env_wait_ms": 0.0738623343236229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002973794937133789, "StateBufferConnector_ms": 0.002214193344116211, "ViewRequirementAgentConnector_ms": 0.05496084690093994}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 723.0749836386835, "num_env_steps_trained_throughput_per_sec": 723.0749836386835, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 5488.54, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5488.498, "sample_time_ms": 703.159, "learn_time_ms": 4772.316, "learn_throughput": 838.167, "synch_weights_time_ms": 12.544}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 23, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-56-47", "timestamp": 1723395407, "time_this_iter_s": 5.5384299755096436, "time_total_s": 126.15231442451477, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e08700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 126.15231442451477, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 30.625, "ram_util_percent": 83.26249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7792635222120832, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5751150887769957, "policy_loss": -0.005382964668873076, "vf_loss": 0.5804965848568827, "vf_explained_var": -0.037487433602412544, "kl": 0.0037615548236035177, "entropy": 1.199728880201777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9830079509721448, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5730849139023727, "policy_loss": -0.018935194413158267, "vf_loss": 0.5914427544067924, "vf_explained_var": -0.1457800683254997, "kl": 0.01154709348070391, "entropy": 1.5388369124382735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -60.645398070002486, "predator_policy": 0.4033416039992437}, "policy_reward_max": {"prey_policy": -0.4033416039992437, "predator_policy": 60.645398070002486}, "policy_reward_mean": {"prey_policy": -24.55490035365251, "predator_policy": 24.55490035365251}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-7.737001811492655, -4.738490833884459, -10.904905894862532, -38.947951123043, -46.044139281404, -30.18454137782855, -40.766167653769116, -34.75034763037793, -21.368380615794514, -10.450306901427034, -44.06827036307091, -3.987763432000672, -24.538256372231434, -28.532196014562018, -12.903365773243882, -15.807119206860929, -30.953889403343965, -38.46568369589294, -58.267335207669575, -35.24063598278907, -22.67892429792625, -34.626109200897154, -17.280917602790634, -37.37010355132658, -21.545309348805883, -24.012911822654676, -22.95417567108686, -9.322975987404016, -16.470583215979893, -37.60874939758933, -38.37611782981496, -20.91526153510061, -0.4033416039992437, -12.094170541535421, -44.72503417988379, -10.959355471527896, -10.606807704841735, -44.74219448173387, -21.718342270490425, -60.645398070002486, -18.665612527325585, -8.49359219046609, -32.54475679370685, -33.15476936418574, -8.967783077533143, -20.508337824713063, -5.960104480035868, -27.08399880544844, -9.566986520322617, -20.115004588889217, -27.14175195154278, -43.54108254662229, -38.66305659521164, -54.99878709818476, -10.692668644096505, -21.00024485779777, -43.41833646742541, -37.5912752431027, -24.339938155987255, -22.041753490053676, -36.674802012996196, -14.950749617513106, -25.815023612746007, -18.23393443417357, -19.368061404377624, -17.53864986260159, -35.12044353678397, -17.335261802387826, -15.160357954734916, -41.9220617456762, -23.144387236605017, -36.17500322636069, -39.01813114429602, -6.684246642595413, -1.928457564001391, -28.08226120942424, -7.016616888768239, -4.475499480692717, -23.285757323492692, -18.29113866751083, -26.883257270877174, -21.49784242708046, -44.46990529189621, -17.28490263358701, -32.754993740058026, -35.58863264164731, -7.788228508526122, -14.235104888068648, -17.343951454515764, -18.28737446171094, -43.84096539083154, -38.078408948258485, -37.88739782703303, -21.9041974306249, -5.432822144009261, -3.019725125563655, -13.978464211495552, -14.814990261288568, -39.96185059059267, -14.012801166255688], "policy_predator_policy_reward": [7.737001811492655, 4.738490833884459, 10.904905894862532, 38.947951123043, 46.044139281404, 30.18454137782855, 40.766167653769116, 34.75034763037793, 21.368380615794514, 10.450306901427034, 44.06827036307091, 3.987763432000672, 24.538256372231434, 28.532196014562018, 12.903365773243882, 15.807119206860929, 30.953889403343965, 38.46568369589294, 58.267335207669575, 35.24063598278907, 22.67892429792625, 34.626109200897154, 17.280917602790634, 37.37010355132658, 21.545309348805883, 24.012911822654676, 22.95417567108686, 9.322975987404016, 16.470583215979893, 37.60874939758933, 38.37611782981496, 20.91526153510061, 0.4033416039992437, 12.094170541535421, 44.72503417988379, 10.959355471527896, 10.606807704841735, 44.74219448173387, 21.718342270490425, 60.645398070002486, 18.665612527325585, 8.49359219046609, 32.54475679370685, 33.15476936418574, 8.967783077533143, 20.508337824713063, 5.960104480035868, 27.08399880544844, 9.566986520322617, 20.115004588889217, 27.14175195154278, 43.54108254662229, 38.66305659521164, 54.99878709818476, 10.692668644096505, 21.00024485779777, 43.41833646742541, 37.5912752431027, 24.339938155987255, 22.041753490053676, 36.674802012996196, 14.950749617513106, 25.815023612746007, 18.23393443417357, 19.368061404377624, 17.53864986260159, 35.12044353678397, 17.335261802387826, 15.160357954734916, 41.9220617456762, 23.144387236605017, 36.17500322636069, 39.01813114429602, 6.684246642595413, 1.928457564001391, 28.08226120942424, 7.016616888768239, 4.475499480692717, 23.285757323492692, 18.29113866751083, 26.883257270877174, 21.49784242708046, 44.46990529189621, 17.28490263358701, 32.754993740058026, 35.58863264164731, 7.788228508526122, 14.235104888068648, 17.343951454515764, 18.28737446171094, 43.84096539083154, 38.078408948258485, 37.88739782703303, 21.9041974306249, 5.432822144009261, 3.019725125563655, 13.978464211495552, 14.814990261288568, 39.96185059059267, 14.012801166255688]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30229087384236825, "mean_inference_ms": 1.0025860818242824, "mean_action_processing_ms": 0.1308665377465497, "mean_env_wait_ms": 0.07358558807059647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026837587356567383, "StateBufferConnector_ms": 0.002148747444152832, "ViewRequirementAgentConnector_ms": 0.053557753562927246}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 736.9291957951344, "num_env_steps_trained_throughput_per_sec": 736.9291957951344, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 5478.714, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5478.674, "sample_time_ms": 693.977, "learn_time_ms": 4771.633, "learn_throughput": 838.287, "synch_weights_time_ms": 12.595}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 24, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-56-52", "timestamp": 1723395412, "time_this_iter_s": 5.431653738021851, "time_total_s": 131.58396816253662, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78870d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 131.58396816253662, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 29.412499999999998, "ram_util_percent": 83.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8459121854665379, "cur_kl_coeff": 0.00019531250000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7688359695176283, "policy_loss": -0.0031325615505920722, "vf_loss": 0.7719678919374322, "vf_explained_var": 0.08828559493025144, "kl": 0.0032614850150148238, "entropy": 1.1382943008095026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.145293878391385, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7655620284805384, "policy_loss": -0.014960710134861681, "vf_loss": 0.7801572954903047, "vf_explained_var": 0.10186596860488256, "kl": 0.007308836526154992, "entropy": 1.552317414432764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -60.645398070002486, "predator_policy": 0.4033416039992437}, "policy_reward_max": {"prey_policy": -0.4033416039992437, "predator_policy": 60.645398070002486}, "policy_reward_mean": {"prey_policy": -24.168647621470512, "predator_policy": 24.168647621470512}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-10.450306901427034, -44.06827036307091, -3.987763432000672, -24.538256372231434, -28.532196014562018, -12.903365773243882, -15.807119206860929, -30.953889403343965, -38.46568369589294, -58.267335207669575, -35.24063598278907, -22.67892429792625, -34.626109200897154, -17.280917602790634, -37.37010355132658, -21.545309348805883, -24.012911822654676, -22.95417567108686, -9.322975987404016, -16.470583215979893, -37.60874939758933, -38.37611782981496, -20.91526153510061, -0.4033416039992437, -12.094170541535421, -44.72503417988379, -10.959355471527896, -10.606807704841735, -44.74219448173387, -21.718342270490425, -60.645398070002486, -18.665612527325585, -8.49359219046609, -32.54475679370685, -33.15476936418574, -8.967783077533143, -20.508337824713063, -5.960104480035868, -27.08399880544844, -9.566986520322617, -20.115004588889217, -27.14175195154278, -43.54108254662229, -38.66305659521164, -54.99878709818476, -10.692668644096505, -21.00024485779777, -43.41833646742541, -37.5912752431027, -24.339938155987255, -22.041753490053676, -36.674802012996196, -14.950749617513106, -25.815023612746007, -18.23393443417357, -19.368061404377624, -17.53864986260159, -35.12044353678397, -17.335261802387826, -15.160357954734916, -41.9220617456762, -23.144387236605017, -36.17500322636069, -39.01813114429602, -6.684246642595413, -1.928457564001391, -28.08226120942424, -7.016616888768239, -4.475499480692717, -23.285757323492692, -18.29113866751083, -26.883257270877174, -21.49784242708046, -44.46990529189621, -17.28490263358701, -32.754993740058026, -35.58863264164731, -7.788228508526122, -14.235104888068648, -17.343951454515764, -18.28737446171094, -43.84096539083154, -38.078408948258485, -37.88739782703303, -21.9041974306249, -5.432822144009261, -3.019725125563655, -13.978464211495552, -14.814990261288568, -39.96185059059267, -14.012801166255688, -20.965362164464125, -41.43066219219249, -7.2533987724157045, -19.44962589742956, -19.202429381094184, -18.411074696397584, -35.84873494242311, -9.442226757073826, -24.813138200765565], "policy_predator_policy_reward": [10.450306901427034, 44.06827036307091, 3.987763432000672, 24.538256372231434, 28.532196014562018, 12.903365773243882, 15.807119206860929, 30.953889403343965, 38.46568369589294, 58.267335207669575, 35.24063598278907, 22.67892429792625, 34.626109200897154, 17.280917602790634, 37.37010355132658, 21.545309348805883, 24.012911822654676, 22.95417567108686, 9.322975987404016, 16.470583215979893, 37.60874939758933, 38.37611782981496, 20.91526153510061, 0.4033416039992437, 12.094170541535421, 44.72503417988379, 10.959355471527896, 10.606807704841735, 44.74219448173387, 21.718342270490425, 60.645398070002486, 18.665612527325585, 8.49359219046609, 32.54475679370685, 33.15476936418574, 8.967783077533143, 20.508337824713063, 5.960104480035868, 27.08399880544844, 9.566986520322617, 20.115004588889217, 27.14175195154278, 43.54108254662229, 38.66305659521164, 54.99878709818476, 10.692668644096505, 21.00024485779777, 43.41833646742541, 37.5912752431027, 24.339938155987255, 22.041753490053676, 36.674802012996196, 14.950749617513106, 25.815023612746007, 18.23393443417357, 19.368061404377624, 17.53864986260159, 35.12044353678397, 17.335261802387826, 15.160357954734916, 41.9220617456762, 23.144387236605017, 36.17500322636069, 39.01813114429602, 6.684246642595413, 1.928457564001391, 28.08226120942424, 7.016616888768239, 4.475499480692717, 23.285757323492692, 18.29113866751083, 26.883257270877174, 21.49784242708046, 44.46990529189621, 17.28490263358701, 32.754993740058026, 35.58863264164731, 7.788228508526122, 14.235104888068648, 17.343951454515764, 18.28737446171094, 43.84096539083154, 38.078408948258485, 37.88739782703303, 21.9041974306249, 5.432822144009261, 3.019725125563655, 13.978464211495552, 14.814990261288568, 39.96185059059267, 14.012801166255688, 20.965362164464125, 41.43066219219249, 7.2533987724157045, 19.44962589742956, 19.202429381094184, 18.411074696397584, 35.84873494242311, 9.442226757073826, 24.813138200765565]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30189483623214225, "mean_inference_ms": 0.9998291535799081, "mean_action_processing_ms": 0.13067987929396585, "mean_env_wait_ms": 0.07337128175389125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002711176872253418, "StateBufferConnector_ms": 0.002131819725036621, "ViewRequirementAgentConnector_ms": 0.056107521057128906}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 692.7242756289509, "num_env_steps_trained_throughput_per_sec": 692.7242756289509, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 5501.159, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5501.118, "sample_time_ms": 662.631, "learn_time_ms": 4825.07, "learn_throughput": 829.004, "synch_weights_time_ms": 12.952}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 25, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-56-58", "timestamp": 1723395418, "time_this_iter_s": 5.779391288757324, "time_total_s": 137.36335945129395, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e08670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 137.36335945129395, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 33.0375, "ram_util_percent": 83.2875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7681795204058289, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6247159676626325, "policy_loss": -0.0021111691816865156, "vf_loss": 0.6268266325428461, "vf_explained_var": -0.14381570058564344, "kl": 0.005172772057857675, "entropy": 1.1437256519993146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.127577446664994, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6362468942359556, "policy_loss": -0.014005704548617359, "vf_loss": 0.6499324653840934, "vf_explained_var": -0.05253847477336725, "kl": 0.0064026870018515725, "entropy": 1.5391772668808699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -60.645398070002486, "predator_policy": 0.4033416039992437}, "policy_reward_max": {"prey_policy": -0.4033416039992437, "predator_policy": 60.645398070002486}, "policy_reward_mean": {"prey_policy": -24.605642861051383, "predator_policy": 24.605642861051383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-58.267335207669575, -35.24063598278907, -22.67892429792625, -34.626109200897154, -17.280917602790634, -37.37010355132658, -21.545309348805883, -24.012911822654676, -22.95417567108686, -9.322975987404016, -16.470583215979893, -37.60874939758933, -38.37611782981496, -20.91526153510061, -0.4033416039992437, -12.094170541535421, -44.72503417988379, -10.959355471527896, -10.606807704841735, -44.74219448173387, -21.718342270490425, -60.645398070002486, -18.665612527325585, -8.49359219046609, -32.54475679370685, -33.15476936418574, -8.967783077533143, -20.508337824713063, -5.960104480035868, -27.08399880544844, -9.566986520322617, -20.115004588889217, -27.14175195154278, -43.54108254662229, -38.66305659521164, -54.99878709818476, -10.692668644096505, -21.00024485779777, -43.41833646742541, -37.5912752431027, -24.339938155987255, -22.041753490053676, -36.674802012996196, -14.950749617513106, -25.815023612746007, -18.23393443417357, -19.368061404377624, -17.53864986260159, -35.12044353678397, -17.335261802387826, -15.160357954734916, -41.9220617456762, -23.144387236605017, -36.17500322636069, -39.01813114429602, -6.684246642595413, -1.928457564001391, -28.08226120942424, -7.016616888768239, -4.475499480692717, -23.285757323492692, -18.29113866751083, -26.883257270877174, -21.49784242708046, -44.46990529189621, -17.28490263358701, -32.754993740058026, -35.58863264164731, -7.788228508526122, -14.235104888068648, -17.343951454515764, -18.28737446171094, -43.84096539083154, -38.078408948258485, -37.88739782703303, -21.9041974306249, -5.432822144009261, -3.019725125563655, -13.978464211495552, -14.814990261288568, -39.96185059059267, -14.012801166255688, -20.965362164464125, -41.43066219219249, -7.2533987724157045, -19.44962589742956, -19.202429381094184, -18.411074696397584, -35.84873494242311, -9.442226757073826, -24.813138200765565, -35.24887225792476, -30.8583902807604, -38.7497673345061, -13.957738983610172, -34.553376166906666, -29.013083154120835, -18.258565395798055, -15.607235518820584, -37.15934602827356], "policy_predator_policy_reward": [58.267335207669575, 35.24063598278907, 22.67892429792625, 34.626109200897154, 17.280917602790634, 37.37010355132658, 21.545309348805883, 24.012911822654676, 22.95417567108686, 9.322975987404016, 16.470583215979893, 37.60874939758933, 38.37611782981496, 20.91526153510061, 0.4033416039992437, 12.094170541535421, 44.72503417988379, 10.959355471527896, 10.606807704841735, 44.74219448173387, 21.718342270490425, 60.645398070002486, 18.665612527325585, 8.49359219046609, 32.54475679370685, 33.15476936418574, 8.967783077533143, 20.508337824713063, 5.960104480035868, 27.08399880544844, 9.566986520322617, 20.115004588889217, 27.14175195154278, 43.54108254662229, 38.66305659521164, 54.99878709818476, 10.692668644096505, 21.00024485779777, 43.41833646742541, 37.5912752431027, 24.339938155987255, 22.041753490053676, 36.674802012996196, 14.950749617513106, 25.815023612746007, 18.23393443417357, 19.368061404377624, 17.53864986260159, 35.12044353678397, 17.335261802387826, 15.160357954734916, 41.9220617456762, 23.144387236605017, 36.17500322636069, 39.01813114429602, 6.684246642595413, 1.928457564001391, 28.08226120942424, 7.016616888768239, 4.475499480692717, 23.285757323492692, 18.29113866751083, 26.883257270877174, 21.49784242708046, 44.46990529189621, 17.28490263358701, 32.754993740058026, 35.58863264164731, 7.788228508526122, 14.235104888068648, 17.343951454515764, 18.28737446171094, 43.84096539083154, 38.078408948258485, 37.88739782703303, 21.9041974306249, 5.432822144009261, 3.019725125563655, 13.978464211495552, 14.814990261288568, 39.96185059059267, 14.012801166255688, 20.965362164464125, 41.43066219219249, 7.2533987724157045, 19.44962589742956, 19.202429381094184, 18.411074696397584, 35.84873494242311, 9.442226757073826, 24.813138200765565, 35.24887225792476, 30.8583902807604, 38.7497673345061, 13.957738983610172, 34.553376166906666, 29.013083154120835, 18.258565395798055, 15.607235518820584, 37.15934602827356]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3014874153301221, "mean_inference_ms": 0.9971393883741176, "mean_action_processing_ms": 0.13049722757121138, "mean_env_wait_ms": 0.0731705032338322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028798580169677734, "StateBufferConnector_ms": 0.002133488655090332, "ViewRequirementAgentConnector_ms": 0.052726030349731445}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 721.1576957328836, "num_env_steps_trained_throughput_per_sec": 721.1576957328836, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 5533.055, "restore_workers_time_ms": 0.016, "training_step_time_ms": 5533.016, "sample_time_ms": 661.862, "learn_time_ms": 4857.277, "learn_throughput": 823.507, "synch_weights_time_ms": 13.382}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 26, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-57-04", "timestamp": 1723395424, "time_this_iter_s": 5.55158805847168, "time_total_s": 142.91494750976562, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78e15e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 142.91494750976562, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 29.337500000000002, "ram_util_percent": 82.8375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6329650859348476, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1291827669813756, "policy_loss": -0.0016801838518100945, "vf_loss": 0.1308621094096452, "vf_explained_var": 0.8143288264671962, "kl": 0.008614868232540577, "entropy": 1.2046440289666256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8368004693572099, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1237459452180019, "policy_loss": -0.007133196092521151, "vf_loss": 0.13066561185211564, "vf_explained_var": 0.8275222941612204, "kl": 0.004270586100376687, "entropy": 1.5573419036964575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -60.645398070002486, "predator_policy": 0.4033416039992437}, "policy_reward_max": {"prey_policy": -0.4033416039992437, "predator_policy": 60.645398070002486}, "policy_reward_mean": {"prey_policy": -24.362272778482282, "predator_policy": 24.362272778482282}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-17.280917602790634, -37.37010355132658, -21.545309348805883, -24.012911822654676, -22.95417567108686, -9.322975987404016, -16.470583215979893, -37.60874939758933, -38.37611782981496, -20.91526153510061, -0.4033416039992437, -12.094170541535421, -44.72503417988379, -10.959355471527896, -10.606807704841735, -44.74219448173387, -21.718342270490425, -60.645398070002486, -18.665612527325585, -8.49359219046609, -32.54475679370685, -33.15476936418574, -8.967783077533143, -20.508337824713063, -5.960104480035868, -27.08399880544844, -9.566986520322617, -20.115004588889217, -27.14175195154278, -43.54108254662229, -38.66305659521164, -54.99878709818476, -10.692668644096505, -21.00024485779777, -43.41833646742541, -37.5912752431027, -24.339938155987255, -22.041753490053676, -36.674802012996196, -14.950749617513106, -25.815023612746007, -18.23393443417357, -19.368061404377624, -17.53864986260159, -35.12044353678397, -17.335261802387826, -15.160357954734916, -41.9220617456762, -23.144387236605017, -36.17500322636069, -39.01813114429602, -6.684246642595413, -1.928457564001391, -28.08226120942424, -7.016616888768239, -4.475499480692717, -23.285757323492692, -18.29113866751083, -26.883257270877174, -21.49784242708046, -44.46990529189621, -17.28490263358701, -32.754993740058026, -35.58863264164731, -7.788228508526122, -14.235104888068648, -17.343951454515764, -18.28737446171094, -43.84096539083154, -38.078408948258485, -37.88739782703303, -21.9041974306249, -5.432822144009261, -3.019725125563655, -13.978464211495552, -14.814990261288568, -39.96185059059267, -14.012801166255688, -20.965362164464125, -41.43066219219249, -7.2533987724157045, -19.44962589742956, -19.202429381094184, -18.411074696397584, -35.84873494242311, -9.442226757073826, -24.813138200765565, -35.24887225792476, -30.8583902807604, -38.7497673345061, -13.957738983610172, -34.553376166906666, -29.013083154120835, -18.258565395798055, -15.607235518820584, -37.15934602827356, -18.98581567327794, -37.78778088885852, -34.59281758749602, -35.109582282739495], "policy_predator_policy_reward": [17.280917602790634, 37.37010355132658, 21.545309348805883, 24.012911822654676, 22.95417567108686, 9.322975987404016, 16.470583215979893, 37.60874939758933, 38.37611782981496, 20.91526153510061, 0.4033416039992437, 12.094170541535421, 44.72503417988379, 10.959355471527896, 10.606807704841735, 44.74219448173387, 21.718342270490425, 60.645398070002486, 18.665612527325585, 8.49359219046609, 32.54475679370685, 33.15476936418574, 8.967783077533143, 20.508337824713063, 5.960104480035868, 27.08399880544844, 9.566986520322617, 20.115004588889217, 27.14175195154278, 43.54108254662229, 38.66305659521164, 54.99878709818476, 10.692668644096505, 21.00024485779777, 43.41833646742541, 37.5912752431027, 24.339938155987255, 22.041753490053676, 36.674802012996196, 14.950749617513106, 25.815023612746007, 18.23393443417357, 19.368061404377624, 17.53864986260159, 35.12044353678397, 17.335261802387826, 15.160357954734916, 41.9220617456762, 23.144387236605017, 36.17500322636069, 39.01813114429602, 6.684246642595413, 1.928457564001391, 28.08226120942424, 7.016616888768239, 4.475499480692717, 23.285757323492692, 18.29113866751083, 26.883257270877174, 21.49784242708046, 44.46990529189621, 17.28490263358701, 32.754993740058026, 35.58863264164731, 7.788228508526122, 14.235104888068648, 17.343951454515764, 18.28737446171094, 43.84096539083154, 38.078408948258485, 37.88739782703303, 21.9041974306249, 5.432822144009261, 3.019725125563655, 13.978464211495552, 14.814990261288568, 39.96185059059267, 14.012801166255688, 20.965362164464125, 41.43066219219249, 7.2533987724157045, 19.44962589742956, 19.202429381094184, 18.411074696397584, 35.84873494242311, 9.442226757073826, 24.813138200765565, 35.24887225792476, 30.8583902807604, 38.7497673345061, 13.957738983610172, 34.553376166906666, 29.013083154120835, 18.258565395798055, 15.607235518820584, 37.15934602827356, 18.98581567327794, 37.78778088885852, 34.59281758749602, 35.109582282739495]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.301068923803339, "mean_inference_ms": 0.9952268786072076, "mean_action_processing_ms": 0.13020803855417934, "mean_env_wait_ms": 0.07295809631558002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002875089645385742, "StateBufferConnector_ms": 0.0021337270736694336, "ViewRequirementAgentConnector_ms": 0.05264592170715332}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 745.1143167495829, "num_env_steps_trained_throughput_per_sec": 745.1143167495829, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 5571.996, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5571.958, "sample_time_ms": 663.257, "learn_time_ms": 4894.538, "learn_throughput": 817.238, "synch_weights_time_ms": 13.665}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 27, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-57-09", "timestamp": 1723395429, "time_this_iter_s": 5.373251914978027, "time_total_s": 148.28819942474365, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78870d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 148.28819942474365, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 30.6625, "ram_util_percent": 82.82499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7089612113001446, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5217911495982359, "policy_loss": -0.0045487742565455845, "vf_loss": 0.5263392548503665, "vf_explained_var": -0.266664234486719, "kl": 0.006845820556851263, "entropy": 1.1095528740435838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0379776500475904, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5027780676848731, "policy_loss": -0.01911191864249607, "vf_loss": 0.5216715219585846, "vf_explained_var": -0.1493944584702452, "kl": 0.00873855671377175, "entropy": 1.551431107148528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -60.645398070002486, "predator_policy": 0.4033416039992437}, "policy_reward_max": {"prey_policy": -0.4033416039992437, "predator_policy": 60.645398070002486}, "policy_reward_mean": {"prey_policy": -24.632502117777253, "predator_policy": 24.632502117777253}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-9.322975987404016, -16.470583215979893, -37.60874939758933, -38.37611782981496, -20.91526153510061, -0.4033416039992437, -12.094170541535421, -44.72503417988379, -10.959355471527896, -10.606807704841735, -44.74219448173387, -21.718342270490425, -60.645398070002486, -18.665612527325585, -8.49359219046609, -32.54475679370685, -33.15476936418574, -8.967783077533143, -20.508337824713063, -5.960104480035868, -27.08399880544844, -9.566986520322617, -20.115004588889217, -27.14175195154278, -43.54108254662229, -38.66305659521164, -54.99878709818476, -10.692668644096505, -21.00024485779777, -43.41833646742541, -37.5912752431027, -24.339938155987255, -22.041753490053676, -36.674802012996196, -14.950749617513106, -25.815023612746007, -18.23393443417357, -19.368061404377624, -17.53864986260159, -35.12044353678397, -17.335261802387826, -15.160357954734916, -41.9220617456762, -23.144387236605017, -36.17500322636069, -39.01813114429602, -6.684246642595413, -1.928457564001391, -28.08226120942424, -7.016616888768239, -4.475499480692717, -23.285757323492692, -18.29113866751083, -26.883257270877174, -21.49784242708046, -44.46990529189621, -17.28490263358701, -32.754993740058026, -35.58863264164731, -7.788228508526122, -14.235104888068648, -17.343951454515764, -18.28737446171094, -43.84096539083154, -38.078408948258485, -37.88739782703303, -21.9041974306249, -5.432822144009261, -3.019725125563655, -13.978464211495552, -14.814990261288568, -39.96185059059267, -14.012801166255688, -20.965362164464125, -41.43066219219249, -7.2533987724157045, -19.44962589742956, -19.202429381094184, -18.411074696397584, -35.84873494242311, -9.442226757073826, -24.813138200765565, -35.24887225792476, -30.8583902807604, -38.7497673345061, -13.957738983610172, -34.553376166906666, -29.013083154120835, -18.258565395798055, -15.607235518820584, -37.15934602827356, -18.98581567327794, -37.78778088885852, -34.59281758749602, -35.109582282739495, -26.62814241629311, -38.74517377938086, -22.663075984386065, -42.32411817426178, -19.825841571840144], "policy_predator_policy_reward": [9.322975987404016, 16.470583215979893, 37.60874939758933, 38.37611782981496, 20.91526153510061, 0.4033416039992437, 12.094170541535421, 44.72503417988379, 10.959355471527896, 10.606807704841735, 44.74219448173387, 21.718342270490425, 60.645398070002486, 18.665612527325585, 8.49359219046609, 32.54475679370685, 33.15476936418574, 8.967783077533143, 20.508337824713063, 5.960104480035868, 27.08399880544844, 9.566986520322617, 20.115004588889217, 27.14175195154278, 43.54108254662229, 38.66305659521164, 54.99878709818476, 10.692668644096505, 21.00024485779777, 43.41833646742541, 37.5912752431027, 24.339938155987255, 22.041753490053676, 36.674802012996196, 14.950749617513106, 25.815023612746007, 18.23393443417357, 19.368061404377624, 17.53864986260159, 35.12044353678397, 17.335261802387826, 15.160357954734916, 41.9220617456762, 23.144387236605017, 36.17500322636069, 39.01813114429602, 6.684246642595413, 1.928457564001391, 28.08226120942424, 7.016616888768239, 4.475499480692717, 23.285757323492692, 18.29113866751083, 26.883257270877174, 21.49784242708046, 44.46990529189621, 17.28490263358701, 32.754993740058026, 35.58863264164731, 7.788228508526122, 14.235104888068648, 17.343951454515764, 18.28737446171094, 43.84096539083154, 38.078408948258485, 37.88739782703303, 21.9041974306249, 5.432822144009261, 3.019725125563655, 13.978464211495552, 14.814990261288568, 39.96185059059267, 14.012801166255688, 20.965362164464125, 41.43066219219249, 7.2533987724157045, 19.44962589742956, 19.202429381094184, 18.411074696397584, 35.84873494242311, 9.442226757073826, 24.813138200765565, 35.24887225792476, 30.8583902807604, 38.7497673345061, 13.957738983610172, 34.553376166906666, 29.013083154120835, 18.258565395798055, 15.607235518820584, 37.15934602827356, 18.98581567327794, 37.78778088885852, 34.59281758749602, 35.109582282739495, 26.62814241629311, 38.74517377938086, 22.663075984386065, 42.32411817426178, 19.825841571840144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3004676131416484, "mean_inference_ms": 0.9927490020583913, "mean_action_processing_ms": 0.13008853498147313, "mean_env_wait_ms": 0.07279778523854162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028710365295410156, "StateBufferConnector_ms": 0.002124190330505371, "ViewRequirementAgentConnector_ms": 0.0525285005569458}, "num_episodes": 5, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 702.6576131367012, "num_env_steps_trained_throughput_per_sec": 702.6576131367012, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 5600.617, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5600.58, "sample_time_ms": 664.928, "learn_time_ms": 4921.803, "learn_throughput": 812.71, "synch_weights_time_ms": 13.405}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 28, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-57-15", "timestamp": 1723395435, "time_this_iter_s": 5.697609901428223, "time_total_s": 153.98580932617188, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7854310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 153.98580932617188, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 30.2875, "ram_util_percent": 82.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6293074540328234, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5163775467779488, "policy_loss": -0.001471642209313965, "vf_loss": 0.5178489763328495, "vf_explained_var": -0.7278557089467843, "kl": 0.002152606603945084, "entropy": 1.101557095721364, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.003511820686981, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5118262282235567, "policy_loss": -0.012248520026817762, "vf_loss": 0.523825796499538, "vf_explained_var": -0.7006498550996184, "kl": 0.009958045869794263, "entropy": 1.5094860376169283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -60.645398070002486, "predator_policy": 1.928457564001391}, "policy_reward_max": {"prey_policy": -1.928457564001391, "predator_policy": 60.645398070002486}, "policy_reward_mean": {"prey_policy": -25.140630073647632, "predator_policy": 25.140630073647632}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-10.606807704841735, -44.74219448173387, -21.718342270490425, -60.645398070002486, -18.665612527325585, -8.49359219046609, -32.54475679370685, -33.15476936418574, -8.967783077533143, -20.508337824713063, -5.960104480035868, -27.08399880544844, -9.566986520322617, -20.115004588889217, -27.14175195154278, -43.54108254662229, -38.66305659521164, -54.99878709818476, -10.692668644096505, -21.00024485779777, -43.41833646742541, -37.5912752431027, -24.339938155987255, -22.041753490053676, -36.674802012996196, -14.950749617513106, -25.815023612746007, -18.23393443417357, -19.368061404377624, -17.53864986260159, -35.12044353678397, -17.335261802387826, -15.160357954734916, -41.9220617456762, -23.144387236605017, -36.17500322636069, -39.01813114429602, -6.684246642595413, -1.928457564001391, -28.08226120942424, -7.016616888768239, -4.475499480692717, -23.285757323492692, -18.29113866751083, -26.883257270877174, -21.49784242708046, -44.46990529189621, -17.28490263358701, -32.754993740058026, -35.58863264164731, -7.788228508526122, -14.235104888068648, -17.343951454515764, -18.28737446171094, -43.84096539083154, -38.078408948258485, -37.88739782703303, -21.9041974306249, -5.432822144009261, -3.019725125563655, -13.978464211495552, -14.814990261288568, -39.96185059059267, -14.012801166255688, -20.965362164464125, -41.43066219219249, -7.2533987724157045, -19.44962589742956, -19.202429381094184, -18.411074696397584, -35.84873494242311, -9.442226757073826, -24.813138200765565, -35.24887225792476, -30.8583902807604, -38.7497673345061, -13.957738983610172, -34.553376166906666, -29.013083154120835, -18.258565395798055, -15.607235518820584, -37.15934602827356, -18.98581567327794, -37.78778088885852, -34.59281758749602, -35.109582282739495, -26.62814241629311, -38.74517377938086, -22.663075984386065, -42.32411817426178, -19.825841571840144, -48.437374639415964, -9.845926768262672, -24.890071714821147, -28.722923862918428, -37.65764555171175, -33.73384279437583, -22.89504890162881, -17.25066345709139, -18.25488765964672], "policy_predator_policy_reward": [10.606807704841735, 44.74219448173387, 21.718342270490425, 60.645398070002486, 18.665612527325585, 8.49359219046609, 32.54475679370685, 33.15476936418574, 8.967783077533143, 20.508337824713063, 5.960104480035868, 27.08399880544844, 9.566986520322617, 20.115004588889217, 27.14175195154278, 43.54108254662229, 38.66305659521164, 54.99878709818476, 10.692668644096505, 21.00024485779777, 43.41833646742541, 37.5912752431027, 24.339938155987255, 22.041753490053676, 36.674802012996196, 14.950749617513106, 25.815023612746007, 18.23393443417357, 19.368061404377624, 17.53864986260159, 35.12044353678397, 17.335261802387826, 15.160357954734916, 41.9220617456762, 23.144387236605017, 36.17500322636069, 39.01813114429602, 6.684246642595413, 1.928457564001391, 28.08226120942424, 7.016616888768239, 4.475499480692717, 23.285757323492692, 18.29113866751083, 26.883257270877174, 21.49784242708046, 44.46990529189621, 17.28490263358701, 32.754993740058026, 35.58863264164731, 7.788228508526122, 14.235104888068648, 17.343951454515764, 18.28737446171094, 43.84096539083154, 38.078408948258485, 37.88739782703303, 21.9041974306249, 5.432822144009261, 3.019725125563655, 13.978464211495552, 14.814990261288568, 39.96185059059267, 14.012801166255688, 20.965362164464125, 41.43066219219249, 7.2533987724157045, 19.44962589742956, 19.202429381094184, 18.411074696397584, 35.84873494242311, 9.442226757073826, 24.813138200765565, 35.24887225792476, 30.8583902807604, 38.7497673345061, 13.957738983610172, 34.553376166906666, 29.013083154120835, 18.258565395798055, 15.607235518820584, 37.15934602827356, 18.98581567327794, 37.78778088885852, 34.59281758749602, 35.109582282739495, 26.62814241629311, 38.74517377938086, 22.663075984386065, 42.32411817426178, 19.825841571840144, 48.437374639415964, 9.845926768262672, 24.890071714821147, 28.722923862918428, 37.65764555171175, 33.73384279437583, 22.89504890162881, 17.25066345709139, 18.25488765964672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29938506994035985, "mean_inference_ms": 0.9882445622048671, "mean_action_processing_ms": 0.12966344050562076, "mean_env_wait_ms": 0.07240689277719381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028876066207885742, "StateBufferConnector_ms": 0.0021355152130126953, "ViewRequirementAgentConnector_ms": 0.05277872085571289}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 736.8964720124595, "num_env_steps_trained_throughput_per_sec": 736.8964720124595, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 5584.103, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5584.065, "sample_time_ms": 664.372, "learn_time_ms": 4905.785, "learn_throughput": 815.364, "synch_weights_time_ms": 13.425}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "training_iteration": 29, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-57-20", "timestamp": 1723395440, "time_this_iter_s": 5.432735919952393, "time_total_s": 159.41854524612427, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78e15e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 159.41854524612427, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 26.575, "ram_util_percent": 81.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6256211190018803, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4022867006715387, "policy_loss": -0.0006606693139474373, "vf_loss": 0.4029472250355563, "vf_explained_var": 0.382300807038943, "kl": 0.0029995033706220224, "entropy": 1.1035305879389246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9722740275319666, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3810804947523138, "policy_loss": -0.017739034034699824, "vf_loss": 0.39863205074410263, "vf_explained_var": 0.42291771452873944, "kl": 0.007499232561048958, "entropy": 1.5197531968355178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -54.99878709818476, "predator_policy": 1.928457564001391}, "policy_reward_max": {"prey_policy": -1.928457564001391, "predator_policy": 54.99878709818476}, "policy_reward_mean": {"prey_policy": -25.126556663930863, "predator_policy": 25.126556663930863}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-20.508337824713063, -5.960104480035868, -27.08399880544844, -9.566986520322617, -20.115004588889217, -27.14175195154278, -43.54108254662229, -38.66305659521164, -54.99878709818476, -10.692668644096505, -21.00024485779777, -43.41833646742541, -37.5912752431027, -24.339938155987255, -22.041753490053676, -36.674802012996196, -14.950749617513106, -25.815023612746007, -18.23393443417357, -19.368061404377624, -17.53864986260159, -35.12044353678397, -17.335261802387826, -15.160357954734916, -41.9220617456762, -23.144387236605017, -36.17500322636069, -39.01813114429602, -6.684246642595413, -1.928457564001391, -28.08226120942424, -7.016616888768239, -4.475499480692717, -23.285757323492692, -18.29113866751083, -26.883257270877174, -21.49784242708046, -44.46990529189621, -17.28490263358701, -32.754993740058026, -35.58863264164731, -7.788228508526122, -14.235104888068648, -17.343951454515764, -18.28737446171094, -43.84096539083154, -38.078408948258485, -37.88739782703303, -21.9041974306249, -5.432822144009261, -3.019725125563655, -13.978464211495552, -14.814990261288568, -39.96185059059267, -14.012801166255688, -20.965362164464125, -41.43066219219249, -7.2533987724157045, -19.44962589742956, -19.202429381094184, -18.411074696397584, -35.84873494242311, -9.442226757073826, -24.813138200765565, -35.24887225792476, -30.8583902807604, -38.7497673345061, -13.957738983610172, -34.553376166906666, -29.013083154120835, -18.258565395798055, -15.607235518820584, -37.15934602827356, -18.98581567327794, -37.78778088885852, -34.59281758749602, -35.109582282739495, -26.62814241629311, -38.74517377938086, -22.663075984386065, -42.32411817426178, -19.825841571840144, -48.437374639415964, -9.845926768262672, -24.890071714821147, -28.722923862918428, -37.65764555171175, -33.73384279437583, -22.89504890162881, -17.25066345709139, -18.25488765964672, -21.71911012907175, -33.43664677081347, -36.57133042596932, -18.224881126468986, -43.98227640968142, -31.296373766709223, -11.622962017735679, -22.59399240126301, -18.68434246089647], "policy_predator_policy_reward": [20.508337824713063, 5.960104480035868, 27.08399880544844, 9.566986520322617, 20.115004588889217, 27.14175195154278, 43.54108254662229, 38.66305659521164, 54.99878709818476, 10.692668644096505, 21.00024485779777, 43.41833646742541, 37.5912752431027, 24.339938155987255, 22.041753490053676, 36.674802012996196, 14.950749617513106, 25.815023612746007, 18.23393443417357, 19.368061404377624, 17.53864986260159, 35.12044353678397, 17.335261802387826, 15.160357954734916, 41.9220617456762, 23.144387236605017, 36.17500322636069, 39.01813114429602, 6.684246642595413, 1.928457564001391, 28.08226120942424, 7.016616888768239, 4.475499480692717, 23.285757323492692, 18.29113866751083, 26.883257270877174, 21.49784242708046, 44.46990529189621, 17.28490263358701, 32.754993740058026, 35.58863264164731, 7.788228508526122, 14.235104888068648, 17.343951454515764, 18.28737446171094, 43.84096539083154, 38.078408948258485, 37.88739782703303, 21.9041974306249, 5.432822144009261, 3.019725125563655, 13.978464211495552, 14.814990261288568, 39.96185059059267, 14.012801166255688, 20.965362164464125, 41.43066219219249, 7.2533987724157045, 19.44962589742956, 19.202429381094184, 18.411074696397584, 35.84873494242311, 9.442226757073826, 24.813138200765565, 35.24887225792476, 30.8583902807604, 38.7497673345061, 13.957738983610172, 34.553376166906666, 29.013083154120835, 18.258565395798055, 15.607235518820584, 37.15934602827356, 18.98581567327794, 37.78778088885852, 34.59281758749602, 35.109582282739495, 26.62814241629311, 38.74517377938086, 22.663075984386065, 42.32411817426178, 19.825841571840144, 48.437374639415964, 9.845926768262672, 24.890071714821147, 28.722923862918428, 37.65764555171175, 33.73384279437583, 22.89504890162881, 17.25066345709139, 18.25488765964672, 21.71911012907175, 33.43664677081347, 36.57133042596932, 18.224881126468986, 43.98227640968142, 31.296373766709223, 11.622962017735679, 22.59399240126301, 18.68434246089647]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2983302423040599, "mean_inference_ms": 0.9838801579711915, "mean_action_processing_ms": 0.1292596855675175, "mean_env_wait_ms": 0.07202989718559845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002911210060119629, "StateBufferConnector_ms": 0.0027254819869995117, "ViewRequirementAgentConnector_ms": 0.052829623222351074}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 732.9388902756946, "num_env_steps_trained_throughput_per_sec": 732.9388902756946, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 5539.26, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5539.226, "sample_time_ms": 653.956, "learn_time_ms": 4871.879, "learn_throughput": 821.039, "synch_weights_time_ms": 12.92}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 30, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-57-26", "timestamp": 1723395446, "time_this_iter_s": 5.462335824966431, "time_total_s": 164.8808810710907, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7854af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 164.8808810710907, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 27.6, "ram_util_percent": 81.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8773059881137063, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5339006427830706, "policy_loss": -0.0012994577361193176, "vf_loss": 0.5351999845704996, "vf_explained_var": 0.25825753565877674, "kl": 0.004778242750659067, "entropy": 1.0392428078999123, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2520689739690474, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5111089645109739, "policy_loss": -0.01608220925797165, "vf_loss": 0.5268609160169339, "vf_explained_var": 0.2957224783177177, "kl": 0.013210336387867342, "entropy": 1.532954746733109, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -48.437374639415964, "predator_policy": 1.928457564001391}, "policy_reward_max": {"prey_policy": -1.928457564001391, "predator_policy": 48.437374639415964}, "policy_reward_mean": {"prey_policy": -24.95734577650036, "predator_policy": 24.95734577650036}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-10.692668644096505, -21.00024485779777, -43.41833646742541, -37.5912752431027, -24.339938155987255, -22.041753490053676, -36.674802012996196, -14.950749617513106, -25.815023612746007, -18.23393443417357, -19.368061404377624, -17.53864986260159, -35.12044353678397, -17.335261802387826, -15.160357954734916, -41.9220617456762, -23.144387236605017, -36.17500322636069, -39.01813114429602, -6.684246642595413, -1.928457564001391, -28.08226120942424, -7.016616888768239, -4.475499480692717, -23.285757323492692, -18.29113866751083, -26.883257270877174, -21.49784242708046, -44.46990529189621, -17.28490263358701, -32.754993740058026, -35.58863264164731, -7.788228508526122, -14.235104888068648, -17.343951454515764, -18.28737446171094, -43.84096539083154, -38.078408948258485, -37.88739782703303, -21.9041974306249, -5.432822144009261, -3.019725125563655, -13.978464211495552, -14.814990261288568, -39.96185059059267, -14.012801166255688, -20.965362164464125, -41.43066219219249, -7.2533987724157045, -19.44962589742956, -19.202429381094184, -18.411074696397584, -35.84873494242311, -9.442226757073826, -24.813138200765565, -35.24887225792476, -30.8583902807604, -38.7497673345061, -13.957738983610172, -34.553376166906666, -29.013083154120835, -18.258565395798055, -15.607235518820584, -37.15934602827356, -18.98581567327794, -37.78778088885852, -34.59281758749602, -35.109582282739495, -26.62814241629311, -38.74517377938086, -22.663075984386065, -42.32411817426178, -19.825841571840144, -48.437374639415964, -9.845926768262672, -24.890071714821147, -28.722923862918428, -37.65764555171175, -33.73384279437583, -22.89504890162881, -17.25066345709139, -18.25488765964672, -21.71911012907175, -33.43664677081347, -36.57133042596932, -18.224881126468986, -43.98227640968142, -31.296373766709223, -11.622962017735679, -22.59399240126301, -18.68434246089647, -20.227855935041344, -17.601613659509997, -38.787783035392096, -22.669614851382256, -9.376134268010555, -10.304683578263543, -42.15079404373901, -28.672863297131666, -40.86667899945003], "policy_predator_policy_reward": [10.692668644096505, 21.00024485779777, 43.41833646742541, 37.5912752431027, 24.339938155987255, 22.041753490053676, 36.674802012996196, 14.950749617513106, 25.815023612746007, 18.23393443417357, 19.368061404377624, 17.53864986260159, 35.12044353678397, 17.335261802387826, 15.160357954734916, 41.9220617456762, 23.144387236605017, 36.17500322636069, 39.01813114429602, 6.684246642595413, 1.928457564001391, 28.08226120942424, 7.016616888768239, 4.475499480692717, 23.285757323492692, 18.29113866751083, 26.883257270877174, 21.49784242708046, 44.46990529189621, 17.28490263358701, 32.754993740058026, 35.58863264164731, 7.788228508526122, 14.235104888068648, 17.343951454515764, 18.28737446171094, 43.84096539083154, 38.078408948258485, 37.88739782703303, 21.9041974306249, 5.432822144009261, 3.019725125563655, 13.978464211495552, 14.814990261288568, 39.96185059059267, 14.012801166255688, 20.965362164464125, 41.43066219219249, 7.2533987724157045, 19.44962589742956, 19.202429381094184, 18.411074696397584, 35.84873494242311, 9.442226757073826, 24.813138200765565, 35.24887225792476, 30.8583902807604, 38.7497673345061, 13.957738983610172, 34.553376166906666, 29.013083154120835, 18.258565395798055, 15.607235518820584, 37.15934602827356, 18.98581567327794, 37.78778088885852, 34.59281758749602, 35.109582282739495, 26.62814241629311, 38.74517377938086, 22.663075984386065, 42.32411817426178, 19.825841571840144, 48.437374639415964, 9.845926768262672, 24.890071714821147, 28.722923862918428, 37.65764555171175, 33.73384279437583, 22.89504890162881, 17.25066345709139, 18.25488765964672, 21.71911012907175, 33.43664677081347, 36.57133042596932, 18.224881126468986, 43.98227640968142, 31.296373766709223, 11.622962017735679, 22.59399240126301, 18.68434246089647, 20.227855935041344, 17.601613659509997, 38.787783035392096, 22.669614851382256, 9.376134268010555, 10.304683578263543, 42.15079404373901, 28.672863297131666, 40.86667899945003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29747488328194244, "mean_inference_ms": 0.9802747885323927, "mean_action_processing_ms": 0.1289367494287512, "mean_env_wait_ms": 0.0716910090509168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028967857360839844, "StateBufferConnector_ms": 0.0027083158493041992, "ViewRequirementAgentConnector_ms": 0.052335381507873535}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 675.2179760455854, "num_env_steps_trained_throughput_per_sec": 675.2179760455854, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 5570.206, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5570.173, "sample_time_ms": 654.109, "learn_time_ms": 4902.099, "learn_throughput": 815.977, "synch_weights_time_ms": 13.514}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "training_iteration": 31, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-57-32", "timestamp": 1723395452, "time_this_iter_s": 5.9484100341796875, "time_total_s": 170.82929110527039, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78e14c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 170.82929110527039, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 32.0, "ram_util_percent": 81.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6497737580134223, "cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.35556084527634085, "policy_loss": -0.0044058354270722095, "vf_loss": 0.35996660065526764, "vf_explained_var": 0.34870492611080406, "kl": 0.006520694499975951, "entropy": 1.0595717204113801, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.068818030366674, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3477443432481929, "policy_loss": -0.011191865345851208, "vf_loss": 0.3587957826248991, "vf_explained_var": 0.37929966195176046, "kl": 0.005617074982933401, "entropy": 1.5258563129852216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -48.437374639415964, "predator_policy": 1.928457564001391}, "policy_reward_max": {"prey_policy": -1.928457564001391, "predator_policy": 48.437374639415964}, "policy_reward_mean": {"prey_policy": -25.2809697709792, "predator_policy": 25.2809697709792}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-18.23393443417357, -19.368061404377624, -17.53864986260159, -35.12044353678397, -17.335261802387826, -15.160357954734916, -41.9220617456762, -23.144387236605017, -36.17500322636069, -39.01813114429602, -6.684246642595413, -1.928457564001391, -28.08226120942424, -7.016616888768239, -4.475499480692717, -23.285757323492692, -18.29113866751083, -26.883257270877174, -21.49784242708046, -44.46990529189621, -17.28490263358701, -32.754993740058026, -35.58863264164731, -7.788228508526122, -14.235104888068648, -17.343951454515764, -18.28737446171094, -43.84096539083154, -38.078408948258485, -37.88739782703303, -21.9041974306249, -5.432822144009261, -3.019725125563655, -13.978464211495552, -14.814990261288568, -39.96185059059267, -14.012801166255688, -20.965362164464125, -41.43066219219249, -7.2533987724157045, -19.44962589742956, -19.202429381094184, -18.411074696397584, -35.84873494242311, -9.442226757073826, -24.813138200765565, -35.24887225792476, -30.8583902807604, -38.7497673345061, -13.957738983610172, -34.553376166906666, -29.013083154120835, -18.258565395798055, -15.607235518820584, -37.15934602827356, -18.98581567327794, -37.78778088885852, -34.59281758749602, -35.109582282739495, -26.62814241629311, -38.74517377938086, -22.663075984386065, -42.32411817426178, -19.825841571840144, -48.437374639415964, -9.845926768262672, -24.890071714821147, -28.722923862918428, -37.65764555171175, -33.73384279437583, -22.89504890162881, -17.25066345709139, -18.25488765964672, -21.71911012907175, -33.43664677081347, -36.57133042596932, -18.224881126468986, -43.98227640968142, -31.296373766709223, -11.622962017735679, -22.59399240126301, -18.68434246089647, -20.227855935041344, -17.601613659509997, -38.787783035392096, -22.669614851382256, -9.376134268010555, -10.304683578263543, -42.15079404373901, -28.672863297131666, -40.86667899945003, -36.58386498758507, -7.555365610127753, -18.260911036144975, -38.48484875741808, -42.45366548344764, -30.683886924814647, -31.130487943275668, -32.42055048459499, -31.313610322193824], "policy_predator_policy_reward": [18.23393443417357, 19.368061404377624, 17.53864986260159, 35.12044353678397, 17.335261802387826, 15.160357954734916, 41.9220617456762, 23.144387236605017, 36.17500322636069, 39.01813114429602, 6.684246642595413, 1.928457564001391, 28.08226120942424, 7.016616888768239, 4.475499480692717, 23.285757323492692, 18.29113866751083, 26.883257270877174, 21.49784242708046, 44.46990529189621, 17.28490263358701, 32.754993740058026, 35.58863264164731, 7.788228508526122, 14.235104888068648, 17.343951454515764, 18.28737446171094, 43.84096539083154, 38.078408948258485, 37.88739782703303, 21.9041974306249, 5.432822144009261, 3.019725125563655, 13.978464211495552, 14.814990261288568, 39.96185059059267, 14.012801166255688, 20.965362164464125, 41.43066219219249, 7.2533987724157045, 19.44962589742956, 19.202429381094184, 18.411074696397584, 35.84873494242311, 9.442226757073826, 24.813138200765565, 35.24887225792476, 30.8583902807604, 38.7497673345061, 13.957738983610172, 34.553376166906666, 29.013083154120835, 18.258565395798055, 15.607235518820584, 37.15934602827356, 18.98581567327794, 37.78778088885852, 34.59281758749602, 35.109582282739495, 26.62814241629311, 38.74517377938086, 22.663075984386065, 42.32411817426178, 19.825841571840144, 48.437374639415964, 9.845926768262672, 24.890071714821147, 28.722923862918428, 37.65764555171175, 33.73384279437583, 22.89504890162881, 17.25066345709139, 18.25488765964672, 21.71911012907175, 33.43664677081347, 36.57133042596932, 18.224881126468986, 43.98227640968142, 31.296373766709223, 11.622962017735679, 22.59399240126301, 18.68434246089647, 20.227855935041344, 17.601613659509997, 38.787783035392096, 22.669614851382256, 9.376134268010555, 10.304683578263543, 42.15079404373901, 28.672863297131666, 40.86667899945003, 36.58386498758507, 7.555365610127753, 18.260911036144975, 38.48484875741808, 42.45366548344764, 30.683886924814647, 31.130487943275668, 32.42055048459499, 31.313610322193824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29658125691068843, "mean_inference_ms": 0.9767603340570704, "mean_action_processing_ms": 0.1286032151745248, "mean_env_wait_ms": 0.07134987827650947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002850174903869629, "StateBufferConnector_ms": 0.002693653106689453, "ViewRequirementAgentConnector_ms": 0.05097758769989014}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 729.6169345141462, "num_env_steps_trained_throughput_per_sec": 729.6169345141462, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 5563.384, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5563.35, "sample_time_ms": 645.946, "learn_time_ms": 4903.391, "learn_throughput": 815.762, "synch_weights_time_ms": 13.573}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 32, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-57-37", "timestamp": 1723395457, "time_this_iter_s": 5.488137245178223, "time_total_s": 176.3174283504486, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78e15e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 176.3174283504486, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 29.6625, "ram_util_percent": 81.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.671599836104239, "cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.597679106456538, "policy_loss": -0.0021635410133361197, "vf_loss": 0.5998426101713752, "vf_explained_var": -0.026553417121370635, "kl": 0.003532573976653175, "entropy": 1.046569752196471, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1013657319514703, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5813331871138264, "policy_loss": -0.013149198974618533, "vf_loss": 0.594284669282691, "vf_explained_var": 0.11336617649843296, "kl": 0.007908699321801086, "entropy": 1.545144792770346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -48.437374639415964, "predator_policy": 1.928457564001391}, "policy_reward_max": {"prey_policy": -1.928457564001391, "predator_policy": 48.437374639415964}, "policy_reward_mean": {"prey_policy": -24.993115714032424, "predator_policy": 24.993115714032424}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-39.01813114429602, -6.684246642595413, -1.928457564001391, -28.08226120942424, -7.016616888768239, -4.475499480692717, -23.285757323492692, -18.29113866751083, -26.883257270877174, -21.49784242708046, -44.46990529189621, -17.28490263358701, -32.754993740058026, -35.58863264164731, -7.788228508526122, -14.235104888068648, -17.343951454515764, -18.28737446171094, -43.84096539083154, -38.078408948258485, -37.88739782703303, -21.9041974306249, -5.432822144009261, -3.019725125563655, -13.978464211495552, -14.814990261288568, -39.96185059059267, -14.012801166255688, -20.965362164464125, -41.43066219219249, -7.2533987724157045, -19.44962589742956, -19.202429381094184, -18.411074696397584, -35.84873494242311, -9.442226757073826, -24.813138200765565, -35.24887225792476, -30.8583902807604, -38.7497673345061, -13.957738983610172, -34.553376166906666, -29.013083154120835, -18.258565395798055, -15.607235518820584, -37.15934602827356, -18.98581567327794, -37.78778088885852, -34.59281758749602, -35.109582282739495, -26.62814241629311, -38.74517377938086, -22.663075984386065, -42.32411817426178, -19.825841571840144, -48.437374639415964, -9.845926768262672, -24.890071714821147, -28.722923862918428, -37.65764555171175, -33.73384279437583, -22.89504890162881, -17.25066345709139, -18.25488765964672, -21.71911012907175, -33.43664677081347, -36.57133042596932, -18.224881126468986, -43.98227640968142, -31.296373766709223, -11.622962017735679, -22.59399240126301, -18.68434246089647, -20.227855935041344, -17.601613659509997, -38.787783035392096, -22.669614851382256, -9.376134268010555, -10.304683578263543, -42.15079404373901, -28.672863297131666, -40.86667899945003, -36.58386498758507, -7.555365610127753, -18.260911036144975, -38.48484875741808, -42.45366548344764, -30.683886924814647, -31.130487943275668, -32.42055048459499, -31.313610322193824, -34.60287083522847, -28.4896616452895, -22.04221029736482, -7.765182655601753, -16.547117236467226, -24.625343578073167, -12.095223007613978, -30.720454880984878, -18.324691372399208], "policy_predator_policy_reward": [39.01813114429602, 6.684246642595413, 1.928457564001391, 28.08226120942424, 7.016616888768239, 4.475499480692717, 23.285757323492692, 18.29113866751083, 26.883257270877174, 21.49784242708046, 44.46990529189621, 17.28490263358701, 32.754993740058026, 35.58863264164731, 7.788228508526122, 14.235104888068648, 17.343951454515764, 18.28737446171094, 43.84096539083154, 38.078408948258485, 37.88739782703303, 21.9041974306249, 5.432822144009261, 3.019725125563655, 13.978464211495552, 14.814990261288568, 39.96185059059267, 14.012801166255688, 20.965362164464125, 41.43066219219249, 7.2533987724157045, 19.44962589742956, 19.202429381094184, 18.411074696397584, 35.84873494242311, 9.442226757073826, 24.813138200765565, 35.24887225792476, 30.8583902807604, 38.7497673345061, 13.957738983610172, 34.553376166906666, 29.013083154120835, 18.258565395798055, 15.607235518820584, 37.15934602827356, 18.98581567327794, 37.78778088885852, 34.59281758749602, 35.109582282739495, 26.62814241629311, 38.74517377938086, 22.663075984386065, 42.32411817426178, 19.825841571840144, 48.437374639415964, 9.845926768262672, 24.890071714821147, 28.722923862918428, 37.65764555171175, 33.73384279437583, 22.89504890162881, 17.25066345709139, 18.25488765964672, 21.71911012907175, 33.43664677081347, 36.57133042596932, 18.224881126468986, 43.98227640968142, 31.296373766709223, 11.622962017735679, 22.59399240126301, 18.68434246089647, 20.227855935041344, 17.601613659509997, 38.787783035392096, 22.669614851382256, 9.376134268010555, 10.304683578263543, 42.15079404373901, 28.672863297131666, 40.86667899945003, 36.58386498758507, 7.555365610127753, 18.260911036144975, 38.48484875741808, 42.45366548344764, 30.683886924814647, 31.130487943275668, 32.42055048459499, 31.313610322193824, 34.60287083522847, 28.4896616452895, 22.04221029736482, 7.765182655601753, 16.547117236467226, 24.625343578073167, 12.095223007613978, 30.720454880984878, 18.324691372399208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2956960991553523, "mean_inference_ms": 0.9734182543919703, "mean_action_processing_ms": 0.1282820203162479, "mean_env_wait_ms": 0.07101959357180897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028530359268188477, "StateBufferConnector_ms": 0.0027294158935546875, "ViewRequirementAgentConnector_ms": 0.05110979080200195}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 713.6246057080216, "num_env_steps_trained_throughput_per_sec": 713.6246057080216, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 5570.71, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5570.676, "sample_time_ms": 648.633, "learn_time_ms": 4907.981, "learn_throughput": 814.999, "synch_weights_time_ms": 13.622}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 33, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-57-43", "timestamp": 1723395463, "time_this_iter_s": 5.610053777694702, "time_total_s": 181.9274821281433, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7874790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 181.9274821281433, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 36.325, "ram_util_percent": 82.1875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7422804769439002, "cur_kl_coeff": 6.103515625000001e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2135771826064835, "policy_loss": -0.0003282674580987077, "vf_loss": 0.21390542060835288, "vf_explained_var": 0.8939881640175978, "kl": 0.004943395436514727, "entropy": 1.0158264131595691, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0289154989179223, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1852439893834344, "policy_loss": -0.006937406914948952, "vf_loss": 0.19209632250713185, "vf_explained_var": 0.9146956544369459, "kl": 0.003402991211578137, "entropy": 1.5224026709794998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -48.437374639415964, "predator_policy": 0.9611871334182887}, "policy_reward_max": {"prey_policy": -0.9611871334182887, "predator_policy": 48.437374639415964}, "policy_reward_mean": {"prey_policy": -25.79595440202469, "predator_policy": 25.79595440202469}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-21.49784242708046, -44.46990529189621, -17.28490263358701, -32.754993740058026, -35.58863264164731, -7.788228508526122, -14.235104888068648, -17.343951454515764, -18.28737446171094, -43.84096539083154, -38.078408948258485, -37.88739782703303, -21.9041974306249, -5.432822144009261, -3.019725125563655, -13.978464211495552, -14.814990261288568, -39.96185059059267, -14.012801166255688, -20.965362164464125, -41.43066219219249, -7.2533987724157045, -19.44962589742956, -19.202429381094184, -18.411074696397584, -35.84873494242311, -9.442226757073826, -24.813138200765565, -35.24887225792476, -30.8583902807604, -38.7497673345061, -13.957738983610172, -34.553376166906666, -29.013083154120835, -18.258565395798055, -15.607235518820584, -37.15934602827356, -18.98581567327794, -37.78778088885852, -34.59281758749602, -35.109582282739495, -26.62814241629311, -38.74517377938086, -22.663075984386065, -42.32411817426178, -19.825841571840144, -48.437374639415964, -9.845926768262672, -24.890071714821147, -28.722923862918428, -37.65764555171175, -33.73384279437583, -22.89504890162881, -17.25066345709139, -18.25488765964672, -21.71911012907175, -33.43664677081347, -36.57133042596932, -18.224881126468986, -43.98227640968142, -31.296373766709223, -11.622962017735679, -22.59399240126301, -18.68434246089647, -20.227855935041344, -17.601613659509997, -38.787783035392096, -22.669614851382256, -9.376134268010555, -10.304683578263543, -42.15079404373901, -28.672863297131666, -40.86667899945003, -36.58386498758507, -7.555365610127753, -18.260911036144975, -38.48484875741808, -42.45366548344764, -30.683886924814647, -31.130487943275668, -32.42055048459499, -31.313610322193824, -34.60287083522847, -28.4896616452895, -22.04221029736482, -7.765182655601753, -16.547117236467226, -24.625343578073167, -12.095223007613978, -30.720454880984878, -18.324691372399208, -27.364518259113005, -22.305507839037226, -0.9611871334182887, -38.075628738105664, -19.144688093299, -19.53023229222223, -21.210273674090764, -46.5606653172767, -40.79653364432326], "policy_predator_policy_reward": [21.49784242708046, 44.46990529189621, 17.28490263358701, 32.754993740058026, 35.58863264164731, 7.788228508526122, 14.235104888068648, 17.343951454515764, 18.28737446171094, 43.84096539083154, 38.078408948258485, 37.88739782703303, 21.9041974306249, 5.432822144009261, 3.019725125563655, 13.978464211495552, 14.814990261288568, 39.96185059059267, 14.012801166255688, 20.965362164464125, 41.43066219219249, 7.2533987724157045, 19.44962589742956, 19.202429381094184, 18.411074696397584, 35.84873494242311, 9.442226757073826, 24.813138200765565, 35.24887225792476, 30.8583902807604, 38.7497673345061, 13.957738983610172, 34.553376166906666, 29.013083154120835, 18.258565395798055, 15.607235518820584, 37.15934602827356, 18.98581567327794, 37.78778088885852, 34.59281758749602, 35.109582282739495, 26.62814241629311, 38.74517377938086, 22.663075984386065, 42.32411817426178, 19.825841571840144, 48.437374639415964, 9.845926768262672, 24.890071714821147, 28.722923862918428, 37.65764555171175, 33.73384279437583, 22.89504890162881, 17.25066345709139, 18.25488765964672, 21.71911012907175, 33.43664677081347, 36.57133042596932, 18.224881126468986, 43.98227640968142, 31.296373766709223, 11.622962017735679, 22.59399240126301, 18.68434246089647, 20.227855935041344, 17.601613659509997, 38.787783035392096, 22.669614851382256, 9.376134268010555, 10.304683578263543, 42.15079404373901, 28.672863297131666, 40.86667899945003, 36.58386498758507, 7.555365610127753, 18.260911036144975, 38.48484875741808, 42.45366548344764, 30.683886924814647, 31.130487943275668, 32.42055048459499, 31.313610322193824, 34.60287083522847, 28.4896616452895, 22.04221029736482, 7.765182655601753, 16.547117236467226, 24.625343578073167, 12.095223007613978, 30.720454880984878, 18.324691372399208, 27.364518259113005, 22.305507839037226, 0.9611871334182887, 38.075628738105664, 19.144688093299, 19.53023229222223, 21.210273674090764, 46.5606653172767, 40.79653364432326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2947647261668395, "mean_inference_ms": 0.9701841182735592, "mean_action_processing_ms": 0.12797306990873625, "mean_env_wait_ms": 0.07071178895001139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002805948257446289, "StateBufferConnector_ms": 0.002720952033996582, "ViewRequirementAgentConnector_ms": 0.050560832023620605}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 722.6512832699271, "num_env_steps_trained_throughput_per_sec": 722.6512832699271, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 5581.434, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5581.4, "sample_time_ms": 655.809, "learn_time_ms": 4911.528, "learn_throughput": 814.411, "synch_weights_time_ms": 13.606}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 34, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-57-49", "timestamp": 1723395469, "time_this_iter_s": 5.555882453918457, "time_total_s": 187.48336458206177, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78e14c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 187.48336458206177, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 43.2875, "ram_util_percent": 83.23750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8013165994236867, "cur_kl_coeff": 3.0517578125000006e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4241180115689834, "policy_loss": -0.0015169830095449774, "vf_loss": 0.42563498654635623, "vf_explained_var": 0.7541464500129222, "kl": 0.00368458540519453, "entropy": 1.0333435044934351, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2027923432334016, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3857085030574429, "policy_loss": -0.00985097619947434, "vf_loss": 0.39548864770913494, "vf_explained_var": 0.8094688008228937, "kl": 0.005666523849181945, "entropy": 1.517286437874039, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -48.437374639415964, "predator_policy": 0.9611871334182887}, "policy_reward_max": {"prey_policy": -0.9611871334182887, "predator_policy": 48.437374639415964}, "policy_reward_mean": {"prey_policy": -25.753290205344584, "predator_policy": 25.753290205344584}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-43.84096539083154, -38.078408948258485, -37.88739782703303, -21.9041974306249, -5.432822144009261, -3.019725125563655, -13.978464211495552, -14.814990261288568, -39.96185059059267, -14.012801166255688, -20.965362164464125, -41.43066219219249, -7.2533987724157045, -19.44962589742956, -19.202429381094184, -18.411074696397584, -35.84873494242311, -9.442226757073826, -24.813138200765565, -35.24887225792476, -30.8583902807604, -38.7497673345061, -13.957738983610172, -34.553376166906666, -29.013083154120835, -18.258565395798055, -15.607235518820584, -37.15934602827356, -18.98581567327794, -37.78778088885852, -34.59281758749602, -35.109582282739495, -26.62814241629311, -38.74517377938086, -22.663075984386065, -42.32411817426178, -19.825841571840144, -48.437374639415964, -9.845926768262672, -24.890071714821147, -28.722923862918428, -37.65764555171175, -33.73384279437583, -22.89504890162881, -17.25066345709139, -18.25488765964672, -21.71911012907175, -33.43664677081347, -36.57133042596932, -18.224881126468986, -43.98227640968142, -31.296373766709223, -11.622962017735679, -22.59399240126301, -18.68434246089647, -20.227855935041344, -17.601613659509997, -38.787783035392096, -22.669614851382256, -9.376134268010555, -10.304683578263543, -42.15079404373901, -28.672863297131666, -40.86667899945003, -36.58386498758507, -7.555365610127753, -18.260911036144975, -38.48484875741808, -42.45366548344764, -30.683886924814647, -31.130487943275668, -32.42055048459499, -31.313610322193824, -34.60287083522847, -28.4896616452895, -22.04221029736482, -7.765182655601753, -16.547117236467226, -24.625343578073167, -12.095223007613978, -30.720454880984878, -18.324691372399208, -27.364518259113005, -22.305507839037226, -0.9611871334182887, -38.075628738105664, -19.144688093299, -19.53023229222223, -21.210273674090764, -46.5606653172767, -40.79653364432326, -38.0701986660726, -18.061437576943714, -10.086063098417931, -22.08377741122029, -29.713465755736873, -3.1264570045392714, -38.712081032596984, -24.71783583034225, -20.41320000320958], "policy_predator_policy_reward": [43.84096539083154, 38.078408948258485, 37.88739782703303, 21.9041974306249, 5.432822144009261, 3.019725125563655, 13.978464211495552, 14.814990261288568, 39.96185059059267, 14.012801166255688, 20.965362164464125, 41.43066219219249, 7.2533987724157045, 19.44962589742956, 19.202429381094184, 18.411074696397584, 35.84873494242311, 9.442226757073826, 24.813138200765565, 35.24887225792476, 30.8583902807604, 38.7497673345061, 13.957738983610172, 34.553376166906666, 29.013083154120835, 18.258565395798055, 15.607235518820584, 37.15934602827356, 18.98581567327794, 37.78778088885852, 34.59281758749602, 35.109582282739495, 26.62814241629311, 38.74517377938086, 22.663075984386065, 42.32411817426178, 19.825841571840144, 48.437374639415964, 9.845926768262672, 24.890071714821147, 28.722923862918428, 37.65764555171175, 33.73384279437583, 22.89504890162881, 17.25066345709139, 18.25488765964672, 21.71911012907175, 33.43664677081347, 36.57133042596932, 18.224881126468986, 43.98227640968142, 31.296373766709223, 11.622962017735679, 22.59399240126301, 18.68434246089647, 20.227855935041344, 17.601613659509997, 38.787783035392096, 22.669614851382256, 9.376134268010555, 10.304683578263543, 42.15079404373901, 28.672863297131666, 40.86667899945003, 36.58386498758507, 7.555365610127753, 18.260911036144975, 38.48484875741808, 42.45366548344764, 30.683886924814647, 31.130487943275668, 32.42055048459499, 31.313610322193824, 34.60287083522847, 28.4896616452895, 22.04221029736482, 7.765182655601753, 16.547117236467226, 24.625343578073167, 12.095223007613978, 30.720454880984878, 18.324691372399208, 27.364518259113005, 22.305507839037226, 0.9611871334182887, 38.075628738105664, 19.144688093299, 19.53023229222223, 21.210273674090764, 46.5606653172767, 40.79653364432326, 38.0701986660726, 18.061437576943714, 10.086063098417931, 22.08377741122029, 29.713465755736873, 3.1264570045392714, 38.712081032596984, 24.71783583034225, 20.41320000320958]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.293988449006592, "mean_inference_ms": 0.9674114442168166, "mean_action_processing_ms": 0.12771179631472068, "mean_env_wait_ms": 0.07044552304943372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028505325317382812, "StateBufferConnector_ms": 0.002741098403930664, "ViewRequirementAgentConnector_ms": 0.05095791816711426}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 727.4321282737222, "num_env_steps_trained_throughput_per_sec": 727.4321282737222, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 5553.886, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5553.848, "sample_time_ms": 654.999, "learn_time_ms": 4885.03, "learn_throughput": 818.828, "synch_weights_time_ms": 13.32}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 35, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-57-54", "timestamp": 1723395474, "time_this_iter_s": 5.503840208053589, "time_total_s": 192.98720479011536, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e088b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 192.98720479011536, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 42.975, "ram_util_percent": 83.0125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49954663041668634, "cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07500933706013768, "policy_loss": -0.0009288665212807245, "vf_loss": 0.07593820071197115, "vf_explained_var": 0.8169619932770729, "kl": 0.0020102314912111264, "entropy": 1.060979657744368, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7710297704751914, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06459423539174433, "policy_loss": -0.006772358596451037, "vf_loss": 0.07126425379926028, "vf_explained_var": 0.9238347568859656, "kl": 0.008187184302466255, "entropy": 1.5333810766537985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -48.437374639415964, "predator_policy": 0.9611871334182887}, "policy_reward_max": {"prey_policy": -0.9611871334182887, "predator_policy": 48.437374639415964}, "policy_reward_mean": {"prey_policy": -25.51337423748103, "predator_policy": 25.51337423748103}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-5.432822144009261, -3.019725125563655, -13.978464211495552, -14.814990261288568, -39.96185059059267, -14.012801166255688, -20.965362164464125, -41.43066219219249, -7.2533987724157045, -19.44962589742956, -19.202429381094184, -18.411074696397584, -35.84873494242311, -9.442226757073826, -24.813138200765565, -35.24887225792476, -30.8583902807604, -38.7497673345061, -13.957738983610172, -34.553376166906666, -29.013083154120835, -18.258565395798055, -15.607235518820584, -37.15934602827356, -18.98581567327794, -37.78778088885852, -34.59281758749602, -35.109582282739495, -26.62814241629311, -38.74517377938086, -22.663075984386065, -42.32411817426178, -19.825841571840144, -48.437374639415964, -9.845926768262672, -24.890071714821147, -28.722923862918428, -37.65764555171175, -33.73384279437583, -22.89504890162881, -17.25066345709139, -18.25488765964672, -21.71911012907175, -33.43664677081347, -36.57133042596932, -18.224881126468986, -43.98227640968142, -31.296373766709223, -11.622962017735679, -22.59399240126301, -18.68434246089647, -20.227855935041344, -17.601613659509997, -38.787783035392096, -22.669614851382256, -9.376134268010555, -10.304683578263543, -42.15079404373901, -28.672863297131666, -40.86667899945003, -36.58386498758507, -7.555365610127753, -18.260911036144975, -38.48484875741808, -42.45366548344764, -30.683886924814647, -31.130487943275668, -32.42055048459499, -31.313610322193824, -34.60287083522847, -28.4896616452895, -22.04221029736482, -7.765182655601753, -16.547117236467226, -24.625343578073167, -12.095223007613978, -30.720454880984878, -18.324691372399208, -27.364518259113005, -22.305507839037226, -0.9611871334182887, -38.075628738105664, -19.144688093299, -19.53023229222223, -21.210273674090764, -46.5606653172767, -40.79653364432326, -38.0701986660726, -18.061437576943714, -10.086063098417931, -22.08377741122029, -29.713465755736873, -3.1264570045392714, -38.712081032596984, -24.71783583034225, -20.41320000320958, -43.491515918809085, -19.70531238831454, -23.778943217672325, -30.743601285595854], "policy_predator_policy_reward": [5.432822144009261, 3.019725125563655, 13.978464211495552, 14.814990261288568, 39.96185059059267, 14.012801166255688, 20.965362164464125, 41.43066219219249, 7.2533987724157045, 19.44962589742956, 19.202429381094184, 18.411074696397584, 35.84873494242311, 9.442226757073826, 24.813138200765565, 35.24887225792476, 30.8583902807604, 38.7497673345061, 13.957738983610172, 34.553376166906666, 29.013083154120835, 18.258565395798055, 15.607235518820584, 37.15934602827356, 18.98581567327794, 37.78778088885852, 34.59281758749602, 35.109582282739495, 26.62814241629311, 38.74517377938086, 22.663075984386065, 42.32411817426178, 19.825841571840144, 48.437374639415964, 9.845926768262672, 24.890071714821147, 28.722923862918428, 37.65764555171175, 33.73384279437583, 22.89504890162881, 17.25066345709139, 18.25488765964672, 21.71911012907175, 33.43664677081347, 36.57133042596932, 18.224881126468986, 43.98227640968142, 31.296373766709223, 11.622962017735679, 22.59399240126301, 18.68434246089647, 20.227855935041344, 17.601613659509997, 38.787783035392096, 22.669614851382256, 9.376134268010555, 10.304683578263543, 42.15079404373901, 28.672863297131666, 40.86667899945003, 36.58386498758507, 7.555365610127753, 18.260911036144975, 38.48484875741808, 42.45366548344764, 30.683886924814647, 31.130487943275668, 32.42055048459499, 31.313610322193824, 34.60287083522847, 28.4896616452895, 22.04221029736482, 7.765182655601753, 16.547117236467226, 24.625343578073167, 12.095223007613978, 30.720454880984878, 18.324691372399208, 27.364518259113005, 22.305507839037226, 0.9611871334182887, 38.075628738105664, 19.144688093299, 19.53023229222223, 21.210273674090764, 46.5606653172767, 40.79653364432326, 38.0701986660726, 18.061437576943714, 10.086063098417931, 22.08377741122029, 29.713465755736873, 3.1264570045392714, 38.712081032596984, 24.71783583034225, 20.41320000320958, 43.491515918809085, 19.70531238831454, 23.778943217672325, 30.743601285595854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29363771287081186, "mean_inference_ms": 0.9662405119391849, "mean_action_processing_ms": 0.12755319381853863, "mean_env_wait_ms": 0.0703087687325643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028225183486938477, "StateBufferConnector_ms": 0.0027277469635009766, "ViewRequirementAgentConnector_ms": 0.050142765045166016}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 710.1010821823173, "num_env_steps_trained_throughput_per_sec": 710.1010821823173, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 5562.522, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5562.485, "sample_time_ms": 657.623, "learn_time_ms": 4891.152, "learn_throughput": 817.803, "synch_weights_time_ms": 13.235}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 36, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-58-00", "timestamp": 1723395480, "time_this_iter_s": 5.67768120765686, "time_total_s": 198.66488599777222, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7874790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 198.66488599777222, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 45.3625, "ram_util_percent": 83.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6556872972287238, "cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1767832223539396, "policy_loss": -0.0015145867898051317, "vf_loss": 0.17829779913299718, "vf_explained_var": 0.7256520131602884, "kl": 0.010618327688532266, "entropy": 0.9762168024356167, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7606127550980697, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.15595467880132977, "policy_loss": -0.01851736216679759, "vf_loss": 0.17428960284451023, "vf_explained_var": 0.6559883890052637, "kl": 0.014595059264759574, "entropy": 1.5300199943284194, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -48.437374639415964, "predator_policy": 0.9611871334182887}, "policy_reward_max": {"prey_policy": -0.9611871334182887, "predator_policy": 48.437374639415964}, "policy_reward_mean": {"prey_policy": -26.241972240035746, "predator_policy": 26.241972240035746}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-14.012801166255688, -20.965362164464125, -41.43066219219249, -7.2533987724157045, -19.44962589742956, -19.202429381094184, -18.411074696397584, -35.84873494242311, -9.442226757073826, -24.813138200765565, -35.24887225792476, -30.8583902807604, -38.7497673345061, -13.957738983610172, -34.553376166906666, -29.013083154120835, -18.258565395798055, -15.607235518820584, -37.15934602827356, -18.98581567327794, -37.78778088885852, -34.59281758749602, -35.109582282739495, -26.62814241629311, -38.74517377938086, -22.663075984386065, -42.32411817426178, -19.825841571840144, -48.437374639415964, -9.845926768262672, -24.890071714821147, -28.722923862918428, -37.65764555171175, -33.73384279437583, -22.89504890162881, -17.25066345709139, -18.25488765964672, -21.71911012907175, -33.43664677081347, -36.57133042596932, -18.224881126468986, -43.98227640968142, -31.296373766709223, -11.622962017735679, -22.59399240126301, -18.68434246089647, -20.227855935041344, -17.601613659509997, -38.787783035392096, -22.669614851382256, -9.376134268010555, -10.304683578263543, -42.15079404373901, -28.672863297131666, -40.86667899945003, -36.58386498758507, -7.555365610127753, -18.260911036144975, -38.48484875741808, -42.45366548344764, -30.683886924814647, -31.130487943275668, -32.42055048459499, -31.313610322193824, -34.60287083522847, -28.4896616452895, -22.04221029736482, -7.765182655601753, -16.547117236467226, -24.625343578073167, -12.095223007613978, -30.720454880984878, -18.324691372399208, -27.364518259113005, -22.305507839037226, -0.9611871334182887, -38.075628738105664, -19.144688093299, -19.53023229222223, -21.210273674090764, -46.5606653172767, -40.79653364432326, -38.0701986660726, -18.061437576943714, -10.086063098417931, -22.08377741122029, -29.713465755736873, -3.1264570045392714, -38.712081032596984, -24.71783583034225, -20.41320000320958, -43.491515918809085, -19.70531238831454, -23.778943217672325, -30.743601285595854, -34.651972253637524, -27.604779944617075, -45.40373522894289, -3.050470986265102, -39.35669417496017], "policy_predator_policy_reward": [14.012801166255688, 20.965362164464125, 41.43066219219249, 7.2533987724157045, 19.44962589742956, 19.202429381094184, 18.411074696397584, 35.84873494242311, 9.442226757073826, 24.813138200765565, 35.24887225792476, 30.8583902807604, 38.7497673345061, 13.957738983610172, 34.553376166906666, 29.013083154120835, 18.258565395798055, 15.607235518820584, 37.15934602827356, 18.98581567327794, 37.78778088885852, 34.59281758749602, 35.109582282739495, 26.62814241629311, 38.74517377938086, 22.663075984386065, 42.32411817426178, 19.825841571840144, 48.437374639415964, 9.845926768262672, 24.890071714821147, 28.722923862918428, 37.65764555171175, 33.73384279437583, 22.89504890162881, 17.25066345709139, 18.25488765964672, 21.71911012907175, 33.43664677081347, 36.57133042596932, 18.224881126468986, 43.98227640968142, 31.296373766709223, 11.622962017735679, 22.59399240126301, 18.68434246089647, 20.227855935041344, 17.601613659509997, 38.787783035392096, 22.669614851382256, 9.376134268010555, 10.304683578263543, 42.15079404373901, 28.672863297131666, 40.86667899945003, 36.58386498758507, 7.555365610127753, 18.260911036144975, 38.48484875741808, 42.45366548344764, 30.683886924814647, 31.130487943275668, 32.42055048459499, 31.313610322193824, 34.60287083522847, 28.4896616452895, 22.04221029736482, 7.765182655601753, 16.547117236467226, 24.625343578073167, 12.095223007613978, 30.720454880984878, 18.324691372399208, 27.364518259113005, 22.305507839037226, 0.9611871334182887, 38.075628738105664, 19.144688093299, 19.53023229222223, 21.210273674090764, 46.5606653172767, 40.79653364432326, 38.0701986660726, 18.061437576943714, 10.086063098417931, 22.08377741122029, 29.713465755736873, 3.1264570045392714, 38.712081032596984, 24.71783583034225, 20.41320000320958, 43.491515918809085, 19.70531238831454, 23.778943217672325, 30.743601285595854, 34.651972253637524, 27.604779944617075, 45.40373522894289, 3.050470986265102, 39.35669417496017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2933250726564059, "mean_inference_ms": 0.9651091923397978, "mean_action_processing_ms": 0.1275189214595698, "mean_env_wait_ms": 0.0702221163075228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002855539321899414, "StateBufferConnector_ms": 0.002745509147644043, "ViewRequirementAgentConnector_ms": 0.05054616928100586}, "num_episodes": 5, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 711.0803989441544, "num_env_steps_trained_throughput_per_sec": 711.0803989441544, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 5588.219, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5588.178, "sample_time_ms": 660.888, "learn_time_ms": 4913.599, "learn_throughput": 814.067, "synch_weights_time_ms": 13.221}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "training_iteration": 37, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-58-05", "timestamp": 1723395485, "time_this_iter_s": 5.629800796508789, "time_total_s": 204.294686794281, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 204.294686794281, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 36.1625, "ram_util_percent": 82.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7435799304706355, "cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1558935823607802, "policy_loss": -0.0012695456818619278, "vf_loss": 0.15716312297736296, "vf_explained_var": 0.9233735026791692, "kl": 0.007161864272286456, "entropy": 0.9647509447609385, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0200967226177453, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.11547597868426844, "policy_loss": -0.010836728899448644, "vf_loss": 0.12623303631941477, "vf_explained_var": 0.9647456649069984, "kl": 0.006373749018539506, "entropy": 1.5129406437277795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -48.437374639415964, "predator_policy": 0.9611871334182887}, "policy_reward_max": {"prey_policy": -0.9611871334182887, "predator_policy": 48.437374639415964}, "policy_reward_mean": {"prey_policy": -26.17609954928143, "predator_policy": 26.17609954928143}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-24.813138200765565, -35.24887225792476, -30.8583902807604, -38.7497673345061, -13.957738983610172, -34.553376166906666, -29.013083154120835, -18.258565395798055, -15.607235518820584, -37.15934602827356, -18.98581567327794, -37.78778088885852, -34.59281758749602, -35.109582282739495, -26.62814241629311, -38.74517377938086, -22.663075984386065, -42.32411817426178, -19.825841571840144, -48.437374639415964, -9.845926768262672, -24.890071714821147, -28.722923862918428, -37.65764555171175, -33.73384279437583, -22.89504890162881, -17.25066345709139, -18.25488765964672, -21.71911012907175, -33.43664677081347, -36.57133042596932, -18.224881126468986, -43.98227640968142, -31.296373766709223, -11.622962017735679, -22.59399240126301, -18.68434246089647, -20.227855935041344, -17.601613659509997, -38.787783035392096, -22.669614851382256, -9.376134268010555, -10.304683578263543, -42.15079404373901, -28.672863297131666, -40.86667899945003, -36.58386498758507, -7.555365610127753, -18.260911036144975, -38.48484875741808, -42.45366548344764, -30.683886924814647, -31.130487943275668, -32.42055048459499, -31.313610322193824, -34.60287083522847, -28.4896616452895, -22.04221029736482, -7.765182655601753, -16.547117236467226, -24.625343578073167, -12.095223007613978, -30.720454880984878, -18.324691372399208, -27.364518259113005, -22.305507839037226, -0.9611871334182887, -38.075628738105664, -19.144688093299, -19.53023229222223, -21.210273674090764, -46.5606653172767, -40.79653364432326, -38.0701986660726, -18.061437576943714, -10.086063098417931, -22.08377741122029, -29.713465755736873, -3.1264570045392714, -38.712081032596984, -24.71783583034225, -20.41320000320958, -43.491515918809085, -19.70531238831454, -23.778943217672325, -30.743601285595854, -34.651972253637524, -27.604779944617075, -45.40373522894289, -3.050470986265102, -39.35669417496017, -19.292860852239798, -2.313470685041178, -16.189291066146907, -28.789735531321934, -26.312650746328217, -18.725905228311063, -28.938338438743827, -28.12347754152367, -10.743316804656708], "policy_predator_policy_reward": [24.813138200765565, 35.24887225792476, 30.8583902807604, 38.7497673345061, 13.957738983610172, 34.553376166906666, 29.013083154120835, 18.258565395798055, 15.607235518820584, 37.15934602827356, 18.98581567327794, 37.78778088885852, 34.59281758749602, 35.109582282739495, 26.62814241629311, 38.74517377938086, 22.663075984386065, 42.32411817426178, 19.825841571840144, 48.437374639415964, 9.845926768262672, 24.890071714821147, 28.722923862918428, 37.65764555171175, 33.73384279437583, 22.89504890162881, 17.25066345709139, 18.25488765964672, 21.71911012907175, 33.43664677081347, 36.57133042596932, 18.224881126468986, 43.98227640968142, 31.296373766709223, 11.622962017735679, 22.59399240126301, 18.68434246089647, 20.227855935041344, 17.601613659509997, 38.787783035392096, 22.669614851382256, 9.376134268010555, 10.304683578263543, 42.15079404373901, 28.672863297131666, 40.86667899945003, 36.58386498758507, 7.555365610127753, 18.260911036144975, 38.48484875741808, 42.45366548344764, 30.683886924814647, 31.130487943275668, 32.42055048459499, 31.313610322193824, 34.60287083522847, 28.4896616452895, 22.04221029736482, 7.765182655601753, 16.547117236467226, 24.625343578073167, 12.095223007613978, 30.720454880984878, 18.324691372399208, 27.364518259113005, 22.305507839037226, 0.9611871334182887, 38.075628738105664, 19.144688093299, 19.53023229222223, 21.210273674090764, 46.5606653172767, 40.79653364432326, 38.0701986660726, 18.061437576943714, 10.086063098417931, 22.08377741122029, 29.713465755736873, 3.1264570045392714, 38.712081032596984, 24.71783583034225, 20.41320000320958, 43.491515918809085, 19.70531238831454, 23.778943217672325, 30.743601285595854, 34.651972253637524, 27.604779944617075, 45.40373522894289, 3.050470986265102, 39.35669417496017, 19.292860852239798, 2.313470685041178, 16.189291066146907, 28.789735531321934, 26.312650746328217, 18.725905228311063, 28.938338438743827, 28.12347754152367, 10.743316804656708]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2926338682604771, "mean_inference_ms": 0.9629172946008362, "mean_action_processing_ms": 0.12734216529435485, "mean_env_wait_ms": 0.07002070210134423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002923250198364258, "StateBufferConnector_ms": 0.0027730464935302734, "ViewRequirementAgentConnector_ms": 0.047942280769348145}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 709.2035358352421, "num_env_steps_trained_throughput_per_sec": 709.2035358352421, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 5582.964, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5582.924, "sample_time_ms": 655.961, "learn_time_ms": 4913.276, "learn_throughput": 814.121, "synch_weights_time_ms": 13.22}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 38, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-58-11", "timestamp": 1723395491, "time_this_iter_s": 5.64468789100647, "time_total_s": 209.93937468528748, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e08790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 209.93937468528748, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 31.937499999999996, "ram_util_percent": 82.57499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6944814897375181, "cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.23049127534031869, "policy_loss": 0.0005038100406333494, "vf_loss": 0.22998746156614894, "vf_explained_var": 0.7215911855300268, "kl": 0.006760118752927961, "entropy": 0.9405138993635773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9281663610134274, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2374307810007849, "policy_loss": -0.013947338093081877, "vf_loss": 0.2512915145159544, "vf_explained_var": 0.6493493565047781, "kl": 0.006928338663410122, "entropy": 1.4627309434115887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -48.437374639415964, "predator_policy": 0.9611871334182887}, "policy_reward_max": {"prey_policy": -0.9611871334182887, "predator_policy": 48.437374639415964}, "policy_reward_mean": {"prey_policy": -25.39266326988198, "predator_policy": 25.39266326988198}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-37.15934602827356, -18.98581567327794, -37.78778088885852, -34.59281758749602, -35.109582282739495, -26.62814241629311, -38.74517377938086, -22.663075984386065, -42.32411817426178, -19.825841571840144, -48.437374639415964, -9.845926768262672, -24.890071714821147, -28.722923862918428, -37.65764555171175, -33.73384279437583, -22.89504890162881, -17.25066345709139, -18.25488765964672, -21.71911012907175, -33.43664677081347, -36.57133042596932, -18.224881126468986, -43.98227640968142, -31.296373766709223, -11.622962017735679, -22.59399240126301, -18.68434246089647, -20.227855935041344, -17.601613659509997, -38.787783035392096, -22.669614851382256, -9.376134268010555, -10.304683578263543, -42.15079404373901, -28.672863297131666, -40.86667899945003, -36.58386498758507, -7.555365610127753, -18.260911036144975, -38.48484875741808, -42.45366548344764, -30.683886924814647, -31.130487943275668, -32.42055048459499, -31.313610322193824, -34.60287083522847, -28.4896616452895, -22.04221029736482, -7.765182655601753, -16.547117236467226, -24.625343578073167, -12.095223007613978, -30.720454880984878, -18.324691372399208, -27.364518259113005, -22.305507839037226, -0.9611871334182887, -38.075628738105664, -19.144688093299, -19.53023229222223, -21.210273674090764, -46.5606653172767, -40.79653364432326, -38.0701986660726, -18.061437576943714, -10.086063098417931, -22.08377741122029, -29.713465755736873, -3.1264570045392714, -38.712081032596984, -24.71783583034225, -20.41320000320958, -43.491515918809085, -19.70531238831454, -23.778943217672325, -30.743601285595854, -34.651972253637524, -27.604779944617075, -45.40373522894289, -3.050470986265102, -39.35669417496017, -19.292860852239798, -2.313470685041178, -16.189291066146907, -28.789735531321934, -26.312650746328217, -18.725905228311063, -28.938338438743827, -28.12347754152367, -10.743316804656708, -27.407260177700906, -24.763317982748283, -10.20871592819244, -31.633552169664767, -4.845996336433416, -39.045630839044506, -13.05860386451091, -3.9599967262165867, -7.793465328756714], "policy_predator_policy_reward": [37.15934602827356, 18.98581567327794, 37.78778088885852, 34.59281758749602, 35.109582282739495, 26.62814241629311, 38.74517377938086, 22.663075984386065, 42.32411817426178, 19.825841571840144, 48.437374639415964, 9.845926768262672, 24.890071714821147, 28.722923862918428, 37.65764555171175, 33.73384279437583, 22.89504890162881, 17.25066345709139, 18.25488765964672, 21.71911012907175, 33.43664677081347, 36.57133042596932, 18.224881126468986, 43.98227640968142, 31.296373766709223, 11.622962017735679, 22.59399240126301, 18.68434246089647, 20.227855935041344, 17.601613659509997, 38.787783035392096, 22.669614851382256, 9.376134268010555, 10.304683578263543, 42.15079404373901, 28.672863297131666, 40.86667899945003, 36.58386498758507, 7.555365610127753, 18.260911036144975, 38.48484875741808, 42.45366548344764, 30.683886924814647, 31.130487943275668, 32.42055048459499, 31.313610322193824, 34.60287083522847, 28.4896616452895, 22.04221029736482, 7.765182655601753, 16.547117236467226, 24.625343578073167, 12.095223007613978, 30.720454880984878, 18.324691372399208, 27.364518259113005, 22.305507839037226, 0.9611871334182887, 38.075628738105664, 19.144688093299, 19.53023229222223, 21.210273674090764, 46.5606653172767, 40.79653364432326, 38.0701986660726, 18.061437576943714, 10.086063098417931, 22.08377741122029, 29.713465755736873, 3.1264570045392714, 38.712081032596984, 24.71783583034225, 20.41320000320958, 43.491515918809085, 19.70531238831454, 23.778943217672325, 30.743601285595854, 34.651972253637524, 27.604779944617075, 45.40373522894289, 3.050470986265102, 39.35669417496017, 19.292860852239798, 2.313470685041178, 16.189291066146907, 28.789735531321934, 26.312650746328217, 18.725905228311063, 28.938338438743827, 28.12347754152367, 10.743316804656708, 27.407260177700906, 24.763317982748283, 10.20871592819244, 31.633552169664767, 4.845996336433416, 39.045630839044506, 13.05860386451091, 3.9599967262165867, 7.793465328756714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.291968879591792, "mean_inference_ms": 0.9608488107663797, "mean_action_processing_ms": 0.12718390455148956, "mean_env_wait_ms": 0.06981689968584819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00278472900390625, "StateBufferConnector_ms": 0.0028764009475708008, "ViewRequirementAgentConnector_ms": 0.04860031604766846}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 713.3192814177767, "num_env_steps_trained_throughput_per_sec": 713.3192814177767, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 5600.906, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5600.866, "sample_time_ms": 658.582, "learn_time_ms": 4928.62, "learn_throughput": 811.586, "synch_weights_time_ms": 13.24}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 39, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-58-17", "timestamp": 1723395497, "time_this_iter_s": 5.613987922668457, "time_total_s": 215.55336260795593, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2d8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 215.55336260795593, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 31.4375, "ram_util_percent": 82.6125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9408525886169324, "cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5089559916251649, "policy_loss": -0.0010373831590792784, "vf_loss": 0.5099933775297055, "vf_explained_var": 0.5891744521756966, "kl": 0.0059316497323694895, "entropy": 0.8961555467297634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1351959192038825, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.438478452197766, "policy_loss": -0.017968665508669802, "vf_loss": 0.45637085118408627, "vf_explained_var": 0.7368863864491383, "kl": 0.00610154182393714, "entropy": 1.4654884051531554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -48.437374639415964, "predator_policy": 0.9611871334182887}, "policy_reward_max": {"prey_policy": -0.9611871334182887, "predator_policy": 48.437374639415964}, "policy_reward_mean": {"prey_policy": -24.51862420439139, "predator_policy": 24.51862420439139}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-19.825841571840144, -48.437374639415964, -9.845926768262672, -24.890071714821147, -28.722923862918428, -37.65764555171175, -33.73384279437583, -22.89504890162881, -17.25066345709139, -18.25488765964672, -21.71911012907175, -33.43664677081347, -36.57133042596932, -18.224881126468986, -43.98227640968142, -31.296373766709223, -11.622962017735679, -22.59399240126301, -18.68434246089647, -20.227855935041344, -17.601613659509997, -38.787783035392096, -22.669614851382256, -9.376134268010555, -10.304683578263543, -42.15079404373901, -28.672863297131666, -40.86667899945003, -36.58386498758507, -7.555365610127753, -18.260911036144975, -38.48484875741808, -42.45366548344764, -30.683886924814647, -31.130487943275668, -32.42055048459499, -31.313610322193824, -34.60287083522847, -28.4896616452895, -22.04221029736482, -7.765182655601753, -16.547117236467226, -24.625343578073167, -12.095223007613978, -30.720454880984878, -18.324691372399208, -27.364518259113005, -22.305507839037226, -0.9611871334182887, -38.075628738105664, -19.144688093299, -19.53023229222223, -21.210273674090764, -46.5606653172767, -40.79653364432326, -38.0701986660726, -18.061437576943714, -10.086063098417931, -22.08377741122029, -29.713465755736873, -3.1264570045392714, -38.712081032596984, -24.71783583034225, -20.41320000320958, -43.491515918809085, -19.70531238831454, -23.778943217672325, -30.743601285595854, -34.651972253637524, -27.604779944617075, -45.40373522894289, -3.050470986265102, -39.35669417496017, -19.292860852239798, -2.313470685041178, -16.189291066146907, -28.789735531321934, -26.312650746328217, -18.725905228311063, -28.938338438743827, -28.12347754152367, -10.743316804656708, -27.407260177700906, -24.763317982748283, -10.20871592819244, -31.633552169664767, -4.845996336433416, -39.045630839044506, -13.05860386451091, -3.9599967262165867, -7.793465328756714, -18.294292232468077, -18.62259509537857, -12.467865316773056, -25.083229133423266, -18.371264225450542, -34.33611367906768, -15.7449854452201, -32.23587225175914, -31.435728886367457], "policy_predator_policy_reward": [19.825841571840144, 48.437374639415964, 9.845926768262672, 24.890071714821147, 28.722923862918428, 37.65764555171175, 33.73384279437583, 22.89504890162881, 17.25066345709139, 18.25488765964672, 21.71911012907175, 33.43664677081347, 36.57133042596932, 18.224881126468986, 43.98227640968142, 31.296373766709223, 11.622962017735679, 22.59399240126301, 18.68434246089647, 20.227855935041344, 17.601613659509997, 38.787783035392096, 22.669614851382256, 9.376134268010555, 10.304683578263543, 42.15079404373901, 28.672863297131666, 40.86667899945003, 36.58386498758507, 7.555365610127753, 18.260911036144975, 38.48484875741808, 42.45366548344764, 30.683886924814647, 31.130487943275668, 32.42055048459499, 31.313610322193824, 34.60287083522847, 28.4896616452895, 22.04221029736482, 7.765182655601753, 16.547117236467226, 24.625343578073167, 12.095223007613978, 30.720454880984878, 18.324691372399208, 27.364518259113005, 22.305507839037226, 0.9611871334182887, 38.075628738105664, 19.144688093299, 19.53023229222223, 21.210273674090764, 46.5606653172767, 40.79653364432326, 38.0701986660726, 18.061437576943714, 10.086063098417931, 22.08377741122029, 29.713465755736873, 3.1264570045392714, 38.712081032596984, 24.71783583034225, 20.41320000320958, 43.491515918809085, 19.70531238831454, 23.778943217672325, 30.743601285595854, 34.651972253637524, 27.604779944617075, 45.40373522894289, 3.050470986265102, 39.35669417496017, 19.292860852239798, 2.313470685041178, 16.189291066146907, 28.789735531321934, 26.312650746328217, 18.725905228311063, 28.938338438743827, 28.12347754152367, 10.743316804656708, 27.407260177700906, 24.763317982748283, 10.20871592819244, 31.633552169664767, 4.845996336433416, 39.045630839044506, 13.05860386451091, 3.9599967262165867, 7.793465328756714, 18.294292232468077, 18.62259509537857, 12.467865316773056, 25.083229133423266, 18.371264225450542, 34.33611367906768, 15.7449854452201, 32.23587225175914, 31.435728886367457]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2914208127256399, "mean_inference_ms": 0.9588818504824232, "mean_action_processing_ms": 0.12703914851877524, "mean_env_wait_ms": 0.06962635938882838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002907276153564453, "StateBufferConnector_ms": 0.002955198287963867, "ViewRequirementAgentConnector_ms": 0.05254995822906494}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 692.7576561184864, "num_env_steps_trained_throughput_per_sec": 692.7576561184864, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 5632.56, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5632.52, "sample_time_ms": 670.762, "learn_time_ms": 4948.188, "learn_throughput": 808.377, "synch_weights_time_ms": 13.142}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 40, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-58-22", "timestamp": 1723395502, "time_this_iter_s": 5.779912948608398, "time_total_s": 221.33327555656433, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78231f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 221.33327555656433, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 31.875000000000004, "ram_util_percent": 82.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8955634304787964, "cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.28511403001224, "policy_loss": 0.00036792507647381476, "vf_loss": 0.2847461057283605, "vf_explained_var": 0.720882776627938, "kl": 0.004096202121179366, "entropy": 0.8809815146028995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.139818140041704, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.25821244247346536, "policy_loss": -0.01852652665717566, "vf_loss": 0.276665411235687, "vf_explained_var": 0.7944580285499493, "kl": 0.005884621055462957, "entropy": 1.4913210252920786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.826291742461734, "predator_policy": 0.9611871334182887}, "policy_reward_max": {"prey_policy": -0.9611871334182887, "predator_policy": 51.826291742461734}, "policy_reward_mean": {"prey_policy": -24.857885631791035, "predator_policy": 24.857885631791035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-18.25488765964672, -21.71911012907175, -33.43664677081347, -36.57133042596932, -18.224881126468986, -43.98227640968142, -31.296373766709223, -11.622962017735679, -22.59399240126301, -18.68434246089647, -20.227855935041344, -17.601613659509997, -38.787783035392096, -22.669614851382256, -9.376134268010555, -10.304683578263543, -42.15079404373901, -28.672863297131666, -40.86667899945003, -36.58386498758507, -7.555365610127753, -18.260911036144975, -38.48484875741808, -42.45366548344764, -30.683886924814647, -31.130487943275668, -32.42055048459499, -31.313610322193824, -34.60287083522847, -28.4896616452895, -22.04221029736482, -7.765182655601753, -16.547117236467226, -24.625343578073167, -12.095223007613978, -30.720454880984878, -18.324691372399208, -27.364518259113005, -22.305507839037226, -0.9611871334182887, -38.075628738105664, -19.144688093299, -19.53023229222223, -21.210273674090764, -46.5606653172767, -40.79653364432326, -38.0701986660726, -18.061437576943714, -10.086063098417931, -22.08377741122029, -29.713465755736873, -3.1264570045392714, -38.712081032596984, -24.71783583034225, -20.41320000320958, -43.491515918809085, -19.70531238831454, -23.778943217672325, -30.743601285595854, -34.651972253637524, -27.604779944617075, -45.40373522894289, -3.050470986265102, -39.35669417496017, -19.292860852239798, -2.313470685041178, -16.189291066146907, -28.789735531321934, -26.312650746328217, -18.725905228311063, -28.938338438743827, -28.12347754152367, -10.743316804656708, -27.407260177700906, -24.763317982748283, -10.20871592819244, -31.633552169664767, -4.845996336433416, -39.045630839044506, -13.05860386451091, -3.9599967262165867, -7.793465328756714, -18.294292232468077, -18.62259509537857, -12.467865316773056, -25.083229133423266, -18.371264225450542, -34.33611367906768, -15.7449854452201, -32.23587225175914, -31.435728886367457, -31.866411018895107, -40.128018254381615, -37.093964403427236, -51.826291742461734, -27.387267607083892, -20.852966704310397, -14.661093464422933, -24.835196842076147, -28.53427196497292], "policy_predator_policy_reward": [18.25488765964672, 21.71911012907175, 33.43664677081347, 36.57133042596932, 18.224881126468986, 43.98227640968142, 31.296373766709223, 11.622962017735679, 22.59399240126301, 18.68434246089647, 20.227855935041344, 17.601613659509997, 38.787783035392096, 22.669614851382256, 9.376134268010555, 10.304683578263543, 42.15079404373901, 28.672863297131666, 40.86667899945003, 36.58386498758507, 7.555365610127753, 18.260911036144975, 38.48484875741808, 42.45366548344764, 30.683886924814647, 31.130487943275668, 32.42055048459499, 31.313610322193824, 34.60287083522847, 28.4896616452895, 22.04221029736482, 7.765182655601753, 16.547117236467226, 24.625343578073167, 12.095223007613978, 30.720454880984878, 18.324691372399208, 27.364518259113005, 22.305507839037226, 0.9611871334182887, 38.075628738105664, 19.144688093299, 19.53023229222223, 21.210273674090764, 46.5606653172767, 40.79653364432326, 38.0701986660726, 18.061437576943714, 10.086063098417931, 22.08377741122029, 29.713465755736873, 3.1264570045392714, 38.712081032596984, 24.71783583034225, 20.41320000320958, 43.491515918809085, 19.70531238831454, 23.778943217672325, 30.743601285595854, 34.651972253637524, 27.604779944617075, 45.40373522894289, 3.050470986265102, 39.35669417496017, 19.292860852239798, 2.313470685041178, 16.189291066146907, 28.789735531321934, 26.312650746328217, 18.725905228311063, 28.938338438743827, 28.12347754152367, 10.743316804656708, 27.407260177700906, 24.763317982748283, 10.20871592819244, 31.633552169664767, 4.845996336433416, 39.045630839044506, 13.05860386451091, 3.9599967262165867, 7.793465328756714, 18.294292232468077, 18.62259509537857, 12.467865316773056, 25.083229133423266, 18.371264225450542, 34.33611367906768, 15.7449854452201, 32.23587225175914, 31.435728886367457, 31.866411018895107, 40.128018254381615, 37.093964403427236, 51.826291742461734, 27.387267607083892, 20.852966704310397, 14.661093464422933, 24.835196842076147, 28.53427196497292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.290951371545924, "mean_inference_ms": 0.9571429187859549, "mean_action_processing_ms": 0.12689486809919986, "mean_env_wait_ms": 0.06945328323140415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029543638229370117, "StateBufferConnector_ms": 0.00298154354095459, "ViewRequirementAgentConnector_ms": 0.052456021308898926}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 684.2468994658603, "num_env_steps_trained_throughput_per_sec": 684.2468994658603, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 5624.743, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5624.703, "sample_time_ms": 668.966, "learn_time_ms": 4942.511, "learn_throughput": 809.305, "synch_weights_time_ms": 12.819}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "training_iteration": 41, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-58-28", "timestamp": 1723395508, "time_this_iter_s": 5.896810054779053, "time_total_s": 227.23008561134338, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e08e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 227.23008561134338, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 35.025, "ram_util_percent": 82.57499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8375017826911062, "cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3006518891158824, "policy_loss": -0.0003718694468261674, "vf_loss": 0.30102375788264907, "vf_explained_var": 0.6785638557126125, "kl": 0.0028534723872280037, "entropy": 0.9033938461914659, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1941599687716613, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.26862535108763647, "policy_loss": -0.009376696931576589, "vf_loss": 0.2778939737356268, "vf_explained_var": 0.6712503919998805, "kl": 0.008645875858513315, "entropy": 1.4902621739854416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.826291742461734, "predator_policy": 0.9611871334182887}, "policy_reward_max": {"prey_policy": -0.9611871334182887, "predator_policy": 51.826291742461734}, "policy_reward_mean": {"prey_policy": -24.687497271887956, "predator_policy": 24.687497271887956}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-18.68434246089647, -20.227855935041344, -17.601613659509997, -38.787783035392096, -22.669614851382256, -9.376134268010555, -10.304683578263543, -42.15079404373901, -28.672863297131666, -40.86667899945003, -36.58386498758507, -7.555365610127753, -18.260911036144975, -38.48484875741808, -42.45366548344764, -30.683886924814647, -31.130487943275668, -32.42055048459499, -31.313610322193824, -34.60287083522847, -28.4896616452895, -22.04221029736482, -7.765182655601753, -16.547117236467226, -24.625343578073167, -12.095223007613978, -30.720454880984878, -18.324691372399208, -27.364518259113005, -22.305507839037226, -0.9611871334182887, -38.075628738105664, -19.144688093299, -19.53023229222223, -21.210273674090764, -46.5606653172767, -40.79653364432326, -38.0701986660726, -18.061437576943714, -10.086063098417931, -22.08377741122029, -29.713465755736873, -3.1264570045392714, -38.712081032596984, -24.71783583034225, -20.41320000320958, -43.491515918809085, -19.70531238831454, -23.778943217672325, -30.743601285595854, -34.651972253637524, -27.604779944617075, -45.40373522894289, -3.050470986265102, -39.35669417496017, -19.292860852239798, -2.313470685041178, -16.189291066146907, -28.789735531321934, -26.312650746328217, -18.725905228311063, -28.938338438743827, -28.12347754152367, -10.743316804656708, -27.407260177700906, -24.763317982748283, -10.20871592819244, -31.633552169664767, -4.845996336433416, -39.045630839044506, -13.05860386451091, -3.9599967262165867, -7.793465328756714, -18.294292232468077, -18.62259509537857, -12.467865316773056, -25.083229133423266, -18.371264225450542, -34.33611367906768, -15.7449854452201, -32.23587225175914, -31.435728886367457, -31.866411018895107, -40.128018254381615, -37.093964403427236, -51.826291742461734, -27.387267607083892, -20.852966704310397, -14.661093464422933, -24.835196842076147, -28.53427196497292, -19.57391064374147, -26.762152334499902, -34.21462126538992, -19.86542299839449, -3.433773154909936, -17.27539423434425, -25.408084463028164, -35.085260009150055, -39.04500561359296], "policy_predator_policy_reward": [18.68434246089647, 20.227855935041344, 17.601613659509997, 38.787783035392096, 22.669614851382256, 9.376134268010555, 10.304683578263543, 42.15079404373901, 28.672863297131666, 40.86667899945003, 36.58386498758507, 7.555365610127753, 18.260911036144975, 38.48484875741808, 42.45366548344764, 30.683886924814647, 31.130487943275668, 32.42055048459499, 31.313610322193824, 34.60287083522847, 28.4896616452895, 22.04221029736482, 7.765182655601753, 16.547117236467226, 24.625343578073167, 12.095223007613978, 30.720454880984878, 18.324691372399208, 27.364518259113005, 22.305507839037226, 0.9611871334182887, 38.075628738105664, 19.144688093299, 19.53023229222223, 21.210273674090764, 46.5606653172767, 40.79653364432326, 38.0701986660726, 18.061437576943714, 10.086063098417931, 22.08377741122029, 29.713465755736873, 3.1264570045392714, 38.712081032596984, 24.71783583034225, 20.41320000320958, 43.491515918809085, 19.70531238831454, 23.778943217672325, 30.743601285595854, 34.651972253637524, 27.604779944617075, 45.40373522894289, 3.050470986265102, 39.35669417496017, 19.292860852239798, 2.313470685041178, 16.189291066146907, 28.789735531321934, 26.312650746328217, 18.725905228311063, 28.938338438743827, 28.12347754152367, 10.743316804656708, 27.407260177700906, 24.763317982748283, 10.20871592819244, 31.633552169664767, 4.845996336433416, 39.045630839044506, 13.05860386451091, 3.9599967262165867, 7.793465328756714, 18.294292232468077, 18.62259509537857, 12.467865316773056, 25.083229133423266, 18.371264225450542, 34.33611367906768, 15.7449854452201, 32.23587225175914, 31.435728886367457, 31.866411018895107, 40.128018254381615, 37.093964403427236, 51.826291742461734, 27.387267607083892, 20.852966704310397, 14.661093464422933, 24.835196842076147, 28.53427196497292, 19.57391064374147, 26.762152334499902, 34.21462126538992, 19.86542299839449, 3.433773154909936, 17.27539423434425, 25.408084463028164, 35.085260009150055, 39.04500561359296]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29058273470442136, "mean_inference_ms": 0.9557493514254601, "mean_action_processing_ms": 0.12677784464556624, "mean_env_wait_ms": 0.06931903071054561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029257535934448242, "StateBufferConnector_ms": 0.002389073371887207, "ViewRequirementAgentConnector_ms": 0.052043795585632324}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 710.4026945243803, "num_env_steps_trained_throughput_per_sec": 710.4026945243803, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 5639.573, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5639.529, "sample_time_ms": 678.309, "learn_time_ms": 4947.489, "learn_throughput": 808.491, "synch_weights_time_ms": 13.334}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 42, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-58-34", "timestamp": 1723395514, "time_this_iter_s": 5.6350250244140625, "time_total_s": 232.86511063575745, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7874790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 232.86511063575745, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 34.2125, "ram_util_percent": 82.64999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7506044715875759, "cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.22844813246435175, "policy_loss": -0.0008572736992694748, "vf_loss": 0.22930540604284033, "vf_explained_var": 0.7132646987214685, "kl": 0.0064150390565312874, "entropy": 0.899804612249136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9407996284775436, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1920082873518671, "policy_loss": -0.011189007507346105, "vf_loss": 0.20310428826487623, "vf_explained_var": 0.6932490249474843, "kl": 0.0074405594186401245, "entropy": 1.4923655064155659, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.826291742461734, "predator_policy": 0.9611871334182887}, "policy_reward_max": {"prey_policy": -0.9611871334182887, "predator_policy": 51.826291742461734}, "policy_reward_mean": {"prey_policy": -25.316670965830014, "predator_policy": 25.316670965830014}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-40.86667899945003, -36.58386498758507, -7.555365610127753, -18.260911036144975, -38.48484875741808, -42.45366548344764, -30.683886924814647, -31.130487943275668, -32.42055048459499, -31.313610322193824, -34.60287083522847, -28.4896616452895, -22.04221029736482, -7.765182655601753, -16.547117236467226, -24.625343578073167, -12.095223007613978, -30.720454880984878, -18.324691372399208, -27.364518259113005, -22.305507839037226, -0.9611871334182887, -38.075628738105664, -19.144688093299, -19.53023229222223, -21.210273674090764, -46.5606653172767, -40.79653364432326, -38.0701986660726, -18.061437576943714, -10.086063098417931, -22.08377741122029, -29.713465755736873, -3.1264570045392714, -38.712081032596984, -24.71783583034225, -20.41320000320958, -43.491515918809085, -19.70531238831454, -23.778943217672325, -30.743601285595854, -34.651972253637524, -27.604779944617075, -45.40373522894289, -3.050470986265102, -39.35669417496017, -19.292860852239798, -2.313470685041178, -16.189291066146907, -28.789735531321934, -26.312650746328217, -18.725905228311063, -28.938338438743827, -28.12347754152367, -10.743316804656708, -27.407260177700906, -24.763317982748283, -10.20871592819244, -31.633552169664767, -4.845996336433416, -39.045630839044506, -13.05860386451091, -3.9599967262165867, -7.793465328756714, -18.294292232468077, -18.62259509537857, -12.467865316773056, -25.083229133423266, -18.371264225450542, -34.33611367906768, -15.7449854452201, -32.23587225175914, -31.435728886367457, -31.866411018895107, -40.128018254381615, -37.093964403427236, -51.826291742461734, -27.387267607083892, -20.852966704310397, -14.661093464422933, -24.835196842076147, -28.53427196497292, -19.57391064374147, -26.762152334499902, -34.21462126538992, -19.86542299839449, -3.433773154909936, -17.27539423434425, -25.408084463028164, -35.085260009150055, -39.04500561359296, -40.47597388433184, -22.93067546581531, -21.843758339441337, -28.812786979748445, -23.6271091029861, -42.849560250588766, -16.95849380671437, -38.65398446835984, -35.24071222558682], "policy_predator_policy_reward": [40.86667899945003, 36.58386498758507, 7.555365610127753, 18.260911036144975, 38.48484875741808, 42.45366548344764, 30.683886924814647, 31.130487943275668, 32.42055048459499, 31.313610322193824, 34.60287083522847, 28.4896616452895, 22.04221029736482, 7.765182655601753, 16.547117236467226, 24.625343578073167, 12.095223007613978, 30.720454880984878, 18.324691372399208, 27.364518259113005, 22.305507839037226, 0.9611871334182887, 38.075628738105664, 19.144688093299, 19.53023229222223, 21.210273674090764, 46.5606653172767, 40.79653364432326, 38.0701986660726, 18.061437576943714, 10.086063098417931, 22.08377741122029, 29.713465755736873, 3.1264570045392714, 38.712081032596984, 24.71783583034225, 20.41320000320958, 43.491515918809085, 19.70531238831454, 23.778943217672325, 30.743601285595854, 34.651972253637524, 27.604779944617075, 45.40373522894289, 3.050470986265102, 39.35669417496017, 19.292860852239798, 2.313470685041178, 16.189291066146907, 28.789735531321934, 26.312650746328217, 18.725905228311063, 28.938338438743827, 28.12347754152367, 10.743316804656708, 27.407260177700906, 24.763317982748283, 10.20871592819244, 31.633552169664767, 4.845996336433416, 39.045630839044506, 13.05860386451091, 3.9599967262165867, 7.793465328756714, 18.294292232468077, 18.62259509537857, 12.467865316773056, 25.083229133423266, 18.371264225450542, 34.33611367906768, 15.7449854452201, 32.23587225175914, 31.435728886367457, 31.866411018895107, 40.128018254381615, 37.093964403427236, 51.826291742461734, 27.387267607083892, 20.852966704310397, 14.661093464422933, 24.835196842076147, 28.53427196497292, 19.57391064374147, 26.762152334499902, 34.21462126538992, 19.86542299839449, 3.433773154909936, 17.27539423434425, 25.408084463028164, 35.085260009150055, 39.04500561359296, 40.47597388433184, 22.93067546581531, 21.843758339441337, 28.812786979748445, 23.6271091029861, 42.849560250588766, 16.95849380671437, 38.65398446835984, 35.24071222558682]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2902230527353867, "mean_inference_ms": 0.9543872275714448, "mean_action_processing_ms": 0.1266641462808288, "mean_env_wait_ms": 0.06918985170863955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029369592666625977, "StateBufferConnector_ms": 0.0023834705352783203, "ViewRequirementAgentConnector_ms": 0.05159008502960205}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 709.1235300363226, "num_env_steps_trained_throughput_per_sec": 709.1235300363226, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 5643.131, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5643.085, "sample_time_ms": 677.723, "learn_time_ms": 4951.738, "learn_throughput": 807.797, "synch_weights_time_ms": 13.226}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "training_iteration": 43, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-58-40", "timestamp": 1723395520, "time_this_iter_s": 5.646186828613281, "time_total_s": 238.51129746437073, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78231f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 238.51129746437073, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 32.6, "ram_util_percent": 82.88749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6819751506205648, "cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.22280491583514958, "policy_loss": -0.0016791492695726145, "vf_loss": 0.2244840639779189, "vf_explained_var": 0.8321003797774513, "kl": 0.003290228785741282, "entropy": 0.8326763899375995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.987110278243199, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.23189160932955322, "policy_loss": -0.01116778623108985, "vf_loss": 0.2429908046227259, "vf_explained_var": 0.770435735459129, "kl": 0.005487284810468888, "entropy": 1.4509550717969735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.826291742461734, "predator_policy": 0.012650213639929131}, "policy_reward_max": {"prey_policy": -0.012650213639929131, "predator_policy": 51.826291742461734}, "policy_reward_mean": {"prey_policy": -24.39412761515046, "predator_policy": 24.39412761515046}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-31.313610322193824, -34.60287083522847, -28.4896616452895, -22.04221029736482, -7.765182655601753, -16.547117236467226, -24.625343578073167, -12.095223007613978, -30.720454880984878, -18.324691372399208, -27.364518259113005, -22.305507839037226, -0.9611871334182887, -38.075628738105664, -19.144688093299, -19.53023229222223, -21.210273674090764, -46.5606653172767, -40.79653364432326, -38.0701986660726, -18.061437576943714, -10.086063098417931, -22.08377741122029, -29.713465755736873, -3.1264570045392714, -38.712081032596984, -24.71783583034225, -20.41320000320958, -43.491515918809085, -19.70531238831454, -23.778943217672325, -30.743601285595854, -34.651972253637524, -27.604779944617075, -45.40373522894289, -3.050470986265102, -39.35669417496017, -19.292860852239798, -2.313470685041178, -16.189291066146907, -28.789735531321934, -26.312650746328217, -18.725905228311063, -28.938338438743827, -28.12347754152367, -10.743316804656708, -27.407260177700906, -24.763317982748283, -10.20871592819244, -31.633552169664767, -4.845996336433416, -39.045630839044506, -13.05860386451091, -3.9599967262165867, -7.793465328756714, -18.294292232468077, -18.62259509537857, -12.467865316773056, -25.083229133423266, -18.371264225450542, -34.33611367906768, -15.7449854452201, -32.23587225175914, -31.435728886367457, -31.866411018895107, -40.128018254381615, -37.093964403427236, -51.826291742461734, -27.387267607083892, -20.852966704310397, -14.661093464422933, -24.835196842076147, -28.53427196497292, -19.57391064374147, -26.762152334499902, -34.21462126538992, -19.86542299839449, -3.433773154909936, -17.27539423434425, -25.408084463028164, -35.085260009150055, -39.04500561359296, -40.47597388433184, -22.93067546581531, -21.843758339441337, -28.812786979748445, -23.6271091029861, -42.849560250588766, -16.95849380671437, -38.65398446835984, -35.24071222558682, -22.52949202045841, -17.582275429700715, -29.083087273900603, -23.955673945378642, -24.3801062582327, -12.602240893119825, -33.951827138336895, -0.012650213639929131, -22.088571986135584], "policy_predator_policy_reward": [31.313610322193824, 34.60287083522847, 28.4896616452895, 22.04221029736482, 7.765182655601753, 16.547117236467226, 24.625343578073167, 12.095223007613978, 30.720454880984878, 18.324691372399208, 27.364518259113005, 22.305507839037226, 0.9611871334182887, 38.075628738105664, 19.144688093299, 19.53023229222223, 21.210273674090764, 46.5606653172767, 40.79653364432326, 38.0701986660726, 18.061437576943714, 10.086063098417931, 22.08377741122029, 29.713465755736873, 3.1264570045392714, 38.712081032596984, 24.71783583034225, 20.41320000320958, 43.491515918809085, 19.70531238831454, 23.778943217672325, 30.743601285595854, 34.651972253637524, 27.604779944617075, 45.40373522894289, 3.050470986265102, 39.35669417496017, 19.292860852239798, 2.313470685041178, 16.189291066146907, 28.789735531321934, 26.312650746328217, 18.725905228311063, 28.938338438743827, 28.12347754152367, 10.743316804656708, 27.407260177700906, 24.763317982748283, 10.20871592819244, 31.633552169664767, 4.845996336433416, 39.045630839044506, 13.05860386451091, 3.9599967262165867, 7.793465328756714, 18.294292232468077, 18.62259509537857, 12.467865316773056, 25.083229133423266, 18.371264225450542, 34.33611367906768, 15.7449854452201, 32.23587225175914, 31.435728886367457, 31.866411018895107, 40.128018254381615, 37.093964403427236, 51.826291742461734, 27.387267607083892, 20.852966704310397, 14.661093464422933, 24.835196842076147, 28.53427196497292, 19.57391064374147, 26.762152334499902, 34.21462126538992, 19.86542299839449, 3.433773154909936, 17.27539423434425, 25.408084463028164, 35.085260009150055, 39.04500561359296, 40.47597388433184, 22.93067546581531, 21.843758339441337, 28.812786979748445, 23.6271091029861, 42.849560250588766, 16.95849380671437, 38.65398446835984, 35.24071222558682, 22.52949202045841, 17.582275429700715, 29.083087273900603, 23.955673945378642, 24.3801062582327, 12.602240893119825, 33.951827138336895, 0.012650213639929131, 22.088571986135584]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28989644828944755, "mean_inference_ms": 0.9531407250248276, "mean_action_processing_ms": 0.1265626958556621, "mean_env_wait_ms": 0.0690703936443247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029636621475219727, "StateBufferConnector_ms": 0.0023621320724487305, "ViewRequirementAgentConnector_ms": 0.05196726322174072}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 716.2746852650058, "num_env_steps_trained_throughput_per_sec": 716.2746852650058, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 5648.058, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5648.014, "sample_time_ms": 672.606, "learn_time_ms": 4961.757, "learn_throughput": 806.166, "synch_weights_time_ms": 13.265}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 44, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-58-45", "timestamp": 1723395525, "time_this_iter_s": 5.590205907821655, "time_total_s": 244.10150337219238, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78e1670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 244.10150337219238, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 36.175, "ram_util_percent": 82.4625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6951227956994747, "cur_kl_coeff": 9.536743164062502e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.13332497128164203, "policy_loss": -0.006290181759201611, "vf_loss": 0.13961515288683585, "vf_explained_var": 0.7630230884999036, "kl": 0.004364372310909189, "entropy": 0.8202860579515497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9783512144504736, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.13855541186315654, "policy_loss": -0.0028885592427589776, "vf_loss": 0.14140517842994693, "vf_explained_var": 0.7459813427180052, "kl": 0.0031033449091570613, "entropy": 1.4236941476662954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.826291742461734, "predator_policy": 0.012650213639929131}, "policy_reward_max": {"prey_policy": -0.012650213639929131, "predator_policy": 51.826291742461734}, "policy_reward_mean": {"prey_policy": -24.16396651035636, "predator_policy": 24.16396651035636}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-7.765182655601753, -16.547117236467226, -24.625343578073167, -12.095223007613978, -30.720454880984878, -18.324691372399208, -27.364518259113005, -22.305507839037226, -0.9611871334182887, -38.075628738105664, -19.144688093299, -19.53023229222223, -21.210273674090764, -46.5606653172767, -40.79653364432326, -38.0701986660726, -18.061437576943714, -10.086063098417931, -22.08377741122029, -29.713465755736873, -3.1264570045392714, -38.712081032596984, -24.71783583034225, -20.41320000320958, -43.491515918809085, -19.70531238831454, -23.778943217672325, -30.743601285595854, -34.651972253637524, -27.604779944617075, -45.40373522894289, -3.050470986265102, -39.35669417496017, -19.292860852239798, -2.313470685041178, -16.189291066146907, -28.789735531321934, -26.312650746328217, -18.725905228311063, -28.938338438743827, -28.12347754152367, -10.743316804656708, -27.407260177700906, -24.763317982748283, -10.20871592819244, -31.633552169664767, -4.845996336433416, -39.045630839044506, -13.05860386451091, -3.9599967262165867, -7.793465328756714, -18.294292232468077, -18.62259509537857, -12.467865316773056, -25.083229133423266, -18.371264225450542, -34.33611367906768, -15.7449854452201, -32.23587225175914, -31.435728886367457, -31.866411018895107, -40.128018254381615, -37.093964403427236, -51.826291742461734, -27.387267607083892, -20.852966704310397, -14.661093464422933, -24.835196842076147, -28.53427196497292, -19.57391064374147, -26.762152334499902, -34.21462126538992, -19.86542299839449, -3.433773154909936, -17.27539423434425, -25.408084463028164, -35.085260009150055, -39.04500561359296, -40.47597388433184, -22.93067546581531, -21.843758339441337, -28.812786979748445, -23.6271091029861, -42.849560250588766, -16.95849380671437, -38.65398446835984, -35.24071222558682, -22.52949202045841, -17.582275429700715, -29.083087273900603, -23.955673945378642, -24.3801062582327, -12.602240893119825, -33.951827138336895, -0.012650213639929131, -22.088571986135584, -24.319741714662317, -22.291808117435327, -15.880784080145526, -30.939908708422806], "policy_predator_policy_reward": [7.765182655601753, 16.547117236467226, 24.625343578073167, 12.095223007613978, 30.720454880984878, 18.324691372399208, 27.364518259113005, 22.305507839037226, 0.9611871334182887, 38.075628738105664, 19.144688093299, 19.53023229222223, 21.210273674090764, 46.5606653172767, 40.79653364432326, 38.0701986660726, 18.061437576943714, 10.086063098417931, 22.08377741122029, 29.713465755736873, 3.1264570045392714, 38.712081032596984, 24.71783583034225, 20.41320000320958, 43.491515918809085, 19.70531238831454, 23.778943217672325, 30.743601285595854, 34.651972253637524, 27.604779944617075, 45.40373522894289, 3.050470986265102, 39.35669417496017, 19.292860852239798, 2.313470685041178, 16.189291066146907, 28.789735531321934, 26.312650746328217, 18.725905228311063, 28.938338438743827, 28.12347754152367, 10.743316804656708, 27.407260177700906, 24.763317982748283, 10.20871592819244, 31.633552169664767, 4.845996336433416, 39.045630839044506, 13.05860386451091, 3.9599967262165867, 7.793465328756714, 18.294292232468077, 18.62259509537857, 12.467865316773056, 25.083229133423266, 18.371264225450542, 34.33611367906768, 15.7449854452201, 32.23587225175914, 31.435728886367457, 31.866411018895107, 40.128018254381615, 37.093964403427236, 51.826291742461734, 27.387267607083892, 20.852966704310397, 14.661093464422933, 24.835196842076147, 28.53427196497292, 19.57391064374147, 26.762152334499902, 34.21462126538992, 19.86542299839449, 3.433773154909936, 17.27539423434425, 25.408084463028164, 35.085260009150055, 39.04500561359296, 40.47597388433184, 22.93067546581531, 21.843758339441337, 28.812786979748445, 23.6271091029861, 42.849560250588766, 16.95849380671437, 38.65398446835984, 35.24071222558682, 22.52949202045841, 17.582275429700715, 29.083087273900603, 23.955673945378642, 24.3801062582327, 12.602240893119825, 33.951827138336895, 0.012650213639929131, 22.088571986135584, 24.319741714662317, 22.291808117435327, 15.880784080145526, 30.939908708422806]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28969289584880575, "mean_inference_ms": 0.9524444711845527, "mean_action_processing_ms": 0.12646259467767781, "mean_env_wait_ms": 0.06899946812283997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002972245216369629, "StateBufferConnector_ms": 0.0023604631423950195, "ViewRequirementAgentConnector_ms": 0.05214667320251465}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 736.3909984393206, "num_env_steps_trained_throughput_per_sec": 736.3909984393206, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 5641.366, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5641.324, "sample_time_ms": 670.902, "learn_time_ms": 4956.609, "learn_throughput": 807.003, "synch_weights_time_ms": 13.474}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 45, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-58-51", "timestamp": 1723395531, "time_this_iter_s": 5.43607497215271, "time_total_s": 249.5375783443451, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2f940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 249.5375783443451, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 27.8625, "ram_util_percent": 82.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0598746377509087, "cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2129961863354159, "policy_loss": -0.0026936943822268708, "vf_loss": 0.2156898807908874, "vf_explained_var": 0.9476008144517739, "kl": 0.002656922804075995, "entropy": 0.819691979388396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2547042479893813, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.17696352723698966, "policy_loss": -0.00879413791214271, "vf_loss": 0.18565208398116131, "vf_explained_var": 0.9667025571068127, "kl": 0.016892662944286447, "entropy": 1.425443770736456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.826291742461734, "predator_policy": 0.012650213639929131}, "policy_reward_max": {"prey_policy": -0.012650213639929131, "predator_policy": 51.826291742461734}, "policy_reward_mean": {"prey_policy": -24.146703299817702, "predator_policy": 24.146703299817702}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-18.324691372399208, -27.364518259113005, -22.305507839037226, -0.9611871334182887, -38.075628738105664, -19.144688093299, -19.53023229222223, -21.210273674090764, -46.5606653172767, -40.79653364432326, -38.0701986660726, -18.061437576943714, -10.086063098417931, -22.08377741122029, -29.713465755736873, -3.1264570045392714, -38.712081032596984, -24.71783583034225, -20.41320000320958, -43.491515918809085, -19.70531238831454, -23.778943217672325, -30.743601285595854, -34.651972253637524, -27.604779944617075, -45.40373522894289, -3.050470986265102, -39.35669417496017, -19.292860852239798, -2.313470685041178, -16.189291066146907, -28.789735531321934, -26.312650746328217, -18.725905228311063, -28.938338438743827, -28.12347754152367, -10.743316804656708, -27.407260177700906, -24.763317982748283, -10.20871592819244, -31.633552169664767, -4.845996336433416, -39.045630839044506, -13.05860386451091, -3.9599967262165867, -7.793465328756714, -18.294292232468077, -18.62259509537857, -12.467865316773056, -25.083229133423266, -18.371264225450542, -34.33611367906768, -15.7449854452201, -32.23587225175914, -31.435728886367457, -31.866411018895107, -40.128018254381615, -37.093964403427236, -51.826291742461734, -27.387267607083892, -20.852966704310397, -14.661093464422933, -24.835196842076147, -28.53427196497292, -19.57391064374147, -26.762152334499902, -34.21462126538992, -19.86542299839449, -3.433773154909936, -17.27539423434425, -25.408084463028164, -35.085260009150055, -39.04500561359296, -40.47597388433184, -22.93067546581531, -21.843758339441337, -28.812786979748445, -23.6271091029861, -42.849560250588766, -16.95849380671437, -38.65398446835984, -35.24071222558682, -22.52949202045841, -17.582275429700715, -29.083087273900603, -23.955673945378642, -24.3801062582327, -12.602240893119825, -33.951827138336895, -0.012650213639929131, -22.088571986135584, -24.319741714662317, -22.291808117435327, -15.880784080145526, -30.939908708422806, -30.450500897077617, -14.282611147975743, -8.041966529914806, -26.97484632584302, -10.2770754040646], "policy_predator_policy_reward": [18.324691372399208, 27.364518259113005, 22.305507839037226, 0.9611871334182887, 38.075628738105664, 19.144688093299, 19.53023229222223, 21.210273674090764, 46.5606653172767, 40.79653364432326, 38.0701986660726, 18.061437576943714, 10.086063098417931, 22.08377741122029, 29.713465755736873, 3.1264570045392714, 38.712081032596984, 24.71783583034225, 20.41320000320958, 43.491515918809085, 19.70531238831454, 23.778943217672325, 30.743601285595854, 34.651972253637524, 27.604779944617075, 45.40373522894289, 3.050470986265102, 39.35669417496017, 19.292860852239798, 2.313470685041178, 16.189291066146907, 28.789735531321934, 26.312650746328217, 18.725905228311063, 28.938338438743827, 28.12347754152367, 10.743316804656708, 27.407260177700906, 24.763317982748283, 10.20871592819244, 31.633552169664767, 4.845996336433416, 39.045630839044506, 13.05860386451091, 3.9599967262165867, 7.793465328756714, 18.294292232468077, 18.62259509537857, 12.467865316773056, 25.083229133423266, 18.371264225450542, 34.33611367906768, 15.7449854452201, 32.23587225175914, 31.435728886367457, 31.866411018895107, 40.128018254381615, 37.093964403427236, 51.826291742461734, 27.387267607083892, 20.852966704310397, 14.661093464422933, 24.835196842076147, 28.53427196497292, 19.57391064374147, 26.762152334499902, 34.21462126538992, 19.86542299839449, 3.433773154909936, 17.27539423434425, 25.408084463028164, 35.085260009150055, 39.04500561359296, 40.47597388433184, 22.93067546581531, 21.843758339441337, 28.812786979748445, 23.6271091029861, 42.849560250588766, 16.95849380671437, 38.65398446835984, 35.24071222558682, 22.52949202045841, 17.582275429700715, 29.083087273900603, 23.955673945378642, 24.3801062582327, 12.602240893119825, 33.951827138336895, 0.012650213639929131, 22.088571986135584, 24.319741714662317, 22.291808117435327, 15.880784080145526, 30.939908708422806, 30.450500897077617, 14.282611147975743, 8.041966529914806, 26.97484632584302, 10.2770754040646]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2895832434214736, "mean_inference_ms": 0.9520578172025677, "mean_action_processing_ms": 0.12647786942910275, "mean_env_wait_ms": 0.06896131112517256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029774904251098633, "StateBufferConnector_ms": 0.002366185188293457, "ViewRequirementAgentConnector_ms": 0.05237734317779541}, "num_episodes": 5, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 700.5984930791055, "num_env_steps_trained_throughput_per_sec": 700.5984930791055, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 5649.007, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5648.964, "sample_time_ms": 667.434, "learn_time_ms": 4967.518, "learn_throughput": 805.231, "synch_weights_time_ms": 13.669}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 46, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-58-57", "timestamp": 1723395537, "time_this_iter_s": 5.714505910873413, "time_total_s": 255.2520842552185, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78231f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 255.2520842552185, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 29.862499999999997, "ram_util_percent": 82.5875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.043026618907849, "cur_kl_coeff": 2.3841857910156255e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.24431318691155562, "policy_loss": 0.00041642790796079984, "vf_loss": 0.24389675883964326, "vf_explained_var": 0.9223154864584406, "kl": 0.007984994556041096, "entropy": 0.8171866222595175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1788901876037319, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.20709576302272883, "policy_loss": -0.01359100875997683, "vf_loss": 0.22064663780814348, "vf_explained_var": 0.9226546455795567, "kl": 0.006421433774144312, "entropy": 1.4110926253100236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.826291742461734, "predator_policy": 0.012650213639929131}, "policy_reward_max": {"prey_policy": -0.012650213639929131, "predator_policy": 51.826291742461734}, "policy_reward_mean": {"prey_policy": -24.368518075127493, "predator_policy": 24.368518075127493}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-40.79653364432326, -38.0701986660726, -18.061437576943714, -10.086063098417931, -22.08377741122029, -29.713465755736873, -3.1264570045392714, -38.712081032596984, -24.71783583034225, -20.41320000320958, -43.491515918809085, -19.70531238831454, -23.778943217672325, -30.743601285595854, -34.651972253637524, -27.604779944617075, -45.40373522894289, -3.050470986265102, -39.35669417496017, -19.292860852239798, -2.313470685041178, -16.189291066146907, -28.789735531321934, -26.312650746328217, -18.725905228311063, -28.938338438743827, -28.12347754152367, -10.743316804656708, -27.407260177700906, -24.763317982748283, -10.20871592819244, -31.633552169664767, -4.845996336433416, -39.045630839044506, -13.05860386451091, -3.9599967262165867, -7.793465328756714, -18.294292232468077, -18.62259509537857, -12.467865316773056, -25.083229133423266, -18.371264225450542, -34.33611367906768, -15.7449854452201, -32.23587225175914, -31.435728886367457, -31.866411018895107, -40.128018254381615, -37.093964403427236, -51.826291742461734, -27.387267607083892, -20.852966704310397, -14.661093464422933, -24.835196842076147, -28.53427196497292, -19.57391064374147, -26.762152334499902, -34.21462126538992, -19.86542299839449, -3.433773154909936, -17.27539423434425, -25.408084463028164, -35.085260009150055, -39.04500561359296, -40.47597388433184, -22.93067546581531, -21.843758339441337, -28.812786979748445, -23.6271091029861, -42.849560250588766, -16.95849380671437, -38.65398446835984, -35.24071222558682, -22.52949202045841, -17.582275429700715, -29.083087273900603, -23.955673945378642, -24.3801062582327, -12.602240893119825, -33.951827138336895, -0.012650213639929131, -22.088571986135584, -24.319741714662317, -22.291808117435327, -15.880784080145526, -30.939908708422806, -30.450500897077617, -14.282611147975743, -8.041966529914806, -26.97484632584302, -10.2770754040646, -33.37724646965708, -24.622260706022498, -19.66973631015792, -24.886446946383753, -9.022837496283762, -8.235634060402758, -49.63388616598074, -32.95012423681155, -33.26069785824188], "policy_predator_policy_reward": [40.79653364432326, 38.0701986660726, 18.061437576943714, 10.086063098417931, 22.08377741122029, 29.713465755736873, 3.1264570045392714, 38.712081032596984, 24.71783583034225, 20.41320000320958, 43.491515918809085, 19.70531238831454, 23.778943217672325, 30.743601285595854, 34.651972253637524, 27.604779944617075, 45.40373522894289, 3.050470986265102, 39.35669417496017, 19.292860852239798, 2.313470685041178, 16.189291066146907, 28.789735531321934, 26.312650746328217, 18.725905228311063, 28.938338438743827, 28.12347754152367, 10.743316804656708, 27.407260177700906, 24.763317982748283, 10.20871592819244, 31.633552169664767, 4.845996336433416, 39.045630839044506, 13.05860386451091, 3.9599967262165867, 7.793465328756714, 18.294292232468077, 18.62259509537857, 12.467865316773056, 25.083229133423266, 18.371264225450542, 34.33611367906768, 15.7449854452201, 32.23587225175914, 31.435728886367457, 31.866411018895107, 40.128018254381615, 37.093964403427236, 51.826291742461734, 27.387267607083892, 20.852966704310397, 14.661093464422933, 24.835196842076147, 28.53427196497292, 19.57391064374147, 26.762152334499902, 34.21462126538992, 19.86542299839449, 3.433773154909936, 17.27539423434425, 25.408084463028164, 35.085260009150055, 39.04500561359296, 40.47597388433184, 22.93067546581531, 21.843758339441337, 28.812786979748445, 23.6271091029861, 42.849560250588766, 16.95849380671437, 38.65398446835984, 35.24071222558682, 22.52949202045841, 17.582275429700715, 29.083087273900603, 23.955673945378642, 24.3801062582327, 12.602240893119825, 33.951827138336895, 0.012650213639929131, 22.088571986135584, 24.319741714662317, 22.291808117435327, 15.880784080145526, 30.939908708422806, 30.450500897077617, 14.282611147975743, 8.041966529914806, 26.97484632584302, 10.2770754040646, 33.37724646965708, 24.622260706022498, 19.66973631015792, 24.886446946383753, 9.022837496283762, 8.235634060402758, 49.63388616598074, 32.95012423681155, 33.26069785824188]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28927527907117295, "mean_inference_ms": 0.9511488080312737, "mean_action_processing_ms": 0.12640989340457606, "mean_env_wait_ms": 0.06886413130708992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002931833267211914, "StateBufferConnector_ms": 0.002300739288330078, "ViewRequirementAgentConnector_ms": 0.05289614200592041}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 695.236944408116, "num_env_steps_trained_throughput_per_sec": 695.236944408116, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 5661.824, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5661.783, "sample_time_ms": 668.626, "learn_time_ms": 4979.105, "learn_throughput": 803.357, "synch_weights_time_ms": 13.662}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "training_iteration": 47, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-59-02", "timestamp": 1723395542, "time_this_iter_s": 5.758074998855591, "time_total_s": 261.0101592540741, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7887670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 261.0101592540741, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 32.387499999999996, "ram_util_percent": 82.5375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9424649746157229, "cur_kl_coeff": 2.3841857910156255e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.20778510354988006, "policy_loss": -0.001987235000221214, "vf_loss": 0.20977233786446353, "vf_explained_var": 0.9457602160051465, "kl": 0.005946221184473211, "entropy": 0.7722610664864381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1246978617894152, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.14954707020863983, "policy_loss": -0.012856182341420209, "vf_loss": 0.16236311702135328, "vf_explained_var": 0.9734657921517889, "kl": 0.006421516017044114, "entropy": 1.344733423491319, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.826291742461734, "predator_policy": 0.012650213639929131}, "policy_reward_max": {"prey_policy": -0.012650213639929131, "predator_policy": 51.826291742461734}, "policy_reward_mean": {"prey_policy": -24.622281120842775, "predator_policy": 24.622281120842775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-20.41320000320958, -43.491515918809085, -19.70531238831454, -23.778943217672325, -30.743601285595854, -34.651972253637524, -27.604779944617075, -45.40373522894289, -3.050470986265102, -39.35669417496017, -19.292860852239798, -2.313470685041178, -16.189291066146907, -28.789735531321934, -26.312650746328217, -18.725905228311063, -28.938338438743827, -28.12347754152367, -10.743316804656708, -27.407260177700906, -24.763317982748283, -10.20871592819244, -31.633552169664767, -4.845996336433416, -39.045630839044506, -13.05860386451091, -3.9599967262165867, -7.793465328756714, -18.294292232468077, -18.62259509537857, -12.467865316773056, -25.083229133423266, -18.371264225450542, -34.33611367906768, -15.7449854452201, -32.23587225175914, -31.435728886367457, -31.866411018895107, -40.128018254381615, -37.093964403427236, -51.826291742461734, -27.387267607083892, -20.852966704310397, -14.661093464422933, -24.835196842076147, -28.53427196497292, -19.57391064374147, -26.762152334499902, -34.21462126538992, -19.86542299839449, -3.433773154909936, -17.27539423434425, -25.408084463028164, -35.085260009150055, -39.04500561359296, -40.47597388433184, -22.93067546581531, -21.843758339441337, -28.812786979748445, -23.6271091029861, -42.849560250588766, -16.95849380671437, -38.65398446835984, -35.24071222558682, -22.52949202045841, -17.582275429700715, -29.083087273900603, -23.955673945378642, -24.3801062582327, -12.602240893119825, -33.951827138336895, -0.012650213639929131, -22.088571986135584, -24.319741714662317, -22.291808117435327, -15.880784080145526, -30.939908708422806, -30.450500897077617, -14.282611147975743, -8.041966529914806, -26.97484632584302, -10.2770754040646, -33.37724646965708, -24.622260706022498, -19.66973631015792, -24.886446946383753, -9.022837496283762, -8.235634060402758, -49.63388616598074, -32.95012423681155, -33.26069785824188, -40.18115686078791, -26.528164671115274, -15.909623717462956, -19.38971279501839, -30.828232605738403, -28.35064772271743, -34.18622254208536, -22.177434059659493, -33.19295961713598], "policy_predator_policy_reward": [20.41320000320958, 43.491515918809085, 19.70531238831454, 23.778943217672325, 30.743601285595854, 34.651972253637524, 27.604779944617075, 45.40373522894289, 3.050470986265102, 39.35669417496017, 19.292860852239798, 2.313470685041178, 16.189291066146907, 28.789735531321934, 26.312650746328217, 18.725905228311063, 28.938338438743827, 28.12347754152367, 10.743316804656708, 27.407260177700906, 24.763317982748283, 10.20871592819244, 31.633552169664767, 4.845996336433416, 39.045630839044506, 13.05860386451091, 3.9599967262165867, 7.793465328756714, 18.294292232468077, 18.62259509537857, 12.467865316773056, 25.083229133423266, 18.371264225450542, 34.33611367906768, 15.7449854452201, 32.23587225175914, 31.435728886367457, 31.866411018895107, 40.128018254381615, 37.093964403427236, 51.826291742461734, 27.387267607083892, 20.852966704310397, 14.661093464422933, 24.835196842076147, 28.53427196497292, 19.57391064374147, 26.762152334499902, 34.21462126538992, 19.86542299839449, 3.433773154909936, 17.27539423434425, 25.408084463028164, 35.085260009150055, 39.04500561359296, 40.47597388433184, 22.93067546581531, 21.843758339441337, 28.812786979748445, 23.6271091029861, 42.849560250588766, 16.95849380671437, 38.65398446835984, 35.24071222558682, 22.52949202045841, 17.582275429700715, 29.083087273900603, 23.955673945378642, 24.3801062582327, 12.602240893119825, 33.951827138336895, 0.012650213639929131, 22.088571986135584, 24.319741714662317, 22.291808117435327, 15.880784080145526, 30.939908708422806, 30.450500897077617, 14.282611147975743, 8.041966529914806, 26.97484632584302, 10.2770754040646, 33.37724646965708, 24.622260706022498, 19.66973631015792, 24.886446946383753, 9.022837496283762, 8.235634060402758, 49.63388616598074, 32.95012423681155, 33.26069785824188, 40.18115686078791, 26.528164671115274, 15.909623717462956, 19.38971279501839, 30.828232605738403, 28.35064772271743, 34.18622254208536, 22.177434059659493, 33.19295961713598]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28890397621311725, "mean_inference_ms": 0.9501788609958562, "mean_action_processing_ms": 0.1263363984291989, "mean_env_wait_ms": 0.06876263921435732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029271841049194336, "StateBufferConnector_ms": 0.002295255661010742, "ViewRequirementAgentConnector_ms": 0.05362749099731445}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 710.4475177362928, "num_env_steps_trained_throughput_per_sec": 710.4475177362928, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 5660.836, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5660.795, "sample_time_ms": 668.416, "learn_time_ms": 4978.303, "learn_throughput": 803.487, "synch_weights_time_ms": 13.682}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 48, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-59-08", "timestamp": 1723395548, "time_this_iter_s": 5.63504695892334, "time_total_s": 266.64520621299744, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7854e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 266.64520621299744, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 29.9125, "ram_util_percent": 82.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8918634492127846, "cur_kl_coeff": 2.3841857910156255e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4344043315233042, "policy_loss": -0.0012701807468450473, "vf_loss": 0.43567451103202376, "vf_explained_var": 0.707008152268827, "kl": 0.004773577602323733, "entropy": 0.7358473700160781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2880244623869657, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4286497421535387, "policy_loss": -0.013319735171777817, "vf_loss": 0.4419341441360302, "vf_explained_var": 0.832101113597552, "kl": 0.005653314844677008, "entropy": 1.3524516722808282, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.826291742461734, "predator_policy": 0.012650213639929131}, "policy_reward_max": {"prey_policy": -0.012650213639929131, "predator_policy": 51.826291742461734}, "policy_reward_mean": {"prey_policy": -24.237463758734883, "predator_policy": 24.237463758734883}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-39.35669417496017, -19.292860852239798, -2.313470685041178, -16.189291066146907, -28.789735531321934, -26.312650746328217, -18.725905228311063, -28.938338438743827, -28.12347754152367, -10.743316804656708, -27.407260177700906, -24.763317982748283, -10.20871592819244, -31.633552169664767, -4.845996336433416, -39.045630839044506, -13.05860386451091, -3.9599967262165867, -7.793465328756714, -18.294292232468077, -18.62259509537857, -12.467865316773056, -25.083229133423266, -18.371264225450542, -34.33611367906768, -15.7449854452201, -32.23587225175914, -31.435728886367457, -31.866411018895107, -40.128018254381615, -37.093964403427236, -51.826291742461734, -27.387267607083892, -20.852966704310397, -14.661093464422933, -24.835196842076147, -28.53427196497292, -19.57391064374147, -26.762152334499902, -34.21462126538992, -19.86542299839449, -3.433773154909936, -17.27539423434425, -25.408084463028164, -35.085260009150055, -39.04500561359296, -40.47597388433184, -22.93067546581531, -21.843758339441337, -28.812786979748445, -23.6271091029861, -42.849560250588766, -16.95849380671437, -38.65398446835984, -35.24071222558682, -22.52949202045841, -17.582275429700715, -29.083087273900603, -23.955673945378642, -24.3801062582327, -12.602240893119825, -33.951827138336895, -0.012650213639929131, -22.088571986135584, -24.319741714662317, -22.291808117435327, -15.880784080145526, -30.939908708422806, -30.450500897077617, -14.282611147975743, -8.041966529914806, -26.97484632584302, -10.2770754040646, -33.37724646965708, -24.622260706022498, -19.66973631015792, -24.886446946383753, -9.022837496283762, -8.235634060402758, -49.63388616598074, -32.95012423681155, -33.26069785824188, -40.18115686078791, -26.528164671115274, -15.909623717462956, -19.38971279501839, -30.828232605738403, -28.35064772271743, -34.18622254208536, -22.177434059659493, -33.19295961713598, -14.721466350839567, -25.31749729983064, -10.180708202813223, -12.632068976899134, -38.24543404459634, -25.293618734634155, -24.896253544747452, -41.33339499065545, -17.741352871258517], "policy_predator_policy_reward": [39.35669417496017, 19.292860852239798, 2.313470685041178, 16.189291066146907, 28.789735531321934, 26.312650746328217, 18.725905228311063, 28.938338438743827, 28.12347754152367, 10.743316804656708, 27.407260177700906, 24.763317982748283, 10.20871592819244, 31.633552169664767, 4.845996336433416, 39.045630839044506, 13.05860386451091, 3.9599967262165867, 7.793465328756714, 18.294292232468077, 18.62259509537857, 12.467865316773056, 25.083229133423266, 18.371264225450542, 34.33611367906768, 15.7449854452201, 32.23587225175914, 31.435728886367457, 31.866411018895107, 40.128018254381615, 37.093964403427236, 51.826291742461734, 27.387267607083892, 20.852966704310397, 14.661093464422933, 24.835196842076147, 28.53427196497292, 19.57391064374147, 26.762152334499902, 34.21462126538992, 19.86542299839449, 3.433773154909936, 17.27539423434425, 25.408084463028164, 35.085260009150055, 39.04500561359296, 40.47597388433184, 22.93067546581531, 21.843758339441337, 28.812786979748445, 23.6271091029861, 42.849560250588766, 16.95849380671437, 38.65398446835984, 35.24071222558682, 22.52949202045841, 17.582275429700715, 29.083087273900603, 23.955673945378642, 24.3801062582327, 12.602240893119825, 33.951827138336895, 0.012650213639929131, 22.088571986135584, 24.319741714662317, 22.291808117435327, 15.880784080145526, 30.939908708422806, 30.450500897077617, 14.282611147975743, 8.041966529914806, 26.97484632584302, 10.2770754040646, 33.37724646965708, 24.622260706022498, 19.66973631015792, 24.886446946383753, 9.022837496283762, 8.235634060402758, 49.63388616598074, 32.95012423681155, 33.26069785824188, 40.18115686078791, 26.528164671115274, 15.909623717462956, 19.38971279501839, 30.828232605738403, 28.35064772271743, 34.18622254208536, 22.177434059659493, 33.19295961713598, 14.721466350839567, 25.31749729983064, 10.180708202813223, 12.632068976899134, 38.24543404459634, 25.293618734634155, 24.896253544747452, 41.33339499065545, 17.741352871258517]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2885484043933954, "mean_inference_ms": 0.9491985925251873, "mean_action_processing_ms": 0.12625916203901125, "mean_env_wait_ms": 0.0686601680961258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028998851776123047, "StateBufferConnector_ms": 0.002274155616760254, "ViewRequirementAgentConnector_ms": 0.05325198173522949}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 681.4877892909292, "num_env_steps_trained_throughput_per_sec": 681.4877892909292, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 5687.03, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5686.984, "sample_time_ms": 673.995, "learn_time_ms": 4998.285, "learn_throughput": 800.274, "synch_weights_time_ms": 14.287}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "training_iteration": 49, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-59-14", "timestamp": 1723395554, "time_this_iter_s": 5.8745810985565186, "time_total_s": 272.51978731155396, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78878b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 272.51978731155396, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 31.333333333333332, "ram_util_percent": 82.64444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.003079850661258, "cur_kl_coeff": 1.1920928955078127e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.22637027064726378, "policy_loss": -0.0021166902440503082, "vf_loss": 0.22848696062574164, "vf_explained_var": 0.9089842543626825, "kl": 0.010514742785682518, "entropy": 0.7373034033924342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2403577870534113, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.24150509515945184, "policy_loss": -0.00871708125268924, "vf_loss": 0.2501493585878052, "vf_explained_var": 0.9591031869252523, "kl": 0.011650862966946453, "entropy": 1.3340915054082871, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.826291742461734, "predator_policy": 0.012650213639929131}, "policy_reward_max": {"prey_policy": -0.012650213639929131, "predator_policy": 51.826291742461734}, "policy_reward_mean": {"prey_policy": -25.11274180504878, "predator_policy": 25.11274180504878}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-10.743316804656708, -27.407260177700906, -24.763317982748283, -10.20871592819244, -31.633552169664767, -4.845996336433416, -39.045630839044506, -13.05860386451091, -3.9599967262165867, -7.793465328756714, -18.294292232468077, -18.62259509537857, -12.467865316773056, -25.083229133423266, -18.371264225450542, -34.33611367906768, -15.7449854452201, -32.23587225175914, -31.435728886367457, -31.866411018895107, -40.128018254381615, -37.093964403427236, -51.826291742461734, -27.387267607083892, -20.852966704310397, -14.661093464422933, -24.835196842076147, -28.53427196497292, -19.57391064374147, -26.762152334499902, -34.21462126538992, -19.86542299839449, -3.433773154909936, -17.27539423434425, -25.408084463028164, -35.085260009150055, -39.04500561359296, -40.47597388433184, -22.93067546581531, -21.843758339441337, -28.812786979748445, -23.6271091029861, -42.849560250588766, -16.95849380671437, -38.65398446835984, -35.24071222558682, -22.52949202045841, -17.582275429700715, -29.083087273900603, -23.955673945378642, -24.3801062582327, -12.602240893119825, -33.951827138336895, -0.012650213639929131, -22.088571986135584, -24.319741714662317, -22.291808117435327, -15.880784080145526, -30.939908708422806, -30.450500897077617, -14.282611147975743, -8.041966529914806, -26.97484632584302, -10.2770754040646, -33.37724646965708, -24.622260706022498, -19.66973631015792, -24.886446946383753, -9.022837496283762, -8.235634060402758, -49.63388616598074, -32.95012423681155, -33.26069785824188, -40.18115686078791, -26.528164671115274, -15.909623717462956, -19.38971279501839, -30.828232605738403, -28.35064772271743, -34.18622254208536, -22.177434059659493, -33.19295961713598, -14.721466350839567, -25.31749729983064, -10.180708202813223, -12.632068976899134, -38.24543404459634, -25.293618734634155, -24.896253544747452, -41.33339499065545, -17.741352871258517, -34.55488302643242, -44.36667856516549, -23.744494514986826, -18.666797341056547, -41.79682847089701, -43.953380252787326, -32.048237857523986, -19.693029349863735, -36.745899517293246], "policy_predator_policy_reward": [10.743316804656708, 27.407260177700906, 24.763317982748283, 10.20871592819244, 31.633552169664767, 4.845996336433416, 39.045630839044506, 13.05860386451091, 3.9599967262165867, 7.793465328756714, 18.294292232468077, 18.62259509537857, 12.467865316773056, 25.083229133423266, 18.371264225450542, 34.33611367906768, 15.7449854452201, 32.23587225175914, 31.435728886367457, 31.866411018895107, 40.128018254381615, 37.093964403427236, 51.826291742461734, 27.387267607083892, 20.852966704310397, 14.661093464422933, 24.835196842076147, 28.53427196497292, 19.57391064374147, 26.762152334499902, 34.21462126538992, 19.86542299839449, 3.433773154909936, 17.27539423434425, 25.408084463028164, 35.085260009150055, 39.04500561359296, 40.47597388433184, 22.93067546581531, 21.843758339441337, 28.812786979748445, 23.6271091029861, 42.849560250588766, 16.95849380671437, 38.65398446835984, 35.24071222558682, 22.52949202045841, 17.582275429700715, 29.083087273900603, 23.955673945378642, 24.3801062582327, 12.602240893119825, 33.951827138336895, 0.012650213639929131, 22.088571986135584, 24.319741714662317, 22.291808117435327, 15.880784080145526, 30.939908708422806, 30.450500897077617, 14.282611147975743, 8.041966529914806, 26.97484632584302, 10.2770754040646, 33.37724646965708, 24.622260706022498, 19.66973631015792, 24.886446946383753, 9.022837496283762, 8.235634060402758, 49.63388616598074, 32.95012423681155, 33.26069785824188, 40.18115686078791, 26.528164671115274, 15.909623717462956, 19.38971279501839, 30.828232605738403, 28.35064772271743, 34.18622254208536, 22.177434059659493, 33.19295961713598, 14.721466350839567, 25.31749729983064, 10.180708202813223, 12.632068976899134, 38.24543404459634, 25.293618734634155, 24.896253544747452, 41.33339499065545, 17.741352871258517, 34.55488302643242, 44.36667856516549, 23.744494514986826, 18.666797341056547, 41.79682847089701, 43.953380252787326, 32.048237857523986, 19.693029349863735, 36.745899517293246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.288238780962975, "mean_inference_ms": 0.9482210240137701, "mean_action_processing_ms": 0.1261801769546759, "mean_env_wait_ms": 0.0685590886717439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027583837509155273, "StateBufferConnector_ms": 0.0022379159927368164, "ViewRequirementAgentConnector_ms": 0.05255603790283203}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 729.6486024171294, "num_env_steps_trained_throughput_per_sec": 729.6486024171294, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 5657.837, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5657.79, "sample_time_ms": 664.255, "learn_time_ms": 4978.766, "learn_throughput": 803.412, "synch_weights_time_ms": 14.354}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 50, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-59-19", "timestamp": 1723395559, "time_this_iter_s": 5.486888885498047, "time_total_s": 278.006676197052, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7887670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 278.006676197052, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 28.25, "ram_util_percent": 82.8875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0065525851522883, "cur_kl_coeff": 1.1920928955078127e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2838615803513676, "policy_loss": -0.0008677822251532537, "vf_loss": 0.2847293630087127, "vf_explained_var": 0.9193927682315309, "kl": 0.004859618643703336, "entropy": 0.705818691290915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1956204829427104, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.29337275316537065, "policy_loss": -0.016391743605587785, "vf_loss": 0.30969362177420406, "vf_explained_var": 0.9226806158199906, "kl": 0.011340096380252695, "entropy": 1.358269496013721, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.826291742461734, "predator_policy": 0.012650213639929131}, "policy_reward_max": {"prey_policy": -0.012650213639929131, "predator_policy": 51.826291742461734}, "policy_reward_mean": {"prey_policy": -25.473751415160464, "predator_policy": 25.473751415160464}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-7.793465328756714, -18.294292232468077, -18.62259509537857, -12.467865316773056, -25.083229133423266, -18.371264225450542, -34.33611367906768, -15.7449854452201, -32.23587225175914, -31.435728886367457, -31.866411018895107, -40.128018254381615, -37.093964403427236, -51.826291742461734, -27.387267607083892, -20.852966704310397, -14.661093464422933, -24.835196842076147, -28.53427196497292, -19.57391064374147, -26.762152334499902, -34.21462126538992, -19.86542299839449, -3.433773154909936, -17.27539423434425, -25.408084463028164, -35.085260009150055, -39.04500561359296, -40.47597388433184, -22.93067546581531, -21.843758339441337, -28.812786979748445, -23.6271091029861, -42.849560250588766, -16.95849380671437, -38.65398446835984, -35.24071222558682, -22.52949202045841, -17.582275429700715, -29.083087273900603, -23.955673945378642, -24.3801062582327, -12.602240893119825, -33.951827138336895, -0.012650213639929131, -22.088571986135584, -24.319741714662317, -22.291808117435327, -15.880784080145526, -30.939908708422806, -30.450500897077617, -14.282611147975743, -8.041966529914806, -26.97484632584302, -10.2770754040646, -33.37724646965708, -24.622260706022498, -19.66973631015792, -24.886446946383753, -9.022837496283762, -8.235634060402758, -49.63388616598074, -32.95012423681155, -33.26069785824188, -40.18115686078791, -26.528164671115274, -15.909623717462956, -19.38971279501839, -30.828232605738403, -28.35064772271743, -34.18622254208536, -22.177434059659493, -33.19295961713598, -14.721466350839567, -25.31749729983064, -10.180708202813223, -12.632068976899134, -38.24543404459634, -25.293618734634155, -24.896253544747452, -41.33339499065545, -17.741352871258517, -34.55488302643242, -44.36667856516549, -23.744494514986826, -18.666797341056547, -41.79682847089701, -43.953380252787326, -32.048237857523986, -19.693029349863735, -36.745899517293246, -43.69867742563689, -1.2765732364327818, -16.935165599996214, -13.890926004327135, -26.797486846982864, -26.58117999913773, -30.639225215360828, -19.005015370144996, -22.943102142316953], "policy_predator_policy_reward": [7.793465328756714, 18.294292232468077, 18.62259509537857, 12.467865316773056, 25.083229133423266, 18.371264225450542, 34.33611367906768, 15.7449854452201, 32.23587225175914, 31.435728886367457, 31.866411018895107, 40.128018254381615, 37.093964403427236, 51.826291742461734, 27.387267607083892, 20.852966704310397, 14.661093464422933, 24.835196842076147, 28.53427196497292, 19.57391064374147, 26.762152334499902, 34.21462126538992, 19.86542299839449, 3.433773154909936, 17.27539423434425, 25.408084463028164, 35.085260009150055, 39.04500561359296, 40.47597388433184, 22.93067546581531, 21.843758339441337, 28.812786979748445, 23.6271091029861, 42.849560250588766, 16.95849380671437, 38.65398446835984, 35.24071222558682, 22.52949202045841, 17.582275429700715, 29.083087273900603, 23.955673945378642, 24.3801062582327, 12.602240893119825, 33.951827138336895, 0.012650213639929131, 22.088571986135584, 24.319741714662317, 22.291808117435327, 15.880784080145526, 30.939908708422806, 30.450500897077617, 14.282611147975743, 8.041966529914806, 26.97484632584302, 10.2770754040646, 33.37724646965708, 24.622260706022498, 19.66973631015792, 24.886446946383753, 9.022837496283762, 8.235634060402758, 49.63388616598074, 32.95012423681155, 33.26069785824188, 40.18115686078791, 26.528164671115274, 15.909623717462956, 19.38971279501839, 30.828232605738403, 28.35064772271743, 34.18622254208536, 22.177434059659493, 33.19295961713598, 14.721466350839567, 25.31749729983064, 10.180708202813223, 12.632068976899134, 38.24543404459634, 25.293618734634155, 24.896253544747452, 41.33339499065545, 17.741352871258517, 34.55488302643242, 44.36667856516549, 23.744494514986826, 18.666797341056547, 41.79682847089701, 43.953380252787326, 32.048237857523986, 19.693029349863735, 36.745899517293246, 43.69867742563689, 1.2765732364327818, 16.935165599996214, 13.890926004327135, 26.797486846982864, 26.58117999913773, 30.639225215360828, 19.005015370144996, 22.943102142316953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2879309941812996, "mean_inference_ms": 0.9471915345376342, "mean_action_processing_ms": 0.1260863675667897, "mean_env_wait_ms": 0.06845618675280718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00272369384765625, "StateBufferConnector_ms": 0.0021266937255859375, "ViewRequirementAgentConnector_ms": 0.05239999294281006}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 742.7172085631709, "num_env_steps_trained_throughput_per_sec": 742.7172085631709, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 5611.816, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5611.771, "sample_time_ms": 660.07, "learn_time_ms": 4937.052, "learn_throughput": 810.2, "synch_weights_time_ms": 14.247}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "training_iteration": 51, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-59-25", "timestamp": 1723395565, "time_this_iter_s": 5.391262054443359, "time_total_s": 283.39793825149536, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e083a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 283.39793825149536, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 30.085714285714285, "ram_util_percent": 82.82857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2573565058565388, "cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2825644271370644, "policy_loss": -0.0013263527536764741, "vf_loss": 0.28389078127608325, "vf_explained_var": 0.9440043196082115, "kl": 0.0054827087552794754, "entropy": 0.6525484576200445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3353500568928818, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3125477245847454, "policy_loss": -0.007180645603511948, "vf_loss": 0.3196931030252017, "vf_explained_var": 0.9312115533898274, "kl": 0.005642991601110674, "entropy": 1.3272188761581978, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.826291742461734, "predator_policy": 0.012650213639929131}, "policy_reward_max": {"prey_policy": -0.012650213639929131, "predator_policy": 51.826291742461734}, "policy_reward_mean": {"prey_policy": -25.863455738468282, "predator_policy": 25.863455738468282}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-31.435728886367457, -31.866411018895107, -40.128018254381615, -37.093964403427236, -51.826291742461734, -27.387267607083892, -20.852966704310397, -14.661093464422933, -24.835196842076147, -28.53427196497292, -19.57391064374147, -26.762152334499902, -34.21462126538992, -19.86542299839449, -3.433773154909936, -17.27539423434425, -25.408084463028164, -35.085260009150055, -39.04500561359296, -40.47597388433184, -22.93067546581531, -21.843758339441337, -28.812786979748445, -23.6271091029861, -42.849560250588766, -16.95849380671437, -38.65398446835984, -35.24071222558682, -22.52949202045841, -17.582275429700715, -29.083087273900603, -23.955673945378642, -24.3801062582327, -12.602240893119825, -33.951827138336895, -0.012650213639929131, -22.088571986135584, -24.319741714662317, -22.291808117435327, -15.880784080145526, -30.939908708422806, -30.450500897077617, -14.282611147975743, -8.041966529914806, -26.97484632584302, -10.2770754040646, -33.37724646965708, -24.622260706022498, -19.66973631015792, -24.886446946383753, -9.022837496283762, -8.235634060402758, -49.63388616598074, -32.95012423681155, -33.26069785824188, -40.18115686078791, -26.528164671115274, -15.909623717462956, -19.38971279501839, -30.828232605738403, -28.35064772271743, -34.18622254208536, -22.177434059659493, -33.19295961713598, -14.721466350839567, -25.31749729983064, -10.180708202813223, -12.632068976899134, -38.24543404459634, -25.293618734634155, -24.896253544747452, -41.33339499065545, -17.741352871258517, -34.55488302643242, -44.36667856516549, -23.744494514986826, -18.666797341056547, -41.79682847089701, -43.953380252787326, -32.048237857523986, -19.693029349863735, -36.745899517293246, -43.69867742563689, -1.2765732364327818, -16.935165599996214, -13.890926004327135, -26.797486846982864, -26.58117999913773, -30.639225215360828, -19.005015370144996, -22.943102142316953, -41.618250175842874, -6.379715459428439, -40.63894221081294, -11.652069104483576, -12.024532628949384, -39.479277465448604, -31.786442656707635, -21.428426110349424, -16.912459227056324], "policy_predator_policy_reward": [31.435728886367457, 31.866411018895107, 40.128018254381615, 37.093964403427236, 51.826291742461734, 27.387267607083892, 20.852966704310397, 14.661093464422933, 24.835196842076147, 28.53427196497292, 19.57391064374147, 26.762152334499902, 34.21462126538992, 19.86542299839449, 3.433773154909936, 17.27539423434425, 25.408084463028164, 35.085260009150055, 39.04500561359296, 40.47597388433184, 22.93067546581531, 21.843758339441337, 28.812786979748445, 23.6271091029861, 42.849560250588766, 16.95849380671437, 38.65398446835984, 35.24071222558682, 22.52949202045841, 17.582275429700715, 29.083087273900603, 23.955673945378642, 24.3801062582327, 12.602240893119825, 33.951827138336895, 0.012650213639929131, 22.088571986135584, 24.319741714662317, 22.291808117435327, 15.880784080145526, 30.939908708422806, 30.450500897077617, 14.282611147975743, 8.041966529914806, 26.97484632584302, 10.2770754040646, 33.37724646965708, 24.622260706022498, 19.66973631015792, 24.886446946383753, 9.022837496283762, 8.235634060402758, 49.63388616598074, 32.95012423681155, 33.26069785824188, 40.18115686078791, 26.528164671115274, 15.909623717462956, 19.38971279501839, 30.828232605738403, 28.35064772271743, 34.18622254208536, 22.177434059659493, 33.19295961713598, 14.721466350839567, 25.31749729983064, 10.180708202813223, 12.632068976899134, 38.24543404459634, 25.293618734634155, 24.896253544747452, 41.33339499065545, 17.741352871258517, 34.55488302643242, 44.36667856516549, 23.744494514986826, 18.666797341056547, 41.79682847089701, 43.953380252787326, 32.048237857523986, 19.693029349863735, 36.745899517293246, 43.69867742563689, 1.2765732364327818, 16.935165599996214, 13.890926004327135, 26.797486846982864, 26.58117999913773, 30.639225215360828, 19.005015370144996, 22.943102142316953, 41.618250175842874, 6.379715459428439, 40.63894221081294, 11.652069104483576, 12.024532628949384, 39.479277465448604, 31.786442656707635, 21.428426110349424, 16.912459227056324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2875610889808205, "mean_inference_ms": 0.9461426156354438, "mean_action_processing_ms": 0.12598814949407625, "mean_env_wait_ms": 0.06835007915859749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026360750198364258, "StateBufferConnector_ms": 0.0020334720611572266, "ViewRequirementAgentConnector_ms": 0.04899930953979492}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 656.31635034441, "num_env_steps_trained_throughput_per_sec": 656.31635034441, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 5658.215, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5658.174, "sample_time_ms": 655.532, "learn_time_ms": 4988.594, "learn_throughput": 801.829, "synch_weights_time_ms": 13.659}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 52, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-59-31", "timestamp": 1723395571, "time_this_iter_s": 6.100657939910889, "time_total_s": 289.49859619140625, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7854e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 289.49859619140625, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 31.84444444444445, "ram_util_percent": 83.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2156283976975828, "cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.15818627893699688, "policy_loss": -0.003665628284458459, "vf_loss": 0.16185190714119624, "vf_explained_var": 0.9838733987261852, "kl": 0.010187244348554614, "entropy": 0.6374192363582551, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.245828711024175, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1434025912785728, "policy_loss": -0.00503208448553778, "vf_loss": 0.14837118399445898, "vf_explained_var": 0.9865595961610476, "kl": 0.010158680268468013, "entropy": 1.3464699039856594, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.63388616598074, "predator_policy": 0.012650213639929131}, "policy_reward_max": {"prey_policy": -0.012650213639929131, "predator_policy": 49.63388616598074}, "policy_reward_mean": {"prey_policy": -25.191352946618796, "predator_policy": 25.191352946618796}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-28.53427196497292, -19.57391064374147, -26.762152334499902, -34.21462126538992, -19.86542299839449, -3.433773154909936, -17.27539423434425, -25.408084463028164, -35.085260009150055, -39.04500561359296, -40.47597388433184, -22.93067546581531, -21.843758339441337, -28.812786979748445, -23.6271091029861, -42.849560250588766, -16.95849380671437, -38.65398446835984, -35.24071222558682, -22.52949202045841, -17.582275429700715, -29.083087273900603, -23.955673945378642, -24.3801062582327, -12.602240893119825, -33.951827138336895, -0.012650213639929131, -22.088571986135584, -24.319741714662317, -22.291808117435327, -15.880784080145526, -30.939908708422806, -30.450500897077617, -14.282611147975743, -8.041966529914806, -26.97484632584302, -10.2770754040646, -33.37724646965708, -24.622260706022498, -19.66973631015792, -24.886446946383753, -9.022837496283762, -8.235634060402758, -49.63388616598074, -32.95012423681155, -33.26069785824188, -40.18115686078791, -26.528164671115274, -15.909623717462956, -19.38971279501839, -30.828232605738403, -28.35064772271743, -34.18622254208536, -22.177434059659493, -33.19295961713598, -14.721466350839567, -25.31749729983064, -10.180708202813223, -12.632068976899134, -38.24543404459634, -25.293618734634155, -24.896253544747452, -41.33339499065545, -17.741352871258517, -34.55488302643242, -44.36667856516549, -23.744494514986826, -18.666797341056547, -41.79682847089701, -43.953380252787326, -32.048237857523986, -19.693029349863735, -36.745899517293246, -43.69867742563689, -1.2765732364327818, -16.935165599996214, -13.890926004327135, -26.797486846982864, -26.58117999913773, -30.639225215360828, -19.005015370144996, -22.943102142316953, -41.618250175842874, -6.379715459428439, -40.63894221081294, -11.652069104483576, -12.024532628949384, -39.479277465448604, -31.786442656707635, -21.428426110349424, -16.912459227056324, -38.67346127170445, -29.206731733957803, -9.586628522470674, -40.77676615153024, -18.429226914955663, -6.883069055255438, -6.846660583172033, -40.862710795089654, -21.611404710341333], "policy_predator_policy_reward": [28.53427196497292, 19.57391064374147, 26.762152334499902, 34.21462126538992, 19.86542299839449, 3.433773154909936, 17.27539423434425, 25.408084463028164, 35.085260009150055, 39.04500561359296, 40.47597388433184, 22.93067546581531, 21.843758339441337, 28.812786979748445, 23.6271091029861, 42.849560250588766, 16.95849380671437, 38.65398446835984, 35.24071222558682, 22.52949202045841, 17.582275429700715, 29.083087273900603, 23.955673945378642, 24.3801062582327, 12.602240893119825, 33.951827138336895, 0.012650213639929131, 22.088571986135584, 24.319741714662317, 22.291808117435327, 15.880784080145526, 30.939908708422806, 30.450500897077617, 14.282611147975743, 8.041966529914806, 26.97484632584302, 10.2770754040646, 33.37724646965708, 24.622260706022498, 19.66973631015792, 24.886446946383753, 9.022837496283762, 8.235634060402758, 49.63388616598074, 32.95012423681155, 33.26069785824188, 40.18115686078791, 26.528164671115274, 15.909623717462956, 19.38971279501839, 30.828232605738403, 28.35064772271743, 34.18622254208536, 22.177434059659493, 33.19295961713598, 14.721466350839567, 25.31749729983064, 10.180708202813223, 12.632068976899134, 38.24543404459634, 25.293618734634155, 24.896253544747452, 41.33339499065545, 17.741352871258517, 34.55488302643242, 44.36667856516549, 23.744494514986826, 18.666797341056547, 41.79682847089701, 43.953380252787326, 32.048237857523986, 19.693029349863735, 36.745899517293246, 43.69867742563689, 1.2765732364327818, 16.935165599996214, 13.890926004327135, 26.797486846982864, 26.58117999913773, 30.639225215360828, 19.005015370144996, 22.943102142316953, 41.618250175842874, 6.379715459428439, 40.63894221081294, 11.652069104483576, 12.024532628949384, 39.479277465448604, 31.786442656707635, 21.428426110349424, 16.912459227056324, 38.67346127170445, 29.206731733957803, 9.586628522470674, 40.77676615153024, 18.429226914955663, 6.883069055255438, 6.846660583172033, 40.862710795089654, 21.611404710341333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28726335310485235, "mean_inference_ms": 0.9452722572766828, "mean_action_processing_ms": 0.1259091691189665, "mean_env_wait_ms": 0.06826149697753765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002573728561401367, "StateBufferConnector_ms": 0.002009272575378418, "ViewRequirementAgentConnector_ms": 0.04803335666656494}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 722.3261521711548, "num_env_steps_trained_throughput_per_sec": 722.3261521711548, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 424000, "timers": {"training_iteration_time_ms": 5647.905, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5647.865, "sample_time_ms": 661.426, "learn_time_ms": 4972.392, "learn_throughput": 804.442, "synch_weights_time_ms": 13.658}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "done": false, "training_iteration": 53, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-59-36", "timestamp": 1723395576, "time_this_iter_s": 5.542156934738159, "time_total_s": 295.0407531261444, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 295.0407531261444, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 28.85, "ram_util_percent": 83.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7235451631558438, "cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05680994241971623, "policy_loss": -0.0012509289882776406, "vf_loss": 0.05806087146823605, "vf_explained_var": 0.987332664616406, "kl": 0.003094888643435508, "entropy": 0.6598958456888795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8694646555309494, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05967184380655605, "policy_loss": -0.006234438429479875, "vf_loss": 0.06588185460035069, "vf_explained_var": 0.9822614437590043, "kl": 0.0039084292789227735, "entropy": 1.3344383500516415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.63388616598074, "predator_policy": 0.012650213639929131}, "policy_reward_max": {"prey_policy": -0.012650213639929131, "predator_policy": 49.63388616598074}, "policy_reward_mean": {"prey_policy": -25.23853210849372, "predator_policy": 25.23853210849372}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-19.86542299839449, -3.433773154909936, -17.27539423434425, -25.408084463028164, -35.085260009150055, -39.04500561359296, -40.47597388433184, -22.93067546581531, -21.843758339441337, -28.812786979748445, -23.6271091029861, -42.849560250588766, -16.95849380671437, -38.65398446835984, -35.24071222558682, -22.52949202045841, -17.582275429700715, -29.083087273900603, -23.955673945378642, -24.3801062582327, -12.602240893119825, -33.951827138336895, -0.012650213639929131, -22.088571986135584, -24.319741714662317, -22.291808117435327, -15.880784080145526, -30.939908708422806, -30.450500897077617, -14.282611147975743, -8.041966529914806, -26.97484632584302, -10.2770754040646, -33.37724646965708, -24.622260706022498, -19.66973631015792, -24.886446946383753, -9.022837496283762, -8.235634060402758, -49.63388616598074, -32.95012423681155, -33.26069785824188, -40.18115686078791, -26.528164671115274, -15.909623717462956, -19.38971279501839, -30.828232605738403, -28.35064772271743, -34.18622254208536, -22.177434059659493, -33.19295961713598, -14.721466350839567, -25.31749729983064, -10.180708202813223, -12.632068976899134, -38.24543404459634, -25.293618734634155, -24.896253544747452, -41.33339499065545, -17.741352871258517, -34.55488302643242, -44.36667856516549, -23.744494514986826, -18.666797341056547, -41.79682847089701, -43.953380252787326, -32.048237857523986, -19.693029349863735, -36.745899517293246, -43.69867742563689, -1.2765732364327818, -16.935165599996214, -13.890926004327135, -26.797486846982864, -26.58117999913773, -30.639225215360828, -19.005015370144996, -22.943102142316953, -41.618250175842874, -6.379715459428439, -40.63894221081294, -11.652069104483576, -12.024532628949384, -39.479277465448604, -31.786442656707635, -21.428426110349424, -16.912459227056324, -38.67346127170445, -29.206731733957803, -9.586628522470674, -40.77676615153024, -18.429226914955663, -6.883069055255438, -6.846660583172033, -40.862710795089654, -21.611404710341333, -28.979462680895114, -30.445357172281433, -38.13063363443832, -16.24741890848236], "policy_predator_policy_reward": [19.86542299839449, 3.433773154909936, 17.27539423434425, 25.408084463028164, 35.085260009150055, 39.04500561359296, 40.47597388433184, 22.93067546581531, 21.843758339441337, 28.812786979748445, 23.6271091029861, 42.849560250588766, 16.95849380671437, 38.65398446835984, 35.24071222558682, 22.52949202045841, 17.582275429700715, 29.083087273900603, 23.955673945378642, 24.3801062582327, 12.602240893119825, 33.951827138336895, 0.012650213639929131, 22.088571986135584, 24.319741714662317, 22.291808117435327, 15.880784080145526, 30.939908708422806, 30.450500897077617, 14.282611147975743, 8.041966529914806, 26.97484632584302, 10.2770754040646, 33.37724646965708, 24.622260706022498, 19.66973631015792, 24.886446946383753, 9.022837496283762, 8.235634060402758, 49.63388616598074, 32.95012423681155, 33.26069785824188, 40.18115686078791, 26.528164671115274, 15.909623717462956, 19.38971279501839, 30.828232605738403, 28.35064772271743, 34.18622254208536, 22.177434059659493, 33.19295961713598, 14.721466350839567, 25.31749729983064, 10.180708202813223, 12.632068976899134, 38.24543404459634, 25.293618734634155, 24.896253544747452, 41.33339499065545, 17.741352871258517, 34.55488302643242, 44.36667856516549, 23.744494514986826, 18.666797341056547, 41.79682847089701, 43.953380252787326, 32.048237857523986, 19.693029349863735, 36.745899517293246, 43.69867742563689, 1.2765732364327818, 16.935165599996214, 13.890926004327135, 26.797486846982864, 26.58117999913773, 30.639225215360828, 19.005015370144996, 22.943102142316953, 41.618250175842874, 6.379715459428439, 40.63894221081294, 11.652069104483576, 12.024532628949384, 39.479277465448604, 31.786442656707635, 21.428426110349424, 16.912459227056324, 38.67346127170445, 29.206731733957803, 9.586628522470674, 40.77676615153024, 18.429226914955663, 6.883069055255438, 6.846660583172033, 40.862710795089654, 21.611404710341333, 28.979462680895114, 30.445357172281433, 38.13063363443832, 16.24741890848236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2870467644115888, "mean_inference_ms": 0.944692264356543, "mean_action_processing_ms": 0.12581211308510995, "mean_env_wait_ms": 0.0681911441733198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025458335876464844, "StateBufferConnector_ms": 0.0019958019256591797, "ViewRequirementAgentConnector_ms": 0.048000216484069824}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 754.4655651410368, "num_env_steps_trained_throughput_per_sec": 754.4655651410368, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 5619.637, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5619.597, "sample_time_ms": 661.832, "learn_time_ms": 4943.751, "learn_throughput": 809.102, "synch_weights_time_ms": 13.629}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 54, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-59-42", "timestamp": 1723395582, "time_this_iter_s": 5.305756092071533, "time_total_s": 300.34650921821594, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2f280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 300.34650921821594, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 29.300000000000004, "ram_util_percent": 82.97142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8767543557099998, "cur_kl_coeff": 2.980232238769532e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09311917785781437, "policy_loss": -0.002270081673729389, "vf_loss": 0.09538925920884746, "vf_explained_var": 0.9882181527093052, "kl": 0.008220671034218632, "entropy": 0.5834091832861305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.000855538342148, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07359155247777001, "policy_loss": -0.014344890272453389, "vf_loss": 0.08789933336665853, "vf_explained_var": 0.9916731983423233, "kl": 0.011874900822113335, "entropy": 1.2563521696875493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.63388616598074, "predator_policy": 0.012650213639929131}, "policy_reward_max": {"prey_policy": -0.012650213639929131, "predator_policy": 49.63388616598074}, "policy_reward_mean": {"prey_policy": -25.049302604340536, "predator_policy": 25.049302604340536}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-39.04500561359296, -40.47597388433184, -22.93067546581531, -21.843758339441337, -28.812786979748445, -23.6271091029861, -42.849560250588766, -16.95849380671437, -38.65398446835984, -35.24071222558682, -22.52949202045841, -17.582275429700715, -29.083087273900603, -23.955673945378642, -24.3801062582327, -12.602240893119825, -33.951827138336895, -0.012650213639929131, -22.088571986135584, -24.319741714662317, -22.291808117435327, -15.880784080145526, -30.939908708422806, -30.450500897077617, -14.282611147975743, -8.041966529914806, -26.97484632584302, -10.2770754040646, -33.37724646965708, -24.622260706022498, -19.66973631015792, -24.886446946383753, -9.022837496283762, -8.235634060402758, -49.63388616598074, -32.95012423681155, -33.26069785824188, -40.18115686078791, -26.528164671115274, -15.909623717462956, -19.38971279501839, -30.828232605738403, -28.35064772271743, -34.18622254208536, -22.177434059659493, -33.19295961713598, -14.721466350839567, -25.31749729983064, -10.180708202813223, -12.632068976899134, -38.24543404459634, -25.293618734634155, -24.896253544747452, -41.33339499065545, -17.741352871258517, -34.55488302643242, -44.36667856516549, -23.744494514986826, -18.666797341056547, -41.79682847089701, -43.953380252787326, -32.048237857523986, -19.693029349863735, -36.745899517293246, -43.69867742563689, -1.2765732364327818, -16.935165599996214, -13.890926004327135, -26.797486846982864, -26.58117999913773, -30.639225215360828, -19.005015370144996, -22.943102142316953, -41.618250175842874, -6.379715459428439, -40.63894221081294, -11.652069104483576, -12.024532628949384, -39.479277465448604, -31.786442656707635, -21.428426110349424, -16.912459227056324, -38.67346127170445, -29.206731733957803, -9.586628522470674, -40.77676615153024, -18.429226914955663, -6.883069055255438, -6.846660583172033, -40.862710795089654, -21.611404710341333, -28.979462680895114, -30.445357172281433, -38.13063363443832, -16.24741890848236, -11.213180446187629, -12.885162529589167, -7.779803452326615, -31.29762912568306, -18.96920889072182], "policy_predator_policy_reward": [39.04500561359296, 40.47597388433184, 22.93067546581531, 21.843758339441337, 28.812786979748445, 23.6271091029861, 42.849560250588766, 16.95849380671437, 38.65398446835984, 35.24071222558682, 22.52949202045841, 17.582275429700715, 29.083087273900603, 23.955673945378642, 24.3801062582327, 12.602240893119825, 33.951827138336895, 0.012650213639929131, 22.088571986135584, 24.319741714662317, 22.291808117435327, 15.880784080145526, 30.939908708422806, 30.450500897077617, 14.282611147975743, 8.041966529914806, 26.97484632584302, 10.2770754040646, 33.37724646965708, 24.622260706022498, 19.66973631015792, 24.886446946383753, 9.022837496283762, 8.235634060402758, 49.63388616598074, 32.95012423681155, 33.26069785824188, 40.18115686078791, 26.528164671115274, 15.909623717462956, 19.38971279501839, 30.828232605738403, 28.35064772271743, 34.18622254208536, 22.177434059659493, 33.19295961713598, 14.721466350839567, 25.31749729983064, 10.180708202813223, 12.632068976899134, 38.24543404459634, 25.293618734634155, 24.896253544747452, 41.33339499065545, 17.741352871258517, 34.55488302643242, 44.36667856516549, 23.744494514986826, 18.666797341056547, 41.79682847089701, 43.953380252787326, 32.048237857523986, 19.693029349863735, 36.745899517293246, 43.69867742563689, 1.2765732364327818, 16.935165599996214, 13.890926004327135, 26.797486846982864, 26.58117999913773, 30.639225215360828, 19.005015370144996, 22.943102142316953, 41.618250175842874, 6.379715459428439, 40.63894221081294, 11.652069104483576, 12.024532628949384, 39.479277465448604, 31.786442656707635, 21.428426110349424, 16.912459227056324, 38.67346127170445, 29.206731733957803, 9.586628522470674, 40.77676615153024, 18.429226914955663, 6.883069055255438, 6.846660583172033, 40.862710795089654, 21.611404710341333, 28.979462680895114, 30.445357172281433, 38.13063363443832, 16.24741890848236, 11.213180446187629, 12.885162529589167, 7.779803452326615, 31.29762912568306, 18.96920889072182]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2868940898574539, "mean_inference_ms": 0.9441752974241162, "mean_action_processing_ms": 0.12580927633904207, "mean_env_wait_ms": 0.06814134456517204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002562999725341797, "StateBufferConnector_ms": 0.00200653076171875, "ViewRequirementAgentConnector_ms": 0.04822969436645508}, "num_episodes": 5, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 743.257089880054, "num_env_steps_trained_throughput_per_sec": 743.257089880054, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 5614.618, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5614.579, "sample_time_ms": 659.949, "learn_time_ms": 4940.614, "learn_throughput": 809.616, "synch_weights_time_ms": 13.631}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "training_iteration": 55, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-59-47", "timestamp": 1723395587, "time_this_iter_s": 5.387294054031372, "time_total_s": 305.7338032722473, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2fe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 305.7338032722473, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 27.5625, "ram_util_percent": 83.16250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.384713274007663, "cur_kl_coeff": 2.980232238769532e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1982372017072824, "policy_loss": 0.0007483512103741911, "vf_loss": 0.19748885063066457, "vf_explained_var": 0.9835165604948998, "kl": 0.0019331488532440618, "entropy": 0.5245353715494275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.39816277056622, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1875271607598279, "policy_loss": -0.012402815052701044, "vf_loss": 0.1999074525005805, "vf_explained_var": 0.9793457418059309, "kl": 0.0072077877076762885, "entropy": 1.224550182496508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.63388616598074, "predator_policy": 0.012650213639929131}, "policy_reward_max": {"prey_policy": -0.012650213639929131, "predator_policy": 49.63388616598074}, "policy_reward_mean": {"prey_policy": -24.465307287501034, "predator_policy": 24.465307287501034}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-35.24071222558682, -22.52949202045841, -17.582275429700715, -29.083087273900603, -23.955673945378642, -24.3801062582327, -12.602240893119825, -33.951827138336895, -0.012650213639929131, -22.088571986135584, -24.319741714662317, -22.291808117435327, -15.880784080145526, -30.939908708422806, -30.450500897077617, -14.282611147975743, -8.041966529914806, -26.97484632584302, -10.2770754040646, -33.37724646965708, -24.622260706022498, -19.66973631015792, -24.886446946383753, -9.022837496283762, -8.235634060402758, -49.63388616598074, -32.95012423681155, -33.26069785824188, -40.18115686078791, -26.528164671115274, -15.909623717462956, -19.38971279501839, -30.828232605738403, -28.35064772271743, -34.18622254208536, -22.177434059659493, -33.19295961713598, -14.721466350839567, -25.31749729983064, -10.180708202813223, -12.632068976899134, -38.24543404459634, -25.293618734634155, -24.896253544747452, -41.33339499065545, -17.741352871258517, -34.55488302643242, -44.36667856516549, -23.744494514986826, -18.666797341056547, -41.79682847089701, -43.953380252787326, -32.048237857523986, -19.693029349863735, -36.745899517293246, -43.69867742563689, -1.2765732364327818, -16.935165599996214, -13.890926004327135, -26.797486846982864, -26.58117999913773, -30.639225215360828, -19.005015370144996, -22.943102142316953, -41.618250175842874, -6.379715459428439, -40.63894221081294, -11.652069104483576, -12.024532628949384, -39.479277465448604, -31.786442656707635, -21.428426110349424, -16.912459227056324, -38.67346127170445, -29.206731733957803, -9.586628522470674, -40.77676615153024, -18.429226914955663, -6.883069055255438, -6.846660583172033, -40.862710795089654, -21.611404710341333, -28.979462680895114, -30.445357172281433, -38.13063363443832, -16.24741890848236, -11.213180446187629, -12.885162529589167, -7.779803452326615, -31.29762912568306, -18.96920889072182, -8.684470210838478, -17.10593519211604, -43.25891672608131, -10.5916437608281, -23.984866721922646, -24.872554008884748, -29.016071604296535, -19.85063587174783, -39.432722130913284], "policy_predator_policy_reward": [35.24071222558682, 22.52949202045841, 17.582275429700715, 29.083087273900603, 23.955673945378642, 24.3801062582327, 12.602240893119825, 33.951827138336895, 0.012650213639929131, 22.088571986135584, 24.319741714662317, 22.291808117435327, 15.880784080145526, 30.939908708422806, 30.450500897077617, 14.282611147975743, 8.041966529914806, 26.97484632584302, 10.2770754040646, 33.37724646965708, 24.622260706022498, 19.66973631015792, 24.886446946383753, 9.022837496283762, 8.235634060402758, 49.63388616598074, 32.95012423681155, 33.26069785824188, 40.18115686078791, 26.528164671115274, 15.909623717462956, 19.38971279501839, 30.828232605738403, 28.35064772271743, 34.18622254208536, 22.177434059659493, 33.19295961713598, 14.721466350839567, 25.31749729983064, 10.180708202813223, 12.632068976899134, 38.24543404459634, 25.293618734634155, 24.896253544747452, 41.33339499065545, 17.741352871258517, 34.55488302643242, 44.36667856516549, 23.744494514986826, 18.666797341056547, 41.79682847089701, 43.953380252787326, 32.048237857523986, 19.693029349863735, 36.745899517293246, 43.69867742563689, 1.2765732364327818, 16.935165599996214, 13.890926004327135, 26.797486846982864, 26.58117999913773, 30.639225215360828, 19.005015370144996, 22.943102142316953, 41.618250175842874, 6.379715459428439, 40.63894221081294, 11.652069104483576, 12.024532628949384, 39.479277465448604, 31.786442656707635, 21.428426110349424, 16.912459227056324, 38.67346127170445, 29.206731733957803, 9.586628522470674, 40.77676615153024, 18.429226914955663, 6.883069055255438, 6.846660583172033, 40.862710795089654, 21.611404710341333, 28.979462680895114, 30.445357172281433, 38.13063363443832, 16.24741890848236, 11.213180446187629, 12.885162529589167, 7.779803452326615, 31.29762912568306, 18.96920889072182, 8.684470210838478, 17.10593519211604, 43.25891672608131, 10.5916437608281, 23.984866721922646, 24.872554008884748, 29.016071604296535, 19.85063587174783, 39.432722130913284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28652284047120063, "mean_inference_ms": 0.9431073504777902, "mean_action_processing_ms": 0.1257272094358701, "mean_env_wait_ms": 0.06802246849434282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002570629119873047, "StateBufferConnector_ms": 0.002020716667175293, "ViewRequirementAgentConnector_ms": 0.049042463302612305}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 740.7216939080851, "num_env_steps_trained_throughput_per_sec": 740.7216939080851, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 5583.692, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5583.653, "sample_time_ms": 659.157, "learn_time_ms": 4910.748, "learn_throughput": 814.54, "synch_weights_time_ms": 13.373}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 56, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-59-53", "timestamp": 1723395593, "time_this_iter_s": 5.405377149581909, "time_total_s": 311.1391804218292, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2daf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 311.1391804218292, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 27.4625, "ram_util_percent": 83.1625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9459473475813865, "cur_kl_coeff": 1.490116119384766e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.16601334672692852, "policy_loss": -0.0011223789222034005, "vf_loss": 0.16713572545171093, "vf_explained_var": 0.9691025763129194, "kl": 0.002195273348302503, "entropy": 0.5421174317908783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1091232489794494, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.14440567346867586, "policy_loss": -0.011098018188204151, "vf_loss": 0.15548909559923535, "vf_explained_var": 0.9794382208958268, "kl": 0.004670515425358029, "entropy": 1.1445910037805638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.63388616598074, "predator_policy": 1.2765732364327818}, "policy_reward_max": {"prey_policy": -1.2765732364327818, "predator_policy": 49.63388616598074}, "policy_reward_mean": {"prey_policy": -24.733517849080204, "predator_policy": 24.733517849080204}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-22.088571986135584, -24.319741714662317, -22.291808117435327, -15.880784080145526, -30.939908708422806, -30.450500897077617, -14.282611147975743, -8.041966529914806, -26.97484632584302, -10.2770754040646, -33.37724646965708, -24.622260706022498, -19.66973631015792, -24.886446946383753, -9.022837496283762, -8.235634060402758, -49.63388616598074, -32.95012423681155, -33.26069785824188, -40.18115686078791, -26.528164671115274, -15.909623717462956, -19.38971279501839, -30.828232605738403, -28.35064772271743, -34.18622254208536, -22.177434059659493, -33.19295961713598, -14.721466350839567, -25.31749729983064, -10.180708202813223, -12.632068976899134, -38.24543404459634, -25.293618734634155, -24.896253544747452, -41.33339499065545, -17.741352871258517, -34.55488302643242, -44.36667856516549, -23.744494514986826, -18.666797341056547, -41.79682847089701, -43.953380252787326, -32.048237857523986, -19.693029349863735, -36.745899517293246, -43.69867742563689, -1.2765732364327818, -16.935165599996214, -13.890926004327135, -26.797486846982864, -26.58117999913773, -30.639225215360828, -19.005015370144996, -22.943102142316953, -41.618250175842874, -6.379715459428439, -40.63894221081294, -11.652069104483576, -12.024532628949384, -39.479277465448604, -31.786442656707635, -21.428426110349424, -16.912459227056324, -38.67346127170445, -29.206731733957803, -9.586628522470674, -40.77676615153024, -18.429226914955663, -6.883069055255438, -6.846660583172033, -40.862710795089654, -21.611404710341333, -28.979462680895114, -30.445357172281433, -38.13063363443832, -16.24741890848236, -11.213180446187629, -12.885162529589167, -7.779803452326615, -31.29762912568306, -18.96920889072182, -8.684470210838478, -17.10593519211604, -43.25891672608131, -10.5916437608281, -23.984866721922646, -24.872554008884748, -29.016071604296535, -19.85063587174783, -39.432722130913284, -26.01003462311119, -25.848504495305463, -2.3524929624321187, -28.210669532284168, -39.678201577601655, -27.035036390702427, -30.325226898722054, -14.999244665450805, -31.699710410661325], "policy_predator_policy_reward": [22.088571986135584, 24.319741714662317, 22.291808117435327, 15.880784080145526, 30.939908708422806, 30.450500897077617, 14.282611147975743, 8.041966529914806, 26.97484632584302, 10.2770754040646, 33.37724646965708, 24.622260706022498, 19.66973631015792, 24.886446946383753, 9.022837496283762, 8.235634060402758, 49.63388616598074, 32.95012423681155, 33.26069785824188, 40.18115686078791, 26.528164671115274, 15.909623717462956, 19.38971279501839, 30.828232605738403, 28.35064772271743, 34.18622254208536, 22.177434059659493, 33.19295961713598, 14.721466350839567, 25.31749729983064, 10.180708202813223, 12.632068976899134, 38.24543404459634, 25.293618734634155, 24.896253544747452, 41.33339499065545, 17.741352871258517, 34.55488302643242, 44.36667856516549, 23.744494514986826, 18.666797341056547, 41.79682847089701, 43.953380252787326, 32.048237857523986, 19.693029349863735, 36.745899517293246, 43.69867742563689, 1.2765732364327818, 16.935165599996214, 13.890926004327135, 26.797486846982864, 26.58117999913773, 30.639225215360828, 19.005015370144996, 22.943102142316953, 41.618250175842874, 6.379715459428439, 40.63894221081294, 11.652069104483576, 12.024532628949384, 39.479277465448604, 31.786442656707635, 21.428426110349424, 16.912459227056324, 38.67346127170445, 29.206731733957803, 9.586628522470674, 40.77676615153024, 18.429226914955663, 6.883069055255438, 6.846660583172033, 40.862710795089654, 21.611404710341333, 28.979462680895114, 30.445357172281433, 38.13063363443832, 16.24741890848236, 11.213180446187629, 12.885162529589167, 7.779803452326615, 31.29762912568306, 18.96920889072182, 8.684470210838478, 17.10593519211604, 43.25891672608131, 10.5916437608281, 23.984866721922646, 24.872554008884748, 29.016071604296535, 19.85063587174783, 39.432722130913284, 26.01003462311119, 25.848504495305463, 2.3524929624321187, 28.210669532284168, 39.678201577601655, 27.035036390702427, 30.325226898722054, 14.999244665450805, 31.699710410661325]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2861570707888882, "mean_inference_ms": 0.942056529862636, "mean_action_processing_ms": 0.12564789752374378, "mean_env_wait_ms": 0.06790768804693743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025783777236938477, "StateBufferConnector_ms": 0.0020303726196289062, "ViewRequirementAgentConnector_ms": 0.049027085304260254}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 702.6086181583021, "num_env_steps_trained_throughput_per_sec": 702.6086181583021, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 5577.655, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5577.617, "sample_time_ms": 646.719, "learn_time_ms": 4917.184, "learn_throughput": 813.474, "synch_weights_time_ms": 13.377}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "training_iteration": 57, "trial_id": "5fdfb_00000", "date": "2024-08-11_12-59-58", "timestamp": 1723395598, "time_this_iter_s": 5.7002832889556885, "time_total_s": 316.8394637107849, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2f9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 316.8394637107849, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 31.6875, "ram_util_percent": 83.26249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2934006296408673, "cur_kl_coeff": 7.45058059692383e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.22009641190525145, "policy_loss": -0.0003757415395133042, "vf_loss": 0.2204721534702306, "vf_explained_var": 0.9742634946480393, "kl": 0.001161236362468306, "entropy": 0.5355503419103722, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2348253403790295, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.12792174303519158, "policy_loss": -0.009013241862339783, "vf_loss": 0.13691872161968302, "vf_explained_var": 0.9932297398025791, "kl": 0.010408409773174445, "entropy": 1.1265508676568667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.63388616598074, "predator_policy": 1.2765732364327818}, "policy_reward_max": {"prey_policy": -1.2765732364327818, "predator_policy": 49.63388616598074}, "policy_reward_mean": {"prey_policy": -25.020560575735363, "predator_policy": 25.020560575735363}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-10.2770754040646, -33.37724646965708, -24.622260706022498, -19.66973631015792, -24.886446946383753, -9.022837496283762, -8.235634060402758, -49.63388616598074, -32.95012423681155, -33.26069785824188, -40.18115686078791, -26.528164671115274, -15.909623717462956, -19.38971279501839, -30.828232605738403, -28.35064772271743, -34.18622254208536, -22.177434059659493, -33.19295961713598, -14.721466350839567, -25.31749729983064, -10.180708202813223, -12.632068976899134, -38.24543404459634, -25.293618734634155, -24.896253544747452, -41.33339499065545, -17.741352871258517, -34.55488302643242, -44.36667856516549, -23.744494514986826, -18.666797341056547, -41.79682847089701, -43.953380252787326, -32.048237857523986, -19.693029349863735, -36.745899517293246, -43.69867742563689, -1.2765732364327818, -16.935165599996214, -13.890926004327135, -26.797486846982864, -26.58117999913773, -30.639225215360828, -19.005015370144996, -22.943102142316953, -41.618250175842874, -6.379715459428439, -40.63894221081294, -11.652069104483576, -12.024532628949384, -39.479277465448604, -31.786442656707635, -21.428426110349424, -16.912459227056324, -38.67346127170445, -29.206731733957803, -9.586628522470674, -40.77676615153024, -18.429226914955663, -6.883069055255438, -6.846660583172033, -40.862710795089654, -21.611404710341333, -28.979462680895114, -30.445357172281433, -38.13063363443832, -16.24741890848236, -11.213180446187629, -12.885162529589167, -7.779803452326615, -31.29762912568306, -18.96920889072182, -8.684470210838478, -17.10593519211604, -43.25891672608131, -10.5916437608281, -23.984866721922646, -24.872554008884748, -29.016071604296535, -19.85063587174783, -39.432722130913284, -26.01003462311119, -25.848504495305463, -2.3524929624321187, -28.210669532284168, -39.678201577601655, -27.035036390702427, -30.325226898722054, -14.999244665450805, -31.699710410661325, -22.472026521378215, -10.561416193612665, -40.6970335331541, -22.4615804408744, -16.385379124063608, -25.1964115408982, -45.49338639635012, -19.83738565230712, -20.870392770489985], "policy_predator_policy_reward": [10.2770754040646, 33.37724646965708, 24.622260706022498, 19.66973631015792, 24.886446946383753, 9.022837496283762, 8.235634060402758, 49.63388616598074, 32.95012423681155, 33.26069785824188, 40.18115686078791, 26.528164671115274, 15.909623717462956, 19.38971279501839, 30.828232605738403, 28.35064772271743, 34.18622254208536, 22.177434059659493, 33.19295961713598, 14.721466350839567, 25.31749729983064, 10.180708202813223, 12.632068976899134, 38.24543404459634, 25.293618734634155, 24.896253544747452, 41.33339499065545, 17.741352871258517, 34.55488302643242, 44.36667856516549, 23.744494514986826, 18.666797341056547, 41.79682847089701, 43.953380252787326, 32.048237857523986, 19.693029349863735, 36.745899517293246, 43.69867742563689, 1.2765732364327818, 16.935165599996214, 13.890926004327135, 26.797486846982864, 26.58117999913773, 30.639225215360828, 19.005015370144996, 22.943102142316953, 41.618250175842874, 6.379715459428439, 40.63894221081294, 11.652069104483576, 12.024532628949384, 39.479277465448604, 31.786442656707635, 21.428426110349424, 16.912459227056324, 38.67346127170445, 29.206731733957803, 9.586628522470674, 40.77676615153024, 18.429226914955663, 6.883069055255438, 6.846660583172033, 40.862710795089654, 21.611404710341333, 28.979462680895114, 30.445357172281433, 38.13063363443832, 16.24741890848236, 11.213180446187629, 12.885162529589167, 7.779803452326615, 31.29762912568306, 18.96920889072182, 8.684470210838478, 17.10593519211604, 43.25891672608131, 10.5916437608281, 23.984866721922646, 24.872554008884748, 29.016071604296535, 19.85063587174783, 39.432722130913284, 26.01003462311119, 25.848504495305463, 2.3524929624321187, 28.210669532284168, 39.678201577601655, 27.035036390702427, 30.325226898722054, 14.999244665450805, 31.699710410661325, 22.472026521378215, 10.561416193612665, 40.6970335331541, 22.4615804408744, 16.385379124063608, 25.1964115408982, 45.49338639635012, 19.83738565230712, 20.870392770489985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28584831114291115, "mean_inference_ms": 0.9411858134034955, "mean_action_processing_ms": 0.12558711792693816, "mean_env_wait_ms": 0.06780693658509335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025480985641479492, "StateBufferConnector_ms": 0.0020265579223632812, "ViewRequirementAgentConnector_ms": 0.04840505123138428}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 702.9059005167802, "num_env_steps_trained_throughput_per_sec": 702.9059005167802, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 5583.697, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5583.658, "sample_time_ms": 655.615, "learn_time_ms": 4913.741, "learn_throughput": 814.044, "synch_weights_time_ms": 13.959}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 58, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-00-04", "timestamp": 1723395604, "time_this_iter_s": 5.707220077514648, "time_total_s": 322.54668378829956, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e08790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 322.54668378829956, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 35.2375, "ram_util_percent": 83.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1812886812258512, "cur_kl_coeff": 3.725290298461915e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.173669965613711, "policy_loss": -0.0025011477557806455, "vf_loss": 0.17617111363603424, "vf_explained_var": 0.9900346569096049, "kl": 0.008927092766823796, "entropy": 0.48081302565212053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3601235260566076, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1551718056955148, "policy_loss": -0.005608079214531851, "vf_loss": 0.1607625208989096, "vf_explained_var": 0.991135532905658, "kl": 0.011112947880010065, "entropy": 1.07855658972015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.728043413624135, "predator_policy": 1.2765732364327818}, "policy_reward_max": {"prey_policy": -1.2765732364327818, "predator_policy": 51.728043413624135}, "policy_reward_mean": {"prey_policy": -25.275317964361463, "predator_policy": 25.275317964361463}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-33.26069785824188, -40.18115686078791, -26.528164671115274, -15.909623717462956, -19.38971279501839, -30.828232605738403, -28.35064772271743, -34.18622254208536, -22.177434059659493, -33.19295961713598, -14.721466350839567, -25.31749729983064, -10.180708202813223, -12.632068976899134, -38.24543404459634, -25.293618734634155, -24.896253544747452, -41.33339499065545, -17.741352871258517, -34.55488302643242, -44.36667856516549, -23.744494514986826, -18.666797341056547, -41.79682847089701, -43.953380252787326, -32.048237857523986, -19.693029349863735, -36.745899517293246, -43.69867742563689, -1.2765732364327818, -16.935165599996214, -13.890926004327135, -26.797486846982864, -26.58117999913773, -30.639225215360828, -19.005015370144996, -22.943102142316953, -41.618250175842874, -6.379715459428439, -40.63894221081294, -11.652069104483576, -12.024532628949384, -39.479277465448604, -31.786442656707635, -21.428426110349424, -16.912459227056324, -38.67346127170445, -29.206731733957803, -9.586628522470674, -40.77676615153024, -18.429226914955663, -6.883069055255438, -6.846660583172033, -40.862710795089654, -21.611404710341333, -28.979462680895114, -30.445357172281433, -38.13063363443832, -16.24741890848236, -11.213180446187629, -12.885162529589167, -7.779803452326615, -31.29762912568306, -18.96920889072182, -8.684470210838478, -17.10593519211604, -43.25891672608131, -10.5916437608281, -23.984866721922646, -24.872554008884748, -29.016071604296535, -19.85063587174783, -39.432722130913284, -26.01003462311119, -25.848504495305463, -2.3524929624321187, -28.210669532284168, -39.678201577601655, -27.035036390702427, -30.325226898722054, -14.999244665450805, -31.699710410661325, -22.472026521378215, -10.561416193612665, -40.6970335331541, -22.4615804408744, -16.385379124063608, -25.1964115408982, -45.49338639635012, -19.83738565230712, -20.870392770489985, -16.631123640269042, -25.130610892147317, -29.371545042145097, -27.58297930730685, -51.728043413624135, -3.983462515500694, -31.228964658651424, -16.145791261294903, -36.34846592743483], "policy_predator_policy_reward": [33.26069785824188, 40.18115686078791, 26.528164671115274, 15.909623717462956, 19.38971279501839, 30.828232605738403, 28.35064772271743, 34.18622254208536, 22.177434059659493, 33.19295961713598, 14.721466350839567, 25.31749729983064, 10.180708202813223, 12.632068976899134, 38.24543404459634, 25.293618734634155, 24.896253544747452, 41.33339499065545, 17.741352871258517, 34.55488302643242, 44.36667856516549, 23.744494514986826, 18.666797341056547, 41.79682847089701, 43.953380252787326, 32.048237857523986, 19.693029349863735, 36.745899517293246, 43.69867742563689, 1.2765732364327818, 16.935165599996214, 13.890926004327135, 26.797486846982864, 26.58117999913773, 30.639225215360828, 19.005015370144996, 22.943102142316953, 41.618250175842874, 6.379715459428439, 40.63894221081294, 11.652069104483576, 12.024532628949384, 39.479277465448604, 31.786442656707635, 21.428426110349424, 16.912459227056324, 38.67346127170445, 29.206731733957803, 9.586628522470674, 40.77676615153024, 18.429226914955663, 6.883069055255438, 6.846660583172033, 40.862710795089654, 21.611404710341333, 28.979462680895114, 30.445357172281433, 38.13063363443832, 16.24741890848236, 11.213180446187629, 12.885162529589167, 7.779803452326615, 31.29762912568306, 18.96920889072182, 8.684470210838478, 17.10593519211604, 43.25891672608131, 10.5916437608281, 23.984866721922646, 24.872554008884748, 29.016071604296535, 19.85063587174783, 39.432722130913284, 26.01003462311119, 25.848504495305463, 2.3524929624321187, 28.210669532284168, 39.678201577601655, 27.035036390702427, 30.325226898722054, 14.999244665450805, 31.699710410661325, 22.472026521378215, 10.561416193612665, 40.6970335331541, 22.4615804408744, 16.385379124063608, 25.1964115408982, 45.49338639635012, 19.83738565230712, 20.870392770489985, 16.631123640269042, 25.130610892147317, 29.371545042145097, 27.58297930730685, 51.728043413624135, 3.983462515500694, 31.228964658651424, 16.145791261294903, 36.34846592743483]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28565737406909425, "mean_inference_ms": 0.940538356852026, "mean_action_processing_ms": 0.12555308761601378, "mean_env_wait_ms": 0.06772323661695899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025364160537719727, "StateBufferConnector_ms": 0.0020275115966796875, "ViewRequirementAgentConnector_ms": 0.04803621768951416}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 702.7135611039208, "num_env_steps_trained_throughput_per_sec": 702.7135611039208, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 472000, "timers": {"training_iteration_time_ms": 5565.967, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5565.931, "sample_time_ms": 669.509, "learn_time_ms": 4882.732, "learn_throughput": 819.213, "synch_weights_time_ms": 13.362}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "done": false, "training_iteration": 59, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-00-10", "timestamp": 1723395610, "time_this_iter_s": 5.70301079750061, "time_total_s": 328.24969458580017, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2daf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 328.24969458580017, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 42.2375, "ram_util_percent": 83.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0633131407822172, "cur_kl_coeff": 3.725290298461915e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.15318236514843495, "policy_loss": -0.0008058853234009197, "vf_loss": 0.15398825037991629, "vf_explained_var": 0.9905785781641802, "kl": 0.0017026431768925932, "entropy": 0.44468876359363396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0391225202319523, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.14023720575419626, "policy_loss": -0.025973766280367273, "vf_loss": 0.16619237384099203, "vf_explained_var": 0.9897078548868498, "kl": 0.01190227063732164, "entropy": 1.0679403450960914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.728043413624135, "predator_policy": 1.2765732364327818}, "policy_reward_max": {"prey_policy": -1.2765732364327818, "predator_policy": 51.728043413624135}, "policy_reward_mean": {"prey_policy": -25.248330812955857, "predator_policy": 25.248330812955857}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-33.19295961713598, -14.721466350839567, -25.31749729983064, -10.180708202813223, -12.632068976899134, -38.24543404459634, -25.293618734634155, -24.896253544747452, -41.33339499065545, -17.741352871258517, -34.55488302643242, -44.36667856516549, -23.744494514986826, -18.666797341056547, -41.79682847089701, -43.953380252787326, -32.048237857523986, -19.693029349863735, -36.745899517293246, -43.69867742563689, -1.2765732364327818, -16.935165599996214, -13.890926004327135, -26.797486846982864, -26.58117999913773, -30.639225215360828, -19.005015370144996, -22.943102142316953, -41.618250175842874, -6.379715459428439, -40.63894221081294, -11.652069104483576, -12.024532628949384, -39.479277465448604, -31.786442656707635, -21.428426110349424, -16.912459227056324, -38.67346127170445, -29.206731733957803, -9.586628522470674, -40.77676615153024, -18.429226914955663, -6.883069055255438, -6.846660583172033, -40.862710795089654, -21.611404710341333, -28.979462680895114, -30.445357172281433, -38.13063363443832, -16.24741890848236, -11.213180446187629, -12.885162529589167, -7.779803452326615, -31.29762912568306, -18.96920889072182, -8.684470210838478, -17.10593519211604, -43.25891672608131, -10.5916437608281, -23.984866721922646, -24.872554008884748, -29.016071604296535, -19.85063587174783, -39.432722130913284, -26.01003462311119, -25.848504495305463, -2.3524929624321187, -28.210669532284168, -39.678201577601655, -27.035036390702427, -30.325226898722054, -14.999244665450805, -31.699710410661325, -22.472026521378215, -10.561416193612665, -40.6970335331541, -22.4615804408744, -16.385379124063608, -25.1964115408982, -45.49338639635012, -19.83738565230712, -20.870392770489985, -16.631123640269042, -25.130610892147317, -29.371545042145097, -27.58297930730685, -51.728043413624135, -3.983462515500694, -31.228964658651424, -16.145791261294903, -36.34846592743483, -34.397169323660535, -30.949594011798254, -26.3075143348385, -37.24717470886553, -24.32407650976866, -11.953476523103532, -34.35125293626834, -30.3115442363966, -18.271375107567064], "policy_predator_policy_reward": [33.19295961713598, 14.721466350839567, 25.31749729983064, 10.180708202813223, 12.632068976899134, 38.24543404459634, 25.293618734634155, 24.896253544747452, 41.33339499065545, 17.741352871258517, 34.55488302643242, 44.36667856516549, 23.744494514986826, 18.666797341056547, 41.79682847089701, 43.953380252787326, 32.048237857523986, 19.693029349863735, 36.745899517293246, 43.69867742563689, 1.2765732364327818, 16.935165599996214, 13.890926004327135, 26.797486846982864, 26.58117999913773, 30.639225215360828, 19.005015370144996, 22.943102142316953, 41.618250175842874, 6.379715459428439, 40.63894221081294, 11.652069104483576, 12.024532628949384, 39.479277465448604, 31.786442656707635, 21.428426110349424, 16.912459227056324, 38.67346127170445, 29.206731733957803, 9.586628522470674, 40.77676615153024, 18.429226914955663, 6.883069055255438, 6.846660583172033, 40.862710795089654, 21.611404710341333, 28.979462680895114, 30.445357172281433, 38.13063363443832, 16.24741890848236, 11.213180446187629, 12.885162529589167, 7.779803452326615, 31.29762912568306, 18.96920889072182, 8.684470210838478, 17.10593519211604, 43.25891672608131, 10.5916437608281, 23.984866721922646, 24.872554008884748, 29.016071604296535, 19.85063587174783, 39.432722130913284, 26.01003462311119, 25.848504495305463, 2.3524929624321187, 28.210669532284168, 39.678201577601655, 27.035036390702427, 30.325226898722054, 14.999244665450805, 31.699710410661325, 22.472026521378215, 10.561416193612665, 40.6970335331541, 22.4615804408744, 16.385379124063608, 25.1964115408982, 45.49338639635012, 19.83738565230712, 20.870392770489985, 16.631123640269042, 25.130610892147317, 29.371545042145097, 27.58297930730685, 51.728043413624135, 3.983462515500694, 31.228964658651424, 16.145791261294903, 36.34846592743483, 34.397169323660535, 30.949594011798254, 26.3075143348385, 37.24717470886553, 24.32407650976866, 11.953476523103532, 34.35125293626834, 30.3115442363966, 18.271375107567064]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28549548515508805, "mean_inference_ms": 0.9399625305029156, "mean_action_processing_ms": 0.12552870167144106, "mean_env_wait_ms": 0.06764433147364889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025396347045898438, "StateBufferConnector_ms": 0.0020409822463989258, "ViewRequirementAgentConnector_ms": 0.04887890815734863}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 715.7721784126538, "num_env_steps_trained_throughput_per_sec": 715.7721784126538, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 5576.596, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5576.56, "sample_time_ms": 669.153, "learn_time_ms": 4893.63, "learn_throughput": 817.389, "synch_weights_time_ms": 13.452}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 60, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-00-15", "timestamp": 1723395615, "time_this_iter_s": 5.592487096786499, "time_total_s": 333.84218168258667, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7874430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 333.84218168258667, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 35.1875, "ram_util_percent": 83.0125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.19116327847975, "cur_kl_coeff": 1.8626451492309574e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.20887330963741987, "policy_loss": -0.0015996011677392138, "vf_loss": 0.2104729112101874, "vf_explained_var": 0.9868928049380581, "kl": 0.0033455523775380155, "entropy": 0.4588466555501024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3099054715130478, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.14583561594031, "policy_loss": -0.015667011773621196, "vf_loss": 0.16148446704804276, "vf_explained_var": 0.9928489731624722, "kl": 0.011621975365980515, "entropy": 1.0273996145774922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -58.49319853375822, "predator_policy": 1.2765732364327818}, "policy_reward_max": {"prey_policy": -1.2765732364327818, "predator_policy": 58.49319853375822}, "policy_reward_mean": {"prey_policy": -25.190812336217483, "predator_policy": 25.190812336217483}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-17.741352871258517, -34.55488302643242, -44.36667856516549, -23.744494514986826, -18.666797341056547, -41.79682847089701, -43.953380252787326, -32.048237857523986, -19.693029349863735, -36.745899517293246, -43.69867742563689, -1.2765732364327818, -16.935165599996214, -13.890926004327135, -26.797486846982864, -26.58117999913773, -30.639225215360828, -19.005015370144996, -22.943102142316953, -41.618250175842874, -6.379715459428439, -40.63894221081294, -11.652069104483576, -12.024532628949384, -39.479277465448604, -31.786442656707635, -21.428426110349424, -16.912459227056324, -38.67346127170445, -29.206731733957803, -9.586628522470674, -40.77676615153024, -18.429226914955663, -6.883069055255438, -6.846660583172033, -40.862710795089654, -21.611404710341333, -28.979462680895114, -30.445357172281433, -38.13063363443832, -16.24741890848236, -11.213180446187629, -12.885162529589167, -7.779803452326615, -31.29762912568306, -18.96920889072182, -8.684470210838478, -17.10593519211604, -43.25891672608131, -10.5916437608281, -23.984866721922646, -24.872554008884748, -29.016071604296535, -19.85063587174783, -39.432722130913284, -26.01003462311119, -25.848504495305463, -2.3524929624321187, -28.210669532284168, -39.678201577601655, -27.035036390702427, -30.325226898722054, -14.999244665450805, -31.699710410661325, -22.472026521378215, -10.561416193612665, -40.6970335331541, -22.4615804408744, -16.385379124063608, -25.1964115408982, -45.49338639635012, -19.83738565230712, -20.870392770489985, -16.631123640269042, -25.130610892147317, -29.371545042145097, -27.58297930730685, -51.728043413624135, -3.983462515500694, -31.228964658651424, -16.145791261294903, -36.34846592743483, -34.397169323660535, -30.949594011798254, -26.3075143348385, -37.24717470886553, -24.32407650976866, -11.953476523103532, -34.35125293626834, -30.3115442363966, -18.271375107567064, -28.560055941132344, -15.885102307721997, -9.679841865833, -23.365561681544566, -25.35508998878149, -9.166967774676797, -58.49319853375822, -43.307270395863384, -6.248465599003241], "policy_predator_policy_reward": [17.741352871258517, 34.55488302643242, 44.36667856516549, 23.744494514986826, 18.666797341056547, 41.79682847089701, 43.953380252787326, 32.048237857523986, 19.693029349863735, 36.745899517293246, 43.69867742563689, 1.2765732364327818, 16.935165599996214, 13.890926004327135, 26.797486846982864, 26.58117999913773, 30.639225215360828, 19.005015370144996, 22.943102142316953, 41.618250175842874, 6.379715459428439, 40.63894221081294, 11.652069104483576, 12.024532628949384, 39.479277465448604, 31.786442656707635, 21.428426110349424, 16.912459227056324, 38.67346127170445, 29.206731733957803, 9.586628522470674, 40.77676615153024, 18.429226914955663, 6.883069055255438, 6.846660583172033, 40.862710795089654, 21.611404710341333, 28.979462680895114, 30.445357172281433, 38.13063363443832, 16.24741890848236, 11.213180446187629, 12.885162529589167, 7.779803452326615, 31.29762912568306, 18.96920889072182, 8.684470210838478, 17.10593519211604, 43.25891672608131, 10.5916437608281, 23.984866721922646, 24.872554008884748, 29.016071604296535, 19.85063587174783, 39.432722130913284, 26.01003462311119, 25.848504495305463, 2.3524929624321187, 28.210669532284168, 39.678201577601655, 27.035036390702427, 30.325226898722054, 14.999244665450805, 31.699710410661325, 22.472026521378215, 10.561416193612665, 40.6970335331541, 22.4615804408744, 16.385379124063608, 25.1964115408982, 45.49338639635012, 19.83738565230712, 20.870392770489985, 16.631123640269042, 25.130610892147317, 29.371545042145097, 27.58297930730685, 51.728043413624135, 3.983462515500694, 31.228964658651424, 16.145791261294903, 36.34846592743483, 34.397169323660535, 30.949594011798254, 26.3075143348385, 37.24717470886553, 24.32407650976866, 11.953476523103532, 34.35125293626834, 30.3115442363966, 18.271375107567064, 28.560055941132344, 15.885102307721997, 9.679841865833, 23.365561681544566, 25.35508998878149, 9.166967774676797, 58.49319853375822, 43.307270395863384, 6.248465599003241]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2854817036934817, "mean_inference_ms": 0.9399276450033291, "mean_action_processing_ms": 0.12556150170416114, "mean_env_wait_ms": 0.06760597630265601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025589466094970703, "StateBufferConnector_ms": 0.0020731687545776367, "ViewRequirementAgentConnector_ms": 0.04965078830718994}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 713.7952374724529, "num_env_steps_trained_throughput_per_sec": 713.7952374724529, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 488000, "timers": {"training_iteration_time_ms": 5598.418, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5598.381, "sample_time_ms": 699.036, "learn_time_ms": 4885.552, "learn_throughput": 818.741, "synch_weights_time_ms": 13.462}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "done": false, "training_iteration": 61, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-00-21", "timestamp": 1723395621, "time_this_iter_s": 5.60810399055481, "time_total_s": 339.4502856731415, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2f9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 339.4502856731415, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 35.6625, "ram_util_percent": 82.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8253596120669197, "cur_kl_coeff": 9.313225746154787e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06376527342120729, "policy_loss": -0.003358404617877871, "vf_loss": 0.06712367768244197, "vf_explained_var": 0.9936219907055298, "kl": 0.00467362396678741, "entropy": 0.4431078228789071, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.884531728643924, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06501250089991117, "policy_loss": -0.013797099261379724, "vf_loss": 0.07879528768826276, "vf_explained_var": 0.9842055034513275, "kl": 0.009160184971317164, "entropy": 1.0267064424231649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -58.49319853375822, "predator_policy": 1.2765732364327818}, "policy_reward_max": {"prey_policy": -1.2765732364327818, "predator_policy": 58.49319853375822}, "policy_reward_mean": {"prey_policy": -25.42500822172134, "predator_policy": 25.42500822172134}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-36.745899517293246, -43.69867742563689, -1.2765732364327818, -16.935165599996214, -13.890926004327135, -26.797486846982864, -26.58117999913773, -30.639225215360828, -19.005015370144996, -22.943102142316953, -41.618250175842874, -6.379715459428439, -40.63894221081294, -11.652069104483576, -12.024532628949384, -39.479277465448604, -31.786442656707635, -21.428426110349424, -16.912459227056324, -38.67346127170445, -29.206731733957803, -9.586628522470674, -40.77676615153024, -18.429226914955663, -6.883069055255438, -6.846660583172033, -40.862710795089654, -21.611404710341333, -28.979462680895114, -30.445357172281433, -38.13063363443832, -16.24741890848236, -11.213180446187629, -12.885162529589167, -7.779803452326615, -31.29762912568306, -18.96920889072182, -8.684470210838478, -17.10593519211604, -43.25891672608131, -10.5916437608281, -23.984866721922646, -24.872554008884748, -29.016071604296535, -19.85063587174783, -39.432722130913284, -26.01003462311119, -25.848504495305463, -2.3524929624321187, -28.210669532284168, -39.678201577601655, -27.035036390702427, -30.325226898722054, -14.999244665450805, -31.699710410661325, -22.472026521378215, -10.561416193612665, -40.6970335331541, -22.4615804408744, -16.385379124063608, -25.1964115408982, -45.49338639635012, -19.83738565230712, -20.870392770489985, -16.631123640269042, -25.130610892147317, -29.371545042145097, -27.58297930730685, -51.728043413624135, -3.983462515500694, -31.228964658651424, -16.145791261294903, -36.34846592743483, -34.397169323660535, -30.949594011798254, -26.3075143348385, -37.24717470886553, -24.32407650976866, -11.953476523103532, -34.35125293626834, -30.3115442363966, -18.271375107567064, -28.560055941132344, -15.885102307721997, -9.679841865833, -23.365561681544566, -25.35508998878149, -9.166967774676797, -58.49319853375822, -43.307270395863384, -6.248465599003241, -13.812539483513488, -45.66891195798172, -39.552360990020034, -19.559965847125138, -38.741801237445955, -30.93145695212236, -40.8449928319705, -48.912926141094616, -21.960315359082983], "policy_predator_policy_reward": [36.745899517293246, 43.69867742563689, 1.2765732364327818, 16.935165599996214, 13.890926004327135, 26.797486846982864, 26.58117999913773, 30.639225215360828, 19.005015370144996, 22.943102142316953, 41.618250175842874, 6.379715459428439, 40.63894221081294, 11.652069104483576, 12.024532628949384, 39.479277465448604, 31.786442656707635, 21.428426110349424, 16.912459227056324, 38.67346127170445, 29.206731733957803, 9.586628522470674, 40.77676615153024, 18.429226914955663, 6.883069055255438, 6.846660583172033, 40.862710795089654, 21.611404710341333, 28.979462680895114, 30.445357172281433, 38.13063363443832, 16.24741890848236, 11.213180446187629, 12.885162529589167, 7.779803452326615, 31.29762912568306, 18.96920889072182, 8.684470210838478, 17.10593519211604, 43.25891672608131, 10.5916437608281, 23.984866721922646, 24.872554008884748, 29.016071604296535, 19.85063587174783, 39.432722130913284, 26.01003462311119, 25.848504495305463, 2.3524929624321187, 28.210669532284168, 39.678201577601655, 27.035036390702427, 30.325226898722054, 14.999244665450805, 31.699710410661325, 22.472026521378215, 10.561416193612665, 40.6970335331541, 22.4615804408744, 16.385379124063608, 25.1964115408982, 45.49338639635012, 19.83738565230712, 20.870392770489985, 16.631123640269042, 25.130610892147317, 29.371545042145097, 27.58297930730685, 51.728043413624135, 3.983462515500694, 31.228964658651424, 16.145791261294903, 36.34846592743483, 34.397169323660535, 30.949594011798254, 26.3075143348385, 37.24717470886553, 24.32407650976866, 11.953476523103532, 34.35125293626834, 30.3115442363966, 18.271375107567064, 28.560055941132344, 15.885102307721997, 9.679841865833, 23.365561681544566, 25.35508998878149, 9.166967774676797, 58.49319853375822, 43.307270395863384, 6.248465599003241, 13.812539483513488, 45.66891195798172, 39.552360990020034, 19.559965847125138, 38.741801237445955, 30.93145695212236, 40.8449928319705, 48.912926141094616, 21.960315359082983]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28545927132733984, "mean_inference_ms": 0.9398382390213661, "mean_action_processing_ms": 0.12558221091505176, "mean_env_wait_ms": 0.06756264079480565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025511980056762695, "StateBufferConnector_ms": 0.0020720958709716797, "ViewRequirementAgentConnector_ms": 0.04973304271697998}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 742.2903474871359, "num_env_steps_trained_throughput_per_sec": 742.2903474871359, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 5527.829, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5527.793, "sample_time_ms": 694.87, "learn_time_ms": 4819.088, "learn_throughput": 830.033, "synch_weights_time_ms": 13.507}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 62, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-00-26", "timestamp": 1723395626, "time_this_iter_s": 5.393803119659424, "time_total_s": 344.8440887928009, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78544c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 344.8440887928009, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 28.287499999999998, "ram_util_percent": 82.2125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9200582300778478, "cur_kl_coeff": 4.6566128730773935e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06633860973330835, "policy_loss": 0.00021959575897199102, "vf_loss": 0.0661190134085094, "vf_explained_var": 0.9873560707395276, "kl": 0.003115439821565196, "entropy": 0.3910543141576151, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8749821950526288, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.10866878874773343, "policy_loss": -0.01871946717510582, "vf_loss": 0.12736874760788244, "vf_explained_var": 0.9654921425506473, "kl": 0.012485563021951872, "entropy": 0.9734621139243245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -58.49319853375822, "predator_policy": 2.3524929624321187}, "policy_reward_max": {"prey_policy": -2.3524929624321187, "predator_policy": 58.49319853375822}, "policy_reward_mean": {"prey_policy": -25.22577857989336, "predator_policy": 25.22577857989336}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-13.890926004327135, -26.797486846982864, -26.58117999913773, -30.639225215360828, -19.005015370144996, -22.943102142316953, -41.618250175842874, -6.379715459428439, -40.63894221081294, -11.652069104483576, -12.024532628949384, -39.479277465448604, -31.786442656707635, -21.428426110349424, -16.912459227056324, -38.67346127170445, -29.206731733957803, -9.586628522470674, -40.77676615153024, -18.429226914955663, -6.883069055255438, -6.846660583172033, -40.862710795089654, -21.611404710341333, -28.979462680895114, -30.445357172281433, -38.13063363443832, -16.24741890848236, -11.213180446187629, -12.885162529589167, -7.779803452326615, -31.29762912568306, -18.96920889072182, -8.684470210838478, -17.10593519211604, -43.25891672608131, -10.5916437608281, -23.984866721922646, -24.872554008884748, -29.016071604296535, -19.85063587174783, -39.432722130913284, -26.01003462311119, -25.848504495305463, -2.3524929624321187, -28.210669532284168, -39.678201577601655, -27.035036390702427, -30.325226898722054, -14.999244665450805, -31.699710410661325, -22.472026521378215, -10.561416193612665, -40.6970335331541, -22.4615804408744, -16.385379124063608, -25.1964115408982, -45.49338639635012, -19.83738565230712, -20.870392770489985, -16.631123640269042, -25.130610892147317, -29.371545042145097, -27.58297930730685, -51.728043413624135, -3.983462515500694, -31.228964658651424, -16.145791261294903, -36.34846592743483, -34.397169323660535, -30.949594011798254, -26.3075143348385, -37.24717470886553, -24.32407650976866, -11.953476523103532, -34.35125293626834, -30.3115442363966, -18.271375107567064, -28.560055941132344, -15.885102307721997, -9.679841865833, -23.365561681544566, -25.35508998878149, -9.166967774676797, -58.49319853375822, -43.307270395863384, -6.248465599003241, -13.812539483513488, -45.66891195798172, -39.552360990020034, -19.559965847125138, -38.741801237445955, -30.93145695212236, -40.8449928319705, -48.912926141094616, -21.960315359082983, -15.449233903287915, -33.50068692733218, -15.19778682639577, -14.585643939545859], "policy_predator_policy_reward": [13.890926004327135, 26.797486846982864, 26.58117999913773, 30.639225215360828, 19.005015370144996, 22.943102142316953, 41.618250175842874, 6.379715459428439, 40.63894221081294, 11.652069104483576, 12.024532628949384, 39.479277465448604, 31.786442656707635, 21.428426110349424, 16.912459227056324, 38.67346127170445, 29.206731733957803, 9.586628522470674, 40.77676615153024, 18.429226914955663, 6.883069055255438, 6.846660583172033, 40.862710795089654, 21.611404710341333, 28.979462680895114, 30.445357172281433, 38.13063363443832, 16.24741890848236, 11.213180446187629, 12.885162529589167, 7.779803452326615, 31.29762912568306, 18.96920889072182, 8.684470210838478, 17.10593519211604, 43.25891672608131, 10.5916437608281, 23.984866721922646, 24.872554008884748, 29.016071604296535, 19.85063587174783, 39.432722130913284, 26.01003462311119, 25.848504495305463, 2.3524929624321187, 28.210669532284168, 39.678201577601655, 27.035036390702427, 30.325226898722054, 14.999244665450805, 31.699710410661325, 22.472026521378215, 10.561416193612665, 40.6970335331541, 22.4615804408744, 16.385379124063608, 25.1964115408982, 45.49338639635012, 19.83738565230712, 20.870392770489985, 16.631123640269042, 25.130610892147317, 29.371545042145097, 27.58297930730685, 51.728043413624135, 3.983462515500694, 31.228964658651424, 16.145791261294903, 36.34846592743483, 34.397169323660535, 30.949594011798254, 26.3075143348385, 37.24717470886553, 24.32407650976866, 11.953476523103532, 34.35125293626834, 30.3115442363966, 18.271375107567064, 28.560055941132344, 15.885102307721997, 9.679841865833, 23.365561681544566, 25.35508998878149, 9.166967774676797, 58.49319853375822, 43.307270395863384, 6.248465599003241, 13.812539483513488, 45.66891195798172, 39.552360990020034, 19.559965847125138, 38.741801237445955, 30.93145695212236, 40.8449928319705, 48.912926141094616, 21.960315359082983, 15.449233903287915, 33.50068692733218, 15.19778682639577, 14.585643939545859]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2854847980344075, "mean_inference_ms": 0.9399514066571121, "mean_action_processing_ms": 0.1255827762016858, "mean_env_wait_ms": 0.06754609185848368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025519132614135742, "StateBufferConnector_ms": 0.002072572708129883, "ViewRequirementAgentConnector_ms": 0.04937934875488281}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 698.8891941424366, "num_env_steps_trained_throughput_per_sec": 698.8891941424366, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 5546.399, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5546.362, "sample_time_ms": 717.302, "learn_time_ms": 4815.074, "learn_throughput": 830.724, "synch_weights_time_ms": 13.656}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "training_iteration": 63, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-00-32", "timestamp": 1723395632, "time_this_iter_s": 5.7277748584747314, "time_total_s": 350.57186365127563, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9ed1280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 350.57186365127563, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 32.6875, "ram_util_percent": 81.9625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8828193513055642, "cur_kl_coeff": 2.3283064365386967e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.11612178497234708, "policy_loss": -0.00022926711850838424, "vf_loss": 0.11635105184395797, "vf_explained_var": 0.9857090522224704, "kl": 0.0011273684623958205, "entropy": 0.36712275552563367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9444287966626386, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.10828873961462099, "policy_loss": -0.013281498509119654, "vf_loss": 0.12156015242217108, "vf_explained_var": 0.9818991525719564, "kl": 0.006454860262389654, "entropy": 0.9163911899551749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -58.49319853375822, "predator_policy": 2.3524929624321187}, "policy_reward_max": {"prey_policy": -2.3524929624321187, "predator_policy": 58.49319853375822}, "policy_reward_mean": {"prey_policy": -25.13020146456262, "predator_policy": 25.13020146456262}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-22.943102142316953, -41.618250175842874, -6.379715459428439, -40.63894221081294, -11.652069104483576, -12.024532628949384, -39.479277465448604, -31.786442656707635, -21.428426110349424, -16.912459227056324, -38.67346127170445, -29.206731733957803, -9.586628522470674, -40.77676615153024, -18.429226914955663, -6.883069055255438, -6.846660583172033, -40.862710795089654, -21.611404710341333, -28.979462680895114, -30.445357172281433, -38.13063363443832, -16.24741890848236, -11.213180446187629, -12.885162529589167, -7.779803452326615, -31.29762912568306, -18.96920889072182, -8.684470210838478, -17.10593519211604, -43.25891672608131, -10.5916437608281, -23.984866721922646, -24.872554008884748, -29.016071604296535, -19.85063587174783, -39.432722130913284, -26.01003462311119, -25.848504495305463, -2.3524929624321187, -28.210669532284168, -39.678201577601655, -27.035036390702427, -30.325226898722054, -14.999244665450805, -31.699710410661325, -22.472026521378215, -10.561416193612665, -40.6970335331541, -22.4615804408744, -16.385379124063608, -25.1964115408982, -45.49338639635012, -19.83738565230712, -20.870392770489985, -16.631123640269042, -25.130610892147317, -29.371545042145097, -27.58297930730685, -51.728043413624135, -3.983462515500694, -31.228964658651424, -16.145791261294903, -36.34846592743483, -34.397169323660535, -30.949594011798254, -26.3075143348385, -37.24717470886553, -24.32407650976866, -11.953476523103532, -34.35125293626834, -30.3115442363966, -18.271375107567064, -28.560055941132344, -15.885102307721997, -9.679841865833, -23.365561681544566, -25.35508998878149, -9.166967774676797, -58.49319853375822, -43.307270395863384, -6.248465599003241, -13.812539483513488, -45.66891195798172, -39.552360990020034, -19.559965847125138, -38.741801237445955, -30.93145695212236, -40.8449928319705, -48.912926141094616, -21.960315359082983, -15.449233903287915, -33.50068692733218, -15.19778682639577, -14.585643939545859, -30.716917878474852, -25.514019611283103, -26.53444867751875, -16.044632802910204, -8.54610293269289], "policy_predator_policy_reward": [22.943102142316953, 41.618250175842874, 6.379715459428439, 40.63894221081294, 11.652069104483576, 12.024532628949384, 39.479277465448604, 31.786442656707635, 21.428426110349424, 16.912459227056324, 38.67346127170445, 29.206731733957803, 9.586628522470674, 40.77676615153024, 18.429226914955663, 6.883069055255438, 6.846660583172033, 40.862710795089654, 21.611404710341333, 28.979462680895114, 30.445357172281433, 38.13063363443832, 16.24741890848236, 11.213180446187629, 12.885162529589167, 7.779803452326615, 31.29762912568306, 18.96920889072182, 8.684470210838478, 17.10593519211604, 43.25891672608131, 10.5916437608281, 23.984866721922646, 24.872554008884748, 29.016071604296535, 19.85063587174783, 39.432722130913284, 26.01003462311119, 25.848504495305463, 2.3524929624321187, 28.210669532284168, 39.678201577601655, 27.035036390702427, 30.325226898722054, 14.999244665450805, 31.699710410661325, 22.472026521378215, 10.561416193612665, 40.6970335331541, 22.4615804408744, 16.385379124063608, 25.1964115408982, 45.49338639635012, 19.83738565230712, 20.870392770489985, 16.631123640269042, 25.130610892147317, 29.371545042145097, 27.58297930730685, 51.728043413624135, 3.983462515500694, 31.228964658651424, 16.145791261294903, 36.34846592743483, 34.397169323660535, 30.949594011798254, 26.3075143348385, 37.24717470886553, 24.32407650976866, 11.953476523103532, 34.35125293626834, 30.3115442363966, 18.271375107567064, 28.560055941132344, 15.885102307721997, 9.679841865833, 23.365561681544566, 25.35508998878149, 9.166967774676797, 58.49319853375822, 43.307270395863384, 6.248465599003241, 13.812539483513488, 45.66891195798172, 39.552360990020034, 19.559965847125138, 38.741801237445955, 30.93145695212236, 40.8449928319705, 48.912926141094616, 21.960315359082983, 15.449233903287915, 33.50068692733218, 15.19778682639577, 14.585643939545859, 30.716917878474852, 25.514019611283103, 26.53444867751875, 16.044632802910204, 8.54610293269289]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2856087349447776, "mean_inference_ms": 0.9403829514891452, "mean_action_processing_ms": 0.12568252027765175, "mean_env_wait_ms": 0.06759360387982015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00255739688873291, "StateBufferConnector_ms": 0.0020751953125, "ViewRequirementAgentConnector_ms": 0.04931294918060303}, "num_episodes": 5, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 708.6345054563985, "num_env_steps_trained_throughput_per_sec": 708.6345054563985, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 5580.688, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5580.652, "sample_time_ms": 725.462, "learn_time_ms": 4841.168, "learn_throughput": 826.247, "synch_weights_time_ms": 13.684}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 64, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-00-38", "timestamp": 1723395638, "time_this_iter_s": 5.669114112854004, "time_total_s": 356.24097776412964, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78549d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 356.24097776412964, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 33.325, "ram_util_percent": 82.23750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0401991071800392, "cur_kl_coeff": 1.1641532182693484e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09479341813615368, "policy_loss": -0.0028519104145137437, "vf_loss": 0.09764532834330263, "vf_explained_var": 0.9961844395225247, "kl": 0.002260875986206745, "entropy": 0.3211262427115192, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.158814301667735, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0981067529735204, "policy_loss": -0.012100947139212318, "vf_loss": 0.1101938797859475, "vf_explained_var": 0.9955783138051629, "kl": 0.008845050881286594, "entropy": 0.7886155385524034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -58.49319853375822, "predator_policy": 2.3524929624321187}, "policy_reward_max": {"prey_policy": -2.3524929624321187, "predator_policy": 58.49319853375822}, "policy_reward_mean": {"prey_policy": -25.37151374207974, "predator_policy": 25.37151374207974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-16.912459227056324, -38.67346127170445, -29.206731733957803, -9.586628522470674, -40.77676615153024, -18.429226914955663, -6.883069055255438, -6.846660583172033, -40.862710795089654, -21.611404710341333, -28.979462680895114, -30.445357172281433, -38.13063363443832, -16.24741890848236, -11.213180446187629, -12.885162529589167, -7.779803452326615, -31.29762912568306, -18.96920889072182, -8.684470210838478, -17.10593519211604, -43.25891672608131, -10.5916437608281, -23.984866721922646, -24.872554008884748, -29.016071604296535, -19.85063587174783, -39.432722130913284, -26.01003462311119, -25.848504495305463, -2.3524929624321187, -28.210669532284168, -39.678201577601655, -27.035036390702427, -30.325226898722054, -14.999244665450805, -31.699710410661325, -22.472026521378215, -10.561416193612665, -40.6970335331541, -22.4615804408744, -16.385379124063608, -25.1964115408982, -45.49338639635012, -19.83738565230712, -20.870392770489985, -16.631123640269042, -25.130610892147317, -29.371545042145097, -27.58297930730685, -51.728043413624135, -3.983462515500694, -31.228964658651424, -16.145791261294903, -36.34846592743483, -34.397169323660535, -30.949594011798254, -26.3075143348385, -37.24717470886553, -24.32407650976866, -11.953476523103532, -34.35125293626834, -30.3115442363966, -18.271375107567064, -28.560055941132344, -15.885102307721997, -9.679841865833, -23.365561681544566, -25.35508998878149, -9.166967774676797, -58.49319853375822, -43.307270395863384, -6.248465599003241, -13.812539483513488, -45.66891195798172, -39.552360990020034, -19.559965847125138, -38.741801237445955, -30.93145695212236, -40.8449928319705, -48.912926141094616, -21.960315359082983, -15.449233903287915, -33.50068692733218, -15.19778682639577, -14.585643939545859, -30.716917878474852, -25.514019611283103, -26.53444867751875, -16.044632802910204, -8.54610293269289, -14.556770566778583, -20.06733184266381, -15.150382658366617, -25.90289920925112, -34.04991904998431, -37.580680108753626, -28.71914250099823, -37.57489737654208, -38.479962392712835], "policy_predator_policy_reward": [16.912459227056324, 38.67346127170445, 29.206731733957803, 9.586628522470674, 40.77676615153024, 18.429226914955663, 6.883069055255438, 6.846660583172033, 40.862710795089654, 21.611404710341333, 28.979462680895114, 30.445357172281433, 38.13063363443832, 16.24741890848236, 11.213180446187629, 12.885162529589167, 7.779803452326615, 31.29762912568306, 18.96920889072182, 8.684470210838478, 17.10593519211604, 43.25891672608131, 10.5916437608281, 23.984866721922646, 24.872554008884748, 29.016071604296535, 19.85063587174783, 39.432722130913284, 26.01003462311119, 25.848504495305463, 2.3524929624321187, 28.210669532284168, 39.678201577601655, 27.035036390702427, 30.325226898722054, 14.999244665450805, 31.699710410661325, 22.472026521378215, 10.561416193612665, 40.6970335331541, 22.4615804408744, 16.385379124063608, 25.1964115408982, 45.49338639635012, 19.83738565230712, 20.870392770489985, 16.631123640269042, 25.130610892147317, 29.371545042145097, 27.58297930730685, 51.728043413624135, 3.983462515500694, 31.228964658651424, 16.145791261294903, 36.34846592743483, 34.397169323660535, 30.949594011798254, 26.3075143348385, 37.24717470886553, 24.32407650976866, 11.953476523103532, 34.35125293626834, 30.3115442363966, 18.271375107567064, 28.560055941132344, 15.885102307721997, 9.679841865833, 23.365561681544566, 25.35508998878149, 9.166967774676797, 58.49319853375822, 43.307270395863384, 6.248465599003241, 13.812539483513488, 45.66891195798172, 39.552360990020034, 19.559965847125138, 38.741801237445955, 30.93145695212236, 40.8449928319705, 48.912926141094616, 21.960315359082983, 15.449233903287915, 33.50068692733218, 15.19778682639577, 14.585643939545859, 30.716917878474852, 25.514019611283103, 26.53444867751875, 16.044632802910204, 8.54610293269289, 14.556770566778583, 20.06733184266381, 15.150382658366617, 25.90289920925112, 34.04991904998431, 37.580680108753626, 28.71914250099823, 37.57489737654208, 38.479962392712835]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28575805026240275, "mean_inference_ms": 0.9410776943168503, "mean_action_processing_ms": 0.12580254587317363, "mean_env_wait_ms": 0.06764327525328002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025496482849121094, "StateBufferConnector_ms": 0.0020734071731567383, "ViewRequirementAgentConnector_ms": 0.049135446548461914}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 726.2370793949103, "num_env_steps_trained_throughput_per_sec": 726.2370793949103, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 5593.303, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5593.264, "sample_time_ms": 730.639, "learn_time_ms": 4848.668, "learn_throughput": 824.969, "synch_weights_time_ms": 13.617}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "training_iteration": 65, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-00-43", "timestamp": 1723395643, "time_this_iter_s": 5.513894081115723, "time_total_s": 361.75487184524536, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7874550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 361.75487184524536, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 28.775000000000002, "ram_util_percent": 82.38749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0245033612474799, "cur_kl_coeff": 5.820766091346742e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1483851042823517, "policy_loss": -0.0013762283559723679, "vf_loss": 0.14976133205927908, "vf_explained_var": 0.9908703829472264, "kl": 0.0018477558555413294, "entropy": 0.31323776001421116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2472152918887636, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1385246064988981, "policy_loss": -0.008305111624940765, "vf_loss": 0.14681863525377897, "vf_explained_var": 0.9898760409404834, "kl": 0.007092955972764063, "entropy": 0.7667635633299749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -58.49319853375822, "predator_policy": 2.3524929624321187}, "policy_reward_max": {"prey_policy": -2.3524929624321187, "predator_policy": 58.49319853375822}, "policy_reward_mean": {"prey_policy": -25.70762031832653, "predator_policy": 25.70762031832653}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-21.611404710341333, -28.979462680895114, -30.445357172281433, -38.13063363443832, -16.24741890848236, -11.213180446187629, -12.885162529589167, -7.779803452326615, -31.29762912568306, -18.96920889072182, -8.684470210838478, -17.10593519211604, -43.25891672608131, -10.5916437608281, -23.984866721922646, -24.872554008884748, -29.016071604296535, -19.85063587174783, -39.432722130913284, -26.01003462311119, -25.848504495305463, -2.3524929624321187, -28.210669532284168, -39.678201577601655, -27.035036390702427, -30.325226898722054, -14.999244665450805, -31.699710410661325, -22.472026521378215, -10.561416193612665, -40.6970335331541, -22.4615804408744, -16.385379124063608, -25.1964115408982, -45.49338639635012, -19.83738565230712, -20.870392770489985, -16.631123640269042, -25.130610892147317, -29.371545042145097, -27.58297930730685, -51.728043413624135, -3.983462515500694, -31.228964658651424, -16.145791261294903, -36.34846592743483, -34.397169323660535, -30.949594011798254, -26.3075143348385, -37.24717470886553, -24.32407650976866, -11.953476523103532, -34.35125293626834, -30.3115442363966, -18.271375107567064, -28.560055941132344, -15.885102307721997, -9.679841865833, -23.365561681544566, -25.35508998878149, -9.166967774676797, -58.49319853375822, -43.307270395863384, -6.248465599003241, -13.812539483513488, -45.66891195798172, -39.552360990020034, -19.559965847125138, -38.741801237445955, -30.93145695212236, -40.8449928319705, -48.912926141094616, -21.960315359082983, -15.449233903287915, -33.50068692733218, -15.19778682639577, -14.585643939545859, -30.716917878474852, -25.514019611283103, -26.53444867751875, -16.044632802910204, -8.54610293269289, -14.556770566778583, -20.06733184266381, -15.150382658366617, -25.90289920925112, -34.04991904998431, -37.580680108753626, -28.71914250099823, -37.57489737654208, -38.479962392712835, -34.944758592904435, -20.398520181518197, -31.05686650975829, -37.05622610728636, -22.209845105156102, -23.60814878819461, -16.418443614506018, -24.243690791337904, -31.851872189209427], "policy_predator_policy_reward": [21.611404710341333, 28.979462680895114, 30.445357172281433, 38.13063363443832, 16.24741890848236, 11.213180446187629, 12.885162529589167, 7.779803452326615, 31.29762912568306, 18.96920889072182, 8.684470210838478, 17.10593519211604, 43.25891672608131, 10.5916437608281, 23.984866721922646, 24.872554008884748, 29.016071604296535, 19.85063587174783, 39.432722130913284, 26.01003462311119, 25.848504495305463, 2.3524929624321187, 28.210669532284168, 39.678201577601655, 27.035036390702427, 30.325226898722054, 14.999244665450805, 31.699710410661325, 22.472026521378215, 10.561416193612665, 40.6970335331541, 22.4615804408744, 16.385379124063608, 25.1964115408982, 45.49338639635012, 19.83738565230712, 20.870392770489985, 16.631123640269042, 25.130610892147317, 29.371545042145097, 27.58297930730685, 51.728043413624135, 3.983462515500694, 31.228964658651424, 16.145791261294903, 36.34846592743483, 34.397169323660535, 30.949594011798254, 26.3075143348385, 37.24717470886553, 24.32407650976866, 11.953476523103532, 34.35125293626834, 30.3115442363966, 18.271375107567064, 28.560055941132344, 15.885102307721997, 9.679841865833, 23.365561681544566, 25.35508998878149, 9.166967774676797, 58.49319853375822, 43.307270395863384, 6.248465599003241, 13.812539483513488, 45.66891195798172, 39.552360990020034, 19.559965847125138, 38.741801237445955, 30.93145695212236, 40.8449928319705, 48.912926141094616, 21.960315359082983, 15.449233903287915, 33.50068692733218, 15.19778682639577, 14.585643939545859, 30.716917878474852, 25.514019611283103, 26.53444867751875, 16.044632802910204, 8.54610293269289, 14.556770566778583, 20.06733184266381, 15.150382658366617, 25.90289920925112, 34.04991904998431, 37.580680108753626, 28.71914250099823, 37.57489737654208, 38.479962392712835, 34.944758592904435, 20.398520181518197, 31.05686650975829, 37.05622610728636, 22.209845105156102, 23.60814878819461, 16.418443614506018, 24.243690791337904, 31.851872189209427]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2858825888551816, "mean_inference_ms": 0.9417159495134766, "mean_action_processing_ms": 0.12591675358573964, "mean_env_wait_ms": 0.06768648334716484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002589106559753418, "StateBufferConnector_ms": 0.0020859241485595703, "ViewRequirementAgentConnector_ms": 0.04976820945739746}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 733.3403794647755, "num_env_steps_trained_throughput_per_sec": 733.3403794647755, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 5598.739, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5598.699, "sample_time_ms": 734.489, "learn_time_ms": 4850.241, "learn_throughput": 824.701, "synch_weights_time_ms": 13.629}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 66, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-00-49", "timestamp": 1723395649, "time_this_iter_s": 5.459943056106567, "time_total_s": 367.21481490135193, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7854430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 367.21481490135193, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 28.3, "ram_util_percent": 82.44285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0348726836343607, "cur_kl_coeff": 2.910383045673371e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.21186834278632888, "policy_loss": -0.000389860252228876, "vf_loss": 0.21225820254379263, "vf_explained_var": 0.9774871566643317, "kl": 0.0031053902940396043, "entropy": 0.33103610665226973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2509260817275694, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.19624902444202236, "policy_loss": -0.0061300877229465795, "vf_loss": 0.20237185425357893, "vf_explained_var": 0.9717544297377269, "kl": 0.004644732183460811, "entropy": 0.7542557205383976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -58.49319853375822, "predator_policy": 2.3524929624321187}, "policy_reward_max": {"prey_policy": -2.3524929624321187, "predator_policy": 58.49319853375822}, "policy_reward_mean": {"prey_policy": -26.161921458212518, "predator_policy": 26.161921458212518}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-18.96920889072182, -8.684470210838478, -17.10593519211604, -43.25891672608131, -10.5916437608281, -23.984866721922646, -24.872554008884748, -29.016071604296535, -19.85063587174783, -39.432722130913284, -26.01003462311119, -25.848504495305463, -2.3524929624321187, -28.210669532284168, -39.678201577601655, -27.035036390702427, -30.325226898722054, -14.999244665450805, -31.699710410661325, -22.472026521378215, -10.561416193612665, -40.6970335331541, -22.4615804408744, -16.385379124063608, -25.1964115408982, -45.49338639635012, -19.83738565230712, -20.870392770489985, -16.631123640269042, -25.130610892147317, -29.371545042145097, -27.58297930730685, -51.728043413624135, -3.983462515500694, -31.228964658651424, -16.145791261294903, -36.34846592743483, -34.397169323660535, -30.949594011798254, -26.3075143348385, -37.24717470886553, -24.32407650976866, -11.953476523103532, -34.35125293626834, -30.3115442363966, -18.271375107567064, -28.560055941132344, -15.885102307721997, -9.679841865833, -23.365561681544566, -25.35508998878149, -9.166967774676797, -58.49319853375822, -43.307270395863384, -6.248465599003241, -13.812539483513488, -45.66891195798172, -39.552360990020034, -19.559965847125138, -38.741801237445955, -30.93145695212236, -40.8449928319705, -48.912926141094616, -21.960315359082983, -15.449233903287915, -33.50068692733218, -15.19778682639577, -14.585643939545859, -30.716917878474852, -25.514019611283103, -26.53444867751875, -16.044632802910204, -8.54610293269289, -14.556770566778583, -20.06733184266381, -15.150382658366617, -25.90289920925112, -34.04991904998431, -37.580680108753626, -28.71914250099823, -37.57489737654208, -38.479962392712835, -34.944758592904435, -20.398520181518197, -31.05686650975829, -37.05622610728636, -22.209845105156102, -23.60814878819461, -16.418443614506018, -24.243690791337904, -31.851872189209427, -37.43069975198246, -27.56234165480921, -22.77908347802367, -38.728437798553884, -40.40148762261259, -31.96699841904658, -15.50255640190138, -20.845078952078502, -8.803482569815777], "policy_predator_policy_reward": [18.96920889072182, 8.684470210838478, 17.10593519211604, 43.25891672608131, 10.5916437608281, 23.984866721922646, 24.872554008884748, 29.016071604296535, 19.85063587174783, 39.432722130913284, 26.01003462311119, 25.848504495305463, 2.3524929624321187, 28.210669532284168, 39.678201577601655, 27.035036390702427, 30.325226898722054, 14.999244665450805, 31.699710410661325, 22.472026521378215, 10.561416193612665, 40.6970335331541, 22.4615804408744, 16.385379124063608, 25.1964115408982, 45.49338639635012, 19.83738565230712, 20.870392770489985, 16.631123640269042, 25.130610892147317, 29.371545042145097, 27.58297930730685, 51.728043413624135, 3.983462515500694, 31.228964658651424, 16.145791261294903, 36.34846592743483, 34.397169323660535, 30.949594011798254, 26.3075143348385, 37.24717470886553, 24.32407650976866, 11.953476523103532, 34.35125293626834, 30.3115442363966, 18.271375107567064, 28.560055941132344, 15.885102307721997, 9.679841865833, 23.365561681544566, 25.35508998878149, 9.166967774676797, 58.49319853375822, 43.307270395863384, 6.248465599003241, 13.812539483513488, 45.66891195798172, 39.552360990020034, 19.559965847125138, 38.741801237445955, 30.93145695212236, 40.8449928319705, 48.912926141094616, 21.960315359082983, 15.449233903287915, 33.50068692733218, 15.19778682639577, 14.585643939545859, 30.716917878474852, 25.514019611283103, 26.53444867751875, 16.044632802910204, 8.54610293269289, 14.556770566778583, 20.06733184266381, 15.150382658366617, 25.90289920925112, 34.04991904998431, 37.580680108753626, 28.71914250099823, 37.57489737654208, 38.479962392712835, 34.944758592904435, 20.398520181518197, 31.05686650975829, 37.05622610728636, 22.209845105156102, 23.60814878819461, 16.418443614506018, 24.243690791337904, 31.851872189209427, 37.43069975198246, 27.56234165480921, 22.77908347802367, 38.728437798553884, 40.40148762261259, 31.96699841904658, 15.50255640190138, 20.845078952078502, 8.803482569815777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28602451162488873, "mean_inference_ms": 0.9424301361722026, "mean_action_processing_ms": 0.12604443728623618, "mean_env_wait_ms": 0.06773853843405314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025974512100219727, "StateBufferConnector_ms": 0.0020885467529296875, "ViewRequirementAgentConnector_ms": 0.049843788146972656}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 739.8665126360006, "num_env_steps_trained_throughput_per_sec": 739.8665126360006, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 536000, "timers": {"training_iteration_time_ms": 5570.07, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5570.03, "sample_time_ms": 732.938, "learn_time_ms": 4823.257, "learn_throughput": 829.315, "synch_weights_time_ms": 13.502}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "done": false, "training_iteration": 67, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-00-54", "timestamp": 1723395654, "time_this_iter_s": 5.410717725753784, "time_total_s": 372.6255326271057, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7892b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 372.6255326271057, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 27.3, "ram_util_percent": 82.48750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0331686832476408, "cur_kl_coeff": 1.4551915228366855e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1437373370262018, "policy_loss": -0.0008384996845658559, "vf_loss": 0.14457583694214313, "vf_explained_var": 0.9911440912634134, "kl": 0.002163726020040239, "entropy": 0.3701168442921092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.042773339524865, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.102668599425643, "policy_loss": -0.00767972754862664, "vf_loss": 0.11034374597948045, "vf_explained_var": 0.9933538226410746, "kl": 0.005863998483386845, "entropy": 0.7384293545037508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -58.49319853375822, "predator_policy": 2.3524929624321187}, "policy_reward_max": {"prey_policy": -2.3524929624321187, "predator_policy": 58.49319853375822}, "policy_reward_mean": {"prey_policy": -26.698339349790125, "predator_policy": 26.698339349790125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-39.432722130913284, -26.01003462311119, -25.848504495305463, -2.3524929624321187, -28.210669532284168, -39.678201577601655, -27.035036390702427, -30.325226898722054, -14.999244665450805, -31.699710410661325, -22.472026521378215, -10.561416193612665, -40.6970335331541, -22.4615804408744, -16.385379124063608, -25.1964115408982, -45.49338639635012, -19.83738565230712, -20.870392770489985, -16.631123640269042, -25.130610892147317, -29.371545042145097, -27.58297930730685, -51.728043413624135, -3.983462515500694, -31.228964658651424, -16.145791261294903, -36.34846592743483, -34.397169323660535, -30.949594011798254, -26.3075143348385, -37.24717470886553, -24.32407650976866, -11.953476523103532, -34.35125293626834, -30.3115442363966, -18.271375107567064, -28.560055941132344, -15.885102307721997, -9.679841865833, -23.365561681544566, -25.35508998878149, -9.166967774676797, -58.49319853375822, -43.307270395863384, -6.248465599003241, -13.812539483513488, -45.66891195798172, -39.552360990020034, -19.559965847125138, -38.741801237445955, -30.93145695212236, -40.8449928319705, -48.912926141094616, -21.960315359082983, -15.449233903287915, -33.50068692733218, -15.19778682639577, -14.585643939545859, -30.716917878474852, -25.514019611283103, -26.53444867751875, -16.044632802910204, -8.54610293269289, -14.556770566778583, -20.06733184266381, -15.150382658366617, -25.90289920925112, -34.04991904998431, -37.580680108753626, -28.71914250099823, -37.57489737654208, -38.479962392712835, -34.944758592904435, -20.398520181518197, -31.05686650975829, -37.05622610728636, -22.209845105156102, -23.60814878819461, -16.418443614506018, -24.243690791337904, -31.851872189209427, -37.43069975198246, -27.56234165480921, -22.77908347802367, -38.728437798553884, -40.40148762261259, -31.96699841904658, -15.50255640190138, -20.845078952078502, -8.803482569815777, -19.797552177382975, -15.441335288201685, -44.983861448890224, -41.94664579818074, -3.861814076628411, -20.95776160478251, -27.95171998589796, -35.464415394875786, -39.57098637035823], "policy_predator_policy_reward": [39.432722130913284, 26.01003462311119, 25.848504495305463, 2.3524929624321187, 28.210669532284168, 39.678201577601655, 27.035036390702427, 30.325226898722054, 14.999244665450805, 31.699710410661325, 22.472026521378215, 10.561416193612665, 40.6970335331541, 22.4615804408744, 16.385379124063608, 25.1964115408982, 45.49338639635012, 19.83738565230712, 20.870392770489985, 16.631123640269042, 25.130610892147317, 29.371545042145097, 27.58297930730685, 51.728043413624135, 3.983462515500694, 31.228964658651424, 16.145791261294903, 36.34846592743483, 34.397169323660535, 30.949594011798254, 26.3075143348385, 37.24717470886553, 24.32407650976866, 11.953476523103532, 34.35125293626834, 30.3115442363966, 18.271375107567064, 28.560055941132344, 15.885102307721997, 9.679841865833, 23.365561681544566, 25.35508998878149, 9.166967774676797, 58.49319853375822, 43.307270395863384, 6.248465599003241, 13.812539483513488, 45.66891195798172, 39.552360990020034, 19.559965847125138, 38.741801237445955, 30.93145695212236, 40.8449928319705, 48.912926141094616, 21.960315359082983, 15.449233903287915, 33.50068692733218, 15.19778682639577, 14.585643939545859, 30.716917878474852, 25.514019611283103, 26.53444867751875, 16.044632802910204, 8.54610293269289, 14.556770566778583, 20.06733184266381, 15.150382658366617, 25.90289920925112, 34.04991904998431, 37.580680108753626, 28.71914250099823, 37.57489737654208, 38.479962392712835, 34.944758592904435, 20.398520181518197, 31.05686650975829, 37.05622610728636, 22.209845105156102, 23.60814878819461, 16.418443614506018, 24.243690791337904, 31.851872189209427, 37.43069975198246, 27.56234165480921, 22.77908347802367, 38.728437798553884, 40.40148762261259, 31.96699841904658, 15.50255640190138, 20.845078952078502, 8.803482569815777, 19.797552177382975, 15.441335288201685, 44.983861448890224, 41.94664579818074, 3.861814076628411, 20.95776160478251, 27.95171998589796, 35.464415394875786, 39.57098637035823]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2861946083443599, "mean_inference_ms": 0.9431801345587693, "mean_action_processing_ms": 0.12615680824183306, "mean_env_wait_ms": 0.06779217985509406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00253140926361084, "StateBufferConnector_ms": 0.0020362138748168945, "ViewRequirementAgentConnector_ms": 0.04822719097137451}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 691.4543776840289, "num_env_steps_trained_throughput_per_sec": 691.4543776840289, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 5579.494, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5579.455, "sample_time_ms": 725.694, "learn_time_ms": 4840.428, "learn_throughput": 826.373, "synch_weights_time_ms": 13.001}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 68, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-01-00", "timestamp": 1723395660, "time_this_iter_s": 5.789031982421875, "time_total_s": 378.4145646095276, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7874550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 378.4145646095276, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 35.1625, "ram_util_percent": 82.8625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3581613856678207, "cur_kl_coeff": 7.275957614183427e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2883939889705895, "policy_loss": -0.0005330403936871637, "vf_loss": 0.2889270306487257, "vf_explained_var": 0.9548871689165632, "kl": 0.003631195326696694, "entropy": 0.28225270200831193, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3169687403055528, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2686128977417563, "policy_loss": -0.012689945433521643, "vf_loss": 0.28129644704749807, "vf_explained_var": 0.9684804291774829, "kl": 0.008189098276959232, "entropy": 0.6961979054535429, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -58.49319853375822, "predator_policy": 3.861814076628411}, "policy_reward_max": {"prey_policy": -3.861814076628411, "predator_policy": 58.49319853375822}, "policy_reward_mean": {"prey_policy": -26.56427314441287, "predator_policy": 26.56427314441287}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-31.699710410661325, -22.472026521378215, -10.561416193612665, -40.6970335331541, -22.4615804408744, -16.385379124063608, -25.1964115408982, -45.49338639635012, -19.83738565230712, -20.870392770489985, -16.631123640269042, -25.130610892147317, -29.371545042145097, -27.58297930730685, -51.728043413624135, -3.983462515500694, -31.228964658651424, -16.145791261294903, -36.34846592743483, -34.397169323660535, -30.949594011798254, -26.3075143348385, -37.24717470886553, -24.32407650976866, -11.953476523103532, -34.35125293626834, -30.3115442363966, -18.271375107567064, -28.560055941132344, -15.885102307721997, -9.679841865833, -23.365561681544566, -25.35508998878149, -9.166967774676797, -58.49319853375822, -43.307270395863384, -6.248465599003241, -13.812539483513488, -45.66891195798172, -39.552360990020034, -19.559965847125138, -38.741801237445955, -30.93145695212236, -40.8449928319705, -48.912926141094616, -21.960315359082983, -15.449233903287915, -33.50068692733218, -15.19778682639577, -14.585643939545859, -30.716917878474852, -25.514019611283103, -26.53444867751875, -16.044632802910204, -8.54610293269289, -14.556770566778583, -20.06733184266381, -15.150382658366617, -25.90289920925112, -34.04991904998431, -37.580680108753626, -28.71914250099823, -37.57489737654208, -38.479962392712835, -34.944758592904435, -20.398520181518197, -31.05686650975829, -37.05622610728636, -22.209845105156102, -23.60814878819461, -16.418443614506018, -24.243690791337904, -31.851872189209427, -37.43069975198246, -27.56234165480921, -22.77908347802367, -38.728437798553884, -40.40148762261259, -31.96699841904658, -15.50255640190138, -20.845078952078502, -8.803482569815777, -19.797552177382975, -15.441335288201685, -44.983861448890224, -41.94664579818074, -3.861814076628411, -20.95776160478251, -27.95171998589796, -35.464415394875786, -39.57098637035823, -11.329095998811546, -19.320061499174805, -33.88449548595208, -11.091920480723072, -22.75459560171919, -46.8326321977528, -43.3855864918836, -27.792693442969867, -4.0944315398100315], "policy_predator_policy_reward": [31.699710410661325, 22.472026521378215, 10.561416193612665, 40.6970335331541, 22.4615804408744, 16.385379124063608, 25.1964115408982, 45.49338639635012, 19.83738565230712, 20.870392770489985, 16.631123640269042, 25.130610892147317, 29.371545042145097, 27.58297930730685, 51.728043413624135, 3.983462515500694, 31.228964658651424, 16.145791261294903, 36.34846592743483, 34.397169323660535, 30.949594011798254, 26.3075143348385, 37.24717470886553, 24.32407650976866, 11.953476523103532, 34.35125293626834, 30.3115442363966, 18.271375107567064, 28.560055941132344, 15.885102307721997, 9.679841865833, 23.365561681544566, 25.35508998878149, 9.166967774676797, 58.49319853375822, 43.307270395863384, 6.248465599003241, 13.812539483513488, 45.66891195798172, 39.552360990020034, 19.559965847125138, 38.741801237445955, 30.93145695212236, 40.8449928319705, 48.912926141094616, 21.960315359082983, 15.449233903287915, 33.50068692733218, 15.19778682639577, 14.585643939545859, 30.716917878474852, 25.514019611283103, 26.53444867751875, 16.044632802910204, 8.54610293269289, 14.556770566778583, 20.06733184266381, 15.150382658366617, 25.90289920925112, 34.04991904998431, 37.580680108753626, 28.71914250099823, 37.57489737654208, 38.479962392712835, 34.944758592904435, 20.398520181518197, 31.05686650975829, 37.05622610728636, 22.209845105156102, 23.60814878819461, 16.418443614506018, 24.243690791337904, 31.851872189209427, 37.43069975198246, 27.56234165480921, 22.77908347802367, 38.728437798553884, 40.40148762261259, 31.96699841904658, 15.50255640190138, 20.845078952078502, 8.803482569815777, 19.797552177382975, 15.441335288201685, 44.983861448890224, 41.94664579818074, 3.861814076628411, 20.95776160478251, 27.95171998589796, 35.464415394875786, 39.57098637035823, 11.329095998811546, 19.320061499174805, 33.88449548595208, 11.091920480723072, 22.75459560171919, 46.8326321977528, 43.3855864918836, 27.792693442969867, 4.0944315398100315]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.286416998833749, "mean_inference_ms": 0.9440654582112208, "mean_action_processing_ms": 0.12628317358270783, "mean_env_wait_ms": 0.06785584399293244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002538442611694336, "StateBufferConnector_ms": 0.0020291805267333984, "ViewRequirementAgentConnector_ms": 0.04839503765106201}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 695.7873370823334, "num_env_steps_trained_throughput_per_sec": 695.7873370823334, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 5585.16, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5585.122, "sample_time_ms": 706.253, "learn_time_ms": 4865.605, "learn_throughput": 822.097, "synch_weights_time_ms": 12.936}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "training_iteration": 69, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-01-06", "timestamp": 1723395666, "time_this_iter_s": 5.7547688484191895, "time_total_s": 384.1693334579468, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2faf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 384.1693334579468, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 31.475, "ram_util_percent": 82.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0027154598850756, "cur_kl_coeff": 3.6379788070917137e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.20657717626891098, "policy_loss": -0.000596290123454916, "vf_loss": 0.20717346625169739, "vf_explained_var": 0.9578499292333921, "kl": 0.0011103356031348017, "entropy": 0.24041665744346877, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1035699973503748, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.17134849858394147, "policy_loss": -0.01533812955240137, "vf_loss": 0.18667678442046357, "vf_explained_var": 0.9772367003063361, "kl": 0.012599074272414931, "entropy": 0.6219263400572042, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -58.49319853375822, "predator_policy": 3.861814076628411}, "policy_reward_max": {"prey_policy": -3.861814076628411, "predator_policy": 58.49319853375822}, "policy_reward_mean": {"prey_policy": -26.895945982372737, "predator_policy": 26.895945982372737}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-20.870392770489985, -16.631123640269042, -25.130610892147317, -29.371545042145097, -27.58297930730685, -51.728043413624135, -3.983462515500694, -31.228964658651424, -16.145791261294903, -36.34846592743483, -34.397169323660535, -30.949594011798254, -26.3075143348385, -37.24717470886553, -24.32407650976866, -11.953476523103532, -34.35125293626834, -30.3115442363966, -18.271375107567064, -28.560055941132344, -15.885102307721997, -9.679841865833, -23.365561681544566, -25.35508998878149, -9.166967774676797, -58.49319853375822, -43.307270395863384, -6.248465599003241, -13.812539483513488, -45.66891195798172, -39.552360990020034, -19.559965847125138, -38.741801237445955, -30.93145695212236, -40.8449928319705, -48.912926141094616, -21.960315359082983, -15.449233903287915, -33.50068692733218, -15.19778682639577, -14.585643939545859, -30.716917878474852, -25.514019611283103, -26.53444867751875, -16.044632802910204, -8.54610293269289, -14.556770566778583, -20.06733184266381, -15.150382658366617, -25.90289920925112, -34.04991904998431, -37.580680108753626, -28.71914250099823, -37.57489737654208, -38.479962392712835, -34.944758592904435, -20.398520181518197, -31.05686650975829, -37.05622610728636, -22.209845105156102, -23.60814878819461, -16.418443614506018, -24.243690791337904, -31.851872189209427, -37.43069975198246, -27.56234165480921, -22.77908347802367, -38.728437798553884, -40.40148762261259, -31.96699841904658, -15.50255640190138, -20.845078952078502, -8.803482569815777, -19.797552177382975, -15.441335288201685, -44.983861448890224, -41.94664579818074, -3.861814076628411, -20.95776160478251, -27.95171998589796, -35.464415394875786, -39.57098637035823, -11.329095998811546, -19.320061499174805, -33.88449548595208, -11.091920480723072, -22.75459560171919, -46.8326321977528, -43.3855864918836, -27.792693442969867, -4.0944315398100315, -33.2495283570337, -12.517230433989525, -36.12815954893587, -26.866724579310304, -12.315882590494224, -42.361436915983596, -6.501117090404515, -55.542421809598295, -42.48911228353694], "policy_predator_policy_reward": [20.870392770489985, 16.631123640269042, 25.130610892147317, 29.371545042145097, 27.58297930730685, 51.728043413624135, 3.983462515500694, 31.228964658651424, 16.145791261294903, 36.34846592743483, 34.397169323660535, 30.949594011798254, 26.3075143348385, 37.24717470886553, 24.32407650976866, 11.953476523103532, 34.35125293626834, 30.3115442363966, 18.271375107567064, 28.560055941132344, 15.885102307721997, 9.679841865833, 23.365561681544566, 25.35508998878149, 9.166967774676797, 58.49319853375822, 43.307270395863384, 6.248465599003241, 13.812539483513488, 45.66891195798172, 39.552360990020034, 19.559965847125138, 38.741801237445955, 30.93145695212236, 40.8449928319705, 48.912926141094616, 21.960315359082983, 15.449233903287915, 33.50068692733218, 15.19778682639577, 14.585643939545859, 30.716917878474852, 25.514019611283103, 26.53444867751875, 16.044632802910204, 8.54610293269289, 14.556770566778583, 20.06733184266381, 15.150382658366617, 25.90289920925112, 34.04991904998431, 37.580680108753626, 28.71914250099823, 37.57489737654208, 38.479962392712835, 34.944758592904435, 20.398520181518197, 31.05686650975829, 37.05622610728636, 22.209845105156102, 23.60814878819461, 16.418443614506018, 24.243690791337904, 31.851872189209427, 37.43069975198246, 27.56234165480921, 22.77908347802367, 38.728437798553884, 40.40148762261259, 31.96699841904658, 15.50255640190138, 20.845078952078502, 8.803482569815777, 19.797552177382975, 15.441335288201685, 44.983861448890224, 41.94664579818074, 3.861814076628411, 20.95776160478251, 27.95171998589796, 35.464415394875786, 39.57098637035823, 11.329095998811546, 19.320061499174805, 33.88449548595208, 11.091920480723072, 22.75459560171919, 46.8326321977528, 43.3855864918836, 27.792693442969867, 4.0944315398100315, 33.2495283570337, 12.517230433989525, 36.12815954893587, 26.866724579310304, 12.315882590494224, 42.361436915983596, 6.501117090404515, 55.542421809598295, 42.48911228353694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28663558384636867, "mean_inference_ms": 0.9449125958404098, "mean_action_processing_ms": 0.12639970927559369, "mean_env_wait_ms": 0.067916001412207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002551555633544922, "StateBufferConnector_ms": 0.002037525177001953, "ViewRequirementAgentConnector_ms": 0.04909312725067139}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 726.6355380015706, "num_env_steps_trained_throughput_per_sec": 726.6355380015706, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 5576.803, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5576.766, "sample_time_ms": 707.814, "learn_time_ms": 4855.456, "learn_throughput": 823.815, "synch_weights_time_ms": 13.162}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 70, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-01-11", "timestamp": 1723395671, "time_this_iter_s": 5.509696006774902, "time_total_s": 389.6790294647217, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7854430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 389.6790294647217, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 27.2, "ram_util_percent": 82.5875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0421677052043379, "cur_kl_coeff": 1.8189894035458568e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08076289809978335, "policy_loss": -0.002222522766290543, "vf_loss": 0.08298542073074107, "vf_explained_var": 0.9960091181099415, "kl": 0.00631327837595516, "entropy": 0.24452964315811793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0298942010539274, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06239155704452817, "policy_loss": -0.015459666963579366, "vf_loss": 0.07784617965032035, "vf_explained_var": 0.9965978893761833, "kl": 0.006456879163611282, "entropy": 0.6000161583845814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -58.49319853375822, "predator_policy": 1.8140205749826976}, "policy_reward_max": {"prey_policy": -1.8140205749826976, "predator_policy": 58.49319853375822}, "policy_reward_mean": {"prey_policy": -26.198265755015704, "predator_policy": 26.198265755015704}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-36.34846592743483, -34.397169323660535, -30.949594011798254, -26.3075143348385, -37.24717470886553, -24.32407650976866, -11.953476523103532, -34.35125293626834, -30.3115442363966, -18.271375107567064, -28.560055941132344, -15.885102307721997, -9.679841865833, -23.365561681544566, -25.35508998878149, -9.166967774676797, -58.49319853375822, -43.307270395863384, -6.248465599003241, -13.812539483513488, -45.66891195798172, -39.552360990020034, -19.559965847125138, -38.741801237445955, -30.93145695212236, -40.8449928319705, -48.912926141094616, -21.960315359082983, -15.449233903287915, -33.50068692733218, -15.19778682639577, -14.585643939545859, -30.716917878474852, -25.514019611283103, -26.53444867751875, -16.044632802910204, -8.54610293269289, -14.556770566778583, -20.06733184266381, -15.150382658366617, -25.90289920925112, -34.04991904998431, -37.580680108753626, -28.71914250099823, -37.57489737654208, -38.479962392712835, -34.944758592904435, -20.398520181518197, -31.05686650975829, -37.05622610728636, -22.209845105156102, -23.60814878819461, -16.418443614506018, -24.243690791337904, -31.851872189209427, -37.43069975198246, -27.56234165480921, -22.77908347802367, -38.728437798553884, -40.40148762261259, -31.96699841904658, -15.50255640190138, -20.845078952078502, -8.803482569815777, -19.797552177382975, -15.441335288201685, -44.983861448890224, -41.94664579818074, -3.861814076628411, -20.95776160478251, -27.95171998589796, -35.464415394875786, -39.57098637035823, -11.329095998811546, -19.320061499174805, -33.88449548595208, -11.091920480723072, -22.75459560171919, -46.8326321977528, -43.3855864918836, -27.792693442969867, -4.0944315398100315, -33.2495283570337, -12.517230433989525, -36.12815954893587, -26.866724579310304, -12.315882590494224, -42.361436915983596, -6.501117090404515, -55.542421809598295, -42.48911228353694, -15.800476950452595, -47.17354268060696, -17.70695922779983, -14.216738283166473, -22.615731677971652, -1.8140205749826976, -9.454248258840055, -15.43353164181724, -8.68964147008862], "policy_predator_policy_reward": [36.34846592743483, 34.397169323660535, 30.949594011798254, 26.3075143348385, 37.24717470886553, 24.32407650976866, 11.953476523103532, 34.35125293626834, 30.3115442363966, 18.271375107567064, 28.560055941132344, 15.885102307721997, 9.679841865833, 23.365561681544566, 25.35508998878149, 9.166967774676797, 58.49319853375822, 43.307270395863384, 6.248465599003241, 13.812539483513488, 45.66891195798172, 39.552360990020034, 19.559965847125138, 38.741801237445955, 30.93145695212236, 40.8449928319705, 48.912926141094616, 21.960315359082983, 15.449233903287915, 33.50068692733218, 15.19778682639577, 14.585643939545859, 30.716917878474852, 25.514019611283103, 26.53444867751875, 16.044632802910204, 8.54610293269289, 14.556770566778583, 20.06733184266381, 15.150382658366617, 25.90289920925112, 34.04991904998431, 37.580680108753626, 28.71914250099823, 37.57489737654208, 38.479962392712835, 34.944758592904435, 20.398520181518197, 31.05686650975829, 37.05622610728636, 22.209845105156102, 23.60814878819461, 16.418443614506018, 24.243690791337904, 31.851872189209427, 37.43069975198246, 27.56234165480921, 22.77908347802367, 38.728437798553884, 40.40148762261259, 31.96699841904658, 15.50255640190138, 20.845078952078502, 8.803482569815777, 19.797552177382975, 15.441335288201685, 44.983861448890224, 41.94664579818074, 3.861814076628411, 20.95776160478251, 27.95171998589796, 35.464415394875786, 39.57098637035823, 11.329095998811546, 19.320061499174805, 33.88449548595208, 11.091920480723072, 22.75459560171919, 46.8326321977528, 43.3855864918836, 27.792693442969867, 4.0944315398100315, 33.2495283570337, 12.517230433989525, 36.12815954893587, 26.866724579310304, 12.315882590494224, 42.361436915983596, 6.501117090404515, 55.542421809598295, 42.48911228353694, 15.800476950452595, 47.17354268060696, 17.70695922779983, 14.216738283166473, 22.615731677971652, 1.8140205749826976, 9.454248258840055, 15.43353164181724, 8.68964147008862]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28675263721575606, "mean_inference_ms": 0.9454745201743704, "mean_action_processing_ms": 0.126483599143146, "mean_env_wait_ms": 0.06796054168130175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002499222755432129, "StateBufferConnector_ms": 0.0019922256469726562, "ViewRequirementAgentConnector_ms": 0.0476154088973999}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 739.5298172538103, "num_env_steps_trained_throughput_per_sec": 739.5298172538103, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 568000, "timers": {"training_iteration_time_ms": 5557.302, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5557.266, "sample_time_ms": 684.863, "learn_time_ms": 4858.933, "learn_throughput": 823.226, "synch_weights_time_ms": 13.14}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "done": false, "training_iteration": 71, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-01-17", "timestamp": 1723395677, "time_this_iter_s": 5.413129806518555, "time_total_s": 395.09215927124023, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9ed1c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 395.09215927124023, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 30.025, "ram_util_percent": 82.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1302168955871215, "cur_kl_coeff": 1.8189894035458568e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08601106389493604, "policy_loss": -0.0009518271515844389, "vf_loss": 0.08696289072589328, "vf_explained_var": 0.9940234751130144, "kl": 0.004065809151070739, "entropy": 0.260449149288858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9904509372077882, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04741419990081492, "policy_loss": -0.013907719183771405, "vf_loss": 0.06131585883558728, "vf_explained_var": 0.9965920261417825, "kl": 0.007756620959854758, "entropy": 0.6044426519423723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -58.49319853375822, "predator_policy": 1.8140205749826976}, "policy_reward_max": {"prey_policy": -1.8140205749826976, "predator_policy": 58.49319853375822}, "policy_reward_mean": {"prey_policy": -25.92610144701016, "predator_policy": 25.92610144701016}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-37.24717470886553, -24.32407650976866, -11.953476523103532, -34.35125293626834, -30.3115442363966, -18.271375107567064, -28.560055941132344, -15.885102307721997, -9.679841865833, -23.365561681544566, -25.35508998878149, -9.166967774676797, -58.49319853375822, -43.307270395863384, -6.248465599003241, -13.812539483513488, -45.66891195798172, -39.552360990020034, -19.559965847125138, -38.741801237445955, -30.93145695212236, -40.8449928319705, -48.912926141094616, -21.960315359082983, -15.449233903287915, -33.50068692733218, -15.19778682639577, -14.585643939545859, -30.716917878474852, -25.514019611283103, -26.53444867751875, -16.044632802910204, -8.54610293269289, -14.556770566778583, -20.06733184266381, -15.150382658366617, -25.90289920925112, -34.04991904998431, -37.580680108753626, -28.71914250099823, -37.57489737654208, -38.479962392712835, -34.944758592904435, -20.398520181518197, -31.05686650975829, -37.05622610728636, -22.209845105156102, -23.60814878819461, -16.418443614506018, -24.243690791337904, -31.851872189209427, -37.43069975198246, -27.56234165480921, -22.77908347802367, -38.728437798553884, -40.40148762261259, -31.96699841904658, -15.50255640190138, -20.845078952078502, -8.803482569815777, -19.797552177382975, -15.441335288201685, -44.983861448890224, -41.94664579818074, -3.861814076628411, -20.95776160478251, -27.95171998589796, -35.464415394875786, -39.57098637035823, -11.329095998811546, -19.320061499174805, -33.88449548595208, -11.091920480723072, -22.75459560171919, -46.8326321977528, -43.3855864918836, -27.792693442969867, -4.0944315398100315, -33.2495283570337, -12.517230433989525, -36.12815954893587, -26.866724579310304, -12.315882590494224, -42.361436915983596, -6.501117090404515, -55.542421809598295, -42.48911228353694, -15.800476950452595, -47.17354268060696, -17.70695922779983, -14.216738283166473, -22.615731677971652, -1.8140205749826976, -9.454248258840055, -15.43353164181724, -8.68964147008862, -7.707079177761937, -18.76298315650611, -29.71910240405205, -44.59714805885781], "policy_predator_policy_reward": [37.24717470886553, 24.32407650976866, 11.953476523103532, 34.35125293626834, 30.3115442363966, 18.271375107567064, 28.560055941132344, 15.885102307721997, 9.679841865833, 23.365561681544566, 25.35508998878149, 9.166967774676797, 58.49319853375822, 43.307270395863384, 6.248465599003241, 13.812539483513488, 45.66891195798172, 39.552360990020034, 19.559965847125138, 38.741801237445955, 30.93145695212236, 40.8449928319705, 48.912926141094616, 21.960315359082983, 15.449233903287915, 33.50068692733218, 15.19778682639577, 14.585643939545859, 30.716917878474852, 25.514019611283103, 26.53444867751875, 16.044632802910204, 8.54610293269289, 14.556770566778583, 20.06733184266381, 15.150382658366617, 25.90289920925112, 34.04991904998431, 37.580680108753626, 28.71914250099823, 37.57489737654208, 38.479962392712835, 34.944758592904435, 20.398520181518197, 31.05686650975829, 37.05622610728636, 22.209845105156102, 23.60814878819461, 16.418443614506018, 24.243690791337904, 31.851872189209427, 37.43069975198246, 27.56234165480921, 22.77908347802367, 38.728437798553884, 40.40148762261259, 31.96699841904658, 15.50255640190138, 20.845078952078502, 8.803482569815777, 19.797552177382975, 15.441335288201685, 44.983861448890224, 41.94664579818074, 3.861814076628411, 20.95776160478251, 27.95171998589796, 35.464415394875786, 39.57098637035823, 11.329095998811546, 19.320061499174805, 33.88449548595208, 11.091920480723072, 22.75459560171919, 46.8326321977528, 43.3855864918836, 27.792693442969867, 4.0944315398100315, 33.2495283570337, 12.517230433989525, 36.12815954893587, 26.866724579310304, 12.315882590494224, 42.361436915983596, 6.501117090404515, 55.542421809598295, 42.48911228353694, 15.800476950452595, 47.17354268060696, 17.70695922779983, 14.216738283166473, 22.615731677971652, 1.8140205749826976, 9.454248258840055, 15.43353164181724, 8.68964147008862, 7.707079177761937, 18.76298315650611, 29.71910240405205, 44.59714805885781]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28677333794081955, "mean_inference_ms": 0.9455915320251047, "mean_action_processing_ms": 0.12649544316249525, "mean_env_wait_ms": 0.06794779243311942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024863481521606445, "StateBufferConnector_ms": 0.001984715461730957, "ViewRequirementAgentConnector_ms": 0.04727160930633545}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 749.4807934450022, "num_env_steps_trained_throughput_per_sec": 749.4807934450022, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 5552.133, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5552.095, "sample_time_ms": 684.311, "learn_time_ms": 4854.311, "learn_throughput": 824.01, "synch_weights_time_ms": 13.143}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 72, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-01-22", "timestamp": 1723395682, "time_this_iter_s": 5.341707944869995, "time_total_s": 400.43386721611023, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9ed1dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 400.43386721611023, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 26.828571428571426, "ram_util_percent": 82.62857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0162990606079498, "cur_kl_coeff": 9.094947017729284e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0694512396279606, "policy_loss": -0.003152185803143463, "vf_loss": 0.07260342582012527, "vf_explained_var": 0.9938293329750498, "kl": 0.002113705234462889, "entropy": 0.21897295592352747, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9670645140577108, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05121802207372734, "policy_loss": -0.006158720957561551, "vf_loss": 0.057373154746407334, "vf_explained_var": 0.9949963046237826, "kl": 0.004592962280360274, "entropy": 0.49806728335097433, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -58.49319853375822, "predator_policy": 1.8140205749826976}, "policy_reward_max": {"prey_policy": -1.8140205749826976, "predator_policy": 58.49319853375822}, "policy_reward_mean": {"prey_policy": -26.510480409051425, "predator_policy": 26.510480409051425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-18.271375107567064, -28.560055941132344, -15.885102307721997, -9.679841865833, -23.365561681544566, -25.35508998878149, -9.166967774676797, -58.49319853375822, -43.307270395863384, -6.248465599003241, -13.812539483513488, -45.66891195798172, -39.552360990020034, -19.559965847125138, -38.741801237445955, -30.93145695212236, -40.8449928319705, -48.912926141094616, -21.960315359082983, -15.449233903287915, -33.50068692733218, -15.19778682639577, -14.585643939545859, -30.716917878474852, -25.514019611283103, -26.53444867751875, -16.044632802910204, -8.54610293269289, -14.556770566778583, -20.06733184266381, -15.150382658366617, -25.90289920925112, -34.04991904998431, -37.580680108753626, -28.71914250099823, -37.57489737654208, -38.479962392712835, -34.944758592904435, -20.398520181518197, -31.05686650975829, -37.05622610728636, -22.209845105156102, -23.60814878819461, -16.418443614506018, -24.243690791337904, -31.851872189209427, -37.43069975198246, -27.56234165480921, -22.77908347802367, -38.728437798553884, -40.40148762261259, -31.96699841904658, -15.50255640190138, -20.845078952078502, -8.803482569815777, -19.797552177382975, -15.441335288201685, -44.983861448890224, -41.94664579818074, -3.861814076628411, -20.95776160478251, -27.95171998589796, -35.464415394875786, -39.57098637035823, -11.329095998811546, -19.320061499174805, -33.88449548595208, -11.091920480723072, -22.75459560171919, -46.8326321977528, -43.3855864918836, -27.792693442969867, -4.0944315398100315, -33.2495283570337, -12.517230433989525, -36.12815954893587, -26.866724579310304, -12.315882590494224, -42.361436915983596, -6.501117090404515, -55.542421809598295, -42.48911228353694, -15.800476950452595, -47.17354268060696, -17.70695922779983, -14.216738283166473, -22.615731677971652, -1.8140205749826976, -9.454248258840055, -15.43353164181724, -8.68964147008862, -7.707079177761937, -18.76298315650611, -29.71910240405205, -44.59714805885781, -26.737941358407888, -45.48734940013729, -38.879819310541535, -36.08685639530788, -49.43345465413472], "policy_predator_policy_reward": [18.271375107567064, 28.560055941132344, 15.885102307721997, 9.679841865833, 23.365561681544566, 25.35508998878149, 9.166967774676797, 58.49319853375822, 43.307270395863384, 6.248465599003241, 13.812539483513488, 45.66891195798172, 39.552360990020034, 19.559965847125138, 38.741801237445955, 30.93145695212236, 40.8449928319705, 48.912926141094616, 21.960315359082983, 15.449233903287915, 33.50068692733218, 15.19778682639577, 14.585643939545859, 30.716917878474852, 25.514019611283103, 26.53444867751875, 16.044632802910204, 8.54610293269289, 14.556770566778583, 20.06733184266381, 15.150382658366617, 25.90289920925112, 34.04991904998431, 37.580680108753626, 28.71914250099823, 37.57489737654208, 38.479962392712835, 34.944758592904435, 20.398520181518197, 31.05686650975829, 37.05622610728636, 22.209845105156102, 23.60814878819461, 16.418443614506018, 24.243690791337904, 31.851872189209427, 37.43069975198246, 27.56234165480921, 22.77908347802367, 38.728437798553884, 40.40148762261259, 31.96699841904658, 15.50255640190138, 20.845078952078502, 8.803482569815777, 19.797552177382975, 15.441335288201685, 44.983861448890224, 41.94664579818074, 3.861814076628411, 20.95776160478251, 27.95171998589796, 35.464415394875786, 39.57098637035823, 11.329095998811546, 19.320061499174805, 33.88449548595208, 11.091920480723072, 22.75459560171919, 46.8326321977528, 43.3855864918836, 27.792693442969867, 4.0944315398100315, 33.2495283570337, 12.517230433989525, 36.12815954893587, 26.866724579310304, 12.315882590494224, 42.361436915983596, 6.501117090404515, 55.542421809598295, 42.48911228353694, 15.800476950452595, 47.17354268060696, 17.70695922779983, 14.216738283166473, 22.615731677971652, 1.8140205749826976, 9.454248258840055, 15.43353164181724, 8.68964147008862, 7.707079177761937, 18.76298315650611, 29.71910240405205, 44.59714805885781, 26.737941358407888, 45.48734940013729, 38.879819310541535, 36.08685639530788, 49.43345465413472]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28684295907455404, "mean_inference_ms": 0.9459199453459455, "mean_action_processing_ms": 0.1265608516709383, "mean_env_wait_ms": 0.0679953369329571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025017261505126953, "StateBufferConnector_ms": 0.0019807815551757812, "ViewRequirementAgentConnector_ms": 0.04562711715698242}, "num_episodes": 5, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 709.0253834750147, "num_env_steps_trained_throughput_per_sec": 709.0253834750147, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 584000, "timers": {"training_iteration_time_ms": 5543.951, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5543.912, "sample_time_ms": 657.876, "learn_time_ms": 4872.583, "learn_throughput": 820.92, "synch_weights_time_ms": 13.084}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "done": false, "training_iteration": 73, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-01-28", "timestamp": 1723395688, "time_this_iter_s": 5.672834873199463, "time_total_s": 406.1067020893097, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9ed1310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 406.1067020893097, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 31.05, "ram_util_percent": 82.6125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0228109541038672, "cur_kl_coeff": 4.547473508864642e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.15019565990708847, "policy_loss": 0.0004439500846880643, "vf_loss": 0.1497517097838378, "vf_explained_var": 0.9851905315493544, "kl": 0.0012928219416666147, "entropy": 0.18299006641221544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2568848936197659, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1404498142373389, "policy_loss": -0.005450388303628036, "vf_loss": 0.14589934345373573, "vf_explained_var": 0.9883405195549131, "kl": 0.0021976659585303724, "entropy": 0.4603634700489541, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -55.542421809598295, "predator_policy": 1.8140205749826976}, "policy_reward_max": {"prey_policy": -1.8140205749826976, "predator_policy": 55.542421809598295}, "policy_reward_mean": {"prey_policy": -26.265976572897515, "predator_policy": 26.265976572897515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-6.248465599003241, -13.812539483513488, -45.66891195798172, -39.552360990020034, -19.559965847125138, -38.741801237445955, -30.93145695212236, -40.8449928319705, -48.912926141094616, -21.960315359082983, -15.449233903287915, -33.50068692733218, -15.19778682639577, -14.585643939545859, -30.716917878474852, -25.514019611283103, -26.53444867751875, -16.044632802910204, -8.54610293269289, -14.556770566778583, -20.06733184266381, -15.150382658366617, -25.90289920925112, -34.04991904998431, -37.580680108753626, -28.71914250099823, -37.57489737654208, -38.479962392712835, -34.944758592904435, -20.398520181518197, -31.05686650975829, -37.05622610728636, -22.209845105156102, -23.60814878819461, -16.418443614506018, -24.243690791337904, -31.851872189209427, -37.43069975198246, -27.56234165480921, -22.77908347802367, -38.728437798553884, -40.40148762261259, -31.96699841904658, -15.50255640190138, -20.845078952078502, -8.803482569815777, -19.797552177382975, -15.441335288201685, -44.983861448890224, -41.94664579818074, -3.861814076628411, -20.95776160478251, -27.95171998589796, -35.464415394875786, -39.57098637035823, -11.329095998811546, -19.320061499174805, -33.88449548595208, -11.091920480723072, -22.75459560171919, -46.8326321977528, -43.3855864918836, -27.792693442969867, -4.0944315398100315, -33.2495283570337, -12.517230433989525, -36.12815954893587, -26.866724579310304, -12.315882590494224, -42.361436915983596, -6.501117090404515, -55.542421809598295, -42.48911228353694, -15.800476950452595, -47.17354268060696, -17.70695922779983, -14.216738283166473, -22.615731677971652, -1.8140205749826976, -9.454248258840055, -15.43353164181724, -8.68964147008862, -7.707079177761937, -18.76298315650611, -29.71910240405205, -44.59714805885781, -26.737941358407888, -45.48734940013729, -38.879819310541535, -36.08685639530788, -49.43345465413472, -17.35705477424239, -26.499806857220847, -28.829817335102174, -15.083272070220954, -5.017549817429212, -51.28375741301588, -24.198137626327618, -25.519061497984705, -13.845622589943842], "policy_predator_policy_reward": [6.248465599003241, 13.812539483513488, 45.66891195798172, 39.552360990020034, 19.559965847125138, 38.741801237445955, 30.93145695212236, 40.8449928319705, 48.912926141094616, 21.960315359082983, 15.449233903287915, 33.50068692733218, 15.19778682639577, 14.585643939545859, 30.716917878474852, 25.514019611283103, 26.53444867751875, 16.044632802910204, 8.54610293269289, 14.556770566778583, 20.06733184266381, 15.150382658366617, 25.90289920925112, 34.04991904998431, 37.580680108753626, 28.71914250099823, 37.57489737654208, 38.479962392712835, 34.944758592904435, 20.398520181518197, 31.05686650975829, 37.05622610728636, 22.209845105156102, 23.60814878819461, 16.418443614506018, 24.243690791337904, 31.851872189209427, 37.43069975198246, 27.56234165480921, 22.77908347802367, 38.728437798553884, 40.40148762261259, 31.96699841904658, 15.50255640190138, 20.845078952078502, 8.803482569815777, 19.797552177382975, 15.441335288201685, 44.983861448890224, 41.94664579818074, 3.861814076628411, 20.95776160478251, 27.95171998589796, 35.464415394875786, 39.57098637035823, 11.329095998811546, 19.320061499174805, 33.88449548595208, 11.091920480723072, 22.75459560171919, 46.8326321977528, 43.3855864918836, 27.792693442969867, 4.0944315398100315, 33.2495283570337, 12.517230433989525, 36.12815954893587, 26.866724579310304, 12.315882590494224, 42.361436915983596, 6.501117090404515, 55.542421809598295, 42.48911228353694, 15.800476950452595, 47.17354268060696, 17.70695922779983, 14.216738283166473, 22.615731677971652, 1.8140205749826976, 9.454248258840055, 15.43353164181724, 8.68964147008862, 7.707079177761937, 18.76298315650611, 29.71910240405205, 44.59714805885781, 26.737941358407888, 45.48734940013729, 38.879819310541535, 36.08685639530788, 49.43345465413472, 17.35705477424239, 26.499806857220847, 28.829817335102174, 15.083272070220954, 5.017549817429212, 51.28375741301588, 24.198137626327618, 25.519061497984705, 13.845622589943842]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2867907855681633, "mean_inference_ms": 0.9459540750731592, "mean_action_processing_ms": 0.1265849702906235, "mean_env_wait_ms": 0.0679955961036107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002498149871826172, "StateBufferConnector_ms": 0.001961946487426758, "ViewRequirementAgentConnector_ms": 0.04535520076751709}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 716.9066302348157, "num_env_steps_trained_throughput_per_sec": 716.9066302348157, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 5537.441, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5537.399, "sample_time_ms": 653.647, "learn_time_ms": 4870.259, "learn_throughput": 821.312, "synch_weights_time_ms": 13.129}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 74, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-01-33", "timestamp": 1723395693, "time_this_iter_s": 5.584425210952759, "time_total_s": 411.69112730026245, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 411.69112730026245, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 28.212500000000002, "ram_util_percent": 82.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1589550204885504, "cur_kl_coeff": 2.273736754432321e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1365905217314624, "policy_loss": -0.000847813589158856, "vf_loss": 0.1374383355937122, "vf_explained_var": 0.9939074910556277, "kl": 0.001433485568122082, "entropy": 0.21600707905987898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3006468646849194, "cur_kl_coeff": 0.00019531250000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.12060201126041648, "policy_loss": -0.011738413383621566, "vf_loss": 0.13233921241092805, "vf_explained_var": 0.9932597504928709, "kl": 0.006208687017766705, "entropy": 0.49569863999883335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -55.542421809598295, "predator_policy": 1.8140205749826976}, "policy_reward_max": {"prey_policy": -1.8140205749826976, "predator_policy": 55.542421809598295}, "policy_reward_mean": {"prey_policy": -25.491973880734815, "predator_policy": 25.491973880734815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-21.960315359082983, -15.449233903287915, -33.50068692733218, -15.19778682639577, -14.585643939545859, -30.716917878474852, -25.514019611283103, -26.53444867751875, -16.044632802910204, -8.54610293269289, -14.556770566778583, -20.06733184266381, -15.150382658366617, -25.90289920925112, -34.04991904998431, -37.580680108753626, -28.71914250099823, -37.57489737654208, -38.479962392712835, -34.944758592904435, -20.398520181518197, -31.05686650975829, -37.05622610728636, -22.209845105156102, -23.60814878819461, -16.418443614506018, -24.243690791337904, -31.851872189209427, -37.43069975198246, -27.56234165480921, -22.77908347802367, -38.728437798553884, -40.40148762261259, -31.96699841904658, -15.50255640190138, -20.845078952078502, -8.803482569815777, -19.797552177382975, -15.441335288201685, -44.983861448890224, -41.94664579818074, -3.861814076628411, -20.95776160478251, -27.95171998589796, -35.464415394875786, -39.57098637035823, -11.329095998811546, -19.320061499174805, -33.88449548595208, -11.091920480723072, -22.75459560171919, -46.8326321977528, -43.3855864918836, -27.792693442969867, -4.0944315398100315, -33.2495283570337, -12.517230433989525, -36.12815954893587, -26.866724579310304, -12.315882590494224, -42.361436915983596, -6.501117090404515, -55.542421809598295, -42.48911228353694, -15.800476950452595, -47.17354268060696, -17.70695922779983, -14.216738283166473, -22.615731677971652, -1.8140205749826976, -9.454248258840055, -15.43353164181724, -8.68964147008862, -7.707079177761937, -18.76298315650611, -29.71910240405205, -44.59714805885781, -26.737941358407888, -45.48734940013729, -38.879819310541535, -36.08685639530788, -49.43345465413472, -17.35705477424239, -26.499806857220847, -28.829817335102174, -15.083272070220954, -5.017549817429212, -51.28375741301588, -24.198137626327618, -25.519061497984705, -13.845622589943842, -32.203355109573565, -17.10721401290221, -11.020799055421522, -23.955540179542325, -26.19163855074058, -40.03053820882677, -26.911512994182775, -8.249301139927734, -21.20325257288897], "policy_predator_policy_reward": [21.960315359082983, 15.449233903287915, 33.50068692733218, 15.19778682639577, 14.585643939545859, 30.716917878474852, 25.514019611283103, 26.53444867751875, 16.044632802910204, 8.54610293269289, 14.556770566778583, 20.06733184266381, 15.150382658366617, 25.90289920925112, 34.04991904998431, 37.580680108753626, 28.71914250099823, 37.57489737654208, 38.479962392712835, 34.944758592904435, 20.398520181518197, 31.05686650975829, 37.05622610728636, 22.209845105156102, 23.60814878819461, 16.418443614506018, 24.243690791337904, 31.851872189209427, 37.43069975198246, 27.56234165480921, 22.77908347802367, 38.728437798553884, 40.40148762261259, 31.96699841904658, 15.50255640190138, 20.845078952078502, 8.803482569815777, 19.797552177382975, 15.441335288201685, 44.983861448890224, 41.94664579818074, 3.861814076628411, 20.95776160478251, 27.95171998589796, 35.464415394875786, 39.57098637035823, 11.329095998811546, 19.320061499174805, 33.88449548595208, 11.091920480723072, 22.75459560171919, 46.8326321977528, 43.3855864918836, 27.792693442969867, 4.0944315398100315, 33.2495283570337, 12.517230433989525, 36.12815954893587, 26.866724579310304, 12.315882590494224, 42.361436915983596, 6.501117090404515, 55.542421809598295, 42.48911228353694, 15.800476950452595, 47.17354268060696, 17.70695922779983, 14.216738283166473, 22.615731677971652, 1.8140205749826976, 9.454248258840055, 15.43353164181724, 8.68964147008862, 7.707079177761937, 18.76298315650611, 29.71910240405205, 44.59714805885781, 26.737941358407888, 45.48734940013729, 38.879819310541535, 36.08685639530788, 49.43345465413472, 17.35705477424239, 26.499806857220847, 28.829817335102174, 15.083272070220954, 5.017549817429212, 51.28375741301588, 24.198137626327618, 25.519061497984705, 13.845622589943842, 32.203355109573565, 17.10721401290221, 11.020799055421522, 23.955540179542325, 26.19163855074058, 40.03053820882677, 26.911512994182775, 8.249301139927734, 21.20325257288897]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28674486796584775, "mean_inference_ms": 0.9460130497935495, "mean_action_processing_ms": 0.12661415915617777, "mean_env_wait_ms": 0.06799901444305384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002555370330810547, "StateBufferConnector_ms": 0.0019769668579101562, "ViewRequirementAgentConnector_ms": 0.04549431800842285}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 736.6384734950334, "num_env_steps_trained_throughput_per_sec": 736.6384734950334, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 5529.661, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5529.622, "sample_time_ms": 650.354, "learn_time_ms": 4865.642, "learn_throughput": 822.091, "synch_weights_time_ms": 13.264}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 75, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-01-39", "timestamp": 1723395699, "time_this_iter_s": 5.4349822998046875, "time_total_s": 417.12610960006714, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9ed1550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 417.12610960006714, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 30.35, "ram_util_percent": 82.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0907685632817448, "cur_kl_coeff": 1.1368683772161605e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09140676182820849, "policy_loss": -0.0014837824307808963, "vf_loss": 0.092890544293914, "vf_explained_var": 0.9967539427181085, "kl": 0.0027714751587758824, "entropy": 0.18307010240387173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0983534031081945, "cur_kl_coeff": 0.00019531250000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07780369258143764, "policy_loss": -0.0045219672024056, "vf_loss": 0.08232517286863489, "vf_explained_var": 0.9969412236164014, "kl": 0.002493943355133288, "entropy": 0.4969630274921656, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -55.542421809598295, "predator_policy": 1.8140205749826976}, "policy_reward_max": {"prey_policy": -1.8140205749826976, "predator_policy": 55.542421809598295}, "policy_reward_mean": {"prey_policy": -25.88341086651321, "predator_policy": 25.88341086651321}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-8.54610293269289, -14.556770566778583, -20.06733184266381, -15.150382658366617, -25.90289920925112, -34.04991904998431, -37.580680108753626, -28.71914250099823, -37.57489737654208, -38.479962392712835, -34.944758592904435, -20.398520181518197, -31.05686650975829, -37.05622610728636, -22.209845105156102, -23.60814878819461, -16.418443614506018, -24.243690791337904, -31.851872189209427, -37.43069975198246, -27.56234165480921, -22.77908347802367, -38.728437798553884, -40.40148762261259, -31.96699841904658, -15.50255640190138, -20.845078952078502, -8.803482569815777, -19.797552177382975, -15.441335288201685, -44.983861448890224, -41.94664579818074, -3.861814076628411, -20.95776160478251, -27.95171998589796, -35.464415394875786, -39.57098637035823, -11.329095998811546, -19.320061499174805, -33.88449548595208, -11.091920480723072, -22.75459560171919, -46.8326321977528, -43.3855864918836, -27.792693442969867, -4.0944315398100315, -33.2495283570337, -12.517230433989525, -36.12815954893587, -26.866724579310304, -12.315882590494224, -42.361436915983596, -6.501117090404515, -55.542421809598295, -42.48911228353694, -15.800476950452595, -47.17354268060696, -17.70695922779983, -14.216738283166473, -22.615731677971652, -1.8140205749826976, -9.454248258840055, -15.43353164181724, -8.68964147008862, -7.707079177761937, -18.76298315650611, -29.71910240405205, -44.59714805885781, -26.737941358407888, -45.48734940013729, -38.879819310541535, -36.08685639530788, -49.43345465413472, -17.35705477424239, -26.499806857220847, -28.829817335102174, -15.083272070220954, -5.017549817429212, -51.28375741301588, -24.198137626327618, -25.519061497984705, -13.845622589943842, -32.203355109573565, -17.10721401290221, -11.020799055421522, -23.955540179542325, -26.19163855074058, -40.03053820882677, -26.911512994182775, -8.249301139927734, -21.20325257288897, -47.13713617721615, -15.655070545226726, -17.573179330421382, -12.962582483229923, -19.40123145042067, -39.8210516917707, -26.521021210028024, -36.322717368983135, -23.253394246375137], "policy_predator_policy_reward": [8.54610293269289, 14.556770566778583, 20.06733184266381, 15.150382658366617, 25.90289920925112, 34.04991904998431, 37.580680108753626, 28.71914250099823, 37.57489737654208, 38.479962392712835, 34.944758592904435, 20.398520181518197, 31.05686650975829, 37.05622610728636, 22.209845105156102, 23.60814878819461, 16.418443614506018, 24.243690791337904, 31.851872189209427, 37.43069975198246, 27.56234165480921, 22.77908347802367, 38.728437798553884, 40.40148762261259, 31.96699841904658, 15.50255640190138, 20.845078952078502, 8.803482569815777, 19.797552177382975, 15.441335288201685, 44.983861448890224, 41.94664579818074, 3.861814076628411, 20.95776160478251, 27.95171998589796, 35.464415394875786, 39.57098637035823, 11.329095998811546, 19.320061499174805, 33.88449548595208, 11.091920480723072, 22.75459560171919, 46.8326321977528, 43.3855864918836, 27.792693442969867, 4.0944315398100315, 33.2495283570337, 12.517230433989525, 36.12815954893587, 26.866724579310304, 12.315882590494224, 42.361436915983596, 6.501117090404515, 55.542421809598295, 42.48911228353694, 15.800476950452595, 47.17354268060696, 17.70695922779983, 14.216738283166473, 22.615731677971652, 1.8140205749826976, 9.454248258840055, 15.43353164181724, 8.68964147008862, 7.707079177761937, 18.76298315650611, 29.71910240405205, 44.59714805885781, 26.737941358407888, 45.48734940013729, 38.879819310541535, 36.08685639530788, 49.43345465413472, 17.35705477424239, 26.499806857220847, 28.829817335102174, 15.083272070220954, 5.017549817429212, 51.28375741301588, 24.198137626327618, 25.519061497984705, 13.845622589943842, 32.203355109573565, 17.10721401290221, 11.020799055421522, 23.955540179542325, 26.19163855074058, 40.03053820882677, 26.911512994182775, 8.249301139927734, 21.20325257288897, 47.13713617721615, 15.655070545226726, 17.573179330421382, 12.962582483229923, 19.40123145042067, 39.8210516917707, 26.521021210028024, 36.322717368983135, 23.253394246375137]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2865760241068209, "mean_inference_ms": 0.9456325881192816, "mean_action_processing_ms": 0.1265849374430527, "mean_env_wait_ms": 0.06795286659531385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002552509307861328, "StateBufferConnector_ms": 0.001966238021850586, "ViewRequirementAgentConnector_ms": 0.04539608955383301}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 762.881987991118, "num_env_steps_trained_throughput_per_sec": 762.881987991118, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 5508.539, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5508.5, "sample_time_ms": 648.408, "learn_time_ms": 4846.404, "learn_throughput": 825.354, "synch_weights_time_ms": 13.326}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 76, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-01-44", "timestamp": 1723395704, "time_this_iter_s": 5.248340845108032, "time_total_s": 422.37445044517517, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2f940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 422.37445044517517, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 26.4125, "ram_util_percent": 82.73750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8928794914080451, "cur_kl_coeff": 5.6843418860808026e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09400770333268156, "policy_loss": -0.0002791839697844504, "vf_loss": 0.09428688791425278, "vf_explained_var": 0.9938601788133383, "kl": 0.002908377888840389, "entropy": 0.17910179312651356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0816064144484698, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0984105916389551, "policy_loss": -0.011871579138824018, "vf_loss": 0.11028145849898768, "vf_explained_var": 0.9915267911429206, "kl": 0.007289904803409542, "entropy": 0.4684327615424991, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -55.542421809598295, "predator_policy": 1.8140205749826976}, "policy_reward_max": {"prey_policy": -1.8140205749826976, "predator_policy": 55.542421809598295}, "policy_reward_mean": {"prey_policy": -26.10984860861307, "predator_policy": 26.10984860861307}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-38.479962392712835, -34.944758592904435, -20.398520181518197, -31.05686650975829, -37.05622610728636, -22.209845105156102, -23.60814878819461, -16.418443614506018, -24.243690791337904, -31.851872189209427, -37.43069975198246, -27.56234165480921, -22.77908347802367, -38.728437798553884, -40.40148762261259, -31.96699841904658, -15.50255640190138, -20.845078952078502, -8.803482569815777, -19.797552177382975, -15.441335288201685, -44.983861448890224, -41.94664579818074, -3.861814076628411, -20.95776160478251, -27.95171998589796, -35.464415394875786, -39.57098637035823, -11.329095998811546, -19.320061499174805, -33.88449548595208, -11.091920480723072, -22.75459560171919, -46.8326321977528, -43.3855864918836, -27.792693442969867, -4.0944315398100315, -33.2495283570337, -12.517230433989525, -36.12815954893587, -26.866724579310304, -12.315882590494224, -42.361436915983596, -6.501117090404515, -55.542421809598295, -42.48911228353694, -15.800476950452595, -47.17354268060696, -17.70695922779983, -14.216738283166473, -22.615731677971652, -1.8140205749826976, -9.454248258840055, -15.43353164181724, -8.68964147008862, -7.707079177761937, -18.76298315650611, -29.71910240405205, -44.59714805885781, -26.737941358407888, -45.48734940013729, -38.879819310541535, -36.08685639530788, -49.43345465413472, -17.35705477424239, -26.499806857220847, -28.829817335102174, -15.083272070220954, -5.017549817429212, -51.28375741301588, -24.198137626327618, -25.519061497984705, -13.845622589943842, -32.203355109573565, -17.10721401290221, -11.020799055421522, -23.955540179542325, -26.19163855074058, -40.03053820882677, -26.911512994182775, -8.249301139927734, -21.20325257288897, -47.13713617721615, -15.655070545226726, -17.573179330421382, -12.962582483229923, -19.40123145042067, -39.8210516917707, -26.521021210028024, -36.322717368983135, -23.253394246375137, -46.3293937840854, -35.964657782362586, -17.92604156378123, -34.68657664589833, -14.592225796989014, -8.388020895354172, -26.33757808711987, -24.89654801805055, -35.67085788237628], "policy_predator_policy_reward": [38.479962392712835, 34.944758592904435, 20.398520181518197, 31.05686650975829, 37.05622610728636, 22.209845105156102, 23.60814878819461, 16.418443614506018, 24.243690791337904, 31.851872189209427, 37.43069975198246, 27.56234165480921, 22.77908347802367, 38.728437798553884, 40.40148762261259, 31.96699841904658, 15.50255640190138, 20.845078952078502, 8.803482569815777, 19.797552177382975, 15.441335288201685, 44.983861448890224, 41.94664579818074, 3.861814076628411, 20.95776160478251, 27.95171998589796, 35.464415394875786, 39.57098637035823, 11.329095998811546, 19.320061499174805, 33.88449548595208, 11.091920480723072, 22.75459560171919, 46.8326321977528, 43.3855864918836, 27.792693442969867, 4.0944315398100315, 33.2495283570337, 12.517230433989525, 36.12815954893587, 26.866724579310304, 12.315882590494224, 42.361436915983596, 6.501117090404515, 55.542421809598295, 42.48911228353694, 15.800476950452595, 47.17354268060696, 17.70695922779983, 14.216738283166473, 22.615731677971652, 1.8140205749826976, 9.454248258840055, 15.43353164181724, 8.68964147008862, 7.707079177761937, 18.76298315650611, 29.71910240405205, 44.59714805885781, 26.737941358407888, 45.48734940013729, 38.879819310541535, 36.08685639530788, 49.43345465413472, 17.35705477424239, 26.499806857220847, 28.829817335102174, 15.083272070220954, 5.017549817429212, 51.28375741301588, 24.198137626327618, 25.519061497984705, 13.845622589943842, 32.203355109573565, 17.10721401290221, 11.020799055421522, 23.955540179542325, 26.19163855074058, 40.03053820882677, 26.911512994182775, 8.249301139927734, 21.20325257288897, 47.13713617721615, 15.655070545226726, 17.573179330421382, 12.962582483229923, 19.40123145042067, 39.8210516917707, 26.521021210028024, 36.322717368983135, 23.253394246375137, 46.3293937840854, 35.964657782362586, 17.92604156378123, 34.68657664589833, 14.592225796989014, 8.388020895354172, 26.33757808711987, 24.89654801805055, 35.67085788237628]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2863746013412731, "mean_inference_ms": 0.945027184859334, "mean_action_processing_ms": 0.12652405493705013, "mean_env_wait_ms": 0.06787452510987028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002595067024230957, "StateBufferConnector_ms": 0.002007007598876953, "ViewRequirementAgentConnector_ms": 0.046430349349975586}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 774.6478034328687, "num_env_steps_trained_throughput_per_sec": 774.6478034328687, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 616000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 616000, "timers": {"training_iteration_time_ms": 5484.265, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5484.226, "sample_time_ms": 655.825, "learn_time_ms": 4814.726, "learn_throughput": 830.785, "synch_weights_time_ms": 13.31}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "done": false, "training_iteration": 77, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-01-49", "timestamp": 1723395709, "time_this_iter_s": 5.167983770370483, "time_total_s": 427.54243421554565, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 427.54243421554565, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 26.700000000000006, "ram_util_percent": 82.67142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2106767130084335, "cur_kl_coeff": 2.8421709430404013e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.14064070559470565, "policy_loss": -0.0005418793579641108, "vf_loss": 0.1411825850819393, "vf_explained_var": 0.9930652691051364, "kl": 0.0021313576167234756, "entropy": 0.1952136922472467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2516846405963102, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.13961013047819507, "policy_loss": -0.004342581718810834, "vf_loss": 0.14395221541441666, "vf_explained_var": 0.9927021236469348, "kl": 0.005088426680200857, "entropy": 0.4528925736434758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -55.542421809598295, "predator_policy": 0.8039535970710219}, "policy_reward_max": {"prey_policy": -0.8039535970710219, "predator_policy": 55.542421809598295}, "policy_reward_mean": {"prey_policy": -25.73217021823156, "predator_policy": 25.73217021823156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-31.851872189209427, -37.43069975198246, -27.56234165480921, -22.77908347802367, -38.728437798553884, -40.40148762261259, -31.96699841904658, -15.50255640190138, -20.845078952078502, -8.803482569815777, -19.797552177382975, -15.441335288201685, -44.983861448890224, -41.94664579818074, -3.861814076628411, -20.95776160478251, -27.95171998589796, -35.464415394875786, -39.57098637035823, -11.329095998811546, -19.320061499174805, -33.88449548595208, -11.091920480723072, -22.75459560171919, -46.8326321977528, -43.3855864918836, -27.792693442969867, -4.0944315398100315, -33.2495283570337, -12.517230433989525, -36.12815954893587, -26.866724579310304, -12.315882590494224, -42.361436915983596, -6.501117090404515, -55.542421809598295, -42.48911228353694, -15.800476950452595, -47.17354268060696, -17.70695922779983, -14.216738283166473, -22.615731677971652, -1.8140205749826976, -9.454248258840055, -15.43353164181724, -8.68964147008862, -7.707079177761937, -18.76298315650611, -29.71910240405205, -44.59714805885781, -26.737941358407888, -45.48734940013729, -38.879819310541535, -36.08685639530788, -49.43345465413472, -17.35705477424239, -26.499806857220847, -28.829817335102174, -15.083272070220954, -5.017549817429212, -51.28375741301588, -24.198137626327618, -25.519061497984705, -13.845622589943842, -32.203355109573565, -17.10721401290221, -11.020799055421522, -23.955540179542325, -26.19163855074058, -40.03053820882677, -26.911512994182775, -8.249301139927734, -21.20325257288897, -47.13713617721615, -15.655070545226726, -17.573179330421382, -12.962582483229923, -19.40123145042067, -39.8210516917707, -26.521021210028024, -36.322717368983135, -23.253394246375137, -46.3293937840854, -35.964657782362586, -17.92604156378123, -34.68657664589833, -14.592225796989014, -8.388020895354172, -26.33757808711987, -24.89654801805055, -35.67085788237628, -19.298444068127825, -9.472398385651935, -28.253881232985023, -30.576415642439166, -29.30386385006976, -0.8039535970710219, -24.309755961662944, -41.49703778277352, -27.132872524441797], "policy_predator_policy_reward": [31.851872189209427, 37.43069975198246, 27.56234165480921, 22.77908347802367, 38.728437798553884, 40.40148762261259, 31.96699841904658, 15.50255640190138, 20.845078952078502, 8.803482569815777, 19.797552177382975, 15.441335288201685, 44.983861448890224, 41.94664579818074, 3.861814076628411, 20.95776160478251, 27.95171998589796, 35.464415394875786, 39.57098637035823, 11.329095998811546, 19.320061499174805, 33.88449548595208, 11.091920480723072, 22.75459560171919, 46.8326321977528, 43.3855864918836, 27.792693442969867, 4.0944315398100315, 33.2495283570337, 12.517230433989525, 36.12815954893587, 26.866724579310304, 12.315882590494224, 42.361436915983596, 6.501117090404515, 55.542421809598295, 42.48911228353694, 15.800476950452595, 47.17354268060696, 17.70695922779983, 14.216738283166473, 22.615731677971652, 1.8140205749826976, 9.454248258840055, 15.43353164181724, 8.68964147008862, 7.707079177761937, 18.76298315650611, 29.71910240405205, 44.59714805885781, 26.737941358407888, 45.48734940013729, 38.879819310541535, 36.08685639530788, 49.43345465413472, 17.35705477424239, 26.499806857220847, 28.829817335102174, 15.083272070220954, 5.017549817429212, 51.28375741301588, 24.198137626327618, 25.519061497984705, 13.845622589943842, 32.203355109573565, 17.10721401290221, 11.020799055421522, 23.955540179542325, 26.19163855074058, 40.03053820882677, 26.911512994182775, 8.249301139927734, 21.20325257288897, 47.13713617721615, 15.655070545226726, 17.573179330421382, 12.962582483229923, 19.40123145042067, 39.8210516917707, 26.521021210028024, 36.322717368983135, 23.253394246375137, 46.3293937840854, 35.964657782362586, 17.92604156378123, 34.68657664589833, 14.592225796989014, 8.388020895354172, 26.33757808711987, 24.89654801805055, 35.67085788237628, 19.298444068127825, 9.472398385651935, 28.253881232985023, 30.576415642439166, 29.30386385006976, 0.8039535970710219, 24.309755961662944, 41.49703778277352, 27.132872524441797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28619187300387877, "mean_inference_ms": 0.9444860487703225, "mean_action_processing_ms": 0.12647581047960535, "mean_env_wait_ms": 0.06779968839519475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025899410247802734, "StateBufferConnector_ms": 0.002151966094970703, "ViewRequirementAgentConnector_ms": 0.04670083522796631}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 740.6645985245173, "num_env_steps_trained_throughput_per_sec": 740.6645985245173, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 5445.83, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5445.791, "sample_time_ms": 660.715, "learn_time_ms": 4771.49, "learn_throughput": 838.313, "synch_weights_time_ms": 13.224}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 78, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-01-55", "timestamp": 1723395715, "time_this_iter_s": 5.406038999557495, "time_total_s": 432.94847321510315, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e08430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 432.94847321510315, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 27.587500000000002, "ram_util_percent": 82.57499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2128395681579909, "cur_kl_coeff": 1.4210854715202006e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.13080874412601892, "policy_loss": -0.002925457126790813, "vf_loss": 0.1337342003903662, "vf_explained_var": 0.9961213480060299, "kl": 0.00353862576314668, "entropy": 0.15915933926201736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2498203981046876, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.12116291238698977, "policy_loss": -0.00536137803804498, "vf_loss": 0.12652391416292327, "vf_explained_var": 0.9961602358147502, "kl": 0.0038632475055692264, "entropy": 0.4282515300127367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -55.542421809598295, "predator_policy": 0.8039535970710219}, "policy_reward_max": {"prey_policy": -0.8039535970710219, "predator_policy": 55.542421809598295}, "policy_reward_mean": {"prey_policy": -25.18912387861834, "predator_policy": 25.18912387861834}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-8.803482569815777, -19.797552177382975, -15.441335288201685, -44.983861448890224, -41.94664579818074, -3.861814076628411, -20.95776160478251, -27.95171998589796, -35.464415394875786, -39.57098637035823, -11.329095998811546, -19.320061499174805, -33.88449548595208, -11.091920480723072, -22.75459560171919, -46.8326321977528, -43.3855864918836, -27.792693442969867, -4.0944315398100315, -33.2495283570337, -12.517230433989525, -36.12815954893587, -26.866724579310304, -12.315882590494224, -42.361436915983596, -6.501117090404515, -55.542421809598295, -42.48911228353694, -15.800476950452595, -47.17354268060696, -17.70695922779983, -14.216738283166473, -22.615731677971652, -1.8140205749826976, -9.454248258840055, -15.43353164181724, -8.68964147008862, -7.707079177761937, -18.76298315650611, -29.71910240405205, -44.59714805885781, -26.737941358407888, -45.48734940013729, -38.879819310541535, -36.08685639530788, -49.43345465413472, -17.35705477424239, -26.499806857220847, -28.829817335102174, -15.083272070220954, -5.017549817429212, -51.28375741301588, -24.198137626327618, -25.519061497984705, -13.845622589943842, -32.203355109573565, -17.10721401290221, -11.020799055421522, -23.955540179542325, -26.19163855074058, -40.03053820882677, -26.911512994182775, -8.249301139927734, -21.20325257288897, -47.13713617721615, -15.655070545226726, -17.573179330421382, -12.962582483229923, -19.40123145042067, -39.8210516917707, -26.521021210028024, -36.322717368983135, -23.253394246375137, -46.3293937840854, -35.964657782362586, -17.92604156378123, -34.68657664589833, -14.592225796989014, -8.388020895354172, -26.33757808711987, -24.89654801805055, -35.67085788237628, -19.298444068127825, -9.472398385651935, -28.253881232985023, -30.576415642439166, -29.30386385006976, -0.8039535970710219, -24.309755961662944, -41.49703778277352, -27.132872524441797, -20.64017107346463, -40.238031805355654, -24.37688067426022, -15.726527991308108, -7.485440284971657, -18.103762436296496, -19.985596459231918, -36.62895876608411, -29.578552815923246], "policy_predator_policy_reward": [8.803482569815777, 19.797552177382975, 15.441335288201685, 44.983861448890224, 41.94664579818074, 3.861814076628411, 20.95776160478251, 27.95171998589796, 35.464415394875786, 39.57098637035823, 11.329095998811546, 19.320061499174805, 33.88449548595208, 11.091920480723072, 22.75459560171919, 46.8326321977528, 43.3855864918836, 27.792693442969867, 4.0944315398100315, 33.2495283570337, 12.517230433989525, 36.12815954893587, 26.866724579310304, 12.315882590494224, 42.361436915983596, 6.501117090404515, 55.542421809598295, 42.48911228353694, 15.800476950452595, 47.17354268060696, 17.70695922779983, 14.216738283166473, 22.615731677971652, 1.8140205749826976, 9.454248258840055, 15.43353164181724, 8.68964147008862, 7.707079177761937, 18.76298315650611, 29.71910240405205, 44.59714805885781, 26.737941358407888, 45.48734940013729, 38.879819310541535, 36.08685639530788, 49.43345465413472, 17.35705477424239, 26.499806857220847, 28.829817335102174, 15.083272070220954, 5.017549817429212, 51.28375741301588, 24.198137626327618, 25.519061497984705, 13.845622589943842, 32.203355109573565, 17.10721401290221, 11.020799055421522, 23.955540179542325, 26.19163855074058, 40.03053820882677, 26.911512994182775, 8.249301139927734, 21.20325257288897, 47.13713617721615, 15.655070545226726, 17.573179330421382, 12.962582483229923, 19.40123145042067, 39.8210516917707, 26.521021210028024, 36.322717368983135, 23.253394246375137, 46.3293937840854, 35.964657782362586, 17.92604156378123, 34.68657664589833, 14.592225796989014, 8.388020895354172, 26.33757808711987, 24.89654801805055, 35.67085788237628, 19.298444068127825, 9.472398385651935, 28.253881232985023, 30.576415642439166, 29.30386385006976, 0.8039535970710219, 24.309755961662944, 41.49703778277352, 27.132872524441797, 20.64017107346463, 40.238031805355654, 24.37688067426022, 15.726527991308108, 7.485440284971657, 18.103762436296496, 19.985596459231918, 36.62895876608411, 29.578552815923246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2860740312769093, "mean_inference_ms": 0.9441572180921893, "mean_action_processing_ms": 0.12644869876475204, "mean_env_wait_ms": 0.06773895104974455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026477575302124023, "StateBufferConnector_ms": 0.0021970272064208984, "ViewRequirementAgentConnector_ms": 0.04837393760681152}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 685.436330354241, "num_env_steps_trained_throughput_per_sec": 685.436330354241, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 632000, "timers": {"training_iteration_time_ms": 5454.511, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5454.473, "sample_time_ms": 666.095, "learn_time_ms": 4774.782, "learn_throughput": 837.735, "synch_weights_time_ms": 13.233}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "done": false, "training_iteration": 79, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-02-01", "timestamp": 1723395721, "time_this_iter_s": 5.840638875961304, "time_total_s": 438.78911209106445, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x325f46c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 438.78911209106445, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 32.2125, "ram_util_percent": 82.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8874285355831186, "cur_kl_coeff": 7.105427357601003e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07270638294091138, "policy_loss": -0.0010634021787457944, "vf_loss": 0.07376978514948859, "vf_explained_var": 0.9941493369018038, "kl": 0.0018864537344212466, "entropy": 0.15882505177675435, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.039952734609445, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05744069855055992, "policy_loss": -0.00829964187796577, "vf_loss": 0.06574012494917648, "vf_explained_var": 0.994184415973723, "kl": 0.004415885478138339, "entropy": 0.4073137418056528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -55.542421809598295, "predator_policy": 0.8039535970710219}, "policy_reward_max": {"prey_policy": -0.8039535970710219, "predator_policy": 55.542421809598295}, "policy_reward_mean": {"prey_policy": -25.613401436563755, "predator_policy": 25.613401436563755}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-39.57098637035823, -11.329095998811546, -19.320061499174805, -33.88449548595208, -11.091920480723072, -22.75459560171919, -46.8326321977528, -43.3855864918836, -27.792693442969867, -4.0944315398100315, -33.2495283570337, -12.517230433989525, -36.12815954893587, -26.866724579310304, -12.315882590494224, -42.361436915983596, -6.501117090404515, -55.542421809598295, -42.48911228353694, -15.800476950452595, -47.17354268060696, -17.70695922779983, -14.216738283166473, -22.615731677971652, -1.8140205749826976, -9.454248258840055, -15.43353164181724, -8.68964147008862, -7.707079177761937, -18.76298315650611, -29.71910240405205, -44.59714805885781, -26.737941358407888, -45.48734940013729, -38.879819310541535, -36.08685639530788, -49.43345465413472, -17.35705477424239, -26.499806857220847, -28.829817335102174, -15.083272070220954, -5.017549817429212, -51.28375741301588, -24.198137626327618, -25.519061497984705, -13.845622589943842, -32.203355109573565, -17.10721401290221, -11.020799055421522, -23.955540179542325, -26.19163855074058, -40.03053820882677, -26.911512994182775, -8.249301139927734, -21.20325257288897, -47.13713617721615, -15.655070545226726, -17.573179330421382, -12.962582483229923, -19.40123145042067, -39.8210516917707, -26.521021210028024, -36.322717368983135, -23.253394246375137, -46.3293937840854, -35.964657782362586, -17.92604156378123, -34.68657664589833, -14.592225796989014, -8.388020895354172, -26.33757808711987, -24.89654801805055, -35.67085788237628, -19.298444068127825, -9.472398385651935, -28.253881232985023, -30.576415642439166, -29.30386385006976, -0.8039535970710219, -24.309755961662944, -41.49703778277352, -27.132872524441797, -20.64017107346463, -40.238031805355654, -24.37688067426022, -15.726527991308108, -7.485440284971657, -18.103762436296496, -19.985596459231918, -36.62895876608411, -29.578552815923246, -35.56904904253925, -9.299578455847369, -39.37248821663691, -19.842577332502618, -24.824155906443483, -42.2428737750496, -25.111299808154648, -35.25959323649358, -30.114728365530105], "policy_predator_policy_reward": [39.57098637035823, 11.329095998811546, 19.320061499174805, 33.88449548595208, 11.091920480723072, 22.75459560171919, 46.8326321977528, 43.3855864918836, 27.792693442969867, 4.0944315398100315, 33.2495283570337, 12.517230433989525, 36.12815954893587, 26.866724579310304, 12.315882590494224, 42.361436915983596, 6.501117090404515, 55.542421809598295, 42.48911228353694, 15.800476950452595, 47.17354268060696, 17.70695922779983, 14.216738283166473, 22.615731677971652, 1.8140205749826976, 9.454248258840055, 15.43353164181724, 8.68964147008862, 7.707079177761937, 18.76298315650611, 29.71910240405205, 44.59714805885781, 26.737941358407888, 45.48734940013729, 38.879819310541535, 36.08685639530788, 49.43345465413472, 17.35705477424239, 26.499806857220847, 28.829817335102174, 15.083272070220954, 5.017549817429212, 51.28375741301588, 24.198137626327618, 25.519061497984705, 13.845622589943842, 32.203355109573565, 17.10721401290221, 11.020799055421522, 23.955540179542325, 26.19163855074058, 40.03053820882677, 26.911512994182775, 8.249301139927734, 21.20325257288897, 47.13713617721615, 15.655070545226726, 17.573179330421382, 12.962582483229923, 19.40123145042067, 39.8210516917707, 26.521021210028024, 36.322717368983135, 23.253394246375137, 46.3293937840854, 35.964657782362586, 17.92604156378123, 34.68657664589833, 14.592225796989014, 8.388020895354172, 26.33757808711987, 24.89654801805055, 35.67085788237628, 19.298444068127825, 9.472398385651935, 28.253881232985023, 30.576415642439166, 29.30386385006976, 0.8039535970710219, 24.309755961662944, 41.49703778277352, 27.132872524441797, 20.64017107346463, 40.238031805355654, 24.37688067426022, 15.726527991308108, 7.485440284971657, 18.103762436296496, 19.985596459231918, 36.62895876608411, 29.578552815923246, 35.56904904253925, 9.299578455847369, 39.37248821663691, 19.842577332502618, 24.824155906443483, 42.2428737750496, 25.111299808154648, 35.25959323649358, 30.114728365530105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2860192756453159, "mean_inference_ms": 0.9449255946379916, "mean_action_processing_ms": 0.12643759676735392, "mean_env_wait_ms": 0.06769161043545342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027121305465698242, "StateBufferConnector_ms": 0.0023145675659179688, "ViewRequirementAgentConnector_ms": 0.05079972743988037}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 619.5819727565445, "num_env_steps_trained_throughput_per_sec": 619.5819727565445, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 5549.663, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5549.422, "sample_time_ms": 724.844, "learn_time_ms": 4810.11, "learn_throughput": 831.582, "synch_weights_time_ms": 13.74}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 80, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-02-07", "timestamp": 1723395727, "time_this_iter_s": 6.5277252197265625, "time_total_s": 445.316837310791, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7854ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 445.316837310791, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 53.05555555555556, "ram_util_percent": 82.65555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9769675122263531, "cur_kl_coeff": 3.5527136788005016e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08174494489527812, "policy_loss": -0.002781602019967977, "vf_loss": 0.08452654717839322, "vf_explained_var": 0.9933769914632042, "kl": 0.0028325863157077193, "entropy": 0.17962906726946434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0692029929719866, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08022616498977489, "policy_loss": -0.007902467909783202, "vf_loss": 0.08812849550158716, "vf_explained_var": 0.9928445043663184, "kl": 0.005603363995797898, "entropy": 0.4313891132051746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -55.542421809598295, "predator_policy": -0.026246688910982474}, "policy_reward_max": {"prey_policy": 0.026246688910982474, "predator_policy": 55.542421809598295}, "policy_reward_mean": {"prey_policy": -25.517046259731263, "predator_policy": 25.517046259731263}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-11.091920480723072, -22.75459560171919, -46.8326321977528, -43.3855864918836, -27.792693442969867, -4.0944315398100315, -33.2495283570337, -12.517230433989525, -36.12815954893587, -26.866724579310304, -12.315882590494224, -42.361436915983596, -6.501117090404515, -55.542421809598295, -42.48911228353694, -15.800476950452595, -47.17354268060696, -17.70695922779983, -14.216738283166473, -22.615731677971652, -1.8140205749826976, -9.454248258840055, -15.43353164181724, -8.68964147008862, -7.707079177761937, -18.76298315650611, -29.71910240405205, -44.59714805885781, -26.737941358407888, -45.48734940013729, -38.879819310541535, -36.08685639530788, -49.43345465413472, -17.35705477424239, -26.499806857220847, -28.829817335102174, -15.083272070220954, -5.017549817429212, -51.28375741301588, -24.198137626327618, -25.519061497984705, -13.845622589943842, -32.203355109573565, -17.10721401290221, -11.020799055421522, -23.955540179542325, -26.19163855074058, -40.03053820882677, -26.911512994182775, -8.249301139927734, -21.20325257288897, -47.13713617721615, -15.655070545226726, -17.573179330421382, -12.962582483229923, -19.40123145042067, -39.8210516917707, -26.521021210028024, -36.322717368983135, -23.253394246375137, -46.3293937840854, -35.964657782362586, -17.92604156378123, -34.68657664589833, -14.592225796989014, -8.388020895354172, -26.33757808711987, -24.89654801805055, -35.67085788237628, -19.298444068127825, -9.472398385651935, -28.253881232985023, -30.576415642439166, -29.30386385006976, -0.8039535970710219, -24.309755961662944, -41.49703778277352, -27.132872524441797, -20.64017107346463, -40.238031805355654, -24.37688067426022, -15.726527991308108, -7.485440284971657, -18.103762436296496, -19.985596459231918, -36.62895876608411, -29.578552815923246, -35.56904904253925, -9.299578455847369, -39.37248821663691, -19.842577332502618, -24.824155906443483, -42.2428737750496, -25.111299808154648, -35.25959323649358, -30.114728365530105, -44.30559213548801, -23.937209272195087, -26.252566952275306, 0.026246688910982474], "policy_predator_policy_reward": [11.091920480723072, 22.75459560171919, 46.8326321977528, 43.3855864918836, 27.792693442969867, 4.0944315398100315, 33.2495283570337, 12.517230433989525, 36.12815954893587, 26.866724579310304, 12.315882590494224, 42.361436915983596, 6.501117090404515, 55.542421809598295, 42.48911228353694, 15.800476950452595, 47.17354268060696, 17.70695922779983, 14.216738283166473, 22.615731677971652, 1.8140205749826976, 9.454248258840055, 15.43353164181724, 8.68964147008862, 7.707079177761937, 18.76298315650611, 29.71910240405205, 44.59714805885781, 26.737941358407888, 45.48734940013729, 38.879819310541535, 36.08685639530788, 49.43345465413472, 17.35705477424239, 26.499806857220847, 28.829817335102174, 15.083272070220954, 5.017549817429212, 51.28375741301588, 24.198137626327618, 25.519061497984705, 13.845622589943842, 32.203355109573565, 17.10721401290221, 11.020799055421522, 23.955540179542325, 26.19163855074058, 40.03053820882677, 26.911512994182775, 8.249301139927734, 21.20325257288897, 47.13713617721615, 15.655070545226726, 17.573179330421382, 12.962582483229923, 19.40123145042067, 39.8210516917707, 26.521021210028024, 36.322717368983135, 23.253394246375137, 46.3293937840854, 35.964657782362586, 17.92604156378123, 34.68657664589833, 14.592225796989014, 8.388020895354172, 26.33757808711987, 24.89654801805055, 35.67085788237628, 19.298444068127825, 9.472398385651935, 28.253881232985023, 30.576415642439166, 29.30386385006976, 0.8039535970710219, 24.309755961662944, 41.49703778277352, 27.132872524441797, 20.64017107346463, 40.238031805355654, 24.37688067426022, 15.726527991308108, 7.485440284971657, 18.103762436296496, 19.985596459231918, 36.62895876608411, 29.578552815923246, 35.56904904253925, 9.299578455847369, 39.37248821663691, 19.842577332502618, 24.824155906443483, 42.2428737750496, 25.111299808154648, 35.25959323649358, 30.114728365530105, 44.30559213548801, 23.937209272195087, 26.252566952275306, -0.026246688910982474]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28595020309160823, "mean_inference_ms": 0.9451987481895621, "mean_action_processing_ms": 0.12641033062327722, "mean_env_wait_ms": 0.06766887343315812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002717137336730957, "StateBufferConnector_ms": 0.0023366212844848633, "ViewRequirementAgentConnector_ms": 0.05093276500701904}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 709.6795370937193, "num_env_steps_trained_throughput_per_sec": 709.6795370937193, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 5572.416, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5572.172, "sample_time_ms": 734.556, "learn_time_ms": 4823.065, "learn_throughput": 829.348, "synch_weights_time_ms": 13.784}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "training_iteration": 81, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-02-13", "timestamp": 1723395733, "time_this_iter_s": 5.6410980224609375, "time_total_s": 450.95793533325195, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a785a8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 450.95793533325195, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 36.6125, "ram_util_percent": 83.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0115121007741739, "cur_kl_coeff": 1.7763568394002508e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08029754895202738, "policy_loss": -0.001103370306373108, "vf_loss": 0.081400919262281, "vf_explained_var": 0.9955459999541442, "kl": 0.0017773373815220253, "entropy": 0.14767147313104942, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0105585381543885, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06974787103119601, "policy_loss": -0.008666090541131174, "vf_loss": 0.07841384354202698, "vf_explained_var": 0.9957623682295282, "kl": 0.004817378634089013, "entropy": 0.4100929696733753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -55.542421809598295, "predator_policy": -0.026246688910982474}, "policy_reward_max": {"prey_policy": 0.026246688910982474, "predator_policy": 55.542421809598295}, "policy_reward_mean": {"prey_policy": -24.963835919617605, "predator_policy": 24.963835919617605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-4.0944315398100315, -33.2495283570337, -12.517230433989525, -36.12815954893587, -26.866724579310304, -12.315882590494224, -42.361436915983596, -6.501117090404515, -55.542421809598295, -42.48911228353694, -15.800476950452595, -47.17354268060696, -17.70695922779983, -14.216738283166473, -22.615731677971652, -1.8140205749826976, -9.454248258840055, -15.43353164181724, -8.68964147008862, -7.707079177761937, -18.76298315650611, -29.71910240405205, -44.59714805885781, -26.737941358407888, -45.48734940013729, -38.879819310541535, -36.08685639530788, -49.43345465413472, -17.35705477424239, -26.499806857220847, -28.829817335102174, -15.083272070220954, -5.017549817429212, -51.28375741301588, -24.198137626327618, -25.519061497984705, -13.845622589943842, -32.203355109573565, -17.10721401290221, -11.020799055421522, -23.955540179542325, -26.19163855074058, -40.03053820882677, -26.911512994182775, -8.249301139927734, -21.20325257288897, -47.13713617721615, -15.655070545226726, -17.573179330421382, -12.962582483229923, -19.40123145042067, -39.8210516917707, -26.521021210028024, -36.322717368983135, -23.253394246375137, -46.3293937840854, -35.964657782362586, -17.92604156378123, -34.68657664589833, -14.592225796989014, -8.388020895354172, -26.33757808711987, -24.89654801805055, -35.67085788237628, -19.298444068127825, -9.472398385651935, -28.253881232985023, -30.576415642439166, -29.30386385006976, -0.8039535970710219, -24.309755961662944, -41.49703778277352, -27.132872524441797, -20.64017107346463, -40.238031805355654, -24.37688067426022, -15.726527991308108, -7.485440284971657, -18.103762436296496, -19.985596459231918, -36.62895876608411, -29.578552815923246, -35.56904904253925, -9.299578455847369, -39.37248821663691, -19.842577332502618, -24.824155906443483, -42.2428737750496, -25.111299808154648, -35.25959323649358, -30.114728365530105, -44.30559213548801, -23.937209272195087, -26.252566952275306, 0.026246688910982474, -9.46632889224162, -45.58488925554185, -15.573148854841346, -11.99516136420667, -13.916865836851242], "policy_predator_policy_reward": [4.0944315398100315, 33.2495283570337, 12.517230433989525, 36.12815954893587, 26.866724579310304, 12.315882590494224, 42.361436915983596, 6.501117090404515, 55.542421809598295, 42.48911228353694, 15.800476950452595, 47.17354268060696, 17.70695922779983, 14.216738283166473, 22.615731677971652, 1.8140205749826976, 9.454248258840055, 15.43353164181724, 8.68964147008862, 7.707079177761937, 18.76298315650611, 29.71910240405205, 44.59714805885781, 26.737941358407888, 45.48734940013729, 38.879819310541535, 36.08685639530788, 49.43345465413472, 17.35705477424239, 26.499806857220847, 28.829817335102174, 15.083272070220954, 5.017549817429212, 51.28375741301588, 24.198137626327618, 25.519061497984705, 13.845622589943842, 32.203355109573565, 17.10721401290221, 11.020799055421522, 23.955540179542325, 26.19163855074058, 40.03053820882677, 26.911512994182775, 8.249301139927734, 21.20325257288897, 47.13713617721615, 15.655070545226726, 17.573179330421382, 12.962582483229923, 19.40123145042067, 39.8210516917707, 26.521021210028024, 36.322717368983135, 23.253394246375137, 46.3293937840854, 35.964657782362586, 17.92604156378123, 34.68657664589833, 14.592225796989014, 8.388020895354172, 26.33757808711987, 24.89654801805055, 35.67085788237628, 19.298444068127825, 9.472398385651935, 28.253881232985023, 30.576415642439166, 29.30386385006976, 0.8039535970710219, 24.309755961662944, 41.49703778277352, 27.132872524441797, 20.64017107346463, 40.238031805355654, 24.37688067426022, 15.726527991308108, 7.485440284971657, 18.103762436296496, 19.985596459231918, 36.62895876608411, 29.578552815923246, 35.56904904253925, 9.299578455847369, 39.37248821663691, 19.842577332502618, 24.824155906443483, 42.2428737750496, 25.111299808154648, 35.25959323649358, 30.114728365530105, 44.30559213548801, 23.937209272195087, 26.252566952275306, -0.026246688910982474, 9.46632889224162, 45.58488925554185, 15.573148854841346, 11.99516136420667, 13.916865836851242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28598581544572005, "mean_inference_ms": 0.9457617194455863, "mean_action_processing_ms": 0.12643836484853543, "mean_env_wait_ms": 0.06766335212851544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002716660499572754, "StateBufferConnector_ms": 0.0023423433303833008, "ViewRequirementAgentConnector_ms": 0.05095779895782471}, "num_episodes": 5, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 728.2585373508217, "num_env_steps_trained_throughput_per_sec": 728.2585373508217, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 5587.967, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5587.725, "sample_time_ms": 737.079, "learn_time_ms": 4836.041, "learn_throughput": 827.123, "synch_weights_time_ms": 13.839}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 82, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-02-18", "timestamp": 1723395738, "time_this_iter_s": 5.497647762298584, "time_total_s": 456.45558309555054, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x325f46c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 456.45558309555054, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 27.4, "ram_util_percent": 82.9375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0614853015479941, "cur_kl_coeff": 8.881784197001254e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.11253170254931319, "policy_loss": 0.0007507944161867878, "vf_loss": 0.11178090842440724, "vf_explained_var": 0.9908538817117611, "kl": 0.0019397957800594287, "entropy": 0.14664211227403331, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.020276625951131, "cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.10743812382534088, "policy_loss": -0.010461756335522902, "vf_loss": 0.11789978873954775, "vf_explained_var": 0.9898433045173685, "kl": 0.007532944004219629, "entropy": 0.3794406654934088, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.28375741301588, "predator_policy": -0.026246688910982474}, "policy_reward_max": {"prey_policy": 0.026246688910982474, "predator_policy": 51.28375741301588}, "policy_reward_mean": {"prey_policy": -25.16011465117789, "predator_policy": 25.16011465117789}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-42.48911228353694, -15.800476950452595, -47.17354268060696, -17.70695922779983, -14.216738283166473, -22.615731677971652, -1.8140205749826976, -9.454248258840055, -15.43353164181724, -8.68964147008862, -7.707079177761937, -18.76298315650611, -29.71910240405205, -44.59714805885781, -26.737941358407888, -45.48734940013729, -38.879819310541535, -36.08685639530788, -49.43345465413472, -17.35705477424239, -26.499806857220847, -28.829817335102174, -15.083272070220954, -5.017549817429212, -51.28375741301588, -24.198137626327618, -25.519061497984705, -13.845622589943842, -32.203355109573565, -17.10721401290221, -11.020799055421522, -23.955540179542325, -26.19163855074058, -40.03053820882677, -26.911512994182775, -8.249301139927734, -21.20325257288897, -47.13713617721615, -15.655070545226726, -17.573179330421382, -12.962582483229923, -19.40123145042067, -39.8210516917707, -26.521021210028024, -36.322717368983135, -23.253394246375137, -46.3293937840854, -35.964657782362586, -17.92604156378123, -34.68657664589833, -14.592225796989014, -8.388020895354172, -26.33757808711987, -24.89654801805055, -35.67085788237628, -19.298444068127825, -9.472398385651935, -28.253881232985023, -30.576415642439166, -29.30386385006976, -0.8039535970710219, -24.309755961662944, -41.49703778277352, -27.132872524441797, -20.64017107346463, -40.238031805355654, -24.37688067426022, -15.726527991308108, -7.485440284971657, -18.103762436296496, -19.985596459231918, -36.62895876608411, -29.578552815923246, -35.56904904253925, -9.299578455847369, -39.37248821663691, -19.842577332502618, -24.824155906443483, -42.2428737750496, -25.111299808154648, -35.25959323649358, -30.114728365530105, -44.30559213548801, -23.937209272195087, -26.252566952275306, 0.026246688910982474, -9.46632889224162, -45.58488925554185, -15.573148854841346, -11.99516136420667, -13.916865836851242, -33.44360185584716, -20.547095565135567, -33.88949433274668, -15.505079166559913, -37.88309566852536, -16.224680237061403, -37.99066666583815, -26.453743454814774, -27.267349075059514], "policy_predator_policy_reward": [42.48911228353694, 15.800476950452595, 47.17354268060696, 17.70695922779983, 14.216738283166473, 22.615731677971652, 1.8140205749826976, 9.454248258840055, 15.43353164181724, 8.68964147008862, 7.707079177761937, 18.76298315650611, 29.71910240405205, 44.59714805885781, 26.737941358407888, 45.48734940013729, 38.879819310541535, 36.08685639530788, 49.43345465413472, 17.35705477424239, 26.499806857220847, 28.829817335102174, 15.083272070220954, 5.017549817429212, 51.28375741301588, 24.198137626327618, 25.519061497984705, 13.845622589943842, 32.203355109573565, 17.10721401290221, 11.020799055421522, 23.955540179542325, 26.19163855074058, 40.03053820882677, 26.911512994182775, 8.249301139927734, 21.20325257288897, 47.13713617721615, 15.655070545226726, 17.573179330421382, 12.962582483229923, 19.40123145042067, 39.8210516917707, 26.521021210028024, 36.322717368983135, 23.253394246375137, 46.3293937840854, 35.964657782362586, 17.92604156378123, 34.68657664589833, 14.592225796989014, 8.388020895354172, 26.33757808711987, 24.89654801805055, 35.67085788237628, 19.298444068127825, 9.472398385651935, 28.253881232985023, 30.576415642439166, 29.30386385006976, 0.8039535970710219, 24.309755961662944, 41.49703778277352, 27.132872524441797, 20.64017107346463, 40.238031805355654, 24.37688067426022, 15.726527991308108, 7.485440284971657, 18.103762436296496, 19.985596459231918, 36.62895876608411, 29.578552815923246, 35.56904904253925, 9.299578455847369, 39.37248821663691, 19.842577332502618, 24.824155906443483, 42.2428737750496, 25.111299808154648, 35.25959323649358, 30.114728365530105, 44.30559213548801, 23.937209272195087, 26.252566952275306, -0.026246688910982474, 9.46632889224162, 45.58488925554185, 15.573148854841346, 11.99516136420667, 13.916865836851242, 33.44360185584716, 20.547095565135567, 33.88949433274668, 15.505079166559913, 37.88309566852536, 16.224680237061403, 37.99066666583815, 26.453743454814774, 27.267349075059514]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28593044996883105, "mean_inference_ms": 0.9465197235689421, "mean_action_processing_ms": 0.12643217365624337, "mean_env_wait_ms": 0.06763089204308381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002741575241088867, "StateBufferConnector_ms": 0.0023508071899414062, "ViewRequirementAgentConnector_ms": 0.050775885581970215}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 742.7065557120358, "num_env_steps_trained_throughput_per_sec": 742.7065557120358, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 664000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 664000, "timers": {"training_iteration_time_ms": 5562.383, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5562.142, "sample_time_ms": 740.046, "learn_time_ms": 4807.696, "learn_throughput": 831.999, "synch_weights_time_ms": 13.671}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "done": false, "training_iteration": 83, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-02-24", "timestamp": 1723395744, "time_this_iter_s": 5.391143798828125, "time_total_s": 461.84672689437866, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7854310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 461.84672689437866, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 28.3, "ram_util_percent": 82.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1899537992508462, "cur_kl_coeff": 4.440892098500627e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.12262645783339395, "policy_loss": 0.00021403004551151145, "vf_loss": 0.12241242801731762, "vf_explained_var": 0.9949517720689376, "kl": 0.002683131717090866, "entropy": 0.13064494443436464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1535098263683419, "cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.10638082186918231, "policy_loss": -0.0032734149843842413, "vf_loss": 0.10965420689220386, "vf_explained_var": 0.9955271638929843, "kl": 0.002509157599967073, "entropy": 0.37057146976391475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.60658024637951, "predator_policy": -0.026246688910982474}, "policy_reward_max": {"prey_policy": 0.026246688910982474, "predator_policy": 51.60658024637951}, "policy_reward_mean": {"prey_policy": -25.787523308993855, "predator_policy": 25.787523308993855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-8.68964147008862, -7.707079177761937, -18.76298315650611, -29.71910240405205, -44.59714805885781, -26.737941358407888, -45.48734940013729, -38.879819310541535, -36.08685639530788, -49.43345465413472, -17.35705477424239, -26.499806857220847, -28.829817335102174, -15.083272070220954, -5.017549817429212, -51.28375741301588, -24.198137626327618, -25.519061497984705, -13.845622589943842, -32.203355109573565, -17.10721401290221, -11.020799055421522, -23.955540179542325, -26.19163855074058, -40.03053820882677, -26.911512994182775, -8.249301139927734, -21.20325257288897, -47.13713617721615, -15.655070545226726, -17.573179330421382, -12.962582483229923, -19.40123145042067, -39.8210516917707, -26.521021210028024, -36.322717368983135, -23.253394246375137, -46.3293937840854, -35.964657782362586, -17.92604156378123, -34.68657664589833, -14.592225796989014, -8.388020895354172, -26.33757808711987, -24.89654801805055, -35.67085788237628, -19.298444068127825, -9.472398385651935, -28.253881232985023, -30.576415642439166, -29.30386385006976, -0.8039535970710219, -24.309755961662944, -41.49703778277352, -27.132872524441797, -20.64017107346463, -40.238031805355654, -24.37688067426022, -15.726527991308108, -7.485440284971657, -18.103762436296496, -19.985596459231918, -36.62895876608411, -29.578552815923246, -35.56904904253925, -9.299578455847369, -39.37248821663691, -19.842577332502618, -24.824155906443483, -42.2428737750496, -25.111299808154648, -35.25959323649358, -30.114728365530105, -44.30559213548801, -23.937209272195087, -26.252566952275306, 0.026246688910982474, -9.46632889224162, -45.58488925554185, -15.573148854841346, -11.99516136420667, -13.916865836851242, -33.44360185584716, -20.547095565135567, -33.88949433274668, -15.505079166559913, -37.88309566852536, -16.224680237061403, -37.99066666583815, -26.453743454814774, -27.267349075059514, -16.42309995113736, -5.984624830685265, -16.82725045088991, -46.93811596401322, -41.11762103091564, -8.555333485786829, -27.28252252404607, -34.71007887691701, -51.60658024637951], "policy_predator_policy_reward": [8.68964147008862, 7.707079177761937, 18.76298315650611, 29.71910240405205, 44.59714805885781, 26.737941358407888, 45.48734940013729, 38.879819310541535, 36.08685639530788, 49.43345465413472, 17.35705477424239, 26.499806857220847, 28.829817335102174, 15.083272070220954, 5.017549817429212, 51.28375741301588, 24.198137626327618, 25.519061497984705, 13.845622589943842, 32.203355109573565, 17.10721401290221, 11.020799055421522, 23.955540179542325, 26.19163855074058, 40.03053820882677, 26.911512994182775, 8.249301139927734, 21.20325257288897, 47.13713617721615, 15.655070545226726, 17.573179330421382, 12.962582483229923, 19.40123145042067, 39.8210516917707, 26.521021210028024, 36.322717368983135, 23.253394246375137, 46.3293937840854, 35.964657782362586, 17.92604156378123, 34.68657664589833, 14.592225796989014, 8.388020895354172, 26.33757808711987, 24.89654801805055, 35.67085788237628, 19.298444068127825, 9.472398385651935, 28.253881232985023, 30.576415642439166, 29.30386385006976, 0.8039535970710219, 24.309755961662944, 41.49703778277352, 27.132872524441797, 20.64017107346463, 40.238031805355654, 24.37688067426022, 15.726527991308108, 7.485440284971657, 18.103762436296496, 19.985596459231918, 36.62895876608411, 29.578552815923246, 35.56904904253925, 9.299578455847369, 39.37248821663691, 19.842577332502618, 24.824155906443483, 42.2428737750496, 25.111299808154648, 35.25959323649358, 30.114728365530105, 44.30559213548801, 23.937209272195087, 26.252566952275306, -0.026246688910982474, 9.46632889224162, 45.58488925554185, 15.573148854841346, 11.99516136420667, 13.916865836851242, 33.44360185584716, 20.547095565135567, 33.88949433274668, 15.505079166559913, 37.88309566852536, 16.224680237061403, 37.99066666583815, 26.453743454814774, 27.267349075059514, 16.42309995113736, 5.984624830685265, 16.82725045088991, 46.93811596401322, 41.11762103091564, 8.555333485786829, 27.28252252404607, 34.71007887691701, 51.60658024637951]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28586501310003615, "mean_inference_ms": 0.9472317276010582, "mean_action_processing_ms": 0.12641811691052252, "mean_env_wait_ms": 0.06759492372842643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002786993980407715, "StateBufferConnector_ms": 0.0023692846298217773, "ViewRequirementAgentConnector_ms": 0.051367998123168945}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 682.9552330379178, "num_env_steps_trained_throughput_per_sec": 682.9552330379178, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 5590.118, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5589.879, "sample_time_ms": 738.005, "learn_time_ms": 4837.109, "learn_throughput": 826.94, "synch_weights_time_ms": 14.037}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 84, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-02-30", "timestamp": 1723395750, "time_this_iter_s": 5.861702919006348, "time_total_s": 467.708429813385, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a785a820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 467.708429813385, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 30.93333333333333, "ram_util_percent": 82.92222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2080609606423727, "cur_kl_coeff": 2.2204460492503135e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07477816116831187, "policy_loss": -0.0007730198255255042, "vf_loss": 0.07555118080733034, "vf_explained_var": 0.9964920861646533, "kl": 0.0019193677258766565, "entropy": 0.14414396109835556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.077903617763271, "cur_kl_coeff": 6.103515625000001e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08899326121788059, "policy_loss": -0.004165935841713994, "vf_loss": 0.0931591841072077, "vf_explained_var": 0.9952653200055163, "kl": 0.002230768839575803, "entropy": 0.38986448288584746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.60658024637951, "predator_policy": -0.026246688910982474}, "policy_reward_max": {"prey_policy": 0.026246688910982474, "predator_policy": 51.60658024637951}, "policy_reward_mean": {"prey_policy": -25.659572176275255, "predator_policy": 25.659572176275255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-49.43345465413472, -17.35705477424239, -26.499806857220847, -28.829817335102174, -15.083272070220954, -5.017549817429212, -51.28375741301588, -24.198137626327618, -25.519061497984705, -13.845622589943842, -32.203355109573565, -17.10721401290221, -11.020799055421522, -23.955540179542325, -26.19163855074058, -40.03053820882677, -26.911512994182775, -8.249301139927734, -21.20325257288897, -47.13713617721615, -15.655070545226726, -17.573179330421382, -12.962582483229923, -19.40123145042067, -39.8210516917707, -26.521021210028024, -36.322717368983135, -23.253394246375137, -46.3293937840854, -35.964657782362586, -17.92604156378123, -34.68657664589833, -14.592225796989014, -8.388020895354172, -26.33757808711987, -24.89654801805055, -35.67085788237628, -19.298444068127825, -9.472398385651935, -28.253881232985023, -30.576415642439166, -29.30386385006976, -0.8039535970710219, -24.309755961662944, -41.49703778277352, -27.132872524441797, -20.64017107346463, -40.238031805355654, -24.37688067426022, -15.726527991308108, -7.485440284971657, -18.103762436296496, -19.985596459231918, -36.62895876608411, -29.578552815923246, -35.56904904253925, -9.299578455847369, -39.37248821663691, -19.842577332502618, -24.824155906443483, -42.2428737750496, -25.111299808154648, -35.25959323649358, -30.114728365530105, -44.30559213548801, -23.937209272195087, -26.252566952275306, 0.026246688910982474, -9.46632889224162, -45.58488925554185, -15.573148854841346, -11.99516136420667, -13.916865836851242, -33.44360185584716, -20.547095565135567, -33.88949433274668, -15.505079166559913, -37.88309566852536, -16.224680237061403, -37.99066666583815, -26.453743454814774, -27.267349075059514, -16.42309995113736, -5.984624830685265, -16.82725045088991, -46.93811596401322, -41.11762103091564, -8.555333485786829, -27.28252252404607, -34.71007887691701, -51.60658024637951, -29.169853304573248, -24.56300586480998, -39.01942331374626, -21.420682231833908, -26.96418223363707, -35.66270697491005, -11.359319323051995, -32.40582402884745, -23.307810184391254], "policy_predator_policy_reward": [49.43345465413472, 17.35705477424239, 26.499806857220847, 28.829817335102174, 15.083272070220954, 5.017549817429212, 51.28375741301588, 24.198137626327618, 25.519061497984705, 13.845622589943842, 32.203355109573565, 17.10721401290221, 11.020799055421522, 23.955540179542325, 26.19163855074058, 40.03053820882677, 26.911512994182775, 8.249301139927734, 21.20325257288897, 47.13713617721615, 15.655070545226726, 17.573179330421382, 12.962582483229923, 19.40123145042067, 39.8210516917707, 26.521021210028024, 36.322717368983135, 23.253394246375137, 46.3293937840854, 35.964657782362586, 17.92604156378123, 34.68657664589833, 14.592225796989014, 8.388020895354172, 26.33757808711987, 24.89654801805055, 35.67085788237628, 19.298444068127825, 9.472398385651935, 28.253881232985023, 30.576415642439166, 29.30386385006976, 0.8039535970710219, 24.309755961662944, 41.49703778277352, 27.132872524441797, 20.64017107346463, 40.238031805355654, 24.37688067426022, 15.726527991308108, 7.485440284971657, 18.103762436296496, 19.985596459231918, 36.62895876608411, 29.578552815923246, 35.56904904253925, 9.299578455847369, 39.37248821663691, 19.842577332502618, 24.824155906443483, 42.2428737750496, 25.111299808154648, 35.25959323649358, 30.114728365530105, 44.30559213548801, 23.937209272195087, 26.252566952275306, -0.026246688910982474, 9.46632889224162, 45.58488925554185, 15.573148854841346, 11.99516136420667, 13.916865836851242, 33.44360185584716, 20.547095565135567, 33.88949433274668, 15.505079166559913, 37.88309566852536, 16.224680237061403, 37.99066666583815, 26.453743454814774, 27.267349075059514, 16.42309995113736, 5.984624830685265, 16.82725045088991, 46.93811596401322, 41.11762103091564, 8.555333485786829, 27.28252252404607, 34.71007887691701, 51.60658024637951, 29.169853304573248, 24.56300586480998, 39.01942331374626, 21.420682231833908, 26.96418223363707, 35.66270697491005, 11.359319323051995, 32.40582402884745, 23.307810184391254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2858210639553597, "mean_inference_ms": 0.9480269447969486, "mean_action_processing_ms": 0.12640810799838575, "mean_env_wait_ms": 0.06756843246358074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002817511558532715, "StateBufferConnector_ms": 0.0028334856033325195, "ViewRequirementAgentConnector_ms": 0.051854848861694336}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 751.0553339843261, "num_env_steps_trained_throughput_per_sec": 751.0553339843261, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 5579.694, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5579.456, "sample_time_ms": 737.336, "learn_time_ms": 4827.5, "learn_throughput": 828.586, "synch_weights_time_ms": 13.89}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "training_iteration": 85, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-02-35", "timestamp": 1723395755, "time_this_iter_s": 5.3313000202178955, "time_total_s": 473.0397298336029, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7854af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 473.0397298336029, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 30.557142857142853, "ram_util_percent": 82.98571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0772642073842387, "cur_kl_coeff": 1.1102230246251568e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.10303341493903038, "policy_loss": 0.00017641653272827776, "vf_loss": 0.10285699875288022, "vf_explained_var": 0.9928078403696418, "kl": 0.001231619335236943, "entropy": 0.12953829851855214, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9398614737360428, "cur_kl_coeff": 3.0517578125000006e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.049011286679744144, "policy_loss": -0.022901567979715765, "vf_loss": 0.07191282331865902, "vf_explained_var": 0.9950633651887377, "kl": 0.010398807754211491, "entropy": 0.3572103859546284, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.60658024637951, "predator_policy": -0.026246688910982474}, "policy_reward_max": {"prey_policy": 0.026246688910982474, "predator_policy": 51.60658024637951}, "policy_reward_mean": {"prey_policy": -25.301555307424373, "predator_policy": 25.301555307424373}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-13.845622589943842, -32.203355109573565, -17.10721401290221, -11.020799055421522, -23.955540179542325, -26.19163855074058, -40.03053820882677, -26.911512994182775, -8.249301139927734, -21.20325257288897, -47.13713617721615, -15.655070545226726, -17.573179330421382, -12.962582483229923, -19.40123145042067, -39.8210516917707, -26.521021210028024, -36.322717368983135, -23.253394246375137, -46.3293937840854, -35.964657782362586, -17.92604156378123, -34.68657664589833, -14.592225796989014, -8.388020895354172, -26.33757808711987, -24.89654801805055, -35.67085788237628, -19.298444068127825, -9.472398385651935, -28.253881232985023, -30.576415642439166, -29.30386385006976, -0.8039535970710219, -24.309755961662944, -41.49703778277352, -27.132872524441797, -20.64017107346463, -40.238031805355654, -24.37688067426022, -15.726527991308108, -7.485440284971657, -18.103762436296496, -19.985596459231918, -36.62895876608411, -29.578552815923246, -35.56904904253925, -9.299578455847369, -39.37248821663691, -19.842577332502618, -24.824155906443483, -42.2428737750496, -25.111299808154648, -35.25959323649358, -30.114728365530105, -44.30559213548801, -23.937209272195087, -26.252566952275306, 0.026246688910982474, -9.46632889224162, -45.58488925554185, -15.573148854841346, -11.99516136420667, -13.916865836851242, -33.44360185584716, -20.547095565135567, -33.88949433274668, -15.505079166559913, -37.88309566852536, -16.224680237061403, -37.99066666583815, -26.453743454814774, -27.267349075059514, -16.42309995113736, -5.984624830685265, -16.82725045088991, -46.93811596401322, -41.11762103091564, -8.555333485786829, -27.28252252404607, -34.71007887691701, -51.60658024637951, -29.169853304573248, -24.56300586480998, -39.01942331374626, -21.420682231833908, -26.96418223363707, -35.66270697491005, -11.359319323051995, -32.40582402884745, -23.307810184391254, -5.043399246774118, -10.825197946913429, -9.229618634754033, -22.035830410404593, -39.07605714703182, -27.01169483634059, -42.48619870935891, -30.21700461576904, -21.495223613243844], "policy_predator_policy_reward": [13.845622589943842, 32.203355109573565, 17.10721401290221, 11.020799055421522, 23.955540179542325, 26.19163855074058, 40.03053820882677, 26.911512994182775, 8.249301139927734, 21.20325257288897, 47.13713617721615, 15.655070545226726, 17.573179330421382, 12.962582483229923, 19.40123145042067, 39.8210516917707, 26.521021210028024, 36.322717368983135, 23.253394246375137, 46.3293937840854, 35.964657782362586, 17.92604156378123, 34.68657664589833, 14.592225796989014, 8.388020895354172, 26.33757808711987, 24.89654801805055, 35.67085788237628, 19.298444068127825, 9.472398385651935, 28.253881232985023, 30.576415642439166, 29.30386385006976, 0.8039535970710219, 24.309755961662944, 41.49703778277352, 27.132872524441797, 20.64017107346463, 40.238031805355654, 24.37688067426022, 15.726527991308108, 7.485440284971657, 18.103762436296496, 19.985596459231918, 36.62895876608411, 29.578552815923246, 35.56904904253925, 9.299578455847369, 39.37248821663691, 19.842577332502618, 24.824155906443483, 42.2428737750496, 25.111299808154648, 35.25959323649358, 30.114728365530105, 44.30559213548801, 23.937209272195087, 26.252566952275306, -0.026246688910982474, 9.46632889224162, 45.58488925554185, 15.573148854841346, 11.99516136420667, 13.916865836851242, 33.44360185584716, 20.547095565135567, 33.88949433274668, 15.505079166559913, 37.88309566852536, 16.224680237061403, 37.99066666583815, 26.453743454814774, 27.267349075059514, 16.42309995113736, 5.984624830685265, 16.82725045088991, 46.93811596401322, 41.11762103091564, 8.555333485786829, 27.28252252404607, 34.71007887691701, 51.60658024637951, 29.169853304573248, 24.56300586480998, 39.01942331374626, 21.420682231833908, 26.96418223363707, 35.66270697491005, 11.359319323051995, 32.40582402884745, 23.307810184391254, 5.043399246774118, 10.825197946913429, 9.229618634754033, 22.035830410404593, 39.07605714703182, 27.01169483634059, 42.48619870935891, 30.21700461576904, 21.495223613243844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28580347565964087, "mean_inference_ms": 0.9488356586060118, "mean_action_processing_ms": 0.12640345921299245, "mean_env_wait_ms": 0.06755662386308846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027865171432495117, "StateBufferConnector_ms": 0.0028194189071655273, "ViewRequirementAgentConnector_ms": 0.0518488883972168}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 729.7907928095935, "num_env_steps_trained_throughput_per_sec": 729.7907928095935, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 5603.471, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5603.23, "sample_time_ms": 738.844, "learn_time_ms": 4849.847, "learn_throughput": 824.768, "synch_weights_time_ms": 13.811}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 86, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-02-41", "timestamp": 1723395761, "time_this_iter_s": 5.485948085784912, "time_total_s": 478.5256779193878, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7854310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 478.5256779193878, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 31.575, "ram_util_percent": 83.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0251599807913105, "cur_kl_coeff": 5.551115123125784e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07488638700451702, "policy_loss": -0.0025074050720528857, "vf_loss": 0.0773937915005566, "vf_explained_var": 0.9961510873710115, "kl": 0.003560676850933209, "entropy": 0.1283518090688934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1567327140364796, "cur_kl_coeff": 3.0517578125000006e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08622990793329942, "policy_loss": -0.01178009094534597, "vf_loss": 0.09800997589481994, "vf_explained_var": 0.9949018025770784, "kl": 0.00752341868587777, "entropy": 0.3271622643340379, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.60658024637951, "predator_policy": -0.026246688910982474}, "policy_reward_max": {"prey_policy": 0.026246688910982474, "predator_policy": 51.60658024637951}, "policy_reward_mean": {"prey_policy": -25.103302535045565, "predator_policy": 25.103302535045565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-21.20325257288897, -47.13713617721615, -15.655070545226726, -17.573179330421382, -12.962582483229923, -19.40123145042067, -39.8210516917707, -26.521021210028024, -36.322717368983135, -23.253394246375137, -46.3293937840854, -35.964657782362586, -17.92604156378123, -34.68657664589833, -14.592225796989014, -8.388020895354172, -26.33757808711987, -24.89654801805055, -35.67085788237628, -19.298444068127825, -9.472398385651935, -28.253881232985023, -30.576415642439166, -29.30386385006976, -0.8039535970710219, -24.309755961662944, -41.49703778277352, -27.132872524441797, -20.64017107346463, -40.238031805355654, -24.37688067426022, -15.726527991308108, -7.485440284971657, -18.103762436296496, -19.985596459231918, -36.62895876608411, -29.578552815923246, -35.56904904253925, -9.299578455847369, -39.37248821663691, -19.842577332502618, -24.824155906443483, -42.2428737750496, -25.111299808154648, -35.25959323649358, -30.114728365530105, -44.30559213548801, -23.937209272195087, -26.252566952275306, 0.026246688910982474, -9.46632889224162, -45.58488925554185, -15.573148854841346, -11.99516136420667, -13.916865836851242, -33.44360185584716, -20.547095565135567, -33.88949433274668, -15.505079166559913, -37.88309566852536, -16.224680237061403, -37.99066666583815, -26.453743454814774, -27.267349075059514, -16.42309995113736, -5.984624830685265, -16.82725045088991, -46.93811596401322, -41.11762103091564, -8.555333485786829, -27.28252252404607, -34.71007887691701, -51.60658024637951, -29.169853304573248, -24.56300586480998, -39.01942331374626, -21.420682231833908, -26.96418223363707, -35.66270697491005, -11.359319323051995, -32.40582402884745, -23.307810184391254, -5.043399246774118, -10.825197946913429, -9.229618634754033, -22.035830410404593, -39.07605714703182, -27.01169483634059, -42.48619870935891, -30.21700461576904, -21.495223613243844, -24.727790938731367, -11.593601791675045, -22.426613646436593, -4.78715959990135, -18.342257662275216, -7.199941669574564, -36.18677373269291, -44.842112416455095, -9.583993145438786], "policy_predator_policy_reward": [21.20325257288897, 47.13713617721615, 15.655070545226726, 17.573179330421382, 12.962582483229923, 19.40123145042067, 39.8210516917707, 26.521021210028024, 36.322717368983135, 23.253394246375137, 46.3293937840854, 35.964657782362586, 17.92604156378123, 34.68657664589833, 14.592225796989014, 8.388020895354172, 26.33757808711987, 24.89654801805055, 35.67085788237628, 19.298444068127825, 9.472398385651935, 28.253881232985023, 30.576415642439166, 29.30386385006976, 0.8039535970710219, 24.309755961662944, 41.49703778277352, 27.132872524441797, 20.64017107346463, 40.238031805355654, 24.37688067426022, 15.726527991308108, 7.485440284971657, 18.103762436296496, 19.985596459231918, 36.62895876608411, 29.578552815923246, 35.56904904253925, 9.299578455847369, 39.37248821663691, 19.842577332502618, 24.824155906443483, 42.2428737750496, 25.111299808154648, 35.25959323649358, 30.114728365530105, 44.30559213548801, 23.937209272195087, 26.252566952275306, -0.026246688910982474, 9.46632889224162, 45.58488925554185, 15.573148854841346, 11.99516136420667, 13.916865836851242, 33.44360185584716, 20.547095565135567, 33.88949433274668, 15.505079166559913, 37.88309566852536, 16.224680237061403, 37.99066666583815, 26.453743454814774, 27.267349075059514, 16.42309995113736, 5.984624830685265, 16.82725045088991, 46.93811596401322, 41.11762103091564, 8.555333485786829, 27.28252252404607, 34.71007887691701, 51.60658024637951, 29.169853304573248, 24.56300586480998, 39.01942331374626, 21.420682231833908, 26.96418223363707, 35.66270697491005, 11.359319323051995, 32.40582402884745, 23.307810184391254, 5.043399246774118, 10.825197946913429, 9.229618634754033, 22.035830410404593, 39.07605714703182, 27.01169483634059, 42.48619870935891, 30.21700461576904, 21.495223613243844, 24.727790938731367, 11.593601791675045, 22.426613646436593, 4.78715959990135, 18.342257662275216, 7.199941669574564, 36.18677373269291, 44.842112416455095, 9.583993145438786]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2858109435007634, "mean_inference_ms": 0.9497331330767786, "mean_action_processing_ms": 0.12640717613053845, "mean_env_wait_ms": 0.0675509640645693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027365684509277344, "StateBufferConnector_ms": 0.0028061866760253906, "ViewRequirementAgentConnector_ms": 0.05155074596405029}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 710.5342020173033, "num_env_steps_trained_throughput_per_sec": 710.5342020173033, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 5650.064, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5649.822, "sample_time_ms": 739.931, "learn_time_ms": 4894.93, "learn_throughput": 817.172, "synch_weights_time_ms": 14.234}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "training_iteration": 87, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-02-46", "timestamp": 1723395766, "time_this_iter_s": 5.634926080703735, "time_total_s": 484.16060400009155, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2d9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 484.16060400009155, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 41.4375, "ram_util_percent": 83.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0207690964608143, "cur_kl_coeff": 2.775557561562892e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05674604039425806, "policy_loss": -0.0045832662877122255, "vf_loss": 0.06132930677267723, "vf_explained_var": 0.9949256110936403, "kl": 0.004716664344901749, "entropy": 0.16287163318290065, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9993793155997992, "cur_kl_coeff": 3.0517578125000006e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05487004229729185, "policy_loss": -0.009103054316559186, "vf_loss": 0.06397308179487785, "vf_explained_var": 0.9945211254060269, "kl": 0.004985333125241235, "entropy": 0.33153107296675444, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.60658024637951, "predator_policy": -0.026246688910982474}, "policy_reward_max": {"prey_policy": 0.026246688910982474, "predator_policy": 51.60658024637951}, "policy_reward_mean": {"prey_policy": -25.09557427979469, "predator_policy": 25.09557427979469}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-23.253394246375137, -46.3293937840854, -35.964657782362586, -17.92604156378123, -34.68657664589833, -14.592225796989014, -8.388020895354172, -26.33757808711987, -24.89654801805055, -35.67085788237628, -19.298444068127825, -9.472398385651935, -28.253881232985023, -30.576415642439166, -29.30386385006976, -0.8039535970710219, -24.309755961662944, -41.49703778277352, -27.132872524441797, -20.64017107346463, -40.238031805355654, -24.37688067426022, -15.726527991308108, -7.485440284971657, -18.103762436296496, -19.985596459231918, -36.62895876608411, -29.578552815923246, -35.56904904253925, -9.299578455847369, -39.37248821663691, -19.842577332502618, -24.824155906443483, -42.2428737750496, -25.111299808154648, -35.25959323649358, -30.114728365530105, -44.30559213548801, -23.937209272195087, -26.252566952275306, 0.026246688910982474, -9.46632889224162, -45.58488925554185, -15.573148854841346, -11.99516136420667, -13.916865836851242, -33.44360185584716, -20.547095565135567, -33.88949433274668, -15.505079166559913, -37.88309566852536, -16.224680237061403, -37.99066666583815, -26.453743454814774, -27.267349075059514, -16.42309995113736, -5.984624830685265, -16.82725045088991, -46.93811596401322, -41.11762103091564, -8.555333485786829, -27.28252252404607, -34.71007887691701, -51.60658024637951, -29.169853304573248, -24.56300586480998, -39.01942331374626, -21.420682231833908, -26.96418223363707, -35.66270697491005, -11.359319323051995, -32.40582402884745, -23.307810184391254, -5.043399246774118, -10.825197946913429, -9.229618634754033, -22.035830410404593, -39.07605714703182, -27.01169483634059, -42.48619870935891, -30.21700461576904, -21.495223613243844, -24.727790938731367, -11.593601791675045, -22.426613646436593, -4.78715959990135, -18.342257662275216, -7.199941669574564, -36.18677373269291, -44.842112416455095, -9.583993145438786, -25.763461994307242, -44.874439492369575, -18.272670956748012, -12.311630052405436, -27.1230583027028, -38.89932838585429, -24.111922785027655, -29.006263951563476, -15.461641384119524], "policy_predator_policy_reward": [23.253394246375137, 46.3293937840854, 35.964657782362586, 17.92604156378123, 34.68657664589833, 14.592225796989014, 8.388020895354172, 26.33757808711987, 24.89654801805055, 35.67085788237628, 19.298444068127825, 9.472398385651935, 28.253881232985023, 30.576415642439166, 29.30386385006976, 0.8039535970710219, 24.309755961662944, 41.49703778277352, 27.132872524441797, 20.64017107346463, 40.238031805355654, 24.37688067426022, 15.726527991308108, 7.485440284971657, 18.103762436296496, 19.985596459231918, 36.62895876608411, 29.578552815923246, 35.56904904253925, 9.299578455847369, 39.37248821663691, 19.842577332502618, 24.824155906443483, 42.2428737750496, 25.111299808154648, 35.25959323649358, 30.114728365530105, 44.30559213548801, 23.937209272195087, 26.252566952275306, -0.026246688910982474, 9.46632889224162, 45.58488925554185, 15.573148854841346, 11.99516136420667, 13.916865836851242, 33.44360185584716, 20.547095565135567, 33.88949433274668, 15.505079166559913, 37.88309566852536, 16.224680237061403, 37.99066666583815, 26.453743454814774, 27.267349075059514, 16.42309995113736, 5.984624830685265, 16.82725045088991, 46.93811596401322, 41.11762103091564, 8.555333485786829, 27.28252252404607, 34.71007887691701, 51.60658024637951, 29.169853304573248, 24.56300586480998, 39.01942331374626, 21.420682231833908, 26.96418223363707, 35.66270697491005, 11.359319323051995, 32.40582402884745, 23.307810184391254, 5.043399246774118, 10.825197946913429, 9.229618634754033, 22.035830410404593, 39.07605714703182, 27.01169483634059, 42.48619870935891, 30.21700461576904, 21.495223613243844, 24.727790938731367, 11.593601791675045, 22.426613646436593, 4.78715959990135, 18.342257662275216, 7.199941669574564, 36.18677373269291, 44.842112416455095, 9.583993145438786, 25.763461994307242, 44.874439492369575, 18.272670956748012, 12.311630052405436, 27.1230583027028, 38.89932838585429, 24.111922785027655, 29.006263951563476, 15.461641384119524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2858012456650453, "mean_inference_ms": 0.9505561585423038, "mean_action_processing_ms": 0.12640640189640778, "mean_env_wait_ms": 0.06754117481251645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027370452880859375, "StateBufferConnector_ms": 0.0028095245361328125, "ViewRequirementAgentConnector_ms": 0.051485538482666016}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 769.0104292001101, "num_env_steps_trained_throughput_per_sec": 769.0104292001101, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 5630.158, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5629.915, "sample_time_ms": 731.923, "learn_time_ms": 4883.246, "learn_throughput": 819.127, "synch_weights_time_ms": 14.011}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 88, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-02-51", "timestamp": 1723395771, "time_this_iter_s": 5.206949949264526, "time_total_s": 489.3675539493561, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7854af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 489.3675539493561, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 37.699999999999996, "ram_util_percent": 83.38571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9543246730541189, "cur_kl_coeff": 1.387778780781446e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09480075537406568, "policy_loss": -0.0006263670902626473, "vf_loss": 0.09542712220184815, "vf_explained_var": 0.9941372427468499, "kl": 0.0013646545827843027, "entropy": 0.12414970174819852, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8936976105129967, "cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.058909261677505736, "policy_loss": -0.007107979699988694, "vf_loss": 0.06601723343871223, "vf_explained_var": 0.9960787288844586, "kl": 0.005077138620306454, "entropy": 0.318629623670131, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.60658024637951, "predator_policy": -0.026246688910982474}, "policy_reward_max": {"prey_policy": 0.026246688910982474, "predator_policy": 51.60658024637951}, "policy_reward_mean": {"prey_policy": -24.44909661519179, "predator_policy": 24.44909661519179}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-35.67085788237628, -19.298444068127825, -9.472398385651935, -28.253881232985023, -30.576415642439166, -29.30386385006976, -0.8039535970710219, -24.309755961662944, -41.49703778277352, -27.132872524441797, -20.64017107346463, -40.238031805355654, -24.37688067426022, -15.726527991308108, -7.485440284971657, -18.103762436296496, -19.985596459231918, -36.62895876608411, -29.578552815923246, -35.56904904253925, -9.299578455847369, -39.37248821663691, -19.842577332502618, -24.824155906443483, -42.2428737750496, -25.111299808154648, -35.25959323649358, -30.114728365530105, -44.30559213548801, -23.937209272195087, -26.252566952275306, 0.026246688910982474, -9.46632889224162, -45.58488925554185, -15.573148854841346, -11.99516136420667, -13.916865836851242, -33.44360185584716, -20.547095565135567, -33.88949433274668, -15.505079166559913, -37.88309566852536, -16.224680237061403, -37.99066666583815, -26.453743454814774, -27.267349075059514, -16.42309995113736, -5.984624830685265, -16.82725045088991, -46.93811596401322, -41.11762103091564, -8.555333485786829, -27.28252252404607, -34.71007887691701, -51.60658024637951, -29.169853304573248, -24.56300586480998, -39.01942331374626, -21.420682231833908, -26.96418223363707, -35.66270697491005, -11.359319323051995, -32.40582402884745, -23.307810184391254, -5.043399246774118, -10.825197946913429, -9.229618634754033, -22.035830410404593, -39.07605714703182, -27.01169483634059, -42.48619870935891, -30.21700461576904, -21.495223613243844, -24.727790938731367, -11.593601791675045, -22.426613646436593, -4.78715959990135, -18.342257662275216, -7.199941669574564, -36.18677373269291, -44.842112416455095, -9.583993145438786, -25.763461994307242, -44.874439492369575, -18.272670956748012, -12.311630052405436, -27.1230583027028, -38.89932838585429, -24.111922785027655, -29.006263951563476, -15.461641384119524, -20.01974636728624, -47.54682827318746, -17.36096781623729, -25.186653928744732, -5.4098230418647, -4.954527433188319, -7.547676313995944, -33.82424112945824, -5.876206055763955], "policy_predator_policy_reward": [35.67085788237628, 19.298444068127825, 9.472398385651935, 28.253881232985023, 30.576415642439166, 29.30386385006976, 0.8039535970710219, 24.309755961662944, 41.49703778277352, 27.132872524441797, 20.64017107346463, 40.238031805355654, 24.37688067426022, 15.726527991308108, 7.485440284971657, 18.103762436296496, 19.985596459231918, 36.62895876608411, 29.578552815923246, 35.56904904253925, 9.299578455847369, 39.37248821663691, 19.842577332502618, 24.824155906443483, 42.2428737750496, 25.111299808154648, 35.25959323649358, 30.114728365530105, 44.30559213548801, 23.937209272195087, 26.252566952275306, -0.026246688910982474, 9.46632889224162, 45.58488925554185, 15.573148854841346, 11.99516136420667, 13.916865836851242, 33.44360185584716, 20.547095565135567, 33.88949433274668, 15.505079166559913, 37.88309566852536, 16.224680237061403, 37.99066666583815, 26.453743454814774, 27.267349075059514, 16.42309995113736, 5.984624830685265, 16.82725045088991, 46.93811596401322, 41.11762103091564, 8.555333485786829, 27.28252252404607, 34.71007887691701, 51.60658024637951, 29.169853304573248, 24.56300586480998, 39.01942331374626, 21.420682231833908, 26.96418223363707, 35.66270697491005, 11.359319323051995, 32.40582402884745, 23.307810184391254, 5.043399246774118, 10.825197946913429, 9.229618634754033, 22.035830410404593, 39.07605714703182, 27.01169483634059, 42.48619870935891, 30.21700461576904, 21.495223613243844, 24.727790938731367, 11.593601791675045, 22.426613646436593, 4.78715959990135, 18.342257662275216, 7.199941669574564, 36.18677373269291, 44.842112416455095, 9.583993145438786, 25.763461994307242, 44.874439492369575, 18.272670956748012, 12.311630052405436, 27.1230583027028, 38.89932838585429, 24.111922785027655, 29.006263951563476, 15.461641384119524, 20.01974636728624, 47.54682827318746, 17.36096781623729, 25.186653928744732, 5.4098230418647, 4.954527433188319, 7.547676313995944, 33.82424112945824, 5.876206055763955]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28579837942497255, "mean_inference_ms": 0.9514039104510651, "mean_action_processing_ms": 0.12640623027169923, "mean_env_wait_ms": 0.06753234966703793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027179718017578125, "StateBufferConnector_ms": 0.0027927160263061523, "ViewRequirementAgentConnector_ms": 0.05076181888580322}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 703.2706126750813, "num_env_steps_trained_throughput_per_sec": 703.2706126750813, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 712000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 712000, "timers": {"training_iteration_time_ms": 5615.359, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5615.117, "sample_time_ms": 723.524, "learn_time_ms": 4877.193, "learn_throughput": 820.144, "synch_weights_time_ms": 13.665}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "done": false, "training_iteration": 89, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-02-57", "timestamp": 1723395777, "time_this_iter_s": 5.692198991775513, "time_total_s": 495.0597529411316, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9ed1a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 495.0597529411316, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 35.4125, "ram_util_percent": 83.3375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1610368833566704, "cur_kl_coeff": 6.93889390390723e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.059260291554771055, "policy_loss": 6.821379744602988e-05, "vf_loss": 0.05919207759434357, "vf_explained_var": 0.9969827581817905, "kl": 0.0011533910413032238, "entropy": 0.11011556640150957, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9167298699729145, "cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.036074086467605564, "policy_loss": -0.013330013242375571, "vf_loss": 0.04940409118765577, "vf_explained_var": 0.9975457275907199, "kl": 0.005727634715521538, "entropy": 0.3031328344717622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.60658024637951, "predator_policy": -0.026246688910982474}, "policy_reward_max": {"prey_policy": 0.026246688910982474, "predator_policy": 51.60658024637951}, "policy_reward_mean": {"prey_policy": -24.623942528210282, "predator_policy": 24.623942528210282}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-30.576415642439166, -29.30386385006976, -0.8039535970710219, -24.309755961662944, -41.49703778277352, -27.132872524441797, -20.64017107346463, -40.238031805355654, -24.37688067426022, -15.726527991308108, -7.485440284971657, -18.103762436296496, -19.985596459231918, -36.62895876608411, -29.578552815923246, -35.56904904253925, -9.299578455847369, -39.37248821663691, -19.842577332502618, -24.824155906443483, -42.2428737750496, -25.111299808154648, -35.25959323649358, -30.114728365530105, -44.30559213548801, -23.937209272195087, -26.252566952275306, 0.026246688910982474, -9.46632889224162, -45.58488925554185, -15.573148854841346, -11.99516136420667, -13.916865836851242, -33.44360185584716, -20.547095565135567, -33.88949433274668, -15.505079166559913, -37.88309566852536, -16.224680237061403, -37.99066666583815, -26.453743454814774, -27.267349075059514, -16.42309995113736, -5.984624830685265, -16.82725045088991, -46.93811596401322, -41.11762103091564, -8.555333485786829, -27.28252252404607, -34.71007887691701, -51.60658024637951, -29.169853304573248, -24.56300586480998, -39.01942331374626, -21.420682231833908, -26.96418223363707, -35.66270697491005, -11.359319323051995, -32.40582402884745, -23.307810184391254, -5.043399246774118, -10.825197946913429, -9.229618634754033, -22.035830410404593, -39.07605714703182, -27.01169483634059, -42.48619870935891, -30.21700461576904, -21.495223613243844, -24.727790938731367, -11.593601791675045, -22.426613646436593, -4.78715959990135, -18.342257662275216, -7.199941669574564, -36.18677373269291, -44.842112416455095, -9.583993145438786, -25.763461994307242, -44.874439492369575, -18.272670956748012, -12.311630052405436, -27.1230583027028, -38.89932838585429, -24.111922785027655, -29.006263951563476, -15.461641384119524, -20.01974636728624, -47.54682827318746, -17.36096781623729, -25.186653928744732, -5.4098230418647, -4.954527433188319, -7.547676313995944, -33.82424112945824, -5.876206055763955, -20.813561885581393, -27.202928091771994, -37.406816774541724, -24.75686611909465], "policy_predator_policy_reward": [30.576415642439166, 29.30386385006976, 0.8039535970710219, 24.309755961662944, 41.49703778277352, 27.132872524441797, 20.64017107346463, 40.238031805355654, 24.37688067426022, 15.726527991308108, 7.485440284971657, 18.103762436296496, 19.985596459231918, 36.62895876608411, 29.578552815923246, 35.56904904253925, 9.299578455847369, 39.37248821663691, 19.842577332502618, 24.824155906443483, 42.2428737750496, 25.111299808154648, 35.25959323649358, 30.114728365530105, 44.30559213548801, 23.937209272195087, 26.252566952275306, -0.026246688910982474, 9.46632889224162, 45.58488925554185, 15.573148854841346, 11.99516136420667, 13.916865836851242, 33.44360185584716, 20.547095565135567, 33.88949433274668, 15.505079166559913, 37.88309566852536, 16.224680237061403, 37.99066666583815, 26.453743454814774, 27.267349075059514, 16.42309995113736, 5.984624830685265, 16.82725045088991, 46.93811596401322, 41.11762103091564, 8.555333485786829, 27.28252252404607, 34.71007887691701, 51.60658024637951, 29.169853304573248, 24.56300586480998, 39.01942331374626, 21.420682231833908, 26.96418223363707, 35.66270697491005, 11.359319323051995, 32.40582402884745, 23.307810184391254, 5.043399246774118, 10.825197946913429, 9.229618634754033, 22.035830410404593, 39.07605714703182, 27.01169483634059, 42.48619870935891, 30.21700461576904, 21.495223613243844, 24.727790938731367, 11.593601791675045, 22.426613646436593, 4.78715959990135, 18.342257662275216, 7.199941669574564, 36.18677373269291, 44.842112416455095, 9.583993145438786, 25.763461994307242, 44.874439492369575, 18.272670956748012, 12.311630052405436, 27.1230583027028, 38.89932838585429, 24.111922785027655, 29.006263951563476, 15.461641384119524, 20.01974636728624, 47.54682827318746, 17.36096781623729, 25.186653928744732, 5.4098230418647, 4.954527433188319, 7.547676313995944, 33.82424112945824, 5.876206055763955, 20.813561885581393, 27.202928091771994, 37.406816774541724, 24.75686611909465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28576060766348604, "mean_inference_ms": 0.9517507732230739, "mean_action_processing_ms": 0.12638636409961715, "mean_env_wait_ms": 0.06752849737629027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002722024917602539, "StateBufferConnector_ms": 0.0027883052825927734, "ViewRequirementAgentConnector_ms": 0.05098116397857666}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 722.5455913421401, "num_env_steps_trained_throughput_per_sec": 722.5455913421401, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 5523.323, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5523.284, "sample_time_ms": 674.131, "learn_time_ms": 4835.664, "learn_throughput": 827.187, "synch_weights_time_ms": 13.128}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 90, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-03-03", "timestamp": 1723395783, "time_this_iter_s": 5.540431976318359, "time_total_s": 500.60018491744995, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f223a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 500.60018491744995, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 35.8, "ram_util_percent": 82.9125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8087430273958792, "cur_kl_coeff": 3.469446951953615e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03804096685125842, "policy_loss": -0.0013939394026238005, "vf_loss": 0.03943490616317528, "vf_explained_var": 0.9954652208214004, "kl": 0.0017263933577629084, "entropy": 0.12386501499762138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8386040006919454, "cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03708897294091003, "policy_loss": -0.002687236551234188, "vf_loss": 0.03977620658891586, "vf_explained_var": 0.9960866391037901, "kl": 0.0019235489111844074, "entropy": 0.33242384035450717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.60658024637951, "predator_policy": -0.026246688910982474}, "policy_reward_max": {"prey_policy": 0.026246688910982474, "predator_policy": 51.60658024637951}, "policy_reward_mean": {"prey_policy": -25.13187481501584, "predator_policy": 25.13187481501584}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-27.132872524441797, -20.64017107346463, -40.238031805355654, -24.37688067426022, -15.726527991308108, -7.485440284971657, -18.103762436296496, -19.985596459231918, -36.62895876608411, -29.578552815923246, -35.56904904253925, -9.299578455847369, -39.37248821663691, -19.842577332502618, -24.824155906443483, -42.2428737750496, -25.111299808154648, -35.25959323649358, -30.114728365530105, -44.30559213548801, -23.937209272195087, -26.252566952275306, 0.026246688910982474, -9.46632889224162, -45.58488925554185, -15.573148854841346, -11.99516136420667, -13.916865836851242, -33.44360185584716, -20.547095565135567, -33.88949433274668, -15.505079166559913, -37.88309566852536, -16.224680237061403, -37.99066666583815, -26.453743454814774, -27.267349075059514, -16.42309995113736, -5.984624830685265, -16.82725045088991, -46.93811596401322, -41.11762103091564, -8.555333485786829, -27.28252252404607, -34.71007887691701, -51.60658024637951, -29.169853304573248, -24.56300586480998, -39.01942331374626, -21.420682231833908, -26.96418223363707, -35.66270697491005, -11.359319323051995, -32.40582402884745, -23.307810184391254, -5.043399246774118, -10.825197946913429, -9.229618634754033, -22.035830410404593, -39.07605714703182, -27.01169483634059, -42.48619870935891, -30.21700461576904, -21.495223613243844, -24.727790938731367, -11.593601791675045, -22.426613646436593, -4.78715959990135, -18.342257662275216, -7.199941669574564, -36.18677373269291, -44.842112416455095, -9.583993145438786, -25.763461994307242, -44.874439492369575, -18.272670956748012, -12.311630052405436, -27.1230583027028, -38.89932838585429, -24.111922785027655, -29.006263951563476, -15.461641384119524, -20.01974636728624, -47.54682827318746, -17.36096781623729, -25.186653928744732, -5.4098230418647, -4.954527433188319, -7.547676313995944, -33.82424112945824, -5.876206055763955, -20.813561885581393, -27.202928091771994, -37.406816774541724, -24.75686611909465, -44.909350930226594, -25.703513809334115, -50.095999439291745, -41.46047707053369, -15.114914265185996], "policy_predator_policy_reward": [27.132872524441797, 20.64017107346463, 40.238031805355654, 24.37688067426022, 15.726527991308108, 7.485440284971657, 18.103762436296496, 19.985596459231918, 36.62895876608411, 29.578552815923246, 35.56904904253925, 9.299578455847369, 39.37248821663691, 19.842577332502618, 24.824155906443483, 42.2428737750496, 25.111299808154648, 35.25959323649358, 30.114728365530105, 44.30559213548801, 23.937209272195087, 26.252566952275306, -0.026246688910982474, 9.46632889224162, 45.58488925554185, 15.573148854841346, 11.99516136420667, 13.916865836851242, 33.44360185584716, 20.547095565135567, 33.88949433274668, 15.505079166559913, 37.88309566852536, 16.224680237061403, 37.99066666583815, 26.453743454814774, 27.267349075059514, 16.42309995113736, 5.984624830685265, 16.82725045088991, 46.93811596401322, 41.11762103091564, 8.555333485786829, 27.28252252404607, 34.71007887691701, 51.60658024637951, 29.169853304573248, 24.56300586480998, 39.01942331374626, 21.420682231833908, 26.96418223363707, 35.66270697491005, 11.359319323051995, 32.40582402884745, 23.307810184391254, 5.043399246774118, 10.825197946913429, 9.229618634754033, 22.035830410404593, 39.07605714703182, 27.01169483634059, 42.48619870935891, 30.21700461576904, 21.495223613243844, 24.727790938731367, 11.593601791675045, 22.426613646436593, 4.78715959990135, 18.342257662275216, 7.199941669574564, 36.18677373269291, 44.842112416455095, 9.583993145438786, 25.763461994307242, 44.874439492369575, 18.272670956748012, 12.311630052405436, 27.1230583027028, 38.89932838585429, 24.111922785027655, 29.006263951563476, 15.461641384119524, 20.01974636728624, 47.54682827318746, 17.36096781623729, 25.186653928744732, 5.4098230418647, 4.954527433188319, 7.547676313995944, 33.82424112945824, 5.876206055763955, 20.813561885581393, 27.202928091771994, 37.406816774541724, 24.75686611909465, 44.909350930226594, 25.703513809334115, 50.095999439291745, 41.46047707053369, 15.114914265185996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2858082232772071, "mean_inference_ms": 0.9523036168301365, "mean_action_processing_ms": 0.12640698657263696, "mean_env_wait_ms": 0.06753585440779766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002724885940551758, "StateBufferConnector_ms": 0.0026459693908691406, "ViewRequirementAgentConnector_ms": 0.05110001564025879}, "num_episodes": 5, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 722.2401425089698, "num_env_steps_trained_throughput_per_sec": 722.2401425089698, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 728000, "timers": {"training_iteration_time_ms": 5513.519, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5513.483, "sample_time_ms": 656.173, "learn_time_ms": 4843.94, "learn_throughput": 825.774, "synch_weights_time_ms": 13.045}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "done": false, "training_iteration": 91, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-03-08", "timestamp": 1723395788, "time_this_iter_s": 5.542294979095459, "time_total_s": 506.1424798965454, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9ed1e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 506.1424798965454, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 35.075, "ram_util_percent": 82.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.124475693826874, "cur_kl_coeff": 1.7347234759768074e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07814310097965063, "policy_loss": -0.005967523819223667, "vf_loss": 0.08411062500090338, "vf_explained_var": 0.9949612887576222, "kl": 0.006296032364942654, "entropy": 0.15278549178425843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0212899633683263, "cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07527809306614776, "policy_loss": -0.008674435668217484, "vf_loss": 0.08395252491269882, "vf_explained_var": 0.9949374526118239, "kl": 0.005681766251701589, "entropy": 0.33799086104457576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.60658024637951, "predator_policy": -0.026246688910982474}, "policy_reward_max": {"prey_policy": 0.026246688910982474, "predator_policy": 51.60658024637951}, "policy_reward_mean": {"prey_policy": -25.067876677448776, "predator_policy": 25.067876677448776}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-29.578552815923246, -35.56904904253925, -9.299578455847369, -39.37248821663691, -19.842577332502618, -24.824155906443483, -42.2428737750496, -25.111299808154648, -35.25959323649358, -30.114728365530105, -44.30559213548801, -23.937209272195087, -26.252566952275306, 0.026246688910982474, -9.46632889224162, -45.58488925554185, -15.573148854841346, -11.99516136420667, -13.916865836851242, -33.44360185584716, -20.547095565135567, -33.88949433274668, -15.505079166559913, -37.88309566852536, -16.224680237061403, -37.99066666583815, -26.453743454814774, -27.267349075059514, -16.42309995113736, -5.984624830685265, -16.82725045088991, -46.93811596401322, -41.11762103091564, -8.555333485786829, -27.28252252404607, -34.71007887691701, -51.60658024637951, -29.169853304573248, -24.56300586480998, -39.01942331374626, -21.420682231833908, -26.96418223363707, -35.66270697491005, -11.359319323051995, -32.40582402884745, -23.307810184391254, -5.043399246774118, -10.825197946913429, -9.229618634754033, -22.035830410404593, -39.07605714703182, -27.01169483634059, -42.48619870935891, -30.21700461576904, -21.495223613243844, -24.727790938731367, -11.593601791675045, -22.426613646436593, -4.78715959990135, -18.342257662275216, -7.199941669574564, -36.18677373269291, -44.842112416455095, -9.583993145438786, -25.763461994307242, -44.874439492369575, -18.272670956748012, -12.311630052405436, -27.1230583027028, -38.89932838585429, -24.111922785027655, -29.006263951563476, -15.461641384119524, -20.01974636728624, -47.54682827318746, -17.36096781623729, -25.186653928744732, -5.4098230418647, -4.954527433188319, -7.547676313995944, -33.82424112945824, -5.876206055763955, -20.813561885581393, -27.202928091771994, -37.406816774541724, -24.75686611909465, -44.909350930226594, -25.703513809334115, -50.095999439291745, -41.46047707053369, -15.114914265185996, -7.525628044488657, -10.472856117319552, -18.417615871103447, -37.283091940581954, -13.429893456430364, -30.01527654977745, -29.225977645415036, -46.073147382477586, -11.474941251114046], "policy_predator_policy_reward": [29.578552815923246, 35.56904904253925, 9.299578455847369, 39.37248821663691, 19.842577332502618, 24.824155906443483, 42.2428737750496, 25.111299808154648, 35.25959323649358, 30.114728365530105, 44.30559213548801, 23.937209272195087, 26.252566952275306, -0.026246688910982474, 9.46632889224162, 45.58488925554185, 15.573148854841346, 11.99516136420667, 13.916865836851242, 33.44360185584716, 20.547095565135567, 33.88949433274668, 15.505079166559913, 37.88309566852536, 16.224680237061403, 37.99066666583815, 26.453743454814774, 27.267349075059514, 16.42309995113736, 5.984624830685265, 16.82725045088991, 46.93811596401322, 41.11762103091564, 8.555333485786829, 27.28252252404607, 34.71007887691701, 51.60658024637951, 29.169853304573248, 24.56300586480998, 39.01942331374626, 21.420682231833908, 26.96418223363707, 35.66270697491005, 11.359319323051995, 32.40582402884745, 23.307810184391254, 5.043399246774118, 10.825197946913429, 9.229618634754033, 22.035830410404593, 39.07605714703182, 27.01169483634059, 42.48619870935891, 30.21700461576904, 21.495223613243844, 24.727790938731367, 11.593601791675045, 22.426613646436593, 4.78715959990135, 18.342257662275216, 7.199941669574564, 36.18677373269291, 44.842112416455095, 9.583993145438786, 25.763461994307242, 44.874439492369575, 18.272670956748012, 12.311630052405436, 27.1230583027028, 38.89932838585429, 24.111922785027655, 29.006263951563476, 15.461641384119524, 20.01974636728624, 47.54682827318746, 17.36096781623729, 25.186653928744732, 5.4098230418647, 4.954527433188319, 7.547676313995944, 33.82424112945824, 5.876206055763955, 20.813561885581393, 27.202928091771994, 37.406816774541724, 24.75686611909465, 44.909350930226594, 25.703513809334115, 50.095999439291745, 41.46047707053369, 15.114914265185996, 7.525628044488657, 10.472856117319552, 18.417615871103447, 37.283091940581954, 13.429893456430364, 30.01527654977745, 29.225977645415036, 46.073147382477586, 11.474941251114046]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2857693221290547, "mean_inference_ms": 0.9531183434244629, "mean_action_processing_ms": 0.12640496745618357, "mean_env_wait_ms": 0.06753451108985184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026508569717407227, "StateBufferConnector_ms": 0.0025882720947265625, "ViewRequirementAgentConnector_ms": 0.048859596252441406}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 716.8191805132286, "num_env_steps_trained_throughput_per_sec": 716.8191805132286, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 5522.284, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5522.248, "sample_time_ms": 663.647, "learn_time_ms": 4845.099, "learn_throughput": 825.577, "synch_weights_time_ms": 13.173}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 92, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-03-14", "timestamp": 1723395794, "time_this_iter_s": 5.585766792297363, "time_total_s": 511.7282466888428, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2da60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 511.7282466888428, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 35.85, "ram_util_percent": 82.7375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9400851705887665, "cur_kl_coeff": 1.7347234759768074e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07335401985255885, "policy_loss": -0.004227509222255321, "vf_loss": 0.07758152889048991, "vf_explained_var": 0.9943331923956672, "kl": 0.004242936180161184, "entropy": 0.1017842602081752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9802574354844789, "cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07265480668506825, "policy_loss": -0.006004104501092418, "vf_loss": 0.07865890941078153, "vf_explained_var": 0.9941660889113942, "kl": 0.0033325706658093703, "entropy": 0.300311164635544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.60658024637951, "predator_policy": -0.026246688910982474}, "policy_reward_max": {"prey_policy": 0.026246688910982474, "predator_policy": 51.60658024637951}, "policy_reward_mean": {"prey_policy": -24.457507923672182, "predator_policy": 24.457507923672182}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-30.114728365530105, -44.30559213548801, -23.937209272195087, -26.252566952275306, 0.026246688910982474, -9.46632889224162, -45.58488925554185, -15.573148854841346, -11.99516136420667, -13.916865836851242, -33.44360185584716, -20.547095565135567, -33.88949433274668, -15.505079166559913, -37.88309566852536, -16.224680237061403, -37.99066666583815, -26.453743454814774, -27.267349075059514, -16.42309995113736, -5.984624830685265, -16.82725045088991, -46.93811596401322, -41.11762103091564, -8.555333485786829, -27.28252252404607, -34.71007887691701, -51.60658024637951, -29.169853304573248, -24.56300586480998, -39.01942331374626, -21.420682231833908, -26.96418223363707, -35.66270697491005, -11.359319323051995, -32.40582402884745, -23.307810184391254, -5.043399246774118, -10.825197946913429, -9.229618634754033, -22.035830410404593, -39.07605714703182, -27.01169483634059, -42.48619870935891, -30.21700461576904, -21.495223613243844, -24.727790938731367, -11.593601791675045, -22.426613646436593, -4.78715959990135, -18.342257662275216, -7.199941669574564, -36.18677373269291, -44.842112416455095, -9.583993145438786, -25.763461994307242, -44.874439492369575, -18.272670956748012, -12.311630052405436, -27.1230583027028, -38.89932838585429, -24.111922785027655, -29.006263951563476, -15.461641384119524, -20.01974636728624, -47.54682827318746, -17.36096781623729, -25.186653928744732, -5.4098230418647, -4.954527433188319, -7.547676313995944, -33.82424112945824, -5.876206055763955, -20.813561885581393, -27.202928091771994, -37.406816774541724, -24.75686611909465, -44.909350930226594, -25.703513809334115, -50.095999439291745, -41.46047707053369, -15.114914265185996, -7.525628044488657, -10.472856117319552, -18.417615871103447, -37.283091940581954, -13.429893456430364, -30.01527654977745, -29.225977645415036, -46.073147382477586, -11.474941251114046, -0.546592348012364, -38.623011774200926, -16.20362894643225, -16.601765516540883, -24.444481363737918, -5.819004498208745, -34.38757760668063, -40.888055236732995, -22.549175921384222], "policy_predator_policy_reward": [30.114728365530105, 44.30559213548801, 23.937209272195087, 26.252566952275306, -0.026246688910982474, 9.46632889224162, 45.58488925554185, 15.573148854841346, 11.99516136420667, 13.916865836851242, 33.44360185584716, 20.547095565135567, 33.88949433274668, 15.505079166559913, 37.88309566852536, 16.224680237061403, 37.99066666583815, 26.453743454814774, 27.267349075059514, 16.42309995113736, 5.984624830685265, 16.82725045088991, 46.93811596401322, 41.11762103091564, 8.555333485786829, 27.28252252404607, 34.71007887691701, 51.60658024637951, 29.169853304573248, 24.56300586480998, 39.01942331374626, 21.420682231833908, 26.96418223363707, 35.66270697491005, 11.359319323051995, 32.40582402884745, 23.307810184391254, 5.043399246774118, 10.825197946913429, 9.229618634754033, 22.035830410404593, 39.07605714703182, 27.01169483634059, 42.48619870935891, 30.21700461576904, 21.495223613243844, 24.727790938731367, 11.593601791675045, 22.426613646436593, 4.78715959990135, 18.342257662275216, 7.199941669574564, 36.18677373269291, 44.842112416455095, 9.583993145438786, 25.763461994307242, 44.874439492369575, 18.272670956748012, 12.311630052405436, 27.1230583027028, 38.89932838585429, 24.111922785027655, 29.006263951563476, 15.461641384119524, 20.01974636728624, 47.54682827318746, 17.36096781623729, 25.186653928744732, 5.4098230418647, 4.954527433188319, 7.547676313995944, 33.82424112945824, 5.876206055763955, 20.813561885581393, 27.202928091771994, 37.406816774541724, 24.75686611909465, 44.909350930226594, 25.703513809334115, 50.095999439291745, 41.46047707053369, 15.114914265185996, 7.525628044488657, 10.472856117319552, 18.417615871103447, 37.283091940581954, 13.429893456430364, 30.01527654977745, 29.225977645415036, 46.073147382477586, 11.474941251114046, 0.546592348012364, 38.623011774200926, 16.20362894643225, 16.601765516540883, 24.444481363737918, 5.819004498208745, 34.38757760668063, 40.888055236732995, 22.549175921384222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28567188248471403, "mean_inference_ms": 0.9529509838967872, "mean_action_processing_ms": 0.12638911129135863, "mean_env_wait_ms": 0.06752208242237166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025783777236938477, "StateBufferConnector_ms": 0.0024663209915161133, "ViewRequirementAgentConnector_ms": 0.0462113618850708}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 743.6406621397232, "num_env_steps_trained_throughput_per_sec": 743.6406621397232, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 5521.607, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5521.572, "sample_time_ms": 659.913, "learn_time_ms": 4848.183, "learn_throughput": 825.051, "synch_weights_time_ms": 13.15}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "training_iteration": 93, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-03-19", "timestamp": 1723395799, "time_this_iter_s": 5.38493800163269, "time_total_s": 517.1131846904755, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2f820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 517.1131846904755, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 32.775, "ram_util_percent": 82.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1784487112425268, "cur_kl_coeff": 8.673617379884037e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09285617690911749, "policy_loss": 8.808066825925683e-05, "vf_loss": 0.09276809597407312, "vf_explained_var": 0.9948685384665926, "kl": 0.001331371005921106, "entropy": 0.1232532756558309, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1272632899694144, "cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08795223114390562, "policy_loss": -0.011271841994069593, "vf_loss": 0.09922407252403596, "vf_explained_var": 0.9942079368978739, "kl": 0.0036885987368540244, "entropy": 0.32862118881506225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.60658024637951, "predator_policy": 0.546592348012364}, "policy_reward_max": {"prey_policy": -0.546592348012364, "predator_policy": 51.60658024637951}, "policy_reward_mean": {"prey_policy": -24.284767868923197, "predator_policy": 24.284767868923197}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-13.916865836851242, -33.44360185584716, -20.547095565135567, -33.88949433274668, -15.505079166559913, -37.88309566852536, -16.224680237061403, -37.99066666583815, -26.453743454814774, -27.267349075059514, -16.42309995113736, -5.984624830685265, -16.82725045088991, -46.93811596401322, -41.11762103091564, -8.555333485786829, -27.28252252404607, -34.71007887691701, -51.60658024637951, -29.169853304573248, -24.56300586480998, -39.01942331374626, -21.420682231833908, -26.96418223363707, -35.66270697491005, -11.359319323051995, -32.40582402884745, -23.307810184391254, -5.043399246774118, -10.825197946913429, -9.229618634754033, -22.035830410404593, -39.07605714703182, -27.01169483634059, -42.48619870935891, -30.21700461576904, -21.495223613243844, -24.727790938731367, -11.593601791675045, -22.426613646436593, -4.78715959990135, -18.342257662275216, -7.199941669574564, -36.18677373269291, -44.842112416455095, -9.583993145438786, -25.763461994307242, -44.874439492369575, -18.272670956748012, -12.311630052405436, -27.1230583027028, -38.89932838585429, -24.111922785027655, -29.006263951563476, -15.461641384119524, -20.01974636728624, -47.54682827318746, -17.36096781623729, -25.186653928744732, -5.4098230418647, -4.954527433188319, -7.547676313995944, -33.82424112945824, -5.876206055763955, -20.813561885581393, -27.202928091771994, -37.406816774541724, -24.75686611909465, -44.909350930226594, -25.703513809334115, -50.095999439291745, -41.46047707053369, -15.114914265185996, -7.525628044488657, -10.472856117319552, -18.417615871103447, -37.283091940581954, -13.429893456430364, -30.01527654977745, -29.225977645415036, -46.073147382477586, -11.474941251114046, -0.546592348012364, -38.623011774200926, -16.20362894643225, -16.601765516540883, -24.444481363737918, -5.819004498208745, -34.38757760668063, -40.888055236732995, -22.549175921384222, -12.288067658720191, -17.070112758521276, -33.165534894689124, -4.086786941593267, -32.65027811666404, -17.453939918181526, -30.267228998197726, -21.595535849064344, -21.351887792879317], "policy_predator_policy_reward": [13.916865836851242, 33.44360185584716, 20.547095565135567, 33.88949433274668, 15.505079166559913, 37.88309566852536, 16.224680237061403, 37.99066666583815, 26.453743454814774, 27.267349075059514, 16.42309995113736, 5.984624830685265, 16.82725045088991, 46.93811596401322, 41.11762103091564, 8.555333485786829, 27.28252252404607, 34.71007887691701, 51.60658024637951, 29.169853304573248, 24.56300586480998, 39.01942331374626, 21.420682231833908, 26.96418223363707, 35.66270697491005, 11.359319323051995, 32.40582402884745, 23.307810184391254, 5.043399246774118, 10.825197946913429, 9.229618634754033, 22.035830410404593, 39.07605714703182, 27.01169483634059, 42.48619870935891, 30.21700461576904, 21.495223613243844, 24.727790938731367, 11.593601791675045, 22.426613646436593, 4.78715959990135, 18.342257662275216, 7.199941669574564, 36.18677373269291, 44.842112416455095, 9.583993145438786, 25.763461994307242, 44.874439492369575, 18.272670956748012, 12.311630052405436, 27.1230583027028, 38.89932838585429, 24.111922785027655, 29.006263951563476, 15.461641384119524, 20.01974636728624, 47.54682827318746, 17.36096781623729, 25.186653928744732, 5.4098230418647, 4.954527433188319, 7.547676313995944, 33.82424112945824, 5.876206055763955, 20.813561885581393, 27.202928091771994, 37.406816774541724, 24.75686611909465, 44.909350930226594, 25.703513809334115, 50.095999439291745, 41.46047707053369, 15.114914265185996, 7.525628044488657, 10.472856117319552, 18.417615871103447, 37.283091940581954, 13.429893456430364, 30.01527654977745, 29.225977645415036, 46.073147382477586, 11.474941251114046, 0.546592348012364, 38.623011774200926, 16.20362894643225, 16.601765516540883, 24.444481363737918, 5.819004498208745, 34.38757760668063, 40.888055236732995, 22.549175921384222, 12.288067658720191, 17.070112758521276, 33.165534894689124, 4.086786941593267, 32.65027811666404, 17.453939918181526, 30.267228998197726, 21.595535849064344, 21.351887792879317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2855475340643305, "mean_inference_ms": 0.9525819602147887, "mean_action_processing_ms": 0.12636431081932606, "mean_env_wait_ms": 0.06749176218825757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025849342346191406, "StateBufferConnector_ms": 0.0024576187133789062, "ViewRequirementAgentConnector_ms": 0.04640603065490723}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 748.8976366037632, "num_env_steps_trained_throughput_per_sec": 748.8976366037632, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 5470.035, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5470.0, "sample_time_ms": 660.24, "learn_time_ms": 4796.791, "learn_throughput": 833.891, "synch_weights_time_ms": 12.591}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 94, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-03-25", "timestamp": 1723395805, "time_this_iter_s": 5.3460328578948975, "time_total_s": 522.4592175483704, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7854430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 522.4592175483704, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 35.82857142857143, "ram_util_percent": 82.82857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.441733829646061, "cur_kl_coeff": 4.3368086899420186e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.14540931885664274, "policy_loss": 0.0003866688949832072, "vf_loss": 0.14502264928014483, "vf_explained_var": 0.9965462395300467, "kl": 0.001218560949376928, "entropy": 0.11630449539904172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2673553816663723, "cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.15994625720772623, "policy_loss": -0.025449901908965938, "vf_loss": 0.1853961584100034, "vf_explained_var": 0.994499517728885, "kl": 0.007500089929970077, "entropy": 0.3386316572160771, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -51.60658024637951, "predator_policy": 0.546592348012364}, "policy_reward_max": {"prey_policy": -0.546592348012364, "predator_policy": 51.60658024637951}, "policy_reward_mean": {"prey_policy": -23.88762652771688, "predator_policy": 23.88762652771688}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-27.267349075059514, -16.42309995113736, -5.984624830685265, -16.82725045088991, -46.93811596401322, -41.11762103091564, -8.555333485786829, -27.28252252404607, -34.71007887691701, -51.60658024637951, -29.169853304573248, -24.56300586480998, -39.01942331374626, -21.420682231833908, -26.96418223363707, -35.66270697491005, -11.359319323051995, -32.40582402884745, -23.307810184391254, -5.043399246774118, -10.825197946913429, -9.229618634754033, -22.035830410404593, -39.07605714703182, -27.01169483634059, -42.48619870935891, -30.21700461576904, -21.495223613243844, -24.727790938731367, -11.593601791675045, -22.426613646436593, -4.78715959990135, -18.342257662275216, -7.199941669574564, -36.18677373269291, -44.842112416455095, -9.583993145438786, -25.763461994307242, -44.874439492369575, -18.272670956748012, -12.311630052405436, -27.1230583027028, -38.89932838585429, -24.111922785027655, -29.006263951563476, -15.461641384119524, -20.01974636728624, -47.54682827318746, -17.36096781623729, -25.186653928744732, -5.4098230418647, -4.954527433188319, -7.547676313995944, -33.82424112945824, -5.876206055763955, -20.813561885581393, -27.202928091771994, -37.406816774541724, -24.75686611909465, -44.909350930226594, -25.703513809334115, -50.095999439291745, -41.46047707053369, -15.114914265185996, -7.525628044488657, -10.472856117319552, -18.417615871103447, -37.283091940581954, -13.429893456430364, -30.01527654977745, -29.225977645415036, -46.073147382477586, -11.474941251114046, -0.546592348012364, -38.623011774200926, -16.20362894643225, -16.601765516540883, -24.444481363737918, -5.819004498208745, -34.38757760668063, -40.888055236732995, -22.549175921384222, -12.288067658720191, -17.070112758521276, -33.165534894689124, -4.086786941593267, -32.65027811666404, -17.453939918181526, -30.267228998197726, -21.595535849064344, -21.351887792879317, -25.545249877268223, -15.059990236464394, -19.14052439337664, -30.13223623058363, -19.940992175364848, -15.204080937581171, -41.374300290580905, -17.77299790023057, -11.969816621298586], "policy_predator_policy_reward": [27.267349075059514, 16.42309995113736, 5.984624830685265, 16.82725045088991, 46.93811596401322, 41.11762103091564, 8.555333485786829, 27.28252252404607, 34.71007887691701, 51.60658024637951, 29.169853304573248, 24.56300586480998, 39.01942331374626, 21.420682231833908, 26.96418223363707, 35.66270697491005, 11.359319323051995, 32.40582402884745, 23.307810184391254, 5.043399246774118, 10.825197946913429, 9.229618634754033, 22.035830410404593, 39.07605714703182, 27.01169483634059, 42.48619870935891, 30.21700461576904, 21.495223613243844, 24.727790938731367, 11.593601791675045, 22.426613646436593, 4.78715959990135, 18.342257662275216, 7.199941669574564, 36.18677373269291, 44.842112416455095, 9.583993145438786, 25.763461994307242, 44.874439492369575, 18.272670956748012, 12.311630052405436, 27.1230583027028, 38.89932838585429, 24.111922785027655, 29.006263951563476, 15.461641384119524, 20.01974636728624, 47.54682827318746, 17.36096781623729, 25.186653928744732, 5.4098230418647, 4.954527433188319, 7.547676313995944, 33.82424112945824, 5.876206055763955, 20.813561885581393, 27.202928091771994, 37.406816774541724, 24.75686611909465, 44.909350930226594, 25.703513809334115, 50.095999439291745, 41.46047707053369, 15.114914265185996, 7.525628044488657, 10.472856117319552, 18.417615871103447, 37.283091940581954, 13.429893456430364, 30.01527654977745, 29.225977645415036, 46.073147382477586, 11.474941251114046, 0.546592348012364, 38.623011774200926, 16.20362894643225, 16.601765516540883, 24.444481363737918, 5.819004498208745, 34.38757760668063, 40.888055236732995, 22.549175921384222, 12.288067658720191, 17.070112758521276, 33.165534894689124, 4.086786941593267, 32.65027811666404, 17.453939918181526, 30.267228998197726, 21.595535849064344, 21.351887792879317, 25.545249877268223, 15.059990236464394, 19.14052439337664, 30.13223623058363, 19.940992175364848, 15.204080937581171, 41.374300290580905, 17.77299790023057, 11.969816621298586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28542948411912095, "mean_inference_ms": 0.9522604947317564, "mean_action_processing_ms": 0.1263468958845021, "mean_env_wait_ms": 0.06746639590073243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002574324607849121, "StateBufferConnector_ms": 0.0024510622024536133, "ViewRequirementAgentConnector_ms": 0.046440720558166504}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 697.6785945007566, "num_env_steps_trained_throughput_per_sec": 697.6785945007566, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 5510.781, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5510.746, "sample_time_ms": 661.761, "learn_time_ms": 4835.766, "learn_throughput": 827.17, "synch_weights_time_ms": 12.839}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "done": false, "training_iteration": 95, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-03-30", "timestamp": 1723395810, "time_this_iter_s": 5.738807201385498, "time_total_s": 528.1980247497559, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78875e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 528.1980247497559, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 38.037499999999994, "ram_util_percent": 82.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0200964740011842, "cur_kl_coeff": 2.1684043449710093e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.10718805983803274, "policy_loss": -0.0033858450997892456, "vf_loss": 0.11057390513791082, "vf_explained_var": 0.9939837319776416, "kl": 0.0074769873678199395, "entropy": 0.1418493900448084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.146357545411835, "cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09240975685507541, "policy_loss": -0.005464821143687004, "vf_loss": 0.09787457701313543, "vf_explained_var": 0.9950219551101327, "kl": 0.0017959600153121555, "entropy": 0.32678901284622647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -61.54091242152943, "predator_policy": 0.546592348012364}, "policy_reward_max": {"prey_policy": -0.546592348012364, "predator_policy": 61.54091242152943}, "policy_reward_mean": {"prey_policy": -24.571050303938815, "predator_policy": 24.571050303938815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-51.60658024637951, -29.169853304573248, -24.56300586480998, -39.01942331374626, -21.420682231833908, -26.96418223363707, -35.66270697491005, -11.359319323051995, -32.40582402884745, -23.307810184391254, -5.043399246774118, -10.825197946913429, -9.229618634754033, -22.035830410404593, -39.07605714703182, -27.01169483634059, -42.48619870935891, -30.21700461576904, -21.495223613243844, -24.727790938731367, -11.593601791675045, -22.426613646436593, -4.78715959990135, -18.342257662275216, -7.199941669574564, -36.18677373269291, -44.842112416455095, -9.583993145438786, -25.763461994307242, -44.874439492369575, -18.272670956748012, -12.311630052405436, -27.1230583027028, -38.89932838585429, -24.111922785027655, -29.006263951563476, -15.461641384119524, -20.01974636728624, -47.54682827318746, -17.36096781623729, -25.186653928744732, -5.4098230418647, -4.954527433188319, -7.547676313995944, -33.82424112945824, -5.876206055763955, -20.813561885581393, -27.202928091771994, -37.406816774541724, -24.75686611909465, -44.909350930226594, -25.703513809334115, -50.095999439291745, -41.46047707053369, -15.114914265185996, -7.525628044488657, -10.472856117319552, -18.417615871103447, -37.283091940581954, -13.429893456430364, -30.01527654977745, -29.225977645415036, -46.073147382477586, -11.474941251114046, -0.546592348012364, -38.623011774200926, -16.20362894643225, -16.601765516540883, -24.444481363737918, -5.819004498208745, -34.38757760668063, -40.888055236732995, -22.549175921384222, -12.288067658720191, -17.070112758521276, -33.165534894689124, -4.086786941593267, -32.65027811666404, -17.453939918181526, -30.267228998197726, -21.595535849064344, -21.351887792879317, -25.545249877268223, -15.059990236464394, -19.14052439337664, -30.13223623058363, -19.940992175364848, -15.204080937581171, -41.374300290580905, -17.77299790023057, -11.969816621298586, -61.54091242152943, -43.24230028277805, -7.943761265084327, -34.11312214952752, -34.02174803302458, -30.27123175396678, -40.31291806593366, -40.5650686183382, -1.4373112214617905], "policy_predator_policy_reward": [51.60658024637951, 29.169853304573248, 24.56300586480998, 39.01942331374626, 21.420682231833908, 26.96418223363707, 35.66270697491005, 11.359319323051995, 32.40582402884745, 23.307810184391254, 5.043399246774118, 10.825197946913429, 9.229618634754033, 22.035830410404593, 39.07605714703182, 27.01169483634059, 42.48619870935891, 30.21700461576904, 21.495223613243844, 24.727790938731367, 11.593601791675045, 22.426613646436593, 4.78715959990135, 18.342257662275216, 7.199941669574564, 36.18677373269291, 44.842112416455095, 9.583993145438786, 25.763461994307242, 44.874439492369575, 18.272670956748012, 12.311630052405436, 27.1230583027028, 38.89932838585429, 24.111922785027655, 29.006263951563476, 15.461641384119524, 20.01974636728624, 47.54682827318746, 17.36096781623729, 25.186653928744732, 5.4098230418647, 4.954527433188319, 7.547676313995944, 33.82424112945824, 5.876206055763955, 20.813561885581393, 27.202928091771994, 37.406816774541724, 24.75686611909465, 44.909350930226594, 25.703513809334115, 50.095999439291745, 41.46047707053369, 15.114914265185996, 7.525628044488657, 10.472856117319552, 18.417615871103447, 37.283091940581954, 13.429893456430364, 30.01527654977745, 29.225977645415036, 46.073147382477586, 11.474941251114046, 0.546592348012364, 38.623011774200926, 16.20362894643225, 16.601765516540883, 24.444481363737918, 5.819004498208745, 34.38757760668063, 40.888055236732995, 22.549175921384222, 12.288067658720191, 17.070112758521276, 33.165534894689124, 4.086786941593267, 32.65027811666404, 17.453939918181526, 30.267228998197726, 21.595535849064344, 21.351887792879317, 25.545249877268223, 15.059990236464394, 19.14052439337664, 30.13223623058363, 19.940992175364848, 15.204080937581171, 41.374300290580905, 17.77299790023057, 11.969816621298586, 61.54091242152943, 43.24230028277805, 7.943761265084327, 34.11312214952752, 34.02174803302458, 30.27123175396678, 40.31291806593366, 40.5650686183382, 1.4373112214617905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28531809822578486, "mean_inference_ms": 0.951935360797927, "mean_action_processing_ms": 0.1263297962803586, "mean_env_wait_ms": 0.06744069282789403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002543926239013672, "StateBufferConnector_ms": 0.0024503469467163086, "ViewRequirementAgentConnector_ms": 0.04629969596862793}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 714.8955521089807, "num_env_steps_trained_throughput_per_sec": 714.8955521089807, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 5522.2, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5522.166, "sample_time_ms": 656.293, "learn_time_ms": 4852.483, "learn_throughput": 824.32, "synch_weights_time_ms": 12.95}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 96, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-03-36", "timestamp": 1723395816, "time_this_iter_s": 5.604619979858398, "time_total_s": 533.8026447296143, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78a9550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 533.8026447296143, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 35.275, "ram_util_percent": 82.6875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.143257459299639, "cur_kl_coeff": 2.1684043449710093e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09589231345016742, "policy_loss": -0.0031020196724663644, "vf_loss": 0.09899433245591353, "vf_explained_var": 0.9946837580452362, "kl": 0.002883476178235352, "entropy": 0.12931269839173182, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0547474967160573, "cur_kl_coeff": 9.536743164062502e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09016743058687643, "policy_loss": -0.0063568403966201, "vf_loss": 0.09652427132144416, "vf_explained_var": 0.9951314709459742, "kl": 0.0028691573939819467, "entropy": 0.30219138842076065, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -61.54091242152943, "predator_policy": 0.546592348012364}, "policy_reward_max": {"prey_policy": -0.546592348012364, "predator_policy": 61.54091242152943}, "policy_reward_mean": {"prey_policy": -24.044453826970635, "predator_policy": 24.044453826970635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-23.307810184391254, -5.043399246774118, -10.825197946913429, -9.229618634754033, -22.035830410404593, -39.07605714703182, -27.01169483634059, -42.48619870935891, -30.21700461576904, -21.495223613243844, -24.727790938731367, -11.593601791675045, -22.426613646436593, -4.78715959990135, -18.342257662275216, -7.199941669574564, -36.18677373269291, -44.842112416455095, -9.583993145438786, -25.763461994307242, -44.874439492369575, -18.272670956748012, -12.311630052405436, -27.1230583027028, -38.89932838585429, -24.111922785027655, -29.006263951563476, -15.461641384119524, -20.01974636728624, -47.54682827318746, -17.36096781623729, -25.186653928744732, -5.4098230418647, -4.954527433188319, -7.547676313995944, -33.82424112945824, -5.876206055763955, -20.813561885581393, -27.202928091771994, -37.406816774541724, -24.75686611909465, -44.909350930226594, -25.703513809334115, -50.095999439291745, -41.46047707053369, -15.114914265185996, -7.525628044488657, -10.472856117319552, -18.417615871103447, -37.283091940581954, -13.429893456430364, -30.01527654977745, -29.225977645415036, -46.073147382477586, -11.474941251114046, -0.546592348012364, -38.623011774200926, -16.20362894643225, -16.601765516540883, -24.444481363737918, -5.819004498208745, -34.38757760668063, -40.888055236732995, -22.549175921384222, -12.288067658720191, -17.070112758521276, -33.165534894689124, -4.086786941593267, -32.65027811666404, -17.453939918181526, -30.267228998197726, -21.595535849064344, -21.351887792879317, -25.545249877268223, -15.059990236464394, -19.14052439337664, -30.13223623058363, -19.940992175364848, -15.204080937581171, -41.374300290580905, -17.77299790023057, -11.969816621298586, -61.54091242152943, -43.24230028277805, -7.943761265084327, -34.11312214952752, -34.02174803302458, -30.27123175396678, -40.31291806593366, -40.5650686183382, -1.4373112214617905, -44.70852399126967, -25.348804107320284, -13.195411746191109, -41.55291081572308, -15.374217639793532, -24.380416091565806, -20.585193039793992, -25.0196536527478, -9.34679874056542], "policy_predator_policy_reward": [23.307810184391254, 5.043399246774118, 10.825197946913429, 9.229618634754033, 22.035830410404593, 39.07605714703182, 27.01169483634059, 42.48619870935891, 30.21700461576904, 21.495223613243844, 24.727790938731367, 11.593601791675045, 22.426613646436593, 4.78715959990135, 18.342257662275216, 7.199941669574564, 36.18677373269291, 44.842112416455095, 9.583993145438786, 25.763461994307242, 44.874439492369575, 18.272670956748012, 12.311630052405436, 27.1230583027028, 38.89932838585429, 24.111922785027655, 29.006263951563476, 15.461641384119524, 20.01974636728624, 47.54682827318746, 17.36096781623729, 25.186653928744732, 5.4098230418647, 4.954527433188319, 7.547676313995944, 33.82424112945824, 5.876206055763955, 20.813561885581393, 27.202928091771994, 37.406816774541724, 24.75686611909465, 44.909350930226594, 25.703513809334115, 50.095999439291745, 41.46047707053369, 15.114914265185996, 7.525628044488657, 10.472856117319552, 18.417615871103447, 37.283091940581954, 13.429893456430364, 30.01527654977745, 29.225977645415036, 46.073147382477586, 11.474941251114046, 0.546592348012364, 38.623011774200926, 16.20362894643225, 16.601765516540883, 24.444481363737918, 5.819004498208745, 34.38757760668063, 40.888055236732995, 22.549175921384222, 12.288067658720191, 17.070112758521276, 33.165534894689124, 4.086786941593267, 32.65027811666404, 17.453939918181526, 30.267228998197726, 21.595535849064344, 21.351887792879317, 25.545249877268223, 15.059990236464394, 19.14052439337664, 30.13223623058363, 19.940992175364848, 15.204080937581171, 41.374300290580905, 17.77299790023057, 11.969816621298586, 61.54091242152943, 43.24230028277805, 7.943761265084327, 34.11312214952752, 34.02174803302458, 30.27123175396678, 40.31291806593366, 40.5650686183382, 1.4373112214617905, 44.70852399126967, 25.348804107320284, 13.195411746191109, 41.55291081572308, 15.374217639793532, 24.380416091565806, 20.585193039793992, 25.0196536527478, 9.34679874056542]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2852321538140349, "mean_inference_ms": 0.9516559928994351, "mean_action_processing_ms": 0.12631713717687024, "mean_env_wait_ms": 0.06742118321438059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025290250778198242, "StateBufferConnector_ms": 0.0035959482192993164, "ViewRequirementAgentConnector_ms": 0.04606425762176514}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 702.0393652511015, "num_env_steps_trained_throughput_per_sec": 702.0393652511015, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 776000, "timers": {"training_iteration_time_ms": 5529.012, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5528.977, "sample_time_ms": 654.954, "learn_time_ms": 4860.835, "learn_throughput": 822.904, "synch_weights_time_ms": 12.745}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000}, "done": false, "training_iteration": 97, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-03-42", "timestamp": 1723395822, "time_this_iter_s": 5.703190088272095, "time_total_s": 539.5058348178864, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2f820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 539.5058348178864, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 37.97500000000001, "ram_util_percent": 82.8375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9462199956644326, "cur_kl_coeff": 1.0842021724855046e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.037480149126107185, "policy_loss": -0.0015263999193848576, "vf_loss": 0.03900654901517555, "vf_explained_var": 0.9955892677729329, "kl": 0.002369399046562267, "entropy": 0.11429389370411323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6409708258385459, "cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03209947386467557, "policy_loss": -0.008163082516693976, "vf_loss": 0.04026255585583082, "vf_explained_var": 0.994902418491741, "kl": 0.006871887348102772, "entropy": 0.32452027667313815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -61.54091242152943, "predator_policy": 0.546592348012364}, "policy_reward_max": {"prey_policy": -0.546592348012364, "predator_policy": 61.54091242152943}, "policy_reward_mean": {"prey_policy": -23.867447990533396, "predator_policy": 23.867447990533396}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-21.495223613243844, -24.727790938731367, -11.593601791675045, -22.426613646436593, -4.78715959990135, -18.342257662275216, -7.199941669574564, -36.18677373269291, -44.842112416455095, -9.583993145438786, -25.763461994307242, -44.874439492369575, -18.272670956748012, -12.311630052405436, -27.1230583027028, -38.89932838585429, -24.111922785027655, -29.006263951563476, -15.461641384119524, -20.01974636728624, -47.54682827318746, -17.36096781623729, -25.186653928744732, -5.4098230418647, -4.954527433188319, -7.547676313995944, -33.82424112945824, -5.876206055763955, -20.813561885581393, -27.202928091771994, -37.406816774541724, -24.75686611909465, -44.909350930226594, -25.703513809334115, -50.095999439291745, -41.46047707053369, -15.114914265185996, -7.525628044488657, -10.472856117319552, -18.417615871103447, -37.283091940581954, -13.429893456430364, -30.01527654977745, -29.225977645415036, -46.073147382477586, -11.474941251114046, -0.546592348012364, -38.623011774200926, -16.20362894643225, -16.601765516540883, -24.444481363737918, -5.819004498208745, -34.38757760668063, -40.888055236732995, -22.549175921384222, -12.288067658720191, -17.070112758521276, -33.165534894689124, -4.086786941593267, -32.65027811666404, -17.453939918181526, -30.267228998197726, -21.595535849064344, -21.351887792879317, -25.545249877268223, -15.059990236464394, -19.14052439337664, -30.13223623058363, -19.940992175364848, -15.204080937581171, -41.374300290580905, -17.77299790023057, -11.969816621298586, -61.54091242152943, -43.24230028277805, -7.943761265084327, -34.11312214952752, -34.02174803302458, -30.27123175396678, -40.31291806593366, -40.5650686183382, -1.4373112214617905, -44.70852399126967, -25.348804107320284, -13.195411746191109, -41.55291081572308, -15.374217639793532, -24.380416091565806, -20.585193039793992, -25.0196536527478, -9.34679874056542, -14.4172424700415, -35.9018647673863, -5.193970522425994, -29.389177098222603, -42.1622837355019, -9.005663387455282, -24.880085311483253, -26.278899515579553, -4.303041279917952], "policy_predator_policy_reward": [21.495223613243844, 24.727790938731367, 11.593601791675045, 22.426613646436593, 4.78715959990135, 18.342257662275216, 7.199941669574564, 36.18677373269291, 44.842112416455095, 9.583993145438786, 25.763461994307242, 44.874439492369575, 18.272670956748012, 12.311630052405436, 27.1230583027028, 38.89932838585429, 24.111922785027655, 29.006263951563476, 15.461641384119524, 20.01974636728624, 47.54682827318746, 17.36096781623729, 25.186653928744732, 5.4098230418647, 4.954527433188319, 7.547676313995944, 33.82424112945824, 5.876206055763955, 20.813561885581393, 27.202928091771994, 37.406816774541724, 24.75686611909465, 44.909350930226594, 25.703513809334115, 50.095999439291745, 41.46047707053369, 15.114914265185996, 7.525628044488657, 10.472856117319552, 18.417615871103447, 37.283091940581954, 13.429893456430364, 30.01527654977745, 29.225977645415036, 46.073147382477586, 11.474941251114046, 0.546592348012364, 38.623011774200926, 16.20362894643225, 16.601765516540883, 24.444481363737918, 5.819004498208745, 34.38757760668063, 40.888055236732995, 22.549175921384222, 12.288067658720191, 17.070112758521276, 33.165534894689124, 4.086786941593267, 32.65027811666404, 17.453939918181526, 30.267228998197726, 21.595535849064344, 21.351887792879317, 25.545249877268223, 15.059990236464394, 19.14052439337664, 30.13223623058363, 19.940992175364848, 15.204080937581171, 41.374300290580905, 17.77299790023057, 11.969816621298586, 61.54091242152943, 43.24230028277805, 7.943761265084327, 34.11312214952752, 34.02174803302458, 30.27123175396678, 40.31291806593366, 40.5650686183382, 1.4373112214617905, 44.70852399126967, 25.348804107320284, 13.195411746191109, 41.55291081572308, 15.374217639793532, 24.380416091565806, 20.585193039793992, 25.0196536527478, 9.34679874056542, 14.4172424700415, 35.9018647673863, 5.193970522425994, 29.389177098222603, 42.1622837355019, 9.005663387455282, 24.880085311483253, 26.278899515579553, 4.303041279917952]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2851393036096445, "mean_inference_ms": 0.9513161537930626, "mean_action_processing_ms": 0.12629824003426465, "mean_env_wait_ms": 0.06738749752716705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002558112144470215, "StateBufferConnector_ms": 0.003630995750427246, "ViewRequirementAgentConnector_ms": 0.04656672477722168}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 745.5209109768754, "num_env_steps_trained_throughput_per_sec": 745.5209109768754, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 5545.401, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5545.366, "sample_time_ms": 657.52, "learn_time_ms": 4874.409, "learn_throughput": 820.612, "synch_weights_time_ms": 13.004}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 98, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-03-47", "timestamp": 1723395827, "time_this_iter_s": 5.370749235153198, "time_total_s": 544.8765840530396, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f223a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 544.8765840530396, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 35.25, "ram_util_percent": 83.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.179265527613461, "cur_kl_coeff": 5.421010862427523e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.16989390042969413, "policy_loss": -0.00032303428185211184, "vf_loss": 0.17021693371546764, "vf_explained_var": 0.9855561498552561, "kl": 0.0012749167843523668, "entropy": 0.12779880745414024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.22573245872433, "cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.17855941593134048, "policy_loss": -0.003934419970028103, "vf_loss": 0.18249383583509673, "vf_explained_var": 0.9843106336891652, "kl": 0.0027520601690268856, "entropy": 0.352228450247397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -61.54091242152943, "predator_policy": 0.546592348012364}, "policy_reward_max": {"prey_policy": -0.546592348012364, "predator_policy": 61.54091242152943}, "policy_reward_mean": {"prey_policy": -23.902091912710393, "predator_policy": 23.902091912710393}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-4.78715959990135, -18.342257662275216, -7.199941669574564, -36.18677373269291, -44.842112416455095, -9.583993145438786, -25.763461994307242, -44.874439492369575, -18.272670956748012, -12.311630052405436, -27.1230583027028, -38.89932838585429, -24.111922785027655, -29.006263951563476, -15.461641384119524, -20.01974636728624, -47.54682827318746, -17.36096781623729, -25.186653928744732, -5.4098230418647, -4.954527433188319, -7.547676313995944, -33.82424112945824, -5.876206055763955, -20.813561885581393, -27.202928091771994, -37.406816774541724, -24.75686611909465, -44.909350930226594, -25.703513809334115, -50.095999439291745, -41.46047707053369, -15.114914265185996, -7.525628044488657, -10.472856117319552, -18.417615871103447, -37.283091940581954, -13.429893456430364, -30.01527654977745, -29.225977645415036, -46.073147382477586, -11.474941251114046, -0.546592348012364, -38.623011774200926, -16.20362894643225, -16.601765516540883, -24.444481363737918, -5.819004498208745, -34.38757760668063, -40.888055236732995, -22.549175921384222, -12.288067658720191, -17.070112758521276, -33.165534894689124, -4.086786941593267, -32.65027811666404, -17.453939918181526, -30.267228998197726, -21.595535849064344, -21.351887792879317, -25.545249877268223, -15.059990236464394, -19.14052439337664, -30.13223623058363, -19.940992175364848, -15.204080937581171, -41.374300290580905, -17.77299790023057, -11.969816621298586, -61.54091242152943, -43.24230028277805, -7.943761265084327, -34.11312214952752, -34.02174803302458, -30.27123175396678, -40.31291806593366, -40.5650686183382, -1.4373112214617905, -44.70852399126967, -25.348804107320284, -13.195411746191109, -41.55291081572308, -15.374217639793532, -24.380416091565806, -20.585193039793992, -25.0196536527478, -9.34679874056542, -14.4172424700415, -35.9018647673863, -5.193970522425994, -29.389177098222603, -42.1622837355019, -9.005663387455282, -24.880085311483253, -26.278899515579553, -4.303041279917952, -37.88330588166209, -2.279595219003319, -11.889179995577283, -31.655541111544366], "policy_predator_policy_reward": [4.78715959990135, 18.342257662275216, 7.199941669574564, 36.18677373269291, 44.842112416455095, 9.583993145438786, 25.763461994307242, 44.874439492369575, 18.272670956748012, 12.311630052405436, 27.1230583027028, 38.89932838585429, 24.111922785027655, 29.006263951563476, 15.461641384119524, 20.01974636728624, 47.54682827318746, 17.36096781623729, 25.186653928744732, 5.4098230418647, 4.954527433188319, 7.547676313995944, 33.82424112945824, 5.876206055763955, 20.813561885581393, 27.202928091771994, 37.406816774541724, 24.75686611909465, 44.909350930226594, 25.703513809334115, 50.095999439291745, 41.46047707053369, 15.114914265185996, 7.525628044488657, 10.472856117319552, 18.417615871103447, 37.283091940581954, 13.429893456430364, 30.01527654977745, 29.225977645415036, 46.073147382477586, 11.474941251114046, 0.546592348012364, 38.623011774200926, 16.20362894643225, 16.601765516540883, 24.444481363737918, 5.819004498208745, 34.38757760668063, 40.888055236732995, 22.549175921384222, 12.288067658720191, 17.070112758521276, 33.165534894689124, 4.086786941593267, 32.65027811666404, 17.453939918181526, 30.267228998197726, 21.595535849064344, 21.351887792879317, 25.545249877268223, 15.059990236464394, 19.14052439337664, 30.13223623058363, 19.940992175364848, 15.204080937581171, 41.374300290580905, 17.77299790023057, 11.969816621298586, 61.54091242152943, 43.24230028277805, 7.943761265084327, 34.11312214952752, 34.02174803302458, 30.27123175396678, 40.31291806593366, 40.5650686183382, 1.4373112214617905, 44.70852399126967, 25.348804107320284, 13.195411746191109, 41.55291081572308, 15.374217639793532, 24.380416091565806, 20.585193039793992, 25.0196536527478, 9.34679874056542, 14.4172424700415, 35.9018647673863, 5.193970522425994, 29.389177098222603, 42.1622837355019, 9.005663387455282, 24.880085311483253, 26.278899515579553, 4.303041279917952, 37.88330588166209, 2.279595219003319, 11.889179995577283, 31.655541111544366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28503192490751145, "mean_inference_ms": 0.9510235931350691, "mean_action_processing_ms": 0.1262547334073042, "mean_env_wait_ms": 0.06735207013984498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002580404281616211, "StateBufferConnector_ms": 0.0036749839782714844, "ViewRequirementAgentConnector_ms": 0.04714477062225342}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 724.9822235368366, "num_env_steps_trained_throughput_per_sec": 724.9822235368366, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 5528.368, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5528.333, "sample_time_ms": 657.314, "learn_time_ms": 4857.093, "learn_throughput": 823.538, "synch_weights_time_ms": 13.497}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "training_iteration": 99, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-03-53", "timestamp": 1723395833, "time_this_iter_s": 5.52106785774231, "time_total_s": 550.3976519107819, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f22ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 550.3976519107819, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 35.55, "ram_util_percent": 82.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1074435035698116, "cur_kl_coeff": 2.7105054312137616e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04455914904732102, "policy_loss": 3.0326795240398496e-06, "vf_loss": 0.04455611629236955, "vf_explained_var": 0.992567549397548, "kl": 0.001540181919433286, "entropy": 0.14219447230376925, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0228654444838563, "cur_kl_coeff": 2.3841857910156255e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.044828040571913634, "policy_loss": -0.003457767852038766, "vf_loss": 0.048285808438474, "vf_explained_var": 0.9923055409143369, "kl": 0.00383544310203016, "entropy": 0.33355373887655637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -61.54091242152943, "predator_policy": 0.546592348012364}, "policy_reward_max": {"prey_policy": -0.546592348012364, "predator_policy": 61.54091242152943}, "policy_reward_mean": {"prey_policy": -23.96852923020708, "predator_policy": 23.96852923020708}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-12.311630052405436, -27.1230583027028, -38.89932838585429, -24.111922785027655, -29.006263951563476, -15.461641384119524, -20.01974636728624, -47.54682827318746, -17.36096781623729, -25.186653928744732, -5.4098230418647, -4.954527433188319, -7.547676313995944, -33.82424112945824, -5.876206055763955, -20.813561885581393, -27.202928091771994, -37.406816774541724, -24.75686611909465, -44.909350930226594, -25.703513809334115, -50.095999439291745, -41.46047707053369, -15.114914265185996, -7.525628044488657, -10.472856117319552, -18.417615871103447, -37.283091940581954, -13.429893456430364, -30.01527654977745, -29.225977645415036, -46.073147382477586, -11.474941251114046, -0.546592348012364, -38.623011774200926, -16.20362894643225, -16.601765516540883, -24.444481363737918, -5.819004498208745, -34.38757760668063, -40.888055236732995, -22.549175921384222, -12.288067658720191, -17.070112758521276, -33.165534894689124, -4.086786941593267, -32.65027811666404, -17.453939918181526, -30.267228998197726, -21.595535849064344, -21.351887792879317, -25.545249877268223, -15.059990236464394, -19.14052439337664, -30.13223623058363, -19.940992175364848, -15.204080937581171, -41.374300290580905, -17.77299790023057, -11.969816621298586, -61.54091242152943, -43.24230028277805, -7.943761265084327, -34.11312214952752, -34.02174803302458, -30.27123175396678, -40.31291806593366, -40.5650686183382, -1.4373112214617905, -44.70852399126967, -25.348804107320284, -13.195411746191109, -41.55291081572308, -15.374217639793532, -24.380416091565806, -20.585193039793992, -25.0196536527478, -9.34679874056542, -14.4172424700415, -35.9018647673863, -5.193970522425994, -29.389177098222603, -42.1622837355019, -9.005663387455282, -24.880085311483253, -26.278899515579553, -4.303041279917952, -37.88330588166209, -2.279595219003319, -11.889179995577283, -31.655541111544366, -42.29798945924293, -36.45065131020516, -12.29609501745944, -9.573900351360058, -31.736818447065232, -22.424127904441455, -13.147676486428725, -27.811782586864606, -20.757500856363563], "policy_predator_policy_reward": [12.311630052405436, 27.1230583027028, 38.89932838585429, 24.111922785027655, 29.006263951563476, 15.461641384119524, 20.01974636728624, 47.54682827318746, 17.36096781623729, 25.186653928744732, 5.4098230418647, 4.954527433188319, 7.547676313995944, 33.82424112945824, 5.876206055763955, 20.813561885581393, 27.202928091771994, 37.406816774541724, 24.75686611909465, 44.909350930226594, 25.703513809334115, 50.095999439291745, 41.46047707053369, 15.114914265185996, 7.525628044488657, 10.472856117319552, 18.417615871103447, 37.283091940581954, 13.429893456430364, 30.01527654977745, 29.225977645415036, 46.073147382477586, 11.474941251114046, 0.546592348012364, 38.623011774200926, 16.20362894643225, 16.601765516540883, 24.444481363737918, 5.819004498208745, 34.38757760668063, 40.888055236732995, 22.549175921384222, 12.288067658720191, 17.070112758521276, 33.165534894689124, 4.086786941593267, 32.65027811666404, 17.453939918181526, 30.267228998197726, 21.595535849064344, 21.351887792879317, 25.545249877268223, 15.059990236464394, 19.14052439337664, 30.13223623058363, 19.940992175364848, 15.204080937581171, 41.374300290580905, 17.77299790023057, 11.969816621298586, 61.54091242152943, 43.24230028277805, 7.943761265084327, 34.11312214952752, 34.02174803302458, 30.27123175396678, 40.31291806593366, 40.5650686183382, 1.4373112214617905, 44.70852399126967, 25.348804107320284, 13.195411746191109, 41.55291081572308, 15.374217639793532, 24.380416091565806, 20.585193039793992, 25.0196536527478, 9.34679874056542, 14.4172424700415, 35.9018647673863, 5.193970522425994, 29.389177098222603, 42.1622837355019, 9.005663387455282, 24.880085311483253, 26.278899515579553, 4.303041279917952, 37.88330588166209, 2.279595219003319, 11.889179995577283, 31.655541111544366, 42.29798945924293, 36.45065131020516, 12.29609501745944, 9.573900351360058, 31.736818447065232, 22.424127904441455, 13.147676486428725, 27.811782586864606, 20.757500856363563]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28491060292634723, "mean_inference_ms": 0.9505548071942816, "mean_action_processing_ms": 0.1262304005153571, "mean_env_wait_ms": 0.06730870527407419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025655031204223633, "StateBufferConnector_ms": 0.003821730613708496, "ViewRequirementAgentConnector_ms": 0.04712080955505371}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 693.2682891836581, "num_env_steps_trained_throughput_per_sec": 693.2682891836581, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 5551.747, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5551.712, "sample_time_ms": 646.753, "learn_time_ms": 4891.084, "learn_throughput": 817.815, "synch_weights_time_ms": 13.444}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 100, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-03-58", "timestamp": 1723395838, "time_this_iter_s": 5.774504899978638, "time_total_s": 556.1721568107605, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f220d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 556.1721568107605, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 38.0375, "ram_util_percent": 82.9625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0199023926785837, "cur_kl_coeff": 1.3552527156068808e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07018424964771838, "policy_loss": -0.00033395278151147065, "vf_loss": 0.07051820201353015, "vf_explained_var": 0.9946503698204955, "kl": 0.0004926889514018826, "entropy": 0.11954020799603313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 96480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.033703990606591, "cur_kl_coeff": 1.1920928955078127e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07998998576977859, "policy_loss": -0.003593697962545169, "vf_loss": 0.08358368292683735, "vf_explained_var": 0.9937270756810903, "kl": 0.001445804135202757, "entropy": 0.3271096868440509, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 96480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -61.54091242152943, "predator_policy": 0.546592348012364}, "policy_reward_max": {"prey_policy": -0.546592348012364, "predator_policy": 61.54091242152943}, "policy_reward_mean": {"prey_policy": -23.60805192506085, "predator_policy": 23.60805192506085}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-15.461641384119524, -20.01974636728624, -47.54682827318746, -17.36096781623729, -25.186653928744732, -5.4098230418647, -4.954527433188319, -7.547676313995944, -33.82424112945824, -5.876206055763955, -20.813561885581393, -27.202928091771994, -37.406816774541724, -24.75686611909465, -44.909350930226594, -25.703513809334115, -50.095999439291745, -41.46047707053369, -15.114914265185996, -7.525628044488657, -10.472856117319552, -18.417615871103447, -37.283091940581954, -13.429893456430364, -30.01527654977745, -29.225977645415036, -46.073147382477586, -11.474941251114046, -0.546592348012364, -38.623011774200926, -16.20362894643225, -16.601765516540883, -24.444481363737918, -5.819004498208745, -34.38757760668063, -40.888055236732995, -22.549175921384222, -12.288067658720191, -17.070112758521276, -33.165534894689124, -4.086786941593267, -32.65027811666404, -17.453939918181526, -30.267228998197726, -21.595535849064344, -21.351887792879317, -25.545249877268223, -15.059990236464394, -19.14052439337664, -30.13223623058363, -19.940992175364848, -15.204080937581171, -41.374300290580905, -17.77299790023057, -11.969816621298586, -61.54091242152943, -43.24230028277805, -7.943761265084327, -34.11312214952752, -34.02174803302458, -30.27123175396678, -40.31291806593366, -40.5650686183382, -1.4373112214617905, -44.70852399126967, -25.348804107320284, -13.195411746191109, -41.55291081572308, -15.374217639793532, -24.380416091565806, -20.585193039793992, -25.0196536527478, -9.34679874056542, -14.4172424700415, -35.9018647673863, -5.193970522425994, -29.389177098222603, -42.1622837355019, -9.005663387455282, -24.880085311483253, -26.278899515579553, -4.303041279917952, -37.88330588166209, -2.279595219003319, -11.889179995577283, -31.655541111544366, -42.29798945924293, -36.45065131020516, -12.29609501745944, -9.573900351360058, -31.736818447065232, -22.424127904441455, -13.147676486428725, -27.811782586864606, -20.757500856363563, -17.427785335220356, -12.648306022026048, -6.859309896714833, -25.157224221199833, -33.31184748776903], "policy_predator_policy_reward": [15.461641384119524, 20.01974636728624, 47.54682827318746, 17.36096781623729, 25.186653928744732, 5.4098230418647, 4.954527433188319, 7.547676313995944, 33.82424112945824, 5.876206055763955, 20.813561885581393, 27.202928091771994, 37.406816774541724, 24.75686611909465, 44.909350930226594, 25.703513809334115, 50.095999439291745, 41.46047707053369, 15.114914265185996, 7.525628044488657, 10.472856117319552, 18.417615871103447, 37.283091940581954, 13.429893456430364, 30.01527654977745, 29.225977645415036, 46.073147382477586, 11.474941251114046, 0.546592348012364, 38.623011774200926, 16.20362894643225, 16.601765516540883, 24.444481363737918, 5.819004498208745, 34.38757760668063, 40.888055236732995, 22.549175921384222, 12.288067658720191, 17.070112758521276, 33.165534894689124, 4.086786941593267, 32.65027811666404, 17.453939918181526, 30.267228998197726, 21.595535849064344, 21.351887792879317, 25.545249877268223, 15.059990236464394, 19.14052439337664, 30.13223623058363, 19.940992175364848, 15.204080937581171, 41.374300290580905, 17.77299790023057, 11.969816621298586, 61.54091242152943, 43.24230028277805, 7.943761265084327, 34.11312214952752, 34.02174803302458, 30.27123175396678, 40.31291806593366, 40.5650686183382, 1.4373112214617905, 44.70852399126967, 25.348804107320284, 13.195411746191109, 41.55291081572308, 15.374217639793532, 24.380416091565806, 20.585193039793992, 25.0196536527478, 9.34679874056542, 14.4172424700415, 35.9018647673863, 5.193970522425994, 29.389177098222603, 42.1622837355019, 9.005663387455282, 24.880085311483253, 26.278899515579553, 4.303041279917952, 37.88330588166209, 2.279595219003319, 11.889179995577283, 31.655541111544366, 42.29798945924293, 36.45065131020516, 12.29609501745944, 9.573900351360058, 31.736818447065232, 22.424127904441455, 13.147676486428725, 27.811782586864606, 20.757500856363563, 17.427785335220356, 12.648306022026048, 6.859309896714833, 25.157224221199833, 33.31184748776903]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2849080088927411, "mean_inference_ms": 0.9504199881484215, "mean_action_processing_ms": 0.12625133970255212, "mean_env_wait_ms": 0.06730426704200991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002606034278869629, "StateBufferConnector_ms": 0.0038570165634155273, "ViewRequirementAgentConnector_ms": 0.047954440116882324}, "num_episodes": 5, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 686.8623795984889, "num_env_steps_trained_throughput_per_sec": 686.8623795984889, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 808000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 808000, "timers": {"training_iteration_time_ms": 5580.273, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5580.238, "sample_time_ms": 651.893, "learn_time_ms": 4914.182, "learn_throughput": 813.971, "synch_weights_time_ms": 13.731}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000}, "done": false, "training_iteration": 101, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-04-04", "timestamp": 1723395844, "time_this_iter_s": 5.860791921615601, "time_total_s": 562.0329487323761, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a785ae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 562.0329487323761, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 37.050000000000004, "ram_util_percent": 82.97500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0775552025840929, "cur_kl_coeff": 6.776263578034404e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.11522622965882572, "policy_loss": -0.001236446966989509, "vf_loss": 0.11646267710020766, "vf_explained_var": 0.9899288992707928, "kl": 0.0011988163646517336, "entropy": 0.0886864630272612, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 97440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.041701491565133, "cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.10439956047351491, "policy_loss": -0.01192354955225407, "vf_loss": 0.11632311023810568, "vf_explained_var": 0.9909856130679449, "kl": 0.003953359828154105, "entropy": 0.3104203697293997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 97440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -61.54091242152943, "predator_policy": 0.546592348012364}, "policy_reward_max": {"prey_policy": -0.546592348012364, "predator_policy": 61.54091242152943}, "policy_reward_mean": {"prey_policy": -23.477444911730164, "predator_policy": 23.477444911730164}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-5.876206055763955, -20.813561885581393, -27.202928091771994, -37.406816774541724, -24.75686611909465, -44.909350930226594, -25.703513809334115, -50.095999439291745, -41.46047707053369, -15.114914265185996, -7.525628044488657, -10.472856117319552, -18.417615871103447, -37.283091940581954, -13.429893456430364, -30.01527654977745, -29.225977645415036, -46.073147382477586, -11.474941251114046, -0.546592348012364, -38.623011774200926, -16.20362894643225, -16.601765516540883, -24.444481363737918, -5.819004498208745, -34.38757760668063, -40.888055236732995, -22.549175921384222, -12.288067658720191, -17.070112758521276, -33.165534894689124, -4.086786941593267, -32.65027811666404, -17.453939918181526, -30.267228998197726, -21.595535849064344, -21.351887792879317, -25.545249877268223, -15.059990236464394, -19.14052439337664, -30.13223623058363, -19.940992175364848, -15.204080937581171, -41.374300290580905, -17.77299790023057, -11.969816621298586, -61.54091242152943, -43.24230028277805, -7.943761265084327, -34.11312214952752, -34.02174803302458, -30.27123175396678, -40.31291806593366, -40.5650686183382, -1.4373112214617905, -44.70852399126967, -25.348804107320284, -13.195411746191109, -41.55291081572308, -15.374217639793532, -24.380416091565806, -20.585193039793992, -25.0196536527478, -9.34679874056542, -14.4172424700415, -35.9018647673863, -5.193970522425994, -29.389177098222603, -42.1622837355019, -9.005663387455282, -24.880085311483253, -26.278899515579553, -4.303041279917952, -37.88330588166209, -2.279595219003319, -11.889179995577283, -31.655541111544366, -42.29798945924293, -36.45065131020516, -12.29609501745944, -9.573900351360058, -31.736818447065232, -22.424127904441455, -13.147676486428725, -27.811782586864606, -20.757500856363563, -17.427785335220356, -12.648306022026048, -6.859309896714833, -25.157224221199833, -33.31184748776903, -14.589730346543035, -5.379160019325461, -8.605395053409799, -11.297826943194856, -11.457037512680387, -39.464170100515624, -12.283707723392887, -32.25536838050367, -28.919008275448228], "policy_predator_policy_reward": [5.876206055763955, 20.813561885581393, 27.202928091771994, 37.406816774541724, 24.75686611909465, 44.909350930226594, 25.703513809334115, 50.095999439291745, 41.46047707053369, 15.114914265185996, 7.525628044488657, 10.472856117319552, 18.417615871103447, 37.283091940581954, 13.429893456430364, 30.01527654977745, 29.225977645415036, 46.073147382477586, 11.474941251114046, 0.546592348012364, 38.623011774200926, 16.20362894643225, 16.601765516540883, 24.444481363737918, 5.819004498208745, 34.38757760668063, 40.888055236732995, 22.549175921384222, 12.288067658720191, 17.070112758521276, 33.165534894689124, 4.086786941593267, 32.65027811666404, 17.453939918181526, 30.267228998197726, 21.595535849064344, 21.351887792879317, 25.545249877268223, 15.059990236464394, 19.14052439337664, 30.13223623058363, 19.940992175364848, 15.204080937581171, 41.374300290580905, 17.77299790023057, 11.969816621298586, 61.54091242152943, 43.24230028277805, 7.943761265084327, 34.11312214952752, 34.02174803302458, 30.27123175396678, 40.31291806593366, 40.5650686183382, 1.4373112214617905, 44.70852399126967, 25.348804107320284, 13.195411746191109, 41.55291081572308, 15.374217639793532, 24.380416091565806, 20.585193039793992, 25.0196536527478, 9.34679874056542, 14.4172424700415, 35.9018647673863, 5.193970522425994, 29.389177098222603, 42.1622837355019, 9.005663387455282, 24.880085311483253, 26.278899515579553, 4.303041279917952, 37.88330588166209, 2.279595219003319, 11.889179995577283, 31.655541111544366, 42.29798945924293, 36.45065131020516, 12.29609501745944, 9.573900351360058, 31.736818447065232, 22.424127904441455, 13.147676486428725, 27.811782586864606, 20.757500856363563, 17.427785335220356, 12.648306022026048, 6.859309896714833, 25.157224221199833, 33.31184748776903, 14.589730346543035, 5.379160019325461, 8.605395053409799, 11.297826943194856, 11.457037512680387, 39.464170100515624, 12.283707723392887, 32.25536838050367, 28.919008275448228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28480278097195905, "mean_inference_ms": 0.9500005931202757, "mean_action_processing_ms": 0.12623360526094496, "mean_env_wait_ms": 0.067266189988568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026450157165527344, "StateBufferConnector_ms": 0.0038603544235229492, "ViewRequirementAgentConnector_ms": 0.05181896686553955}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 749.8151519615344, "num_env_steps_trained_throughput_per_sec": 749.8151519615344, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 5555.717, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5555.682, "sample_time_ms": 644.368, "learn_time_ms": 4897.497, "learn_throughput": 816.744, "synch_weights_time_ms": 13.388}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 102, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-04-10", "timestamp": 1723395850, "time_this_iter_s": 5.339770078659058, "time_total_s": 567.3727188110352, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f22700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 567.3727188110352, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 34.925, "ram_util_percent": 83.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0988198519063492, "cur_kl_coeff": 3.388131789017202e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06210804482834646, "policy_loss": -0.0017400855922460323, "vf_loss": 0.06384813061449676, "vf_explained_var": 0.9937656035646796, "kl": 0.0015489800837808394, "entropy": 0.10749910696855901, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 98400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9156362297789504, "cur_kl_coeff": 2.980232238769532e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05454043523404835, "policy_loss": -0.004706131955269181, "vf_loss": 0.059246566951818146, "vf_explained_var": 0.9943400578573346, "kl": 0.005367725976396002, "entropy": 0.3057892456961175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 98400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -61.54091242152943, "predator_policy": 0.546592348012364}, "policy_reward_max": {"prey_policy": -0.546592348012364, "predator_policy": 61.54091242152943}, "policy_reward_mean": {"prey_policy": -22.294518897365855, "predator_policy": 22.294518897365855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-15.114914265185996, -7.525628044488657, -10.472856117319552, -18.417615871103447, -37.283091940581954, -13.429893456430364, -30.01527654977745, -29.225977645415036, -46.073147382477586, -11.474941251114046, -0.546592348012364, -38.623011774200926, -16.20362894643225, -16.601765516540883, -24.444481363737918, -5.819004498208745, -34.38757760668063, -40.888055236732995, -22.549175921384222, -12.288067658720191, -17.070112758521276, -33.165534894689124, -4.086786941593267, -32.65027811666404, -17.453939918181526, -30.267228998197726, -21.595535849064344, -21.351887792879317, -25.545249877268223, -15.059990236464394, -19.14052439337664, -30.13223623058363, -19.940992175364848, -15.204080937581171, -41.374300290580905, -17.77299790023057, -11.969816621298586, -61.54091242152943, -43.24230028277805, -7.943761265084327, -34.11312214952752, -34.02174803302458, -30.27123175396678, -40.31291806593366, -40.5650686183382, -1.4373112214617905, -44.70852399126967, -25.348804107320284, -13.195411746191109, -41.55291081572308, -15.374217639793532, -24.380416091565806, -20.585193039793992, -25.0196536527478, -9.34679874056542, -14.4172424700415, -35.9018647673863, -5.193970522425994, -29.389177098222603, -42.1622837355019, -9.005663387455282, -24.880085311483253, -26.278899515579553, -4.303041279917952, -37.88330588166209, -2.279595219003319, -11.889179995577283, -31.655541111544366, -42.29798945924293, -36.45065131020516, -12.29609501745944, -9.573900351360058, -31.736818447065232, -22.424127904441455, -13.147676486428725, -27.811782586864606, -20.757500856363563, -17.427785335220356, -12.648306022026048, -6.859309896714833, -25.157224221199833, -33.31184748776903, -14.589730346543035, -5.379160019325461, -8.605395053409799, -11.297826943194856, -11.457037512680387, -39.464170100515624, -12.283707723392887, -32.25536838050367, -28.919008275448228, -40.18682236764617, -17.870636318860118, -20.583981077899313, -12.950243112729364, -9.383612507268241, -20.043819085749746, -2.4593275769119955, -1.445524730207623, -35.009151962436675], "policy_predator_policy_reward": [15.114914265185996, 7.525628044488657, 10.472856117319552, 18.417615871103447, 37.283091940581954, 13.429893456430364, 30.01527654977745, 29.225977645415036, 46.073147382477586, 11.474941251114046, 0.546592348012364, 38.623011774200926, 16.20362894643225, 16.601765516540883, 24.444481363737918, 5.819004498208745, 34.38757760668063, 40.888055236732995, 22.549175921384222, 12.288067658720191, 17.070112758521276, 33.165534894689124, 4.086786941593267, 32.65027811666404, 17.453939918181526, 30.267228998197726, 21.595535849064344, 21.351887792879317, 25.545249877268223, 15.059990236464394, 19.14052439337664, 30.13223623058363, 19.940992175364848, 15.204080937581171, 41.374300290580905, 17.77299790023057, 11.969816621298586, 61.54091242152943, 43.24230028277805, 7.943761265084327, 34.11312214952752, 34.02174803302458, 30.27123175396678, 40.31291806593366, 40.5650686183382, 1.4373112214617905, 44.70852399126967, 25.348804107320284, 13.195411746191109, 41.55291081572308, 15.374217639793532, 24.380416091565806, 20.585193039793992, 25.0196536527478, 9.34679874056542, 14.4172424700415, 35.9018647673863, 5.193970522425994, 29.389177098222603, 42.1622837355019, 9.005663387455282, 24.880085311483253, 26.278899515579553, 4.303041279917952, 37.88330588166209, 2.279595219003319, 11.889179995577283, 31.655541111544366, 42.29798945924293, 36.45065131020516, 12.29609501745944, 9.573900351360058, 31.736818447065232, 22.424127904441455, 13.147676486428725, 27.811782586864606, 20.757500856363563, 17.427785335220356, 12.648306022026048, 6.859309896714833, 25.157224221199833, 33.31184748776903, 14.589730346543035, 5.379160019325461, 8.605395053409799, 11.297826943194856, 11.457037512680387, 39.464170100515624, 12.283707723392887, 32.25536838050367, 28.919008275448228, 40.18682236764617, 17.870636318860118, 20.583981077899313, 12.950243112729364, 9.383612507268241, 20.043819085749746, 2.4593275769119955, 1.445524730207623, 35.009151962436675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28467994416807874, "mean_inference_ms": 0.9495313661628714, "mean_action_processing_ms": 0.1262149276456509, "mean_env_wait_ms": 0.06722034974717761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026209354400634766, "StateBufferConnector_ms": 0.003863811492919922, "ViewRequirementAgentConnector_ms": 0.05134618282318115}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 722.3016780672649, "num_env_steps_trained_throughput_per_sec": 722.3016780672649, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 824000, "timers": {"training_iteration_time_ms": 5571.608, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5571.574, "sample_time_ms": 647.538, "learn_time_ms": 4910.145, "learn_throughput": 814.64, "synch_weights_time_ms": 13.426}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000}, "done": false, "training_iteration": 103, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-04-15", "timestamp": 1723395855, "time_this_iter_s": 5.5417399406433105, "time_total_s": 572.9144587516785, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a785a5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 572.9144587516785, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 32.9625, "ram_util_percent": 83.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1323546517950793, "cur_kl_coeff": 1.694065894508601e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.041479267463243256, "policy_loss": -0.004731503737275489, "vf_loss": 0.04621077121313041, "vf_explained_var": 0.9976914566010237, "kl": 0.004882418469237158, "entropy": 0.11573415509580325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 99360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8949871595483273, "cur_kl_coeff": 2.980232238769532e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.045091943730403726, "policy_loss": -0.006802352418405159, "vf_loss": 0.0518942956152993, "vf_explained_var": 0.9973562987521291, "kl": 0.0031094939714195933, "entropy": 0.3467618475668132, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 99360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -61.54091242152943, "predator_policy": 0.546592348012364}, "policy_reward_max": {"prey_policy": -0.546592348012364, "predator_policy": 61.54091242152943}, "policy_reward_mean": {"prey_policy": -21.84446895730395, "predator_policy": 21.84446895730395}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-11.474941251114046, -0.546592348012364, -38.623011774200926, -16.20362894643225, -16.601765516540883, -24.444481363737918, -5.819004498208745, -34.38757760668063, -40.888055236732995, -22.549175921384222, -12.288067658720191, -17.070112758521276, -33.165534894689124, -4.086786941593267, -32.65027811666404, -17.453939918181526, -30.267228998197726, -21.595535849064344, -21.351887792879317, -25.545249877268223, -15.059990236464394, -19.14052439337664, -30.13223623058363, -19.940992175364848, -15.204080937581171, -41.374300290580905, -17.77299790023057, -11.969816621298586, -61.54091242152943, -43.24230028277805, -7.943761265084327, -34.11312214952752, -34.02174803302458, -30.27123175396678, -40.31291806593366, -40.5650686183382, -1.4373112214617905, -44.70852399126967, -25.348804107320284, -13.195411746191109, -41.55291081572308, -15.374217639793532, -24.380416091565806, -20.585193039793992, -25.0196536527478, -9.34679874056542, -14.4172424700415, -35.9018647673863, -5.193970522425994, -29.389177098222603, -42.1622837355019, -9.005663387455282, -24.880085311483253, -26.278899515579553, -4.303041279917952, -37.88330588166209, -2.279595219003319, -11.889179995577283, -31.655541111544366, -42.29798945924293, -36.45065131020516, -12.29609501745944, -9.573900351360058, -31.736818447065232, -22.424127904441455, -13.147676486428725, -27.811782586864606, -20.757500856363563, -17.427785335220356, -12.648306022026048, -6.859309896714833, -25.157224221199833, -33.31184748776903, -14.589730346543035, -5.379160019325461, -8.605395053409799, -11.297826943194856, -11.457037512680387, -39.464170100515624, -12.283707723392887, -32.25536838050367, -28.919008275448228, -40.18682236764617, -17.870636318860118, -20.583981077899313, -12.950243112729364, -9.383612507268241, -20.043819085749746, -2.4593275769119955, -1.445524730207623, -35.009151962436675, -5.976956586692161, -19.224401973543166, -24.812172417967417, -17.993423941252217, -19.882202087819984, -8.141357718329827, -33.275219462401715, -13.525382970776313, -19.722290107806604], "policy_predator_policy_reward": [11.474941251114046, 0.546592348012364, 38.623011774200926, 16.20362894643225, 16.601765516540883, 24.444481363737918, 5.819004498208745, 34.38757760668063, 40.888055236732995, 22.549175921384222, 12.288067658720191, 17.070112758521276, 33.165534894689124, 4.086786941593267, 32.65027811666404, 17.453939918181526, 30.267228998197726, 21.595535849064344, 21.351887792879317, 25.545249877268223, 15.059990236464394, 19.14052439337664, 30.13223623058363, 19.940992175364848, 15.204080937581171, 41.374300290580905, 17.77299790023057, 11.969816621298586, 61.54091242152943, 43.24230028277805, 7.943761265084327, 34.11312214952752, 34.02174803302458, 30.27123175396678, 40.31291806593366, 40.5650686183382, 1.4373112214617905, 44.70852399126967, 25.348804107320284, 13.195411746191109, 41.55291081572308, 15.374217639793532, 24.380416091565806, 20.585193039793992, 25.0196536527478, 9.34679874056542, 14.4172424700415, 35.9018647673863, 5.193970522425994, 29.389177098222603, 42.1622837355019, 9.005663387455282, 24.880085311483253, 26.278899515579553, 4.303041279917952, 37.88330588166209, 2.279595219003319, 11.889179995577283, 31.655541111544366, 42.29798945924293, 36.45065131020516, 12.29609501745944, 9.573900351360058, 31.736818447065232, 22.424127904441455, 13.147676486428725, 27.811782586864606, 20.757500856363563, 17.427785335220356, 12.648306022026048, 6.859309896714833, 25.157224221199833, 33.31184748776903, 14.589730346543035, 5.379160019325461, 8.605395053409799, 11.297826943194856, 11.457037512680387, 39.464170100515624, 12.283707723392887, 32.25536838050367, 28.919008275448228, 40.18682236764617, 17.870636318860118, 20.583981077899313, 12.950243112729364, 9.383612507268241, 20.043819085749746, 2.4593275769119955, 1.445524730207623, 35.009151962436675, 5.976956586692161, 19.224401973543166, 24.812172417967417, 17.993423941252217, 19.882202087819984, 8.141357718329827, 33.275219462401715, 13.525382970776313, 19.722290107806604]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28456456240476385, "mean_inference_ms": 0.9489998248616266, "mean_action_processing_ms": 0.12618539827149872, "mean_env_wait_ms": 0.06717058331730252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002612471580505371, "StateBufferConnector_ms": 0.0038515329360961914, "ViewRequirementAgentConnector_ms": 0.05110037326812744}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 740.1196925373189, "num_env_steps_trained_throughput_per_sec": 740.1196925373189, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 5577.943, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5577.909, "sample_time_ms": 646.147, "learn_time_ms": 4917.803, "learn_throughput": 813.371, "synch_weights_time_ms": 13.548}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 104, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-04-21", "timestamp": 1723395861, "time_this_iter_s": 5.409239053726196, "time_total_s": 578.3236978054047, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a785ae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 578.3236978054047, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 34.275, "ram_util_percent": 83.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2093314695637674, "cur_kl_coeff": 8.470329472543005e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08696554380245895, "policy_loss": -0.0005411268639970028, "vf_loss": 0.0875066711504284, "vf_explained_var": 0.99707848764956, "kl": 0.0013404012844357286, "entropy": 0.10082196949321466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 100320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0684885025567685, "cur_kl_coeff": 1.490116119384766e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08791475759862806, "policy_loss": -0.0032008602565232044, "vf_loss": 0.09111561785781912, "vf_explained_var": 0.9969497935846448, "kl": 0.0031511698309924434, "entropy": 0.3012527947779745, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 100320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -61.54091242152943, "predator_policy": 0.3593596140987896}, "policy_reward_max": {"prey_policy": -0.3593596140987896, "predator_policy": 61.54091242152943}, "policy_reward_mean": {"prey_policy": -21.82812552098311, "predator_policy": 21.82812552098311}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-22.549175921384222, -12.288067658720191, -17.070112758521276, -33.165534894689124, -4.086786941593267, -32.65027811666404, -17.453939918181526, -30.267228998197726, -21.595535849064344, -21.351887792879317, -25.545249877268223, -15.059990236464394, -19.14052439337664, -30.13223623058363, -19.940992175364848, -15.204080937581171, -41.374300290580905, -17.77299790023057, -11.969816621298586, -61.54091242152943, -43.24230028277805, -7.943761265084327, -34.11312214952752, -34.02174803302458, -30.27123175396678, -40.31291806593366, -40.5650686183382, -1.4373112214617905, -44.70852399126967, -25.348804107320284, -13.195411746191109, -41.55291081572308, -15.374217639793532, -24.380416091565806, -20.585193039793992, -25.0196536527478, -9.34679874056542, -14.4172424700415, -35.9018647673863, -5.193970522425994, -29.389177098222603, -42.1622837355019, -9.005663387455282, -24.880085311483253, -26.278899515579553, -4.303041279917952, -37.88330588166209, -2.279595219003319, -11.889179995577283, -31.655541111544366, -42.29798945924293, -36.45065131020516, -12.29609501745944, -9.573900351360058, -31.736818447065232, -22.424127904441455, -13.147676486428725, -27.811782586864606, -20.757500856363563, -17.427785335220356, -12.648306022026048, -6.859309896714833, -25.157224221199833, -33.31184748776903, -14.589730346543035, -5.379160019325461, -8.605395053409799, -11.297826943194856, -11.457037512680387, -39.464170100515624, -12.283707723392887, -32.25536838050367, -28.919008275448228, -40.18682236764617, -17.870636318860118, -20.583981077899313, -12.950243112729364, -9.383612507268241, -20.043819085749746, -2.4593275769119955, -1.445524730207623, -35.009151962436675, -5.976956586692161, -19.224401973543166, -24.812172417967417, -17.993423941252217, -19.882202087819984, -8.141357718329827, -33.275219462401715, -13.525382970776313, -19.722290107806604, -17.56309246179246, -29.997859336193525, -20.7929394050566, -45.651144050618115, -29.184030297437666, -24.970830243337545, -0.47070619438059613, -18.364753306662543, -0.3593596140987896], "policy_predator_policy_reward": [22.549175921384222, 12.288067658720191, 17.070112758521276, 33.165534894689124, 4.086786941593267, 32.65027811666404, 17.453939918181526, 30.267228998197726, 21.595535849064344, 21.351887792879317, 25.545249877268223, 15.059990236464394, 19.14052439337664, 30.13223623058363, 19.940992175364848, 15.204080937581171, 41.374300290580905, 17.77299790023057, 11.969816621298586, 61.54091242152943, 43.24230028277805, 7.943761265084327, 34.11312214952752, 34.02174803302458, 30.27123175396678, 40.31291806593366, 40.5650686183382, 1.4373112214617905, 44.70852399126967, 25.348804107320284, 13.195411746191109, 41.55291081572308, 15.374217639793532, 24.380416091565806, 20.585193039793992, 25.0196536527478, 9.34679874056542, 14.4172424700415, 35.9018647673863, 5.193970522425994, 29.389177098222603, 42.1622837355019, 9.005663387455282, 24.880085311483253, 26.278899515579553, 4.303041279917952, 37.88330588166209, 2.279595219003319, 11.889179995577283, 31.655541111544366, 42.29798945924293, 36.45065131020516, 12.29609501745944, 9.573900351360058, 31.736818447065232, 22.424127904441455, 13.147676486428725, 27.811782586864606, 20.757500856363563, 17.427785335220356, 12.648306022026048, 6.859309896714833, 25.157224221199833, 33.31184748776903, 14.589730346543035, 5.379160019325461, 8.605395053409799, 11.297826943194856, 11.457037512680387, 39.464170100515624, 12.283707723392887, 32.25536838050367, 28.919008275448228, 40.18682236764617, 17.870636318860118, 20.583981077899313, 12.950243112729364, 9.383612507268241, 20.043819085749746, 2.4593275769119955, 1.445524730207623, 35.009151962436675, 5.976956586692161, 19.224401973543166, 24.812172417967417, 17.993423941252217, 19.882202087819984, 8.141357718329827, 33.275219462401715, 13.525382970776313, 19.722290107806604, 17.56309246179246, 29.997859336193525, 20.7929394050566, 45.651144050618115, 29.184030297437666, 24.970830243337545, 0.47070619438059613, 18.364753306662543, 0.3593596140987896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28444419583961156, "mean_inference_ms": 0.9484294315286267, "mean_action_processing_ms": 0.1261490952446315, "mean_env_wait_ms": 0.06711703001464625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002606034278869629, "StateBufferConnector_ms": 0.0038683414459228516, "ViewRequirementAgentConnector_ms": 0.05127310752868652}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 742.198762843983, "num_env_steps_trained_throughput_per_sec": 742.198762843983, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 5543.552, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5543.519, "sample_time_ms": 641.325, "learn_time_ms": 4888.488, "learn_throughput": 818.249, "synch_weights_time_ms": 13.299}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 105, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-04-26", "timestamp": 1723395866, "time_this_iter_s": 5.396009922027588, "time_total_s": 583.7197077274323, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 583.7197077274323, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 35.65714285714286, "ram_util_percent": 82.78571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0557444128983964, "cur_kl_coeff": 4.2351647362715025e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08758900235407055, "policy_loss": -0.0025029715601704084, "vf_loss": 0.09009197330645596, "vf_explained_var": 0.9956696586062511, "kl": 0.0016809659304698559, "entropy": 0.0908696307897723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 101280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0930964244374384, "cur_kl_coeff": 7.45058059692383e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09549173466584857, "policy_loss": -0.004820732474278581, "vf_loss": 0.10031246646637253, "vf_explained_var": 0.9946945015961925, "kl": 0.0017598329149160856, "entropy": 0.3045178513042629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 101280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -61.54091242152943, "predator_policy": 0.3593596140987896}, "policy_reward_max": {"prey_policy": -0.3593596140987896, "predator_policy": 61.54091242152943}, "policy_reward_mean": {"prey_policy": -22.12974958377235, "predator_policy": 22.12974958377235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-21.351887792879317, -25.545249877268223, -15.059990236464394, -19.14052439337664, -30.13223623058363, -19.940992175364848, -15.204080937581171, -41.374300290580905, -17.77299790023057, -11.969816621298586, -61.54091242152943, -43.24230028277805, -7.943761265084327, -34.11312214952752, -34.02174803302458, -30.27123175396678, -40.31291806593366, -40.5650686183382, -1.4373112214617905, -44.70852399126967, -25.348804107320284, -13.195411746191109, -41.55291081572308, -15.374217639793532, -24.380416091565806, -20.585193039793992, -25.0196536527478, -9.34679874056542, -14.4172424700415, -35.9018647673863, -5.193970522425994, -29.389177098222603, -42.1622837355019, -9.005663387455282, -24.880085311483253, -26.278899515579553, -4.303041279917952, -37.88330588166209, -2.279595219003319, -11.889179995577283, -31.655541111544366, -42.29798945924293, -36.45065131020516, -12.29609501745944, -9.573900351360058, -31.736818447065232, -22.424127904441455, -13.147676486428725, -27.811782586864606, -20.757500856363563, -17.427785335220356, -12.648306022026048, -6.859309896714833, -25.157224221199833, -33.31184748776903, -14.589730346543035, -5.379160019325461, -8.605395053409799, -11.297826943194856, -11.457037512680387, -39.464170100515624, -12.283707723392887, -32.25536838050367, -28.919008275448228, -40.18682236764617, -17.870636318860118, -20.583981077899313, -12.950243112729364, -9.383612507268241, -20.043819085749746, -2.4593275769119955, -1.445524730207623, -35.009151962436675, -5.976956586692161, -19.224401973543166, -24.812172417967417, -17.993423941252217, -19.882202087819984, -8.141357718329827, -33.275219462401715, -13.525382970776313, -19.722290107806604, -17.56309246179246, -29.997859336193525, -20.7929394050566, -45.651144050618115, -29.184030297437666, -24.970830243337545, -0.47070619438059613, -18.364753306662543, -0.3593596140987896, -1.3977554313871599, -29.443818787248407, -44.013021152374925, -35.12186909312147, -2.9081155866903554, -43.166995150904775, -23.6498530341338, -0.8321941751081363, -40.75544492496922], "policy_predator_policy_reward": [21.351887792879317, 25.545249877268223, 15.059990236464394, 19.14052439337664, 30.13223623058363, 19.940992175364848, 15.204080937581171, 41.374300290580905, 17.77299790023057, 11.969816621298586, 61.54091242152943, 43.24230028277805, 7.943761265084327, 34.11312214952752, 34.02174803302458, 30.27123175396678, 40.31291806593366, 40.5650686183382, 1.4373112214617905, 44.70852399126967, 25.348804107320284, 13.195411746191109, 41.55291081572308, 15.374217639793532, 24.380416091565806, 20.585193039793992, 25.0196536527478, 9.34679874056542, 14.4172424700415, 35.9018647673863, 5.193970522425994, 29.389177098222603, 42.1622837355019, 9.005663387455282, 24.880085311483253, 26.278899515579553, 4.303041279917952, 37.88330588166209, 2.279595219003319, 11.889179995577283, 31.655541111544366, 42.29798945924293, 36.45065131020516, 12.29609501745944, 9.573900351360058, 31.736818447065232, 22.424127904441455, 13.147676486428725, 27.811782586864606, 20.757500856363563, 17.427785335220356, 12.648306022026048, 6.859309896714833, 25.157224221199833, 33.31184748776903, 14.589730346543035, 5.379160019325461, 8.605395053409799, 11.297826943194856, 11.457037512680387, 39.464170100515624, 12.283707723392887, 32.25536838050367, 28.919008275448228, 40.18682236764617, 17.870636318860118, 20.583981077899313, 12.950243112729364, 9.383612507268241, 20.043819085749746, 2.4593275769119955, 1.445524730207623, 35.009151962436675, 5.976956586692161, 19.224401973543166, 24.812172417967417, 17.993423941252217, 19.882202087819984, 8.141357718329827, 33.275219462401715, 13.525382970776313, 19.722290107806604, 17.56309246179246, 29.997859336193525, 20.7929394050566, 45.651144050618115, 29.184030297437666, 24.970830243337545, 0.47070619438059613, 18.364753306662543, 0.3593596140987896, 1.3977554313871599, 29.443818787248407, 44.013021152374925, 35.12186909312147, 2.9081155866903554, 43.166995150904775, 23.6498530341338, 0.8321941751081363, 40.75544492496922]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28444615251184463, "mean_inference_ms": 0.9482425059946767, "mean_action_processing_ms": 0.12615881949186636, "mean_env_wait_ms": 0.06709282791820277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032334327697753906, "StateBufferConnector_ms": 0.0041130781173706055, "ViewRequirementAgentConnector_ms": 0.06548714637756348}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 684.1588936024484, "num_env_steps_trained_throughput_per_sec": 684.1588936024484, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 5568.689, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5568.657, "sample_time_ms": 674.369, "learn_time_ms": 4880.906, "learn_throughput": 819.52, "synch_weights_time_ms": 13.026}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 106, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-04-32", "timestamp": 1723395872, "time_this_iter_s": 5.85208797454834, "time_total_s": 589.5717957019806, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2df70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 589.5717957019806, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 37.675, "ram_util_percent": 82.4125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7841542717069387, "cur_kl_coeff": 2.1175823681357513e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06527737164239321, "policy_loss": -0.0001827686261094641, "vf_loss": 0.06546014051321739, "vf_explained_var": 0.9924582020690044, "kl": 0.0006990666742449525, "entropy": 0.0894493472451965, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 102240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6660122857661918, "cur_kl_coeff": 3.725290298461915e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04293585660076739, "policy_loss": -0.010272833859441258, "vf_loss": 0.05320869092150436, "vf_explained_var": 0.994225601417323, "kl": 0.006155856337891952, "entropy": 0.2870654891555508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 102240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -61.54091242152943, "predator_policy": 0.3593596140987896}, "policy_reward_max": {"prey_policy": -0.3593596140987896, "predator_policy": 61.54091242152943}, "policy_reward_mean": {"prey_policy": -22.141300016189476, "predator_policy": 22.141300016189476}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-11.969816621298586, -61.54091242152943, -43.24230028277805, -7.943761265084327, -34.11312214952752, -34.02174803302458, -30.27123175396678, -40.31291806593366, -40.5650686183382, -1.4373112214617905, -44.70852399126967, -25.348804107320284, -13.195411746191109, -41.55291081572308, -15.374217639793532, -24.380416091565806, -20.585193039793992, -25.0196536527478, -9.34679874056542, -14.4172424700415, -35.9018647673863, -5.193970522425994, -29.389177098222603, -42.1622837355019, -9.005663387455282, -24.880085311483253, -26.278899515579553, -4.303041279917952, -37.88330588166209, -2.279595219003319, -11.889179995577283, -31.655541111544366, -42.29798945924293, -36.45065131020516, -12.29609501745944, -9.573900351360058, -31.736818447065232, -22.424127904441455, -13.147676486428725, -27.811782586864606, -20.757500856363563, -17.427785335220356, -12.648306022026048, -6.859309896714833, -25.157224221199833, -33.31184748776903, -14.589730346543035, -5.379160019325461, -8.605395053409799, -11.297826943194856, -11.457037512680387, -39.464170100515624, -12.283707723392887, -32.25536838050367, -28.919008275448228, -40.18682236764617, -17.870636318860118, -20.583981077899313, -12.950243112729364, -9.383612507268241, -20.043819085749746, -2.4593275769119955, -1.445524730207623, -35.009151962436675, -5.976956586692161, -19.224401973543166, -24.812172417967417, -17.993423941252217, -19.882202087819984, -8.141357718329827, -33.275219462401715, -13.525382970776313, -19.722290107806604, -17.56309246179246, -29.997859336193525, -20.7929394050566, -45.651144050618115, -29.184030297437666, -24.970830243337545, -0.47070619438059613, -18.364753306662543, -0.3593596140987896, -1.3977554313871599, -29.443818787248407, -44.013021152374925, -35.12186909312147, -2.9081155866903554, -43.166995150904775, -23.6498530341338, -0.8321941751081363, -40.75544492496922, -11.300431638158573, -28.21641674600579, -6.931296914485048, -36.308108178636544, -35.929567051278674, -4.22469500651078, -25.386182817640034, -44.92892602646517, -13.451678696861977], "policy_predator_policy_reward": [11.969816621298586, 61.54091242152943, 43.24230028277805, 7.943761265084327, 34.11312214952752, 34.02174803302458, 30.27123175396678, 40.31291806593366, 40.5650686183382, 1.4373112214617905, 44.70852399126967, 25.348804107320284, 13.195411746191109, 41.55291081572308, 15.374217639793532, 24.380416091565806, 20.585193039793992, 25.0196536527478, 9.34679874056542, 14.4172424700415, 35.9018647673863, 5.193970522425994, 29.389177098222603, 42.1622837355019, 9.005663387455282, 24.880085311483253, 26.278899515579553, 4.303041279917952, 37.88330588166209, 2.279595219003319, 11.889179995577283, 31.655541111544366, 42.29798945924293, 36.45065131020516, 12.29609501745944, 9.573900351360058, 31.736818447065232, 22.424127904441455, 13.147676486428725, 27.811782586864606, 20.757500856363563, 17.427785335220356, 12.648306022026048, 6.859309896714833, 25.157224221199833, 33.31184748776903, 14.589730346543035, 5.379160019325461, 8.605395053409799, 11.297826943194856, 11.457037512680387, 39.464170100515624, 12.283707723392887, 32.25536838050367, 28.919008275448228, 40.18682236764617, 17.870636318860118, 20.583981077899313, 12.950243112729364, 9.383612507268241, 20.043819085749746, 2.4593275769119955, 1.445524730207623, 35.009151962436675, 5.976956586692161, 19.224401973543166, 24.812172417967417, 17.993423941252217, 19.882202087819984, 8.141357718329827, 33.275219462401715, 13.525382970776313, 19.722290107806604, 17.56309246179246, 29.997859336193525, 20.7929394050566, 45.651144050618115, 29.184030297437666, 24.970830243337545, 0.47070619438059613, 18.364753306662543, 0.3593596140987896, 1.3977554313871599, 29.443818787248407, 44.013021152374925, 35.12186909312147, 2.9081155866903554, 43.166995150904775, 23.6498530341338, 0.8321941751081363, 40.75544492496922, 11.300431638158573, 28.21641674600579, 6.931296914485048, 36.308108178636544, 35.929567051278674, 4.22469500651078, 25.386182817640034, 44.92892602646517, 13.451678696861977]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.284446431077892, "mean_inference_ms": 0.9480466092812493, "mean_action_processing_ms": 0.12616170829055862, "mean_env_wait_ms": 0.06707247697619287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032243728637695312, "StateBufferConnector_ms": 0.004102826118469238, "ViewRequirementAgentConnector_ms": 0.06514942646026611}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 744.2825797441692, "num_env_steps_trained_throughput_per_sec": 744.2825797441692, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 856000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 856000, "timers": {"training_iteration_time_ms": 5536.35, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5536.318, "sample_time_ms": 673.502, "learn_time_ms": 4849.42, "learn_throughput": 824.841, "synch_weights_time_ms": 13.048}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000}, "done": false, "training_iteration": 107, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-04-37", "timestamp": 1723395877, "time_this_iter_s": 5.379184007644653, "time_total_s": 594.9509797096252, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9ed1160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 594.9509797096252, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 36.3, "ram_util_percent": 82.9625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4718448413846394, "cur_kl_coeff": 1.0587911840678756e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.14091050901382307, "policy_loss": -0.0009621836497293164, "vf_loss": 0.1418726925534429, "vf_explained_var": 0.9950104776148995, "kl": 0.002036098458762859, "entropy": 0.11400468402037707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 103200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3673990483395755, "cur_kl_coeff": 3.725290298461915e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.15344682615468627, "policy_loss": -0.001462412365557005, "vf_loss": 0.1549092384792554, "vf_explained_var": 0.994192473590374, "kl": 0.002067642865844218, "entropy": 0.27986434660851955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 103200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -47.146867912659985, "predator_policy": 0.3593596140987896}, "policy_reward_max": {"prey_policy": -0.3593596140987896, "predator_policy": 47.146867912659985}, "policy_reward_mean": {"prey_policy": -21.76722033671635, "predator_policy": 21.76722033671635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-34.11312214952752, -34.02174803302458, -30.27123175396678, -40.31291806593366, -40.5650686183382, -1.4373112214617905, -44.70852399126967, -25.348804107320284, -13.195411746191109, -41.55291081572308, -15.374217639793532, -24.380416091565806, -20.585193039793992, -25.0196536527478, -9.34679874056542, -14.4172424700415, -35.9018647673863, -5.193970522425994, -29.389177098222603, -42.1622837355019, -9.005663387455282, -24.880085311483253, -26.278899515579553, -4.303041279917952, -37.88330588166209, -2.279595219003319, -11.889179995577283, -31.655541111544366, -42.29798945924293, -36.45065131020516, -12.29609501745944, -9.573900351360058, -31.736818447065232, -22.424127904441455, -13.147676486428725, -27.811782586864606, -20.757500856363563, -17.427785335220356, -12.648306022026048, -6.859309896714833, -25.157224221199833, -33.31184748776903, -14.589730346543035, -5.379160019325461, -8.605395053409799, -11.297826943194856, -11.457037512680387, -39.464170100515624, -12.283707723392887, -32.25536838050367, -28.919008275448228, -40.18682236764617, -17.870636318860118, -20.583981077899313, -12.950243112729364, -9.383612507268241, -20.043819085749746, -2.4593275769119955, -1.445524730207623, -35.009151962436675, -5.976956586692161, -19.224401973543166, -24.812172417967417, -17.993423941252217, -19.882202087819984, -8.141357718329827, -33.275219462401715, -13.525382970776313, -19.722290107806604, -17.56309246179246, -29.997859336193525, -20.7929394050566, -45.651144050618115, -29.184030297437666, -24.970830243337545, -0.47070619438059613, -18.364753306662543, -0.3593596140987896, -1.3977554313871599, -29.443818787248407, -44.013021152374925, -35.12186909312147, -2.9081155866903554, -43.166995150904775, -23.6498530341338, -0.8321941751081363, -40.75544492496922, -11.300431638158573, -28.21641674600579, -6.931296914485048, -36.308108178636544, -35.929567051278674, -4.22469500651078, -25.386182817640034, -44.92892602646517, -13.451678696861977, -15.01138367325926, -6.373646649072337, -18.756924408385895, -47.146867912659985], "policy_predator_policy_reward": [34.11312214952752, 34.02174803302458, 30.27123175396678, 40.31291806593366, 40.5650686183382, 1.4373112214617905, 44.70852399126967, 25.348804107320284, 13.195411746191109, 41.55291081572308, 15.374217639793532, 24.380416091565806, 20.585193039793992, 25.0196536527478, 9.34679874056542, 14.4172424700415, 35.9018647673863, 5.193970522425994, 29.389177098222603, 42.1622837355019, 9.005663387455282, 24.880085311483253, 26.278899515579553, 4.303041279917952, 37.88330588166209, 2.279595219003319, 11.889179995577283, 31.655541111544366, 42.29798945924293, 36.45065131020516, 12.29609501745944, 9.573900351360058, 31.736818447065232, 22.424127904441455, 13.147676486428725, 27.811782586864606, 20.757500856363563, 17.427785335220356, 12.648306022026048, 6.859309896714833, 25.157224221199833, 33.31184748776903, 14.589730346543035, 5.379160019325461, 8.605395053409799, 11.297826943194856, 11.457037512680387, 39.464170100515624, 12.283707723392887, 32.25536838050367, 28.919008275448228, 40.18682236764617, 17.870636318860118, 20.583981077899313, 12.950243112729364, 9.383612507268241, 20.043819085749746, 2.4593275769119955, 1.445524730207623, 35.009151962436675, 5.976956586692161, 19.224401973543166, 24.812172417967417, 17.993423941252217, 19.882202087819984, 8.141357718329827, 33.275219462401715, 13.525382970776313, 19.722290107806604, 17.56309246179246, 29.997859336193525, 20.7929394050566, 45.651144050618115, 29.184030297437666, 24.970830243337545, 0.47070619438059613, 18.364753306662543, 0.3593596140987896, 1.3977554313871599, 29.443818787248407, 44.013021152374925, 35.12186909312147, 2.9081155866903554, 43.166995150904775, 23.6498530341338, 0.8321941751081363, 40.75544492496922, 11.300431638158573, 28.21641674600579, 6.931296914485048, 36.308108178636544, 35.929567051278674, 4.22469500651078, 25.386182817640034, 44.92892602646517, 13.451678696861977, 15.01138367325926, 6.373646649072337, 18.756924408385895, 47.146867912659985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2843704144591967, "mean_inference_ms": 0.9478799902944143, "mean_action_processing_ms": 0.12612616969201898, "mean_env_wait_ms": 0.06705026018772352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032438039779663086, "StateBufferConnector_ms": 0.004122734069824219, "ViewRequirementAgentConnector_ms": 0.0656517744064331}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 732.0371449636104, "num_env_steps_trained_throughput_per_sec": 732.0371449636104, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 5546.233, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5546.201, "sample_time_ms": 675.278, "learn_time_ms": 4857.642, "learn_throughput": 823.445, "synch_weights_time_ms": 12.935}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 108, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-04-43", "timestamp": 1723395883, "time_this_iter_s": 5.467928886413574, "time_total_s": 600.4189085960388, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a785a5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 600.4189085960388, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 31.9875, "ram_util_percent": 83.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9554839535461118, "cur_kl_coeff": 5.293955920339378e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.038078300059229755, "policy_loss": -0.0010828240112459753, "vf_loss": 0.03916112404161443, "vf_explained_var": 0.9965042828892668, "kl": 0.0018642667374294745, "entropy": 0.08304654205179153, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 104160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8398048820594947, "cur_kl_coeff": 1.8626451492309574e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.02508155272953445, "policy_loss": -0.014465509883787793, "vf_loss": 0.039547063088199746, "vf_explained_var": 0.996266847414275, "kl": 0.004542191598663144, "entropy": 0.2829419781919569, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 104160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -47.146867912659985, "predator_policy": 0.3593596140987896}, "policy_reward_max": {"prey_policy": -0.3593596140987896, "predator_policy": 47.146867912659985}, "policy_reward_mean": {"prey_policy": -22.092376267499226, "predator_policy": 22.092376267499226}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-41.55291081572308, -15.374217639793532, -24.380416091565806, -20.585193039793992, -25.0196536527478, -9.34679874056542, -14.4172424700415, -35.9018647673863, -5.193970522425994, -29.389177098222603, -42.1622837355019, -9.005663387455282, -24.880085311483253, -26.278899515579553, -4.303041279917952, -37.88330588166209, -2.279595219003319, -11.889179995577283, -31.655541111544366, -42.29798945924293, -36.45065131020516, -12.29609501745944, -9.573900351360058, -31.736818447065232, -22.424127904441455, -13.147676486428725, -27.811782586864606, -20.757500856363563, -17.427785335220356, -12.648306022026048, -6.859309896714833, -25.157224221199833, -33.31184748776903, -14.589730346543035, -5.379160019325461, -8.605395053409799, -11.297826943194856, -11.457037512680387, -39.464170100515624, -12.283707723392887, -32.25536838050367, -28.919008275448228, -40.18682236764617, -17.870636318860118, -20.583981077899313, -12.950243112729364, -9.383612507268241, -20.043819085749746, -2.4593275769119955, -1.445524730207623, -35.009151962436675, -5.976956586692161, -19.224401973543166, -24.812172417967417, -17.993423941252217, -19.882202087819984, -8.141357718329827, -33.275219462401715, -13.525382970776313, -19.722290107806604, -17.56309246179246, -29.997859336193525, -20.7929394050566, -45.651144050618115, -29.184030297437666, -24.970830243337545, -0.47070619438059613, -18.364753306662543, -0.3593596140987896, -1.3977554313871599, -29.443818787248407, -44.013021152374925, -35.12186909312147, -2.9081155866903554, -43.166995150904775, -23.6498530341338, -0.8321941751081363, -40.75544492496922, -11.300431638158573, -28.21641674600579, -6.931296914485048, -36.308108178636544, -35.929567051278674, -4.22469500651078, -25.386182817640034, -44.92892602646517, -13.451678696861977, -15.01138367325926, -6.373646649072337, -18.756924408385895, -47.146867912659985, -44.47328820251645, -45.60970419543772, -23.614129803134347, -18.057797569896174, -41.778885618678075, -27.94379126029493, -38.66120687437668, -26.211369552899445, -30.139559688087758], "policy_predator_policy_reward": [41.55291081572308, 15.374217639793532, 24.380416091565806, 20.585193039793992, 25.0196536527478, 9.34679874056542, 14.4172424700415, 35.9018647673863, 5.193970522425994, 29.389177098222603, 42.1622837355019, 9.005663387455282, 24.880085311483253, 26.278899515579553, 4.303041279917952, 37.88330588166209, 2.279595219003319, 11.889179995577283, 31.655541111544366, 42.29798945924293, 36.45065131020516, 12.29609501745944, 9.573900351360058, 31.736818447065232, 22.424127904441455, 13.147676486428725, 27.811782586864606, 20.757500856363563, 17.427785335220356, 12.648306022026048, 6.859309896714833, 25.157224221199833, 33.31184748776903, 14.589730346543035, 5.379160019325461, 8.605395053409799, 11.297826943194856, 11.457037512680387, 39.464170100515624, 12.283707723392887, 32.25536838050367, 28.919008275448228, 40.18682236764617, 17.870636318860118, 20.583981077899313, 12.950243112729364, 9.383612507268241, 20.043819085749746, 2.4593275769119955, 1.445524730207623, 35.009151962436675, 5.976956586692161, 19.224401973543166, 24.812172417967417, 17.993423941252217, 19.882202087819984, 8.141357718329827, 33.275219462401715, 13.525382970776313, 19.722290107806604, 17.56309246179246, 29.997859336193525, 20.7929394050566, 45.651144050618115, 29.184030297437666, 24.970830243337545, 0.47070619438059613, 18.364753306662543, 0.3593596140987896, 1.3977554313871599, 29.443818787248407, 44.013021152374925, 35.12186909312147, 2.9081155866903554, 43.166995150904775, 23.6498530341338, 0.8321941751081363, 40.75544492496922, 11.300431638158573, 28.21641674600579, 6.931296914485048, 36.308108178636544, 35.929567051278674, 4.22469500651078, 25.386182817640034, 44.92892602646517, 13.451678696861977, 15.01138367325926, 6.373646649072337, 18.756924408385895, 47.146867912659985, 44.47328820251645, 45.60970419543772, 23.614129803134347, 18.057797569896174, 41.778885618678075, 27.94379126029493, 38.66120687437668, 26.211369552899445, 30.139559688087758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28434967487498314, "mean_inference_ms": 0.9476761030549937, "mean_action_processing_ms": 0.1261300467790305, "mean_env_wait_ms": 0.06702832038399696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032361745834350586, "StateBufferConnector_ms": 0.004123091697692871, "ViewRequirementAgentConnector_ms": 0.06590414047241211}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 764.1418972783699, "num_env_steps_trained_throughput_per_sec": 764.1418972783699, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 872000, "timers": {"training_iteration_time_ms": 5517.958, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5517.926, "sample_time_ms": 676.571, "learn_time_ms": 4828.329, "learn_throughput": 828.444, "synch_weights_time_ms": 12.674}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000}, "done": false, "training_iteration": 109, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-04-48", "timestamp": 1723395888, "time_this_iter_s": 5.238326072692871, "time_total_s": 605.6572346687317, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7865dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 605.6572346687317, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 35.2, "ram_util_percent": 83.04285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1800370912067593, "cur_kl_coeff": 2.646977960169689e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06706257570767775, "policy_loss": 0.0020163931769881555, "vf_loss": 0.06504618257846838, "vf_explained_var": 0.9969487932821115, "kl": 0.001244481893243273, "entropy": 0.0850705081926814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 105120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0217971308622509, "cur_kl_coeff": 9.313225746154787e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.060801021605342, "policy_loss": -0.004469285741288331, "vf_loss": 0.06527030733365488, "vf_explained_var": 0.9969302948564291, "kl": 0.0029527950384331805, "entropy": 0.25960771439907454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 105120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -47.146867912659985, "predator_policy": 0.3593596140987896}, "policy_reward_max": {"prey_policy": -0.3593596140987896, "predator_policy": 47.146867912659985}, "policy_reward_mean": {"prey_policy": -22.160454693872236, "predator_policy": 22.160454693872236}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-9.34679874056542, -14.4172424700415, -35.9018647673863, -5.193970522425994, -29.389177098222603, -42.1622837355019, -9.005663387455282, -24.880085311483253, -26.278899515579553, -4.303041279917952, -37.88330588166209, -2.279595219003319, -11.889179995577283, -31.655541111544366, -42.29798945924293, -36.45065131020516, -12.29609501745944, -9.573900351360058, -31.736818447065232, -22.424127904441455, -13.147676486428725, -27.811782586864606, -20.757500856363563, -17.427785335220356, -12.648306022026048, -6.859309896714833, -25.157224221199833, -33.31184748776903, -14.589730346543035, -5.379160019325461, -8.605395053409799, -11.297826943194856, -11.457037512680387, -39.464170100515624, -12.283707723392887, -32.25536838050367, -28.919008275448228, -40.18682236764617, -17.870636318860118, -20.583981077899313, -12.950243112729364, -9.383612507268241, -20.043819085749746, -2.4593275769119955, -1.445524730207623, -35.009151962436675, -5.976956586692161, -19.224401973543166, -24.812172417967417, -17.993423941252217, -19.882202087819984, -8.141357718329827, -33.275219462401715, -13.525382970776313, -19.722290107806604, -17.56309246179246, -29.997859336193525, -20.7929394050566, -45.651144050618115, -29.184030297437666, -24.970830243337545, -0.47070619438059613, -18.364753306662543, -0.3593596140987896, -1.3977554313871599, -29.443818787248407, -44.013021152374925, -35.12186909312147, -2.9081155866903554, -43.166995150904775, -23.6498530341338, -0.8321941751081363, -40.75544492496922, -11.300431638158573, -28.21641674600579, -6.931296914485048, -36.308108178636544, -35.929567051278674, -4.22469500651078, -25.386182817640034, -44.92892602646517, -13.451678696861977, -15.01138367325926, -6.373646649072337, -18.756924408385895, -47.146867912659985, -44.47328820251645, -45.60970419543772, -23.614129803134347, -18.057797569896174, -41.778885618678075, -27.94379126029493, -38.66120687437668, -26.211369552899445, -30.139559688087758, -36.23996286175875, -11.894087214598233, -33.74606819957853, -23.8863325817875, -27.953783019201936], "policy_predator_policy_reward": [9.34679874056542, 14.4172424700415, 35.9018647673863, 5.193970522425994, 29.389177098222603, 42.1622837355019, 9.005663387455282, 24.880085311483253, 26.278899515579553, 4.303041279917952, 37.88330588166209, 2.279595219003319, 11.889179995577283, 31.655541111544366, 42.29798945924293, 36.45065131020516, 12.29609501745944, 9.573900351360058, 31.736818447065232, 22.424127904441455, 13.147676486428725, 27.811782586864606, 20.757500856363563, 17.427785335220356, 12.648306022026048, 6.859309896714833, 25.157224221199833, 33.31184748776903, 14.589730346543035, 5.379160019325461, 8.605395053409799, 11.297826943194856, 11.457037512680387, 39.464170100515624, 12.283707723392887, 32.25536838050367, 28.919008275448228, 40.18682236764617, 17.870636318860118, 20.583981077899313, 12.950243112729364, 9.383612507268241, 20.043819085749746, 2.4593275769119955, 1.445524730207623, 35.009151962436675, 5.976956586692161, 19.224401973543166, 24.812172417967417, 17.993423941252217, 19.882202087819984, 8.141357718329827, 33.275219462401715, 13.525382970776313, 19.722290107806604, 17.56309246179246, 29.997859336193525, 20.7929394050566, 45.651144050618115, 29.184030297437666, 24.970830243337545, 0.47070619438059613, 18.364753306662543, 0.3593596140987896, 1.3977554313871599, 29.443818787248407, 44.013021152374925, 35.12186909312147, 2.9081155866903554, 43.166995150904775, 23.6498530341338, 0.8321941751081363, 40.75544492496922, 11.300431638158573, 28.21641674600579, 6.931296914485048, 36.308108178636544, 35.929567051278674, 4.22469500651078, 25.386182817640034, 44.92892602646517, 13.451678696861977, 15.01138367325926, 6.373646649072337, 18.756924408385895, 47.146867912659985, 44.47328820251645, 45.60970419543772, 23.614129803134347, 18.057797569896174, 41.778885618678075, 27.94379126029493, 38.66120687437668, 26.211369552899445, 30.139559688087758, 36.23996286175875, 11.894087214598233, 33.74606819957853, 23.8863325817875, 27.953783019201936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28440081612745627, "mean_inference_ms": 0.9476088263946635, "mean_action_processing_ms": 0.12616410353564153, "mean_env_wait_ms": 0.06702337346923665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032536983489990234, "StateBufferConnector_ms": 0.002512216567993164, "ViewRequirementAgentConnector_ms": 0.06560993194580078}, "num_episodes": 5, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 770.7087939786906, "num_env_steps_trained_throughput_per_sec": 770.7087939786906, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 5459.983, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5459.952, "sample_time_ms": 673.947, "learn_time_ms": 4773.011, "learn_throughput": 838.045, "synch_weights_time_ms": 12.64}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 110, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-04-53", "timestamp": 1723395893, "time_this_iter_s": 5.19352388381958, "time_total_s": 610.8507585525513, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9ed1310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 610.8507585525513, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 31.975, "ram_util_percent": 82.9375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3056837388624747, "cur_kl_coeff": 1.3234889800848445e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.17546129560820797, "policy_loss": -0.0019657664193800883, "vf_loss": 0.17742706287341814, "vf_explained_var": 0.9887793447822333, "kl": 0.003452404397184298, "entropy": 0.102549607368807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 106080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2008943792742988, "cur_kl_coeff": 4.6566128730773935e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1368766325955221, "policy_loss": -0.02152335569965847, "vf_loss": 0.15839998897475502, "vf_explained_var": 0.9900389241675536, "kl": 0.008831336447913547, "entropy": 0.27513364103312293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 106080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -47.492272700468774, "predator_policy": 0.3593596140987896}, "policy_reward_max": {"prey_policy": -0.3593596140987896, "predator_policy": 47.492272700468774}, "policy_reward_mean": {"prey_policy": -22.54885247966506, "predator_policy": 22.54885247966506}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-4.303041279917952, -37.88330588166209, -2.279595219003319, -11.889179995577283, -31.655541111544366, -42.29798945924293, -36.45065131020516, -12.29609501745944, -9.573900351360058, -31.736818447065232, -22.424127904441455, -13.147676486428725, -27.811782586864606, -20.757500856363563, -17.427785335220356, -12.648306022026048, -6.859309896714833, -25.157224221199833, -33.31184748776903, -14.589730346543035, -5.379160019325461, -8.605395053409799, -11.297826943194856, -11.457037512680387, -39.464170100515624, -12.283707723392887, -32.25536838050367, -28.919008275448228, -40.18682236764617, -17.870636318860118, -20.583981077899313, -12.950243112729364, -9.383612507268241, -20.043819085749746, -2.4593275769119955, -1.445524730207623, -35.009151962436675, -5.976956586692161, -19.224401973543166, -24.812172417967417, -17.993423941252217, -19.882202087819984, -8.141357718329827, -33.275219462401715, -13.525382970776313, -19.722290107806604, -17.56309246179246, -29.997859336193525, -20.7929394050566, -45.651144050618115, -29.184030297437666, -24.970830243337545, -0.47070619438059613, -18.364753306662543, -0.3593596140987896, -1.3977554313871599, -29.443818787248407, -44.013021152374925, -35.12186909312147, -2.9081155866903554, -43.166995150904775, -23.6498530341338, -0.8321941751081363, -40.75544492496922, -11.300431638158573, -28.21641674600579, -6.931296914485048, -36.308108178636544, -35.929567051278674, -4.22469500651078, -25.386182817640034, -44.92892602646517, -13.451678696861977, -15.01138367325926, -6.373646649072337, -18.756924408385895, -47.146867912659985, -44.47328820251645, -45.60970419543772, -23.614129803134347, -18.057797569896174, -41.778885618678075, -27.94379126029493, -38.66120687437668, -26.211369552899445, -30.139559688087758, -36.23996286175875, -11.894087214598233, -33.74606819957853, -23.8863325817875, -27.953783019201936, -24.04520958887611, -3.0303993579172417, -47.492272700468774, -34.29868442356167, -12.354693904038182, -12.552532804697, -37.66604681316041, -46.23994655320676, -17.735977982018643], "policy_predator_policy_reward": [4.303041279917952, 37.88330588166209, 2.279595219003319, 11.889179995577283, 31.655541111544366, 42.29798945924293, 36.45065131020516, 12.29609501745944, 9.573900351360058, 31.736818447065232, 22.424127904441455, 13.147676486428725, 27.811782586864606, 20.757500856363563, 17.427785335220356, 12.648306022026048, 6.859309896714833, 25.157224221199833, 33.31184748776903, 14.589730346543035, 5.379160019325461, 8.605395053409799, 11.297826943194856, 11.457037512680387, 39.464170100515624, 12.283707723392887, 32.25536838050367, 28.919008275448228, 40.18682236764617, 17.870636318860118, 20.583981077899313, 12.950243112729364, 9.383612507268241, 20.043819085749746, 2.4593275769119955, 1.445524730207623, 35.009151962436675, 5.976956586692161, 19.224401973543166, 24.812172417967417, 17.993423941252217, 19.882202087819984, 8.141357718329827, 33.275219462401715, 13.525382970776313, 19.722290107806604, 17.56309246179246, 29.997859336193525, 20.7929394050566, 45.651144050618115, 29.184030297437666, 24.970830243337545, 0.47070619438059613, 18.364753306662543, 0.3593596140987896, 1.3977554313871599, 29.443818787248407, 44.013021152374925, 35.12186909312147, 2.9081155866903554, 43.166995150904775, 23.6498530341338, 0.8321941751081363, 40.75544492496922, 11.300431638158573, 28.21641674600579, 6.931296914485048, 36.308108178636544, 35.929567051278674, 4.22469500651078, 25.386182817640034, 44.92892602646517, 13.451678696861977, 15.01138367325926, 6.373646649072337, 18.756924408385895, 47.146867912659985, 44.47328820251645, 45.60970419543772, 23.614129803134347, 18.057797569896174, 41.778885618678075, 27.94379126029493, 38.66120687437668, 26.211369552899445, 30.139559688087758, 36.23996286175875, 11.894087214598233, 33.74606819957853, 23.8863325817875, 27.953783019201936, 24.04520958887611, 3.0303993579172417, 47.492272700468774, 34.29868442356167, 12.354693904038182, 12.552532804697, 37.66604681316041, 46.23994655320676, 17.735977982018643]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28434804148561227, "mean_inference_ms": 0.9473587826384757, "mean_action_processing_ms": 0.12616167885342222, "mean_env_wait_ms": 0.06699536829181857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003231525421142578, "StateBufferConnector_ms": 0.002492189407348633, "ViewRequirementAgentConnector_ms": 0.06515777111053467}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 692.0702728768624, "num_env_steps_trained_throughput_per_sec": 692.0702728768624, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 5455.601, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5455.569, "sample_time_ms": 672.951, "learn_time_ms": 4769.874, "learn_throughput": 838.597, "synch_weights_time_ms": 12.391}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "training_iteration": 111, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-04-59", "timestamp": 1723395899, "time_this_iter_s": 5.784857988357544, "time_total_s": 616.6356165409088, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7865e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 616.6356165409088, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 38.2625, "ram_util_percent": 82.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.090966411679983, "cur_kl_coeff": 6.617444900424223e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0593719032384494, "policy_loss": -0.0016492883546258478, "vf_loss": 0.06102119168499485, "vf_explained_var": 0.9966956482579311, "kl": 0.001024356017891822, "entropy": 0.08301189880973349, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 107040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.079735577494527, "cur_kl_coeff": 4.6566128730773935e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06439805732710131, "policy_loss": -0.003143783370857515, "vf_loss": 0.0675418407539837, "vf_explained_var": 0.9962916816895206, "kl": 0.0012623792951320803, "entropy": 0.2622743089372913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 107040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -47.492272700468774, "predator_policy": 0.3593596140987896}, "policy_reward_max": {"prey_policy": -0.3593596140987896, "predator_policy": 47.492272700468774}, "policy_reward_mean": {"prey_policy": -22.79666026694581, "predator_policy": 22.79666026694581}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-31.736818447065232, -22.424127904441455, -13.147676486428725, -27.811782586864606, -20.757500856363563, -17.427785335220356, -12.648306022026048, -6.859309896714833, -25.157224221199833, -33.31184748776903, -14.589730346543035, -5.379160019325461, -8.605395053409799, -11.297826943194856, -11.457037512680387, -39.464170100515624, -12.283707723392887, -32.25536838050367, -28.919008275448228, -40.18682236764617, -17.870636318860118, -20.583981077899313, -12.950243112729364, -9.383612507268241, -20.043819085749746, -2.4593275769119955, -1.445524730207623, -35.009151962436675, -5.976956586692161, -19.224401973543166, -24.812172417967417, -17.993423941252217, -19.882202087819984, -8.141357718329827, -33.275219462401715, -13.525382970776313, -19.722290107806604, -17.56309246179246, -29.997859336193525, -20.7929394050566, -45.651144050618115, -29.184030297437666, -24.970830243337545, -0.47070619438059613, -18.364753306662543, -0.3593596140987896, -1.3977554313871599, -29.443818787248407, -44.013021152374925, -35.12186909312147, -2.9081155866903554, -43.166995150904775, -23.6498530341338, -0.8321941751081363, -40.75544492496922, -11.300431638158573, -28.21641674600579, -6.931296914485048, -36.308108178636544, -35.929567051278674, -4.22469500651078, -25.386182817640034, -44.92892602646517, -13.451678696861977, -15.01138367325926, -6.373646649072337, -18.756924408385895, -47.146867912659985, -44.47328820251645, -45.60970419543772, -23.614129803134347, -18.057797569896174, -41.778885618678075, -27.94379126029493, -38.66120687437668, -26.211369552899445, -30.139559688087758, -36.23996286175875, -11.894087214598233, -33.74606819957853, -23.8863325817875, -27.953783019201936, -24.04520958887611, -3.0303993579172417, -47.492272700468774, -34.29868442356167, -12.354693904038182, -12.552532804697, -37.66604681316041, -46.23994655320676, -17.735977982018643, -33.51296457019234, -26.9263468874282, -25.19971479026126, -23.925409365409333, -5.228979417741585, -24.676039911912078, -23.424109832586247, -21.850758141321073, -28.665755437195273], "policy_predator_policy_reward": [31.736818447065232, 22.424127904441455, 13.147676486428725, 27.811782586864606, 20.757500856363563, 17.427785335220356, 12.648306022026048, 6.859309896714833, 25.157224221199833, 33.31184748776903, 14.589730346543035, 5.379160019325461, 8.605395053409799, 11.297826943194856, 11.457037512680387, 39.464170100515624, 12.283707723392887, 32.25536838050367, 28.919008275448228, 40.18682236764617, 17.870636318860118, 20.583981077899313, 12.950243112729364, 9.383612507268241, 20.043819085749746, 2.4593275769119955, 1.445524730207623, 35.009151962436675, 5.976956586692161, 19.224401973543166, 24.812172417967417, 17.993423941252217, 19.882202087819984, 8.141357718329827, 33.275219462401715, 13.525382970776313, 19.722290107806604, 17.56309246179246, 29.997859336193525, 20.7929394050566, 45.651144050618115, 29.184030297437666, 24.970830243337545, 0.47070619438059613, 18.364753306662543, 0.3593596140987896, 1.3977554313871599, 29.443818787248407, 44.013021152374925, 35.12186909312147, 2.9081155866903554, 43.166995150904775, 23.6498530341338, 0.8321941751081363, 40.75544492496922, 11.300431638158573, 28.21641674600579, 6.931296914485048, 36.308108178636544, 35.929567051278674, 4.22469500651078, 25.386182817640034, 44.92892602646517, 13.451678696861977, 15.01138367325926, 6.373646649072337, 18.756924408385895, 47.146867912659985, 44.47328820251645, 45.60970419543772, 23.614129803134347, 18.057797569896174, 41.778885618678075, 27.94379126029493, 38.66120687437668, 26.211369552899445, 30.139559688087758, 36.23996286175875, 11.894087214598233, 33.74606819957853, 23.8863325817875, 27.953783019201936, 24.04520958887611, 3.0303993579172417, 47.492272700468774, 34.29868442356167, 12.354693904038182, 12.552532804697, 37.66604681316041, 46.23994655320676, 17.735977982018643, 33.51296457019234, 26.9263468874282, 25.19971479026126, 23.925409365409333, 5.228979417741585, 24.676039911912078, 23.424109832586247, 21.850758141321073, 28.665755437195273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2845157676252309, "mean_inference_ms": 0.9472559816398401, "mean_action_processing_ms": 0.12612276668069664, "mean_env_wait_ms": 0.06699641488750825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032188892364501953, "StateBufferConnector_ms": 0.0022896528244018555, "ViewRequirementAgentConnector_ms": 0.0643455982208252}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 730.5143456679538, "num_env_steps_trained_throughput_per_sec": 730.5143456679538, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 5469.696, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5469.662, "sample_time_ms": 672.935, "learn_time_ms": 4779.956, "learn_throughput": 836.828, "synch_weights_time_ms": 16.411}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 112, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-05-05", "timestamp": 1723395905, "time_this_iter_s": 5.483222007751465, "time_total_s": 622.1188385486603, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9ed1dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 622.1188385486603, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 34.3375, "ram_util_percent": 82.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0372602559936543, "cur_kl_coeff": 3.3087224502121113e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.10636003982435796, "policy_loss": -0.0035342693947313817, "vf_loss": 0.10989430890573809, "vf_explained_var": 0.9914313847819964, "kl": 0.0059703013395778345, "entropy": 0.10439503063874629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9944312312174588, "cur_kl_coeff": 2.3283064365386967e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0984248353803802, "policy_loss": -0.003690404279526168, "vf_loss": 0.10211523987430458, "vf_explained_var": 0.9916436679040392, "kl": 0.005902340249653645, "entropy": 0.28000883500402174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -47.492272700468774, "predator_policy": 0.3593596140987896}, "policy_reward_max": {"prey_policy": -0.3593596140987896, "predator_policy": 47.492272700468774}, "policy_reward_mean": {"prey_policy": -22.961543536089348, "predator_policy": 22.961543536089348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-33.31184748776903, -14.589730346543035, -5.379160019325461, -8.605395053409799, -11.297826943194856, -11.457037512680387, -39.464170100515624, -12.283707723392887, -32.25536838050367, -28.919008275448228, -40.18682236764617, -17.870636318860118, -20.583981077899313, -12.950243112729364, -9.383612507268241, -20.043819085749746, -2.4593275769119955, -1.445524730207623, -35.009151962436675, -5.976956586692161, -19.224401973543166, -24.812172417967417, -17.993423941252217, -19.882202087819984, -8.141357718329827, -33.275219462401715, -13.525382970776313, -19.722290107806604, -17.56309246179246, -29.997859336193525, -20.7929394050566, -45.651144050618115, -29.184030297437666, -24.970830243337545, -0.47070619438059613, -18.364753306662543, -0.3593596140987896, -1.3977554313871599, -29.443818787248407, -44.013021152374925, -35.12186909312147, -2.9081155866903554, -43.166995150904775, -23.6498530341338, -0.8321941751081363, -40.75544492496922, -11.300431638158573, -28.21641674600579, -6.931296914485048, -36.308108178636544, -35.929567051278674, -4.22469500651078, -25.386182817640034, -44.92892602646517, -13.451678696861977, -15.01138367325926, -6.373646649072337, -18.756924408385895, -47.146867912659985, -44.47328820251645, -45.60970419543772, -23.614129803134347, -18.057797569896174, -41.778885618678075, -27.94379126029493, -38.66120687437668, -26.211369552899445, -30.139559688087758, -36.23996286175875, -11.894087214598233, -33.74606819957853, -23.8863325817875, -27.953783019201936, -24.04520958887611, -3.0303993579172417, -47.492272700468774, -34.29868442356167, -12.354693904038182, -12.552532804697, -37.66604681316041, -46.23994655320676, -17.735977982018643, -33.51296457019234, -26.9263468874282, -25.19971479026126, -23.925409365409333, -5.228979417741585, -24.676039911912078, -23.424109832586247, -21.850758141321073, -28.665755437195273, -16.184380813985115, -14.856859152398698, -27.09357151677564, -35.345899380546975, -1.8235810085895654, -13.304937859370952, -41.02735041823905, -2.5327515369006317, -42.28952698387139], "policy_predator_policy_reward": [33.31184748776903, 14.589730346543035, 5.379160019325461, 8.605395053409799, 11.297826943194856, 11.457037512680387, 39.464170100515624, 12.283707723392887, 32.25536838050367, 28.919008275448228, 40.18682236764617, 17.870636318860118, 20.583981077899313, 12.950243112729364, 9.383612507268241, 20.043819085749746, 2.4593275769119955, 1.445524730207623, 35.009151962436675, 5.976956586692161, 19.224401973543166, 24.812172417967417, 17.993423941252217, 19.882202087819984, 8.141357718329827, 33.275219462401715, 13.525382970776313, 19.722290107806604, 17.56309246179246, 29.997859336193525, 20.7929394050566, 45.651144050618115, 29.184030297437666, 24.970830243337545, 0.47070619438059613, 18.364753306662543, 0.3593596140987896, 1.3977554313871599, 29.443818787248407, 44.013021152374925, 35.12186909312147, 2.9081155866903554, 43.166995150904775, 23.6498530341338, 0.8321941751081363, 40.75544492496922, 11.300431638158573, 28.21641674600579, 6.931296914485048, 36.308108178636544, 35.929567051278674, 4.22469500651078, 25.386182817640034, 44.92892602646517, 13.451678696861977, 15.01138367325926, 6.373646649072337, 18.756924408385895, 47.146867912659985, 44.47328820251645, 45.60970419543772, 23.614129803134347, 18.057797569896174, 41.778885618678075, 27.94379126029493, 38.66120687437668, 26.211369552899445, 30.139559688087758, 36.23996286175875, 11.894087214598233, 33.74606819957853, 23.8863325817875, 27.953783019201936, 24.04520958887611, 3.0303993579172417, 47.492272700468774, 34.29868442356167, 12.354693904038182, 12.552532804697, 37.66604681316041, 46.23994655320676, 17.735977982018643, 33.51296457019234, 26.9263468874282, 25.19971479026126, 23.925409365409333, 5.228979417741585, 24.676039911912078, 23.424109832586247, 21.850758141321073, 28.665755437195273, 16.184380813985115, 14.856859152398698, 27.09357151677564, 35.345899380546975, 1.8235810085895654, 13.304937859370952, 41.02735041823905, 2.5327515369006317, 42.28952698387139]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28429103204595957, "mean_inference_ms": 0.9470175329531696, "mean_action_processing_ms": 0.1261693848814284, "mean_env_wait_ms": 0.06695110105069926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032111406326293945, "StateBufferConnector_ms": 0.0022965669631958008, "ViewRequirementAgentConnector_ms": 0.06452083587646484}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 708.3911582842233, "num_env_steps_trained_throughput_per_sec": 708.3911582842233, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 904000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 904000, "timers": {"training_iteration_time_ms": 5480.57, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5480.535, "sample_time_ms": 676.623, "learn_time_ms": 4787.14, "learn_throughput": 835.572, "synch_weights_time_ms": 16.405}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000}, "done": false, "training_iteration": 113, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-05-10", "timestamp": 1723395910, "time_this_iter_s": 5.650957107543945, "time_total_s": 627.7697956562042, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9ed1310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 627.7697956562042, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 34.6125, "ram_util_percent": 83.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2702658467615644, "cur_kl_coeff": 3.3087224502121113e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1035225631572151, "policy_loss": -0.0017587379762214065, "vf_loss": 0.10528130199333342, "vf_explained_var": 0.9953357281163335, "kl": 0.0035994241368126206, "entropy": 0.11128843032250492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1729142983444034, "cur_kl_coeff": 2.3283064365386967e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.11068341579618088, "policy_loss": -0.005873591770796338, "vf_loss": 0.11655700739162664, "vf_explained_var": 0.99480966553092, "kl": 0.004676217036389196, "entropy": 0.29949799495128293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -47.492272700468774, "predator_policy": 0.3593596140987896}, "policy_reward_max": {"prey_policy": -0.3593596140987896, "predator_policy": 47.492272700468774}, "policy_reward_mean": {"prey_policy": -23.068583401430672, "predator_policy": 23.068583401430672}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-28.919008275448228, -40.18682236764617, -17.870636318860118, -20.583981077899313, -12.950243112729364, -9.383612507268241, -20.043819085749746, -2.4593275769119955, -1.445524730207623, -35.009151962436675, -5.976956586692161, -19.224401973543166, -24.812172417967417, -17.993423941252217, -19.882202087819984, -8.141357718329827, -33.275219462401715, -13.525382970776313, -19.722290107806604, -17.56309246179246, -29.997859336193525, -20.7929394050566, -45.651144050618115, -29.184030297437666, -24.970830243337545, -0.47070619438059613, -18.364753306662543, -0.3593596140987896, -1.3977554313871599, -29.443818787248407, -44.013021152374925, -35.12186909312147, -2.9081155866903554, -43.166995150904775, -23.6498530341338, -0.8321941751081363, -40.75544492496922, -11.300431638158573, -28.21641674600579, -6.931296914485048, -36.308108178636544, -35.929567051278674, -4.22469500651078, -25.386182817640034, -44.92892602646517, -13.451678696861977, -15.01138367325926, -6.373646649072337, -18.756924408385895, -47.146867912659985, -44.47328820251645, -45.60970419543772, -23.614129803134347, -18.057797569896174, -41.778885618678075, -27.94379126029493, -38.66120687437668, -26.211369552899445, -30.139559688087758, -36.23996286175875, -11.894087214598233, -33.74606819957853, -23.8863325817875, -27.953783019201936, -24.04520958887611, -3.0303993579172417, -47.492272700468774, -34.29868442356167, -12.354693904038182, -12.552532804697, -37.66604681316041, -46.23994655320676, -17.735977982018643, -33.51296457019234, -26.9263468874282, -25.19971479026126, -23.925409365409333, -5.228979417741585, -24.676039911912078, -23.424109832586247, -21.850758141321073, -28.665755437195273, -16.184380813985115, -14.856859152398698, -27.09357151677564, -35.345899380546975, -1.8235810085895654, -13.304937859370952, -41.02735041823905, -2.5327515369006317, -42.28952698387139, -13.776410377800524, -24.008167626666744, -7.098804305026167, -13.048034562850567, -29.687128599441348, -25.025472557501647, -24.09214360895595, -8.605577879409227, -34.00649058381528], "policy_predator_policy_reward": [28.919008275448228, 40.18682236764617, 17.870636318860118, 20.583981077899313, 12.950243112729364, 9.383612507268241, 20.043819085749746, 2.4593275769119955, 1.445524730207623, 35.009151962436675, 5.976956586692161, 19.224401973543166, 24.812172417967417, 17.993423941252217, 19.882202087819984, 8.141357718329827, 33.275219462401715, 13.525382970776313, 19.722290107806604, 17.56309246179246, 29.997859336193525, 20.7929394050566, 45.651144050618115, 29.184030297437666, 24.970830243337545, 0.47070619438059613, 18.364753306662543, 0.3593596140987896, 1.3977554313871599, 29.443818787248407, 44.013021152374925, 35.12186909312147, 2.9081155866903554, 43.166995150904775, 23.6498530341338, 0.8321941751081363, 40.75544492496922, 11.300431638158573, 28.21641674600579, 6.931296914485048, 36.308108178636544, 35.929567051278674, 4.22469500651078, 25.386182817640034, 44.92892602646517, 13.451678696861977, 15.01138367325926, 6.373646649072337, 18.756924408385895, 47.146867912659985, 44.47328820251645, 45.60970419543772, 23.614129803134347, 18.057797569896174, 41.778885618678075, 27.94379126029493, 38.66120687437668, 26.211369552899445, 30.139559688087758, 36.23996286175875, 11.894087214598233, 33.74606819957853, 23.8863325817875, 27.953783019201936, 24.04520958887611, 3.0303993579172417, 47.492272700468774, 34.29868442356167, 12.354693904038182, 12.552532804697, 37.66604681316041, 46.23994655320676, 17.735977982018643, 33.51296457019234, 26.9263468874282, 25.19971479026126, 23.925409365409333, 5.228979417741585, 24.676039911912078, 23.424109832586247, 21.850758141321073, 28.665755437195273, 16.184380813985115, 14.856859152398698, 27.09357151677564, 35.345899380546975, 1.8235810085895654, 13.304937859370952, 41.02735041823905, 2.5327515369006317, 42.28952698387139, 13.776410377800524, 24.008167626666744, 7.098804305026167, 13.048034562850567, 29.687128599441348, 25.025472557501647, 24.09214360895595, 8.605577879409227, 34.00649058381528]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2843973844703751, "mean_inference_ms": 0.9472126047246686, "mean_action_processing_ms": 0.12623148212658772, "mean_env_wait_ms": 0.06697152198721464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035881996154785156, "StateBufferConnector_ms": 0.0023767948150634766, "ViewRequirementAgentConnector_ms": 0.06394481658935547}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 546.5429024791006, "num_env_steps_trained_throughput_per_sec": 546.5429024791006, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 5671.994, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5671.943, "sample_time_ms": 704.867, "learn_time_ms": 4946.366, "learn_throughput": 808.675, "synch_weights_time_ms": 20.09}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 114, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-05-18", "timestamp": 1723395918, "time_this_iter_s": 7.362835884094238, "time_total_s": 635.1326315402985, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a785a9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 635.1326315402985, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 57.249999999999986, "ram_util_percent": 83.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.922824832238257, "cur_kl_coeff": 1.6543612251060557e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.061018799326605706, "policy_loss": -0.0012527232138381805, "vf_loss": 0.062271522495818014, "vf_explained_var": 0.9966970653583606, "kl": 0.002084341272495693, "entropy": 0.11249387347391651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 109920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9855045488414665, "cur_kl_coeff": 1.1641532182693484e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05142595540358646, "policy_loss": -0.011168796020744292, "vf_loss": 0.06259475166540748, "vf_explained_var": 0.9967166679600875, "kl": 0.003464385500290575, "entropy": 0.28820004103084407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 109920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -47.492272700468774, "predator_policy": 0.3593596140987896}, "policy_reward_max": {"prey_policy": -0.3593596140987896, "predator_policy": 47.492272700468774}, "policy_reward_mean": {"prey_policy": -23.398036264144512, "predator_policy": 23.398036264144512}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-35.009151962436675, -5.976956586692161, -19.224401973543166, -24.812172417967417, -17.993423941252217, -19.882202087819984, -8.141357718329827, -33.275219462401715, -13.525382970776313, -19.722290107806604, -17.56309246179246, -29.997859336193525, -20.7929394050566, -45.651144050618115, -29.184030297437666, -24.970830243337545, -0.47070619438059613, -18.364753306662543, -0.3593596140987896, -1.3977554313871599, -29.443818787248407, -44.013021152374925, -35.12186909312147, -2.9081155866903554, -43.166995150904775, -23.6498530341338, -0.8321941751081363, -40.75544492496922, -11.300431638158573, -28.21641674600579, -6.931296914485048, -36.308108178636544, -35.929567051278674, -4.22469500651078, -25.386182817640034, -44.92892602646517, -13.451678696861977, -15.01138367325926, -6.373646649072337, -18.756924408385895, -47.146867912659985, -44.47328820251645, -45.60970419543772, -23.614129803134347, -18.057797569896174, -41.778885618678075, -27.94379126029493, -38.66120687437668, -26.211369552899445, -30.139559688087758, -36.23996286175875, -11.894087214598233, -33.74606819957853, -23.8863325817875, -27.953783019201936, -24.04520958887611, -3.0303993579172417, -47.492272700468774, -34.29868442356167, -12.354693904038182, -12.552532804697, -37.66604681316041, -46.23994655320676, -17.735977982018643, -33.51296457019234, -26.9263468874282, -25.19971479026126, -23.925409365409333, -5.228979417741585, -24.676039911912078, -23.424109832586247, -21.850758141321073, -28.665755437195273, -16.184380813985115, -14.856859152398698, -27.09357151677564, -35.345899380546975, -1.8235810085895654, -13.304937859370952, -41.02735041823905, -2.5327515369006317, -42.28952698387139, -13.776410377800524, -24.008167626666744, -7.098804305026167, -13.048034562850567, -29.687128599441348, -25.025472557501647, -24.09214360895595, -8.605577879409227, -34.00649058381528, -3.257843126310311, -5.7855461696507104, -26.115135044954823, -39.84221996368837, -19.988694436736203, -44.37318808648751, -2.0068845589246616, -32.53095456944333, -12.887795367909275], "policy_predator_policy_reward": [35.009151962436675, 5.976956586692161, 19.224401973543166, 24.812172417967417, 17.993423941252217, 19.882202087819984, 8.141357718329827, 33.275219462401715, 13.525382970776313, 19.722290107806604, 17.56309246179246, 29.997859336193525, 20.7929394050566, 45.651144050618115, 29.184030297437666, 24.970830243337545, 0.47070619438059613, 18.364753306662543, 0.3593596140987896, 1.3977554313871599, 29.443818787248407, 44.013021152374925, 35.12186909312147, 2.9081155866903554, 43.166995150904775, 23.6498530341338, 0.8321941751081363, 40.75544492496922, 11.300431638158573, 28.21641674600579, 6.931296914485048, 36.308108178636544, 35.929567051278674, 4.22469500651078, 25.386182817640034, 44.92892602646517, 13.451678696861977, 15.01138367325926, 6.373646649072337, 18.756924408385895, 47.146867912659985, 44.47328820251645, 45.60970419543772, 23.614129803134347, 18.057797569896174, 41.778885618678075, 27.94379126029493, 38.66120687437668, 26.211369552899445, 30.139559688087758, 36.23996286175875, 11.894087214598233, 33.74606819957853, 23.8863325817875, 27.953783019201936, 24.04520958887611, 3.0303993579172417, 47.492272700468774, 34.29868442356167, 12.354693904038182, 12.552532804697, 37.66604681316041, 46.23994655320676, 17.735977982018643, 33.51296457019234, 26.9263468874282, 25.19971479026126, 23.925409365409333, 5.228979417741585, 24.676039911912078, 23.424109832586247, 21.850758141321073, 28.665755437195273, 16.184380813985115, 14.856859152398698, 27.09357151677564, 35.345899380546975, 1.8235810085895654, 13.304937859370952, 41.02735041823905, 2.5327515369006317, 42.28952698387139, 13.776410377800524, 24.008167626666744, 7.098804305026167, 13.048034562850567, 29.687128599441348, 25.025472557501647, 24.09214360895595, 8.605577879409227, 34.00649058381528, 3.257843126310311, 5.7855461696507104, 26.115135044954823, 39.84221996368837, 19.988694436736203, 44.37318808648751, 2.0068845589246616, 32.53095456944333, 12.887795367909275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2845602214302354, "mean_inference_ms": 0.9476150140666428, "mean_action_processing_ms": 0.12631414421819648, "mean_env_wait_ms": 0.06701502752908026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038270950317382812, "StateBufferConnector_ms": 0.0024111270904541016, "ViewRequirementAgentConnector_ms": 0.06548178195953369}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 679.1912833396366, "num_env_steps_trained_throughput_per_sec": 679.1912833396366, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 920000, "timers": {"training_iteration_time_ms": 5722.001, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5721.938, "sample_time_ms": 733.102, "learn_time_ms": 4968.052, "learn_throughput": 805.145, "synch_weights_time_ms": 20.161}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "done": false, "training_iteration": 115, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-05-24", "timestamp": 1723395924, "time_this_iter_s": 5.893776893615723, "time_total_s": 641.0264084339142, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f22c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 641.0264084339142, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 37.625, "ram_util_percent": 81.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1041181672985354, "cur_kl_coeff": 8.271806125530278e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06247685430328905, "policy_loss": 0.00027855453323960924, "vf_loss": 0.06219830044428818, "vf_explained_var": 0.9967961966370543, "kl": 0.0014848278122579263, "entropy": 0.13286947086259412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 110880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0431041636814673, "cur_kl_coeff": 5.820766091346742e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04248552750529295, "policy_loss": -0.012221917060378474, "vf_loss": 0.05470744437819424, "vf_explained_var": 0.9964122703919808, "kl": 0.004739238120779684, "entropy": 0.29444472286850215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 110880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -47.492272700468774, "predator_policy": 0.3593596140987896}, "policy_reward_max": {"prey_policy": -0.3593596140987896, "predator_policy": 47.492272700468774}, "policy_reward_mean": {"prey_policy": -23.579954198080173, "predator_policy": 23.579954198080173}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-19.722290107806604, -17.56309246179246, -29.997859336193525, -20.7929394050566, -45.651144050618115, -29.184030297437666, -24.970830243337545, -0.47070619438059613, -18.364753306662543, -0.3593596140987896, -1.3977554313871599, -29.443818787248407, -44.013021152374925, -35.12186909312147, -2.9081155866903554, -43.166995150904775, -23.6498530341338, -0.8321941751081363, -40.75544492496922, -11.300431638158573, -28.21641674600579, -6.931296914485048, -36.308108178636544, -35.929567051278674, -4.22469500651078, -25.386182817640034, -44.92892602646517, -13.451678696861977, -15.01138367325926, -6.373646649072337, -18.756924408385895, -47.146867912659985, -44.47328820251645, -45.60970419543772, -23.614129803134347, -18.057797569896174, -41.778885618678075, -27.94379126029493, -38.66120687437668, -26.211369552899445, -30.139559688087758, -36.23996286175875, -11.894087214598233, -33.74606819957853, -23.8863325817875, -27.953783019201936, -24.04520958887611, -3.0303993579172417, -47.492272700468774, -34.29868442356167, -12.354693904038182, -12.552532804697, -37.66604681316041, -46.23994655320676, -17.735977982018643, -33.51296457019234, -26.9263468874282, -25.19971479026126, -23.925409365409333, -5.228979417741585, -24.676039911912078, -23.424109832586247, -21.850758141321073, -28.665755437195273, -16.184380813985115, -14.856859152398698, -27.09357151677564, -35.345899380546975, -1.8235810085895654, -13.304937859370952, -41.02735041823905, -2.5327515369006317, -42.28952698387139, -13.776410377800524, -24.008167626666744, -7.098804305026167, -13.048034562850567, -29.687128599441348, -25.025472557501647, -24.09214360895595, -8.605577879409227, -34.00649058381528, -3.257843126310311, -5.7855461696507104, -26.115135044954823, -39.84221996368837, -19.988694436736203, -44.37318808648751, -2.0068845589246616, -32.53095456944333, -12.887795367909275, -38.95241472156662, -41.52855193003765, -9.229037668118231, -20.1662855233876, -15.410637290370794, -35.85163294927883, -15.999551609275127, -16.079134192761902, -2.8148166299890223], "policy_predator_policy_reward": [19.722290107806604, 17.56309246179246, 29.997859336193525, 20.7929394050566, 45.651144050618115, 29.184030297437666, 24.970830243337545, 0.47070619438059613, 18.364753306662543, 0.3593596140987896, 1.3977554313871599, 29.443818787248407, 44.013021152374925, 35.12186909312147, 2.9081155866903554, 43.166995150904775, 23.6498530341338, 0.8321941751081363, 40.75544492496922, 11.300431638158573, 28.21641674600579, 6.931296914485048, 36.308108178636544, 35.929567051278674, 4.22469500651078, 25.386182817640034, 44.92892602646517, 13.451678696861977, 15.01138367325926, 6.373646649072337, 18.756924408385895, 47.146867912659985, 44.47328820251645, 45.60970419543772, 23.614129803134347, 18.057797569896174, 41.778885618678075, 27.94379126029493, 38.66120687437668, 26.211369552899445, 30.139559688087758, 36.23996286175875, 11.894087214598233, 33.74606819957853, 23.8863325817875, 27.953783019201936, 24.04520958887611, 3.0303993579172417, 47.492272700468774, 34.29868442356167, 12.354693904038182, 12.552532804697, 37.66604681316041, 46.23994655320676, 17.735977982018643, 33.51296457019234, 26.9263468874282, 25.19971479026126, 23.925409365409333, 5.228979417741585, 24.676039911912078, 23.424109832586247, 21.850758141321073, 28.665755437195273, 16.184380813985115, 14.856859152398698, 27.09357151677564, 35.345899380546975, 1.8235810085895654, 13.304937859370952, 41.02735041823905, 2.5327515369006317, 42.28952698387139, 13.776410377800524, 24.008167626666744, 7.098804305026167, 13.048034562850567, 29.687128599441348, 25.025472557501647, 24.09214360895595, 8.605577879409227, 34.00649058381528, 3.257843126310311, 5.7855461696507104, 26.115135044954823, 39.84221996368837, 19.988694436736203, 44.37318808648751, 2.0068845589246616, 32.53095456944333, 12.887795367909275, 38.95241472156662, 41.52855193003765, 9.229037668118231, 20.1662855233876, 15.410637290370794, 35.85163294927883, 15.999551609275127, 16.079134192761902, 2.8148166299890223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2847320520602354, "mean_inference_ms": 0.9480555743532377, "mean_action_processing_ms": 0.12639805550261213, "mean_env_wait_ms": 0.06706229309276203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004090547561645508, "StateBufferConnector_ms": 0.0024400949478149414, "ViewRequirementAgentConnector_ms": 0.0660092830657959}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 685.9139848689576, "num_env_steps_trained_throughput_per_sec": 685.9139848689576, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 5720.505, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5720.442, "sample_time_ms": 703.646, "learn_time_ms": 4995.599, "learn_throughput": 800.705, "synch_weights_time_ms": 20.522}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 116, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-05-29", "timestamp": 1723395929, "time_this_iter_s": 5.836104154586792, "time_total_s": 646.862512588501, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9ed1310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 646.862512588501, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 30.82222222222222, "ram_util_percent": 79.76666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1677820021907488, "cur_kl_coeff": 4.135903062765139e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0797173081805037, "policy_loss": -0.0030977557224105114, "vf_loss": 0.08281506433268078, "vf_explained_var": 0.9967228927339117, "kl": 0.0037387348349139232, "entropy": 0.12722508108320957, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 111840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1133794633982081, "cur_kl_coeff": 2.910383045673371e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.079197933311904, "policy_loss": -0.004202741715562297, "vf_loss": 0.08340067455040602, "vf_explained_var": 0.9967948932821552, "kl": 0.002864746461604738, "entropy": 0.2807129114245375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 111840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.486369307207106, "predator_policy": 0.3593596140987896}, "policy_reward_max": {"prey_policy": -0.3593596140987896, "predator_policy": 49.486369307207106}, "policy_reward_mean": {"prey_policy": -24.075153639342812, "predator_policy": 24.075153639342812}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-45.651144050618115, -29.184030297437666, -24.970830243337545, -0.47070619438059613, -18.364753306662543, -0.3593596140987896, -1.3977554313871599, -29.443818787248407, -44.013021152374925, -35.12186909312147, -2.9081155866903554, -43.166995150904775, -23.6498530341338, -0.8321941751081363, -40.75544492496922, -11.300431638158573, -28.21641674600579, -6.931296914485048, -36.308108178636544, -35.929567051278674, -4.22469500651078, -25.386182817640034, -44.92892602646517, -13.451678696861977, -15.01138367325926, -6.373646649072337, -18.756924408385895, -47.146867912659985, -44.47328820251645, -45.60970419543772, -23.614129803134347, -18.057797569896174, -41.778885618678075, -27.94379126029493, -38.66120687437668, -26.211369552899445, -30.139559688087758, -36.23996286175875, -11.894087214598233, -33.74606819957853, -23.8863325817875, -27.953783019201936, -24.04520958887611, -3.0303993579172417, -47.492272700468774, -34.29868442356167, -12.354693904038182, -12.552532804697, -37.66604681316041, -46.23994655320676, -17.735977982018643, -33.51296457019234, -26.9263468874282, -25.19971479026126, -23.925409365409333, -5.228979417741585, -24.676039911912078, -23.424109832586247, -21.850758141321073, -28.665755437195273, -16.184380813985115, -14.856859152398698, -27.09357151677564, -35.345899380546975, -1.8235810085895654, -13.304937859370952, -41.02735041823905, -2.5327515369006317, -42.28952698387139, -13.776410377800524, -24.008167626666744, -7.098804305026167, -13.048034562850567, -29.687128599441348, -25.025472557501647, -24.09214360895595, -8.605577879409227, -34.00649058381528, -3.257843126310311, -5.7855461696507104, -26.115135044954823, -39.84221996368837, -19.988694436736203, -44.37318808648751, -2.0068845589246616, -32.53095456944333, -12.887795367909275, -38.95241472156662, -41.52855193003765, -9.229037668118231, -20.1662855233876, -15.410637290370794, -35.85163294927883, -15.999551609275127, -16.079134192761902, -2.8148166299890223, -32.65673302150505, -16.67627654022736, -49.486369307207106, -38.77674656817339], "policy_predator_policy_reward": [45.651144050618115, 29.184030297437666, 24.970830243337545, 0.47070619438059613, 18.364753306662543, 0.3593596140987896, 1.3977554313871599, 29.443818787248407, 44.013021152374925, 35.12186909312147, 2.9081155866903554, 43.166995150904775, 23.6498530341338, 0.8321941751081363, 40.75544492496922, 11.300431638158573, 28.21641674600579, 6.931296914485048, 36.308108178636544, 35.929567051278674, 4.22469500651078, 25.386182817640034, 44.92892602646517, 13.451678696861977, 15.01138367325926, 6.373646649072337, 18.756924408385895, 47.146867912659985, 44.47328820251645, 45.60970419543772, 23.614129803134347, 18.057797569896174, 41.778885618678075, 27.94379126029493, 38.66120687437668, 26.211369552899445, 30.139559688087758, 36.23996286175875, 11.894087214598233, 33.74606819957853, 23.8863325817875, 27.953783019201936, 24.04520958887611, 3.0303993579172417, 47.492272700468774, 34.29868442356167, 12.354693904038182, 12.552532804697, 37.66604681316041, 46.23994655320676, 17.735977982018643, 33.51296457019234, 26.9263468874282, 25.19971479026126, 23.925409365409333, 5.228979417741585, 24.676039911912078, 23.424109832586247, 21.850758141321073, 28.665755437195273, 16.184380813985115, 14.856859152398698, 27.09357151677564, 35.345899380546975, 1.8235810085895654, 13.304937859370952, 41.02735041823905, 2.5327515369006317, 42.28952698387139, 13.776410377800524, 24.008167626666744, 7.098804305026167, 13.048034562850567, 29.687128599441348, 25.025472557501647, 24.09214360895595, 8.605577879409227, 34.00649058381528, 3.257843126310311, 5.7855461696507104, 26.115135044954823, 39.84221996368837, 19.988694436736203, 44.37318808648751, 2.0068845589246616, 32.53095456944333, 12.887795367909275, 38.95241472156662, 41.52855193003765, 9.229037668118231, 20.1662855233876, 15.410637290370794, 35.85163294927883, 15.999551609275127, 16.079134192761902, 2.8148166299890223, 32.65673302150505, 16.67627654022736, 49.486369307207106, 38.77674656817339]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28472903362031565, "mean_inference_ms": 0.9482047643876274, "mean_action_processing_ms": 0.12640622566055534, "mean_env_wait_ms": 0.06707243938335648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004222869873046875, "StateBufferConnector_ms": 0.002457737922668457, "ViewRequirementAgentConnector_ms": 0.06636416912078857}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 710.4193596755208, "num_env_steps_trained_throughput_per_sec": 710.4193596755208, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 5746.123, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5746.06, "sample_time_ms": 704.887, "learn_time_ms": 5019.87, "learn_throughput": 796.833, "synch_weights_time_ms": 20.624}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "training_iteration": 117, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-05-35", "timestamp": 1723395935, "time_this_iter_s": 5.635166883468628, "time_total_s": 652.4976794719696, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78dc160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 652.4976794719696, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 29.837500000000002, "ram_util_percent": 79.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0807171709214647, "cur_kl_coeff": 2.0679515313825696e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04745049981926665, "policy_loss": 0.00018118476485445473, "vf_loss": 0.047269314760827304, "vf_explained_var": 0.9958570836111903, "kl": 0.0035048921213858804, "entropy": 0.11194194007936555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 112800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9275161702961972, "cur_kl_coeff": 1.4551915228366855e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03970257340673319, "policy_loss": -0.0030720218916637045, "vf_loss": 0.04277459487978679, "vf_explained_var": 0.9960811904321114, "kl": 0.002609548924209008, "entropy": 0.2289786374506851, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 112800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.486369307207106, "predator_policy": 0.8321941751081363}, "policy_reward_max": {"prey_policy": -0.8321941751081363, "predator_policy": 49.486369307207106}, "policy_reward_mean": {"prey_policy": -24.863265236945185, "predator_policy": 24.863265236945185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-35.12186909312147, -2.9081155866903554, -43.166995150904775, -23.6498530341338, -0.8321941751081363, -40.75544492496922, -11.300431638158573, -28.21641674600579, -6.931296914485048, -36.308108178636544, -35.929567051278674, -4.22469500651078, -25.386182817640034, -44.92892602646517, -13.451678696861977, -15.01138367325926, -6.373646649072337, -18.756924408385895, -47.146867912659985, -44.47328820251645, -45.60970419543772, -23.614129803134347, -18.057797569896174, -41.778885618678075, -27.94379126029493, -38.66120687437668, -26.211369552899445, -30.139559688087758, -36.23996286175875, -11.894087214598233, -33.74606819957853, -23.8863325817875, -27.953783019201936, -24.04520958887611, -3.0303993579172417, -47.492272700468774, -34.29868442356167, -12.354693904038182, -12.552532804697, -37.66604681316041, -46.23994655320676, -17.735977982018643, -33.51296457019234, -26.9263468874282, -25.19971479026126, -23.925409365409333, -5.228979417741585, -24.676039911912078, -23.424109832586247, -21.850758141321073, -28.665755437195273, -16.184380813985115, -14.856859152398698, -27.09357151677564, -35.345899380546975, -1.8235810085895654, -13.304937859370952, -41.02735041823905, -2.5327515369006317, -42.28952698387139, -13.776410377800524, -24.008167626666744, -7.098804305026167, -13.048034562850567, -29.687128599441348, -25.025472557501647, -24.09214360895595, -8.605577879409227, -34.00649058381528, -3.257843126310311, -5.7855461696507104, -26.115135044954823, -39.84221996368837, -19.988694436736203, -44.37318808648751, -2.0068845589246616, -32.53095456944333, -12.887795367909275, -38.95241472156662, -41.52855193003765, -9.229037668118231, -20.1662855233876, -15.410637290370794, -35.85163294927883, -15.999551609275127, -16.079134192761902, -2.8148166299890223, -32.65673302150505, -16.67627654022736, -49.486369307207106, -38.77674656817339, -36.905156390378, -34.24329838445819, -3.4179020707368855, -35.430661302181264, -34.00975005082458, -39.95665369224379, -41.2142084229813, -25.21723927975001, -22.271709244227953], "policy_predator_policy_reward": [35.12186909312147, 2.9081155866903554, 43.166995150904775, 23.6498530341338, 0.8321941751081363, 40.75544492496922, 11.300431638158573, 28.21641674600579, 6.931296914485048, 36.308108178636544, 35.929567051278674, 4.22469500651078, 25.386182817640034, 44.92892602646517, 13.451678696861977, 15.01138367325926, 6.373646649072337, 18.756924408385895, 47.146867912659985, 44.47328820251645, 45.60970419543772, 23.614129803134347, 18.057797569896174, 41.778885618678075, 27.94379126029493, 38.66120687437668, 26.211369552899445, 30.139559688087758, 36.23996286175875, 11.894087214598233, 33.74606819957853, 23.8863325817875, 27.953783019201936, 24.04520958887611, 3.0303993579172417, 47.492272700468774, 34.29868442356167, 12.354693904038182, 12.552532804697, 37.66604681316041, 46.23994655320676, 17.735977982018643, 33.51296457019234, 26.9263468874282, 25.19971479026126, 23.925409365409333, 5.228979417741585, 24.676039911912078, 23.424109832586247, 21.850758141321073, 28.665755437195273, 16.184380813985115, 14.856859152398698, 27.09357151677564, 35.345899380546975, 1.8235810085895654, 13.304937859370952, 41.02735041823905, 2.5327515369006317, 42.28952698387139, 13.776410377800524, 24.008167626666744, 7.098804305026167, 13.048034562850567, 29.687128599441348, 25.025472557501647, 24.09214360895595, 8.605577879409227, 34.00649058381528, 3.257843126310311, 5.7855461696507104, 26.115135044954823, 39.84221996368837, 19.988694436736203, 44.37318808648751, 2.0068845589246616, 32.53095456944333, 12.887795367909275, 38.95241472156662, 41.52855193003765, 9.229037668118231, 20.1662855233876, 15.410637290370794, 35.85163294927883, 15.999551609275127, 16.079134192761902, 2.8148166299890223, 32.65673302150505, 16.67627654022736, 49.486369307207106, 38.77674656817339, 36.905156390378, 34.24329838445819, 3.4179020707368855, 35.430661302181264, 34.00975005082458, 39.95665369224379, 41.2142084229813, 25.21723927975001, 22.271709244227953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2848790659896363, "mean_inference_ms": 0.9485384242429835, "mean_action_processing_ms": 0.12648028190990976, "mean_env_wait_ms": 0.06711245966086679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004455447196960449, "StateBufferConnector_ms": 0.002456188201904297, "ViewRequirementAgentConnector_ms": 0.06663727760314941}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 712.1729881021906, "num_env_steps_trained_throughput_per_sec": 712.1729881021906, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 5761.364, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5761.301, "sample_time_ms": 703.978, "learn_time_ms": 5036.007, "learn_throughput": 794.28, "synch_weights_time_ms": 20.639}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 118, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-05-41", "timestamp": 1723395941, "time_this_iter_s": 5.62208104133606, "time_total_s": 658.1197605133057, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78dcee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 658.1197605133057, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 28.174999999999997, "ram_util_percent": 79.2875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0233583595603704, "cur_kl_coeff": 1.0339757656912848e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09345114375682897, "policy_loss": 0.0001533632855474328, "vf_loss": 0.0932977804041002, "vf_explained_var": 0.9941087421029806, "kl": 0.0008644791487609401, "entropy": 0.0842575705028139, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 113760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9596594754761706, "cur_kl_coeff": 7.275957614183427e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08203619881581593, "policy_loss": -0.0035974072486472625, "vf_loss": 0.08563360614449872, "vf_explained_var": 0.9945670121659835, "kl": 0.0013024540927639979, "entropy": 0.20591282372673353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 113760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.486369307207106, "predator_policy": 1.8235810085895654}, "policy_reward_max": {"prey_policy": -1.8235810085895654, "predator_policy": 49.486369307207106}, "policy_reward_mean": {"prey_policy": -24.852683520328213, "predator_policy": 24.852683520328213}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-40.75544492496922, -11.300431638158573, -28.21641674600579, -6.931296914485048, -36.308108178636544, -35.929567051278674, -4.22469500651078, -25.386182817640034, -44.92892602646517, -13.451678696861977, -15.01138367325926, -6.373646649072337, -18.756924408385895, -47.146867912659985, -44.47328820251645, -45.60970419543772, -23.614129803134347, -18.057797569896174, -41.778885618678075, -27.94379126029493, -38.66120687437668, -26.211369552899445, -30.139559688087758, -36.23996286175875, -11.894087214598233, -33.74606819957853, -23.8863325817875, -27.953783019201936, -24.04520958887611, -3.0303993579172417, -47.492272700468774, -34.29868442356167, -12.354693904038182, -12.552532804697, -37.66604681316041, -46.23994655320676, -17.735977982018643, -33.51296457019234, -26.9263468874282, -25.19971479026126, -23.925409365409333, -5.228979417741585, -24.676039911912078, -23.424109832586247, -21.850758141321073, -28.665755437195273, -16.184380813985115, -14.856859152398698, -27.09357151677564, -35.345899380546975, -1.8235810085895654, -13.304937859370952, -41.02735041823905, -2.5327515369006317, -42.28952698387139, -13.776410377800524, -24.008167626666744, -7.098804305026167, -13.048034562850567, -29.687128599441348, -25.025472557501647, -24.09214360895595, -8.605577879409227, -34.00649058381528, -3.257843126310311, -5.7855461696507104, -26.115135044954823, -39.84221996368837, -19.988694436736203, -44.37318808648751, -2.0068845589246616, -32.53095456944333, -12.887795367909275, -38.95241472156662, -41.52855193003765, -9.229037668118231, -20.1662855233876, -15.410637290370794, -35.85163294927883, -15.999551609275127, -16.079134192761902, -2.8148166299890223, -32.65673302150505, -16.67627654022736, -49.486369307207106, -38.77674656817339, -36.905156390378, -34.24329838445819, -3.4179020707368855, -35.430661302181264, -34.00975005082458, -39.95665369224379, -41.2142084229813, -25.21723927975001, -22.271709244227953, -23.04685735486642, -19.574021700533493, -14.676970603016844, -32.49998184408982, -14.82302387575552], "policy_predator_policy_reward": [40.75544492496922, 11.300431638158573, 28.21641674600579, 6.931296914485048, 36.308108178636544, 35.929567051278674, 4.22469500651078, 25.386182817640034, 44.92892602646517, 13.451678696861977, 15.01138367325926, 6.373646649072337, 18.756924408385895, 47.146867912659985, 44.47328820251645, 45.60970419543772, 23.614129803134347, 18.057797569896174, 41.778885618678075, 27.94379126029493, 38.66120687437668, 26.211369552899445, 30.139559688087758, 36.23996286175875, 11.894087214598233, 33.74606819957853, 23.8863325817875, 27.953783019201936, 24.04520958887611, 3.0303993579172417, 47.492272700468774, 34.29868442356167, 12.354693904038182, 12.552532804697, 37.66604681316041, 46.23994655320676, 17.735977982018643, 33.51296457019234, 26.9263468874282, 25.19971479026126, 23.925409365409333, 5.228979417741585, 24.676039911912078, 23.424109832586247, 21.850758141321073, 28.665755437195273, 16.184380813985115, 14.856859152398698, 27.09357151677564, 35.345899380546975, 1.8235810085895654, 13.304937859370952, 41.02735041823905, 2.5327515369006317, 42.28952698387139, 13.776410377800524, 24.008167626666744, 7.098804305026167, 13.048034562850567, 29.687128599441348, 25.025472557501647, 24.09214360895595, 8.605577879409227, 34.00649058381528, 3.257843126310311, 5.7855461696507104, 26.115135044954823, 39.84221996368837, 19.988694436736203, 44.37318808648751, 2.0068845589246616, 32.53095456944333, 12.887795367909275, 38.95241472156662, 41.52855193003765, 9.229037668118231, 20.1662855233876, 15.410637290370794, 35.85163294927883, 15.999551609275127, 16.079134192761902, 2.8148166299890223, 32.65673302150505, 16.67627654022736, 49.486369307207106, 38.77674656817339, 36.905156390378, 34.24329838445819, 3.4179020707368855, 35.430661302181264, 34.00975005082458, 39.95665369224379, 41.2142084229813, 25.21723927975001, 22.271709244227953, 23.04685735486642, 19.574021700533493, 14.676970603016844, 32.49998184408982, 14.82302387575552]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28501285010388533, "mean_inference_ms": 0.9486267595827378, "mean_action_processing_ms": 0.12652833082760895, "mean_env_wait_ms": 0.06713280086458444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003913283348083496, "StateBufferConnector_ms": 0.0023070573806762695, "ViewRequirementAgentConnector_ms": 0.05729830265045166}, "num_episodes": 5, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 736.5783515749412, "num_env_steps_trained_throughput_per_sec": 736.5783515749412, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 952000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 952000, "timers": {"training_iteration_time_ms": 5780.952, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5780.889, "sample_time_ms": 703.344, "learn_time_ms": 5056.205, "learn_throughput": 791.107, "synch_weights_time_ms": 20.665}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000}, "done": false, "training_iteration": 119, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-05-46", "timestamp": 1723395946, "time_this_iter_s": 5.435462236404419, "time_total_s": 663.5552227497101, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f221f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 663.5552227497101, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 26.925000000000004, "ram_util_percent": 78.875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9099261551474531, "cur_kl_coeff": 5.169878828456424e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.13195484052654743, "policy_loss": -0.0012354362620195995, "vf_loss": 0.1331902776156009, "vf_explained_var": 0.9888804137085875, "kl": 0.0009599432238352912, "entropy": 0.08322071634465829, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 114720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9684721730649472, "cur_kl_coeff": 3.6379788070917137e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08181200111454624, "policy_loss": -0.008579642497594856, "vf_loss": 0.09039164296652112, "vf_explained_var": 0.9942537021512786, "kl": 0.0014050734729564732, "entropy": 0.21285099058101575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 114720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.486369307207106, "predator_policy": 1.8235810085895654}, "policy_reward_max": {"prey_policy": -1.8235810085895654, "predator_policy": 49.486369307207106}, "policy_reward_mean": {"prey_policy": -24.35920913987532, "predator_policy": 24.35920913987532}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-13.451678696861977, -15.01138367325926, -6.373646649072337, -18.756924408385895, -47.146867912659985, -44.47328820251645, -45.60970419543772, -23.614129803134347, -18.057797569896174, -41.778885618678075, -27.94379126029493, -38.66120687437668, -26.211369552899445, -30.139559688087758, -36.23996286175875, -11.894087214598233, -33.74606819957853, -23.8863325817875, -27.953783019201936, -24.04520958887611, -3.0303993579172417, -47.492272700468774, -34.29868442356167, -12.354693904038182, -12.552532804697, -37.66604681316041, -46.23994655320676, -17.735977982018643, -33.51296457019234, -26.9263468874282, -25.19971479026126, -23.925409365409333, -5.228979417741585, -24.676039911912078, -23.424109832586247, -21.850758141321073, -28.665755437195273, -16.184380813985115, -14.856859152398698, -27.09357151677564, -35.345899380546975, -1.8235810085895654, -13.304937859370952, -41.02735041823905, -2.5327515369006317, -42.28952698387139, -13.776410377800524, -24.008167626666744, -7.098804305026167, -13.048034562850567, -29.687128599441348, -25.025472557501647, -24.09214360895595, -8.605577879409227, -34.00649058381528, -3.257843126310311, -5.7855461696507104, -26.115135044954823, -39.84221996368837, -19.988694436736203, -44.37318808648751, -2.0068845589246616, -32.53095456944333, -12.887795367909275, -38.95241472156662, -41.52855193003765, -9.229037668118231, -20.1662855233876, -15.410637290370794, -35.85163294927883, -15.999551609275127, -16.079134192761902, -2.8148166299890223, -32.65673302150505, -16.67627654022736, -49.486369307207106, -38.77674656817339, -36.905156390378, -34.24329838445819, -3.4179020707368855, -35.430661302181264, -34.00975005082458, -39.95665369224379, -41.2142084229813, -25.21723927975001, -22.271709244227953, -23.04685735486642, -19.574021700533493, -14.676970603016844, -32.49998184408982, -14.82302387575552, -5.381597262358847, -24.169819052065527, -29.772846677705477, -10.879659984048814, -17.59238913939044, -21.335731670828125, -9.18988181525037, -25.948382279976066, -40.36332337723701], "policy_predator_policy_reward": [13.451678696861977, 15.01138367325926, 6.373646649072337, 18.756924408385895, 47.146867912659985, 44.47328820251645, 45.60970419543772, 23.614129803134347, 18.057797569896174, 41.778885618678075, 27.94379126029493, 38.66120687437668, 26.211369552899445, 30.139559688087758, 36.23996286175875, 11.894087214598233, 33.74606819957853, 23.8863325817875, 27.953783019201936, 24.04520958887611, 3.0303993579172417, 47.492272700468774, 34.29868442356167, 12.354693904038182, 12.552532804697, 37.66604681316041, 46.23994655320676, 17.735977982018643, 33.51296457019234, 26.9263468874282, 25.19971479026126, 23.925409365409333, 5.228979417741585, 24.676039911912078, 23.424109832586247, 21.850758141321073, 28.665755437195273, 16.184380813985115, 14.856859152398698, 27.09357151677564, 35.345899380546975, 1.8235810085895654, 13.304937859370952, 41.02735041823905, 2.5327515369006317, 42.28952698387139, 13.776410377800524, 24.008167626666744, 7.098804305026167, 13.048034562850567, 29.687128599441348, 25.025472557501647, 24.09214360895595, 8.605577879409227, 34.00649058381528, 3.257843126310311, 5.7855461696507104, 26.115135044954823, 39.84221996368837, 19.988694436736203, 44.37318808648751, 2.0068845589246616, 32.53095456944333, 12.887795367909275, 38.95241472156662, 41.52855193003765, 9.229037668118231, 20.1662855233876, 15.410637290370794, 35.85163294927883, 15.999551609275127, 16.079134192761902, 2.8148166299890223, 32.65673302150505, 16.67627654022736, 49.486369307207106, 38.77674656817339, 36.905156390378, 34.24329838445819, 3.4179020707368855, 35.430661302181264, 34.00975005082458, 39.95665369224379, 41.2142084229813, 25.21723927975001, 22.271709244227953, 23.04685735486642, 19.574021700533493, 14.676970603016844, 32.49998184408982, 14.82302387575552, 5.381597262358847, 24.169819052065527, 29.772846677705477, 10.879659984048814, 17.59238913939044, 21.335731670828125, 9.18988181525037, 25.948382279976066, 40.36332337723701]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2850649820190813, "mean_inference_ms": 0.9486834388818101, "mean_action_processing_ms": 0.1265670024532482, "mean_env_wait_ms": 0.06714365286540075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004103660583496094, "StateBufferConnector_ms": 0.002214789390563965, "ViewRequirementAgentConnector_ms": 0.05214548110961914}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 730.3956571599925, "num_env_steps_trained_throughput_per_sec": 730.3956571599925, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 5809.598, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5809.535, "sample_time_ms": 709.449, "learn_time_ms": 5078.903, "learn_throughput": 787.572, "synch_weights_time_ms": 20.51}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 120, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-05-52", "timestamp": 1723395952, "time_this_iter_s": 5.481622934341431, "time_total_s": 669.0368456840515, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78dc8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 669.0368456840515, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 29.157142857142862, "ram_util_percent": 78.77142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2501181554359695, "cur_kl_coeff": 2.584939414228212e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1642316779743851, "policy_loss": -0.0040171320288209245, "vf_loss": 0.16824881124387805, "vf_explained_var": 0.9924167518193523, "kl": 0.005358683838976862, "entropy": 0.08909369458657844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 115680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0971904678735882, "cur_kl_coeff": 1.8189894035458568e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.15578570335686284, "policy_loss": -0.004669738502586066, "vf_loss": 0.16045544170580495, "vf_explained_var": 0.991803764551878, "kl": 0.0025183269566483517, "entropy": 0.21390689491915207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 115680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.7340545106155, "predator_policy": 1.8235810085895654}, "policy_reward_max": {"prey_policy": -1.8235810085895654, "predator_policy": 49.7340545106155}, "policy_reward_mean": {"prey_policy": -24.43402418388995, "predator_policy": 24.43402418388995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-41.778885618678075, -27.94379126029493, -38.66120687437668, -26.211369552899445, -30.139559688087758, -36.23996286175875, -11.894087214598233, -33.74606819957853, -23.8863325817875, -27.953783019201936, -24.04520958887611, -3.0303993579172417, -47.492272700468774, -34.29868442356167, -12.354693904038182, -12.552532804697, -37.66604681316041, -46.23994655320676, -17.735977982018643, -33.51296457019234, -26.9263468874282, -25.19971479026126, -23.925409365409333, -5.228979417741585, -24.676039911912078, -23.424109832586247, -21.850758141321073, -28.665755437195273, -16.184380813985115, -14.856859152398698, -27.09357151677564, -35.345899380546975, -1.8235810085895654, -13.304937859370952, -41.02735041823905, -2.5327515369006317, -42.28952698387139, -13.776410377800524, -24.008167626666744, -7.098804305026167, -13.048034562850567, -29.687128599441348, -25.025472557501647, -24.09214360895595, -8.605577879409227, -34.00649058381528, -3.257843126310311, -5.7855461696507104, -26.115135044954823, -39.84221996368837, -19.988694436736203, -44.37318808648751, -2.0068845589246616, -32.53095456944333, -12.887795367909275, -38.95241472156662, -41.52855193003765, -9.229037668118231, -20.1662855233876, -15.410637290370794, -35.85163294927883, -15.999551609275127, -16.079134192761902, -2.8148166299890223, -32.65673302150505, -16.67627654022736, -49.486369307207106, -38.77674656817339, -36.905156390378, -34.24329838445819, -3.4179020707368855, -35.430661302181264, -34.00975005082458, -39.95665369224379, -41.2142084229813, -25.21723927975001, -22.271709244227953, -23.04685735486642, -19.574021700533493, -14.676970603016844, -32.49998184408982, -14.82302387575552, -5.381597262358847, -24.169819052065527, -29.772846677705477, -10.879659984048814, -17.59238913939044, -21.335731670828125, -9.18988181525037, -25.948382279976066, -40.36332337723701, -49.7340545106155, -41.79344407106005, -29.440808677971276, -22.687721458097883, -16.525729127266818, -14.760193447509991, -33.70572182664838, -5.252691853710873, -26.076560539805847], "policy_predator_policy_reward": [41.778885618678075, 27.94379126029493, 38.66120687437668, 26.211369552899445, 30.139559688087758, 36.23996286175875, 11.894087214598233, 33.74606819957853, 23.8863325817875, 27.953783019201936, 24.04520958887611, 3.0303993579172417, 47.492272700468774, 34.29868442356167, 12.354693904038182, 12.552532804697, 37.66604681316041, 46.23994655320676, 17.735977982018643, 33.51296457019234, 26.9263468874282, 25.19971479026126, 23.925409365409333, 5.228979417741585, 24.676039911912078, 23.424109832586247, 21.850758141321073, 28.665755437195273, 16.184380813985115, 14.856859152398698, 27.09357151677564, 35.345899380546975, 1.8235810085895654, 13.304937859370952, 41.02735041823905, 2.5327515369006317, 42.28952698387139, 13.776410377800524, 24.008167626666744, 7.098804305026167, 13.048034562850567, 29.687128599441348, 25.025472557501647, 24.09214360895595, 8.605577879409227, 34.00649058381528, 3.257843126310311, 5.7855461696507104, 26.115135044954823, 39.84221996368837, 19.988694436736203, 44.37318808648751, 2.0068845589246616, 32.53095456944333, 12.887795367909275, 38.95241472156662, 41.52855193003765, 9.229037668118231, 20.1662855233876, 15.410637290370794, 35.85163294927883, 15.999551609275127, 16.079134192761902, 2.8148166299890223, 32.65673302150505, 16.67627654022736, 49.486369307207106, 38.77674656817339, 36.905156390378, 34.24329838445819, 3.4179020707368855, 35.430661302181264, 34.00975005082458, 39.95665369224379, 41.2142084229813, 25.21723927975001, 22.271709244227953, 23.04685735486642, 19.574021700533493, 14.676970603016844, 32.49998184408982, 14.82302387575552, 5.381597262358847, 24.169819052065527, 29.772846677705477, 10.879659984048814, 17.59238913939044, 21.335731670828125, 9.18988181525037, 25.948382279976066, 40.36332337723701, 49.7340545106155, 41.79344407106005, 29.440808677971276, 22.687721458097883, 16.525729127266818, 14.760193447509991, 33.70572182664838, 5.252691853710873, 26.076560539805847]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28531816355299516, "mean_inference_ms": 0.9488373597528826, "mean_action_processing_ms": 0.12657355631116124, "mean_env_wait_ms": 0.0671749765646546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042411088943481445, "StateBufferConnector_ms": 0.0021837949752807617, "ViewRequirementAgentConnector_ms": 0.05163764953613281}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 699.8166451438034, "num_env_steps_trained_throughput_per_sec": 699.8166451438034, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 968000, "timers": {"training_iteration_time_ms": 5803.2, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5803.137, "sample_time_ms": 708.504, "learn_time_ms": 5073.437, "learn_throughput": 788.42, "synch_weights_time_ms": 20.522}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000}, "done": false, "training_iteration": 121, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-05-57", "timestamp": 1723395957, "time_this_iter_s": 5.721405982971191, "time_total_s": 674.7582516670227, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f22dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 674.7582516670227, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 28.466666666666672, "ram_util_percent": 78.82222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3328024638971934, "cur_kl_coeff": 2.584939414228212e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.10468879754868492, "policy_loss": -0.002200152905425057, "vf_loss": 0.10688895075193917, "vf_explained_var": 0.9953887953112522, "kl": 0.001711433783630407, "entropy": 0.0802799548759746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 116640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2135149788421888, "cur_kl_coeff": 9.094947017729284e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09538342260348145, "policy_loss": -0.011712964995846656, "vf_loss": 0.10709638800472021, "vf_explained_var": 0.9954143493746718, "kl": 0.005521898410539951, "entropy": 0.2168842062819749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 116640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.7340545106155, "predator_policy": 1.8235810085895654}, "policy_reward_max": {"prey_policy": -1.8235810085895654, "predator_policy": 49.7340545106155}, "policy_reward_mean": {"prey_policy": -23.889063187311166, "predator_policy": 23.889063187311166}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-27.953783019201936, -24.04520958887611, -3.0303993579172417, -47.492272700468774, -34.29868442356167, -12.354693904038182, -12.552532804697, -37.66604681316041, -46.23994655320676, -17.735977982018643, -33.51296457019234, -26.9263468874282, -25.19971479026126, -23.925409365409333, -5.228979417741585, -24.676039911912078, -23.424109832586247, -21.850758141321073, -28.665755437195273, -16.184380813985115, -14.856859152398698, -27.09357151677564, -35.345899380546975, -1.8235810085895654, -13.304937859370952, -41.02735041823905, -2.5327515369006317, -42.28952698387139, -13.776410377800524, -24.008167626666744, -7.098804305026167, -13.048034562850567, -29.687128599441348, -25.025472557501647, -24.09214360895595, -8.605577879409227, -34.00649058381528, -3.257843126310311, -5.7855461696507104, -26.115135044954823, -39.84221996368837, -19.988694436736203, -44.37318808648751, -2.0068845589246616, -32.53095456944333, -12.887795367909275, -38.95241472156662, -41.52855193003765, -9.229037668118231, -20.1662855233876, -15.410637290370794, -35.85163294927883, -15.999551609275127, -16.079134192761902, -2.8148166299890223, -32.65673302150505, -16.67627654022736, -49.486369307207106, -38.77674656817339, -36.905156390378, -34.24329838445819, -3.4179020707368855, -35.430661302181264, -34.00975005082458, -39.95665369224379, -41.2142084229813, -25.21723927975001, -22.271709244227953, -23.04685735486642, -19.574021700533493, -14.676970603016844, -32.49998184408982, -14.82302387575552, -5.381597262358847, -24.169819052065527, -29.772846677705477, -10.879659984048814, -17.59238913939044, -21.335731670828125, -9.18988181525037, -25.948382279976066, -40.36332337723701, -49.7340545106155, -41.79344407106005, -29.440808677971276, -22.687721458097883, -16.525729127266818, -14.760193447509991, -33.70572182664838, -5.252691853710873, -26.076560539805847, -47.70336804165895, -34.22925381732677, -21.928382841420444, -19.498377358259418, -24.73523098101266, -35.993221062583025, -1.975146099434299, -3.480714942849522, -26.461469049636676], "policy_predator_policy_reward": [27.953783019201936, 24.04520958887611, 3.0303993579172417, 47.492272700468774, 34.29868442356167, 12.354693904038182, 12.552532804697, 37.66604681316041, 46.23994655320676, 17.735977982018643, 33.51296457019234, 26.9263468874282, 25.19971479026126, 23.925409365409333, 5.228979417741585, 24.676039911912078, 23.424109832586247, 21.850758141321073, 28.665755437195273, 16.184380813985115, 14.856859152398698, 27.09357151677564, 35.345899380546975, 1.8235810085895654, 13.304937859370952, 41.02735041823905, 2.5327515369006317, 42.28952698387139, 13.776410377800524, 24.008167626666744, 7.098804305026167, 13.048034562850567, 29.687128599441348, 25.025472557501647, 24.09214360895595, 8.605577879409227, 34.00649058381528, 3.257843126310311, 5.7855461696507104, 26.115135044954823, 39.84221996368837, 19.988694436736203, 44.37318808648751, 2.0068845589246616, 32.53095456944333, 12.887795367909275, 38.95241472156662, 41.52855193003765, 9.229037668118231, 20.1662855233876, 15.410637290370794, 35.85163294927883, 15.999551609275127, 16.079134192761902, 2.8148166299890223, 32.65673302150505, 16.67627654022736, 49.486369307207106, 38.77674656817339, 36.905156390378, 34.24329838445819, 3.4179020707368855, 35.430661302181264, 34.00975005082458, 39.95665369224379, 41.2142084229813, 25.21723927975001, 22.271709244227953, 23.04685735486642, 19.574021700533493, 14.676970603016844, 32.49998184408982, 14.82302387575552, 5.381597262358847, 24.169819052065527, 29.772846677705477, 10.879659984048814, 17.59238913939044, 21.335731670828125, 9.18988181525037, 25.948382279976066, 40.36332337723701, 49.7340545106155, 41.79344407106005, 29.440808677971276, 22.687721458097883, 16.525729127266818, 14.760193447509991, 33.70572182664838, 5.252691853710873, 26.076560539805847, 47.70336804165895, 34.22925381732677, 21.928382841420444, 19.498377358259418, 24.73523098101266, 35.993221062583025, 1.975146099434299, 3.480714942849522, 26.461469049636676]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28519830451362077, "mean_inference_ms": 0.9488385437407119, "mean_action_processing_ms": 0.12664652314444716, "mean_env_wait_ms": 0.06716917660461816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435062408447266, "StateBufferConnector_ms": 0.0021926164627075195, "ViewRequirementAgentConnector_ms": 0.0515826940536499}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 729.4501998059984, "num_env_steps_trained_throughput_per_sec": 729.4501998059984, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 5803.999, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5803.938, "sample_time_ms": 716.556, "learn_time_ms": 5069.775, "learn_throughput": 788.99, "synch_weights_time_ms": 16.937}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 122, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-06-03", "timestamp": 1723395963, "time_this_iter_s": 5.489313840866089, "time_total_s": 680.2475655078888, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78dcee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 680.2475655078888, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 30.18571428571428, "ram_util_percent": 78.81428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.108606664200003, "cur_kl_coeff": 1.292469707114106e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1609190215378476, "policy_loss": -0.0024598169041685955, "vf_loss": 0.1633788387218374, "vf_explained_var": 0.9913443335642417, "kl": 0.004332536075908968, "entropy": 0.1251616217487026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 117600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1664751638192683, "cur_kl_coeff": 9.094947017729284e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1483711145228881, "policy_loss": -0.0074951213056920095, "vf_loss": 0.1558662354417417, "vf_explained_var": 0.9925141217807929, "kl": 0.003721655568748883, "entropy": 0.23300804106208187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 117600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.7340545106155, "predator_policy": 1.8235810085895654}, "policy_reward_max": {"prey_policy": -1.8235810085895654, "predator_policy": 49.7340545106155}, "policy_reward_mean": {"prey_policy": -23.349033526898793, "predator_policy": 23.349033526898793}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-17.735977982018643, -33.51296457019234, -26.9263468874282, -25.19971479026126, -23.925409365409333, -5.228979417741585, -24.676039911912078, -23.424109832586247, -21.850758141321073, -28.665755437195273, -16.184380813985115, -14.856859152398698, -27.09357151677564, -35.345899380546975, -1.8235810085895654, -13.304937859370952, -41.02735041823905, -2.5327515369006317, -42.28952698387139, -13.776410377800524, -24.008167626666744, -7.098804305026167, -13.048034562850567, -29.687128599441348, -25.025472557501647, -24.09214360895595, -8.605577879409227, -34.00649058381528, -3.257843126310311, -5.7855461696507104, -26.115135044954823, -39.84221996368837, -19.988694436736203, -44.37318808648751, -2.0068845589246616, -32.53095456944333, -12.887795367909275, -38.95241472156662, -41.52855193003765, -9.229037668118231, -20.1662855233876, -15.410637290370794, -35.85163294927883, -15.999551609275127, -16.079134192761902, -2.8148166299890223, -32.65673302150505, -16.67627654022736, -49.486369307207106, -38.77674656817339, -36.905156390378, -34.24329838445819, -3.4179020707368855, -35.430661302181264, -34.00975005082458, -39.95665369224379, -41.2142084229813, -25.21723927975001, -22.271709244227953, -23.04685735486642, -19.574021700533493, -14.676970603016844, -32.49998184408982, -14.82302387575552, -5.381597262358847, -24.169819052065527, -29.772846677705477, -10.879659984048814, -17.59238913939044, -21.335731670828125, -9.18988181525037, -25.948382279976066, -40.36332337723701, -49.7340545106155, -41.79344407106005, -29.440808677971276, -22.687721458097883, -16.525729127266818, -14.760193447509991, -33.70572182664838, -5.252691853710873, -26.076560539805847, -47.70336804165895, -34.22925381732677, -21.928382841420444, -19.498377358259418, -24.73523098101266, -35.993221062583025, -1.975146099434299, -3.480714942849522, -26.461469049636676, -15.88317983608368, -39.04463202246266, -3.296035993961775, -23.561965356985386, -37.56345214223994, -8.849959157137008, -17.312928750341076, -11.690415803366825, -34.428034061312225], "policy_predator_policy_reward": [17.735977982018643, 33.51296457019234, 26.9263468874282, 25.19971479026126, 23.925409365409333, 5.228979417741585, 24.676039911912078, 23.424109832586247, 21.850758141321073, 28.665755437195273, 16.184380813985115, 14.856859152398698, 27.09357151677564, 35.345899380546975, 1.8235810085895654, 13.304937859370952, 41.02735041823905, 2.5327515369006317, 42.28952698387139, 13.776410377800524, 24.008167626666744, 7.098804305026167, 13.048034562850567, 29.687128599441348, 25.025472557501647, 24.09214360895595, 8.605577879409227, 34.00649058381528, 3.257843126310311, 5.7855461696507104, 26.115135044954823, 39.84221996368837, 19.988694436736203, 44.37318808648751, 2.0068845589246616, 32.53095456944333, 12.887795367909275, 38.95241472156662, 41.52855193003765, 9.229037668118231, 20.1662855233876, 15.410637290370794, 35.85163294927883, 15.999551609275127, 16.079134192761902, 2.8148166299890223, 32.65673302150505, 16.67627654022736, 49.486369307207106, 38.77674656817339, 36.905156390378, 34.24329838445819, 3.4179020707368855, 35.430661302181264, 34.00975005082458, 39.95665369224379, 41.2142084229813, 25.21723927975001, 22.271709244227953, 23.04685735486642, 19.574021700533493, 14.676970603016844, 32.49998184408982, 14.82302387575552, 5.381597262358847, 24.169819052065527, 29.772846677705477, 10.879659984048814, 17.59238913939044, 21.335731670828125, 9.18988181525037, 25.948382279976066, 40.36332337723701, 49.7340545106155, 41.79344407106005, 29.440808677971276, 22.687721458097883, 16.525729127266818, 14.760193447509991, 33.70572182664838, 5.252691853710873, 26.076560539805847, 47.70336804165895, 34.22925381732677, 21.928382841420444, 19.498377358259418, 24.73523098101266, 35.993221062583025, 1.975146099434299, 3.480714942849522, 26.461469049636676, 15.88317983608368, 39.04463202246266, 3.296035993961775, 23.561965356985386, 37.56345214223994, 8.849959157137008, 17.312928750341076, 11.690415803366825, 34.428034061312225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2852903369079954, "mean_inference_ms": 0.9489983416784221, "mean_action_processing_ms": 0.12669576035651506, "mean_env_wait_ms": 0.06718830235752786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046541690826416016, "StateBufferConnector_ms": 0.0021789073944091797, "ViewRequirementAgentConnector_ms": 0.05125832557678223}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 724.3112008749819, "num_env_steps_trained_throughput_per_sec": 724.3112008749819, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 5791.588, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5791.527, "sample_time_ms": 708.543, "learn_time_ms": 5065.393, "learn_throughput": 789.672, "synch_weights_time_ms": 16.968}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "training_iteration": 123, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-06-08", "timestamp": 1723395968, "time_this_iter_s": 5.527646064758301, "time_total_s": 685.7752115726471, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 685.7752115726471, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 27.862499999999997, "ram_util_percent": 78.9625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2982827194035054, "cur_kl_coeff": 6.46234853557053e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.12234782927068105, "policy_loss": -0.002694852722682602, "vf_loss": 0.1250426813882465, "vf_explained_var": 0.9958952070524295, "kl": 0.001808116860770869, "entropy": 0.11709257344094416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 118560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2430148476734757, "cur_kl_coeff": 4.547473508864642e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.11635244939413193, "policy_loss": -0.010050832992904664, "vf_loss": 0.12640328158352834, "vf_explained_var": 0.9957519797608256, "kl": 0.0035631066858421044, "entropy": 0.21581219811923802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 118560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.7340545106155, "predator_policy": 1.8235810085895654}, "policy_reward_max": {"prey_policy": -1.8235810085895654, "predator_policy": 49.7340545106155}, "policy_reward_mean": {"prey_policy": -23.781900619038673, "predator_policy": 23.781900619038673}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-28.665755437195273, -16.184380813985115, -14.856859152398698, -27.09357151677564, -35.345899380546975, -1.8235810085895654, -13.304937859370952, -41.02735041823905, -2.5327515369006317, -42.28952698387139, -13.776410377800524, -24.008167626666744, -7.098804305026167, -13.048034562850567, -29.687128599441348, -25.025472557501647, -24.09214360895595, -8.605577879409227, -34.00649058381528, -3.257843126310311, -5.7855461696507104, -26.115135044954823, -39.84221996368837, -19.988694436736203, -44.37318808648751, -2.0068845589246616, -32.53095456944333, -12.887795367909275, -38.95241472156662, -41.52855193003765, -9.229037668118231, -20.1662855233876, -15.410637290370794, -35.85163294927883, -15.999551609275127, -16.079134192761902, -2.8148166299890223, -32.65673302150505, -16.67627654022736, -49.486369307207106, -38.77674656817339, -36.905156390378, -34.24329838445819, -3.4179020707368855, -35.430661302181264, -34.00975005082458, -39.95665369224379, -41.2142084229813, -25.21723927975001, -22.271709244227953, -23.04685735486642, -19.574021700533493, -14.676970603016844, -32.49998184408982, -14.82302387575552, -5.381597262358847, -24.169819052065527, -29.772846677705477, -10.879659984048814, -17.59238913939044, -21.335731670828125, -9.18988181525037, -25.948382279976066, -40.36332337723701, -49.7340545106155, -41.79344407106005, -29.440808677971276, -22.687721458097883, -16.525729127266818, -14.760193447509991, -33.70572182664838, -5.252691853710873, -26.076560539805847, -47.70336804165895, -34.22925381732677, -21.928382841420444, -19.498377358259418, -24.73523098101266, -35.993221062583025, -1.975146099434299, -3.480714942849522, -26.461469049636676, -15.88317983608368, -39.04463202246266, -3.296035993961775, -23.561965356985386, -37.56345214223994, -8.849959157137008, -17.312928750341076, -11.690415803366825, -34.428034061312225, -31.116465390324553, -21.83005635193026, -34.568724593846504, -11.49867822838106, -21.08022040436611, -40.97550993788201, -30.231476149368763, -42.55985714685612, -11.90602190990305], "policy_predator_policy_reward": [28.665755437195273, 16.184380813985115, 14.856859152398698, 27.09357151677564, 35.345899380546975, 1.8235810085895654, 13.304937859370952, 41.02735041823905, 2.5327515369006317, 42.28952698387139, 13.776410377800524, 24.008167626666744, 7.098804305026167, 13.048034562850567, 29.687128599441348, 25.025472557501647, 24.09214360895595, 8.605577879409227, 34.00649058381528, 3.257843126310311, 5.7855461696507104, 26.115135044954823, 39.84221996368837, 19.988694436736203, 44.37318808648751, 2.0068845589246616, 32.53095456944333, 12.887795367909275, 38.95241472156662, 41.52855193003765, 9.229037668118231, 20.1662855233876, 15.410637290370794, 35.85163294927883, 15.999551609275127, 16.079134192761902, 2.8148166299890223, 32.65673302150505, 16.67627654022736, 49.486369307207106, 38.77674656817339, 36.905156390378, 34.24329838445819, 3.4179020707368855, 35.430661302181264, 34.00975005082458, 39.95665369224379, 41.2142084229813, 25.21723927975001, 22.271709244227953, 23.04685735486642, 19.574021700533493, 14.676970603016844, 32.49998184408982, 14.82302387575552, 5.381597262358847, 24.169819052065527, 29.772846677705477, 10.879659984048814, 17.59238913939044, 21.335731670828125, 9.18988181525037, 25.948382279976066, 40.36332337723701, 49.7340545106155, 41.79344407106005, 29.440808677971276, 22.687721458097883, 16.525729127266818, 14.760193447509991, 33.70572182664838, 5.252691853710873, 26.076560539805847, 47.70336804165895, 34.22925381732677, 21.928382841420444, 19.498377358259418, 24.73523098101266, 35.993221062583025, 1.975146099434299, 3.480714942849522, 26.461469049636676, 15.88317983608368, 39.04463202246266, 3.296035993961775, 23.561965356985386, 37.56345214223994, 8.849959157137008, 17.312928750341076, 11.690415803366825, 34.428034061312225, 31.116465390324553, 21.83005635193026, 34.568724593846504, 11.49867822838106, 21.08022040436611, 40.97550993788201, 30.231476149368763, 42.55985714685612, 11.90602190990305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28544597185230314, "mean_inference_ms": 0.9494214309025817, "mean_action_processing_ms": 0.12677309189719246, "mean_env_wait_ms": 0.06722696468173504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004854679107666016, "StateBufferConnector_ms": 0.0022426843643188477, "ViewRequirementAgentConnector_ms": 0.052042484283447266}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 702.2118194661225, "num_env_steps_trained_throughput_per_sec": 702.2118194661225, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 5629.339, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5629.294, "sample_time_ms": 704.288, "learn_time_ms": 4911.399, "learn_throughput": 814.432, "synch_weights_time_ms": 13.23}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 124, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-06-14", "timestamp": 1723395974, "time_this_iter_s": 5.7014641761779785, "time_total_s": 691.4766757488251, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78651f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 691.4766757488251, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 32.0625, "ram_util_percent": 79.6875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9046313423352937, "cur_kl_coeff": 3.231174267785265e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03628052587955608, "policy_loss": -0.00221355861237195, "vf_loss": 0.03849408501797977, "vf_explained_var": 0.9854144677519798, "kl": 0.0011037421612375587, "entropy": 0.09712716801829326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 119520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7339768797159195, "cur_kl_coeff": 2.273736754432321e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03567828334101553, "policy_loss": -0.003813810423404599, "vf_loss": 0.039492092924774624, "vf_explained_var": 0.9864615523566802, "kl": 0.0011778912648119624, "entropy": 0.1750634139481311, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 119520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.7340545106155, "predator_policy": 1.975146099434299}, "policy_reward_max": {"prey_policy": -1.975146099434299, "predator_policy": 49.7340545106155}, "policy_reward_mean": {"prey_policy": -24.72620088919236, "predator_policy": 24.72620088919236}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-42.28952698387139, -13.776410377800524, -24.008167626666744, -7.098804305026167, -13.048034562850567, -29.687128599441348, -25.025472557501647, -24.09214360895595, -8.605577879409227, -34.00649058381528, -3.257843126310311, -5.7855461696507104, -26.115135044954823, -39.84221996368837, -19.988694436736203, -44.37318808648751, -2.0068845589246616, -32.53095456944333, -12.887795367909275, -38.95241472156662, -41.52855193003765, -9.229037668118231, -20.1662855233876, -15.410637290370794, -35.85163294927883, -15.999551609275127, -16.079134192761902, -2.8148166299890223, -32.65673302150505, -16.67627654022736, -49.486369307207106, -38.77674656817339, -36.905156390378, -34.24329838445819, -3.4179020707368855, -35.430661302181264, -34.00975005082458, -39.95665369224379, -41.2142084229813, -25.21723927975001, -22.271709244227953, -23.04685735486642, -19.574021700533493, -14.676970603016844, -32.49998184408982, -14.82302387575552, -5.381597262358847, -24.169819052065527, -29.772846677705477, -10.879659984048814, -17.59238913939044, -21.335731670828125, -9.18988181525037, -25.948382279976066, -40.36332337723701, -49.7340545106155, -41.79344407106005, -29.440808677971276, -22.687721458097883, -16.525729127266818, -14.760193447509991, -33.70572182664838, -5.252691853710873, -26.076560539805847, -47.70336804165895, -34.22925381732677, -21.928382841420444, -19.498377358259418, -24.73523098101266, -35.993221062583025, -1.975146099434299, -3.480714942849522, -26.461469049636676, -15.88317983608368, -39.04463202246266, -3.296035993961775, -23.561965356985386, -37.56345214223994, -8.849959157137008, -17.312928750341076, -11.690415803366825, -34.428034061312225, -31.116465390324553, -21.83005635193026, -34.568724593846504, -11.49867822838106, -21.08022040436611, -40.97550993788201, -30.231476149368763, -42.55985714685612, -11.90602190990305, -35.66987057577505, -42.21355858707168, -19.3560628603588, -28.18730477031928, -16.727178871140257, -17.185784420450318, -30.00849695118976, -45.628757748282425, -40.28809935478326], "policy_predator_policy_reward": [42.28952698387139, 13.776410377800524, 24.008167626666744, 7.098804305026167, 13.048034562850567, 29.687128599441348, 25.025472557501647, 24.09214360895595, 8.605577879409227, 34.00649058381528, 3.257843126310311, 5.7855461696507104, 26.115135044954823, 39.84221996368837, 19.988694436736203, 44.37318808648751, 2.0068845589246616, 32.53095456944333, 12.887795367909275, 38.95241472156662, 41.52855193003765, 9.229037668118231, 20.1662855233876, 15.410637290370794, 35.85163294927883, 15.999551609275127, 16.079134192761902, 2.8148166299890223, 32.65673302150505, 16.67627654022736, 49.486369307207106, 38.77674656817339, 36.905156390378, 34.24329838445819, 3.4179020707368855, 35.430661302181264, 34.00975005082458, 39.95665369224379, 41.2142084229813, 25.21723927975001, 22.271709244227953, 23.04685735486642, 19.574021700533493, 14.676970603016844, 32.49998184408982, 14.82302387575552, 5.381597262358847, 24.169819052065527, 29.772846677705477, 10.879659984048814, 17.59238913939044, 21.335731670828125, 9.18988181525037, 25.948382279976066, 40.36332337723701, 49.7340545106155, 41.79344407106005, 29.440808677971276, 22.687721458097883, 16.525729127266818, 14.760193447509991, 33.70572182664838, 5.252691853710873, 26.076560539805847, 47.70336804165895, 34.22925381732677, 21.928382841420444, 19.498377358259418, 24.73523098101266, 35.993221062583025, 1.975146099434299, 3.480714942849522, 26.461469049636676, 15.88317983608368, 39.04463202246266, 3.296035993961775, 23.561965356985386, 37.56345214223994, 8.849959157137008, 17.312928750341076, 11.690415803366825, 34.428034061312225, 31.116465390324553, 21.83005635193026, 34.568724593846504, 11.49867822838106, 21.08022040436611, 40.97550993788201, 30.231476149368763, 42.55985714685612, 11.90602190990305, 35.66987057577505, 42.21355858707168, 19.3560628603588, 28.18730477031928, 16.727178871140257, 17.185784420450318, 30.00849695118976, 45.628757748282425, 40.28809935478326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28557339140239235, "mean_inference_ms": 0.9497993539906036, "mean_action_processing_ms": 0.12684553064509924, "mean_env_wait_ms": 0.06726084698747263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004838824272155762, "StateBufferConnector_ms": 0.002210378646850586, "ViewRequirementAgentConnector_ms": 0.051453351974487305}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 745.2946468036524, "num_env_steps_trained_throughput_per_sec": 745.2946468036524, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 1000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1000000, "timers": {"training_iteration_time_ms": 5577.094, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5577.061, "sample_time_ms": 677.761, "learn_time_ms": 4885.879, "learn_throughput": 818.686, "synch_weights_time_ms": 13.045}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "done": false, "training_iteration": 125, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-06-20", "timestamp": 1723395980, "time_this_iter_s": 5.372606992721558, "time_total_s": 696.8492827415466, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78dcee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 696.8492827415466, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 26.075, "ram_util_percent": 79.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0428410949651152, "cur_kl_coeff": 1.6155871338926325e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06134602801685105, "policy_loss": -0.0042393280270819865, "vf_loss": 0.06558535585160523, "vf_explained_var": 0.9971891954541207, "kl": 0.0035914388061392866, "entropy": 0.08698377163188221, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 120480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9547773017858465, "cur_kl_coeff": 1.1368683772161605e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05600052655669666, "policy_loss": -0.004764547970019824, "vf_loss": 0.060765074543693724, "vf_explained_var": 0.9971621264393131, "kl": 0.0023468569078286994, "entropy": 0.1802734067896381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 120480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.7340545106155, "predator_policy": 1.975146099434299}, "policy_reward_max": {"prey_policy": -1.975146099434299, "predator_policy": 49.7340545106155}, "policy_reward_mean": {"prey_policy": -24.372100070049047, "predator_policy": 24.372100070049047}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-13.048034562850567, -29.687128599441348, -25.025472557501647, -24.09214360895595, -8.605577879409227, -34.00649058381528, -3.257843126310311, -5.7855461696507104, -26.115135044954823, -39.84221996368837, -19.988694436736203, -44.37318808648751, -2.0068845589246616, -32.53095456944333, -12.887795367909275, -38.95241472156662, -41.52855193003765, -9.229037668118231, -20.1662855233876, -15.410637290370794, -35.85163294927883, -15.999551609275127, -16.079134192761902, -2.8148166299890223, -32.65673302150505, -16.67627654022736, -49.486369307207106, -38.77674656817339, -36.905156390378, -34.24329838445819, -3.4179020707368855, -35.430661302181264, -34.00975005082458, -39.95665369224379, -41.2142084229813, -25.21723927975001, -22.271709244227953, -23.04685735486642, -19.574021700533493, -14.676970603016844, -32.49998184408982, -14.82302387575552, -5.381597262358847, -24.169819052065527, -29.772846677705477, -10.879659984048814, -17.59238913939044, -21.335731670828125, -9.18988181525037, -25.948382279976066, -40.36332337723701, -49.7340545106155, -41.79344407106005, -29.440808677971276, -22.687721458097883, -16.525729127266818, -14.760193447509991, -33.70572182664838, -5.252691853710873, -26.076560539805847, -47.70336804165895, -34.22925381732677, -21.928382841420444, -19.498377358259418, -24.73523098101266, -35.993221062583025, -1.975146099434299, -3.480714942849522, -26.461469049636676, -15.88317983608368, -39.04463202246266, -3.296035993961775, -23.561965356985386, -37.56345214223994, -8.849959157137008, -17.312928750341076, -11.690415803366825, -34.428034061312225, -31.116465390324553, -21.83005635193026, -34.568724593846504, -11.49867822838106, -21.08022040436611, -40.97550993788201, -30.231476149368763, -42.55985714685612, -11.90602190990305, -35.66987057577505, -42.21355858707168, -19.3560628603588, -28.18730477031928, -16.727178871140257, -17.185784420450318, -30.00849695118976, -45.628757748282425, -40.28809935478326, -15.892344101177176, -22.800883746224184, -10.163577945556174, -2.906021586076471], "policy_predator_policy_reward": [13.048034562850567, 29.687128599441348, 25.025472557501647, 24.09214360895595, 8.605577879409227, 34.00649058381528, 3.257843126310311, 5.7855461696507104, 26.115135044954823, 39.84221996368837, 19.988694436736203, 44.37318808648751, 2.0068845589246616, 32.53095456944333, 12.887795367909275, 38.95241472156662, 41.52855193003765, 9.229037668118231, 20.1662855233876, 15.410637290370794, 35.85163294927883, 15.999551609275127, 16.079134192761902, 2.8148166299890223, 32.65673302150505, 16.67627654022736, 49.486369307207106, 38.77674656817339, 36.905156390378, 34.24329838445819, 3.4179020707368855, 35.430661302181264, 34.00975005082458, 39.95665369224379, 41.2142084229813, 25.21723927975001, 22.271709244227953, 23.04685735486642, 19.574021700533493, 14.676970603016844, 32.49998184408982, 14.82302387575552, 5.381597262358847, 24.169819052065527, 29.772846677705477, 10.879659984048814, 17.59238913939044, 21.335731670828125, 9.18988181525037, 25.948382279976066, 40.36332337723701, 49.7340545106155, 41.79344407106005, 29.440808677971276, 22.687721458097883, 16.525729127266818, 14.760193447509991, 33.70572182664838, 5.252691853710873, 26.076560539805847, 47.70336804165895, 34.22925381732677, 21.928382841420444, 19.498377358259418, 24.73523098101266, 35.993221062583025, 1.975146099434299, 3.480714942849522, 26.461469049636676, 15.88317983608368, 39.04463202246266, 3.296035993961775, 23.561965356985386, 37.56345214223994, 8.849959157137008, 17.312928750341076, 11.690415803366825, 34.428034061312225, 31.116465390324553, 21.83005635193026, 34.568724593846504, 11.49867822838106, 21.08022040436611, 40.97550993788201, 30.231476149368763, 42.55985714685612, 11.90602190990305, 35.66987057577505, 42.21355858707168, 19.3560628603588, 28.18730477031928, 16.727178871140257, 17.185784420450318, 30.00849695118976, 45.628757748282425, 40.28809935478326, 15.892344101177176, 22.800883746224184, 10.163577945556174, 2.906021586076471]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28549433433018556, "mean_inference_ms": 0.949785851497914, "mean_action_processing_ms": 0.12682680706249147, "mean_env_wait_ms": 0.06725640280181217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00480496883392334, "StateBufferConnector_ms": 0.002228975296020508, "ViewRequirementAgentConnector_ms": 0.05198085308074951}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 743.1896934821636, "num_env_steps_trained_throughput_per_sec": 743.1896934821636, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 5532.151, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5532.118, "sample_time_ms": 677.252, "learn_time_ms": 4841.52, "learn_throughput": 826.187, "synch_weights_time_ms": 12.987}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 126, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-06-25", "timestamp": 1723395985, "time_this_iter_s": 5.386803865432739, "time_total_s": 702.2360866069794, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f2fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 702.2360866069794, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 26.650000000000002, "ram_util_percent": 79.63750000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8499857125182947, "cur_kl_coeff": 8.077935669463162e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04256946585737751, "policy_loss": -0.0013619907741182638, "vf_loss": 0.043931456758582496, "vf_explained_var": 0.9966323553894957, "kl": 0.0007799893625347979, "entropy": 0.07487571373349056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 121440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8658898459747434, "cur_kl_coeff": 5.6843418860808026e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04062425105997439, "policy_loss": -0.004049474658434822, "vf_loss": 0.04467372611979954, "vf_explained_var": 0.996889210678637, "kl": 0.0020370243427356273, "entropy": 0.16506866489071398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 121440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.7340545106155, "predator_policy": 1.975146099434299}, "policy_reward_max": {"prey_policy": -1.975146099434299, "predator_policy": 49.7340545106155}, "policy_reward_mean": {"prey_policy": -25.14726021991381, "predator_policy": 25.14726021991381}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-39.84221996368837, -19.988694436736203, -44.37318808648751, -2.0068845589246616, -32.53095456944333, -12.887795367909275, -38.95241472156662, -41.52855193003765, -9.229037668118231, -20.1662855233876, -15.410637290370794, -35.85163294927883, -15.999551609275127, -16.079134192761902, -2.8148166299890223, -32.65673302150505, -16.67627654022736, -49.486369307207106, -38.77674656817339, -36.905156390378, -34.24329838445819, -3.4179020707368855, -35.430661302181264, -34.00975005082458, -39.95665369224379, -41.2142084229813, -25.21723927975001, -22.271709244227953, -23.04685735486642, -19.574021700533493, -14.676970603016844, -32.49998184408982, -14.82302387575552, -5.381597262358847, -24.169819052065527, -29.772846677705477, -10.879659984048814, -17.59238913939044, -21.335731670828125, -9.18988181525037, -25.948382279976066, -40.36332337723701, -49.7340545106155, -41.79344407106005, -29.440808677971276, -22.687721458097883, -16.525729127266818, -14.760193447509991, -33.70572182664838, -5.252691853710873, -26.076560539805847, -47.70336804165895, -34.22925381732677, -21.928382841420444, -19.498377358259418, -24.73523098101266, -35.993221062583025, -1.975146099434299, -3.480714942849522, -26.461469049636676, -15.88317983608368, -39.04463202246266, -3.296035993961775, -23.561965356985386, -37.56345214223994, -8.849959157137008, -17.312928750341076, -11.690415803366825, -34.428034061312225, -31.116465390324553, -21.83005635193026, -34.568724593846504, -11.49867822838106, -21.08022040436611, -40.97550993788201, -30.231476149368763, -42.55985714685612, -11.90602190990305, -35.66987057577505, -42.21355858707168, -19.3560628603588, -28.18730477031928, -16.727178871140257, -17.185784420450318, -30.00849695118976, -45.628757748282425, -40.28809935478326, -15.892344101177176, -22.800883746224184, -10.163577945556174, -2.906021586076471, -40.49787645777747, -46.08662447904452, -40.657454263796886, -14.472810917800103, -23.65267310415181, -4.78789229940541, -33.831727110481836, -22.48523187537921, -20.66709661152833], "policy_predator_policy_reward": [39.84221996368837, 19.988694436736203, 44.37318808648751, 2.0068845589246616, 32.53095456944333, 12.887795367909275, 38.95241472156662, 41.52855193003765, 9.229037668118231, 20.1662855233876, 15.410637290370794, 35.85163294927883, 15.999551609275127, 16.079134192761902, 2.8148166299890223, 32.65673302150505, 16.67627654022736, 49.486369307207106, 38.77674656817339, 36.905156390378, 34.24329838445819, 3.4179020707368855, 35.430661302181264, 34.00975005082458, 39.95665369224379, 41.2142084229813, 25.21723927975001, 22.271709244227953, 23.04685735486642, 19.574021700533493, 14.676970603016844, 32.49998184408982, 14.82302387575552, 5.381597262358847, 24.169819052065527, 29.772846677705477, 10.879659984048814, 17.59238913939044, 21.335731670828125, 9.18988181525037, 25.948382279976066, 40.36332337723701, 49.7340545106155, 41.79344407106005, 29.440808677971276, 22.687721458097883, 16.525729127266818, 14.760193447509991, 33.70572182664838, 5.252691853710873, 26.076560539805847, 47.70336804165895, 34.22925381732677, 21.928382841420444, 19.498377358259418, 24.73523098101266, 35.993221062583025, 1.975146099434299, 3.480714942849522, 26.461469049636676, 15.88317983608368, 39.04463202246266, 3.296035993961775, 23.561965356985386, 37.56345214223994, 8.849959157137008, 17.312928750341076, 11.690415803366825, 34.428034061312225, 31.116465390324553, 21.83005635193026, 34.568724593846504, 11.49867822838106, 21.08022040436611, 40.97550993788201, 30.231476149368763, 42.55985714685612, 11.90602190990305, 35.66987057577505, 42.21355858707168, 19.3560628603588, 28.18730477031928, 16.727178871140257, 17.185784420450318, 30.00849695118976, 45.628757748282425, 40.28809935478326, 15.892344101177176, 22.800883746224184, 10.163577945556174, 2.906021586076471, 40.49787645777747, 46.08662447904452, 40.657454263796886, 14.472810917800103, 23.65267310415181, 4.78789229940541, 33.831727110481836, 22.48523187537921, 20.66709661152833]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.285467046898763, "mean_inference_ms": 0.9497286204030935, "mean_action_processing_ms": 0.1268306684319211, "mean_env_wait_ms": 0.06724129113359514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004317283630371094, "StateBufferConnector_ms": 0.0021151304244995117, "ViewRequirementAgentConnector_ms": 0.04813051223754883}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 719.0950517236436, "num_env_steps_trained_throughput_per_sec": 719.0950517236436, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 1016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1016000, "timers": {"training_iteration_time_ms": 5525.358, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5525.325, "sample_time_ms": 670.319, "learn_time_ms": 4841.911, "learn_throughput": 826.12, "synch_weights_time_ms": 12.74}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000}, "done": false, "training_iteration": 127, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-06-31", "timestamp": 1723395991, "time_this_iter_s": 5.568356037139893, "time_total_s": 707.8044426441193, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f2ff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 707.8044426441193, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 28.9125, "ram_util_percent": 79.26250000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0408757117266456, "cur_kl_coeff": 4.038967834731581e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.12395965939528347, "policy_loss": -0.0029662748869062248, "vf_loss": 0.12692593394215995, "vf_explained_var": 0.9932655844837427, "kl": 0.000918421229473528, "entropy": 0.07736655503395014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 122400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0484745987225323, "cur_kl_coeff": 2.8421709430404013e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.10844284911436261, "policy_loss": -0.01106495229396387, "vf_loss": 0.11950780168554047, "vf_explained_var": 0.993935973321398, "kl": 0.003253308366724261, "entropy": 0.16927470123240104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 122400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.7340545106155, "predator_policy": 1.975146099434299}, "policy_reward_max": {"prey_policy": -1.975146099434299, "predator_policy": 49.7340545106155}, "policy_reward_mean": {"prey_policy": -24.874825646493512, "predator_policy": 24.874825646493512}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-12.887795367909275, -38.95241472156662, -41.52855193003765, -9.229037668118231, -20.1662855233876, -15.410637290370794, -35.85163294927883, -15.999551609275127, -16.079134192761902, -2.8148166299890223, -32.65673302150505, -16.67627654022736, -49.486369307207106, -38.77674656817339, -36.905156390378, -34.24329838445819, -3.4179020707368855, -35.430661302181264, -34.00975005082458, -39.95665369224379, -41.2142084229813, -25.21723927975001, -22.271709244227953, -23.04685735486642, -19.574021700533493, -14.676970603016844, -32.49998184408982, -14.82302387575552, -5.381597262358847, -24.169819052065527, -29.772846677705477, -10.879659984048814, -17.59238913939044, -21.335731670828125, -9.18988181525037, -25.948382279976066, -40.36332337723701, -49.7340545106155, -41.79344407106005, -29.440808677971276, -22.687721458097883, -16.525729127266818, -14.760193447509991, -33.70572182664838, -5.252691853710873, -26.076560539805847, -47.70336804165895, -34.22925381732677, -21.928382841420444, -19.498377358259418, -24.73523098101266, -35.993221062583025, -1.975146099434299, -3.480714942849522, -26.461469049636676, -15.88317983608368, -39.04463202246266, -3.296035993961775, -23.561965356985386, -37.56345214223994, -8.849959157137008, -17.312928750341076, -11.690415803366825, -34.428034061312225, -31.116465390324553, -21.83005635193026, -34.568724593846504, -11.49867822838106, -21.08022040436611, -40.97550993788201, -30.231476149368763, -42.55985714685612, -11.90602190990305, -35.66987057577505, -42.21355858707168, -19.3560628603588, -28.18730477031928, -16.727178871140257, -17.185784420450318, -30.00849695118976, -45.628757748282425, -40.28809935478326, -15.892344101177176, -22.800883746224184, -10.163577945556174, -2.906021586076471, -40.49787645777747, -46.08662447904452, -40.657454263796886, -14.472810917800103, -23.65267310415181, -4.78789229940541, -33.831727110481836, -22.48523187537921, -20.66709661152833, -27.1979643249592, -19.324159342090816, -28.916080074117644, -21.196902203981104, -14.863378328102389], "policy_predator_policy_reward": [12.887795367909275, 38.95241472156662, 41.52855193003765, 9.229037668118231, 20.1662855233876, 15.410637290370794, 35.85163294927883, 15.999551609275127, 16.079134192761902, 2.8148166299890223, 32.65673302150505, 16.67627654022736, 49.486369307207106, 38.77674656817339, 36.905156390378, 34.24329838445819, 3.4179020707368855, 35.430661302181264, 34.00975005082458, 39.95665369224379, 41.2142084229813, 25.21723927975001, 22.271709244227953, 23.04685735486642, 19.574021700533493, 14.676970603016844, 32.49998184408982, 14.82302387575552, 5.381597262358847, 24.169819052065527, 29.772846677705477, 10.879659984048814, 17.59238913939044, 21.335731670828125, 9.18988181525037, 25.948382279976066, 40.36332337723701, 49.7340545106155, 41.79344407106005, 29.440808677971276, 22.687721458097883, 16.525729127266818, 14.760193447509991, 33.70572182664838, 5.252691853710873, 26.076560539805847, 47.70336804165895, 34.22925381732677, 21.928382841420444, 19.498377358259418, 24.73523098101266, 35.993221062583025, 1.975146099434299, 3.480714942849522, 26.461469049636676, 15.88317983608368, 39.04463202246266, 3.296035993961775, 23.561965356985386, 37.56345214223994, 8.849959157137008, 17.312928750341076, 11.690415803366825, 34.428034061312225, 31.116465390324553, 21.83005635193026, 34.568724593846504, 11.49867822838106, 21.08022040436611, 40.97550993788201, 30.231476149368763, 42.55985714685612, 11.90602190990305, 35.66987057577505, 42.21355858707168, 19.3560628603588, 28.18730477031928, 16.727178871140257, 17.185784420450318, 30.00849695118976, 45.628757748282425, 40.28809935478326, 15.892344101177176, 22.800883746224184, 10.163577945556174, 2.906021586076471, 40.49787645777747, 46.08662447904452, 40.657454263796886, 14.472810917800103, 23.65267310415181, 4.78789229940541, 33.831727110481836, 22.48523187537921, 20.66709661152833, 27.1979643249592, 19.324159342090816, 28.916080074117644, 21.196902203981104, 14.863378328102389]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28553282250917333, "mean_inference_ms": 0.9496730852664943, "mean_action_processing_ms": 0.1268524246447436, "mean_env_wait_ms": 0.0672326591785566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042340755462646484, "StateBufferConnector_ms": 0.002112746238708496, "ViewRequirementAgentConnector_ms": 0.048055291175842285}, "num_episodes": 5, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 689.135952856922, "num_env_steps_trained_throughput_per_sec": 689.135952856922, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 5544.133, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5544.101, "sample_time_ms": 673.77, "learn_time_ms": 4857.176, "learn_throughput": 823.524, "synch_weights_time_ms": 12.795}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 128, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-06-36", "timestamp": 1723395996, "time_this_iter_s": 5.808593273162842, "time_total_s": 713.6130359172821, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7865d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 713.6130359172821, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 35.825, "ram_util_percent": 79.5375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8774117116661121, "cur_kl_coeff": 2.0194839173657906e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06935442346827282, "policy_loss": -0.002842005579198788, "vf_loss": 0.07219642884107695, "vf_explained_var": 0.9966267457852761, "kl": 0.0010999206161107402, "entropy": 0.0737765830354571, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 123360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1033303199956814, "cur_kl_coeff": 1.4210854715202006e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06807591772764378, "policy_loss": -0.008310438284631043, "vf_loss": 0.076386355945336, "vf_explained_var": 0.9964678059021632, "kl": 0.005056891435588258, "entropy": 0.19541371488788475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 123360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.7340545106155, "predator_policy": 1.975146099434299}, "policy_reward_max": {"prey_policy": -1.975146099434299, "predator_policy": 49.7340545106155}, "policy_reward_mean": {"prey_policy": -25.65562529203291, "predator_policy": 25.65562529203291}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-2.8148166299890223, -32.65673302150505, -16.67627654022736, -49.486369307207106, -38.77674656817339, -36.905156390378, -34.24329838445819, -3.4179020707368855, -35.430661302181264, -34.00975005082458, -39.95665369224379, -41.2142084229813, -25.21723927975001, -22.271709244227953, -23.04685735486642, -19.574021700533493, -14.676970603016844, -32.49998184408982, -14.82302387575552, -5.381597262358847, -24.169819052065527, -29.772846677705477, -10.879659984048814, -17.59238913939044, -21.335731670828125, -9.18988181525037, -25.948382279976066, -40.36332337723701, -49.7340545106155, -41.79344407106005, -29.440808677971276, -22.687721458097883, -16.525729127266818, -14.760193447509991, -33.70572182664838, -5.252691853710873, -26.076560539805847, -47.70336804165895, -34.22925381732677, -21.928382841420444, -19.498377358259418, -24.73523098101266, -35.993221062583025, -1.975146099434299, -3.480714942849522, -26.461469049636676, -15.88317983608368, -39.04463202246266, -3.296035993961775, -23.561965356985386, -37.56345214223994, -8.849959157137008, -17.312928750341076, -11.690415803366825, -34.428034061312225, -31.116465390324553, -21.83005635193026, -34.568724593846504, -11.49867822838106, -21.08022040436611, -40.97550993788201, -30.231476149368763, -42.55985714685612, -11.90602190990305, -35.66987057577505, -42.21355858707168, -19.3560628603588, -28.18730477031928, -16.727178871140257, -17.185784420450318, -30.00849695118976, -45.628757748282425, -40.28809935478326, -15.892344101177176, -22.800883746224184, -10.163577945556174, -2.906021586076471, -40.49787645777747, -46.08662447904452, -40.657454263796886, -14.472810917800103, -23.65267310415181, -4.78789229940541, -33.831727110481836, -22.48523187537921, -20.66709661152833, -27.1979643249592, -19.324159342090816, -28.916080074117644, -21.196902203981104, -14.863378328102389, -38.77767150009893, -22.290662501563386, -36.206658104260654, -39.38253020592189, -37.04186394296338, -12.26227190746288, -38.228947769313336, -37.39903598625557, -22.595363888805466], "policy_predator_policy_reward": [2.8148166299890223, 32.65673302150505, 16.67627654022736, 49.486369307207106, 38.77674656817339, 36.905156390378, 34.24329838445819, 3.4179020707368855, 35.430661302181264, 34.00975005082458, 39.95665369224379, 41.2142084229813, 25.21723927975001, 22.271709244227953, 23.04685735486642, 19.574021700533493, 14.676970603016844, 32.49998184408982, 14.82302387575552, 5.381597262358847, 24.169819052065527, 29.772846677705477, 10.879659984048814, 17.59238913939044, 21.335731670828125, 9.18988181525037, 25.948382279976066, 40.36332337723701, 49.7340545106155, 41.79344407106005, 29.440808677971276, 22.687721458097883, 16.525729127266818, 14.760193447509991, 33.70572182664838, 5.252691853710873, 26.076560539805847, 47.70336804165895, 34.22925381732677, 21.928382841420444, 19.498377358259418, 24.73523098101266, 35.993221062583025, 1.975146099434299, 3.480714942849522, 26.461469049636676, 15.88317983608368, 39.04463202246266, 3.296035993961775, 23.561965356985386, 37.56345214223994, 8.849959157137008, 17.312928750341076, 11.690415803366825, 34.428034061312225, 31.116465390324553, 21.83005635193026, 34.568724593846504, 11.49867822838106, 21.08022040436611, 40.97550993788201, 30.231476149368763, 42.55985714685612, 11.90602190990305, 35.66987057577505, 42.21355858707168, 19.3560628603588, 28.18730477031928, 16.727178871140257, 17.185784420450318, 30.00849695118976, 45.628757748282425, 40.28809935478326, 15.892344101177176, 22.800883746224184, 10.163577945556174, 2.906021586076471, 40.49787645777747, 46.08662447904452, 40.657454263796886, 14.472810917800103, 23.65267310415181, 4.78789229940541, 33.831727110481836, 22.48523187537921, 20.66709661152833, 27.1979643249592, 19.324159342090816, 28.916080074117644, 21.196902203981104, 14.863378328102389, 38.77767150009893, 22.290662501563386, 36.206658104260654, 39.38253020592189, 37.04186394296338, 12.26227190746288, 38.228947769313336, 37.39903598625557, 22.595363888805466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28548221863799766, "mean_inference_ms": 0.949569583752736, "mean_action_processing_ms": 0.12684933807016774, "mean_env_wait_ms": 0.0672071869487267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004026532173156738, "StateBufferConnector_ms": 0.002130270004272461, "ViewRequirementAgentConnector_ms": 0.05086839199066162}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 732.5985841558568, "num_env_steps_trained_throughput_per_sec": 732.5985841558568, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 1032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 5547.083, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5547.051, "sample_time_ms": 689.14, "learn_time_ms": 4844.633, "learn_throughput": 825.656, "synch_weights_time_ms": 12.919}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "training_iteration": 129, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-06-42", "timestamp": 1723396002, "time_this_iter_s": 5.465936183929443, "time_total_s": 719.0789721012115, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f2f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 719.0789721012115, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 28.425000000000004, "ram_util_percent": 79.9875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2370354190468789, "cur_kl_coeff": 1.0097419586828953e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0702735464219586, "policy_loss": -0.0013794534196980143, "vf_loss": 0.07165299920889083, "vf_explained_var": 0.9976362251366179, "kl": 0.001418974087305025, "entropy": 0.07619251266636032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 124320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1577896380486588, "cur_kl_coeff": 1.4210854715202006e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0635480764710034, "policy_loss": -0.006491696699716461, "vf_loss": 0.07003977325706122, "vf_explained_var": 0.9978824297587077, "kl": 0.00440210593036318, "entropy": 0.19634137575825056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 124320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.7340545106155, "predator_policy": 1.975146099434299}, "policy_reward_max": {"prey_policy": -1.975146099434299, "predator_policy": 49.7340545106155}, "policy_reward_mean": {"prey_policy": -25.27565369967651, "predator_policy": 25.27565369967651}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-34.00975005082458, -39.95665369224379, -41.2142084229813, -25.21723927975001, -22.271709244227953, -23.04685735486642, -19.574021700533493, -14.676970603016844, -32.49998184408982, -14.82302387575552, -5.381597262358847, -24.169819052065527, -29.772846677705477, -10.879659984048814, -17.59238913939044, -21.335731670828125, -9.18988181525037, -25.948382279976066, -40.36332337723701, -49.7340545106155, -41.79344407106005, -29.440808677971276, -22.687721458097883, -16.525729127266818, -14.760193447509991, -33.70572182664838, -5.252691853710873, -26.076560539805847, -47.70336804165895, -34.22925381732677, -21.928382841420444, -19.498377358259418, -24.73523098101266, -35.993221062583025, -1.975146099434299, -3.480714942849522, -26.461469049636676, -15.88317983608368, -39.04463202246266, -3.296035993961775, -23.561965356985386, -37.56345214223994, -8.849959157137008, -17.312928750341076, -11.690415803366825, -34.428034061312225, -31.116465390324553, -21.83005635193026, -34.568724593846504, -11.49867822838106, -21.08022040436611, -40.97550993788201, -30.231476149368763, -42.55985714685612, -11.90602190990305, -35.66987057577505, -42.21355858707168, -19.3560628603588, -28.18730477031928, -16.727178871140257, -17.185784420450318, -30.00849695118976, -45.628757748282425, -40.28809935478326, -15.892344101177176, -22.800883746224184, -10.163577945556174, -2.906021586076471, -40.49787645777747, -46.08662447904452, -40.657454263796886, -14.472810917800103, -23.65267310415181, -4.78789229940541, -33.831727110481836, -22.48523187537921, -20.66709661152833, -27.1979643249592, -19.324159342090816, -28.916080074117644, -21.196902203981104, -14.863378328102389, -38.77767150009893, -22.290662501563386, -36.206658104260654, -39.38253020592189, -37.04186394296338, -12.26227190746288, -38.228947769313336, -37.39903598625557, -22.595363888805466, -23.827061645448666, -29.257178805636695, -32.47227984587261, -17.990242559169218, -38.88793176137072, -14.388113475647042, -12.189340320954171, -16.09450248844668, -27.30415007666989], "policy_predator_policy_reward": [34.00975005082458, 39.95665369224379, 41.2142084229813, 25.21723927975001, 22.271709244227953, 23.04685735486642, 19.574021700533493, 14.676970603016844, 32.49998184408982, 14.82302387575552, 5.381597262358847, 24.169819052065527, 29.772846677705477, 10.879659984048814, 17.59238913939044, 21.335731670828125, 9.18988181525037, 25.948382279976066, 40.36332337723701, 49.7340545106155, 41.79344407106005, 29.440808677971276, 22.687721458097883, 16.525729127266818, 14.760193447509991, 33.70572182664838, 5.252691853710873, 26.076560539805847, 47.70336804165895, 34.22925381732677, 21.928382841420444, 19.498377358259418, 24.73523098101266, 35.993221062583025, 1.975146099434299, 3.480714942849522, 26.461469049636676, 15.88317983608368, 39.04463202246266, 3.296035993961775, 23.561965356985386, 37.56345214223994, 8.849959157137008, 17.312928750341076, 11.690415803366825, 34.428034061312225, 31.116465390324553, 21.83005635193026, 34.568724593846504, 11.49867822838106, 21.08022040436611, 40.97550993788201, 30.231476149368763, 42.55985714685612, 11.90602190990305, 35.66987057577505, 42.21355858707168, 19.3560628603588, 28.18730477031928, 16.727178871140257, 17.185784420450318, 30.00849695118976, 45.628757748282425, 40.28809935478326, 15.892344101177176, 22.800883746224184, 10.163577945556174, 2.906021586076471, 40.49787645777747, 46.08662447904452, 40.657454263796886, 14.472810917800103, 23.65267310415181, 4.78789229940541, 33.831727110481836, 22.48523187537921, 20.66709661152833, 27.1979643249592, 19.324159342090816, 28.916080074117644, 21.196902203981104, 14.863378328102389, 38.77767150009893, 22.290662501563386, 36.206658104260654, 39.38253020592189, 37.04186394296338, 12.26227190746288, 38.228947769313336, 37.39903598625557, 22.595363888805466, 23.827061645448666, 29.257178805636695, 32.47227984587261, 17.990242559169218, 38.88793176137072, 14.388113475647042, 12.189340320954171, 16.09450248844668, 27.30415007666989]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28563593692677874, "mean_inference_ms": 0.9495645644124286, "mean_action_processing_ms": 0.1268115727508884, "mean_env_wait_ms": 0.06720093101422357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038012266159057617, "StateBufferConnector_ms": 0.0021840333938598633, "ViewRequirementAgentConnector_ms": 0.05034923553466797}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 740.7196009092848, "num_env_steps_trained_throughput_per_sec": 740.7196009092848, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 5539.451, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5539.417, "sample_time_ms": 681.717, "learn_time_ms": 4844.384, "learn_throughput": 825.698, "synch_weights_time_ms": 12.956}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 130, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-06-47", "timestamp": 1723396007, "time_this_iter_s": 5.404705047607422, "time_total_s": 724.483677148819, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2f820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 724.483677148819, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 27.099999999999998, "ram_util_percent": 79.91428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.903735361325865, "cur_kl_coeff": 5.0487097934144765e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07611089327789765, "policy_loss": -0.0005016761070388991, "vf_loss": 0.07661256969246703, "vf_explained_var": 0.9970378673945864, "kl": 0.0024192435384966914, "entropy": 0.08666086717760967, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 125280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0881755330755065, "cur_kl_coeff": 7.105427357601003e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08098939868456606, "policy_loss": -0.007161113793457238, "vf_loss": 0.08815051245619543, "vf_explained_var": 0.9964118937030435, "kl": 0.0027960848049590334, "entropy": 0.19849568096299966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 125280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.7340545106155, "predator_policy": 1.975146099434299}, "policy_reward_max": {"prey_policy": -1.975146099434299, "predator_policy": 49.7340545106155}, "policy_reward_mean": {"prey_policy": -25.300177929486896, "predator_policy": 25.300177929486896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-14.82302387575552, -5.381597262358847, -24.169819052065527, -29.772846677705477, -10.879659984048814, -17.59238913939044, -21.335731670828125, -9.18988181525037, -25.948382279976066, -40.36332337723701, -49.7340545106155, -41.79344407106005, -29.440808677971276, -22.687721458097883, -16.525729127266818, -14.760193447509991, -33.70572182664838, -5.252691853710873, -26.076560539805847, -47.70336804165895, -34.22925381732677, -21.928382841420444, -19.498377358259418, -24.73523098101266, -35.993221062583025, -1.975146099434299, -3.480714942849522, -26.461469049636676, -15.88317983608368, -39.04463202246266, -3.296035993961775, -23.561965356985386, -37.56345214223994, -8.849959157137008, -17.312928750341076, -11.690415803366825, -34.428034061312225, -31.116465390324553, -21.83005635193026, -34.568724593846504, -11.49867822838106, -21.08022040436611, -40.97550993788201, -30.231476149368763, -42.55985714685612, -11.90602190990305, -35.66987057577505, -42.21355858707168, -19.3560628603588, -28.18730477031928, -16.727178871140257, -17.185784420450318, -30.00849695118976, -45.628757748282425, -40.28809935478326, -15.892344101177176, -22.800883746224184, -10.163577945556174, -2.906021586076471, -40.49787645777747, -46.08662447904452, -40.657454263796886, -14.472810917800103, -23.65267310415181, -4.78789229940541, -33.831727110481836, -22.48523187537921, -20.66709661152833, -27.1979643249592, -19.324159342090816, -28.916080074117644, -21.196902203981104, -14.863378328102389, -38.77767150009893, -22.290662501563386, -36.206658104260654, -39.38253020592189, -37.04186394296338, -12.26227190746288, -38.228947769313336, -37.39903598625557, -22.595363888805466, -23.827061645448666, -29.257178805636695, -32.47227984587261, -17.990242559169218, -38.88793176137072, -14.388113475647042, -12.189340320954171, -16.09450248844668, -27.30415007666989, -4.651596684958845, -22.368637355688804, -47.14892396260449, -26.059736613093854, -29.06074082207232, -12.369031879369182, -48.14549986984745, -19.57449376711235, -45.54115421882559], "policy_predator_policy_reward": [14.82302387575552, 5.381597262358847, 24.169819052065527, 29.772846677705477, 10.879659984048814, 17.59238913939044, 21.335731670828125, 9.18988181525037, 25.948382279976066, 40.36332337723701, 49.7340545106155, 41.79344407106005, 29.440808677971276, 22.687721458097883, 16.525729127266818, 14.760193447509991, 33.70572182664838, 5.252691853710873, 26.076560539805847, 47.70336804165895, 34.22925381732677, 21.928382841420444, 19.498377358259418, 24.73523098101266, 35.993221062583025, 1.975146099434299, 3.480714942849522, 26.461469049636676, 15.88317983608368, 39.04463202246266, 3.296035993961775, 23.561965356985386, 37.56345214223994, 8.849959157137008, 17.312928750341076, 11.690415803366825, 34.428034061312225, 31.116465390324553, 21.83005635193026, 34.568724593846504, 11.49867822838106, 21.08022040436611, 40.97550993788201, 30.231476149368763, 42.55985714685612, 11.90602190990305, 35.66987057577505, 42.21355858707168, 19.3560628603588, 28.18730477031928, 16.727178871140257, 17.185784420450318, 30.00849695118976, 45.628757748282425, 40.28809935478326, 15.892344101177176, 22.800883746224184, 10.163577945556174, 2.906021586076471, 40.49787645777747, 46.08662447904452, 40.657454263796886, 14.472810917800103, 23.65267310415181, 4.78789229940541, 33.831727110481836, 22.48523187537921, 20.66709661152833, 27.1979643249592, 19.324159342090816, 28.916080074117644, 21.196902203981104, 14.863378328102389, 38.77767150009893, 22.290662501563386, 36.206658104260654, 39.38253020592189, 37.04186394296338, 12.26227190746288, 38.228947769313336, 37.39903598625557, 22.595363888805466, 23.827061645448666, 29.257178805636695, 32.47227984587261, 17.990242559169218, 38.88793176137072, 14.388113475647042, 12.189340320954171, 16.09450248844668, 27.30415007666989, 4.651596684958845, 22.368637355688804, 47.14892396260449, 26.059736613093854, 29.06074082207232, 12.369031879369182, 48.14549986984745, 19.57449376711235, 45.54115421882559]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2853662333652973, "mean_inference_ms": 0.9492883167340274, "mean_action_processing_ms": 0.12683327237582517, "mean_env_wait_ms": 0.06715299036315975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036058425903320312, "StateBufferConnector_ms": 0.0022095441818237305, "ViewRequirementAgentConnector_ms": 0.050814270973205566}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 752.9625668381998, "num_env_steps_trained_throughput_per_sec": 752.9625668381998, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 1048000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1048000, "timers": {"training_iteration_time_ms": 5499.107, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5499.074, "sample_time_ms": 682.758, "learn_time_ms": 4803.084, "learn_throughput": 832.798, "synch_weights_time_ms": 12.874}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000}, "done": false, "training_iteration": 131, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-06-53", "timestamp": 1723396013, "time_this_iter_s": 5.317694902420044, "time_total_s": 729.801372051239, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7865d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 729.801372051239, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 27.5375, "ram_util_percent": 79.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.006590702679629, "cur_kl_coeff": 2.5243548967072383e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08326990524825911, "policy_loss": 0.0018291593154572184, "vf_loss": 0.08144074591109529, "vf_explained_var": 0.9959545332317551, "kl": 0.0013584385506247927, "entropy": 0.08870740393564726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 126240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8789383081253618, "cur_kl_coeff": 3.5527136788005016e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06907735819913796, "policy_loss": -0.005365478869013411, "vf_loss": 0.0744428367606209, "vf_explained_var": 0.996042079354326, "kl": 0.0030264570580794607, "entropy": 0.19707456445321442, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 126240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.7340545106155, "predator_policy": 1.975146099434299}, "policy_reward_max": {"prey_policy": -1.975146099434299, "predator_policy": 49.7340545106155}, "policy_reward_mean": {"prey_policy": -26.414422578276525, "predator_policy": 26.414422578276525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-40.36332337723701, -49.7340545106155, -41.79344407106005, -29.440808677971276, -22.687721458097883, -16.525729127266818, -14.760193447509991, -33.70572182664838, -5.252691853710873, -26.076560539805847, -47.70336804165895, -34.22925381732677, -21.928382841420444, -19.498377358259418, -24.73523098101266, -35.993221062583025, -1.975146099434299, -3.480714942849522, -26.461469049636676, -15.88317983608368, -39.04463202246266, -3.296035993961775, -23.561965356985386, -37.56345214223994, -8.849959157137008, -17.312928750341076, -11.690415803366825, -34.428034061312225, -31.116465390324553, -21.83005635193026, -34.568724593846504, -11.49867822838106, -21.08022040436611, -40.97550993788201, -30.231476149368763, -42.55985714685612, -11.90602190990305, -35.66987057577505, -42.21355858707168, -19.3560628603588, -28.18730477031928, -16.727178871140257, -17.185784420450318, -30.00849695118976, -45.628757748282425, -40.28809935478326, -15.892344101177176, -22.800883746224184, -10.163577945556174, -2.906021586076471, -40.49787645777747, -46.08662447904452, -40.657454263796886, -14.472810917800103, -23.65267310415181, -4.78789229940541, -33.831727110481836, -22.48523187537921, -20.66709661152833, -27.1979643249592, -19.324159342090816, -28.916080074117644, -21.196902203981104, -14.863378328102389, -38.77767150009893, -22.290662501563386, -36.206658104260654, -39.38253020592189, -37.04186394296338, -12.26227190746288, -38.228947769313336, -37.39903598625557, -22.595363888805466, -23.827061645448666, -29.257178805636695, -32.47227984587261, -17.990242559169218, -38.88793176137072, -14.388113475647042, -12.189340320954171, -16.09450248844668, -27.30415007666989, -4.651596684958845, -22.368637355688804, -47.14892396260449, -26.059736613093854, -29.06074082207232, -12.369031879369182, -48.14549986984745, -19.57449376711235, -45.54115421882559, -17.616067776762478, -38.934191454100926, -11.817632511602202, -26.689952373502173, -25.4576683816755, -36.998606598537485, -41.8550985449683, -30.93149511298115, -40.217083882212044], "policy_predator_policy_reward": [40.36332337723701, 49.7340545106155, 41.79344407106005, 29.440808677971276, 22.687721458097883, 16.525729127266818, 14.760193447509991, 33.70572182664838, 5.252691853710873, 26.076560539805847, 47.70336804165895, 34.22925381732677, 21.928382841420444, 19.498377358259418, 24.73523098101266, 35.993221062583025, 1.975146099434299, 3.480714942849522, 26.461469049636676, 15.88317983608368, 39.04463202246266, 3.296035993961775, 23.561965356985386, 37.56345214223994, 8.849959157137008, 17.312928750341076, 11.690415803366825, 34.428034061312225, 31.116465390324553, 21.83005635193026, 34.568724593846504, 11.49867822838106, 21.08022040436611, 40.97550993788201, 30.231476149368763, 42.55985714685612, 11.90602190990305, 35.66987057577505, 42.21355858707168, 19.3560628603588, 28.18730477031928, 16.727178871140257, 17.185784420450318, 30.00849695118976, 45.628757748282425, 40.28809935478326, 15.892344101177176, 22.800883746224184, 10.163577945556174, 2.906021586076471, 40.49787645777747, 46.08662447904452, 40.657454263796886, 14.472810917800103, 23.65267310415181, 4.78789229940541, 33.831727110481836, 22.48523187537921, 20.66709661152833, 27.1979643249592, 19.324159342090816, 28.916080074117644, 21.196902203981104, 14.863378328102389, 38.77767150009893, 22.290662501563386, 36.206658104260654, 39.38253020592189, 37.04186394296338, 12.26227190746288, 38.228947769313336, 37.39903598625557, 22.595363888805466, 23.827061645448666, 29.257178805636695, 32.47227984587261, 17.990242559169218, 38.88793176137072, 14.388113475647042, 12.189340320954171, 16.09450248844668, 27.30415007666989, 4.651596684958845, 22.368637355688804, 47.14892396260449, 26.059736613093854, 29.06074082207232, 12.369031879369182, 48.14549986984745, 19.57449376711235, 45.54115421882559, 17.616067776762478, 38.934191454100926, 11.817632511602202, 26.689952373502173, 25.4576683816755, 36.998606598537485, 41.8550985449683, 30.93149511298115, 40.217083882212044]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28531213534087735, "mean_inference_ms": 0.9491627190244492, "mean_action_processing_ms": 0.12682651222527352, "mean_env_wait_ms": 0.0671289524083557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003380417823791504, "StateBufferConnector_ms": 0.002183198928833008, "ViewRequirementAgentConnector_ms": 0.05040180683135986}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 718.9714482402076, "num_env_steps_trained_throughput_per_sec": 718.9714482402076, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 5507.099, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5507.066, "sample_time_ms": 673.086, "learn_time_ms": 4821.073, "learn_throughput": 829.691, "synch_weights_time_ms": 12.506}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 132, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-06-58", "timestamp": 1723396018, "time_this_iter_s": 5.568028211593628, "time_total_s": 735.3694002628326, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a785a160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 735.3694002628326, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 30.075, "ram_util_percent": 80.17500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0299388899467885, "cur_kl_coeff": 1.2621774483536191e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.12451497647174013, "policy_loss": 0.0003941157972197592, "vf_loss": 0.12412086097174324, "vf_explained_var": 0.99423863645643, "kl": 0.0018157115834764722, "entropy": 0.09194309741724283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 127200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.17045785143661, "cur_kl_coeff": 1.7763568394002508e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.11444152904077783, "policy_loss": -0.003770646369472767, "vf_loss": 0.11821217495404805, "vf_explained_var": 0.9945829867074887, "kl": 0.0017255346246079634, "entropy": 0.21251272934799392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 127200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -48.14549986984745, "predator_policy": 1.975146099434299}, "policy_reward_max": {"prey_policy": -1.975146099434299, "predator_policy": 48.14549986984745}, "policy_reward_mean": {"prey_policy": -26.16866432765021, "predator_policy": 26.16866432765021}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-26.076560539805847, -47.70336804165895, -34.22925381732677, -21.928382841420444, -19.498377358259418, -24.73523098101266, -35.993221062583025, -1.975146099434299, -3.480714942849522, -26.461469049636676, -15.88317983608368, -39.04463202246266, -3.296035993961775, -23.561965356985386, -37.56345214223994, -8.849959157137008, -17.312928750341076, -11.690415803366825, -34.428034061312225, -31.116465390324553, -21.83005635193026, -34.568724593846504, -11.49867822838106, -21.08022040436611, -40.97550993788201, -30.231476149368763, -42.55985714685612, -11.90602190990305, -35.66987057577505, -42.21355858707168, -19.3560628603588, -28.18730477031928, -16.727178871140257, -17.185784420450318, -30.00849695118976, -45.628757748282425, -40.28809935478326, -15.892344101177176, -22.800883746224184, -10.163577945556174, -2.906021586076471, -40.49787645777747, -46.08662447904452, -40.657454263796886, -14.472810917800103, -23.65267310415181, -4.78789229940541, -33.831727110481836, -22.48523187537921, -20.66709661152833, -27.1979643249592, -19.324159342090816, -28.916080074117644, -21.196902203981104, -14.863378328102389, -38.77767150009893, -22.290662501563386, -36.206658104260654, -39.38253020592189, -37.04186394296338, -12.26227190746288, -38.228947769313336, -37.39903598625557, -22.595363888805466, -23.827061645448666, -29.257178805636695, -32.47227984587261, -17.990242559169218, -38.88793176137072, -14.388113475647042, -12.189340320954171, -16.09450248844668, -27.30415007666989, -4.651596684958845, -22.368637355688804, -47.14892396260449, -26.059736613093854, -29.06074082207232, -12.369031879369182, -48.14549986984745, -19.57449376711235, -45.54115421882559, -17.616067776762478, -38.934191454100926, -11.817632511602202, -26.689952373502173, -25.4576683816755, -36.998606598537485, -41.8550985449683, -30.93149511298115, -40.217083882212044, -18.93702863655472, -24.806466661589965, -18.6205483019365, -15.432217735736842, -42.542114945253935, -19.773997009047687, -24.3770771004147, -39.23868492680648, -25.95972797014575], "policy_predator_policy_reward": [26.076560539805847, 47.70336804165895, 34.22925381732677, 21.928382841420444, 19.498377358259418, 24.73523098101266, 35.993221062583025, 1.975146099434299, 3.480714942849522, 26.461469049636676, 15.88317983608368, 39.04463202246266, 3.296035993961775, 23.561965356985386, 37.56345214223994, 8.849959157137008, 17.312928750341076, 11.690415803366825, 34.428034061312225, 31.116465390324553, 21.83005635193026, 34.568724593846504, 11.49867822838106, 21.08022040436611, 40.97550993788201, 30.231476149368763, 42.55985714685612, 11.90602190990305, 35.66987057577505, 42.21355858707168, 19.3560628603588, 28.18730477031928, 16.727178871140257, 17.185784420450318, 30.00849695118976, 45.628757748282425, 40.28809935478326, 15.892344101177176, 22.800883746224184, 10.163577945556174, 2.906021586076471, 40.49787645777747, 46.08662447904452, 40.657454263796886, 14.472810917800103, 23.65267310415181, 4.78789229940541, 33.831727110481836, 22.48523187537921, 20.66709661152833, 27.1979643249592, 19.324159342090816, 28.916080074117644, 21.196902203981104, 14.863378328102389, 38.77767150009893, 22.290662501563386, 36.206658104260654, 39.38253020592189, 37.04186394296338, 12.26227190746288, 38.228947769313336, 37.39903598625557, 22.595363888805466, 23.827061645448666, 29.257178805636695, 32.47227984587261, 17.990242559169218, 38.88793176137072, 14.388113475647042, 12.189340320954171, 16.09450248844668, 27.30415007666989, 4.651596684958845, 22.368637355688804, 47.14892396260449, 26.059736613093854, 29.06074082207232, 12.369031879369182, 48.14549986984745, 19.57449376711235, 45.54115421882559, 17.616067776762478, 38.934191454100926, 11.817632511602202, 26.689952373502173, 25.4576683816755, 36.998606598537485, 41.8550985449683, 30.93149511298115, 40.217083882212044, 18.93702863655472, 24.806466661589965, 18.6205483019365, 15.432217735736842, 42.542114945253935, 19.773997009047687, 24.3770771004147, 39.23868492680648, 25.95972797014575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2852735755878202, "mean_inference_ms": 0.9490760535038544, "mean_action_processing_ms": 0.12682272574997125, "mean_env_wait_ms": 0.06710953942857889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032373666763305664, "StateBufferConnector_ms": 0.002186894416809082, "ViewRequirementAgentConnector_ms": 0.05037844181060791}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 737.6563740371338, "num_env_steps_trained_throughput_per_sec": 737.6563740371338, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 1064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1064000, "timers": {"training_iteration_time_ms": 5497.108, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5497.076, "sample_time_ms": 675.197, "learn_time_ms": 4809.063, "learn_throughput": 831.763, "synch_weights_time_ms": 12.411}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000}, "done": false, "training_iteration": 133, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-07-04", "timestamp": 1723396024, "time_this_iter_s": 5.428385019302368, "time_total_s": 740.797785282135, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f2f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 740.797785282135, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 27.199999999999996, "ram_util_percent": 80.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9812267304242899, "cur_kl_coeff": 6.310887241768096e-31, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08702233584651063, "policy_loss": -0.0010687300379989514, "vf_loss": 0.08809106618524917, "vf_explained_var": 0.9920468489949902, "kl": 0.0012326981518056394, "entropy": 0.0818383576280515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 128160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8922801659442484, "cur_kl_coeff": 8.881784197001254e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07996244883082303, "policy_loss": -0.002375588314074169, "vf_loss": 0.08233803761007343, "vf_explained_var": 0.9935251013065378, "kl": 0.0014167818521896931, "entropy": 0.17040604359935968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 128160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -48.14549986984745, "predator_policy": 1.975146099434299}, "policy_reward_max": {"prey_policy": -1.975146099434299, "predator_policy": 48.14549986984745}, "policy_reward_mean": {"prey_policy": -25.763246499042015, "predator_policy": 25.763246499042015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-19.498377358259418, -24.73523098101266, -35.993221062583025, -1.975146099434299, -3.480714942849522, -26.461469049636676, -15.88317983608368, -39.04463202246266, -3.296035993961775, -23.561965356985386, -37.56345214223994, -8.849959157137008, -17.312928750341076, -11.690415803366825, -34.428034061312225, -31.116465390324553, -21.83005635193026, -34.568724593846504, -11.49867822838106, -21.08022040436611, -40.97550993788201, -30.231476149368763, -42.55985714685612, -11.90602190990305, -35.66987057577505, -42.21355858707168, -19.3560628603588, -28.18730477031928, -16.727178871140257, -17.185784420450318, -30.00849695118976, -45.628757748282425, -40.28809935478326, -15.892344101177176, -22.800883746224184, -10.163577945556174, -2.906021586076471, -40.49787645777747, -46.08662447904452, -40.657454263796886, -14.472810917800103, -23.65267310415181, -4.78789229940541, -33.831727110481836, -22.48523187537921, -20.66709661152833, -27.1979643249592, -19.324159342090816, -28.916080074117644, -21.196902203981104, -14.863378328102389, -38.77767150009893, -22.290662501563386, -36.206658104260654, -39.38253020592189, -37.04186394296338, -12.26227190746288, -38.228947769313336, -37.39903598625557, -22.595363888805466, -23.827061645448666, -29.257178805636695, -32.47227984587261, -17.990242559169218, -38.88793176137072, -14.388113475647042, -12.189340320954171, -16.09450248844668, -27.30415007666989, -4.651596684958845, -22.368637355688804, -47.14892396260449, -26.059736613093854, -29.06074082207232, -12.369031879369182, -48.14549986984745, -19.57449376711235, -45.54115421882559, -17.616067776762478, -38.934191454100926, -11.817632511602202, -26.689952373502173, -25.4576683816755, -36.998606598537485, -41.8550985449683, -30.93149511298115, -40.217083882212044, -18.93702863655472, -24.806466661589965, -18.6205483019365, -15.432217735736842, -42.542114945253935, -19.773997009047687, -24.3770771004147, -39.23868492680648, -25.95972797014575, -11.096831992512714, -10.952019816502082, -39.11668557380115, -28.230244996576953], "policy_predator_policy_reward": [19.498377358259418, 24.73523098101266, 35.993221062583025, 1.975146099434299, 3.480714942849522, 26.461469049636676, 15.88317983608368, 39.04463202246266, 3.296035993961775, 23.561965356985386, 37.56345214223994, 8.849959157137008, 17.312928750341076, 11.690415803366825, 34.428034061312225, 31.116465390324553, 21.83005635193026, 34.568724593846504, 11.49867822838106, 21.08022040436611, 40.97550993788201, 30.231476149368763, 42.55985714685612, 11.90602190990305, 35.66987057577505, 42.21355858707168, 19.3560628603588, 28.18730477031928, 16.727178871140257, 17.185784420450318, 30.00849695118976, 45.628757748282425, 40.28809935478326, 15.892344101177176, 22.800883746224184, 10.163577945556174, 2.906021586076471, 40.49787645777747, 46.08662447904452, 40.657454263796886, 14.472810917800103, 23.65267310415181, 4.78789229940541, 33.831727110481836, 22.48523187537921, 20.66709661152833, 27.1979643249592, 19.324159342090816, 28.916080074117644, 21.196902203981104, 14.863378328102389, 38.77767150009893, 22.290662501563386, 36.206658104260654, 39.38253020592189, 37.04186394296338, 12.26227190746288, 38.228947769313336, 37.39903598625557, 22.595363888805466, 23.827061645448666, 29.257178805636695, 32.47227984587261, 17.990242559169218, 38.88793176137072, 14.388113475647042, 12.189340320954171, 16.09450248844668, 27.30415007666989, 4.651596684958845, 22.368637355688804, 47.14892396260449, 26.059736613093854, 29.06074082207232, 12.369031879369182, 48.14549986984745, 19.57449376711235, 45.54115421882559, 17.616067776762478, 38.934191454100926, 11.817632511602202, 26.689952373502173, 25.4576683816755, 36.998606598537485, 41.8550985449683, 30.93149511298115, 40.217083882212044, 18.93702863655472, 24.806466661589965, 18.6205483019365, 15.432217735736842, 42.542114945253935, 19.773997009047687, 24.3770771004147, 39.23868492680648, 25.95972797014575, 11.096831992512714, 10.952019816502082, 39.11668557380115, 28.230244996576953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2851516666754833, "mean_inference_ms": 0.9489584654879358, "mean_action_processing_ms": 0.1267941343630992, "mean_env_wait_ms": 0.06709116816025008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031327009201049805, "StateBufferConnector_ms": 0.002196192741394043, "ViewRequirementAgentConnector_ms": 0.05108296871185303}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 737.454273984142, "num_env_steps_trained_throughput_per_sec": 737.454273984142, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 5469.886, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5469.853, "sample_time_ms": 650.375, "learn_time_ms": 4806.828, "learn_throughput": 832.15, "synch_weights_time_ms": 12.191}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 134, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-07-09", "timestamp": 1723396029, "time_this_iter_s": 5.429165840148926, "time_total_s": 746.2269511222839, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a78dc040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 746.2269511222839, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 29.185714285714287, "ram_util_percent": 80.35714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1649449784153452, "cur_kl_coeff": 3.155443620884048e-31, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0908884116851065, "policy_loss": 0.0003517466513585532, "vf_loss": 0.0905366653741415, "vf_explained_var": 0.9968016202871998, "kl": 0.001728358564514232, "entropy": 0.06903344710881357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 129120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2436016839618484, "cur_kl_coeff": 4.440892098500627e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08671423302148469, "policy_loss": -0.005134231110423571, "vf_loss": 0.09184846449740386, "vf_explained_var": 0.9967917749037345, "kl": 0.001397455825894826, "entropy": 0.18739046879733604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 129120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -48.14549986984745, "predator_policy": 2.906021586076471}, "policy_reward_max": {"prey_policy": -2.906021586076471, "predator_policy": 48.14549986984745}, "policy_reward_mean": {"prey_policy": -26.381020915299327, "predator_policy": 26.381020915299327}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-23.561965356985386, -37.56345214223994, -8.849959157137008, -17.312928750341076, -11.690415803366825, -34.428034061312225, -31.116465390324553, -21.83005635193026, -34.568724593846504, -11.49867822838106, -21.08022040436611, -40.97550993788201, -30.231476149368763, -42.55985714685612, -11.90602190990305, -35.66987057577505, -42.21355858707168, -19.3560628603588, -28.18730477031928, -16.727178871140257, -17.185784420450318, -30.00849695118976, -45.628757748282425, -40.28809935478326, -15.892344101177176, -22.800883746224184, -10.163577945556174, -2.906021586076471, -40.49787645777747, -46.08662447904452, -40.657454263796886, -14.472810917800103, -23.65267310415181, -4.78789229940541, -33.831727110481836, -22.48523187537921, -20.66709661152833, -27.1979643249592, -19.324159342090816, -28.916080074117644, -21.196902203981104, -14.863378328102389, -38.77767150009893, -22.290662501563386, -36.206658104260654, -39.38253020592189, -37.04186394296338, -12.26227190746288, -38.228947769313336, -37.39903598625557, -22.595363888805466, -23.827061645448666, -29.257178805636695, -32.47227984587261, -17.990242559169218, -38.88793176137072, -14.388113475647042, -12.189340320954171, -16.09450248844668, -27.30415007666989, -4.651596684958845, -22.368637355688804, -47.14892396260449, -26.059736613093854, -29.06074082207232, -12.369031879369182, -48.14549986984745, -19.57449376711235, -45.54115421882559, -17.616067776762478, -38.934191454100926, -11.817632511602202, -26.689952373502173, -25.4576683816755, -36.998606598537485, -41.8550985449683, -30.93149511298115, -40.217083882212044, -18.93702863655472, -24.806466661589965, -18.6205483019365, -15.432217735736842, -42.542114945253935, -19.773997009047687, -24.3770771004147, -39.23868492680648, -25.95972797014575, -11.096831992512714, -10.952019816502082, -39.11668557380115, -28.230244996576953, -21.072507261248337, -23.573895781930034, -39.28261384161102, -23.244733509949924, -8.092116419184828, -35.91782760556152, -24.04624180939871, -19.146188895775072, -37.769323847354634], "policy_predator_policy_reward": [23.561965356985386, 37.56345214223994, 8.849959157137008, 17.312928750341076, 11.690415803366825, 34.428034061312225, 31.116465390324553, 21.83005635193026, 34.568724593846504, 11.49867822838106, 21.08022040436611, 40.97550993788201, 30.231476149368763, 42.55985714685612, 11.90602190990305, 35.66987057577505, 42.21355858707168, 19.3560628603588, 28.18730477031928, 16.727178871140257, 17.185784420450318, 30.00849695118976, 45.628757748282425, 40.28809935478326, 15.892344101177176, 22.800883746224184, 10.163577945556174, 2.906021586076471, 40.49787645777747, 46.08662447904452, 40.657454263796886, 14.472810917800103, 23.65267310415181, 4.78789229940541, 33.831727110481836, 22.48523187537921, 20.66709661152833, 27.1979643249592, 19.324159342090816, 28.916080074117644, 21.196902203981104, 14.863378328102389, 38.77767150009893, 22.290662501563386, 36.206658104260654, 39.38253020592189, 37.04186394296338, 12.26227190746288, 38.228947769313336, 37.39903598625557, 22.595363888805466, 23.827061645448666, 29.257178805636695, 32.47227984587261, 17.990242559169218, 38.88793176137072, 14.388113475647042, 12.189340320954171, 16.09450248844668, 27.30415007666989, 4.651596684958845, 22.368637355688804, 47.14892396260449, 26.059736613093854, 29.06074082207232, 12.369031879369182, 48.14549986984745, 19.57449376711235, 45.54115421882559, 17.616067776762478, 38.934191454100926, 11.817632511602202, 26.689952373502173, 25.4576683816755, 36.998606598537485, 41.8550985449683, 30.93149511298115, 40.217083882212044, 18.93702863655472, 24.806466661589965, 18.6205483019365, 15.432217735736842, 42.542114945253935, 19.773997009047687, 24.3770771004147, 39.23868492680648, 25.95972797014575, 11.096831992512714, 10.952019816502082, 39.11668557380115, 28.230244996576953, 21.072507261248337, 23.573895781930034, 39.28261384161102, 23.244733509949924, 8.092116419184828, 35.91782760556152, 24.04624180939871, 19.146188895775072, 37.769323847354634]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2850977539246533, "mean_inference_ms": 0.9488452551042681, "mean_action_processing_ms": 0.12678508694352766, "mean_env_wait_ms": 0.06706941712924201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002971172332763672, "StateBufferConnector_ms": 0.0026454925537109375, "ViewRequirementAgentConnector_ms": 0.05272650718688965}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 662.4843986281218, "num_env_steps_trained_throughput_per_sec": 662.4843986281218, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 5536.973, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5536.94, "sample_time_ms": 655.674, "learn_time_ms": 4868.589, "learn_throughput": 821.593, "synch_weights_time_ms": 12.215}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 135, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-07-15", "timestamp": 1723396035, "time_this_iter_s": 6.0433189868927, "time_total_s": 752.2702701091766, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f60ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 752.2702701091766, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 35.733333333333334, "ram_util_percent": 81.1888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1260867780540138, "cur_kl_coeff": 1.577721810442024e-31, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06829708901592918, "policy_loss": -0.0012553924340560723, "vf_loss": 0.06955248143349309, "vf_explained_var": 0.9976641340181231, "kl": 0.0012590492311311762, "entropy": 0.06581208565330599, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 130080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0468086595181376, "cur_kl_coeff": 2.2204460492503135e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.047303330156622296, "policy_loss": -0.015865011317509926, "vf_loss": 0.0631683416722808, "vf_explained_var": 0.997593207595249, "kl": 0.0073840497239800644, "entropy": 0.1891655040283998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 130080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -50.03919970517464, "predator_policy": 2.906021586076471}, "policy_reward_max": {"prey_policy": -2.906021586076471, "predator_policy": 50.03919970517464}, "policy_reward_mean": {"prey_policy": -26.53565212481108, "predator_policy": 26.53565212481108}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-11.49867822838106, -21.08022040436611, -40.97550993788201, -30.231476149368763, -42.55985714685612, -11.90602190990305, -35.66987057577505, -42.21355858707168, -19.3560628603588, -28.18730477031928, -16.727178871140257, -17.185784420450318, -30.00849695118976, -45.628757748282425, -40.28809935478326, -15.892344101177176, -22.800883746224184, -10.163577945556174, -2.906021586076471, -40.49787645777747, -46.08662447904452, -40.657454263796886, -14.472810917800103, -23.65267310415181, -4.78789229940541, -33.831727110481836, -22.48523187537921, -20.66709661152833, -27.1979643249592, -19.324159342090816, -28.916080074117644, -21.196902203981104, -14.863378328102389, -38.77767150009893, -22.290662501563386, -36.206658104260654, -39.38253020592189, -37.04186394296338, -12.26227190746288, -38.228947769313336, -37.39903598625557, -22.595363888805466, -23.827061645448666, -29.257178805636695, -32.47227984587261, -17.990242559169218, -38.88793176137072, -14.388113475647042, -12.189340320954171, -16.09450248844668, -27.30415007666989, -4.651596684958845, -22.368637355688804, -47.14892396260449, -26.059736613093854, -29.06074082207232, -12.369031879369182, -48.14549986984745, -19.57449376711235, -45.54115421882559, -17.616067776762478, -38.934191454100926, -11.817632511602202, -26.689952373502173, -25.4576683816755, -36.998606598537485, -41.8550985449683, -30.93149511298115, -40.217083882212044, -18.93702863655472, -24.806466661589965, -18.6205483019365, -15.432217735736842, -42.542114945253935, -19.773997009047687, -24.3770771004147, -39.23868492680648, -25.95972797014575, -11.096831992512714, -10.952019816502082, -39.11668557380115, -28.230244996576953, -21.072507261248337, -23.573895781930034, -39.28261384161102, -23.244733509949924, -8.092116419184828, -35.91782760556152, -24.04624180939871, -19.146188895775072, -37.769323847354634, -18.275490380340685, -40.25505318120454, -6.390881118861785, -35.81089914680477, -36.8762727871254, -29.361064414582852, -50.03919970517464, -14.862136219459684, -4.514125605105068], "policy_predator_policy_reward": [11.49867822838106, 21.08022040436611, 40.97550993788201, 30.231476149368763, 42.55985714685612, 11.90602190990305, 35.66987057577505, 42.21355858707168, 19.3560628603588, 28.18730477031928, 16.727178871140257, 17.185784420450318, 30.00849695118976, 45.628757748282425, 40.28809935478326, 15.892344101177176, 22.800883746224184, 10.163577945556174, 2.906021586076471, 40.49787645777747, 46.08662447904452, 40.657454263796886, 14.472810917800103, 23.65267310415181, 4.78789229940541, 33.831727110481836, 22.48523187537921, 20.66709661152833, 27.1979643249592, 19.324159342090816, 28.916080074117644, 21.196902203981104, 14.863378328102389, 38.77767150009893, 22.290662501563386, 36.206658104260654, 39.38253020592189, 37.04186394296338, 12.26227190746288, 38.228947769313336, 37.39903598625557, 22.595363888805466, 23.827061645448666, 29.257178805636695, 32.47227984587261, 17.990242559169218, 38.88793176137072, 14.388113475647042, 12.189340320954171, 16.09450248844668, 27.30415007666989, 4.651596684958845, 22.368637355688804, 47.14892396260449, 26.059736613093854, 29.06074082207232, 12.369031879369182, 48.14549986984745, 19.57449376711235, 45.54115421882559, 17.616067776762478, 38.934191454100926, 11.817632511602202, 26.689952373502173, 25.4576683816755, 36.998606598537485, 41.8550985449683, 30.93149511298115, 40.217083882212044, 18.93702863655472, 24.806466661589965, 18.6205483019365, 15.432217735736842, 42.542114945253935, 19.773997009047687, 24.3770771004147, 39.23868492680648, 25.95972797014575, 11.096831992512714, 10.952019816502082, 39.11668557380115, 28.230244996576953, 21.072507261248337, 23.573895781930034, 39.28261384161102, 23.244733509949924, 8.092116419184828, 35.91782760556152, 24.04624180939871, 19.146188895775072, 37.769323847354634, 18.275490380340685, 40.25505318120454, 6.390881118861785, 35.81089914680477, 36.8762727871254, 29.361064414582852, 50.03919970517464, 14.862136219459684, 4.514125605105068]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2850283029639761, "mean_inference_ms": 0.9486690122023015, "mean_action_processing_ms": 0.12676977102590697, "mean_env_wait_ms": 0.06704241201285857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002718687057495117, "StateBufferConnector_ms": 0.0026100873947143555, "ViewRequirementAgentConnector_ms": 0.05301010608673096}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 696.6375143170724, "num_env_steps_trained_throughput_per_sec": 696.6375143170724, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 5572.939, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5572.905, "sample_time_ms": 656.024, "learn_time_ms": 4904.252, "learn_throughput": 815.619, "synch_weights_time_ms": 12.205}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 136, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-07-21", "timestamp": 1723396041, "time_this_iter_s": 5.747513055801392, "time_total_s": 758.017783164978, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f60f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 758.017783164978, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 31.525, "ram_util_percent": 81.0125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8813523424789309, "cur_kl_coeff": 7.88860905221012e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.020794248857419005, "policy_loss": -0.0007060288649275511, "vf_loss": 0.021500277333446623, "vf_explained_var": 0.9983865904932221, "kl": 0.0014200296429011901, "entropy": 0.07587285284049965, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 131040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7233387781151881, "cur_kl_coeff": 2.2204460492503135e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.021854369083060494, "policy_loss": -0.009049270381365205, "vf_loss": 0.030903639964041454, "vf_explained_var": 0.9978365467861294, "kl": 0.004205775021760285, "entropy": 0.20274155014194548, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 131040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -50.04877006032447, "predator_policy": 2.906021586076471}, "policy_reward_max": {"prey_policy": -2.906021586076471, "predator_policy": 50.04877006032447}, "policy_reward_mean": {"prey_policy": -26.82111955698784, "predator_policy": 26.82111955698784}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-11.90602190990305, -35.66987057577505, -42.21355858707168, -19.3560628603588, -28.18730477031928, -16.727178871140257, -17.185784420450318, -30.00849695118976, -45.628757748282425, -40.28809935478326, -15.892344101177176, -22.800883746224184, -10.163577945556174, -2.906021586076471, -40.49787645777747, -46.08662447904452, -40.657454263796886, -14.472810917800103, -23.65267310415181, -4.78789229940541, -33.831727110481836, -22.48523187537921, -20.66709661152833, -27.1979643249592, -19.324159342090816, -28.916080074117644, -21.196902203981104, -14.863378328102389, -38.77767150009893, -22.290662501563386, -36.206658104260654, -39.38253020592189, -37.04186394296338, -12.26227190746288, -38.228947769313336, -37.39903598625557, -22.595363888805466, -23.827061645448666, -29.257178805636695, -32.47227984587261, -17.990242559169218, -38.88793176137072, -14.388113475647042, -12.189340320954171, -16.09450248844668, -27.30415007666989, -4.651596684958845, -22.368637355688804, -47.14892396260449, -26.059736613093854, -29.06074082207232, -12.369031879369182, -48.14549986984745, -19.57449376711235, -45.54115421882559, -17.616067776762478, -38.934191454100926, -11.817632511602202, -26.689952373502173, -25.4576683816755, -36.998606598537485, -41.8550985449683, -30.93149511298115, -40.217083882212044, -18.93702863655472, -24.806466661589965, -18.6205483019365, -15.432217735736842, -42.542114945253935, -19.773997009047687, -24.3770771004147, -39.23868492680648, -25.95972797014575, -11.096831992512714, -10.952019816502082, -39.11668557380115, -28.230244996576953, -21.072507261248337, -23.573895781930034, -39.28261384161102, -23.244733509949924, -8.092116419184828, -35.91782760556152, -24.04624180939871, -19.146188895775072, -37.769323847354634, -18.275490380340685, -40.25505318120454, -6.390881118861785, -35.81089914680477, -36.8762727871254, -29.361064414582852, -50.03919970517464, -14.862136219459684, -4.514125605105068, -50.04877006032447, -41.32174970144948, -36.672346156398845, -28.587434529343053, -18.262184637014045], "policy_predator_policy_reward": [11.90602190990305, 35.66987057577505, 42.21355858707168, 19.3560628603588, 28.18730477031928, 16.727178871140257, 17.185784420450318, 30.00849695118976, 45.628757748282425, 40.28809935478326, 15.892344101177176, 22.800883746224184, 10.163577945556174, 2.906021586076471, 40.49787645777747, 46.08662447904452, 40.657454263796886, 14.472810917800103, 23.65267310415181, 4.78789229940541, 33.831727110481836, 22.48523187537921, 20.66709661152833, 27.1979643249592, 19.324159342090816, 28.916080074117644, 21.196902203981104, 14.863378328102389, 38.77767150009893, 22.290662501563386, 36.206658104260654, 39.38253020592189, 37.04186394296338, 12.26227190746288, 38.228947769313336, 37.39903598625557, 22.595363888805466, 23.827061645448666, 29.257178805636695, 32.47227984587261, 17.990242559169218, 38.88793176137072, 14.388113475647042, 12.189340320954171, 16.09450248844668, 27.30415007666989, 4.651596684958845, 22.368637355688804, 47.14892396260449, 26.059736613093854, 29.06074082207232, 12.369031879369182, 48.14549986984745, 19.57449376711235, 45.54115421882559, 17.616067776762478, 38.934191454100926, 11.817632511602202, 26.689952373502173, 25.4576683816755, 36.998606598537485, 41.8550985449683, 30.93149511298115, 40.217083882212044, 18.93702863655472, 24.806466661589965, 18.6205483019365, 15.432217735736842, 42.542114945253935, 19.773997009047687, 24.3770771004147, 39.23868492680648, 25.95972797014575, 11.096831992512714, 10.952019816502082, 39.11668557380115, 28.230244996576953, 21.072507261248337, 23.573895781930034, 39.28261384161102, 23.244733509949924, 8.092116419184828, 35.91782760556152, 24.04624180939871, 19.146188895775072, 37.769323847354634, 18.275490380340685, 40.25505318120454, 6.390881118861785, 35.81089914680477, 36.8762727871254, 29.361064414582852, 50.03919970517464, 14.862136219459684, 4.514125605105068, 50.04877006032447, 41.32174970144948, 36.672346156398845, 28.587434529343053, 18.262184637014045]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2850605576834973, "mean_inference_ms": 0.9485054129777514, "mean_action_processing_ms": 0.12677011780336872, "mean_env_wait_ms": 0.0670251167681438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026121139526367188, "StateBufferConnector_ms": 0.0026001930236816406, "ViewRequirementAgentConnector_ms": 0.05254554748535156}, "num_episodes": 5, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 644.9402347187805, "num_env_steps_trained_throughput_per_sec": 644.9402347187805, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 1096000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1096000, "timers": {"training_iteration_time_ms": 5636.897, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5636.861, "sample_time_ms": 659.827, "learn_time_ms": 4964.243, "learn_throughput": 805.762, "synch_weights_time_ms": 12.365}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000}, "done": false, "training_iteration": 137, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-07-27", "timestamp": 1723396047, "time_this_iter_s": 6.209496974945068, "time_total_s": 764.2272801399231, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2ddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 764.2272801399231, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 37.25555555555556, "ram_util_percent": 81.5111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3967765524983407, "cur_kl_coeff": 3.94430452610506e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.13814349727084238, "policy_loss": -0.0008196632889545678, "vf_loss": 0.13896316075115464, "vf_explained_var": 0.9943038347487648, "kl": 0.0005855550980477038, "entropy": 0.08408909783853839, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.176324924438571, "cur_kl_coeff": 1.1102230246251568e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.13157030584285773, "policy_loss": -0.013422510275874325, "vf_loss": 0.14499281693715602, "vf_explained_var": 0.9940930360307296, "kl": 0.006467161424984474, "entropy": 0.19677008704748006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -50.04877006032447, "predator_policy": 2.906021586076471}, "policy_reward_max": {"prey_policy": -2.906021586076471, "predator_policy": 50.04877006032447}, "policy_reward_mean": {"prey_policy": -26.46766880621669, "predator_policy": 26.46766880621669}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-40.28809935478326, -15.892344101177176, -22.800883746224184, -10.163577945556174, -2.906021586076471, -40.49787645777747, -46.08662447904452, -40.657454263796886, -14.472810917800103, -23.65267310415181, -4.78789229940541, -33.831727110481836, -22.48523187537921, -20.66709661152833, -27.1979643249592, -19.324159342090816, -28.916080074117644, -21.196902203981104, -14.863378328102389, -38.77767150009893, -22.290662501563386, -36.206658104260654, -39.38253020592189, -37.04186394296338, -12.26227190746288, -38.228947769313336, -37.39903598625557, -22.595363888805466, -23.827061645448666, -29.257178805636695, -32.47227984587261, -17.990242559169218, -38.88793176137072, -14.388113475647042, -12.189340320954171, -16.09450248844668, -27.30415007666989, -4.651596684958845, -22.368637355688804, -47.14892396260449, -26.059736613093854, -29.06074082207232, -12.369031879369182, -48.14549986984745, -19.57449376711235, -45.54115421882559, -17.616067776762478, -38.934191454100926, -11.817632511602202, -26.689952373502173, -25.4576683816755, -36.998606598537485, -41.8550985449683, -30.93149511298115, -40.217083882212044, -18.93702863655472, -24.806466661589965, -18.6205483019365, -15.432217735736842, -42.542114945253935, -19.773997009047687, -24.3770771004147, -39.23868492680648, -25.95972797014575, -11.096831992512714, -10.952019816502082, -39.11668557380115, -28.230244996576953, -21.072507261248337, -23.573895781930034, -39.28261384161102, -23.244733509949924, -8.092116419184828, -35.91782760556152, -24.04624180939871, -19.146188895775072, -37.769323847354634, -18.275490380340685, -40.25505318120454, -6.390881118861785, -35.81089914680477, -36.8762727871254, -29.361064414582852, -50.03919970517464, -14.862136219459684, -4.514125605105068, -50.04877006032447, -41.32174970144948, -36.672346156398845, -28.587434529343053, -18.262184637014045, -7.3692245748333, -40.633007036988225, -4.968065518874046, -21.886364685491905, -26.565086867830313, -21.06560255193532, -8.423341674796198, -43.139348640037795, -37.48792006658846], "policy_predator_policy_reward": [40.28809935478326, 15.892344101177176, 22.800883746224184, 10.163577945556174, 2.906021586076471, 40.49787645777747, 46.08662447904452, 40.657454263796886, 14.472810917800103, 23.65267310415181, 4.78789229940541, 33.831727110481836, 22.48523187537921, 20.66709661152833, 27.1979643249592, 19.324159342090816, 28.916080074117644, 21.196902203981104, 14.863378328102389, 38.77767150009893, 22.290662501563386, 36.206658104260654, 39.38253020592189, 37.04186394296338, 12.26227190746288, 38.228947769313336, 37.39903598625557, 22.595363888805466, 23.827061645448666, 29.257178805636695, 32.47227984587261, 17.990242559169218, 38.88793176137072, 14.388113475647042, 12.189340320954171, 16.09450248844668, 27.30415007666989, 4.651596684958845, 22.368637355688804, 47.14892396260449, 26.059736613093854, 29.06074082207232, 12.369031879369182, 48.14549986984745, 19.57449376711235, 45.54115421882559, 17.616067776762478, 38.934191454100926, 11.817632511602202, 26.689952373502173, 25.4576683816755, 36.998606598537485, 41.8550985449683, 30.93149511298115, 40.217083882212044, 18.93702863655472, 24.806466661589965, 18.6205483019365, 15.432217735736842, 42.542114945253935, 19.773997009047687, 24.3770771004147, 39.23868492680648, 25.95972797014575, 11.096831992512714, 10.952019816502082, 39.11668557380115, 28.230244996576953, 21.072507261248337, 23.573895781930034, 39.28261384161102, 23.244733509949924, 8.092116419184828, 35.91782760556152, 24.04624180939871, 19.146188895775072, 37.769323847354634, 18.275490380340685, 40.25505318120454, 6.390881118861785, 35.81089914680477, 36.8762727871254, 29.361064414582852, 50.03919970517464, 14.862136219459684, 4.514125605105068, 50.04877006032447, 41.32174970144948, 36.672346156398845, 28.587434529343053, 18.262184637014045, 7.3692245748333, 40.633007036988225, 4.968065518874046, 21.886364685491905, 26.565086867830313, 21.06560255193532, 8.423341674796198, 43.139348640037795, 37.48792006658846]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28496230877161743, "mean_inference_ms": 0.9481854618560726, "mean_action_processing_ms": 0.12673336301501856, "mean_env_wait_ms": 0.06699074357432513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025938749313354492, "StateBufferConnector_ms": 0.0026084184646606445, "ViewRequirementAgentConnector_ms": 0.05274820327758789}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 656.6969169226272, "num_env_steps_trained_throughput_per_sec": 656.6969169226272, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 5665.57, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5665.528, "sample_time_ms": 663.339, "learn_time_ms": 4988.572, "learn_throughput": 801.833, "synch_weights_time_ms": 13.111}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 138, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-07-33", "timestamp": 1723396053, "time_this_iter_s": 6.1023218631744385, "time_total_s": 770.3296020030975, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f60550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 770.3296020030975, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 38.65555555555555, "ram_util_percent": 81.81111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0650522513159861, "cur_kl_coeff": 1.97215226305253e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06939829806409155, "policy_loss": -0.0013344544505040782, "vf_loss": 0.07073275248306649, "vf_explained_var": 0.9950231570750475, "kl": 0.001408580922113938, "entropy": 0.07986756655445788, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0802675552510967, "cur_kl_coeff": 1.1102230246251568e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07298578528134385, "policy_loss": -0.004099925761208093, "vf_loss": 0.07708571144151695, "vf_explained_var": 0.9944289916505417, "kl": 0.0028200937410627386, "entropy": 0.191456796710069, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -52.25769049359588, "predator_policy": 4.514125605105068}, "policy_reward_max": {"prey_policy": -4.514125605105068, "predator_policy": 52.25769049359588}, "policy_reward_mean": {"prey_policy": -26.38729953096487, "predator_policy": 26.38729953096487}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-23.65267310415181, -4.78789229940541, -33.831727110481836, -22.48523187537921, -20.66709661152833, -27.1979643249592, -19.324159342090816, -28.916080074117644, -21.196902203981104, -14.863378328102389, -38.77767150009893, -22.290662501563386, -36.206658104260654, -39.38253020592189, -37.04186394296338, -12.26227190746288, -38.228947769313336, -37.39903598625557, -22.595363888805466, -23.827061645448666, -29.257178805636695, -32.47227984587261, -17.990242559169218, -38.88793176137072, -14.388113475647042, -12.189340320954171, -16.09450248844668, -27.30415007666989, -4.651596684958845, -22.368637355688804, -47.14892396260449, -26.059736613093854, -29.06074082207232, -12.369031879369182, -48.14549986984745, -19.57449376711235, -45.54115421882559, -17.616067776762478, -38.934191454100926, -11.817632511602202, -26.689952373502173, -25.4576683816755, -36.998606598537485, -41.8550985449683, -30.93149511298115, -40.217083882212044, -18.93702863655472, -24.806466661589965, -18.6205483019365, -15.432217735736842, -42.542114945253935, -19.773997009047687, -24.3770771004147, -39.23868492680648, -25.95972797014575, -11.096831992512714, -10.952019816502082, -39.11668557380115, -28.230244996576953, -21.072507261248337, -23.573895781930034, -39.28261384161102, -23.244733509949924, -8.092116419184828, -35.91782760556152, -24.04624180939871, -19.146188895775072, -37.769323847354634, -18.275490380340685, -40.25505318120454, -6.390881118861785, -35.81089914680477, -36.8762727871254, -29.361064414582852, -50.03919970517464, -14.862136219459684, -4.514125605105068, -50.04877006032447, -41.32174970144948, -36.672346156398845, -28.587434529343053, -18.262184637014045, -7.3692245748333, -40.633007036988225, -4.968065518874046, -21.886364685491905, -26.565086867830313, -21.06560255193532, -8.423341674796198, -43.139348640037795, -37.48792006658846, -13.491955660052383, -24.256353191526422, -19.9801712820016, -52.25769049359588, -31.027157738412352, -8.3836372299131, -27.951444441338307, -15.218312284835466, -33.162043005379005], "policy_predator_policy_reward": [23.65267310415181, 4.78789229940541, 33.831727110481836, 22.48523187537921, 20.66709661152833, 27.1979643249592, 19.324159342090816, 28.916080074117644, 21.196902203981104, 14.863378328102389, 38.77767150009893, 22.290662501563386, 36.206658104260654, 39.38253020592189, 37.04186394296338, 12.26227190746288, 38.228947769313336, 37.39903598625557, 22.595363888805466, 23.827061645448666, 29.257178805636695, 32.47227984587261, 17.990242559169218, 38.88793176137072, 14.388113475647042, 12.189340320954171, 16.09450248844668, 27.30415007666989, 4.651596684958845, 22.368637355688804, 47.14892396260449, 26.059736613093854, 29.06074082207232, 12.369031879369182, 48.14549986984745, 19.57449376711235, 45.54115421882559, 17.616067776762478, 38.934191454100926, 11.817632511602202, 26.689952373502173, 25.4576683816755, 36.998606598537485, 41.8550985449683, 30.93149511298115, 40.217083882212044, 18.93702863655472, 24.806466661589965, 18.6205483019365, 15.432217735736842, 42.542114945253935, 19.773997009047687, 24.3770771004147, 39.23868492680648, 25.95972797014575, 11.096831992512714, 10.952019816502082, 39.11668557380115, 28.230244996576953, 21.072507261248337, 23.573895781930034, 39.28261384161102, 23.244733509949924, 8.092116419184828, 35.91782760556152, 24.04624180939871, 19.146188895775072, 37.769323847354634, 18.275490380340685, 40.25505318120454, 6.390881118861785, 35.81089914680477, 36.8762727871254, 29.361064414582852, 50.03919970517464, 14.862136219459684, 4.514125605105068, 50.04877006032447, 41.32174970144948, 36.672346156398845, 28.587434529343053, 18.262184637014045, 7.3692245748333, 40.633007036988225, 4.968065518874046, 21.886364685491905, 26.565086867830313, 21.06560255193532, 8.423341674796198, 43.139348640037795, 37.48792006658846, 13.491955660052383, 24.256353191526422, 19.9801712820016, 52.25769049359588, 31.027157738412352, 8.3836372299131, 27.951444441338307, 15.218312284835466, 33.162043005379005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.285161029347042, "mean_inference_ms": 0.9483403135798519, "mean_action_processing_ms": 0.12670866142745982, "mean_env_wait_ms": 0.06699908026364176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026930570602416992, "StateBufferConnector_ms": 0.0026928186416625977, "ViewRequirementAgentConnector_ms": 0.05515706539154053}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 660.2720630629035, "num_env_steps_trained_throughput_per_sec": 660.2720630629035, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 1112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1112000, "timers": {"training_iteration_time_ms": 5725.38, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5725.337, "sample_time_ms": 681.315, "learn_time_ms": 5030.567, "learn_throughput": 795.139, "synch_weights_time_ms": 12.95}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000}, "done": false, "training_iteration": 139, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-07-39", "timestamp": 1723396059, "time_this_iter_s": 6.063057899475098, "time_total_s": 776.3926599025726, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2df70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 776.3926599025726, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 39.125, "ram_util_percent": 82.0375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9175395103481908, "cur_kl_coeff": 9.86076131526265e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03831774019466441, "policy_loss": -0.0021201225727660736, "vf_loss": 0.04043786261900095, "vf_explained_var": 0.9982244068756699, "kl": 0.0027199079025848802, "entropy": 0.06561491233878769, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 133920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9386052032001316, "cur_kl_coeff": 5.551115123125784e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.025892934975854588, "policy_loss": -0.009355063577822875, "vf_loss": 0.03524799805115132, "vf_explained_var": 0.998505322324733, "kl": 0.004555498272523243, "entropy": 0.16494938950830448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 133920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -52.25769049359588, "predator_policy": 2.7718224710625288}, "policy_reward_max": {"prey_policy": -2.7718224710625288, "predator_policy": 52.25769049359588}, "policy_reward_mean": {"prey_policy": -25.96923688730037, "predator_policy": 25.96923688730037}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-14.863378328102389, -38.77767150009893, -22.290662501563386, -36.206658104260654, -39.38253020592189, -37.04186394296338, -12.26227190746288, -38.228947769313336, -37.39903598625557, -22.595363888805466, -23.827061645448666, -29.257178805636695, -32.47227984587261, -17.990242559169218, -38.88793176137072, -14.388113475647042, -12.189340320954171, -16.09450248844668, -27.30415007666989, -4.651596684958845, -22.368637355688804, -47.14892396260449, -26.059736613093854, -29.06074082207232, -12.369031879369182, -48.14549986984745, -19.57449376711235, -45.54115421882559, -17.616067776762478, -38.934191454100926, -11.817632511602202, -26.689952373502173, -25.4576683816755, -36.998606598537485, -41.8550985449683, -30.93149511298115, -40.217083882212044, -18.93702863655472, -24.806466661589965, -18.6205483019365, -15.432217735736842, -42.542114945253935, -19.773997009047687, -24.3770771004147, -39.23868492680648, -25.95972797014575, -11.096831992512714, -10.952019816502082, -39.11668557380115, -28.230244996576953, -21.072507261248337, -23.573895781930034, -39.28261384161102, -23.244733509949924, -8.092116419184828, -35.91782760556152, -24.04624180939871, -19.146188895775072, -37.769323847354634, -18.275490380340685, -40.25505318120454, -6.390881118861785, -35.81089914680477, -36.8762727871254, -29.361064414582852, -50.03919970517464, -14.862136219459684, -4.514125605105068, -50.04877006032447, -41.32174970144948, -36.672346156398845, -28.587434529343053, -18.262184637014045, -7.3692245748333, -40.633007036988225, -4.968065518874046, -21.886364685491905, -26.565086867830313, -21.06560255193532, -8.423341674796198, -43.139348640037795, -37.48792006658846, -13.491955660052383, -24.256353191526422, -19.9801712820016, -52.25769049359588, -31.027157738412352, -8.3836372299131, -27.951444441338307, -15.218312284835466, -33.162043005379005, -25.052893989296727, -2.7718224710625288, -12.58714026927753, -9.2712293327786, -17.325055492586866, -22.922779600755096, -13.435888539557709, -35.145168291282275, -21.74148459304818], "policy_predator_policy_reward": [14.863378328102389, 38.77767150009893, 22.290662501563386, 36.206658104260654, 39.38253020592189, 37.04186394296338, 12.26227190746288, 38.228947769313336, 37.39903598625557, 22.595363888805466, 23.827061645448666, 29.257178805636695, 32.47227984587261, 17.990242559169218, 38.88793176137072, 14.388113475647042, 12.189340320954171, 16.09450248844668, 27.30415007666989, 4.651596684958845, 22.368637355688804, 47.14892396260449, 26.059736613093854, 29.06074082207232, 12.369031879369182, 48.14549986984745, 19.57449376711235, 45.54115421882559, 17.616067776762478, 38.934191454100926, 11.817632511602202, 26.689952373502173, 25.4576683816755, 36.998606598537485, 41.8550985449683, 30.93149511298115, 40.217083882212044, 18.93702863655472, 24.806466661589965, 18.6205483019365, 15.432217735736842, 42.542114945253935, 19.773997009047687, 24.3770771004147, 39.23868492680648, 25.95972797014575, 11.096831992512714, 10.952019816502082, 39.11668557380115, 28.230244996576953, 21.072507261248337, 23.573895781930034, 39.28261384161102, 23.244733509949924, 8.092116419184828, 35.91782760556152, 24.04624180939871, 19.146188895775072, 37.769323847354634, 18.275490380340685, 40.25505318120454, 6.390881118861785, 35.81089914680477, 36.8762727871254, 29.361064414582852, 50.03919970517464, 14.862136219459684, 4.514125605105068, 50.04877006032447, 41.32174970144948, 36.672346156398845, 28.587434529343053, 18.262184637014045, 7.3692245748333, 40.633007036988225, 4.968065518874046, 21.886364685491905, 26.565086867830313, 21.06560255193532, 8.423341674796198, 43.139348640037795, 37.48792006658846, 13.491955660052383, 24.256353191526422, 19.9801712820016, 52.25769049359588, 31.027157738412352, 8.3836372299131, 27.951444441338307, 15.218312284835466, 33.162043005379005, 25.052893989296727, 2.7718224710625288, 12.58714026927753, 9.2712293327786, 17.325055492586866, 22.922779600755096, 13.435888539557709, 35.145168291282275, 21.74148459304818]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28494821558469335, "mean_inference_ms": 0.9482009276967486, "mean_action_processing_ms": 0.126726154026279, "mean_env_wait_ms": 0.06696961071102223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002677440643310547, "StateBufferConnector_ms": 0.0026847124099731445, "ViewRequirementAgentConnector_ms": 0.05465257167816162}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 735.4264524277221, "num_env_steps_trained_throughput_per_sec": 735.4264524277221, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 5729.266, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5729.223, "sample_time_ms": 685.112, "learn_time_ms": 5030.737, "learn_throughput": 795.112, "synch_weights_time_ms": 12.872}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 140, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-07-45", "timestamp": 1723396065, "time_this_iter_s": 5.443893194198608, "time_total_s": 781.8365530967712, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9ed1ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 781.8365530967712, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 28.187499999999996, "ram_util_percent": 81.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0226520504336805, "cur_kl_coeff": 4.930380657631325e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05014149129395567, "policy_loss": -0.0015896812891393588, "vf_loss": 0.05173117258527782, "vf_explained_var": 0.9978153729190429, "kl": 0.0013076185802263181, "entropy": 0.09936237611109391, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 134880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0570692756368467, "cur_kl_coeff": 2.775557561562892e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04433250226890474, "policy_loss": -0.006628569080203306, "vf_loss": 0.050961071432296494, "vf_explained_var": 0.9976415699968736, "kl": 0.0036553382454628195, "entropy": 0.19481129336636513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 134880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -52.25769049359588, "predator_policy": 2.7718224710625288}, "policy_reward_max": {"prey_policy": -2.7718224710625288, "predator_policy": 52.25769049359588}, "policy_reward_mean": {"prey_policy": -25.386869659269543, "predator_policy": 25.386869659269543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-22.595363888805466, -23.827061645448666, -29.257178805636695, -32.47227984587261, -17.990242559169218, -38.88793176137072, -14.388113475647042, -12.189340320954171, -16.09450248844668, -27.30415007666989, -4.651596684958845, -22.368637355688804, -47.14892396260449, -26.059736613093854, -29.06074082207232, -12.369031879369182, -48.14549986984745, -19.57449376711235, -45.54115421882559, -17.616067776762478, -38.934191454100926, -11.817632511602202, -26.689952373502173, -25.4576683816755, -36.998606598537485, -41.8550985449683, -30.93149511298115, -40.217083882212044, -18.93702863655472, -24.806466661589965, -18.6205483019365, -15.432217735736842, -42.542114945253935, -19.773997009047687, -24.3770771004147, -39.23868492680648, -25.95972797014575, -11.096831992512714, -10.952019816502082, -39.11668557380115, -28.230244996576953, -21.072507261248337, -23.573895781930034, -39.28261384161102, -23.244733509949924, -8.092116419184828, -35.91782760556152, -24.04624180939871, -19.146188895775072, -37.769323847354634, -18.275490380340685, -40.25505318120454, -6.390881118861785, -35.81089914680477, -36.8762727871254, -29.361064414582852, -50.03919970517464, -14.862136219459684, -4.514125605105068, -50.04877006032447, -41.32174970144948, -36.672346156398845, -28.587434529343053, -18.262184637014045, -7.3692245748333, -40.633007036988225, -4.968065518874046, -21.886364685491905, -26.565086867830313, -21.06560255193532, -8.423341674796198, -43.139348640037795, -37.48792006658846, -13.491955660052383, -24.256353191526422, -19.9801712820016, -52.25769049359588, -31.027157738412352, -8.3836372299131, -27.951444441338307, -15.218312284835466, -33.162043005379005, -25.052893989296727, -2.7718224710625288, -12.58714026927753, -9.2712293327786, -17.325055492586866, -22.922779600755096, -13.435888539557709, -35.145168291282275, -21.74148459304818, -14.939812401964284, -42.96810556848761, -19.17160879767195, -41.24726489669686, -24.86665196416676, -6.691134386963676, -26.6304431502907, -3.19092153675963, -38.510354739857696], "policy_predator_policy_reward": [22.595363888805466, 23.827061645448666, 29.257178805636695, 32.47227984587261, 17.990242559169218, 38.88793176137072, 14.388113475647042, 12.189340320954171, 16.09450248844668, 27.30415007666989, 4.651596684958845, 22.368637355688804, 47.14892396260449, 26.059736613093854, 29.06074082207232, 12.369031879369182, 48.14549986984745, 19.57449376711235, 45.54115421882559, 17.616067776762478, 38.934191454100926, 11.817632511602202, 26.689952373502173, 25.4576683816755, 36.998606598537485, 41.8550985449683, 30.93149511298115, 40.217083882212044, 18.93702863655472, 24.806466661589965, 18.6205483019365, 15.432217735736842, 42.542114945253935, 19.773997009047687, 24.3770771004147, 39.23868492680648, 25.95972797014575, 11.096831992512714, 10.952019816502082, 39.11668557380115, 28.230244996576953, 21.072507261248337, 23.573895781930034, 39.28261384161102, 23.244733509949924, 8.092116419184828, 35.91782760556152, 24.04624180939871, 19.146188895775072, 37.769323847354634, 18.275490380340685, 40.25505318120454, 6.390881118861785, 35.81089914680477, 36.8762727871254, 29.361064414582852, 50.03919970517464, 14.862136219459684, 4.514125605105068, 50.04877006032447, 41.32174970144948, 36.672346156398845, 28.587434529343053, 18.262184637014045, 7.3692245748333, 40.633007036988225, 4.968065518874046, 21.886364685491905, 26.565086867830313, 21.06560255193532, 8.423341674796198, 43.139348640037795, 37.48792006658846, 13.491955660052383, 24.256353191526422, 19.9801712820016, 52.25769049359588, 31.027157738412352, 8.3836372299131, 27.951444441338307, 15.218312284835466, 33.162043005379005, 25.052893989296727, 2.7718224710625288, 12.58714026927753, 9.2712293327786, 17.325055492586866, 22.922779600755096, 13.435888539557709, 35.145168291282275, 21.74148459304818, 14.939812401964284, 42.96810556848761, 19.17160879767195, 41.24726489669686, 24.86665196416676, 6.691134386963676, 26.6304431502907, 3.19092153675963, 38.510354739857696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2849434044315553, "mean_inference_ms": 0.9481540018332018, "mean_action_processing_ms": 0.1267151200435339, "mean_env_wait_ms": 0.06694977069280204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003412008285522461, "StateBufferConnector_ms": 0.0026777982711791992, "ViewRequirementAgentConnector_ms": 0.052056193351745605}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 708.901982136593, "num_env_steps_trained_throughput_per_sec": 708.901982136593, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 1128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 5762.284, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5762.241, "sample_time_ms": 692.966, "learn_time_ms": 5055.936, "learn_throughput": 791.149, "synch_weights_time_ms": 12.84}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "training_iteration": 141, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-07-50", "timestamp": 1723396070, "time_this_iter_s": 5.647239923477173, "time_total_s": 787.4837930202484, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f60550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 787.4837930202484, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 31.137499999999996, "ram_util_percent": 82.0125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7972746414598078, "cur_kl_coeff": 2.4651903288156624e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03949828872717565, "policy_loss": -0.0006293985212929935, "vf_loss": 0.04012768741473944, "vf_explained_var": 0.9986708870157599, "kl": 0.0037120456964589038, "entropy": 0.10264809841464739, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 135840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.010576971170182, "cur_kl_coeff": 1.387778780781446e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04785826236535892, "policy_loss": -0.007332108673169083, "vf_loss": 0.05519037157937419, "vf_explained_var": 0.9979067786286274, "kl": 0.0019662386359544353, "entropy": 0.20562245764303952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 135840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -52.25769049359588, "predator_policy": 2.7718224710625288}, "policy_reward_max": {"prey_policy": -2.7718224710625288, "predator_policy": 52.25769049359588}, "policy_reward_mean": {"prey_policy": -25.525476128776376, "predator_policy": 25.525476128776376}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-27.30415007666989, -4.651596684958845, -22.368637355688804, -47.14892396260449, -26.059736613093854, -29.06074082207232, -12.369031879369182, -48.14549986984745, -19.57449376711235, -45.54115421882559, -17.616067776762478, -38.934191454100926, -11.817632511602202, -26.689952373502173, -25.4576683816755, -36.998606598537485, -41.8550985449683, -30.93149511298115, -40.217083882212044, -18.93702863655472, -24.806466661589965, -18.6205483019365, -15.432217735736842, -42.542114945253935, -19.773997009047687, -24.3770771004147, -39.23868492680648, -25.95972797014575, -11.096831992512714, -10.952019816502082, -39.11668557380115, -28.230244996576953, -21.072507261248337, -23.573895781930034, -39.28261384161102, -23.244733509949924, -8.092116419184828, -35.91782760556152, -24.04624180939871, -19.146188895775072, -37.769323847354634, -18.275490380340685, -40.25505318120454, -6.390881118861785, -35.81089914680477, -36.8762727871254, -29.361064414582852, -50.03919970517464, -14.862136219459684, -4.514125605105068, -50.04877006032447, -41.32174970144948, -36.672346156398845, -28.587434529343053, -18.262184637014045, -7.3692245748333, -40.633007036988225, -4.968065518874046, -21.886364685491905, -26.565086867830313, -21.06560255193532, -8.423341674796198, -43.139348640037795, -37.48792006658846, -13.491955660052383, -24.256353191526422, -19.9801712820016, -52.25769049359588, -31.027157738412352, -8.3836372299131, -27.951444441338307, -15.218312284835466, -33.162043005379005, -25.052893989296727, -2.7718224710625288, -12.58714026927753, -9.2712293327786, -17.325055492586866, -22.922779600755096, -13.435888539557709, -35.145168291282275, -21.74148459304818, -14.939812401964284, -42.96810556848761, -19.17160879767195, -41.24726489669686, -24.86665196416676, -6.691134386963676, -26.6304431502907, -3.19092153675963, -38.510354739857696, -18.60301758543742, -12.190953944634929, -47.85274726694621, -30.011763621623206, -16.91697968803289, -16.903395280137268, -48.26434729580028, -13.224832514924763, -17.594624544497535], "policy_predator_policy_reward": [27.30415007666989, 4.651596684958845, 22.368637355688804, 47.14892396260449, 26.059736613093854, 29.06074082207232, 12.369031879369182, 48.14549986984745, 19.57449376711235, 45.54115421882559, 17.616067776762478, 38.934191454100926, 11.817632511602202, 26.689952373502173, 25.4576683816755, 36.998606598537485, 41.8550985449683, 30.93149511298115, 40.217083882212044, 18.93702863655472, 24.806466661589965, 18.6205483019365, 15.432217735736842, 42.542114945253935, 19.773997009047687, 24.3770771004147, 39.23868492680648, 25.95972797014575, 11.096831992512714, 10.952019816502082, 39.11668557380115, 28.230244996576953, 21.072507261248337, 23.573895781930034, 39.28261384161102, 23.244733509949924, 8.092116419184828, 35.91782760556152, 24.04624180939871, 19.146188895775072, 37.769323847354634, 18.275490380340685, 40.25505318120454, 6.390881118861785, 35.81089914680477, 36.8762727871254, 29.361064414582852, 50.03919970517464, 14.862136219459684, 4.514125605105068, 50.04877006032447, 41.32174970144948, 36.672346156398845, 28.587434529343053, 18.262184637014045, 7.3692245748333, 40.633007036988225, 4.968065518874046, 21.886364685491905, 26.565086867830313, 21.06560255193532, 8.423341674796198, 43.139348640037795, 37.48792006658846, 13.491955660052383, 24.256353191526422, 19.9801712820016, 52.25769049359588, 31.027157738412352, 8.3836372299131, 27.951444441338307, 15.218312284835466, 33.162043005379005, 25.052893989296727, 2.7718224710625288, 12.58714026927753, 9.2712293327786, 17.325055492586866, 22.922779600755096, 13.435888539557709, 35.145168291282275, 21.74148459304818, 14.939812401964284, 42.96810556848761, 19.17160879767195, 41.24726489669686, 24.86665196416676, 6.691134386963676, 26.6304431502907, 3.19092153675963, 38.510354739857696, 18.60301758543742, 12.190953944634929, 47.85274726694621, 30.011763621623206, 16.91697968803289, 16.903395280137268, 48.26434729580028, 13.224832514924763, 17.594624544497535]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2850140438333929, "mean_inference_ms": 0.9484495822868969, "mean_action_processing_ms": 0.1267363103509499, "mean_env_wait_ms": 0.06696049566277881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035386085510253906, "StateBufferConnector_ms": 0.0029315948486328125, "ViewRequirementAgentConnector_ms": 0.0539860725402832}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 651.2798841694015, "num_env_steps_trained_throughput_per_sec": 651.2798841694015, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 5820.109, "restore_workers_time_ms": 0.015, "training_step_time_ms": 5820.067, "sample_time_ms": 738.244, "learn_time_ms": 5068.088, "learn_throughput": 789.252, "synch_weights_time_ms": 13.279}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 142, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-07-57", "timestamp": 1723396077, "time_this_iter_s": 6.146306753158569, "time_total_s": 793.630099773407, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f2fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 793.630099773407, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 37.15555555555555, "ram_util_percent": 81.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0592307899923374, "cur_kl_coeff": 1.2325951644078312e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.060860741446958855, "policy_loss": -0.0008881691964537215, "vf_loss": 0.06174891105135127, "vf_explained_var": 0.9956564572950204, "kl": 0.001423553400328274, "entropy": 0.07552726688445546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 136800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0193490052750955, "cur_kl_coeff": 6.93889390390723e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06555638188438025, "policy_loss": -0.002640160512722408, "vf_loss": 0.06819654269008121, "vf_explained_var": 0.9949607505152623, "kl": 0.002572033205969883, "entropy": 0.16085158055648208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 136800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -52.25769049359588, "predator_policy": 2.7718224710625288}, "policy_reward_max": {"prey_policy": -2.7718224710625288, "predator_policy": 52.25769049359588}, "policy_reward_mean": {"prey_policy": -25.563630656319116, "predator_policy": 25.563630656319116}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-26.059736613093854, -29.06074082207232, -12.369031879369182, -48.14549986984745, -19.57449376711235, -45.54115421882559, -17.616067776762478, -38.934191454100926, -11.817632511602202, -26.689952373502173, -25.4576683816755, -36.998606598537485, -41.8550985449683, -30.93149511298115, -40.217083882212044, -18.93702863655472, -24.806466661589965, -18.6205483019365, -15.432217735736842, -42.542114945253935, -19.773997009047687, -24.3770771004147, -39.23868492680648, -25.95972797014575, -11.096831992512714, -10.952019816502082, -39.11668557380115, -28.230244996576953, -21.072507261248337, -23.573895781930034, -39.28261384161102, -23.244733509949924, -8.092116419184828, -35.91782760556152, -24.04624180939871, -19.146188895775072, -37.769323847354634, -18.275490380340685, -40.25505318120454, -6.390881118861785, -35.81089914680477, -36.8762727871254, -29.361064414582852, -50.03919970517464, -14.862136219459684, -4.514125605105068, -50.04877006032447, -41.32174970144948, -36.672346156398845, -28.587434529343053, -18.262184637014045, -7.3692245748333, -40.633007036988225, -4.968065518874046, -21.886364685491905, -26.565086867830313, -21.06560255193532, -8.423341674796198, -43.139348640037795, -37.48792006658846, -13.491955660052383, -24.256353191526422, -19.9801712820016, -52.25769049359588, -31.027157738412352, -8.3836372299131, -27.951444441338307, -15.218312284835466, -33.162043005379005, -25.052893989296727, -2.7718224710625288, -12.58714026927753, -9.2712293327786, -17.325055492586866, -22.922779600755096, -13.435888539557709, -35.145168291282275, -21.74148459304818, -14.939812401964284, -42.96810556848761, -19.17160879767195, -41.24726489669686, -24.86665196416676, -6.691134386963676, -26.6304431502907, -3.19092153675963, -38.510354739857696, -18.60301758543742, -12.190953944634929, -47.85274726694621, -30.011763621623206, -16.91697968803289, -16.903395280137268, -48.26434729580028, -13.224832514924763, -17.594624544497535, -21.78113730428015, -43.48869889180776, -10.101295520374602, -29.91762911773378], "policy_predator_policy_reward": [26.059736613093854, 29.06074082207232, 12.369031879369182, 48.14549986984745, 19.57449376711235, 45.54115421882559, 17.616067776762478, 38.934191454100926, 11.817632511602202, 26.689952373502173, 25.4576683816755, 36.998606598537485, 41.8550985449683, 30.93149511298115, 40.217083882212044, 18.93702863655472, 24.806466661589965, 18.6205483019365, 15.432217735736842, 42.542114945253935, 19.773997009047687, 24.3770771004147, 39.23868492680648, 25.95972797014575, 11.096831992512714, 10.952019816502082, 39.11668557380115, 28.230244996576953, 21.072507261248337, 23.573895781930034, 39.28261384161102, 23.244733509949924, 8.092116419184828, 35.91782760556152, 24.04624180939871, 19.146188895775072, 37.769323847354634, 18.275490380340685, 40.25505318120454, 6.390881118861785, 35.81089914680477, 36.8762727871254, 29.361064414582852, 50.03919970517464, 14.862136219459684, 4.514125605105068, 50.04877006032447, 41.32174970144948, 36.672346156398845, 28.587434529343053, 18.262184637014045, 7.3692245748333, 40.633007036988225, 4.968065518874046, 21.886364685491905, 26.565086867830313, 21.06560255193532, 8.423341674796198, 43.139348640037795, 37.48792006658846, 13.491955660052383, 24.256353191526422, 19.9801712820016, 52.25769049359588, 31.027157738412352, 8.3836372299131, 27.951444441338307, 15.218312284835466, 33.162043005379005, 25.052893989296727, 2.7718224710625288, 12.58714026927753, 9.2712293327786, 17.325055492586866, 22.922779600755096, 13.435888539557709, 35.145168291282275, 21.74148459304818, 14.939812401964284, 42.96810556848761, 19.17160879767195, 41.24726489669686, 24.86665196416676, 6.691134386963676, 26.6304431502907, 3.19092153675963, 38.510354739857696, 18.60301758543742, 12.190953944634929, 47.85274726694621, 30.011763621623206, 16.91697968803289, 16.903395280137268, 48.26434729580028, 13.224832514924763, 17.594624544497535, 21.78113730428015, 43.48869889180776, 10.101295520374602, 29.91762911773378]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2849573817832509, "mean_inference_ms": 0.9485774409455843, "mean_action_processing_ms": 0.12672547151770744, "mean_env_wait_ms": 0.06696440815851737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003558039665222168, "StateBufferConnector_ms": 0.0029425621032714844, "ViewRequirementAgentConnector_ms": 0.05435609817504883}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 694.9776056219182, "num_env_steps_trained_throughput_per_sec": 694.9776056219182, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 1144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1144000, "timers": {"training_iteration_time_ms": 5853.409, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5853.367, "sample_time_ms": 757.409, "learn_time_ms": 5082.121, "learn_throughput": 787.073, "synch_weights_time_ms": 13.341}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000}, "done": false, "training_iteration": 143, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-08-02", "timestamp": 1723396082, "time_this_iter_s": 5.760318994522095, "time_total_s": 799.3904187679291, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9ed1ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 799.3904187679291, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 32.662499999999994, "ram_util_percent": 81.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0297673330331842, "cur_kl_coeff": 6.162975822039156e-34, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09204898481912097, "policy_loss": -0.000578644822720283, "vf_loss": 0.09262762872094754, "vf_explained_var": 0.9946485048159956, "kl": 0.0010121451103118943, "entropy": 0.08305130214381885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 137760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9661694653797894, "cur_kl_coeff": 3.469446951953615e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0869774215524861, "policy_loss": -0.006156888014811557, "vf_loss": 0.09313430980158349, "vf_explained_var": 0.9946428195262949, "kl": 0.0032062493620006126, "entropy": 0.1557127898791805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 137760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -52.93369004429803, "predator_policy": 2.7718224710625288}, "policy_reward_max": {"prey_policy": -2.7718224710625288, "predator_policy": 52.93369004429803}, "policy_reward_mean": {"prey_policy": -25.90288006417307, "predator_policy": 25.90288006417307}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-26.689952373502173, -25.4576683816755, -36.998606598537485, -41.8550985449683, -30.93149511298115, -40.217083882212044, -18.93702863655472, -24.806466661589965, -18.6205483019365, -15.432217735736842, -42.542114945253935, -19.773997009047687, -24.3770771004147, -39.23868492680648, -25.95972797014575, -11.096831992512714, -10.952019816502082, -39.11668557380115, -28.230244996576953, -21.072507261248337, -23.573895781930034, -39.28261384161102, -23.244733509949924, -8.092116419184828, -35.91782760556152, -24.04624180939871, -19.146188895775072, -37.769323847354634, -18.275490380340685, -40.25505318120454, -6.390881118861785, -35.81089914680477, -36.8762727871254, -29.361064414582852, -50.03919970517464, -14.862136219459684, -4.514125605105068, -50.04877006032447, -41.32174970144948, -36.672346156398845, -28.587434529343053, -18.262184637014045, -7.3692245748333, -40.633007036988225, -4.968065518874046, -21.886364685491905, -26.565086867830313, -21.06560255193532, -8.423341674796198, -43.139348640037795, -37.48792006658846, -13.491955660052383, -24.256353191526422, -19.9801712820016, -52.25769049359588, -31.027157738412352, -8.3836372299131, -27.951444441338307, -15.218312284835466, -33.162043005379005, -25.052893989296727, -2.7718224710625288, -12.58714026927753, -9.2712293327786, -17.325055492586866, -22.922779600755096, -13.435888539557709, -35.145168291282275, -21.74148459304818, -14.939812401964284, -42.96810556848761, -19.17160879767195, -41.24726489669686, -24.86665196416676, -6.691134386963676, -26.6304431502907, -3.19092153675963, -38.510354739857696, -18.60301758543742, -12.190953944634929, -47.85274726694621, -30.011763621623206, -16.91697968803289, -16.903395280137268, -48.26434729580028, -13.224832514924763, -17.594624544497535, -21.78113730428015, -43.48869889180776, -10.101295520374602, -29.91762911773378, -39.47217535532452, -18.589807761395647, -12.158351815370377, -35.791054405657945, -44.35997974414176, -6.9242959593815385, -52.93369004429803, -44.24411970727176, -28.57001490534004], "policy_predator_policy_reward": [26.689952373502173, 25.4576683816755, 36.998606598537485, 41.8550985449683, 30.93149511298115, 40.217083882212044, 18.93702863655472, 24.806466661589965, 18.6205483019365, 15.432217735736842, 42.542114945253935, 19.773997009047687, 24.3770771004147, 39.23868492680648, 25.95972797014575, 11.096831992512714, 10.952019816502082, 39.11668557380115, 28.230244996576953, 21.072507261248337, 23.573895781930034, 39.28261384161102, 23.244733509949924, 8.092116419184828, 35.91782760556152, 24.04624180939871, 19.146188895775072, 37.769323847354634, 18.275490380340685, 40.25505318120454, 6.390881118861785, 35.81089914680477, 36.8762727871254, 29.361064414582852, 50.03919970517464, 14.862136219459684, 4.514125605105068, 50.04877006032447, 41.32174970144948, 36.672346156398845, 28.587434529343053, 18.262184637014045, 7.3692245748333, 40.633007036988225, 4.968065518874046, 21.886364685491905, 26.565086867830313, 21.06560255193532, 8.423341674796198, 43.139348640037795, 37.48792006658846, 13.491955660052383, 24.256353191526422, 19.9801712820016, 52.25769049359588, 31.027157738412352, 8.3836372299131, 27.951444441338307, 15.218312284835466, 33.162043005379005, 25.052893989296727, 2.7718224710625288, 12.58714026927753, 9.2712293327786, 17.325055492586866, 22.922779600755096, 13.435888539557709, 35.145168291282275, 21.74148459304818, 14.939812401964284, 42.96810556848761, 19.17160879767195, 41.24726489669686, 24.86665196416676, 6.691134386963676, 26.6304431502907, 3.19092153675963, 38.510354739857696, 18.60301758543742, 12.190953944634929, 47.85274726694621, 30.011763621623206, 16.91697968803289, 16.903395280137268, 48.26434729580028, 13.224832514924763, 17.594624544497535, 21.78113730428015, 43.48869889180776, 10.101295520374602, 29.91762911773378, 39.47217535532452, 18.589807761395647, 12.158351815370377, 35.791054405657945, 44.35997974414176, 6.9242959593815385, 52.93369004429803, 44.24411970727176, 28.57001490534004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2850647598373894, "mean_inference_ms": 0.949050039220652, "mean_action_processing_ms": 0.1267697025637278, "mean_env_wait_ms": 0.0669876222722308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003549814224243164, "StateBufferConnector_ms": 0.002943277359008789, "ViewRequirementAgentConnector_ms": 0.054337501525878906}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 747.1870397919073, "num_env_steps_trained_throughput_per_sec": 747.1870397919073, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 5846.344, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5846.302, "sample_time_ms": 761.28, "learn_time_ms": 5071.046, "learn_throughput": 788.792, "synch_weights_time_ms": 13.539}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 144, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-08-08", "timestamp": 1723396088, "time_this_iter_s": 5.359356880187988, "time_total_s": 804.7497756481171, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9efc8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 804.7497756481171, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 27.862499999999997, "ram_util_percent": 81.9625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9298251481571546, "cur_kl_coeff": 3.081487911019578e-34, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06328902859822846, "policy_loss": -0.001065169089512589, "vf_loss": 0.06435419773915782, "vf_explained_var": 0.994716938957572, "kl": 0.0009205164933821857, "entropy": 0.06915038537796742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 138720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9852779971901328, "cur_kl_coeff": 1.7347234759768074e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.058759614827674035, "policy_loss": -0.004512808394307891, "vf_loss": 0.06327242240561949, "vf_explained_var": 0.9942319132387638, "kl": 0.003255175967877642, "entropy": 0.16817617642227561, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 138720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -52.93369004429803, "predator_policy": 2.7718224710625288}, "policy_reward_max": {"prey_policy": -2.7718224710625288, "predator_policy": 52.93369004429803}, "policy_reward_mean": {"prey_policy": -25.173039155895886, "predator_policy": 25.173039155895886}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-15.432217735736842, -42.542114945253935, -19.773997009047687, -24.3770771004147, -39.23868492680648, -25.95972797014575, -11.096831992512714, -10.952019816502082, -39.11668557380115, -28.230244996576953, -21.072507261248337, -23.573895781930034, -39.28261384161102, -23.244733509949924, -8.092116419184828, -35.91782760556152, -24.04624180939871, -19.146188895775072, -37.769323847354634, -18.275490380340685, -40.25505318120454, -6.390881118861785, -35.81089914680477, -36.8762727871254, -29.361064414582852, -50.03919970517464, -14.862136219459684, -4.514125605105068, -50.04877006032447, -41.32174970144948, -36.672346156398845, -28.587434529343053, -18.262184637014045, -7.3692245748333, -40.633007036988225, -4.968065518874046, -21.886364685491905, -26.565086867830313, -21.06560255193532, -8.423341674796198, -43.139348640037795, -37.48792006658846, -13.491955660052383, -24.256353191526422, -19.9801712820016, -52.25769049359588, -31.027157738412352, -8.3836372299131, -27.951444441338307, -15.218312284835466, -33.162043005379005, -25.052893989296727, -2.7718224710625288, -12.58714026927753, -9.2712293327786, -17.325055492586866, -22.922779600755096, -13.435888539557709, -35.145168291282275, -21.74148459304818, -14.939812401964284, -42.96810556848761, -19.17160879767195, -41.24726489669686, -24.86665196416676, -6.691134386963676, -26.6304431502907, -3.19092153675963, -38.510354739857696, -18.60301758543742, -12.190953944634929, -47.85274726694621, -30.011763621623206, -16.91697968803289, -16.903395280137268, -48.26434729580028, -13.224832514924763, -17.594624544497535, -21.78113730428015, -43.48869889180776, -10.101295520374602, -29.91762911773378, -39.47217535532452, -18.589807761395647, -12.158351815370377, -35.791054405657945, -44.35997974414176, -6.9242959593815385, -52.93369004429803, -44.24411970727176, -28.57001490534004, -35.487193034095405, -14.285257869294375, -27.753115878356216, -34.90679116389485, -36.800951308671536, -4.327699541766051, -14.2086399771024, -7.7905905021727335, -15.96961839088693], "policy_predator_policy_reward": [15.432217735736842, 42.542114945253935, 19.773997009047687, 24.3770771004147, 39.23868492680648, 25.95972797014575, 11.096831992512714, 10.952019816502082, 39.11668557380115, 28.230244996576953, 21.072507261248337, 23.573895781930034, 39.28261384161102, 23.244733509949924, 8.092116419184828, 35.91782760556152, 24.04624180939871, 19.146188895775072, 37.769323847354634, 18.275490380340685, 40.25505318120454, 6.390881118861785, 35.81089914680477, 36.8762727871254, 29.361064414582852, 50.03919970517464, 14.862136219459684, 4.514125605105068, 50.04877006032447, 41.32174970144948, 36.672346156398845, 28.587434529343053, 18.262184637014045, 7.3692245748333, 40.633007036988225, 4.968065518874046, 21.886364685491905, 26.565086867830313, 21.06560255193532, 8.423341674796198, 43.139348640037795, 37.48792006658846, 13.491955660052383, 24.256353191526422, 19.9801712820016, 52.25769049359588, 31.027157738412352, 8.3836372299131, 27.951444441338307, 15.218312284835466, 33.162043005379005, 25.052893989296727, 2.7718224710625288, 12.58714026927753, 9.2712293327786, 17.325055492586866, 22.922779600755096, 13.435888539557709, 35.145168291282275, 21.74148459304818, 14.939812401964284, 42.96810556848761, 19.17160879767195, 41.24726489669686, 24.86665196416676, 6.691134386963676, 26.6304431502907, 3.19092153675963, 38.510354739857696, 18.60301758543742, 12.190953944634929, 47.85274726694621, 30.011763621623206, 16.91697968803289, 16.903395280137268, 48.26434729580028, 13.224832514924763, 17.594624544497535, 21.78113730428015, 43.48869889180776, 10.101295520374602, 29.91762911773378, 39.47217535532452, 18.589807761395647, 12.158351815370377, 35.791054405657945, 44.35997974414176, 6.9242959593815385, 52.93369004429803, 44.24411970727176, 28.57001490534004, 35.487193034095405, 14.285257869294375, 27.753115878356216, 34.90679116389485, 36.800951308671536, 4.327699541766051, 14.2086399771024, 7.7905905021727335, 15.96961839088693]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2851739872219523, "mean_inference_ms": 0.9495361761352369, "mean_action_processing_ms": 0.12681563057116665, "mean_env_wait_ms": 0.06701112791708783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035784244537353516, "StateBufferConnector_ms": 0.0033212900161743164, "ViewRequirementAgentConnector_ms": 0.05520296096801758}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 731.7784836429529, "num_env_steps_trained_throughput_per_sec": 731.7784836429529, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 1160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1160000, "timers": {"training_iteration_time_ms": 5789.17, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5789.128, "sample_time_ms": 760.507, "learn_time_ms": 5014.696, "learn_throughput": 797.656, "synch_weights_time_ms": 13.491}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "done": false, "training_iteration": 145, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-08-13", "timestamp": 1723396093, "time_this_iter_s": 5.4715399742126465, "time_total_s": 810.2213156223297, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9efcd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 810.2213156223297, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 27.225, "ram_util_percent": 81.9875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9157111323438585, "cur_kl_coeff": 1.540743955509789e-34, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07224441758165388, "policy_loss": -0.0008971075857213388, "vf_loss": 0.07314152485923842, "vf_explained_var": 0.9931206512575348, "kl": 0.0015674876228061552, "entropy": 0.10902267243751945, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 139680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9569140667251, "cur_kl_coeff": 8.673617379884037e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06379299073232687, "policy_loss": -0.005315902014748038, "vf_loss": 0.06910889309753353, "vf_explained_var": 0.9936064456279079, "kl": 0.0049042033974743045, "entropy": 0.19309649956412614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 139680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -52.93369004429803, "predator_policy": 2.7718224710625288}, "policy_reward_max": {"prey_policy": -2.7718224710625288, "predator_policy": 52.93369004429803}, "policy_reward_mean": {"prey_policy": -24.788393988203453, "predator_policy": 24.788393988203453}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-25.95972797014575, -11.096831992512714, -10.952019816502082, -39.11668557380115, -28.230244996576953, -21.072507261248337, -23.573895781930034, -39.28261384161102, -23.244733509949924, -8.092116419184828, -35.91782760556152, -24.04624180939871, -19.146188895775072, -37.769323847354634, -18.275490380340685, -40.25505318120454, -6.390881118861785, -35.81089914680477, -36.8762727871254, -29.361064414582852, -50.03919970517464, -14.862136219459684, -4.514125605105068, -50.04877006032447, -41.32174970144948, -36.672346156398845, -28.587434529343053, -18.262184637014045, -7.3692245748333, -40.633007036988225, -4.968065518874046, -21.886364685491905, -26.565086867830313, -21.06560255193532, -8.423341674796198, -43.139348640037795, -37.48792006658846, -13.491955660052383, -24.256353191526422, -19.9801712820016, -52.25769049359588, -31.027157738412352, -8.3836372299131, -27.951444441338307, -15.218312284835466, -33.162043005379005, -25.052893989296727, -2.7718224710625288, -12.58714026927753, -9.2712293327786, -17.325055492586866, -22.922779600755096, -13.435888539557709, -35.145168291282275, -21.74148459304818, -14.939812401964284, -42.96810556848761, -19.17160879767195, -41.24726489669686, -24.86665196416676, -6.691134386963676, -26.6304431502907, -3.19092153675963, -38.510354739857696, -18.60301758543742, -12.190953944634929, -47.85274726694621, -30.011763621623206, -16.91697968803289, -16.903395280137268, -48.26434729580028, -13.224832514924763, -17.594624544497535, -21.78113730428015, -43.48869889180776, -10.101295520374602, -29.91762911773378, -39.47217535532452, -18.589807761395647, -12.158351815370377, -35.791054405657945, -44.35997974414176, -6.9242959593815385, -52.93369004429803, -44.24411970727176, -28.57001490534004, -35.487193034095405, -14.285257869294375, -27.753115878356216, -34.90679116389485, -36.800951308671536, -4.327699541766051, -14.2086399771024, -7.7905905021727335, -15.96961839088693, -15.49759978952735, -12.112668322099445, -32.071799392386374, -15.61190197887052, -27.605605465131575], "policy_predator_policy_reward": [25.95972797014575, 11.096831992512714, 10.952019816502082, 39.11668557380115, 28.230244996576953, 21.072507261248337, 23.573895781930034, 39.28261384161102, 23.244733509949924, 8.092116419184828, 35.91782760556152, 24.04624180939871, 19.146188895775072, 37.769323847354634, 18.275490380340685, 40.25505318120454, 6.390881118861785, 35.81089914680477, 36.8762727871254, 29.361064414582852, 50.03919970517464, 14.862136219459684, 4.514125605105068, 50.04877006032447, 41.32174970144948, 36.672346156398845, 28.587434529343053, 18.262184637014045, 7.3692245748333, 40.633007036988225, 4.968065518874046, 21.886364685491905, 26.565086867830313, 21.06560255193532, 8.423341674796198, 43.139348640037795, 37.48792006658846, 13.491955660052383, 24.256353191526422, 19.9801712820016, 52.25769049359588, 31.027157738412352, 8.3836372299131, 27.951444441338307, 15.218312284835466, 33.162043005379005, 25.052893989296727, 2.7718224710625288, 12.58714026927753, 9.2712293327786, 17.325055492586866, 22.922779600755096, 13.435888539557709, 35.145168291282275, 21.74148459304818, 14.939812401964284, 42.96810556848761, 19.17160879767195, 41.24726489669686, 24.86665196416676, 6.691134386963676, 26.6304431502907, 3.19092153675963, 38.510354739857696, 18.60301758543742, 12.190953944634929, 47.85274726694621, 30.011763621623206, 16.91697968803289, 16.903395280137268, 48.26434729580028, 13.224832514924763, 17.594624544497535, 21.78113730428015, 43.48869889180776, 10.101295520374602, 29.91762911773378, 39.47217535532452, 18.589807761395647, 12.158351815370377, 35.791054405657945, 44.35997974414176, 6.9242959593815385, 52.93369004429803, 44.24411970727176, 28.57001490534004, 35.487193034095405, 14.285257869294375, 27.753115878356216, 34.90679116389485, 36.800951308671536, 4.327699541766051, 14.2086399771024, 7.7905905021727335, 15.96961839088693, 15.49759978952735, 12.112668322099445, 32.071799392386374, 15.61190197887052, 27.605605465131575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2853232057328973, "mean_inference_ms": 0.9498491353257579, "mean_action_processing_ms": 0.12686778327851123, "mean_env_wait_ms": 0.06702750843329174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035837888717651367, "StateBufferConnector_ms": 0.003329157829284668, "ViewRequirementAgentConnector_ms": 0.055440545082092285}, "num_episodes": 5, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 748.875473749032, "num_env_steps_trained_throughput_per_sec": 748.875473749032, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 5749.117, "restore_workers_time_ms": 0.014, "training_step_time_ms": 5749.076, "sample_time_ms": 761.331, "learn_time_ms": 4973.853, "learn_throughput": 804.206, "synch_weights_time_ms": 13.458}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 146, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-08-19", "timestamp": 1723396099, "time_this_iter_s": 5.346837997436523, "time_total_s": 815.5681536197662, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f2f4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 815.5681536197662, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 27.8, "ram_util_percent": 81.82857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9504920630094905, "cur_kl_coeff": 7.703719777548945e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04308313535924147, "policy_loss": -0.0038082350433493654, "vf_loss": 0.046891369951481465, "vf_explained_var": 0.9975957570597529, "kl": 0.009680780993661231, "entropy": 0.0861729571809216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 140640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9310067359823734, "cur_kl_coeff": 4.3368086899420186e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.049079324276135594, "policy_loss": -0.0033714388560232085, "vf_loss": 0.05245076260665276, "vf_explained_var": 0.997337932822605, "kl": 0.0017450931254952599, "entropy": 0.17223760973041255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 140640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -52.93369004429803, "predator_policy": 2.145159981769636}, "policy_reward_max": {"prey_policy": -2.145159981769636, "predator_policy": 52.93369004429803}, "policy_reward_mean": {"prey_policy": -24.391271373637856, "predator_policy": 24.391271373637856}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-8.092116419184828, -35.91782760556152, -24.04624180939871, -19.146188895775072, -37.769323847354634, -18.275490380340685, -40.25505318120454, -6.390881118861785, -35.81089914680477, -36.8762727871254, -29.361064414582852, -50.03919970517464, -14.862136219459684, -4.514125605105068, -50.04877006032447, -41.32174970144948, -36.672346156398845, -28.587434529343053, -18.262184637014045, -7.3692245748333, -40.633007036988225, -4.968065518874046, -21.886364685491905, -26.565086867830313, -21.06560255193532, -8.423341674796198, -43.139348640037795, -37.48792006658846, -13.491955660052383, -24.256353191526422, -19.9801712820016, -52.25769049359588, -31.027157738412352, -8.3836372299131, -27.951444441338307, -15.218312284835466, -33.162043005379005, -25.052893989296727, -2.7718224710625288, -12.58714026927753, -9.2712293327786, -17.325055492586866, -22.922779600755096, -13.435888539557709, -35.145168291282275, -21.74148459304818, -14.939812401964284, -42.96810556848761, -19.17160879767195, -41.24726489669686, -24.86665196416676, -6.691134386963676, -26.6304431502907, -3.19092153675963, -38.510354739857696, -18.60301758543742, -12.190953944634929, -47.85274726694621, -30.011763621623206, -16.91697968803289, -16.903395280137268, -48.26434729580028, -13.224832514924763, -17.594624544497535, -21.78113730428015, -43.48869889180776, -10.101295520374602, -29.91762911773378, -39.47217535532452, -18.589807761395647, -12.158351815370377, -35.791054405657945, -44.35997974414176, -6.9242959593815385, -52.93369004429803, -44.24411970727176, -28.57001490534004, -35.487193034095405, -14.285257869294375, -27.753115878356216, -34.90679116389485, -36.800951308671536, -4.327699541766051, -14.2086399771024, -7.7905905021727335, -15.96961839088693, -15.49759978952735, -12.112668322099445, -32.071799392386374, -15.61190197887052, -27.605605465131575, -32.38799018366855, -20.728455242332164, -7.254907609587933, -19.921136056348086, -23.740137708008746, -23.383828959641285, -21.652745498677575, -31.60263804768406, -2.145159981769636], "policy_predator_policy_reward": [8.092116419184828, 35.91782760556152, 24.04624180939871, 19.146188895775072, 37.769323847354634, 18.275490380340685, 40.25505318120454, 6.390881118861785, 35.81089914680477, 36.8762727871254, 29.361064414582852, 50.03919970517464, 14.862136219459684, 4.514125605105068, 50.04877006032447, 41.32174970144948, 36.672346156398845, 28.587434529343053, 18.262184637014045, 7.3692245748333, 40.633007036988225, 4.968065518874046, 21.886364685491905, 26.565086867830313, 21.06560255193532, 8.423341674796198, 43.139348640037795, 37.48792006658846, 13.491955660052383, 24.256353191526422, 19.9801712820016, 52.25769049359588, 31.027157738412352, 8.3836372299131, 27.951444441338307, 15.218312284835466, 33.162043005379005, 25.052893989296727, 2.7718224710625288, 12.58714026927753, 9.2712293327786, 17.325055492586866, 22.922779600755096, 13.435888539557709, 35.145168291282275, 21.74148459304818, 14.939812401964284, 42.96810556848761, 19.17160879767195, 41.24726489669686, 24.86665196416676, 6.691134386963676, 26.6304431502907, 3.19092153675963, 38.510354739857696, 18.60301758543742, 12.190953944634929, 47.85274726694621, 30.011763621623206, 16.91697968803289, 16.903395280137268, 48.26434729580028, 13.224832514924763, 17.594624544497535, 21.78113730428015, 43.48869889180776, 10.101295520374602, 29.91762911773378, 39.47217535532452, 18.589807761395647, 12.158351815370377, 35.791054405657945, 44.35997974414176, 6.9242959593815385, 52.93369004429803, 44.24411970727176, 28.57001490534004, 35.487193034095405, 14.285257869294375, 27.753115878356216, 34.90679116389485, 36.800951308671536, 4.327699541766051, 14.2086399771024, 7.7905905021727335, 15.96961839088693, 15.49759978952735, 12.112668322099445, 32.071799392386374, 15.61190197887052, 27.605605465131575, 32.38799018366855, 20.728455242332164, 7.254907609587933, 19.921136056348086, 23.740137708008746, 23.383828959641285, 21.652745498677575, 31.60263804768406, 2.145159981769636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2856221006962508, "mean_inference_ms": 0.9504278224293025, "mean_action_processing_ms": 0.12687820380267292, "mean_env_wait_ms": 0.0670619273573051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003589630126953125, "StateBufferConnector_ms": 0.0028840303421020508, "ViewRequirementAgentConnector_ms": 0.054975032806396484}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 757.5723066522183, "num_env_steps_trained_throughput_per_sec": 757.5723066522183, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 1176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 5656.907, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5656.868, "sample_time_ms": 756.673, "learn_time_ms": 4886.43, "learn_throughput": 818.594, "synch_weights_time_ms": 13.331}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "training_iteration": 147, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-08-24", "timestamp": 1723396104, "time_this_iter_s": 5.285185813903809, "time_total_s": 820.85333943367, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9efce50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 820.85333943367, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 27.674999999999997, "ram_util_percent": 81.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7994411071762443, "cur_kl_coeff": 7.703719777548945e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07679564354621107, "policy_loss": -0.0018706866995974755, "vf_loss": 0.07866633021573459, "vf_explained_var": 0.995380125567317, "kl": 0.0028188151770464176, "entropy": 0.0789671585400356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 141600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.936495972207437, "cur_kl_coeff": 2.1684043449710093e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03236777519802369, "policy_loss": -0.016345532842387912, "vf_loss": 0.04871330782819617, "vf_explained_var": 0.9976754652336239, "kl": 0.007420510094201075, "entropy": 0.19969055814823758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 141600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -52.93369004429803, "predator_policy": 2.145159981769636}, "policy_reward_max": {"prey_policy": -2.145159981769636, "predator_policy": 52.93369004429803}, "policy_reward_mean": {"prey_policy": -24.247544941436978, "predator_policy": 24.247544941436978}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-36.8762727871254, -29.361064414582852, -50.03919970517464, -14.862136219459684, -4.514125605105068, -50.04877006032447, -41.32174970144948, -36.672346156398845, -28.587434529343053, -18.262184637014045, -7.3692245748333, -40.633007036988225, -4.968065518874046, -21.886364685491905, -26.565086867830313, -21.06560255193532, -8.423341674796198, -43.139348640037795, -37.48792006658846, -13.491955660052383, -24.256353191526422, -19.9801712820016, -52.25769049359588, -31.027157738412352, -8.3836372299131, -27.951444441338307, -15.218312284835466, -33.162043005379005, -25.052893989296727, -2.7718224710625288, -12.58714026927753, -9.2712293327786, -17.325055492586866, -22.922779600755096, -13.435888539557709, -35.145168291282275, -21.74148459304818, -14.939812401964284, -42.96810556848761, -19.17160879767195, -41.24726489669686, -24.86665196416676, -6.691134386963676, -26.6304431502907, -3.19092153675963, -38.510354739857696, -18.60301758543742, -12.190953944634929, -47.85274726694621, -30.011763621623206, -16.91697968803289, -16.903395280137268, -48.26434729580028, -13.224832514924763, -17.594624544497535, -21.78113730428015, -43.48869889180776, -10.101295520374602, -29.91762911773378, -39.47217535532452, -18.589807761395647, -12.158351815370377, -35.791054405657945, -44.35997974414176, -6.9242959593815385, -52.93369004429803, -44.24411970727176, -28.57001490534004, -35.487193034095405, -14.285257869294375, -27.753115878356216, -34.90679116389485, -36.800951308671536, -4.327699541766051, -14.2086399771024, -7.7905905021727335, -15.96961839088693, -15.49759978952735, -12.112668322099445, -32.071799392386374, -15.61190197887052, -27.605605465131575, -32.38799018366855, -20.728455242332164, -7.254907609587933, -19.921136056348086, -23.740137708008746, -23.383828959641285, -21.652745498677575, -31.60263804768406, -2.145159981769636, -34.05621567783801, -5.600000703134995, -27.953040519441004, -20.03704018578143, -9.709852105858598, -28.474140045850724, -32.84005748121183, -11.968968103092815, -40.692064362190166], "policy_predator_policy_reward": [36.8762727871254, 29.361064414582852, 50.03919970517464, 14.862136219459684, 4.514125605105068, 50.04877006032447, 41.32174970144948, 36.672346156398845, 28.587434529343053, 18.262184637014045, 7.3692245748333, 40.633007036988225, 4.968065518874046, 21.886364685491905, 26.565086867830313, 21.06560255193532, 8.423341674796198, 43.139348640037795, 37.48792006658846, 13.491955660052383, 24.256353191526422, 19.9801712820016, 52.25769049359588, 31.027157738412352, 8.3836372299131, 27.951444441338307, 15.218312284835466, 33.162043005379005, 25.052893989296727, 2.7718224710625288, 12.58714026927753, 9.2712293327786, 17.325055492586866, 22.922779600755096, 13.435888539557709, 35.145168291282275, 21.74148459304818, 14.939812401964284, 42.96810556848761, 19.17160879767195, 41.24726489669686, 24.86665196416676, 6.691134386963676, 26.6304431502907, 3.19092153675963, 38.510354739857696, 18.60301758543742, 12.190953944634929, 47.85274726694621, 30.011763621623206, 16.91697968803289, 16.903395280137268, 48.26434729580028, 13.224832514924763, 17.594624544497535, 21.78113730428015, 43.48869889180776, 10.101295520374602, 29.91762911773378, 39.47217535532452, 18.589807761395647, 12.158351815370377, 35.791054405657945, 44.35997974414176, 6.9242959593815385, 52.93369004429803, 44.24411970727176, 28.57001490534004, 35.487193034095405, 14.285257869294375, 27.753115878356216, 34.90679116389485, 36.800951308671536, 4.327699541766051, 14.2086399771024, 7.7905905021727335, 15.96961839088693, 15.49759978952735, 12.112668322099445, 32.071799392386374, 15.61190197887052, 27.605605465131575, 32.38799018366855, 20.728455242332164, 7.254907609587933, 19.921136056348086, 23.740137708008746, 23.383828959641285, 21.652745498677575, 31.60263804768406, 2.145159981769636, 34.05621567783801, 5.600000703134995, 27.953040519441004, 20.03704018578143, 9.709852105858598, 28.474140045850724, 32.84005748121183, 11.968968103092815, 40.692064362190166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28571049320630315, "mean_inference_ms": 0.9508280356909925, "mean_action_processing_ms": 0.12691541214437485, "mean_env_wait_ms": 0.0670809930335763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003585338592529297, "StateBufferConnector_ms": 0.0028520822525024414, "ViewRequirementAgentConnector_ms": 0.05276799201965332}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 699.6778112114492, "num_env_steps_trained_throughput_per_sec": 699.6778112114492, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 5619.49, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5619.456, "sample_time_ms": 753.882, "learn_time_ms": 4852.645, "learn_throughput": 824.293, "synch_weights_time_ms": 12.573}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 148, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-08-30", "timestamp": 1723396110, "time_this_iter_s": 5.721415996551514, "time_total_s": 826.5747554302216, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f2ff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 826.5747554302216, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 30.9125, "ram_util_percent": 81.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0028748192824424, "cur_kl_coeff": 3.8518598887744725e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0824272818089715, "policy_loss": -0.00022228806580339248, "vf_loss": 0.0826495684896751, "vf_explained_var": 0.9950969984134038, "kl": 0.0011335432061943668, "entropy": 0.08636298451844292, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 142560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0755418597099682, "cur_kl_coeff": 2.1684043449710093e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07036649265743715, "policy_loss": -0.010043012614672383, "vf_loss": 0.0804095055849757, "vf_explained_var": 0.9953763144090771, "kl": 0.009716765450003143, "entropy": 0.18048781839509806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 142560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1192000, "num_agent_steps_trained": 1192000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -52.93369004429803, "predator_policy": 2.145159981769636}, "policy_reward_max": {"prey_policy": -2.145159981769636, "predator_policy": 52.93369004429803}, "policy_reward_mean": {"prey_policy": -23.59657076547202, "predator_policy": 23.59657076547202}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-18.262184637014045, -7.3692245748333, -40.633007036988225, -4.968065518874046, -21.886364685491905, -26.565086867830313, -21.06560255193532, -8.423341674796198, -43.139348640037795, -37.48792006658846, -13.491955660052383, -24.256353191526422, -19.9801712820016, -52.25769049359588, -31.027157738412352, -8.3836372299131, -27.951444441338307, -15.218312284835466, -33.162043005379005, -25.052893989296727, -2.7718224710625288, -12.58714026927753, -9.2712293327786, -17.325055492586866, -22.922779600755096, -13.435888539557709, -35.145168291282275, -21.74148459304818, -14.939812401964284, -42.96810556848761, -19.17160879767195, -41.24726489669686, -24.86665196416676, -6.691134386963676, -26.6304431502907, -3.19092153675963, -38.510354739857696, -18.60301758543742, -12.190953944634929, -47.85274726694621, -30.011763621623206, -16.91697968803289, -16.903395280137268, -48.26434729580028, -13.224832514924763, -17.594624544497535, -21.78113730428015, -43.48869889180776, -10.101295520374602, -29.91762911773378, -39.47217535532452, -18.589807761395647, -12.158351815370377, -35.791054405657945, -44.35997974414176, -6.9242959593815385, -52.93369004429803, -44.24411970727176, -28.57001490534004, -35.487193034095405, -14.285257869294375, -27.753115878356216, -34.90679116389485, -36.800951308671536, -4.327699541766051, -14.2086399771024, -7.7905905021727335, -15.96961839088693, -15.49759978952735, -12.112668322099445, -32.071799392386374, -15.61190197887052, -27.605605465131575, -32.38799018366855, -20.728455242332164, -7.254907609587933, -19.921136056348086, -23.740137708008746, -23.383828959641285, -21.652745498677575, -31.60263804768406, -2.145159981769636, -34.05621567783801, -5.600000703134995, -27.953040519441004, -20.03704018578143, -9.709852105858598, -28.474140045850724, -32.84005748121183, -11.968968103092815, -40.692064362190166, -31.958975171114517, -9.740452147982245, -11.356328276220093, -37.646629638218904, -29.55031995430114, -8.923785509201798, -23.02344809775131, -45.99757877895685, -28.988164008719938], "policy_predator_policy_reward": [18.262184637014045, 7.3692245748333, 40.633007036988225, 4.968065518874046, 21.886364685491905, 26.565086867830313, 21.06560255193532, 8.423341674796198, 43.139348640037795, 37.48792006658846, 13.491955660052383, 24.256353191526422, 19.9801712820016, 52.25769049359588, 31.027157738412352, 8.3836372299131, 27.951444441338307, 15.218312284835466, 33.162043005379005, 25.052893989296727, 2.7718224710625288, 12.58714026927753, 9.2712293327786, 17.325055492586866, 22.922779600755096, 13.435888539557709, 35.145168291282275, 21.74148459304818, 14.939812401964284, 42.96810556848761, 19.17160879767195, 41.24726489669686, 24.86665196416676, 6.691134386963676, 26.6304431502907, 3.19092153675963, 38.510354739857696, 18.60301758543742, 12.190953944634929, 47.85274726694621, 30.011763621623206, 16.91697968803289, 16.903395280137268, 48.26434729580028, 13.224832514924763, 17.594624544497535, 21.78113730428015, 43.48869889180776, 10.101295520374602, 29.91762911773378, 39.47217535532452, 18.589807761395647, 12.158351815370377, 35.791054405657945, 44.35997974414176, 6.9242959593815385, 52.93369004429803, 44.24411970727176, 28.57001490534004, 35.487193034095405, 14.285257869294375, 27.753115878356216, 34.90679116389485, 36.800951308671536, 4.327699541766051, 14.2086399771024, 7.7905905021727335, 15.96961839088693, 15.49759978952735, 12.112668322099445, 32.071799392386374, 15.61190197887052, 27.605605465131575, 32.38799018366855, 20.728455242332164, 7.254907609587933, 19.921136056348086, 23.740137708008746, 23.383828959641285, 21.652745498677575, 31.60263804768406, 2.145159981769636, 34.05621567783801, 5.600000703134995, 27.953040519441004, 20.03704018578143, 9.709852105858598, 28.474140045850724, 32.84005748121183, 11.968968103092815, 40.692064362190166, 31.958975171114517, 9.740452147982245, 11.356328276220093, 37.646629638218904, 29.55031995430114, 8.923785509201798, 23.02344809775131, 45.99757877895685, 28.988164008719938]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28559410464884044, "mean_inference_ms": 0.9510716229821702, "mean_action_processing_ms": 0.12698191128175135, "mean_env_wait_ms": 0.06708637874622077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036040544509887695, "StateBufferConnector_ms": 0.0028535127639770508, "ViewRequirementAgentConnector_ms": 0.053423285484313965}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1192000, "num_agent_steps_trained": 1192000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 736.3804293257261, "num_env_steps_trained_throughput_per_sec": 736.3804293257261, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 1192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1192000, "timers": {"training_iteration_time_ms": 5556.876, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5556.843, "sample_time_ms": 720.442, "learn_time_ms": 4823.001, "learn_throughput": 829.359, "synch_weights_time_ms": 13.032}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1192000, "num_agent_steps_trained": 1192000}, "done": false, "training_iteration": 149, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-08-35", "timestamp": 1723396115, "time_this_iter_s": 5.4367499351501465, "time_total_s": 832.0115053653717, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f22b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 832.0115053653717, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 31.175, "ram_util_percent": 81.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0311902339259784, "cur_kl_coeff": 1.9259299443872362e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08466255291617321, "policy_loss": 0.0005838667282660026, "vf_loss": 0.08407868554738039, "vf_explained_var": 0.994629500247538, "kl": 0.0008218189954931029, "entropy": 0.08375564142576573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 143520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8770380095733951, "cur_kl_coeff": 2.1684043449710093e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07813214575944585, "policy_loss": -0.0029871903779470207, "vf_loss": 0.08111933589001032, "vf_explained_var": 0.9946616257851323, "kl": 0.002015471926596354, "entropy": 0.16505772584738831, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 143520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -52.93369004429803, "predator_policy": 2.145159981769636}, "policy_reward_max": {"prey_policy": -2.145159981769636, "predator_policy": 52.93369004429803}, "policy_reward_mean": {"prey_policy": -23.517563061672853, "predator_policy": 23.517563061672853}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-37.48792006658846, -13.491955660052383, -24.256353191526422, -19.9801712820016, -52.25769049359588, -31.027157738412352, -8.3836372299131, -27.951444441338307, -15.218312284835466, -33.162043005379005, -25.052893989296727, -2.7718224710625288, -12.58714026927753, -9.2712293327786, -17.325055492586866, -22.922779600755096, -13.435888539557709, -35.145168291282275, -21.74148459304818, -14.939812401964284, -42.96810556848761, -19.17160879767195, -41.24726489669686, -24.86665196416676, -6.691134386963676, -26.6304431502907, -3.19092153675963, -38.510354739857696, -18.60301758543742, -12.190953944634929, -47.85274726694621, -30.011763621623206, -16.91697968803289, -16.903395280137268, -48.26434729580028, -13.224832514924763, -17.594624544497535, -21.78113730428015, -43.48869889180776, -10.101295520374602, -29.91762911773378, -39.47217535532452, -18.589807761395647, -12.158351815370377, -35.791054405657945, -44.35997974414176, -6.9242959593815385, -52.93369004429803, -44.24411970727176, -28.57001490534004, -35.487193034095405, -14.285257869294375, -27.753115878356216, -34.90679116389485, -36.800951308671536, -4.327699541766051, -14.2086399771024, -7.7905905021727335, -15.96961839088693, -15.49759978952735, -12.112668322099445, -32.071799392386374, -15.61190197887052, -27.605605465131575, -32.38799018366855, -20.728455242332164, -7.254907609587933, -19.921136056348086, -23.740137708008746, -23.383828959641285, -21.652745498677575, -31.60263804768406, -2.145159981769636, -34.05621567783801, -5.600000703134995, -27.953040519441004, -20.03704018578143, -9.709852105858598, -28.474140045850724, -32.84005748121183, -11.968968103092815, -40.692064362190166, -31.958975171114517, -9.740452147982245, -11.356328276220093, -37.646629638218904, -29.55031995430114, -8.923785509201798, -23.02344809775131, -45.99757877895685, -28.988164008719938, -14.15350173042544, -26.3588985494634, -5.505296035084255, -38.272060554205325, -3.489575918767172, -17.23652061704322, -28.740300700812824, -19.5881465137755, -31.067155188307755], "policy_predator_policy_reward": [37.48792006658846, 13.491955660052383, 24.256353191526422, 19.9801712820016, 52.25769049359588, 31.027157738412352, 8.3836372299131, 27.951444441338307, 15.218312284835466, 33.162043005379005, 25.052893989296727, 2.7718224710625288, 12.58714026927753, 9.2712293327786, 17.325055492586866, 22.922779600755096, 13.435888539557709, 35.145168291282275, 21.74148459304818, 14.939812401964284, 42.96810556848761, 19.17160879767195, 41.24726489669686, 24.86665196416676, 6.691134386963676, 26.6304431502907, 3.19092153675963, 38.510354739857696, 18.60301758543742, 12.190953944634929, 47.85274726694621, 30.011763621623206, 16.91697968803289, 16.903395280137268, 48.26434729580028, 13.224832514924763, 17.594624544497535, 21.78113730428015, 43.48869889180776, 10.101295520374602, 29.91762911773378, 39.47217535532452, 18.589807761395647, 12.158351815370377, 35.791054405657945, 44.35997974414176, 6.9242959593815385, 52.93369004429803, 44.24411970727176, 28.57001490534004, 35.487193034095405, 14.285257869294375, 27.753115878356216, 34.90679116389485, 36.800951308671536, 4.327699541766051, 14.2086399771024, 7.7905905021727335, 15.96961839088693, 15.49759978952735, 12.112668322099445, 32.071799392386374, 15.61190197887052, 27.605605465131575, 32.38799018366855, 20.728455242332164, 7.254907609587933, 19.921136056348086, 23.740137708008746, 23.383828959641285, 21.652745498677575, 31.60263804768406, 2.145159981769636, 34.05621567783801, 5.600000703134995, 27.953040519441004, 20.03704018578143, 9.709852105858598, 28.474140045850724, 32.84005748121183, 11.968968103092815, 40.692064362190166, 31.958975171114517, 9.740452147982245, 11.356328276220093, 37.646629638218904, 29.55031995430114, 8.923785509201798, 23.02344809775131, 45.99757877895685, 28.988164008719938, 14.15350173042544, 26.3588985494634, 5.505296035084255, 38.272060554205325, 3.489575918767172, 17.23652061704322, 28.740300700812824, 19.5881465137755, 31.067155188307755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2856771330141591, "mean_inference_ms": 0.9514369732006643, "mean_action_processing_ms": 0.12701814414128398, "mean_env_wait_ms": 0.06710296125035367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036063194274902344, "StateBufferConnector_ms": 0.002877354621887207, "ViewRequirementAgentConnector_ms": 0.053250908851623535}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 731.698473283275, "num_env_steps_trained_throughput_per_sec": 731.698473283275, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 5559.648, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5559.614, "sample_time_ms": 720.639, "learn_time_ms": 4825.545, "learn_throughput": 828.922, "synch_weights_time_ms": 13.059}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 150, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-08-41", "timestamp": 1723396121, "time_this_iter_s": 5.471771240234375, "time_total_s": 837.4832766056061, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9efce50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 837.4832766056061, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 28.642857142857142, "ram_util_percent": 81.94285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1308458030689508, "cur_kl_coeff": 9.629649721936181e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.11656065093896663, "policy_loss": -0.0003887354570906609, "vf_loss": 0.1169493869577612, "vf_explained_var": 0.9959087987119953, "kl": 0.00206705370511498, "entropy": 0.08361594893212895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 144480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3134685988382746, "cur_kl_coeff": 1.0842021724855046e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09295209731790237, "policy_loss": -0.009664877222530777, "vf_loss": 0.10261697460324891, "vf_explained_var": 0.9967537535354495, "kl": 0.00495455071726562, "entropy": 0.2117150132233898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 144480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1208000, "num_agent_steps_trained": 1208000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -52.93369004429803, "predator_policy": 2.145159981769636}, "policy_reward_max": {"prey_policy": -2.145159981769636, "predator_policy": 52.93369004429803}, "policy_reward_mean": {"prey_policy": -22.957313911427594, "predator_policy": 22.957313911427594}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-33.162043005379005, -25.052893989296727, -2.7718224710625288, -12.58714026927753, -9.2712293327786, -17.325055492586866, -22.922779600755096, -13.435888539557709, -35.145168291282275, -21.74148459304818, -14.939812401964284, -42.96810556848761, -19.17160879767195, -41.24726489669686, -24.86665196416676, -6.691134386963676, -26.6304431502907, -3.19092153675963, -38.510354739857696, -18.60301758543742, -12.190953944634929, -47.85274726694621, -30.011763621623206, -16.91697968803289, -16.903395280137268, -48.26434729580028, -13.224832514924763, -17.594624544497535, -21.78113730428015, -43.48869889180776, -10.101295520374602, -29.91762911773378, -39.47217535532452, -18.589807761395647, -12.158351815370377, -35.791054405657945, -44.35997974414176, -6.9242959593815385, -52.93369004429803, -44.24411970727176, -28.57001490534004, -35.487193034095405, -14.285257869294375, -27.753115878356216, -34.90679116389485, -36.800951308671536, -4.327699541766051, -14.2086399771024, -7.7905905021727335, -15.96961839088693, -15.49759978952735, -12.112668322099445, -32.071799392386374, -15.61190197887052, -27.605605465131575, -32.38799018366855, -20.728455242332164, -7.254907609587933, -19.921136056348086, -23.740137708008746, -23.383828959641285, -21.652745498677575, -31.60263804768406, -2.145159981769636, -34.05621567783801, -5.600000703134995, -27.953040519441004, -20.03704018578143, -9.709852105858598, -28.474140045850724, -32.84005748121183, -11.968968103092815, -40.692064362190166, -31.958975171114517, -9.740452147982245, -11.356328276220093, -37.646629638218904, -29.55031995430114, -8.923785509201798, -23.02344809775131, -45.99757877895685, -28.988164008719938, -14.15350173042544, -26.3588985494634, -5.505296035084255, -38.272060554205325, -3.489575918767172, -17.23652061704322, -28.740300700812824, -19.5881465137755, -31.067155188307755, -21.37162974404952, -12.673074102680355, -7.555421319212019, -36.73878677123436, -7.667545899096478, -29.773325260563336, -19.61221137289417, -16.99585664562156, -21.641876248386296], "policy_predator_policy_reward": [33.162043005379005, 25.052893989296727, 2.7718224710625288, 12.58714026927753, 9.2712293327786, 17.325055492586866, 22.922779600755096, 13.435888539557709, 35.145168291282275, 21.74148459304818, 14.939812401964284, 42.96810556848761, 19.17160879767195, 41.24726489669686, 24.86665196416676, 6.691134386963676, 26.6304431502907, 3.19092153675963, 38.510354739857696, 18.60301758543742, 12.190953944634929, 47.85274726694621, 30.011763621623206, 16.91697968803289, 16.903395280137268, 48.26434729580028, 13.224832514924763, 17.594624544497535, 21.78113730428015, 43.48869889180776, 10.101295520374602, 29.91762911773378, 39.47217535532452, 18.589807761395647, 12.158351815370377, 35.791054405657945, 44.35997974414176, 6.9242959593815385, 52.93369004429803, 44.24411970727176, 28.57001490534004, 35.487193034095405, 14.285257869294375, 27.753115878356216, 34.90679116389485, 36.800951308671536, 4.327699541766051, 14.2086399771024, 7.7905905021727335, 15.96961839088693, 15.49759978952735, 12.112668322099445, 32.071799392386374, 15.61190197887052, 27.605605465131575, 32.38799018366855, 20.728455242332164, 7.254907609587933, 19.921136056348086, 23.740137708008746, 23.383828959641285, 21.652745498677575, 31.60263804768406, 2.145159981769636, 34.05621567783801, 5.600000703134995, 27.953040519441004, 20.03704018578143, 9.709852105858598, 28.474140045850724, 32.84005748121183, 11.968968103092815, 40.692064362190166, 31.958975171114517, 9.740452147982245, 11.356328276220093, 37.646629638218904, 29.55031995430114, 8.923785509201798, 23.02344809775131, 45.99757877895685, 28.988164008719938, 14.15350173042544, 26.3588985494634, 5.505296035084255, 38.272060554205325, 3.489575918767172, 17.23652061704322, 28.740300700812824, 19.5881465137755, 31.067155188307755, 21.37162974404952, 12.673074102680355, 7.555421319212019, 36.73878677123436, 7.667545899096478, 29.773325260563336, 19.61221137289417, 16.99585664562156, 21.641876248386296]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2856928695472045, "mean_inference_ms": 0.9515564176525751, "mean_action_processing_ms": 0.12702883293827294, "mean_env_wait_ms": 0.06710181091660992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037147998809814453, "StateBufferConnector_ms": 0.002785205841064453, "ViewRequirementAgentConnector_ms": 0.0510258674621582}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1208000, "num_agent_steps_trained": 1208000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 739.5597434650729, "num_env_steps_trained_throughput_per_sec": 739.5597434650729, "timesteps_total": 604000, "num_env_steps_sampled_lifetime": 604000, "num_agent_steps_sampled_lifetime": 1208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1208000, "timers": {"training_iteration_time_ms": 5536.257, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5536.224, "sample_time_ms": 715.553, "learn_time_ms": 4806.99, "learn_throughput": 832.121, "synch_weights_time_ms": 13.307}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1208000, "num_agent_steps_trained": 1208000}, "done": false, "training_iteration": 151, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-08-46", "timestamp": 1723396126, "time_this_iter_s": 5.4138429164886475, "time_total_s": 842.8971195220947, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f60670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 842.8971195220947, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 28.05, "ram_util_percent": 81.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8677773426209267, "cur_kl_coeff": 4.8148248609680906e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06840946369023489, "policy_loss": 4.3144030375212124e-05, "vf_loss": 0.0683663196466417, "vf_explained_var": 0.9922643377135197, "kl": 0.0018343934513968378, "entropy": 0.0840967329502746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 145440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8293945915065706, "cur_kl_coeff": 5.421010862427523e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06865425815218866, "policy_loss": -0.0034999809232734453, "vf_loss": 0.07215424008609261, "vf_explained_var": 0.9906184465313951, "kl": 0.001122180822005553, "entropy": 0.1882892781868577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 145440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -52.93369004429803, "predator_policy": 2.145159981769636}, "policy_reward_max": {"prey_policy": -2.145159981769636, "predator_policy": 52.93369004429803}, "policy_reward_mean": {"prey_policy": -23.397258774592117, "predator_policy": 23.397258774592117}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-9.2712293327786, -17.325055492586866, -22.922779600755096, -13.435888539557709, -35.145168291282275, -21.74148459304818, -14.939812401964284, -42.96810556848761, -19.17160879767195, -41.24726489669686, -24.86665196416676, -6.691134386963676, -26.6304431502907, -3.19092153675963, -38.510354739857696, -18.60301758543742, -12.190953944634929, -47.85274726694621, -30.011763621623206, -16.91697968803289, -16.903395280137268, -48.26434729580028, -13.224832514924763, -17.594624544497535, -21.78113730428015, -43.48869889180776, -10.101295520374602, -29.91762911773378, -39.47217535532452, -18.589807761395647, -12.158351815370377, -35.791054405657945, -44.35997974414176, -6.9242959593815385, -52.93369004429803, -44.24411970727176, -28.57001490534004, -35.487193034095405, -14.285257869294375, -27.753115878356216, -34.90679116389485, -36.800951308671536, -4.327699541766051, -14.2086399771024, -7.7905905021727335, -15.96961839088693, -15.49759978952735, -12.112668322099445, -32.071799392386374, -15.61190197887052, -27.605605465131575, -32.38799018366855, -20.728455242332164, -7.254907609587933, -19.921136056348086, -23.740137708008746, -23.383828959641285, -21.652745498677575, -31.60263804768406, -2.145159981769636, -34.05621567783801, -5.600000703134995, -27.953040519441004, -20.03704018578143, -9.709852105858598, -28.474140045850724, -32.84005748121183, -11.968968103092815, -40.692064362190166, -31.958975171114517, -9.740452147982245, -11.356328276220093, -37.646629638218904, -29.55031995430114, -8.923785509201798, -23.02344809775131, -45.99757877895685, -28.988164008719938, -14.15350173042544, -26.3588985494634, -5.505296035084255, -38.272060554205325, -3.489575918767172, -17.23652061704322, -28.740300700812824, -19.5881465137755, -31.067155188307755, -21.37162974404952, -12.673074102680355, -7.555421319212019, -36.73878677123436, -7.667545899096478, -29.773325260563336, -19.61221137289417, -16.99585664562156, -21.641876248386296, -12.38964664119242, -40.22908176992302, -45.141977533424786, -19.80768010692777], "policy_predator_policy_reward": [9.2712293327786, 17.325055492586866, 22.922779600755096, 13.435888539557709, 35.145168291282275, 21.74148459304818, 14.939812401964284, 42.96810556848761, 19.17160879767195, 41.24726489669686, 24.86665196416676, 6.691134386963676, 26.6304431502907, 3.19092153675963, 38.510354739857696, 18.60301758543742, 12.190953944634929, 47.85274726694621, 30.011763621623206, 16.91697968803289, 16.903395280137268, 48.26434729580028, 13.224832514924763, 17.594624544497535, 21.78113730428015, 43.48869889180776, 10.101295520374602, 29.91762911773378, 39.47217535532452, 18.589807761395647, 12.158351815370377, 35.791054405657945, 44.35997974414176, 6.9242959593815385, 52.93369004429803, 44.24411970727176, 28.57001490534004, 35.487193034095405, 14.285257869294375, 27.753115878356216, 34.90679116389485, 36.800951308671536, 4.327699541766051, 14.2086399771024, 7.7905905021727335, 15.96961839088693, 15.49759978952735, 12.112668322099445, 32.071799392386374, 15.61190197887052, 27.605605465131575, 32.38799018366855, 20.728455242332164, 7.254907609587933, 19.921136056348086, 23.740137708008746, 23.383828959641285, 21.652745498677575, 31.60263804768406, 2.145159981769636, 34.05621567783801, 5.600000703134995, 27.953040519441004, 20.03704018578143, 9.709852105858598, 28.474140045850724, 32.84005748121183, 11.968968103092815, 40.692064362190166, 31.958975171114517, 9.740452147982245, 11.356328276220093, 37.646629638218904, 29.55031995430114, 8.923785509201798, 23.02344809775131, 45.99757877895685, 28.988164008719938, 14.15350173042544, 26.3588985494634, 5.505296035084255, 38.272060554205325, 3.489575918767172, 17.23652061704322, 28.740300700812824, 19.5881465137755, 31.067155188307755, 21.37162974404952, 12.673074102680355, 7.555421319212019, 36.73878677123436, 7.667545899096478, 29.773325260563336, 19.61221137289417, 16.99585664562156, 21.641876248386296, 12.38964664119242, 40.22908176992302, 45.141977533424786, 19.80768010692777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28560449499049384, "mean_inference_ms": 0.9515571887272475, "mean_action_processing_ms": 0.12700867253726136, "mean_env_wait_ms": 0.06709572307858946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037533044815063477, "StateBufferConnector_ms": 0.0028562545776367188, "ViewRequirementAgentConnector_ms": 0.0518261194229126}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 24.71434892205182, "num_env_steps_trained_throughput_per_sec": 24.71434892205182, "timesteps_total": 608000, "num_env_steps_sampled_lifetime": 608000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 21107.012, "restore_workers_time_ms": 0.013, "training_step_time_ms": 21106.977, "sample_time_ms": 675.447, "learn_time_ms": 20417.903, "learn_throughput": 195.907, "synch_weights_time_ms": 13.231}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 152, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-11-28", "timestamp": 1723396288, "time_this_iter_s": 161.90250182151794, "time_total_s": 1004.7996213436127, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9fbb8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1004.7996213436127, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 77.9, "ram_util_percent": 84.04499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.910114634471635, "cur_kl_coeff": 2.4074124304840453e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09602257047057113, "policy_loss": -0.004043544812884647, "vf_loss": 0.10006611582357436, "vf_explained_var": 0.9942925023535888, "kl": 0.013646722892352177, "entropy": 0.07600387324346229, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 146400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0117269923444838, "cur_kl_coeff": 2.7105054312137616e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09512192261851547, "policy_loss": -0.0050606377044459805, "vf_loss": 0.10018255993491039, "vf_explained_var": 0.995247321203351, "kl": 0.004420567279806659, "entropy": 0.19951645103283228, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 146400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -52.93369004429803, "predator_policy": 2.145159981769636}, "policy_reward_max": {"prey_policy": -2.145159981769636, "predator_policy": 52.93369004429803}, "policy_reward_mean": {"prey_policy": -24.17930136119621, "predator_policy": 24.17930136119621}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-41.24726489669686, -24.86665196416676, -6.691134386963676, -26.6304431502907, -3.19092153675963, -38.510354739857696, -18.60301758543742, -12.190953944634929, -47.85274726694621, -30.011763621623206, -16.91697968803289, -16.903395280137268, -48.26434729580028, -13.224832514924763, -17.594624544497535, -21.78113730428015, -43.48869889180776, -10.101295520374602, -29.91762911773378, -39.47217535532452, -18.589807761395647, -12.158351815370377, -35.791054405657945, -44.35997974414176, -6.9242959593815385, -52.93369004429803, -44.24411970727176, -28.57001490534004, -35.487193034095405, -14.285257869294375, -27.753115878356216, -34.90679116389485, -36.800951308671536, -4.327699541766051, -14.2086399771024, -7.7905905021727335, -15.96961839088693, -15.49759978952735, -12.112668322099445, -32.071799392386374, -15.61190197887052, -27.605605465131575, -32.38799018366855, -20.728455242332164, -7.254907609587933, -19.921136056348086, -23.740137708008746, -23.383828959641285, -21.652745498677575, -31.60263804768406, -2.145159981769636, -34.05621567783801, -5.600000703134995, -27.953040519441004, -20.03704018578143, -9.709852105858598, -28.474140045850724, -32.84005748121183, -11.968968103092815, -40.692064362190166, -31.958975171114517, -9.740452147982245, -11.356328276220093, -37.646629638218904, -29.55031995430114, -8.923785509201798, -23.02344809775131, -45.99757877895685, -28.988164008719938, -14.15350173042544, -26.3588985494634, -5.505296035084255, -38.272060554205325, -3.489575918767172, -17.23652061704322, -28.740300700812824, -19.5881465137755, -31.067155188307755, -21.37162974404952, -12.673074102680355, -7.555421319212019, -36.73878677123436, -7.667545899096478, -29.773325260563336, -19.61221137289417, -16.99585664562156, -21.641876248386296, -12.38964664119242, -40.22908176992302, -45.141977533424786, -19.80768010692777, -9.268808542300485, -25.04437084727503, -31.806972293991212, -43.22663756567552, -26.61877024689311, -40.70638275104814, -35.18120724189132, -23.291935571232237, -39.98030621823497], "policy_predator_policy_reward": [41.24726489669686, 24.86665196416676, 6.691134386963676, 26.6304431502907, 3.19092153675963, 38.510354739857696, 18.60301758543742, 12.190953944634929, 47.85274726694621, 30.011763621623206, 16.91697968803289, 16.903395280137268, 48.26434729580028, 13.224832514924763, 17.594624544497535, 21.78113730428015, 43.48869889180776, 10.101295520374602, 29.91762911773378, 39.47217535532452, 18.589807761395647, 12.158351815370377, 35.791054405657945, 44.35997974414176, 6.9242959593815385, 52.93369004429803, 44.24411970727176, 28.57001490534004, 35.487193034095405, 14.285257869294375, 27.753115878356216, 34.90679116389485, 36.800951308671536, 4.327699541766051, 14.2086399771024, 7.7905905021727335, 15.96961839088693, 15.49759978952735, 12.112668322099445, 32.071799392386374, 15.61190197887052, 27.605605465131575, 32.38799018366855, 20.728455242332164, 7.254907609587933, 19.921136056348086, 23.740137708008746, 23.383828959641285, 21.652745498677575, 31.60263804768406, 2.145159981769636, 34.05621567783801, 5.600000703134995, 27.953040519441004, 20.03704018578143, 9.709852105858598, 28.474140045850724, 32.84005748121183, 11.968968103092815, 40.692064362190166, 31.958975171114517, 9.740452147982245, 11.356328276220093, 37.646629638218904, 29.55031995430114, 8.923785509201798, 23.02344809775131, 45.99757877895685, 28.988164008719938, 14.15350173042544, 26.3588985494634, 5.505296035084255, 38.272060554205325, 3.489575918767172, 17.23652061704322, 28.740300700812824, 19.5881465137755, 31.067155188307755, 21.37162974404952, 12.673074102680355, 7.555421319212019, 36.73878677123436, 7.667545899096478, 29.773325260563336, 19.61221137289417, 16.99585664562156, 21.641876248386296, 12.38964664119242, 40.22908176992302, 45.141977533424786, 19.80768010692777, 9.268808542300485, 25.04437084727503, 31.806972293991212, 43.22663756567552, 26.61877024689311, 40.70638275104814, 35.18120724189132, 23.291935571232237, 39.98030621823497]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28575852079489233, "mean_inference_ms": 0.9520494525813823, "mean_action_processing_ms": 0.1270563302693104, "mean_env_wait_ms": 0.06712951652275187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036927461624145508, "StateBufferConnector_ms": 0.002973198890686035, "ViewRequirementAgentConnector_ms": 0.05594813823699951}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 534.6390804058526, "num_env_steps_trained_throughput_per_sec": 534.6390804058526, "timesteps_total": 612000, "num_env_steps_sampled_lifetime": 612000, "num_agent_steps_sampled_lifetime": 1224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 21279.623, "restore_workers_time_ms": 0.013, "training_step_time_ms": 21279.581, "sample_time_ms": 716.048, "learn_time_ms": 20548.241, "learn_throughput": 194.664, "synch_weights_time_ms": 14.65}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "training_iteration": 153, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-11-36", "timestamp": 1723396296, "time_this_iter_s": 7.534777641296387, "time_total_s": 1012.3343989849091, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9fbbc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1012.3343989849091, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 67.37272727272726, "ram_util_percent": 80.69090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0144900515209883, "cur_kl_coeff": 2.4074124304840453e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06021450373615759, "policy_loss": -0.0005895701993722469, "vf_loss": 0.0608040737764289, "vf_explained_var": 0.9967068978895743, "kl": 0.0007359298798249647, "entropy": 0.06686577046784806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 147360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8833169503835961, "cur_kl_coeff": 1.3552527156068808e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04503526969929226, "policy_loss": -0.02152146785592777, "vf_loss": 0.0665567376903103, "vf_explained_var": 0.9963847786809007, "kl": 0.011081111741824773, "entropy": 0.22943769845490655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 147360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -52.93369004429803, "predator_policy": 2.145159981769636}, "policy_reward_max": {"prey_policy": -2.145159981769636, "predator_policy": 52.93369004429803}, "policy_reward_mean": {"prey_policy": -23.876428886309522, "predator_policy": 23.876428886309522}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-30.011763621623206, -16.91697968803289, -16.903395280137268, -48.26434729580028, -13.224832514924763, -17.594624544497535, -21.78113730428015, -43.48869889180776, -10.101295520374602, -29.91762911773378, -39.47217535532452, -18.589807761395647, -12.158351815370377, -35.791054405657945, -44.35997974414176, -6.9242959593815385, -52.93369004429803, -44.24411970727176, -28.57001490534004, -35.487193034095405, -14.285257869294375, -27.753115878356216, -34.90679116389485, -36.800951308671536, -4.327699541766051, -14.2086399771024, -7.7905905021727335, -15.96961839088693, -15.49759978952735, -12.112668322099445, -32.071799392386374, -15.61190197887052, -27.605605465131575, -32.38799018366855, -20.728455242332164, -7.254907609587933, -19.921136056348086, -23.740137708008746, -23.383828959641285, -21.652745498677575, -31.60263804768406, -2.145159981769636, -34.05621567783801, -5.600000703134995, -27.953040519441004, -20.03704018578143, -9.709852105858598, -28.474140045850724, -32.84005748121183, -11.968968103092815, -40.692064362190166, -31.958975171114517, -9.740452147982245, -11.356328276220093, -37.646629638218904, -29.55031995430114, -8.923785509201798, -23.02344809775131, -45.99757877895685, -28.988164008719938, -14.15350173042544, -26.3588985494634, -5.505296035084255, -38.272060554205325, -3.489575918767172, -17.23652061704322, -28.740300700812824, -19.5881465137755, -31.067155188307755, -21.37162974404952, -12.673074102680355, -7.555421319212019, -36.73878677123436, -7.667545899096478, -29.773325260563336, -19.61221137289417, -16.99585664562156, -21.641876248386296, -12.38964664119242, -40.22908176992302, -45.141977533424786, -19.80768010692777, -9.268808542300485, -25.04437084727503, -31.806972293991212, -43.22663756567552, -26.61877024689311, -40.70638275104814, -35.18120724189132, -23.291935571232237, -39.98030621823497, -28.89538767716743, -2.2354860533839984, -13.614439553936412, -26.273580416493253, -19.460601447477483, -5.955252836016908, -42.58153443500117, -9.430170821540251, -41.04978874206844], "policy_predator_policy_reward": [30.011763621623206, 16.91697968803289, 16.903395280137268, 48.26434729580028, 13.224832514924763, 17.594624544497535, 21.78113730428015, 43.48869889180776, 10.101295520374602, 29.91762911773378, 39.47217535532452, 18.589807761395647, 12.158351815370377, 35.791054405657945, 44.35997974414176, 6.9242959593815385, 52.93369004429803, 44.24411970727176, 28.57001490534004, 35.487193034095405, 14.285257869294375, 27.753115878356216, 34.90679116389485, 36.800951308671536, 4.327699541766051, 14.2086399771024, 7.7905905021727335, 15.96961839088693, 15.49759978952735, 12.112668322099445, 32.071799392386374, 15.61190197887052, 27.605605465131575, 32.38799018366855, 20.728455242332164, 7.254907609587933, 19.921136056348086, 23.740137708008746, 23.383828959641285, 21.652745498677575, 31.60263804768406, 2.145159981769636, 34.05621567783801, 5.600000703134995, 27.953040519441004, 20.03704018578143, 9.709852105858598, 28.474140045850724, 32.84005748121183, 11.968968103092815, 40.692064362190166, 31.958975171114517, 9.740452147982245, 11.356328276220093, 37.646629638218904, 29.55031995430114, 8.923785509201798, 23.02344809775131, 45.99757877895685, 28.988164008719938, 14.15350173042544, 26.3588985494634, 5.505296035084255, 38.272060554205325, 3.489575918767172, 17.23652061704322, 28.740300700812824, 19.5881465137755, 31.067155188307755, 21.37162974404952, 12.673074102680355, 7.555421319212019, 36.73878677123436, 7.667545899096478, 29.773325260563336, 19.61221137289417, 16.99585664562156, 21.641876248386296, 12.38964664119242, 40.22908176992302, 45.141977533424786, 19.80768010692777, 9.268808542300485, 25.04437084727503, 31.806972293991212, 43.22663756567552, 26.61877024689311, 40.70638275104814, 35.18120724189132, 23.291935571232237, 39.98030621823497, 28.89538767716743, 2.2354860533839984, 13.614439553936412, 26.273580416493253, 19.460601447477483, 5.955252836016908, 42.58153443500117, 9.430170821540251, 41.04978874206844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28597352461095943, "mean_inference_ms": 0.9529270028553944, "mean_action_processing_ms": 0.12714154892228585, "mean_env_wait_ms": 0.06721227418783993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00316011905670166, "StateBufferConnector_ms": 0.0029898881912231445, "ViewRequirementAgentConnector_ms": 0.059273481369018555}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 608.2484490172402, "num_env_steps_trained_throughput_per_sec": 608.2484490172402, "timesteps_total": 616000, "num_env_steps_sampled_lifetime": 616000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 21402.549, "restore_workers_time_ms": 0.409, "training_step_time_ms": 21401.462, "sample_time_ms": 774.899, "learn_time_ms": 20611.383, "learn_throughput": 194.068, "synch_weights_time_ms": 14.532}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 154, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-11-42", "timestamp": 1723396302, "time_this_iter_s": 6.592848777770996, "time_total_s": 1018.92724776268, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9fbb550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1018.92724776268, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 50.28888888888889, "ram_util_percent": 81.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7026930366099502, "cur_kl_coeff": 1.2037062152420226e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03027797748412316, "policy_loss": -0.0008532412581795749, "vf_loss": 0.031131218169563605, "vf_explained_var": 0.9973328978444139, "kl": 0.010750966435000316, "entropy": 0.06974103627241372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 148320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6253651710848014, "cur_kl_coeff": 1.3552527156068808e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.022828981944136708, "policy_loss": -0.007343760118237697, "vf_loss": 0.03017274180650323, "vf_explained_var": 0.9976385112851858, "kl": 0.006410004184542211, "entropy": 0.20820553619414567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 148320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -52.93369004429803, "predator_policy": 2.145159981769636}, "policy_reward_max": {"prey_policy": -2.145159981769636, "predator_policy": 52.93369004429803}, "policy_reward_mean": {"prey_policy": -23.992261058542873, "predator_policy": 23.992261058542873}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-17.594624544497535, -21.78113730428015, -43.48869889180776, -10.101295520374602, -29.91762911773378, -39.47217535532452, -18.589807761395647, -12.158351815370377, -35.791054405657945, -44.35997974414176, -6.9242959593815385, -52.93369004429803, -44.24411970727176, -28.57001490534004, -35.487193034095405, -14.285257869294375, -27.753115878356216, -34.90679116389485, -36.800951308671536, -4.327699541766051, -14.2086399771024, -7.7905905021727335, -15.96961839088693, -15.49759978952735, -12.112668322099445, -32.071799392386374, -15.61190197887052, -27.605605465131575, -32.38799018366855, -20.728455242332164, -7.254907609587933, -19.921136056348086, -23.740137708008746, -23.383828959641285, -21.652745498677575, -31.60263804768406, -2.145159981769636, -34.05621567783801, -5.600000703134995, -27.953040519441004, -20.03704018578143, -9.709852105858598, -28.474140045850724, -32.84005748121183, -11.968968103092815, -40.692064362190166, -31.958975171114517, -9.740452147982245, -11.356328276220093, -37.646629638218904, -29.55031995430114, -8.923785509201798, -23.02344809775131, -45.99757877895685, -28.988164008719938, -14.15350173042544, -26.3588985494634, -5.505296035084255, -38.272060554205325, -3.489575918767172, -17.23652061704322, -28.740300700812824, -19.5881465137755, -31.067155188307755, -21.37162974404952, -12.673074102680355, -7.555421319212019, -36.73878677123436, -7.667545899096478, -29.773325260563336, -19.61221137289417, -16.99585664562156, -21.641876248386296, -12.38964664119242, -40.22908176992302, -45.141977533424786, -19.80768010692777, -9.268808542300485, -25.04437084727503, -31.806972293991212, -43.22663756567552, -26.61877024689311, -40.70638275104814, -35.18120724189132, -23.291935571232237, -39.98030621823497, -28.89538767716743, -2.2354860533839984, -13.614439553936412, -26.273580416493253, -19.460601447477483, -5.955252836016908, -42.58153443500117, -9.430170821540251, -41.04978874206844, -41.11371247090039, -20.545272674463448, -11.98757478560323, -17.531169800286634, -45.72680589260006], "policy_predator_policy_reward": [17.594624544497535, 21.78113730428015, 43.48869889180776, 10.101295520374602, 29.91762911773378, 39.47217535532452, 18.589807761395647, 12.158351815370377, 35.791054405657945, 44.35997974414176, 6.9242959593815385, 52.93369004429803, 44.24411970727176, 28.57001490534004, 35.487193034095405, 14.285257869294375, 27.753115878356216, 34.90679116389485, 36.800951308671536, 4.327699541766051, 14.2086399771024, 7.7905905021727335, 15.96961839088693, 15.49759978952735, 12.112668322099445, 32.071799392386374, 15.61190197887052, 27.605605465131575, 32.38799018366855, 20.728455242332164, 7.254907609587933, 19.921136056348086, 23.740137708008746, 23.383828959641285, 21.652745498677575, 31.60263804768406, 2.145159981769636, 34.05621567783801, 5.600000703134995, 27.953040519441004, 20.03704018578143, 9.709852105858598, 28.474140045850724, 32.84005748121183, 11.968968103092815, 40.692064362190166, 31.958975171114517, 9.740452147982245, 11.356328276220093, 37.646629638218904, 29.55031995430114, 8.923785509201798, 23.02344809775131, 45.99757877895685, 28.988164008719938, 14.15350173042544, 26.3588985494634, 5.505296035084255, 38.272060554205325, 3.489575918767172, 17.23652061704322, 28.740300700812824, 19.5881465137755, 31.067155188307755, 21.37162974404952, 12.673074102680355, 7.555421319212019, 36.73878677123436, 7.667545899096478, 29.773325260563336, 19.61221137289417, 16.99585664562156, 21.641876248386296, 12.38964664119242, 40.22908176992302, 45.141977533424786, 19.80768010692777, 9.268808542300485, 25.04437084727503, 31.806972293991212, 43.22663756567552, 26.61877024689311, 40.70638275104814, 35.18120724189132, 23.291935571232237, 39.98030621823497, 28.89538767716743, 2.2354860533839984, 13.614439553936412, 26.273580416493253, 19.460601447477483, 5.955252836016908, 42.58153443500117, 9.430170821540251, 41.04978874206844, 41.11371247090039, 20.545272674463448, 11.98757478560323, 17.531169800286634, 45.72680589260006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2861522797774508, "mean_inference_ms": 0.953322576350328, "mean_action_processing_ms": 0.1272056600387627, "mean_env_wait_ms": 0.06725932719066272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003119826316833496, "StateBufferConnector_ms": 0.0026928186416625977, "ViewRequirementAgentConnector_ms": 0.058957815170288086}, "num_episodes": 5, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 715.2267412660821, "num_env_steps_trained_throughput_per_sec": 715.2267412660821, "timesteps_total": 620000, "num_env_steps_sampled_lifetime": 620000, "num_agent_steps_sampled_lifetime": 1240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1240000, "timers": {"training_iteration_time_ms": 21415.198, "restore_workers_time_ms": 0.409, "training_step_time_ms": 21414.112, "sample_time_ms": 772.728, "learn_time_ms": 20625.159, "learn_throughput": 193.938, "synch_weights_time_ms": 15.569}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "done": false, "training_iteration": 155, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-11-48", "timestamp": 1723396308, "time_this_iter_s": 5.60465407371521, "time_total_s": 1024.5319018363953, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9fbb790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1024.5319018363953, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 30.825000000000003, "ram_util_percent": 80.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.002022510751461, "cur_kl_coeff": 1.2037062152420226e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.055268536916264564, "policy_loss": 0.00015937800393051778, "vf_loss": 0.05510915917984675, "vf_explained_var": 0.9973228926459948, "kl": 0.000537379017219534, "entropy": 0.07606515264196786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 149280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9819085486388455, "cur_kl_coeff": 1.3552527156068808e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04452285312169503, "policy_loss": -0.007992953631764976, "vf_loss": 0.05251580636249855, "vf_explained_var": 0.9970624114076296, "kl": 0.0031847279104586807, "entropy": 0.2250001557637006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 149280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -52.93369004429803, "predator_policy": 2.145159981769636}, "policy_reward_max": {"prey_policy": -2.145159981769636, "predator_policy": 52.93369004429803}, "policy_reward_mean": {"prey_policy": -23.83828043646619, "predator_policy": 23.83828043646619}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-44.35997974414176, -6.9242959593815385, -52.93369004429803, -44.24411970727176, -28.57001490534004, -35.487193034095405, -14.285257869294375, -27.753115878356216, -34.90679116389485, -36.800951308671536, -4.327699541766051, -14.2086399771024, -7.7905905021727335, -15.96961839088693, -15.49759978952735, -12.112668322099445, -32.071799392386374, -15.61190197887052, -27.605605465131575, -32.38799018366855, -20.728455242332164, -7.254907609587933, -19.921136056348086, -23.740137708008746, -23.383828959641285, -21.652745498677575, -31.60263804768406, -2.145159981769636, -34.05621567783801, -5.600000703134995, -27.953040519441004, -20.03704018578143, -9.709852105858598, -28.474140045850724, -32.84005748121183, -11.968968103092815, -40.692064362190166, -31.958975171114517, -9.740452147982245, -11.356328276220093, -37.646629638218904, -29.55031995430114, -8.923785509201798, -23.02344809775131, -45.99757877895685, -28.988164008719938, -14.15350173042544, -26.3588985494634, -5.505296035084255, -38.272060554205325, -3.489575918767172, -17.23652061704322, -28.740300700812824, -19.5881465137755, -31.067155188307755, -21.37162974404952, -12.673074102680355, -7.555421319212019, -36.73878677123436, -7.667545899096478, -29.773325260563336, -19.61221137289417, -16.99585664562156, -21.641876248386296, -12.38964664119242, -40.22908176992302, -45.141977533424786, -19.80768010692777, -9.268808542300485, -25.04437084727503, -31.806972293991212, -43.22663756567552, -26.61877024689311, -40.70638275104814, -35.18120724189132, -23.291935571232237, -39.98030621823497, -28.89538767716743, -2.2354860533839984, -13.614439553936412, -26.273580416493253, -19.460601447477483, -5.955252836016908, -42.58153443500117, -9.430170821540251, -41.04978874206844, -41.11371247090039, -20.545272674463448, -11.98757478560323, -17.531169800286634, -45.72680589260006, -42.228786675263976, -10.09075482397131, -16.301953673120078, -24.554369356191184, -46.5282342471656, -9.24095804147866, -15.867238096465712, -36.05447212193206, -12.629945473184229], "policy_predator_policy_reward": [44.35997974414176, 6.9242959593815385, 52.93369004429803, 44.24411970727176, 28.57001490534004, 35.487193034095405, 14.285257869294375, 27.753115878356216, 34.90679116389485, 36.800951308671536, 4.327699541766051, 14.2086399771024, 7.7905905021727335, 15.96961839088693, 15.49759978952735, 12.112668322099445, 32.071799392386374, 15.61190197887052, 27.605605465131575, 32.38799018366855, 20.728455242332164, 7.254907609587933, 19.921136056348086, 23.740137708008746, 23.383828959641285, 21.652745498677575, 31.60263804768406, 2.145159981769636, 34.05621567783801, 5.600000703134995, 27.953040519441004, 20.03704018578143, 9.709852105858598, 28.474140045850724, 32.84005748121183, 11.968968103092815, 40.692064362190166, 31.958975171114517, 9.740452147982245, 11.356328276220093, 37.646629638218904, 29.55031995430114, 8.923785509201798, 23.02344809775131, 45.99757877895685, 28.988164008719938, 14.15350173042544, 26.3588985494634, 5.505296035084255, 38.272060554205325, 3.489575918767172, 17.23652061704322, 28.740300700812824, 19.5881465137755, 31.067155188307755, 21.37162974404952, 12.673074102680355, 7.555421319212019, 36.73878677123436, 7.667545899096478, 29.773325260563336, 19.61221137289417, 16.99585664562156, 21.641876248386296, 12.38964664119242, 40.22908176992302, 45.141977533424786, 19.80768010692777, 9.268808542300485, 25.04437084727503, 31.806972293991212, 43.22663756567552, 26.61877024689311, 40.70638275104814, 35.18120724189132, 23.291935571232237, 39.98030621823497, 28.89538767716743, 2.2354860533839984, 13.614439553936412, 26.273580416493253, 19.460601447477483, 5.955252836016908, 42.58153443500117, 9.430170821540251, 41.04978874206844, 41.11371247090039, 20.545272674463448, 11.98757478560323, 17.531169800286634, 45.72680589260006, 42.228786675263976, 10.09075482397131, 16.301953673120078, 24.554369356191184, 46.5282342471656, 9.24095804147866, 15.867238096465712, 36.05447212193206, 12.629945473184229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28659711702668267, "mean_inference_ms": 0.9544690925754915, "mean_action_processing_ms": 0.12728778147803047, "mean_env_wait_ms": 0.06735190180558534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003172755241394043, "StateBufferConnector_ms": 0.0027382373809814453, "ViewRequirementAgentConnector_ms": 0.06094241142272949}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 652.8692273893969, "num_env_steps_trained_throughput_per_sec": 652.8692273893969, "timesteps_total": 624000, "num_env_steps_sampled_lifetime": 624000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 21493.744, "restore_workers_time_ms": 0.409, "training_step_time_ms": 21492.657, "sample_time_ms": 822.737, "learn_time_ms": 20653.554, "learn_throughput": 193.671, "synch_weights_time_ms": 15.707}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 156, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-11-54", "timestamp": 1723396314, "time_this_iter_s": 6.131934404373169, "time_total_s": 1030.6638362407684, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9ed1f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1030.6638362407684, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 39.599999999999994, "ram_util_percent": 80.55555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.171131067443639, "cur_kl_coeff": 6.018531076210113e-37, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.10100339735581657, "policy_loss": 0.0002576420595384358, "vf_loss": 0.10074575566880715, "vf_explained_var": 0.9963706420113643, "kl": 0.0007456198214563623, "entropy": 0.07776046437308347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 150240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0517083914484828, "cur_kl_coeff": 6.776263578034404e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06882239751770006, "policy_loss": -0.013230696983858556, "vf_loss": 0.08205309512559325, "vf_explained_var": 0.9971182690312465, "kl": 0.006887342995033848, "entropy": 0.23479651403613389, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 150240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1256000, "num_agent_steps_trained": 1256000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -46.5282342471656, "predator_policy": 2.145159981769636}, "policy_reward_max": {"prey_policy": -2.145159981769636, "predator_policy": 46.5282342471656}, "policy_reward_mean": {"prey_policy": -23.395121625088155, "predator_policy": 23.395121625088155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-36.800951308671536, -4.327699541766051, -14.2086399771024, -7.7905905021727335, -15.96961839088693, -15.49759978952735, -12.112668322099445, -32.071799392386374, -15.61190197887052, -27.605605465131575, -32.38799018366855, -20.728455242332164, -7.254907609587933, -19.921136056348086, -23.740137708008746, -23.383828959641285, -21.652745498677575, -31.60263804768406, -2.145159981769636, -34.05621567783801, -5.600000703134995, -27.953040519441004, -20.03704018578143, -9.709852105858598, -28.474140045850724, -32.84005748121183, -11.968968103092815, -40.692064362190166, -31.958975171114517, -9.740452147982245, -11.356328276220093, -37.646629638218904, -29.55031995430114, -8.923785509201798, -23.02344809775131, -45.99757877895685, -28.988164008719938, -14.15350173042544, -26.3588985494634, -5.505296035084255, -38.272060554205325, -3.489575918767172, -17.23652061704322, -28.740300700812824, -19.5881465137755, -31.067155188307755, -21.37162974404952, -12.673074102680355, -7.555421319212019, -36.73878677123436, -7.667545899096478, -29.773325260563336, -19.61221137289417, -16.99585664562156, -21.641876248386296, -12.38964664119242, -40.22908176992302, -45.141977533424786, -19.80768010692777, -9.268808542300485, -25.04437084727503, -31.806972293991212, -43.22663756567552, -26.61877024689311, -40.70638275104814, -35.18120724189132, -23.291935571232237, -39.98030621823497, -28.89538767716743, -2.2354860533839984, -13.614439553936412, -26.273580416493253, -19.460601447477483, -5.955252836016908, -42.58153443500117, -9.430170821540251, -41.04978874206844, -41.11371247090039, -20.545272674463448, -11.98757478560323, -17.531169800286634, -45.72680589260006, -42.228786675263976, -10.09075482397131, -16.301953673120078, -24.554369356191184, -46.5282342471656, -9.24095804147866, -15.867238096465712, -36.05447212193206, -12.629945473184229, -2.8265296685426082, -15.009801227923266, -28.68259342911934, -36.05932537866132, -31.935495666274264, -30.539987313486577, -45.846561757545814, -32.48968175394813, -21.758600972770502], "policy_predator_policy_reward": [36.800951308671536, 4.327699541766051, 14.2086399771024, 7.7905905021727335, 15.96961839088693, 15.49759978952735, 12.112668322099445, 32.071799392386374, 15.61190197887052, 27.605605465131575, 32.38799018366855, 20.728455242332164, 7.254907609587933, 19.921136056348086, 23.740137708008746, 23.383828959641285, 21.652745498677575, 31.60263804768406, 2.145159981769636, 34.05621567783801, 5.600000703134995, 27.953040519441004, 20.03704018578143, 9.709852105858598, 28.474140045850724, 32.84005748121183, 11.968968103092815, 40.692064362190166, 31.958975171114517, 9.740452147982245, 11.356328276220093, 37.646629638218904, 29.55031995430114, 8.923785509201798, 23.02344809775131, 45.99757877895685, 28.988164008719938, 14.15350173042544, 26.3588985494634, 5.505296035084255, 38.272060554205325, 3.489575918767172, 17.23652061704322, 28.740300700812824, 19.5881465137755, 31.067155188307755, 21.37162974404952, 12.673074102680355, 7.555421319212019, 36.73878677123436, 7.667545899096478, 29.773325260563336, 19.61221137289417, 16.99585664562156, 21.641876248386296, 12.38964664119242, 40.22908176992302, 45.141977533424786, 19.80768010692777, 9.268808542300485, 25.04437084727503, 31.806972293991212, 43.22663756567552, 26.61877024689311, 40.70638275104814, 35.18120724189132, 23.291935571232237, 39.98030621823497, 28.89538767716743, 2.2354860533839984, 13.614439553936412, 26.273580416493253, 19.460601447477483, 5.955252836016908, 42.58153443500117, 9.430170821540251, 41.04978874206844, 41.11371247090039, 20.545272674463448, 11.98757478560323, 17.531169800286634, 45.72680589260006, 42.228786675263976, 10.09075482397131, 16.301953673120078, 24.554369356191184, 46.5282342471656, 9.24095804147866, 15.867238096465712, 36.05447212193206, 12.629945473184229, 2.8265296685426082, 15.009801227923266, 28.68259342911934, 36.05932537866132, 31.935495666274264, 30.539987313486577, 45.846561757545814, 32.48968175394813, 21.758600972770502]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2868361521896887, "mean_inference_ms": 0.9554702909420897, "mean_action_processing_ms": 0.12739742250113426, "mean_env_wait_ms": 0.06743642064319909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032814741134643555, "StateBufferConnector_ms": 0.002743244171142578, "ViewRequirementAgentConnector_ms": 0.06135201454162598}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1256000, "num_agent_steps_trained": 1256000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 703.5088314443977, "num_env_steps_trained_throughput_per_sec": 703.5088314443977, "timesteps_total": 628000, "num_env_steps_sampled_lifetime": 628000, "num_agent_steps_sampled_lifetime": 1256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1256000, "timers": {"training_iteration_time_ms": 21534.32, "restore_workers_time_ms": 0.409, "training_step_time_ms": 21533.234, "sample_time_ms": 831.614, "learn_time_ms": 20685.269, "learn_throughput": 193.374, "synch_weights_time_ms": 15.693}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1256000, "num_agent_steps_trained": 1256000}, "done": false, "training_iteration": 157, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-12-00", "timestamp": 1723396320, "time_this_iter_s": 5.691022157669067, "time_total_s": 1036.3548583984375, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7874430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1036.3548583984375, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 31.775, "ram_util_percent": 80.35000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2158904706904043, "cur_kl_coeff": 3.0092655381050566e-37, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1402124703063843, "policy_loss": -0.00303885762768914, "vf_loss": 0.14325132831096804, "vf_explained_var": 0.9931506622582674, "kl": 0.00221905533604278, "entropy": 0.0882494246980059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 151200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0913085052898774, "cur_kl_coeff": 6.776263578034404e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.13988829808319375, "policy_loss": -0.0037915684564116723, "vf_loss": 0.14367986644695824, "vf_explained_var": 0.9927187601104379, "kl": 0.0016248639490743955, "entropy": 0.22602727855555713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 151200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -50.279816614507155, "predator_policy": 2.145159981769636}, "policy_reward_max": {"prey_policy": -2.145159981769636, "predator_policy": 50.279816614507155}, "policy_reward_mean": {"prey_policy": -24.609908795995857, "predator_policy": 24.609908795995857}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-27.605605465131575, -32.38799018366855, -20.728455242332164, -7.254907609587933, -19.921136056348086, -23.740137708008746, -23.383828959641285, -21.652745498677575, -31.60263804768406, -2.145159981769636, -34.05621567783801, -5.600000703134995, -27.953040519441004, -20.03704018578143, -9.709852105858598, -28.474140045850724, -32.84005748121183, -11.968968103092815, -40.692064362190166, -31.958975171114517, -9.740452147982245, -11.356328276220093, -37.646629638218904, -29.55031995430114, -8.923785509201798, -23.02344809775131, -45.99757877895685, -28.988164008719938, -14.15350173042544, -26.3588985494634, -5.505296035084255, -38.272060554205325, -3.489575918767172, -17.23652061704322, -28.740300700812824, -19.5881465137755, -31.067155188307755, -21.37162974404952, -12.673074102680355, -7.555421319212019, -36.73878677123436, -7.667545899096478, -29.773325260563336, -19.61221137289417, -16.99585664562156, -21.641876248386296, -12.38964664119242, -40.22908176992302, -45.141977533424786, -19.80768010692777, -9.268808542300485, -25.04437084727503, -31.806972293991212, -43.22663756567552, -26.61877024689311, -40.70638275104814, -35.18120724189132, -23.291935571232237, -39.98030621823497, -28.89538767716743, -2.2354860533839984, -13.614439553936412, -26.273580416493253, -19.460601447477483, -5.955252836016908, -42.58153443500117, -9.430170821540251, -41.04978874206844, -41.11371247090039, -20.545272674463448, -11.98757478560323, -17.531169800286634, -45.72680589260006, -42.228786675263976, -10.09075482397131, -16.301953673120078, -24.554369356191184, -46.5282342471656, -9.24095804147866, -15.867238096465712, -36.05447212193206, -12.629945473184229, -2.8265296685426082, -15.009801227923266, -28.68259342911934, -36.05932537866132, -31.935495666274264, -30.539987313486577, -45.846561757545814, -32.48968175394813, -21.758600972770502, -37.42818389146173, -32.271026357348234, -50.279816614507155, -48.91182480865115, -27.7443717411648, -6.647181071704699, -41.608015825083555, -16.481536265594926, -14.49822971873712], "policy_predator_policy_reward": [27.605605465131575, 32.38799018366855, 20.728455242332164, 7.254907609587933, 19.921136056348086, 23.740137708008746, 23.383828959641285, 21.652745498677575, 31.60263804768406, 2.145159981769636, 34.05621567783801, 5.600000703134995, 27.953040519441004, 20.03704018578143, 9.709852105858598, 28.474140045850724, 32.84005748121183, 11.968968103092815, 40.692064362190166, 31.958975171114517, 9.740452147982245, 11.356328276220093, 37.646629638218904, 29.55031995430114, 8.923785509201798, 23.02344809775131, 45.99757877895685, 28.988164008719938, 14.15350173042544, 26.3588985494634, 5.505296035084255, 38.272060554205325, 3.489575918767172, 17.23652061704322, 28.740300700812824, 19.5881465137755, 31.067155188307755, 21.37162974404952, 12.673074102680355, 7.555421319212019, 36.73878677123436, 7.667545899096478, 29.773325260563336, 19.61221137289417, 16.99585664562156, 21.641876248386296, 12.38964664119242, 40.22908176992302, 45.141977533424786, 19.80768010692777, 9.268808542300485, 25.04437084727503, 31.806972293991212, 43.22663756567552, 26.61877024689311, 40.70638275104814, 35.18120724189132, 23.291935571232237, 39.98030621823497, 28.89538767716743, 2.2354860533839984, 13.614439553936412, 26.273580416493253, 19.460601447477483, 5.955252836016908, 42.58153443500117, 9.430170821540251, 41.04978874206844, 41.11371247090039, 20.545272674463448, 11.98757478560323, 17.531169800286634, 45.72680589260006, 42.228786675263976, 10.09075482397131, 16.301953673120078, 24.554369356191184, 46.5282342471656, 9.24095804147866, 15.867238096465712, 36.05447212193206, 12.629945473184229, 2.8265296685426082, 15.009801227923266, 28.68259342911934, 36.05932537866132, 31.935495666274264, 30.539987313486577, 45.846561757545814, 32.48968175394813, 21.758600972770502, 37.42818389146173, 32.271026357348234, 50.279816614507155, 48.91182480865115, 27.7443717411648, 6.647181071704699, 41.608015825083555, 16.481536265594926, 14.49822971873712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2868707451550153, "mean_inference_ms": 0.9563314680583075, "mean_action_processing_ms": 0.12753696480644802, "mean_env_wait_ms": 0.06751310222070322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032320022583007812, "StateBufferConnector_ms": 0.0023505687713623047, "ViewRequirementAgentConnector_ms": 0.0599597692489624}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 699.2602407879995, "num_env_steps_trained_throughput_per_sec": 699.2602407879995, "timesteps_total": 632000, "num_env_steps_sampled_lifetime": 632000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 21534.662, "restore_workers_time_ms": 0.409, "training_step_time_ms": 21533.574, "sample_time_ms": 827.489, "learn_time_ms": 20689.684, "learn_throughput": 193.333, "synch_weights_time_ms": 15.737}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 158, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-12-06", "timestamp": 1723396326, "time_this_iter_s": 5.725867033004761, "time_total_s": 1042.0807254314423, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9ed1430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1042.0807254314423, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 31.4, "ram_util_percent": 79.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8253592496427397, "cur_kl_coeff": 1.5046327690525283e-37, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04962894090252424, "policy_loss": -0.0008802448251420476, "vf_loss": 0.050509185437113045, "vf_explained_var": 0.9965968304003279, "kl": 0.0008993707412428109, "entropy": 0.07377381655290567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 152160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8166196610468129, "cur_kl_coeff": 3.388131789017202e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.039517947169709564, "policy_loss": -0.0032917937360859165, "vf_loss": 0.04280974097394695, "vf_explained_var": 0.9975247429683805, "kl": 0.0024996628998656557, "entropy": 0.22675086714637777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 152160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -50.279816614507155, "predator_policy": 2.145159981769636}, "policy_reward_max": {"prey_policy": -2.145159981769636, "predator_policy": 50.279816614507155}, "policy_reward_mean": {"prey_policy": -24.937702894743452, "predator_policy": 24.937702894743452}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-2.145159981769636, -34.05621567783801, -5.600000703134995, -27.953040519441004, -20.03704018578143, -9.709852105858598, -28.474140045850724, -32.84005748121183, -11.968968103092815, -40.692064362190166, -31.958975171114517, -9.740452147982245, -11.356328276220093, -37.646629638218904, -29.55031995430114, -8.923785509201798, -23.02344809775131, -45.99757877895685, -28.988164008719938, -14.15350173042544, -26.3588985494634, -5.505296035084255, -38.272060554205325, -3.489575918767172, -17.23652061704322, -28.740300700812824, -19.5881465137755, -31.067155188307755, -21.37162974404952, -12.673074102680355, -7.555421319212019, -36.73878677123436, -7.667545899096478, -29.773325260563336, -19.61221137289417, -16.99585664562156, -21.641876248386296, -12.38964664119242, -40.22908176992302, -45.141977533424786, -19.80768010692777, -9.268808542300485, -25.04437084727503, -31.806972293991212, -43.22663756567552, -26.61877024689311, -40.70638275104814, -35.18120724189132, -23.291935571232237, -39.98030621823497, -28.89538767716743, -2.2354860533839984, -13.614439553936412, -26.273580416493253, -19.460601447477483, -5.955252836016908, -42.58153443500117, -9.430170821540251, -41.04978874206844, -41.11371247090039, -20.545272674463448, -11.98757478560323, -17.531169800286634, -45.72680589260006, -42.228786675263976, -10.09075482397131, -16.301953673120078, -24.554369356191184, -46.5282342471656, -9.24095804147866, -15.867238096465712, -36.05447212193206, -12.629945473184229, -2.8265296685426082, -15.009801227923266, -28.68259342911934, -36.05932537866132, -31.935495666274264, -30.539987313486577, -45.846561757545814, -32.48968175394813, -21.758600972770502, -37.42818389146173, -32.271026357348234, -50.279816614507155, -48.91182480865115, -27.7443717411648, -6.647181071704699, -41.608015825083555, -16.481536265594926, -14.49822971873712, -24.3402982990822, -38.99312291724147, -33.184168819033516, -6.783314339968194, -38.4241721287897, -25.125238586567498, -35.69139014398761, -15.111962153061935, -23.40318725810721], "policy_predator_policy_reward": [2.145159981769636, 34.05621567783801, 5.600000703134995, 27.953040519441004, 20.03704018578143, 9.709852105858598, 28.474140045850724, 32.84005748121183, 11.968968103092815, 40.692064362190166, 31.958975171114517, 9.740452147982245, 11.356328276220093, 37.646629638218904, 29.55031995430114, 8.923785509201798, 23.02344809775131, 45.99757877895685, 28.988164008719938, 14.15350173042544, 26.3588985494634, 5.505296035084255, 38.272060554205325, 3.489575918767172, 17.23652061704322, 28.740300700812824, 19.5881465137755, 31.067155188307755, 21.37162974404952, 12.673074102680355, 7.555421319212019, 36.73878677123436, 7.667545899096478, 29.773325260563336, 19.61221137289417, 16.99585664562156, 21.641876248386296, 12.38964664119242, 40.22908176992302, 45.141977533424786, 19.80768010692777, 9.268808542300485, 25.04437084727503, 31.806972293991212, 43.22663756567552, 26.61877024689311, 40.70638275104814, 35.18120724189132, 23.291935571232237, 39.98030621823497, 28.89538767716743, 2.2354860533839984, 13.614439553936412, 26.273580416493253, 19.460601447477483, 5.955252836016908, 42.58153443500117, 9.430170821540251, 41.04978874206844, 41.11371247090039, 20.545272674463448, 11.98757478560323, 17.531169800286634, 45.72680589260006, 42.228786675263976, 10.09075482397131, 16.301953673120078, 24.554369356191184, 46.5282342471656, 9.24095804147866, 15.867238096465712, 36.05447212193206, 12.629945473184229, 2.8265296685426082, 15.009801227923266, 28.68259342911934, 36.05932537866132, 31.935495666274264, 30.539987313486577, 45.846561757545814, 32.48968175394813, 21.758600972770502, 37.42818389146173, 32.271026357348234, 50.279816614507155, 48.91182480865115, 27.7443717411648, 6.647181071704699, 41.608015825083555, 16.481536265594926, 14.49822971873712, 24.3402982990822, 38.99312291724147, 33.184168819033516, 6.783314339968194, 38.4241721287897, 25.125238586567498, 35.69139014398761, 15.111962153061935, 23.40318725810721]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2871393061936088, "mean_inference_ms": 0.9574303731924956, "mean_action_processing_ms": 0.1276567946720386, "mean_env_wait_ms": 0.06760666502801943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003275752067565918, "StateBufferConnector_ms": 0.00239408016204834, "ViewRequirementAgentConnector_ms": 0.061527371406555176}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 710.3860602344748, "num_env_steps_trained_throughput_per_sec": 710.3860602344748, "timesteps_total": 636000, "num_env_steps_sampled_lifetime": 636000, "num_agent_steps_sampled_lifetime": 1272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 21554.539, "restore_workers_time_ms": 0.409, "training_step_time_ms": 21553.451, "sample_time_ms": 833.893, "learn_time_ms": 20703.53, "learn_throughput": 193.204, "synch_weights_time_ms": 15.376}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "training_iteration": 159, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-12-11", "timestamp": 1723396331, "time_this_iter_s": 5.635525941848755, "time_total_s": 1047.716251373291, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f2ff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1047.716251373291, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 31.7, "ram_util_percent": 79.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.938371405362462, "cur_kl_coeff": 7.523163845262642e-38, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05903926334649441, "policy_loss": -0.003021873053270004, "vf_loss": 0.062061136068950876, "vf_explained_var": 0.9937534398709734, "kl": 0.0024272203890208567, "entropy": 0.07482452578357576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 153120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9026190921276187, "cur_kl_coeff": 1.694065894508601e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06131265987666363, "policy_loss": -0.000930115025160679, "vf_loss": 0.06224277481184496, "vf_explained_var": 0.9935077134519815, "kl": 0.0025559139158160254, "entropy": 0.2382759793040653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 153120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -50.279816614507155, "predator_policy": 2.2354860533839984}, "policy_reward_max": {"prey_policy": -2.2354860533839984, "predator_policy": 50.279816614507155}, "policy_reward_mean": {"prey_policy": -25.37082515521679, "predator_policy": 25.37082515521679}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-40.692064362190166, -31.958975171114517, -9.740452147982245, -11.356328276220093, -37.646629638218904, -29.55031995430114, -8.923785509201798, -23.02344809775131, -45.99757877895685, -28.988164008719938, -14.15350173042544, -26.3588985494634, -5.505296035084255, -38.272060554205325, -3.489575918767172, -17.23652061704322, -28.740300700812824, -19.5881465137755, -31.067155188307755, -21.37162974404952, -12.673074102680355, -7.555421319212019, -36.73878677123436, -7.667545899096478, -29.773325260563336, -19.61221137289417, -16.99585664562156, -21.641876248386296, -12.38964664119242, -40.22908176992302, -45.141977533424786, -19.80768010692777, -9.268808542300485, -25.04437084727503, -31.806972293991212, -43.22663756567552, -26.61877024689311, -40.70638275104814, -35.18120724189132, -23.291935571232237, -39.98030621823497, -28.89538767716743, -2.2354860533839984, -13.614439553936412, -26.273580416493253, -19.460601447477483, -5.955252836016908, -42.58153443500117, -9.430170821540251, -41.04978874206844, -41.11371247090039, -20.545272674463448, -11.98757478560323, -17.531169800286634, -45.72680589260006, -42.228786675263976, -10.09075482397131, -16.301953673120078, -24.554369356191184, -46.5282342471656, -9.24095804147866, -15.867238096465712, -36.05447212193206, -12.629945473184229, -2.8265296685426082, -15.009801227923266, -28.68259342911934, -36.05932537866132, -31.935495666274264, -30.539987313486577, -45.846561757545814, -32.48968175394813, -21.758600972770502, -37.42818389146173, -32.271026357348234, -50.279816614507155, -48.91182480865115, -27.7443717411648, -6.647181071704699, -41.608015825083555, -16.481536265594926, -14.49822971873712, -24.3402982990822, -38.99312291724147, -33.184168819033516, -6.783314339968194, -38.4241721287897, -25.125238586567498, -35.69139014398761, -15.111962153061935, -23.40318725810721, -37.23163407727566, -27.903244122564768, -16.015564732859783, -30.208783299809383, -16.03074887301128, -26.47045140679754, -23.85018864079802, -14.299691658180965, -24.086394040015062], "policy_predator_policy_reward": [40.692064362190166, 31.958975171114517, 9.740452147982245, 11.356328276220093, 37.646629638218904, 29.55031995430114, 8.923785509201798, 23.02344809775131, 45.99757877895685, 28.988164008719938, 14.15350173042544, 26.3588985494634, 5.505296035084255, 38.272060554205325, 3.489575918767172, 17.23652061704322, 28.740300700812824, 19.5881465137755, 31.067155188307755, 21.37162974404952, 12.673074102680355, 7.555421319212019, 36.73878677123436, 7.667545899096478, 29.773325260563336, 19.61221137289417, 16.99585664562156, 21.641876248386296, 12.38964664119242, 40.22908176992302, 45.141977533424786, 19.80768010692777, 9.268808542300485, 25.04437084727503, 31.806972293991212, 43.22663756567552, 26.61877024689311, 40.70638275104814, 35.18120724189132, 23.291935571232237, 39.98030621823497, 28.89538767716743, 2.2354860533839984, 13.614439553936412, 26.273580416493253, 19.460601447477483, 5.955252836016908, 42.58153443500117, 9.430170821540251, 41.04978874206844, 41.11371247090039, 20.545272674463448, 11.98757478560323, 17.531169800286634, 45.72680589260006, 42.228786675263976, 10.09075482397131, 16.301953673120078, 24.554369356191184, 46.5282342471656, 9.24095804147866, 15.867238096465712, 36.05447212193206, 12.629945473184229, 2.8265296685426082, 15.009801227923266, 28.68259342911934, 36.05932537866132, 31.935495666274264, 30.539987313486577, 45.846561757545814, 32.48968175394813, 21.758600972770502, 37.42818389146173, 32.271026357348234, 50.279816614507155, 48.91182480865115, 27.7443717411648, 6.647181071704699, 41.608015825083555, 16.481536265594926, 14.49822971873712, 24.3402982990822, 38.99312291724147, 33.184168819033516, 6.783314339968194, 38.4241721287897, 25.125238586567498, 35.69139014398761, 15.111962153061935, 23.40318725810721, 37.23163407727566, 27.903244122564768, 16.015564732859783, 30.208783299809383, 16.03074887301128, 26.47045140679754, 23.85018864079802, 14.299691658180965, 24.086394040015062]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28743755824679296, "mean_inference_ms": 0.9586837181575814, "mean_action_processing_ms": 0.1277975361382791, "mean_env_wait_ms": 0.06771061484625178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033417940139770508, "StateBufferConnector_ms": 0.0024878978729248047, "ViewRequirementAgentConnector_ms": 0.06451904773712158}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 679.588332829296, "num_env_steps_trained_throughput_per_sec": 679.588332829296, "timesteps_total": 640000, "num_env_steps_sampled_lifetime": 640000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 21596.456, "restore_workers_time_ms": 0.409, "training_step_time_ms": 21595.369, "sample_time_ms": 856.697, "learn_time_ms": 20722.597, "learn_throughput": 193.026, "synch_weights_time_ms": 15.422}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 160, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-12-17", "timestamp": 1723396337, "time_this_iter_s": 5.890696048736572, "time_total_s": 1053.6069474220276, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9fbb790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1053.6069474220276, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 32.05555555555556, "ram_util_percent": 80.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8831716812526186, "cur_kl_coeff": 3.761581922631321e-38, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03684755751479921, "policy_loss": -0.0011158550226051981, "vf_loss": 0.03796341267297976, "vf_explained_var": 0.9919305731852849, "kl": 0.0021263181346182236, "entropy": 0.10924182553232337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 154080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6735012760075431, "cur_kl_coeff": 8.470329472543005e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.032964853011556744, "policy_loss": -0.0036011661975256476, "vf_loss": 0.036566019298819204, "vf_explained_var": 0.9923479310547312, "kl": 0.005032189174151428, "entropy": 0.2412079058897992, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 154080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1288000, "num_agent_steps_trained": 1288000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -50.279816614507155, "predator_policy": 2.2354860533839984}, "policy_reward_max": {"prey_policy": -2.2354860533839984, "predator_policy": 50.279816614507155}, "policy_reward_mean": {"prey_policy": -25.171164416376367, "predator_policy": 25.171164416376367}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-37.646629638218904, -29.55031995430114, -8.923785509201798, -23.02344809775131, -45.99757877895685, -28.988164008719938, -14.15350173042544, -26.3588985494634, -5.505296035084255, -38.272060554205325, -3.489575918767172, -17.23652061704322, -28.740300700812824, -19.5881465137755, -31.067155188307755, -21.37162974404952, -12.673074102680355, -7.555421319212019, -36.73878677123436, -7.667545899096478, -29.773325260563336, -19.61221137289417, -16.99585664562156, -21.641876248386296, -12.38964664119242, -40.22908176992302, -45.141977533424786, -19.80768010692777, -9.268808542300485, -25.04437084727503, -31.806972293991212, -43.22663756567552, -26.61877024689311, -40.70638275104814, -35.18120724189132, -23.291935571232237, -39.98030621823497, -28.89538767716743, -2.2354860533839984, -13.614439553936412, -26.273580416493253, -19.460601447477483, -5.955252836016908, -42.58153443500117, -9.430170821540251, -41.04978874206844, -41.11371247090039, -20.545272674463448, -11.98757478560323, -17.531169800286634, -45.72680589260006, -42.228786675263976, -10.09075482397131, -16.301953673120078, -24.554369356191184, -46.5282342471656, -9.24095804147866, -15.867238096465712, -36.05447212193206, -12.629945473184229, -2.8265296685426082, -15.009801227923266, -28.68259342911934, -36.05932537866132, -31.935495666274264, -30.539987313486577, -45.846561757545814, -32.48968175394813, -21.758600972770502, -37.42818389146173, -32.271026357348234, -50.279816614507155, -48.91182480865115, -27.7443717411648, -6.647181071704699, -41.608015825083555, -16.481536265594926, -14.49822971873712, -24.3402982990822, -38.99312291724147, -33.184168819033516, -6.783314339968194, -38.4241721287897, -25.125238586567498, -35.69139014398761, -15.111962153061935, -23.40318725810721, -37.23163407727566, -27.903244122564768, -16.015564732859783, -30.208783299809383, -16.03074887301128, -26.47045140679754, -23.85018864079802, -14.299691658180965, -24.086394040015062, -11.153402103006808, -11.3714164568739, -39.05226623511501, -12.204661278469267], "policy_predator_policy_reward": [37.646629638218904, 29.55031995430114, 8.923785509201798, 23.02344809775131, 45.99757877895685, 28.988164008719938, 14.15350173042544, 26.3588985494634, 5.505296035084255, 38.272060554205325, 3.489575918767172, 17.23652061704322, 28.740300700812824, 19.5881465137755, 31.067155188307755, 21.37162974404952, 12.673074102680355, 7.555421319212019, 36.73878677123436, 7.667545899096478, 29.773325260563336, 19.61221137289417, 16.99585664562156, 21.641876248386296, 12.38964664119242, 40.22908176992302, 45.141977533424786, 19.80768010692777, 9.268808542300485, 25.04437084727503, 31.806972293991212, 43.22663756567552, 26.61877024689311, 40.70638275104814, 35.18120724189132, 23.291935571232237, 39.98030621823497, 28.89538767716743, 2.2354860533839984, 13.614439553936412, 26.273580416493253, 19.460601447477483, 5.955252836016908, 42.58153443500117, 9.430170821540251, 41.04978874206844, 41.11371247090039, 20.545272674463448, 11.98757478560323, 17.531169800286634, 45.72680589260006, 42.228786675263976, 10.09075482397131, 16.301953673120078, 24.554369356191184, 46.5282342471656, 9.24095804147866, 15.867238096465712, 36.05447212193206, 12.629945473184229, 2.8265296685426082, 15.009801227923266, 28.68259342911934, 36.05932537866132, 31.935495666274264, 30.539987313486577, 45.846561757545814, 32.48968175394813, 21.758600972770502, 37.42818389146173, 32.271026357348234, 50.279816614507155, 48.91182480865115, 27.7443717411648, 6.647181071704699, 41.608015825083555, 16.481536265594926, 14.49822971873712, 24.3402982990822, 38.99312291724147, 33.184168819033516, 6.783314339968194, 38.4241721287897, 25.125238586567498, 35.69139014398761, 15.111962153061935, 23.40318725810721, 37.23163407727566, 27.903244122564768, 16.015564732859783, 30.208783299809383, 16.03074887301128, 26.47045140679754, 23.85018864079802, 14.299691658180965, 24.086394040015062, 11.153402103006808, 11.3714164568739, 39.05226623511501, 12.204661278469267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2874755912894372, "mean_inference_ms": 0.9591900965156577, "mean_action_processing_ms": 0.12782942534452446, "mean_env_wait_ms": 0.0677447490138682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033327341079711914, "StateBufferConnector_ms": 0.0024862289428710938, "ViewRequirementAgentConnector_ms": 0.06455528736114502}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1288000, "num_agent_steps_trained": 1288000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 737.1256967004724, "num_env_steps_trained_throughput_per_sec": 737.1256967004724, "timesteps_total": 644000, "num_env_steps_sampled_lifetime": 644000, "num_agent_steps_sampled_lifetime": 1288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1288000, "timers": {"training_iteration_time_ms": 21598.242, "restore_workers_time_ms": 0.409, "training_step_time_ms": 21597.155, "sample_time_ms": 856.301, "learn_time_ms": 20724.824, "learn_throughput": 193.005, "synch_weights_time_ms": 15.376}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1288000, "num_agent_steps_trained": 1288000}, "done": false, "training_iteration": 161, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-12-23", "timestamp": 1723396343, "time_this_iter_s": 5.430359840393066, "time_total_s": 1059.0373072624207, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9efcdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1059.0373072624207, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 31.099999999999998, "ram_util_percent": 79.64285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.859262933403564, "cur_kl_coeff": 1.8807909613156604e-38, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04700237257954238, "policy_loss": -0.0013720933435251935, "vf_loss": 0.04837446628662292, "vf_explained_var": 0.9979718547935287, "kl": 0.001702710236355051, "entropy": 0.06948671482047454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 155040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7729458435749014, "cur_kl_coeff": 8.470329472543005e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03579792494031911, "policy_loss": -0.005806775520735149, "vf_loss": 0.04160470021888614, "vf_explained_var": 0.9981498320897421, "kl": 0.003660707315665478, "entropy": 0.22756980278839667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 155040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -50.279816614507155, "predator_policy": 2.2354860533839984}, "policy_reward_max": {"prey_policy": -2.2354860533839984, "predator_policy": 50.279816614507155}, "policy_reward_mean": {"prey_policy": -24.269601569616206, "predator_policy": 24.269601569616206}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-38.272060554205325, -3.489575918767172, -17.23652061704322, -28.740300700812824, -19.5881465137755, -31.067155188307755, -21.37162974404952, -12.673074102680355, -7.555421319212019, -36.73878677123436, -7.667545899096478, -29.773325260563336, -19.61221137289417, -16.99585664562156, -21.641876248386296, -12.38964664119242, -40.22908176992302, -45.141977533424786, -19.80768010692777, -9.268808542300485, -25.04437084727503, -31.806972293991212, -43.22663756567552, -26.61877024689311, -40.70638275104814, -35.18120724189132, -23.291935571232237, -39.98030621823497, -28.89538767716743, -2.2354860533839984, -13.614439553936412, -26.273580416493253, -19.460601447477483, -5.955252836016908, -42.58153443500117, -9.430170821540251, -41.04978874206844, -41.11371247090039, -20.545272674463448, -11.98757478560323, -17.531169800286634, -45.72680589260006, -42.228786675263976, -10.09075482397131, -16.301953673120078, -24.554369356191184, -46.5282342471656, -9.24095804147866, -15.867238096465712, -36.05447212193206, -12.629945473184229, -2.8265296685426082, -15.009801227923266, -28.68259342911934, -36.05932537866132, -31.935495666274264, -30.539987313486577, -45.846561757545814, -32.48968175394813, -21.758600972770502, -37.42818389146173, -32.271026357348234, -50.279816614507155, -48.91182480865115, -27.7443717411648, -6.647181071704699, -41.608015825083555, -16.481536265594926, -14.49822971873712, -24.3402982990822, -38.99312291724147, -33.184168819033516, -6.783314339968194, -38.4241721287897, -25.125238586567498, -35.69139014398761, -15.111962153061935, -23.40318725810721, -37.23163407727566, -27.903244122564768, -16.015564732859783, -30.208783299809383, -16.03074887301128, -26.47045140679754, -23.85018864079802, -14.299691658180965, -24.086394040015062, -11.153402103006808, -11.3714164568739, -39.05226623511501, -12.204661278469267, -23.70826505070779, -4.615683753701728, -26.812448828628547, -19.851848062444624, -17.633727668740626, -14.638531390299509, -5.676998396676984, -6.963673995631188, -10.090160479275557], "policy_predator_policy_reward": [38.272060554205325, 3.489575918767172, 17.23652061704322, 28.740300700812824, 19.5881465137755, 31.067155188307755, 21.37162974404952, 12.673074102680355, 7.555421319212019, 36.73878677123436, 7.667545899096478, 29.773325260563336, 19.61221137289417, 16.99585664562156, 21.641876248386296, 12.38964664119242, 40.22908176992302, 45.141977533424786, 19.80768010692777, 9.268808542300485, 25.04437084727503, 31.806972293991212, 43.22663756567552, 26.61877024689311, 40.70638275104814, 35.18120724189132, 23.291935571232237, 39.98030621823497, 28.89538767716743, 2.2354860533839984, 13.614439553936412, 26.273580416493253, 19.460601447477483, 5.955252836016908, 42.58153443500117, 9.430170821540251, 41.04978874206844, 41.11371247090039, 20.545272674463448, 11.98757478560323, 17.531169800286634, 45.72680589260006, 42.228786675263976, 10.09075482397131, 16.301953673120078, 24.554369356191184, 46.5282342471656, 9.24095804147866, 15.867238096465712, 36.05447212193206, 12.629945473184229, 2.8265296685426082, 15.009801227923266, 28.68259342911934, 36.05932537866132, 31.935495666274264, 30.539987313486577, 45.846561757545814, 32.48968175394813, 21.758600972770502, 37.42818389146173, 32.271026357348234, 50.279816614507155, 48.91182480865115, 27.7443717411648, 6.647181071704699, 41.608015825083555, 16.481536265594926, 14.49822971873712, 24.3402982990822, 38.99312291724147, 33.184168819033516, 6.783314339968194, 38.4241721287897, 25.125238586567498, 35.69139014398761, 15.111962153061935, 23.40318725810721, 37.23163407727566, 27.903244122564768, 16.015564732859783, 30.208783299809383, 16.03074887301128, 26.47045140679754, 23.85018864079802, 14.299691658180965, 24.086394040015062, 11.153402103006808, 11.3714164568739, 39.05226623511501, 12.204661278469267, 23.70826505070779, 4.615683753701728, 26.812448828628547, 19.851848062444624, 17.633727668740626, 14.638531390299509, 5.676998396676984, 6.963673995631188, 10.090160479275557]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28777394772219683, "mean_inference_ms": 0.9604448814494794, "mean_action_processing_ms": 0.12797313486399245, "mean_env_wait_ms": 0.06784712936050756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033147335052490234, "StateBufferConnector_ms": 0.002487659454345703, "ViewRequirementAgentConnector_ms": 0.06378352642059326}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 699.0186865617565, "num_env_steps_trained_throughput_per_sec": 699.0186865617565, "timesteps_total": 648000, "num_env_steps_sampled_lifetime": 648000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 5985.543, "restore_workers_time_ms": 0.408, "training_step_time_ms": 5984.457, "sample_time_ms": 853.206, "learn_time_ms": 5115.341, "learn_throughput": 781.962, "synch_weights_time_ms": 15.283}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 162, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-12-28", "timestamp": 1723396348, "time_this_iter_s": 5.728549957275391, "time_total_s": 1064.765857219696, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7874430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1064.765857219696, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 28.755555555555556, "ram_util_percent": 79.58888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8029197262755284, "cur_kl_coeff": 9.403954806578302e-39, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05334994561004957, "policy_loss": -0.0034543539254324666, "vf_loss": 0.05680429966887459, "vf_explained_var": 0.9962434529016415, "kl": 0.00660462021737185, "entropy": 0.09170526092784712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7833830425360551, "cur_kl_coeff": 4.2351647362715025e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.030896692802222483, "policy_loss": -0.01321353219767237, "vf_loss": 0.04411022560088895, "vf_explained_var": 0.9971213698387146, "kl": 0.006022947572946487, "entropy": 0.22802031373915574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1304000, "num_agent_steps_trained": 1304000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -56.25691123251605, "predator_policy": 2.2354860533839984}, "policy_reward_max": {"prey_policy": -2.2354860533839984, "predator_policy": 56.25691123251605}, "policy_reward_mean": {"prey_policy": -24.777504527198406, "predator_policy": 24.777504527198406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-36.73878677123436, -7.667545899096478, -29.773325260563336, -19.61221137289417, -16.99585664562156, -21.641876248386296, -12.38964664119242, -40.22908176992302, -45.141977533424786, -19.80768010692777, -9.268808542300485, -25.04437084727503, -31.806972293991212, -43.22663756567552, -26.61877024689311, -40.70638275104814, -35.18120724189132, -23.291935571232237, -39.98030621823497, -28.89538767716743, -2.2354860533839984, -13.614439553936412, -26.273580416493253, -19.460601447477483, -5.955252836016908, -42.58153443500117, -9.430170821540251, -41.04978874206844, -41.11371247090039, -20.545272674463448, -11.98757478560323, -17.531169800286634, -45.72680589260006, -42.228786675263976, -10.09075482397131, -16.301953673120078, -24.554369356191184, -46.5282342471656, -9.24095804147866, -15.867238096465712, -36.05447212193206, -12.629945473184229, -2.8265296685426082, -15.009801227923266, -28.68259342911934, -36.05932537866132, -31.935495666274264, -30.539987313486577, -45.846561757545814, -32.48968175394813, -21.758600972770502, -37.42818389146173, -32.271026357348234, -50.279816614507155, -48.91182480865115, -27.7443717411648, -6.647181071704699, -41.608015825083555, -16.481536265594926, -14.49822971873712, -24.3402982990822, -38.99312291724147, -33.184168819033516, -6.783314339968194, -38.4241721287897, -25.125238586567498, -35.69139014398761, -15.111962153061935, -23.40318725810721, -37.23163407727566, -27.903244122564768, -16.015564732859783, -30.208783299809383, -16.03074887301128, -26.47045140679754, -23.85018864079802, -14.299691658180965, -24.086394040015062, -11.153402103006808, -11.3714164568739, -39.05226623511501, -12.204661278469267, -23.70826505070779, -4.615683753701728, -26.812448828628547, -19.851848062444624, -17.633727668740626, -14.638531390299509, -5.676998396676984, -6.963673995631188, -10.090160479275557, -56.25691123251605, -41.95723690596198, -25.37324387054202, -21.6441986287944, -5.9234968142496855, -28.506522425280494, -8.706823010912998, -15.981052791657103, -26.434694737159564], "policy_predator_policy_reward": [36.73878677123436, 7.667545899096478, 29.773325260563336, 19.61221137289417, 16.99585664562156, 21.641876248386296, 12.38964664119242, 40.22908176992302, 45.141977533424786, 19.80768010692777, 9.268808542300485, 25.04437084727503, 31.806972293991212, 43.22663756567552, 26.61877024689311, 40.70638275104814, 35.18120724189132, 23.291935571232237, 39.98030621823497, 28.89538767716743, 2.2354860533839984, 13.614439553936412, 26.273580416493253, 19.460601447477483, 5.955252836016908, 42.58153443500117, 9.430170821540251, 41.04978874206844, 41.11371247090039, 20.545272674463448, 11.98757478560323, 17.531169800286634, 45.72680589260006, 42.228786675263976, 10.09075482397131, 16.301953673120078, 24.554369356191184, 46.5282342471656, 9.24095804147866, 15.867238096465712, 36.05447212193206, 12.629945473184229, 2.8265296685426082, 15.009801227923266, 28.68259342911934, 36.05932537866132, 31.935495666274264, 30.539987313486577, 45.846561757545814, 32.48968175394813, 21.758600972770502, 37.42818389146173, 32.271026357348234, 50.279816614507155, 48.91182480865115, 27.7443717411648, 6.647181071704699, 41.608015825083555, 16.481536265594926, 14.49822971873712, 24.3402982990822, 38.99312291724147, 33.184168819033516, 6.783314339968194, 38.4241721287897, 25.125238586567498, 35.69139014398761, 15.111962153061935, 23.40318725810721, 37.23163407727566, 27.903244122564768, 16.015564732859783, 30.208783299809383, 16.03074887301128, 26.47045140679754, 23.85018864079802, 14.299691658180965, 24.086394040015062, 11.153402103006808, 11.3714164568739, 39.05226623511501, 12.204661278469267, 23.70826505070779, 4.615683753701728, 26.812448828628547, 19.851848062444624, 17.633727668740626, 14.638531390299509, 5.676998396676984, 6.963673995631188, 10.090160479275557, 56.25691123251605, 41.95723690596198, 25.37324387054202, 21.6441986287944, 5.9234968142496855, 28.506522425280494, 8.706823010912998, 15.981052791657103, 26.434694737159564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2880765421566268, "mean_inference_ms": 0.9617120876007569, "mean_action_processing_ms": 0.12811674132082054, "mean_env_wait_ms": 0.06795188511819442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033348798751831055, "StateBufferConnector_ms": 0.0024739503860473633, "ViewRequirementAgentConnector_ms": 0.06411612033843994}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1304000, "num_agent_steps_trained": 1304000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 733.119268933456, "num_env_steps_trained_throughput_per_sec": 733.119268933456, "timesteps_total": 652000, "num_env_steps_sampled_lifetime": 652000, "num_agent_steps_sampled_lifetime": 1304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1304000, "timers": {"training_iteration_time_ms": 5782.987, "restore_workers_time_ms": 0.408, "training_step_time_ms": 5781.909, "sample_time_ms": 794.514, "learn_time_ms": 4973.298, "learn_throughput": 804.295, "synch_weights_time_ms": 13.751}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1304000, "num_agent_steps_trained": 1304000}, "done": false, "training_iteration": 163, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-12-34", "timestamp": 1723396354, "time_this_iter_s": 5.460317850112915, "time_total_s": 1070.226175069809, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f2f700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1070.226175069809, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 30.657142857142862, "ram_util_percent": 79.12857142857145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8352172282291577, "cur_kl_coeff": 9.403954806578302e-39, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.036848145379675165, "policy_loss": -0.0024545515022812952, "vf_loss": 0.039302696514399334, "vf_explained_var": 0.9982552427177628, "kl": 0.002197782881007177, "entropy": 0.0845902834708492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8248275804178168, "cur_kl_coeff": 4.2351647362715025e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0376486654667436, "policy_loss": -0.006752029909694102, "vf_loss": 0.04440069456807881, "vf_explained_var": 0.9979004258289933, "kl": 0.004895707338322571, "entropy": 0.2238235437621673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -56.25691123251605, "predator_policy": 2.2354860533839984}, "policy_reward_max": {"prey_policy": -2.2354860533839984, "predator_policy": 56.25691123251605}, "policy_reward_mean": {"prey_policy": -24.2896997250931, "predator_policy": 24.2896997250931}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-21.641876248386296, -12.38964664119242, -40.22908176992302, -45.141977533424786, -19.80768010692777, -9.268808542300485, -25.04437084727503, -31.806972293991212, -43.22663756567552, -26.61877024689311, -40.70638275104814, -35.18120724189132, -23.291935571232237, -39.98030621823497, -28.89538767716743, -2.2354860533839984, -13.614439553936412, -26.273580416493253, -19.460601447477483, -5.955252836016908, -42.58153443500117, -9.430170821540251, -41.04978874206844, -41.11371247090039, -20.545272674463448, -11.98757478560323, -17.531169800286634, -45.72680589260006, -42.228786675263976, -10.09075482397131, -16.301953673120078, -24.554369356191184, -46.5282342471656, -9.24095804147866, -15.867238096465712, -36.05447212193206, -12.629945473184229, -2.8265296685426082, -15.009801227923266, -28.68259342911934, -36.05932537866132, -31.935495666274264, -30.539987313486577, -45.846561757545814, -32.48968175394813, -21.758600972770502, -37.42818389146173, -32.271026357348234, -50.279816614507155, -48.91182480865115, -27.7443717411648, -6.647181071704699, -41.608015825083555, -16.481536265594926, -14.49822971873712, -24.3402982990822, -38.99312291724147, -33.184168819033516, -6.783314339968194, -38.4241721287897, -25.125238586567498, -35.69139014398761, -15.111962153061935, -23.40318725810721, -37.23163407727566, -27.903244122564768, -16.015564732859783, -30.208783299809383, -16.03074887301128, -26.47045140679754, -23.85018864079802, -14.299691658180965, -24.086394040015062, -11.153402103006808, -11.3714164568739, -39.05226623511501, -12.204661278469267, -23.70826505070779, -4.615683753701728, -26.812448828628547, -19.851848062444624, -17.633727668740626, -14.638531390299509, -5.676998396676984, -6.963673995631188, -10.090160479275557, -56.25691123251605, -41.95723690596198, -25.37324387054202, -21.6441986287944, -5.9234968142496855, -28.506522425280494, -8.706823010912998, -15.981052791657103, -26.434694737159564, -12.50532194751763, -15.177527009576476, -9.736094509765628, -18.252965657157265, -6.3353366148620225], "policy_predator_policy_reward": [21.641876248386296, 12.38964664119242, 40.22908176992302, 45.141977533424786, 19.80768010692777, 9.268808542300485, 25.04437084727503, 31.806972293991212, 43.22663756567552, 26.61877024689311, 40.70638275104814, 35.18120724189132, 23.291935571232237, 39.98030621823497, 28.89538767716743, 2.2354860533839984, 13.614439553936412, 26.273580416493253, 19.460601447477483, 5.955252836016908, 42.58153443500117, 9.430170821540251, 41.04978874206844, 41.11371247090039, 20.545272674463448, 11.98757478560323, 17.531169800286634, 45.72680589260006, 42.228786675263976, 10.09075482397131, 16.301953673120078, 24.554369356191184, 46.5282342471656, 9.24095804147866, 15.867238096465712, 36.05447212193206, 12.629945473184229, 2.8265296685426082, 15.009801227923266, 28.68259342911934, 36.05932537866132, 31.935495666274264, 30.539987313486577, 45.846561757545814, 32.48968175394813, 21.758600972770502, 37.42818389146173, 32.271026357348234, 50.279816614507155, 48.91182480865115, 27.7443717411648, 6.647181071704699, 41.608015825083555, 16.481536265594926, 14.49822971873712, 24.3402982990822, 38.99312291724147, 33.184168819033516, 6.783314339968194, 38.4241721287897, 25.125238586567498, 35.69139014398761, 15.111962153061935, 23.40318725810721, 37.23163407727566, 27.903244122564768, 16.015564732859783, 30.208783299809383, 16.03074887301128, 26.47045140679754, 23.85018864079802, 14.299691658180965, 24.086394040015062, 11.153402103006808, 11.3714164568739, 39.05226623511501, 12.204661278469267, 23.70826505070779, 4.615683753701728, 26.812448828628547, 19.851848062444624, 17.633727668740626, 14.638531390299509, 5.676998396676984, 6.963673995631188, 10.090160479275557, 56.25691123251605, 41.95723690596198, 25.37324387054202, 21.6441986287944, 5.9234968142496855, 28.506522425280494, 8.706823010912998, 15.981052791657103, 26.434694737159564, 12.50532194751763, 15.177527009576476, 9.736094509765628, 18.252965657157265, 6.3353366148620225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28833004521284505, "mean_inference_ms": 0.962460985055646, "mean_action_processing_ms": 0.12822718344490566, "mean_env_wait_ms": 0.06802209200516734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003344416618347168, "StateBufferConnector_ms": 0.0024863481521606445, "ViewRequirementAgentConnector_ms": 0.06432831287384033}, "num_episodes": 5, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 706.0707456355335, "num_env_steps_trained_throughput_per_sec": 706.0707456355335, "timesteps_total": 656000, "num_env_steps_sampled_lifetime": 656000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 5691.236, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5691.202, "sample_time_ms": 734.213, "learn_time_ms": 4942.689, "learn_throughput": 809.276, "synch_weights_time_ms": 13.961}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 164, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-12-40", "timestamp": 1723396360, "time_this_iter_s": 5.670603036880493, "time_total_s": 1075.8967781066895, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9efcc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1075.8967781066895, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 28.2625, "ram_util_percent": 78.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8129870507245263, "cur_kl_coeff": 4.701977403289151e-39, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04272740280284779, "policy_loss": -0.003800012477586279, "vf_loss": 0.046527415019712255, "vf_explained_var": 0.9970555700982611, "kl": 0.00352907584640015, "entropy": 0.06600945166622599, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 157920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8759098273081084, "cur_kl_coeff": 2.1175823681357513e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03951488663199901, "policy_loss": -0.005500925376448625, "vf_loss": 0.04501581221265951, "vf_explained_var": 0.9971163431803386, "kl": 0.0030432286546933232, "entropy": 0.19209469083386163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 157920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -56.25691123251605, "predator_policy": 2.2354860533839984}, "policy_reward_max": {"prey_policy": -2.2354860533839984, "predator_policy": 56.25691123251605}, "policy_reward_mean": {"prey_policy": -24.856498624648847, "predator_policy": 24.856498624648847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-26.61877024689311, -40.70638275104814, -35.18120724189132, -23.291935571232237, -39.98030621823497, -28.89538767716743, -2.2354860533839984, -13.614439553936412, -26.273580416493253, -19.460601447477483, -5.955252836016908, -42.58153443500117, -9.430170821540251, -41.04978874206844, -41.11371247090039, -20.545272674463448, -11.98757478560323, -17.531169800286634, -45.72680589260006, -42.228786675263976, -10.09075482397131, -16.301953673120078, -24.554369356191184, -46.5282342471656, -9.24095804147866, -15.867238096465712, -36.05447212193206, -12.629945473184229, -2.8265296685426082, -15.009801227923266, -28.68259342911934, -36.05932537866132, -31.935495666274264, -30.539987313486577, -45.846561757545814, -32.48968175394813, -21.758600972770502, -37.42818389146173, -32.271026357348234, -50.279816614507155, -48.91182480865115, -27.7443717411648, -6.647181071704699, -41.608015825083555, -16.481536265594926, -14.49822971873712, -24.3402982990822, -38.99312291724147, -33.184168819033516, -6.783314339968194, -38.4241721287897, -25.125238586567498, -35.69139014398761, -15.111962153061935, -23.40318725810721, -37.23163407727566, -27.903244122564768, -16.015564732859783, -30.208783299809383, -16.03074887301128, -26.47045140679754, -23.85018864079802, -14.299691658180965, -24.086394040015062, -11.153402103006808, -11.3714164568739, -39.05226623511501, -12.204661278469267, -23.70826505070779, -4.615683753701728, -26.812448828628547, -19.851848062444624, -17.633727668740626, -14.638531390299509, -5.676998396676984, -6.963673995631188, -10.090160479275557, -56.25691123251605, -41.95723690596198, -25.37324387054202, -21.6441986287944, -5.9234968142496855, -28.506522425280494, -8.706823010912998, -15.981052791657103, -26.434694737159564, -12.50532194751763, -15.177527009576476, -9.736094509765628, -18.252965657157265, -6.3353366148620225, -35.01484235934386, -20.04018414792604, -38.677569687250376, -43.108726352996, -32.30477265599069, -36.87943156153521, -33.78243907024207, -41.49563456665631, -23.933341102730846], "policy_predator_policy_reward": [26.61877024689311, 40.70638275104814, 35.18120724189132, 23.291935571232237, 39.98030621823497, 28.89538767716743, 2.2354860533839984, 13.614439553936412, 26.273580416493253, 19.460601447477483, 5.955252836016908, 42.58153443500117, 9.430170821540251, 41.04978874206844, 41.11371247090039, 20.545272674463448, 11.98757478560323, 17.531169800286634, 45.72680589260006, 42.228786675263976, 10.09075482397131, 16.301953673120078, 24.554369356191184, 46.5282342471656, 9.24095804147866, 15.867238096465712, 36.05447212193206, 12.629945473184229, 2.8265296685426082, 15.009801227923266, 28.68259342911934, 36.05932537866132, 31.935495666274264, 30.539987313486577, 45.846561757545814, 32.48968175394813, 21.758600972770502, 37.42818389146173, 32.271026357348234, 50.279816614507155, 48.91182480865115, 27.7443717411648, 6.647181071704699, 41.608015825083555, 16.481536265594926, 14.49822971873712, 24.3402982990822, 38.99312291724147, 33.184168819033516, 6.783314339968194, 38.4241721287897, 25.125238586567498, 35.69139014398761, 15.111962153061935, 23.40318725810721, 37.23163407727566, 27.903244122564768, 16.015564732859783, 30.208783299809383, 16.03074887301128, 26.47045140679754, 23.85018864079802, 14.299691658180965, 24.086394040015062, 11.153402103006808, 11.3714164568739, 39.05226623511501, 12.204661278469267, 23.70826505070779, 4.615683753701728, 26.812448828628547, 19.851848062444624, 17.633727668740626, 14.638531390299509, 5.676998396676984, 6.963673995631188, 10.090160479275557, 56.25691123251605, 41.95723690596198, 25.37324387054202, 21.6441986287944, 5.9234968142496855, 28.506522425280494, 8.706823010912998, 15.981052791657103, 26.434694737159564, 12.50532194751763, 15.177527009576476, 9.736094509765628, 18.252965657157265, 6.3353366148620225, 35.01484235934386, 20.04018414792604, 38.677569687250376, 43.108726352996, 32.30477265599069, 36.87943156153521, 33.78243907024207, 41.49563456665631, 23.933341102730846]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2887479644000276, "mean_inference_ms": 0.9635760743610605, "mean_action_processing_ms": 0.12831377110378234, "mean_env_wait_ms": 0.06811236344208771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003079533576965332, "StateBufferConnector_ms": 0.0023981332778930664, "ViewRequirementAgentConnector_ms": 0.06587791442871094}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 733.1648260214445, "num_env_steps_trained_throughput_per_sec": 733.1648260214445, "timesteps_total": 660000, "num_env_steps_sampled_lifetime": 660000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 5677.553, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5677.52, "sample_time_ms": 735.46, "learn_time_ms": 4928.512, "learn_throughput": 811.604, "synch_weights_time_ms": 13.219}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 165, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-12-45", "timestamp": 1723396365, "time_this_iter_s": 5.460564136505127, "time_total_s": 1081.3573422431946, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f2fb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1081.3573422431946, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 27.424999999999997, "ram_util_percent": 78.4625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.085933693870902, "cur_kl_coeff": 2.3509887016445755e-39, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07371588270616485, "policy_loss": 0.0006401221258177732, "vf_loss": 0.07307576047921126, "vf_explained_var": 0.997894675284624, "kl": 0.0013028960207473294, "entropy": 0.06256506981007988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 158880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9723532893539717, "cur_kl_coeff": 1.0587911840678756e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07634532759523911, "policy_loss": -0.007830167978924388, "vf_loss": 0.0841754951000136, "vf_explained_var": 0.9976479483147462, "kl": 0.00417633168292002, "entropy": 0.21706852867888907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 158880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -56.25691123251605, "predator_policy": 2.0309089477868296}, "policy_reward_max": {"prey_policy": -2.0309089477868296, "predator_policy": 56.25691123251605}, "policy_reward_mean": {"prey_policy": -24.18936701852598, "predator_policy": 24.18936701852598}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-19.460601447477483, -5.955252836016908, -42.58153443500117, -9.430170821540251, -41.04978874206844, -41.11371247090039, -20.545272674463448, -11.98757478560323, -17.531169800286634, -45.72680589260006, -42.228786675263976, -10.09075482397131, -16.301953673120078, -24.554369356191184, -46.5282342471656, -9.24095804147866, -15.867238096465712, -36.05447212193206, -12.629945473184229, -2.8265296685426082, -15.009801227923266, -28.68259342911934, -36.05932537866132, -31.935495666274264, -30.539987313486577, -45.846561757545814, -32.48968175394813, -21.758600972770502, -37.42818389146173, -32.271026357348234, -50.279816614507155, -48.91182480865115, -27.7443717411648, -6.647181071704699, -41.608015825083555, -16.481536265594926, -14.49822971873712, -24.3402982990822, -38.99312291724147, -33.184168819033516, -6.783314339968194, -38.4241721287897, -25.125238586567498, -35.69139014398761, -15.111962153061935, -23.40318725810721, -37.23163407727566, -27.903244122564768, -16.015564732859783, -30.208783299809383, -16.03074887301128, -26.47045140679754, -23.85018864079802, -14.299691658180965, -24.086394040015062, -11.153402103006808, -11.3714164568739, -39.05226623511501, -12.204661278469267, -23.70826505070779, -4.615683753701728, -26.812448828628547, -19.851848062444624, -17.633727668740626, -14.638531390299509, -5.676998396676984, -6.963673995631188, -10.090160479275557, -56.25691123251605, -41.95723690596198, -25.37324387054202, -21.6441986287944, -5.9234968142496855, -28.506522425280494, -8.706823010912998, -15.981052791657103, -26.434694737159564, -12.50532194751763, -15.177527009576476, -9.736094509765628, -18.252965657157265, -6.3353366148620225, -35.01484235934386, -20.04018414792604, -38.677569687250376, -43.108726352996, -32.30477265599069, -36.87943156153521, -33.78243907024207, -41.49563456665631, -23.933341102730846, -24.721303548932532, -14.465291942068477, -40.84614788464316, -10.528373025001303, -17.00346857312575, -14.344762661780754, -30.85497486361115, -15.289103671044247, -2.0309089477868296], "policy_predator_policy_reward": [19.460601447477483, 5.955252836016908, 42.58153443500117, 9.430170821540251, 41.04978874206844, 41.11371247090039, 20.545272674463448, 11.98757478560323, 17.531169800286634, 45.72680589260006, 42.228786675263976, 10.09075482397131, 16.301953673120078, 24.554369356191184, 46.5282342471656, 9.24095804147866, 15.867238096465712, 36.05447212193206, 12.629945473184229, 2.8265296685426082, 15.009801227923266, 28.68259342911934, 36.05932537866132, 31.935495666274264, 30.539987313486577, 45.846561757545814, 32.48968175394813, 21.758600972770502, 37.42818389146173, 32.271026357348234, 50.279816614507155, 48.91182480865115, 27.7443717411648, 6.647181071704699, 41.608015825083555, 16.481536265594926, 14.49822971873712, 24.3402982990822, 38.99312291724147, 33.184168819033516, 6.783314339968194, 38.4241721287897, 25.125238586567498, 35.69139014398761, 15.111962153061935, 23.40318725810721, 37.23163407727566, 27.903244122564768, 16.015564732859783, 30.208783299809383, 16.03074887301128, 26.47045140679754, 23.85018864079802, 14.299691658180965, 24.086394040015062, 11.153402103006808, 11.3714164568739, 39.05226623511501, 12.204661278469267, 23.70826505070779, 4.615683753701728, 26.812448828628547, 19.851848062444624, 17.633727668740626, 14.638531390299509, 5.676998396676984, 6.963673995631188, 10.090160479275557, 56.25691123251605, 41.95723690596198, 25.37324387054202, 21.6441986287944, 5.9234968142496855, 28.506522425280494, 8.706823010912998, 15.981052791657103, 26.434694737159564, 12.50532194751763, 15.177527009576476, 9.736094509765628, 18.252965657157265, 6.3353366148620225, 35.01484235934386, 20.04018414792604, 38.677569687250376, 43.108726352996, 32.30477265599069, 36.87943156153521, 33.78243907024207, 41.49563456665631, 23.933341102730846, 24.721303548932532, 14.465291942068477, 40.84614788464316, 10.528373025001303, 17.00346857312575, 14.344762661780754, 30.85497486361115, 15.289103671044247, 2.0309089477868296]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28884321601025376, "mean_inference_ms": 0.9641198360874895, "mean_action_processing_ms": 0.12838859474149159, "mean_env_wait_ms": 0.06815438133375695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002982020378112793, "StateBufferConnector_ms": 0.0023925304412841797, "ViewRequirementAgentConnector_ms": 0.06017661094665527}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 739.0053284606682, "num_env_steps_trained_throughput_per_sec": 739.0053284606682, "timesteps_total": 664000, "num_env_steps_sampled_lifetime": 664000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 5606.141, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5606.108, "sample_time_ms": 678.995, "learn_time_ms": 4913.616, "learn_throughput": 814.064, "synch_weights_time_ms": 13.175}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 166, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-12-50", "timestamp": 1723396370, "time_this_iter_s": 5.4182069301605225, "time_total_s": 1086.775549173355, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f604c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1086.775549173355, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 27.849999999999998, "ram_util_percent": 78.55000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0173673124983906, "cur_kl_coeff": 1.1754943508222877e-39, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.13221247116598533, "policy_loss": -0.000697246499476023, "vf_loss": 0.13290971762714132, "vf_explained_var": 0.9931589243312676, "kl": 0.0006330619721813221, "entropy": 0.04998836189964398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 159840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1563089089468122, "cur_kl_coeff": 5.293955920339378e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.11904178548381121, "policy_loss": -0.006048174518946325, "vf_loss": 0.12508995981770568, "vf_explained_var": 0.9936500921845436, "kl": 0.0014505011452953696, "entropy": 0.1925482569883267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 159840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 1336000, "num_agent_steps_trained": 1336000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -56.25691123251605, "predator_policy": 2.0309089477868296}, "policy_reward_max": {"prey_policy": -2.0309089477868296, "predator_policy": 56.25691123251605}, "policy_reward_mean": {"prey_policy": -24.946079306271173, "predator_policy": 24.946079306271173}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-45.72680589260006, -42.228786675263976, -10.09075482397131, -16.301953673120078, -24.554369356191184, -46.5282342471656, -9.24095804147866, -15.867238096465712, -36.05447212193206, -12.629945473184229, -2.8265296685426082, -15.009801227923266, -28.68259342911934, -36.05932537866132, -31.935495666274264, -30.539987313486577, -45.846561757545814, -32.48968175394813, -21.758600972770502, -37.42818389146173, -32.271026357348234, -50.279816614507155, -48.91182480865115, -27.7443717411648, -6.647181071704699, -41.608015825083555, -16.481536265594926, -14.49822971873712, -24.3402982990822, -38.99312291724147, -33.184168819033516, -6.783314339968194, -38.4241721287897, -25.125238586567498, -35.69139014398761, -15.111962153061935, -23.40318725810721, -37.23163407727566, -27.903244122564768, -16.015564732859783, -30.208783299809383, -16.03074887301128, -26.47045140679754, -23.85018864079802, -14.299691658180965, -24.086394040015062, -11.153402103006808, -11.3714164568739, -39.05226623511501, -12.204661278469267, -23.70826505070779, -4.615683753701728, -26.812448828628547, -19.851848062444624, -17.633727668740626, -14.638531390299509, -5.676998396676984, -6.963673995631188, -10.090160479275557, -56.25691123251605, -41.95723690596198, -25.37324387054202, -21.6441986287944, -5.9234968142496855, -28.506522425280494, -8.706823010912998, -15.981052791657103, -26.434694737159564, -12.50532194751763, -15.177527009576476, -9.736094509765628, -18.252965657157265, -6.3353366148620225, -35.01484235934386, -20.04018414792604, -38.677569687250376, -43.108726352996, -32.30477265599069, -36.87943156153521, -33.78243907024207, -41.49563456665631, -23.933341102730846, -24.721303548932532, -14.465291942068477, -40.84614788464316, -10.528373025001303, -17.00346857312575, -14.344762661780754, -30.85497486361115, -15.289103671044247, -2.0309089477868296, -21.617908005612716, -42.17755202738457, -24.11330609755365, -19.479892982482923, -42.6303808783365, -19.30239150392302, -28.304201215466158, -54.643551069645824, -33.05712300747141], "policy_predator_policy_reward": [45.72680589260006, 42.228786675263976, 10.09075482397131, 16.301953673120078, 24.554369356191184, 46.5282342471656, 9.24095804147866, 15.867238096465712, 36.05447212193206, 12.629945473184229, 2.8265296685426082, 15.009801227923266, 28.68259342911934, 36.05932537866132, 31.935495666274264, 30.539987313486577, 45.846561757545814, 32.48968175394813, 21.758600972770502, 37.42818389146173, 32.271026357348234, 50.279816614507155, 48.91182480865115, 27.7443717411648, 6.647181071704699, 41.608015825083555, 16.481536265594926, 14.49822971873712, 24.3402982990822, 38.99312291724147, 33.184168819033516, 6.783314339968194, 38.4241721287897, 25.125238586567498, 35.69139014398761, 15.111962153061935, 23.40318725810721, 37.23163407727566, 27.903244122564768, 16.015564732859783, 30.208783299809383, 16.03074887301128, 26.47045140679754, 23.85018864079802, 14.299691658180965, 24.086394040015062, 11.153402103006808, 11.3714164568739, 39.05226623511501, 12.204661278469267, 23.70826505070779, 4.615683753701728, 26.812448828628547, 19.851848062444624, 17.633727668740626, 14.638531390299509, 5.676998396676984, 6.963673995631188, 10.090160479275557, 56.25691123251605, 41.95723690596198, 25.37324387054202, 21.6441986287944, 5.9234968142496855, 28.506522425280494, 8.706823010912998, 15.981052791657103, 26.434694737159564, 12.50532194751763, 15.177527009576476, 9.736094509765628, 18.252965657157265, 6.3353366148620225, 35.01484235934386, 20.04018414792604, 38.677569687250376, 43.108726352996, 32.30477265599069, 36.87943156153521, 33.78243907024207, 41.49563456665631, 23.933341102730846, 24.721303548932532, 14.465291942068477, 40.84614788464316, 10.528373025001303, 17.00346857312575, 14.344762661780754, 30.85497486361115, 15.289103671044247, 2.0309089477868296, 21.617908005612716, 42.17755202738457, 24.11330609755365, 19.479892982482923, 42.6303808783365, 19.30239150392302, 28.304201215466158, 54.643551069645824, 33.05712300747141]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28869809736739194, "mean_inference_ms": 0.9643653197158515, "mean_action_processing_ms": 0.12846576011417102, "mean_env_wait_ms": 0.06815472589602645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028700828552246094, "StateBufferConnector_ms": 0.0023436546325683594, "ViewRequirementAgentConnector_ms": 0.05726742744445801}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1336000, "num_agent_steps_trained": 1336000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 714.6371409225682, "num_env_steps_trained_throughput_per_sec": 714.6371409225682, "timesteps_total": 668000, "num_env_steps_sampled_lifetime": 668000, "num_agent_steps_sampled_lifetime": 1336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1336000, "timers": {"training_iteration_time_ms": 5597.286, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5597.254, "sample_time_ms": 675.065, "learn_time_ms": 4908.65, "learn_throughput": 814.888, "synch_weights_time_ms": 13.215}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 1336000, "num_agent_steps_trained": 1336000}, "done": false, "training_iteration": 167, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-12-56", "timestamp": 1723396376, "time_this_iter_s": 5.602426767349243, "time_total_s": 1092.3779759407043, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f2faf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1092.3779759407043, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 28.35, "ram_util_percent": 78.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2711046214215458, "cur_kl_coeff": 5.877471754111439e-40, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1657041220991232, "policy_loss": 0.0001732626534552158, "vf_loss": 0.16553085853714342, "vf_explained_var": 0.9920272715389729, "kl": 0.0013263907204946683, "entropy": 0.07915335188445169, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2434905719943345, "cur_kl_coeff": 2.646977960169689e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.18118293060518528, "policy_loss": -0.007736758482496953, "vf_loss": 0.18891968843915188, "vf_explained_var": 0.9905696327487628, "kl": 0.003302953735051384, "entropy": 0.22122137206606568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -56.25691123251605, "predator_policy": 2.0309089477868296}, "policy_reward_max": {"prey_policy": -2.0309089477868296, "predator_policy": 56.25691123251605}, "policy_reward_mean": {"prey_policy": -24.61499086102338, "predator_policy": 24.61499086102338}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-12.629945473184229, -2.8265296685426082, -15.009801227923266, -28.68259342911934, -36.05932537866132, -31.935495666274264, -30.539987313486577, -45.846561757545814, -32.48968175394813, -21.758600972770502, -37.42818389146173, -32.271026357348234, -50.279816614507155, -48.91182480865115, -27.7443717411648, -6.647181071704699, -41.608015825083555, -16.481536265594926, -14.49822971873712, -24.3402982990822, -38.99312291724147, -33.184168819033516, -6.783314339968194, -38.4241721287897, -25.125238586567498, -35.69139014398761, -15.111962153061935, -23.40318725810721, -37.23163407727566, -27.903244122564768, -16.015564732859783, -30.208783299809383, -16.03074887301128, -26.47045140679754, -23.85018864079802, -14.299691658180965, -24.086394040015062, -11.153402103006808, -11.3714164568739, -39.05226623511501, -12.204661278469267, -23.70826505070779, -4.615683753701728, -26.812448828628547, -19.851848062444624, -17.633727668740626, -14.638531390299509, -5.676998396676984, -6.963673995631188, -10.090160479275557, -56.25691123251605, -41.95723690596198, -25.37324387054202, -21.6441986287944, -5.9234968142496855, -28.506522425280494, -8.706823010912998, -15.981052791657103, -26.434694737159564, -12.50532194751763, -15.177527009576476, -9.736094509765628, -18.252965657157265, -6.3353366148620225, -35.01484235934386, -20.04018414792604, -38.677569687250376, -43.108726352996, -32.30477265599069, -36.87943156153521, -33.78243907024207, -41.49563456665631, -23.933341102730846, -24.721303548932532, -14.465291942068477, -40.84614788464316, -10.528373025001303, -17.00346857312575, -14.344762661780754, -30.85497486361115, -15.289103671044247, -2.0309089477868296, -21.617908005612716, -42.17755202738457, -24.11330609755365, -19.479892982482923, -42.6303808783365, -19.30239150392302, -28.304201215466158, -54.643551069645824, -33.05712300747141, -30.31044296850583, -30.501813847251157, -7.525772806325641, -31.89223726299482, -23.423547156492223, -16.077477674595954, -15.034140602482607, -18.64954815414929, -40.069747930611854], "policy_predator_policy_reward": [12.629945473184229, 2.8265296685426082, 15.009801227923266, 28.68259342911934, 36.05932537866132, 31.935495666274264, 30.539987313486577, 45.846561757545814, 32.48968175394813, 21.758600972770502, 37.42818389146173, 32.271026357348234, 50.279816614507155, 48.91182480865115, 27.7443717411648, 6.647181071704699, 41.608015825083555, 16.481536265594926, 14.49822971873712, 24.3402982990822, 38.99312291724147, 33.184168819033516, 6.783314339968194, 38.4241721287897, 25.125238586567498, 35.69139014398761, 15.111962153061935, 23.40318725810721, 37.23163407727566, 27.903244122564768, 16.015564732859783, 30.208783299809383, 16.03074887301128, 26.47045140679754, 23.85018864079802, 14.299691658180965, 24.086394040015062, 11.153402103006808, 11.3714164568739, 39.05226623511501, 12.204661278469267, 23.70826505070779, 4.615683753701728, 26.812448828628547, 19.851848062444624, 17.633727668740626, 14.638531390299509, 5.676998396676984, 6.963673995631188, 10.090160479275557, 56.25691123251605, 41.95723690596198, 25.37324387054202, 21.6441986287944, 5.9234968142496855, 28.506522425280494, 8.706823010912998, 15.981052791657103, 26.434694737159564, 12.50532194751763, 15.177527009576476, 9.736094509765628, 18.252965657157265, 6.3353366148620225, 35.01484235934386, 20.04018414792604, 38.677569687250376, 43.108726352996, 32.30477265599069, 36.87943156153521, 33.78243907024207, 41.49563456665631, 23.933341102730846, 24.721303548932532, 14.465291942068477, 40.84614788464316, 10.528373025001303, 17.00346857312575, 14.344762661780754, 30.85497486361115, 15.289103671044247, 2.0309089477868296, 21.617908005612716, 42.17755202738457, 24.11330609755365, 19.479892982482923, 42.6303808783365, 19.30239150392302, 28.304201215466158, 54.643551069645824, 33.05712300747141, 30.31044296850583, 30.501813847251157, 7.525772806325641, 31.89223726299482, 23.423547156492223, 16.077477674595954, 15.034140602482607, 18.64954815414929, 40.069747930611854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28864950228606795, "mean_inference_ms": 0.9642319853354137, "mean_action_processing_ms": 0.12846259133291565, "mean_env_wait_ms": 0.06813967869794493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028536319732666016, "StateBufferConnector_ms": 0.0024209022521972656, "ViewRequirementAgentConnector_ms": 0.05866575241088867}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 700.8977073499607, "num_env_steps_trained_throughput_per_sec": 700.8977073499607, "timesteps_total": 672000, "num_env_steps_sampled_lifetime": 672000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 5595.95, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5595.918, "sample_time_ms": 686.216, "learn_time_ms": 4895.763, "learn_throughput": 817.033, "synch_weights_time_ms": 13.615}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 168, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-13-02", "timestamp": 1723396382, "time_this_iter_s": 5.7123048305511475, "time_total_s": 1098.0902807712555, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9fbb280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1098.0902807712555, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 33.475, "ram_util_percent": 78.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9603559072595089, "cur_kl_coeff": 2.9387358770557193e-40, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08236079464137826, "policy_loss": -0.0022473196261368384, "vf_loss": 0.08460811507247853, "vf_explained_var": 0.9954657681286335, "kl": 0.0030984422661939227, "entropy": 0.058972080630095056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 161760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0076029186292241, "cur_kl_coeff": 1.3234889800848445e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0787874019741139, "policy_loss": -0.0023216261753987054, "vf_loss": 0.08110902817813136, "vf_explained_var": 0.9957865672186017, "kl": 0.0020816486919727098, "entropy": 0.216766965497906, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 161760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 1352000, "num_agent_steps_trained": 1352000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -56.25691123251605, "predator_policy": 2.0309089477868296}, "policy_reward_max": {"prey_policy": -2.0309089477868296, "predator_policy": 56.25691123251605}, "policy_reward_mean": {"prey_policy": -24.68123784070021, "predator_policy": 24.68123784070021}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-21.758600972770502, -37.42818389146173, -32.271026357348234, -50.279816614507155, -48.91182480865115, -27.7443717411648, -6.647181071704699, -41.608015825083555, -16.481536265594926, -14.49822971873712, -24.3402982990822, -38.99312291724147, -33.184168819033516, -6.783314339968194, -38.4241721287897, -25.125238586567498, -35.69139014398761, -15.111962153061935, -23.40318725810721, -37.23163407727566, -27.903244122564768, -16.015564732859783, -30.208783299809383, -16.03074887301128, -26.47045140679754, -23.85018864079802, -14.299691658180965, -24.086394040015062, -11.153402103006808, -11.3714164568739, -39.05226623511501, -12.204661278469267, -23.70826505070779, -4.615683753701728, -26.812448828628547, -19.851848062444624, -17.633727668740626, -14.638531390299509, -5.676998396676984, -6.963673995631188, -10.090160479275557, -56.25691123251605, -41.95723690596198, -25.37324387054202, -21.6441986287944, -5.9234968142496855, -28.506522425280494, -8.706823010912998, -15.981052791657103, -26.434694737159564, -12.50532194751763, -15.177527009576476, -9.736094509765628, -18.252965657157265, -6.3353366148620225, -35.01484235934386, -20.04018414792604, -38.677569687250376, -43.108726352996, -32.30477265599069, -36.87943156153521, -33.78243907024207, -41.49563456665631, -23.933341102730846, -24.721303548932532, -14.465291942068477, -40.84614788464316, -10.528373025001303, -17.00346857312575, -14.344762661780754, -30.85497486361115, -15.289103671044247, -2.0309089477868296, -21.617908005612716, -42.17755202738457, -24.11330609755365, -19.479892982482923, -42.6303808783365, -19.30239150392302, -28.304201215466158, -54.643551069645824, -33.05712300747141, -30.31044296850583, -30.501813847251157, -7.525772806325641, -31.89223726299482, -23.423547156492223, -16.077477674595954, -15.034140602482607, -18.64954815414929, -40.069747930611854, -29.093697920120864, -30.31195371838063, -36.9660152648345, -43.609720991257426, -20.682036160959495, -17.5206026193765, -12.834111525968646, -30.96318316517064, -20.663298270300345], "policy_predator_policy_reward": [21.758600972770502, 37.42818389146173, 32.271026357348234, 50.279816614507155, 48.91182480865115, 27.7443717411648, 6.647181071704699, 41.608015825083555, 16.481536265594926, 14.49822971873712, 24.3402982990822, 38.99312291724147, 33.184168819033516, 6.783314339968194, 38.4241721287897, 25.125238586567498, 35.69139014398761, 15.111962153061935, 23.40318725810721, 37.23163407727566, 27.903244122564768, 16.015564732859783, 30.208783299809383, 16.03074887301128, 26.47045140679754, 23.85018864079802, 14.299691658180965, 24.086394040015062, 11.153402103006808, 11.3714164568739, 39.05226623511501, 12.204661278469267, 23.70826505070779, 4.615683753701728, 26.812448828628547, 19.851848062444624, 17.633727668740626, 14.638531390299509, 5.676998396676984, 6.963673995631188, 10.090160479275557, 56.25691123251605, 41.95723690596198, 25.37324387054202, 21.6441986287944, 5.9234968142496855, 28.506522425280494, 8.706823010912998, 15.981052791657103, 26.434694737159564, 12.50532194751763, 15.177527009576476, 9.736094509765628, 18.252965657157265, 6.3353366148620225, 35.01484235934386, 20.04018414792604, 38.677569687250376, 43.108726352996, 32.30477265599069, 36.87943156153521, 33.78243907024207, 41.49563456665631, 23.933341102730846, 24.721303548932532, 14.465291942068477, 40.84614788464316, 10.528373025001303, 17.00346857312575, 14.344762661780754, 30.85497486361115, 15.289103671044247, 2.0309089477868296, 21.617908005612716, 42.17755202738457, 24.11330609755365, 19.479892982482923, 42.6303808783365, 19.30239150392302, 28.304201215466158, 54.643551069645824, 33.05712300747141, 30.31044296850583, 30.501813847251157, 7.525772806325641, 31.89223726299482, 23.423547156492223, 16.077477674595954, 15.034140602482607, 18.64954815414929, 40.069747930611854, 29.093697920120864, 30.31195371838063, 36.9660152648345, 43.609720991257426, 20.682036160959495, 17.5206026193765, 12.834111525968646, 30.96318316517064, 20.663298270300345]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28858694888333963, "mean_inference_ms": 0.9640108718555486, "mean_action_processing_ms": 0.12844233315780543, "mean_env_wait_ms": 0.06812036410585373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002720355987548828, "StateBufferConnector_ms": 0.0025418996810913086, "ViewRequirementAgentConnector_ms": 0.057088375091552734}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1352000, "num_agent_steps_trained": 1352000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 720.4668128538007, "num_env_steps_trained_throughput_per_sec": 720.4668128538007, "timesteps_total": 676000, "num_env_steps_sampled_lifetime": 676000, "num_agent_steps_sampled_lifetime": 1352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1352000, "timers": {"training_iteration_time_ms": 5588.072, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5588.04, "sample_time_ms": 677.921, "learn_time_ms": 4896.268, "learn_throughput": 816.949, "synch_weights_time_ms": 13.527}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 1352000, "num_agent_steps_trained": 1352000}, "done": false, "training_iteration": 169, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-13-07", "timestamp": 1723396387, "time_this_iter_s": 5.558089971542358, "time_total_s": 1103.6483707427979, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9efcc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1103.6483707427979, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 29.8125, "ram_util_percent": 78.2125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0128407976124436, "cur_kl_coeff": 1.4693679385278597e-40, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03167198930750601, "policy_loss": -0.0015564315515803173, "vf_loss": 0.033228421005333075, "vf_explained_var": 0.9983084730803966, "kl": 0.0029704117191585054, "entropy": 0.06159443858341547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 162720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8602695890547086, "cur_kl_coeff": 6.617444900424223e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.019497632326965685, "policy_loss": -0.007476292873131267, "vf_loss": 0.026973924847213008, "vf_explained_var": 0.9985786036277811, "kl": 0.004021775507719322, "entropy": 0.24416097939635317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 162720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -56.25691123251605, "predator_policy": -0.025080335085858163}, "policy_reward_max": {"prey_policy": 0.025080335085858163, "predator_policy": 56.25691123251605}, "policy_reward_mean": {"prey_policy": -24.11905440636012, "predator_policy": 24.11905440636012}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-48.91182480865115, -27.7443717411648, -6.647181071704699, -41.608015825083555, -16.481536265594926, -14.49822971873712, -24.3402982990822, -38.99312291724147, -33.184168819033516, -6.783314339968194, -38.4241721287897, -25.125238586567498, -35.69139014398761, -15.111962153061935, -23.40318725810721, -37.23163407727566, -27.903244122564768, -16.015564732859783, -30.208783299809383, -16.03074887301128, -26.47045140679754, -23.85018864079802, -14.299691658180965, -24.086394040015062, -11.153402103006808, -11.3714164568739, -39.05226623511501, -12.204661278469267, -23.70826505070779, -4.615683753701728, -26.812448828628547, -19.851848062444624, -17.633727668740626, -14.638531390299509, -5.676998396676984, -6.963673995631188, -10.090160479275557, -56.25691123251605, -41.95723690596198, -25.37324387054202, -21.6441986287944, -5.9234968142496855, -28.506522425280494, -8.706823010912998, -15.981052791657103, -26.434694737159564, -12.50532194751763, -15.177527009576476, -9.736094509765628, -18.252965657157265, -6.3353366148620225, -35.01484235934386, -20.04018414792604, -38.677569687250376, -43.108726352996, -32.30477265599069, -36.87943156153521, -33.78243907024207, -41.49563456665631, -23.933341102730846, -24.721303548932532, -14.465291942068477, -40.84614788464316, -10.528373025001303, -17.00346857312575, -14.344762661780754, -30.85497486361115, -15.289103671044247, -2.0309089477868296, -21.617908005612716, -42.17755202738457, -24.11330609755365, -19.479892982482923, -42.6303808783365, -19.30239150392302, -28.304201215466158, -54.643551069645824, -33.05712300747141, -30.31044296850583, -30.501813847251157, -7.525772806325641, -31.89223726299482, -23.423547156492223, -16.077477674595954, -15.034140602482607, -18.64954815414929, -40.069747930611854, -29.093697920120864, -30.31195371838063, -36.9660152648345, -43.609720991257426, -20.682036160959495, -17.5206026193765, -12.834111525968646, -30.96318316517064, -20.663298270300345, -30.027319214557146, -28.957151434660023, 0.025080335085858163, -26.559894087947345], "policy_predator_policy_reward": [48.91182480865115, 27.7443717411648, 6.647181071704699, 41.608015825083555, 16.481536265594926, 14.49822971873712, 24.3402982990822, 38.99312291724147, 33.184168819033516, 6.783314339968194, 38.4241721287897, 25.125238586567498, 35.69139014398761, 15.111962153061935, 23.40318725810721, 37.23163407727566, 27.903244122564768, 16.015564732859783, 30.208783299809383, 16.03074887301128, 26.47045140679754, 23.85018864079802, 14.299691658180965, 24.086394040015062, 11.153402103006808, 11.3714164568739, 39.05226623511501, 12.204661278469267, 23.70826505070779, 4.615683753701728, 26.812448828628547, 19.851848062444624, 17.633727668740626, 14.638531390299509, 5.676998396676984, 6.963673995631188, 10.090160479275557, 56.25691123251605, 41.95723690596198, 25.37324387054202, 21.6441986287944, 5.9234968142496855, 28.506522425280494, 8.706823010912998, 15.981052791657103, 26.434694737159564, 12.50532194751763, 15.177527009576476, 9.736094509765628, 18.252965657157265, 6.3353366148620225, 35.01484235934386, 20.04018414792604, 38.677569687250376, 43.108726352996, 32.30477265599069, 36.87943156153521, 33.78243907024207, 41.49563456665631, 23.933341102730846, 24.721303548932532, 14.465291942068477, 40.84614788464316, 10.528373025001303, 17.00346857312575, 14.344762661780754, 30.85497486361115, 15.289103671044247, 2.0309089477868296, 21.617908005612716, 42.17755202738457, 24.11330609755365, 19.479892982482923, 42.6303808783365, 19.30239150392302, 28.304201215466158, 54.643551069645824, 33.05712300747141, 30.31044296850583, 30.501813847251157, 7.525772806325641, 31.89223726299482, 23.423547156492223, 16.077477674595954, 15.034140602482607, 18.64954815414929, 40.069747930611854, 29.093697920120864, 30.31195371838063, 36.9660152648345, 43.609720991257426, 20.682036160959495, 17.5206026193765, 12.834111525968646, 30.96318316517064, 20.663298270300345, 30.027319214557146, 28.957151434660023, -0.025080335085858163, 26.559894087947345]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2884657747808426, "mean_inference_ms": 0.9638796633468157, "mean_action_processing_ms": 0.1284059140858066, "mean_env_wait_ms": 0.06810167678111193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027627944946289062, "StateBufferConnector_ms": 0.0025718212127685547, "ViewRequirementAgentConnector_ms": 0.05797290802001953}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 767.2745101993786, "num_env_steps_trained_throughput_per_sec": 767.2745101993786, "timesteps_total": 680000, "num_env_steps_sampled_lifetime": 680000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 5520.806, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5520.774, "sample_time_ms": 662.957, "learn_time_ms": 4843.803, "learn_throughput": 825.797, "synch_weights_time_ms": 13.677}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 170, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-13-13", "timestamp": 1723396393, "time_this_iter_s": 5.21936297416687, "time_total_s": 1108.8677337169647, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a787aee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1108.8677337169647, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 31.642857142857142, "ram_util_percent": 78.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2102104799666753, "cur_kl_coeff": 7.346839692639298e-41, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.15437685226182415, "policy_loss": -0.006594846113148378, "vf_loss": 0.1609716980262116, "vf_explained_var": 0.9947506792843341, "kl": 0.003019296819821804, "entropy": 0.06862405604188097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 163680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3252791523002088, "cur_kl_coeff": 3.3087224502121113e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.15074079202871266, "policy_loss": -0.005034749030285942, "vf_loss": 0.15577554162300658, "vf_explained_var": 0.9947951807330052, "kl": 0.0030946678271878054, "entropy": 0.2524848404961328, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 163680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -56.25691123251605, "predator_policy": -0.025080335085858163}, "policy_reward_max": {"prey_policy": 0.025080335085858163, "predator_policy": 56.25691123251605}, "policy_reward_mean": {"prey_policy": -24.13833056567715, "predator_policy": 24.13833056567715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-6.783314339968194, -38.4241721287897, -25.125238586567498, -35.69139014398761, -15.111962153061935, -23.40318725810721, -37.23163407727566, -27.903244122564768, -16.015564732859783, -30.208783299809383, -16.03074887301128, -26.47045140679754, -23.85018864079802, -14.299691658180965, -24.086394040015062, -11.153402103006808, -11.3714164568739, -39.05226623511501, -12.204661278469267, -23.70826505070779, -4.615683753701728, -26.812448828628547, -19.851848062444624, -17.633727668740626, -14.638531390299509, -5.676998396676984, -6.963673995631188, -10.090160479275557, -56.25691123251605, -41.95723690596198, -25.37324387054202, -21.6441986287944, -5.9234968142496855, -28.506522425280494, -8.706823010912998, -15.981052791657103, -26.434694737159564, -12.50532194751763, -15.177527009576476, -9.736094509765628, -18.252965657157265, -6.3353366148620225, -35.01484235934386, -20.04018414792604, -38.677569687250376, -43.108726352996, -32.30477265599069, -36.87943156153521, -33.78243907024207, -41.49563456665631, -23.933341102730846, -24.721303548932532, -14.465291942068477, -40.84614788464316, -10.528373025001303, -17.00346857312575, -14.344762661780754, -30.85497486361115, -15.289103671044247, -2.0309089477868296, -21.617908005612716, -42.17755202738457, -24.11330609755365, -19.479892982482923, -42.6303808783365, -19.30239150392302, -28.304201215466158, -54.643551069645824, -33.05712300747141, -30.31044296850583, -30.501813847251157, -7.525772806325641, -31.89223726299482, -23.423547156492223, -16.077477674595954, -15.034140602482607, -18.64954815414929, -40.069747930611854, -29.093697920120864, -30.31195371838063, -36.9660152648345, -43.609720991257426, -20.682036160959495, -17.5206026193765, -12.834111525968646, -30.96318316517064, -20.663298270300345, -30.027319214557146, -28.957151434660023, 0.025080335085858163, -26.559894087947345, -21.07319266376143, -44.934725342234145, -51.21806592888487, -20.860714646396833, -23.129959091325425, -11.862818470213808, -27.319594039501776, -25.182686703076275, -28.754608512601802], "policy_predator_policy_reward": [6.783314339968194, 38.4241721287897, 25.125238586567498, 35.69139014398761, 15.111962153061935, 23.40318725810721, 37.23163407727566, 27.903244122564768, 16.015564732859783, 30.208783299809383, 16.03074887301128, 26.47045140679754, 23.85018864079802, 14.299691658180965, 24.086394040015062, 11.153402103006808, 11.3714164568739, 39.05226623511501, 12.204661278469267, 23.70826505070779, 4.615683753701728, 26.812448828628547, 19.851848062444624, 17.633727668740626, 14.638531390299509, 5.676998396676984, 6.963673995631188, 10.090160479275557, 56.25691123251605, 41.95723690596198, 25.37324387054202, 21.6441986287944, 5.9234968142496855, 28.506522425280494, 8.706823010912998, 15.981052791657103, 26.434694737159564, 12.50532194751763, 15.177527009576476, 9.736094509765628, 18.252965657157265, 6.3353366148620225, 35.01484235934386, 20.04018414792604, 38.677569687250376, 43.108726352996, 32.30477265599069, 36.87943156153521, 33.78243907024207, 41.49563456665631, 23.933341102730846, 24.721303548932532, 14.465291942068477, 40.84614788464316, 10.528373025001303, 17.00346857312575, 14.344762661780754, 30.85497486361115, 15.289103671044247, 2.0309089477868296, 21.617908005612716, 42.17755202738457, 24.11330609755365, 19.479892982482923, 42.6303808783365, 19.30239150392302, 28.304201215466158, 54.643551069645824, 33.05712300747141, 30.31044296850583, 30.501813847251157, 7.525772806325641, 31.89223726299482, 23.423547156492223, 16.077477674595954, 15.034140602482607, 18.64954815414929, 40.069747930611854, 29.093697920120864, 30.31195371838063, 36.9660152648345, 43.609720991257426, 20.682036160959495, 17.5206026193765, 12.834111525968646, 30.96318316517064, 20.663298270300345, 30.027319214557146, 28.957151434660023, -0.025080335085858163, 26.559894087947345, 21.07319266376143, 44.934725342234145, 51.21806592888487, 20.860714646396833, 23.129959091325425, 11.862818470213808, 27.319594039501776, 25.182686703076275, 28.754608512601802]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2884087032412614, "mean_inference_ms": 0.963719661398306, "mean_action_processing_ms": 0.12839137346648904, "mean_env_wait_ms": 0.06808470808856508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002871394157409668, "StateBufferConnector_ms": 0.002621173858642578, "ViewRequirementAgentConnector_ms": 0.05796325206756592}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 738.625839033062, "num_env_steps_trained_throughput_per_sec": 738.625839033062, "timesteps_total": 684000, "num_env_steps_sampled_lifetime": 684000, "num_agent_steps_sampled_lifetime": 1368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 5519.704, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5519.671, "sample_time_ms": 664.729, "learn_time_ms": 4840.921, "learn_throughput": 826.289, "synch_weights_time_ms": 13.677}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "training_iteration": 171, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-13-18", "timestamp": 1723396398, "time_this_iter_s": 5.420180082321167, "time_total_s": 1114.287913799286, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a787ae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1114.287913799286, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 28.7625, "ram_util_percent": 77.9125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9337908225444456, "cur_kl_coeff": 3.673419846319649e-41, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1097533258216572, "policy_loss": 0.00029783777851359144, "vf_loss": 0.10945548801100813, "vf_explained_var": 0.993849246079723, "kl": 0.0010193341808015426, "entropy": 0.052277307489566736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 164640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0870073538894454, "cur_kl_coeff": 1.6543612251060557e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09070745021017501, "policy_loss": -0.006794842536995323, "vf_loss": 0.09750229258303686, "vf_explained_var": 0.9941309494276841, "kl": 0.004349466895030633, "entropy": 0.20704108187928796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 164640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -56.25691123251605, "predator_policy": -0.025080335085858163}, "policy_reward_max": {"prey_policy": 0.025080335085858163, "predator_policy": 56.25691123251605}, "policy_reward_mean": {"prey_policy": -24.195055939485627, "predator_policy": 24.195055939485627}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-30.208783299809383, -16.03074887301128, -26.47045140679754, -23.85018864079802, -14.299691658180965, -24.086394040015062, -11.153402103006808, -11.3714164568739, -39.05226623511501, -12.204661278469267, -23.70826505070779, -4.615683753701728, -26.812448828628547, -19.851848062444624, -17.633727668740626, -14.638531390299509, -5.676998396676984, -6.963673995631188, -10.090160479275557, -56.25691123251605, -41.95723690596198, -25.37324387054202, -21.6441986287944, -5.9234968142496855, -28.506522425280494, -8.706823010912998, -15.981052791657103, -26.434694737159564, -12.50532194751763, -15.177527009576476, -9.736094509765628, -18.252965657157265, -6.3353366148620225, -35.01484235934386, -20.04018414792604, -38.677569687250376, -43.108726352996, -32.30477265599069, -36.87943156153521, -33.78243907024207, -41.49563456665631, -23.933341102730846, -24.721303548932532, -14.465291942068477, -40.84614788464316, -10.528373025001303, -17.00346857312575, -14.344762661780754, -30.85497486361115, -15.289103671044247, -2.0309089477868296, -21.617908005612716, -42.17755202738457, -24.11330609755365, -19.479892982482923, -42.6303808783365, -19.30239150392302, -28.304201215466158, -54.643551069645824, -33.05712300747141, -30.31044296850583, -30.501813847251157, -7.525772806325641, -31.89223726299482, -23.423547156492223, -16.077477674595954, -15.034140602482607, -18.64954815414929, -40.069747930611854, -29.093697920120864, -30.31195371838063, -36.9660152648345, -43.609720991257426, -20.682036160959495, -17.5206026193765, -12.834111525968646, -30.96318316517064, -20.663298270300345, -30.027319214557146, -28.957151434660023, 0.025080335085858163, -26.559894087947345, -21.07319266376143, -44.934725342234145, -51.21806592888487, -20.860714646396833, -23.129959091325425, -11.862818470213808, -27.319594039501776, -25.182686703076275, -28.754608512601802, -54.280341936164795, -27.50207229799464, -37.749965534777715, -32.412524869551504, -38.304225983514236, -18.168159985655535, -6.285429838567496, -7.000788192628416, -9.658736285175967], "policy_predator_policy_reward": [30.208783299809383, 16.03074887301128, 26.47045140679754, 23.85018864079802, 14.299691658180965, 24.086394040015062, 11.153402103006808, 11.3714164568739, 39.05226623511501, 12.204661278469267, 23.70826505070779, 4.615683753701728, 26.812448828628547, 19.851848062444624, 17.633727668740626, 14.638531390299509, 5.676998396676984, 6.963673995631188, 10.090160479275557, 56.25691123251605, 41.95723690596198, 25.37324387054202, 21.6441986287944, 5.9234968142496855, 28.506522425280494, 8.706823010912998, 15.981052791657103, 26.434694737159564, 12.50532194751763, 15.177527009576476, 9.736094509765628, 18.252965657157265, 6.3353366148620225, 35.01484235934386, 20.04018414792604, 38.677569687250376, 43.108726352996, 32.30477265599069, 36.87943156153521, 33.78243907024207, 41.49563456665631, 23.933341102730846, 24.721303548932532, 14.465291942068477, 40.84614788464316, 10.528373025001303, 17.00346857312575, 14.344762661780754, 30.85497486361115, 15.289103671044247, 2.0309089477868296, 21.617908005612716, 42.17755202738457, 24.11330609755365, 19.479892982482923, 42.6303808783365, 19.30239150392302, 28.304201215466158, 54.643551069645824, 33.05712300747141, 30.31044296850583, 30.501813847251157, 7.525772806325641, 31.89223726299482, 23.423547156492223, 16.077477674595954, 15.034140602482607, 18.64954815414929, 40.069747930611854, 29.093697920120864, 30.31195371838063, 36.9660152648345, 43.609720991257426, 20.682036160959495, 17.5206026193765, 12.834111525968646, 30.96318316517064, 20.663298270300345, 30.027319214557146, 28.957151434660023, -0.025080335085858163, 26.559894087947345, 21.07319266376143, 44.934725342234145, 51.21806592888487, 20.860714646396833, 23.129959091325425, 11.862818470213808, 27.319594039501776, 25.182686703076275, 28.754608512601802, 54.280341936164795, 27.50207229799464, 37.749965534777715, 32.412524869551504, 38.304225983514236, 18.168159985655535, 6.285429838567496, 7.000788192628416, 9.658736285175967]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28833005299929204, "mean_inference_ms": 0.9634714960759438, "mean_action_processing_ms": 0.12836891026105557, "mean_env_wait_ms": 0.0680635903190153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028189420700073242, "StateBufferConnector_ms": 0.0025644302368164062, "ViewRequirementAgentConnector_ms": 0.05661046504974365}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 713.6008087570201, "num_env_steps_trained_throughput_per_sec": 713.6008087570201, "timesteps_total": 688000, "num_env_steps_sampled_lifetime": 688000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 5508.011, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5507.977, "sample_time_ms": 665.403, "learn_time_ms": 4828.996, "learn_throughput": 828.329, "synch_weights_time_ms": 13.236}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 172, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-13-24", "timestamp": 1723396404, "time_this_iter_s": 5.610839128494263, "time_total_s": 1119.8987529277802, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9fbb820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1119.8987529277802, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 30.5875, "ram_util_percent": 77.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8741952292310695, "cur_kl_coeff": 1.8367099231598246e-41, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03106101286102785, "policy_loss": -0.00020414321067316148, "vf_loss": 0.03126515576223028, "vf_explained_var": 0.9988182306289672, "kl": 0.0045929358204142845, "entropy": 0.08083488748428257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 165600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8034475439848999, "cur_kl_coeff": 8.271806125530278e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.023801830295148343, "policy_loss": -0.006593715108707935, "vf_loss": 0.030395545096447072, "vf_explained_var": 0.9989371433854103, "kl": 0.0028613903503100667, "entropy": 0.22733424454927445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 165600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 1384000, "num_agent_steps_trained": 1384000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -56.25691123251605, "predator_policy": -0.025080335085858163}, "policy_reward_max": {"prey_policy": 0.025080335085858163, "predator_policy": 56.25691123251605}, "policy_reward_mean": {"prey_policy": -24.035313817251623, "predator_policy": 24.035313817251623}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-24.086394040015062, -11.153402103006808, -11.3714164568739, -39.05226623511501, -12.204661278469267, -23.70826505070779, -4.615683753701728, -26.812448828628547, -19.851848062444624, -17.633727668740626, -14.638531390299509, -5.676998396676984, -6.963673995631188, -10.090160479275557, -56.25691123251605, -41.95723690596198, -25.37324387054202, -21.6441986287944, -5.9234968142496855, -28.506522425280494, -8.706823010912998, -15.981052791657103, -26.434694737159564, -12.50532194751763, -15.177527009576476, -9.736094509765628, -18.252965657157265, -6.3353366148620225, -35.01484235934386, -20.04018414792604, -38.677569687250376, -43.108726352996, -32.30477265599069, -36.87943156153521, -33.78243907024207, -41.49563456665631, -23.933341102730846, -24.721303548932532, -14.465291942068477, -40.84614788464316, -10.528373025001303, -17.00346857312575, -14.344762661780754, -30.85497486361115, -15.289103671044247, -2.0309089477868296, -21.617908005612716, -42.17755202738457, -24.11330609755365, -19.479892982482923, -42.6303808783365, -19.30239150392302, -28.304201215466158, -54.643551069645824, -33.05712300747141, -30.31044296850583, -30.501813847251157, -7.525772806325641, -31.89223726299482, -23.423547156492223, -16.077477674595954, -15.034140602482607, -18.64954815414929, -40.069747930611854, -29.093697920120864, -30.31195371838063, -36.9660152648345, -43.609720991257426, -20.682036160959495, -17.5206026193765, -12.834111525968646, -30.96318316517064, -20.663298270300345, -30.027319214557146, -28.957151434660023, 0.025080335085858163, -26.559894087947345, -21.07319266376143, -44.934725342234145, -51.21806592888487, -20.860714646396833, -23.129959091325425, -11.862818470213808, -27.319594039501776, -25.182686703076275, -28.754608512601802, -54.280341936164795, -27.50207229799464, -37.749965534777715, -32.412524869551504, -38.304225983514236, -18.168159985655535, -6.285429838567496, -7.000788192628416, -9.658736285175967, -13.065422557922217, -17.80994756924958, -23.85315383860217, -32.84015205602592, -7.316975633396082], "policy_predator_policy_reward": [24.086394040015062, 11.153402103006808, 11.3714164568739, 39.05226623511501, 12.204661278469267, 23.70826505070779, 4.615683753701728, 26.812448828628547, 19.851848062444624, 17.633727668740626, 14.638531390299509, 5.676998396676984, 6.963673995631188, 10.090160479275557, 56.25691123251605, 41.95723690596198, 25.37324387054202, 21.6441986287944, 5.9234968142496855, 28.506522425280494, 8.706823010912998, 15.981052791657103, 26.434694737159564, 12.50532194751763, 15.177527009576476, 9.736094509765628, 18.252965657157265, 6.3353366148620225, 35.01484235934386, 20.04018414792604, 38.677569687250376, 43.108726352996, 32.30477265599069, 36.87943156153521, 33.78243907024207, 41.49563456665631, 23.933341102730846, 24.721303548932532, 14.465291942068477, 40.84614788464316, 10.528373025001303, 17.00346857312575, 14.344762661780754, 30.85497486361115, 15.289103671044247, 2.0309089477868296, 21.617908005612716, 42.17755202738457, 24.11330609755365, 19.479892982482923, 42.6303808783365, 19.30239150392302, 28.304201215466158, 54.643551069645824, 33.05712300747141, 30.31044296850583, 30.501813847251157, 7.525772806325641, 31.89223726299482, 23.423547156492223, 16.077477674595954, 15.034140602482607, 18.64954815414929, 40.069747930611854, 29.093697920120864, 30.31195371838063, 36.9660152648345, 43.609720991257426, 20.682036160959495, 17.5206026193765, 12.834111525968646, 30.96318316517064, 20.663298270300345, 30.027319214557146, 28.957151434660023, -0.025080335085858163, 26.559894087947345, 21.07319266376143, 44.934725342234145, 51.21806592888487, 20.860714646396833, 23.129959091325425, 11.862818470213808, 27.319594039501776, 25.182686703076275, 28.754608512601802, 54.280341936164795, 27.50207229799464, 37.749965534777715, 32.412524869551504, 38.304225983514236, 18.168159985655535, 6.285429838567496, 7.000788192628416, 9.658736285175967, 13.065422557922217, 17.80994756924958, 23.85315383860217, 32.84015205602592, 7.316975633396082]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.288368755222901, "mean_inference_ms": 0.963313415992889, "mean_action_processing_ms": 0.12837428360657394, "mean_env_wait_ms": 0.06805741507615076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027719736099243164, "StateBufferConnector_ms": 0.0024995803833007812, "ViewRequirementAgentConnector_ms": 0.05462801456451416}, "num_episodes": 5, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1384000, "num_agent_steps_trained": 1384000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 750.4961119371318, "num_env_steps_trained_throughput_per_sec": 750.4961119371318, "timesteps_total": 692000, "num_env_steps_sampled_lifetime": 692000, "num_agent_steps_sampled_lifetime": 1384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1384000, "timers": {"training_iteration_time_ms": 5495.378, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5495.344, "sample_time_ms": 661.147, "learn_time_ms": 4820.774, "learn_throughput": 829.742, "synch_weights_time_ms": 13.085}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 1384000, "num_agent_steps_trained": 1384000}, "done": false, "training_iteration": 173, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-13-29", "timestamp": 1723396409, "time_this_iter_s": 5.335185766220093, "time_total_s": 1125.2339386940002, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a787aca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1125.2339386940002, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 28.9, "ram_util_percent": 77.6125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0490619822405278, "cur_kl_coeff": 9.183549615799123e-42, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1216279798837301, "policy_loss": -0.005892470309239191, "vf_loss": 0.1275204499203634, "vf_explained_var": 0.9939626972501476, "kl": 0.029413467701895315, "entropy": 0.07970065369930429, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 166560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2676046196681758, "cur_kl_coeff": 4.135903062765139e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.10199276825102667, "policy_loss": -0.0030358772538117288, "vf_loss": 0.10502864561470536, "vf_explained_var": 0.994870835604767, "kl": 0.005216520104514074, "entropy": 0.24645010742048423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 166560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -56.25691123251605, "predator_policy": -0.025080335085858163}, "policy_reward_max": {"prey_policy": 0.025080335085858163, "predator_policy": 56.25691123251605}, "policy_reward_mean": {"prey_policy": -25.416093984202515, "predator_policy": 25.416093984202515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-17.633727668740626, -14.638531390299509, -5.676998396676984, -6.963673995631188, -10.090160479275557, -56.25691123251605, -41.95723690596198, -25.37324387054202, -21.6441986287944, -5.9234968142496855, -28.506522425280494, -8.706823010912998, -15.981052791657103, -26.434694737159564, -12.50532194751763, -15.177527009576476, -9.736094509765628, -18.252965657157265, -6.3353366148620225, -35.01484235934386, -20.04018414792604, -38.677569687250376, -43.108726352996, -32.30477265599069, -36.87943156153521, -33.78243907024207, -41.49563456665631, -23.933341102730846, -24.721303548932532, -14.465291942068477, -40.84614788464316, -10.528373025001303, -17.00346857312575, -14.344762661780754, -30.85497486361115, -15.289103671044247, -2.0309089477868296, -21.617908005612716, -42.17755202738457, -24.11330609755365, -19.479892982482923, -42.6303808783365, -19.30239150392302, -28.304201215466158, -54.643551069645824, -33.05712300747141, -30.31044296850583, -30.501813847251157, -7.525772806325641, -31.89223726299482, -23.423547156492223, -16.077477674595954, -15.034140602482607, -18.64954815414929, -40.069747930611854, -29.093697920120864, -30.31195371838063, -36.9660152648345, -43.609720991257426, -20.682036160959495, -17.5206026193765, -12.834111525968646, -30.96318316517064, -20.663298270300345, -30.027319214557146, -28.957151434660023, 0.025080335085858163, -26.559894087947345, -21.07319266376143, -44.934725342234145, -51.21806592888487, -20.860714646396833, -23.129959091325425, -11.862818470213808, -27.319594039501776, -25.182686703076275, -28.754608512601802, -54.280341936164795, -27.50207229799464, -37.749965534777715, -32.412524869551504, -38.304225983514236, -18.168159985655535, -6.285429838567496, -7.000788192628416, -9.658736285175967, -13.065422557922217, -17.80994756924958, -23.85315383860217, -32.84015205602592, -7.316975633396082, -44.43141261407091, -26.59385844208394, -26.26230626971555, -41.35836296284163, -36.07213716639947, -27.582224759731698, -50.87289069393142, -5.053515894306441, -52.70769370097162], "policy_predator_policy_reward": [17.633727668740626, 14.638531390299509, 5.676998396676984, 6.963673995631188, 10.090160479275557, 56.25691123251605, 41.95723690596198, 25.37324387054202, 21.6441986287944, 5.9234968142496855, 28.506522425280494, 8.706823010912998, 15.981052791657103, 26.434694737159564, 12.50532194751763, 15.177527009576476, 9.736094509765628, 18.252965657157265, 6.3353366148620225, 35.01484235934386, 20.04018414792604, 38.677569687250376, 43.108726352996, 32.30477265599069, 36.87943156153521, 33.78243907024207, 41.49563456665631, 23.933341102730846, 24.721303548932532, 14.465291942068477, 40.84614788464316, 10.528373025001303, 17.00346857312575, 14.344762661780754, 30.85497486361115, 15.289103671044247, 2.0309089477868296, 21.617908005612716, 42.17755202738457, 24.11330609755365, 19.479892982482923, 42.6303808783365, 19.30239150392302, 28.304201215466158, 54.643551069645824, 33.05712300747141, 30.31044296850583, 30.501813847251157, 7.525772806325641, 31.89223726299482, 23.423547156492223, 16.077477674595954, 15.034140602482607, 18.64954815414929, 40.069747930611854, 29.093697920120864, 30.31195371838063, 36.9660152648345, 43.609720991257426, 20.682036160959495, 17.5206026193765, 12.834111525968646, 30.96318316517064, 20.663298270300345, 30.027319214557146, 28.957151434660023, -0.025080335085858163, 26.559894087947345, 21.07319266376143, 44.934725342234145, 51.21806592888487, 20.860714646396833, 23.129959091325425, 11.862818470213808, 27.319594039501776, 25.182686703076275, 28.754608512601802, 54.280341936164795, 27.50207229799464, 37.749965534777715, 32.412524869551504, 38.304225983514236, 18.168159985655535, 6.285429838567496, 7.000788192628416, 9.658736285175967, 13.065422557922217, 17.80994756924958, 23.85315383860217, 32.84015205602592, 7.316975633396082, 44.43141261407091, 26.59385844208394, 26.26230626971555, 41.35836296284163, 36.07213716639947, 27.582224759731698, 50.87289069393142, 5.053515894306441, 52.70769370097162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2884549009200121, "mean_inference_ms": 0.9629958778720774, "mean_action_processing_ms": 0.1282983925778875, "mean_env_wait_ms": 0.06803318979945377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027871131896972656, "StateBufferConnector_ms": 0.0025234222412109375, "ViewRequirementAgentConnector_ms": 0.05484127998352051}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 736.1732131794064, "num_env_steps_trained_throughput_per_sec": 736.1732131794064, "timesteps_total": 696000, "num_env_steps_sampled_lifetime": 696000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 5472.212, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5472.18, "sample_time_ms": 660.707, "learn_time_ms": 4798.023, "learn_throughput": 833.677, "synch_weights_time_ms": 13.113}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 174, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-13-34", "timestamp": 1723396414, "time_this_iter_s": 5.436971664428711, "time_total_s": 1130.670910358429, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9fbb9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1130.670910358429, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 31.899999999999995, "ram_util_percent": 77.38571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6337205483112485, "cur_kl_coeff": 1.3775324423698679e-41, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.030487175744686585, "policy_loss": -0.0001245064546916789, "vf_loss": 0.03061168249259936, "vf_explained_var": 0.9975865930939715, "kl": 0.001712833735289916, "entropy": 0.08116181103590255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 167520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6846680393597732, "cur_kl_coeff": 4.135903062765139e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.004914560078032082, "policy_loss": -0.021394437665003353, "vf_loss": 0.02630899763122822, "vf_explained_var": 0.9980795825521152, "kl": 0.006341883577727715, "entropy": 0.23145359658325712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 167520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -54.643551069645824, "predator_policy": -0.025080335085858163}, "policy_reward_max": {"prey_policy": 0.025080335085858163, "predator_policy": 54.643551069645824}, "policy_reward_mean": {"prey_policy": -25.531026907890112, "predator_policy": 25.531026907890112}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-5.9234968142496855, -28.506522425280494, -8.706823010912998, -15.981052791657103, -26.434694737159564, -12.50532194751763, -15.177527009576476, -9.736094509765628, -18.252965657157265, -6.3353366148620225, -35.01484235934386, -20.04018414792604, -38.677569687250376, -43.108726352996, -32.30477265599069, -36.87943156153521, -33.78243907024207, -41.49563456665631, -23.933341102730846, -24.721303548932532, -14.465291942068477, -40.84614788464316, -10.528373025001303, -17.00346857312575, -14.344762661780754, -30.85497486361115, -15.289103671044247, -2.0309089477868296, -21.617908005612716, -42.17755202738457, -24.11330609755365, -19.479892982482923, -42.6303808783365, -19.30239150392302, -28.304201215466158, -54.643551069645824, -33.05712300747141, -30.31044296850583, -30.501813847251157, -7.525772806325641, -31.89223726299482, -23.423547156492223, -16.077477674595954, -15.034140602482607, -18.64954815414929, -40.069747930611854, -29.093697920120864, -30.31195371838063, -36.9660152648345, -43.609720991257426, -20.682036160959495, -17.5206026193765, -12.834111525968646, -30.96318316517064, -20.663298270300345, -30.027319214557146, -28.957151434660023, 0.025080335085858163, -26.559894087947345, -21.07319266376143, -44.934725342234145, -51.21806592888487, -20.860714646396833, -23.129959091325425, -11.862818470213808, -27.319594039501776, -25.182686703076275, -28.754608512601802, -54.280341936164795, -27.50207229799464, -37.749965534777715, -32.412524869551504, -38.304225983514236, -18.168159985655535, -6.285429838567496, -7.000788192628416, -9.658736285175967, -13.065422557922217, -17.80994756924958, -23.85315383860217, -32.84015205602592, -7.316975633396082, -44.43141261407091, -26.59385844208394, -26.26230626971555, -41.35836296284163, -36.07213716639947, -27.582224759731698, -50.87289069393142, -5.053515894306441, -52.70769370097162, -32.763744544970514, -27.27964671295727, -7.582936753359597, -16.29744435130356, -19.18861316540978, -13.844337047950464, -17.102842979030946, -36.216983097718945, -41.45142628449696], "policy_predator_policy_reward": [5.9234968142496855, 28.506522425280494, 8.706823010912998, 15.981052791657103, 26.434694737159564, 12.50532194751763, 15.177527009576476, 9.736094509765628, 18.252965657157265, 6.3353366148620225, 35.01484235934386, 20.04018414792604, 38.677569687250376, 43.108726352996, 32.30477265599069, 36.87943156153521, 33.78243907024207, 41.49563456665631, 23.933341102730846, 24.721303548932532, 14.465291942068477, 40.84614788464316, 10.528373025001303, 17.00346857312575, 14.344762661780754, 30.85497486361115, 15.289103671044247, 2.0309089477868296, 21.617908005612716, 42.17755202738457, 24.11330609755365, 19.479892982482923, 42.6303808783365, 19.30239150392302, 28.304201215466158, 54.643551069645824, 33.05712300747141, 30.31044296850583, 30.501813847251157, 7.525772806325641, 31.89223726299482, 23.423547156492223, 16.077477674595954, 15.034140602482607, 18.64954815414929, 40.069747930611854, 29.093697920120864, 30.31195371838063, 36.9660152648345, 43.609720991257426, 20.682036160959495, 17.5206026193765, 12.834111525968646, 30.96318316517064, 20.663298270300345, 30.027319214557146, 28.957151434660023, -0.025080335085858163, 26.559894087947345, 21.07319266376143, 44.934725342234145, 51.21806592888487, 20.860714646396833, 23.129959091325425, 11.862818470213808, 27.319594039501776, 25.182686703076275, 28.754608512601802, 54.280341936164795, 27.50207229799464, 37.749965534777715, 32.412524869551504, 38.304225983514236, 18.168159985655535, 6.285429838567496, 7.000788192628416, 9.658736285175967, 13.065422557922217, 17.80994756924958, 23.85315383860217, 32.84015205602592, 7.316975633396082, 44.43141261407091, 26.59385844208394, 26.26230626971555, 41.35836296284163, 36.07213716639947, 27.582224759731698, 50.87289069393142, 5.053515894306441, 52.70769370097162, 32.763744544970514, 27.27964671295727, 7.582936753359597, 16.29744435130356, 19.18861316540978, 13.844337047950464, 17.102842979030946, 36.216983097718945, 41.45142628449696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.288341417242686, "mean_inference_ms": 0.9626177801248028, "mean_action_processing_ms": 0.12825267234119564, "mean_env_wait_ms": 0.06800156219823024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027923583984375, "StateBufferConnector_ms": 0.0025222301483154297, "ViewRequirementAgentConnector_ms": 0.054939985275268555}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 637.771143806551, "num_env_steps_trained_throughput_per_sec": 637.771143806551, "timesteps_total": 700000, "num_env_steps_sampled_lifetime": 700000, "num_agent_steps_sampled_lifetime": 1400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1400000, "timers": {"training_iteration_time_ms": 5553.817, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5553.761, "sample_time_ms": 659.435, "learn_time_ms": 4879.546, "learn_throughput": 819.748, "synch_weights_time_ms": 14.17}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "done": false, "training_iteration": 175, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-13-41", "timestamp": 1723396421, "time_this_iter_s": 6.330132961273193, "time_total_s": 1137.0010433197021, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f2fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1137.0010433197021, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 36.58888888888889, "ram_util_percent": 78.47777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8646527871644746, "cur_kl_coeff": 6.887662211849339e-42, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04625364949121528, "policy_loss": -0.016416495180358957, "vf_loss": 0.06267014473560266, "vf_explained_var": 0.9961606082816918, "kl": 0.08040656297330868, "entropy": 0.06435545614076546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 168480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8550854597551127, "cur_kl_coeff": 4.135903062765139e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05503852619464548, "policy_loss": -0.006627896422287449, "vf_loss": 0.06166642281071593, "vf_explained_var": 0.9960753879199425, "kl": 0.00285507158499569, "entropy": 0.22415315215475856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 168480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -54.643551069645824, "predator_policy": -0.025080335085858163}, "policy_reward_max": {"prey_policy": 0.025080335085858163, "predator_policy": 54.643551069645824}, "policy_reward_mean": {"prey_policy": -26.324296677373514, "predator_policy": 26.324296677373514}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-6.3353366148620225, -35.01484235934386, -20.04018414792604, -38.677569687250376, -43.108726352996, -32.30477265599069, -36.87943156153521, -33.78243907024207, -41.49563456665631, -23.933341102730846, -24.721303548932532, -14.465291942068477, -40.84614788464316, -10.528373025001303, -17.00346857312575, -14.344762661780754, -30.85497486361115, -15.289103671044247, -2.0309089477868296, -21.617908005612716, -42.17755202738457, -24.11330609755365, -19.479892982482923, -42.6303808783365, -19.30239150392302, -28.304201215466158, -54.643551069645824, -33.05712300747141, -30.31044296850583, -30.501813847251157, -7.525772806325641, -31.89223726299482, -23.423547156492223, -16.077477674595954, -15.034140602482607, -18.64954815414929, -40.069747930611854, -29.093697920120864, -30.31195371838063, -36.9660152648345, -43.609720991257426, -20.682036160959495, -17.5206026193765, -12.834111525968646, -30.96318316517064, -20.663298270300345, -30.027319214557146, -28.957151434660023, 0.025080335085858163, -26.559894087947345, -21.07319266376143, -44.934725342234145, -51.21806592888487, -20.860714646396833, -23.129959091325425, -11.862818470213808, -27.319594039501776, -25.182686703076275, -28.754608512601802, -54.280341936164795, -27.50207229799464, -37.749965534777715, -32.412524869551504, -38.304225983514236, -18.168159985655535, -6.285429838567496, -7.000788192628416, -9.658736285175967, -13.065422557922217, -17.80994756924958, -23.85315383860217, -32.84015205602592, -7.316975633396082, -44.43141261407091, -26.59385844208394, -26.26230626971555, -41.35836296284163, -36.07213716639947, -27.582224759731698, -50.87289069393142, -5.053515894306441, -52.70769370097162, -32.763744544970514, -27.27964671295727, -7.582936753359597, -16.29744435130356, -19.18861316540978, -13.844337047950464, -17.102842979030946, -36.216983097718945, -41.45142628449696, -23.293781892489, -15.46996289859717, -31.85288550895892, -33.87280858682232, -7.718187998106092, -37.98533298958364, -16.403987288466112, -22.49117034944364, -31.463358339150112], "policy_predator_policy_reward": [6.3353366148620225, 35.01484235934386, 20.04018414792604, 38.677569687250376, 43.108726352996, 32.30477265599069, 36.87943156153521, 33.78243907024207, 41.49563456665631, 23.933341102730846, 24.721303548932532, 14.465291942068477, 40.84614788464316, 10.528373025001303, 17.00346857312575, 14.344762661780754, 30.85497486361115, 15.289103671044247, 2.0309089477868296, 21.617908005612716, 42.17755202738457, 24.11330609755365, 19.479892982482923, 42.6303808783365, 19.30239150392302, 28.304201215466158, 54.643551069645824, 33.05712300747141, 30.31044296850583, 30.501813847251157, 7.525772806325641, 31.89223726299482, 23.423547156492223, 16.077477674595954, 15.034140602482607, 18.64954815414929, 40.069747930611854, 29.093697920120864, 30.31195371838063, 36.9660152648345, 43.609720991257426, 20.682036160959495, 17.5206026193765, 12.834111525968646, 30.96318316517064, 20.663298270300345, 30.027319214557146, 28.957151434660023, -0.025080335085858163, 26.559894087947345, 21.07319266376143, 44.934725342234145, 51.21806592888487, 20.860714646396833, 23.129959091325425, 11.862818470213808, 27.319594039501776, 25.182686703076275, 28.754608512601802, 54.280341936164795, 27.50207229799464, 37.749965534777715, 32.412524869551504, 38.304225983514236, 18.168159985655535, 6.285429838567496, 7.000788192628416, 9.658736285175967, 13.065422557922217, 17.80994756924958, 23.85315383860217, 32.84015205602592, 7.316975633396082, 44.43141261407091, 26.59385844208394, 26.26230626971555, 41.35836296284163, 36.07213716639947, 27.582224759731698, 50.87289069393142, 5.053515894306441, 52.70769370097162, 32.763744544970514, 27.27964671295727, 7.582936753359597, 16.29744435130356, 19.18861316540978, 13.844337047950464, 17.102842979030946, 36.216983097718945, 41.45142628449696, 23.293781892489, 15.46996289859717, 31.85288550895892, 33.87280858682232, 7.718187998106092, 37.98533298958364, 16.403987288466112, 22.49117034944364, 31.463358339150112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2880797018056224, "mean_inference_ms": 0.9624514471446015, "mean_action_processing_ms": 0.1282679643321654, "mean_env_wait_ms": 0.06798351762302586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029108524322509766, "StateBufferConnector_ms": 0.0025680065155029297, "ViewRequirementAgentConnector_ms": 0.05624878406524658}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 655.0784697920058, "num_env_steps_trained_throughput_per_sec": 655.0784697920058, "timesteps_total": 704000, "num_env_steps_sampled_lifetime": 704000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 5623.165, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5623.106, "sample_time_ms": 696.989, "learn_time_ms": 4911.384, "learn_throughput": 814.434, "synch_weights_time_ms": 14.121}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 176, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-13-47", "timestamp": 1723396427, "time_this_iter_s": 6.1114630699157715, "time_total_s": 1143.112506389618, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2fe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1143.112506389618, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 34.300000000000004, "ram_util_percent": 80.87777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0334198703989386, "cur_kl_coeff": 1.0331493317774014e-41, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09112339668693797, "policy_loss": -0.0008488573187302487, "vf_loss": 0.09197225460084155, "vf_explained_var": 0.9944994072740276, "kl": 0.0032850195370994323, "entropy": 0.06269854202788944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 169440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1792092555978646, "cur_kl_coeff": 2.0679515313825696e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0893763497658559, "policy_loss": -0.0029046320436464158, "vf_loss": 0.09228098227855905, "vf_explained_var": 0.9944557739421725, "kl": 0.0023699179312690016, "entropy": 0.22888010578850906, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 169440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -54.643551069645824, "predator_policy": -0.025080335085858163}, "policy_reward_max": {"prey_policy": 0.025080335085858163, "predator_policy": 54.643551069645824}, "policy_reward_mean": {"prey_policy": -25.36143731563535, "predator_policy": 25.36143731563535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-23.933341102730846, -24.721303548932532, -14.465291942068477, -40.84614788464316, -10.528373025001303, -17.00346857312575, -14.344762661780754, -30.85497486361115, -15.289103671044247, -2.0309089477868296, -21.617908005612716, -42.17755202738457, -24.11330609755365, -19.479892982482923, -42.6303808783365, -19.30239150392302, -28.304201215466158, -54.643551069645824, -33.05712300747141, -30.31044296850583, -30.501813847251157, -7.525772806325641, -31.89223726299482, -23.423547156492223, -16.077477674595954, -15.034140602482607, -18.64954815414929, -40.069747930611854, -29.093697920120864, -30.31195371838063, -36.9660152648345, -43.609720991257426, -20.682036160959495, -17.5206026193765, -12.834111525968646, -30.96318316517064, -20.663298270300345, -30.027319214557146, -28.957151434660023, 0.025080335085858163, -26.559894087947345, -21.07319266376143, -44.934725342234145, -51.21806592888487, -20.860714646396833, -23.129959091325425, -11.862818470213808, -27.319594039501776, -25.182686703076275, -28.754608512601802, -54.280341936164795, -27.50207229799464, -37.749965534777715, -32.412524869551504, -38.304225983514236, -18.168159985655535, -6.285429838567496, -7.000788192628416, -9.658736285175967, -13.065422557922217, -17.80994756924958, -23.85315383860217, -32.84015205602592, -7.316975633396082, -44.43141261407091, -26.59385844208394, -26.26230626971555, -41.35836296284163, -36.07213716639947, -27.582224759731698, -50.87289069393142, -5.053515894306441, -52.70769370097162, -32.763744544970514, -27.27964671295727, -7.582936753359597, -16.29744435130356, -19.18861316540978, -13.844337047950464, -17.102842979030946, -36.216983097718945, -41.45142628449696, -23.293781892489, -15.46996289859717, -31.85288550895892, -33.87280858682232, -7.718187998106092, -37.98533298958364, -16.403987288466112, -22.49117034944364, -31.463358339150112, -11.083953461304947, -7.798499916206144, -39.93262832295289, -23.22091786716155, -9.736846153156147, -29.6684293436966, -23.99297814796962, -21.14998998768789, -24.768757642849817], "policy_predator_policy_reward": [23.933341102730846, 24.721303548932532, 14.465291942068477, 40.84614788464316, 10.528373025001303, 17.00346857312575, 14.344762661780754, 30.85497486361115, 15.289103671044247, 2.0309089477868296, 21.617908005612716, 42.17755202738457, 24.11330609755365, 19.479892982482923, 42.6303808783365, 19.30239150392302, 28.304201215466158, 54.643551069645824, 33.05712300747141, 30.31044296850583, 30.501813847251157, 7.525772806325641, 31.89223726299482, 23.423547156492223, 16.077477674595954, 15.034140602482607, 18.64954815414929, 40.069747930611854, 29.093697920120864, 30.31195371838063, 36.9660152648345, 43.609720991257426, 20.682036160959495, 17.5206026193765, 12.834111525968646, 30.96318316517064, 20.663298270300345, 30.027319214557146, 28.957151434660023, -0.025080335085858163, 26.559894087947345, 21.07319266376143, 44.934725342234145, 51.21806592888487, 20.860714646396833, 23.129959091325425, 11.862818470213808, 27.319594039501776, 25.182686703076275, 28.754608512601802, 54.280341936164795, 27.50207229799464, 37.749965534777715, 32.412524869551504, 38.304225983514236, 18.168159985655535, 6.285429838567496, 7.000788192628416, 9.658736285175967, 13.065422557922217, 17.80994756924958, 23.85315383860217, 32.84015205602592, 7.316975633396082, 44.43141261407091, 26.59385844208394, 26.26230626971555, 41.35836296284163, 36.07213716639947, 27.582224759731698, 50.87289069393142, 5.053515894306441, 52.70769370097162, 32.763744544970514, 27.27964671295727, 7.582936753359597, 16.29744435130356, 19.18861316540978, 13.844337047950464, 17.102842979030946, 36.216983097718945, 41.45142628449696, 23.293781892489, 15.46996289859717, 31.85288550895892, 33.87280858682232, 7.718187998106092, 37.98533298958364, 16.403987288466112, 22.49117034944364, 31.463358339150112, 11.083953461304947, 7.798499916206144, 39.93262832295289, 23.22091786716155, 9.736846153156147, 29.6684293436966, 23.99297814796962, 21.14998998768789, 24.768757642849817]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2880196267984075, "mean_inference_ms": 0.9623797273405286, "mean_action_processing_ms": 0.1282542566438353, "mean_env_wait_ms": 0.06797591416759755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002904057502746582, "StateBufferConnector_ms": 0.002582073211669922, "ViewRequirementAgentConnector_ms": 0.05243420600891113}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 674.5665974457748, "num_env_steps_trained_throughput_per_sec": 674.5665974457748, "timesteps_total": 708000, "num_env_steps_sampled_lifetime": 708000, "num_agent_steps_sampled_lifetime": 1416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 5656.413, "restore_workers_time_ms": 0.012, "training_step_time_ms": 5656.354, "sample_time_ms": 698.581, "learn_time_ms": 4942.908, "learn_throughput": 809.24, "synch_weights_time_ms": 14.256}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "training_iteration": 177, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-13-53", "timestamp": 1723396433, "time_this_iter_s": 5.934345245361328, "time_total_s": 1149.0468516349792, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f65310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1149.0468516349792, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 30.355555555555554, "ram_util_percent": 80.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8154167637617017, "cur_kl_coeff": 5.165746658887007e-42, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06975674578400988, "policy_loss": -0.0018710152368536608, "vf_loss": 0.0716277609244571, "vf_explained_var": 0.9958157538746794, "kl": 0.0030998389838170276, "entropy": 0.07083101377550823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 170400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9060616546155263, "cur_kl_coeff": 1.0339757656912848e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.050654365123409664, "policy_loss": -0.008508377167648481, "vf_loss": 0.05916274300349566, "vf_explained_var": 0.9970278563598792, "kl": 0.0032695444569441974, "entropy": 0.20679494997796913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 170400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -54.643551069645824, "predator_policy": -0.025080335085858163}, "policy_reward_max": {"prey_policy": 0.025080335085858163, "predator_policy": 54.643551069645824}, "policy_reward_mean": {"prey_policy": -25.499967913620843, "predator_policy": 25.499967913620843}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-2.0309089477868296, -21.617908005612716, -42.17755202738457, -24.11330609755365, -19.479892982482923, -42.6303808783365, -19.30239150392302, -28.304201215466158, -54.643551069645824, -33.05712300747141, -30.31044296850583, -30.501813847251157, -7.525772806325641, -31.89223726299482, -23.423547156492223, -16.077477674595954, -15.034140602482607, -18.64954815414929, -40.069747930611854, -29.093697920120864, -30.31195371838063, -36.9660152648345, -43.609720991257426, -20.682036160959495, -17.5206026193765, -12.834111525968646, -30.96318316517064, -20.663298270300345, -30.027319214557146, -28.957151434660023, 0.025080335085858163, -26.559894087947345, -21.07319266376143, -44.934725342234145, -51.21806592888487, -20.860714646396833, -23.129959091325425, -11.862818470213808, -27.319594039501776, -25.182686703076275, -28.754608512601802, -54.280341936164795, -27.50207229799464, -37.749965534777715, -32.412524869551504, -38.304225983514236, -18.168159985655535, -6.285429838567496, -7.000788192628416, -9.658736285175967, -13.065422557922217, -17.80994756924958, -23.85315383860217, -32.84015205602592, -7.316975633396082, -44.43141261407091, -26.59385844208394, -26.26230626971555, -41.35836296284163, -36.07213716639947, -27.582224759731698, -50.87289069393142, -5.053515894306441, -52.70769370097162, -32.763744544970514, -27.27964671295727, -7.582936753359597, -16.29744435130356, -19.18861316540978, -13.844337047950464, -17.102842979030946, -36.216983097718945, -41.45142628449696, -23.293781892489, -15.46996289859717, -31.85288550895892, -33.87280858682232, -7.718187998106092, -37.98533298958364, -16.403987288466112, -22.49117034944364, -31.463358339150112, -11.083953461304947, -7.798499916206144, -39.93262832295289, -23.22091786716155, -9.736846153156147, -29.6684293436966, -23.99297814796962, -21.14998998768789, -24.768757642849817, -24.833325345973588, -32.3743247796403, -26.726681165609484, -17.8675915849858, -22.88948885697551, -16.68422207538675, -19.45560265542364, -15.66144914711986, -29.34714146037229], "policy_predator_policy_reward": [2.0309089477868296, 21.617908005612716, 42.17755202738457, 24.11330609755365, 19.479892982482923, 42.6303808783365, 19.30239150392302, 28.304201215466158, 54.643551069645824, 33.05712300747141, 30.31044296850583, 30.501813847251157, 7.525772806325641, 31.89223726299482, 23.423547156492223, 16.077477674595954, 15.034140602482607, 18.64954815414929, 40.069747930611854, 29.093697920120864, 30.31195371838063, 36.9660152648345, 43.609720991257426, 20.682036160959495, 17.5206026193765, 12.834111525968646, 30.96318316517064, 20.663298270300345, 30.027319214557146, 28.957151434660023, -0.025080335085858163, 26.559894087947345, 21.07319266376143, 44.934725342234145, 51.21806592888487, 20.860714646396833, 23.129959091325425, 11.862818470213808, 27.319594039501776, 25.182686703076275, 28.754608512601802, 54.280341936164795, 27.50207229799464, 37.749965534777715, 32.412524869551504, 38.304225983514236, 18.168159985655535, 6.285429838567496, 7.000788192628416, 9.658736285175967, 13.065422557922217, 17.80994756924958, 23.85315383860217, 32.84015205602592, 7.316975633396082, 44.43141261407091, 26.59385844208394, 26.26230626971555, 41.35836296284163, 36.07213716639947, 27.582224759731698, 50.87289069393142, 5.053515894306441, 52.70769370097162, 32.763744544970514, 27.27964671295727, 7.582936753359597, 16.29744435130356, 19.18861316540978, 13.844337047950464, 17.102842979030946, 36.216983097718945, 41.45142628449696, 23.293781892489, 15.46996289859717, 31.85288550895892, 33.87280858682232, 7.718187998106092, 37.98533298958364, 16.403987288466112, 22.49117034944364, 31.463358339150112, 11.083953461304947, 7.798499916206144, 39.93262832295289, 23.22091786716155, 9.736846153156147, 29.6684293436966, 23.99297814796962, 21.14998998768789, 24.768757642849817, 24.833325345973588, 32.3743247796403, 26.726681165609484, 17.8675915849858, 22.88948885697551, 16.68422207538675, 19.45560265542364, 15.66144914711986, 29.34714146037229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2879905740712981, "mean_inference_ms": 0.9624615547191769, "mean_action_processing_ms": 0.12825986007335133, "mean_env_wait_ms": 0.06798324237232362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002891063690185547, "StateBufferConnector_ms": 0.0025185346603393555, "ViewRequirementAgentConnector_ms": 0.05266427993774414}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 672.4033768747356, "num_env_steps_trained_throughput_per_sec": 672.4033768747356, "timesteps_total": 712000, "num_env_steps_sampled_lifetime": 712000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 5680.598, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5680.533, "sample_time_ms": 705.721, "learn_time_ms": 4960.151, "learn_throughput": 806.427, "synch_weights_time_ms": 14.052}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 178, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-13-59", "timestamp": 1723396439, "time_this_iter_s": 5.953459978103638, "time_total_s": 1155.0003116130829, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a787aca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1155.0003116130829, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 34.15, "ram_util_percent": 79.6125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8352704296587035, "cur_kl_coeff": 2.5828733294435035e-42, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.023967225856661875, "policy_loss": 0.000604482524067862, "vf_loss": 0.02336274318464954, "vf_explained_var": 0.997853815369308, "kl": 0.0016125059952874258, "entropy": 0.06014203240629286, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 171360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.68338889896404, "cur_kl_coeff": 5.169878828456424e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0070468171705821685, "policy_loss": -0.015554973733621106, "vf_loss": 0.022601790409438157, "vf_explained_var": 0.9980563482269644, "kl": 0.01171251005853613, "entropy": 0.20222792698380848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 171360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 1432000, "num_agent_steps_trained": 1432000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -54.643551069645824, "predator_policy": -0.025080335085858163}, "policy_reward_max": {"prey_policy": 0.025080335085858163, "predator_policy": 54.643551069645824}, "policy_reward_mean": {"prey_policy": -25.546303795493294, "predator_policy": 25.546303795493294}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-19.479892982482923, -42.6303808783365, -19.30239150392302, -28.304201215466158, -54.643551069645824, -33.05712300747141, -30.31044296850583, -30.501813847251157, -7.525772806325641, -31.89223726299482, -23.423547156492223, -16.077477674595954, -15.034140602482607, -18.64954815414929, -40.069747930611854, -29.093697920120864, -30.31195371838063, -36.9660152648345, -43.609720991257426, -20.682036160959495, -17.5206026193765, -12.834111525968646, -30.96318316517064, -20.663298270300345, -30.027319214557146, -28.957151434660023, 0.025080335085858163, -26.559894087947345, -21.07319266376143, -44.934725342234145, -51.21806592888487, -20.860714646396833, -23.129959091325425, -11.862818470213808, -27.319594039501776, -25.182686703076275, -28.754608512601802, -54.280341936164795, -27.50207229799464, -37.749965534777715, -32.412524869551504, -38.304225983514236, -18.168159985655535, -6.285429838567496, -7.000788192628416, -9.658736285175967, -13.065422557922217, -17.80994756924958, -23.85315383860217, -32.84015205602592, -7.316975633396082, -44.43141261407091, -26.59385844208394, -26.26230626971555, -41.35836296284163, -36.07213716639947, -27.582224759731698, -50.87289069393142, -5.053515894306441, -52.70769370097162, -32.763744544970514, -27.27964671295727, -7.582936753359597, -16.29744435130356, -19.18861316540978, -13.844337047950464, -17.102842979030946, -36.216983097718945, -41.45142628449696, -23.293781892489, -15.46996289859717, -31.85288550895892, -33.87280858682232, -7.718187998106092, -37.98533298958364, -16.403987288466112, -22.49117034944364, -31.463358339150112, -11.083953461304947, -7.798499916206144, -39.93262832295289, -23.22091786716155, -9.736846153156147, -29.6684293436966, -23.99297814796962, -21.14998998768789, -24.768757642849817, -24.833325345973588, -32.3743247796403, -26.726681165609484, -17.8675915849858, -22.88948885697551, -16.68422207538675, -19.45560265542364, -15.66144914711986, -29.34714146037229, -40.13093818911391, -33.00097596455997, -18.473171175256986, -2.9681779366529457], "policy_predator_policy_reward": [19.479892982482923, 42.6303808783365, 19.30239150392302, 28.304201215466158, 54.643551069645824, 33.05712300747141, 30.31044296850583, 30.501813847251157, 7.525772806325641, 31.89223726299482, 23.423547156492223, 16.077477674595954, 15.034140602482607, 18.64954815414929, 40.069747930611854, 29.093697920120864, 30.31195371838063, 36.9660152648345, 43.609720991257426, 20.682036160959495, 17.5206026193765, 12.834111525968646, 30.96318316517064, 20.663298270300345, 30.027319214557146, 28.957151434660023, -0.025080335085858163, 26.559894087947345, 21.07319266376143, 44.934725342234145, 51.21806592888487, 20.860714646396833, 23.129959091325425, 11.862818470213808, 27.319594039501776, 25.182686703076275, 28.754608512601802, 54.280341936164795, 27.50207229799464, 37.749965534777715, 32.412524869551504, 38.304225983514236, 18.168159985655535, 6.285429838567496, 7.000788192628416, 9.658736285175967, 13.065422557922217, 17.80994756924958, 23.85315383860217, 32.84015205602592, 7.316975633396082, 44.43141261407091, 26.59385844208394, 26.26230626971555, 41.35836296284163, 36.07213716639947, 27.582224759731698, 50.87289069393142, 5.053515894306441, 52.70769370097162, 32.763744544970514, 27.27964671295727, 7.582936753359597, 16.29744435130356, 19.18861316540978, 13.844337047950464, 17.102842979030946, 36.216983097718945, 41.45142628449696, 23.293781892489, 15.46996289859717, 31.85288550895892, 33.87280858682232, 7.718187998106092, 37.98533298958364, 16.403987288466112, 22.49117034944364, 31.463358339150112, 11.083953461304947, 7.798499916206144, 39.93262832295289, 23.22091786716155, 9.736846153156147, 29.6684293436966, 23.99297814796962, 21.14998998768789, 24.768757642849817, 24.833325345973588, 32.3743247796403, 26.726681165609484, 17.8675915849858, 22.88948885697551, 16.68422207538675, 19.45560265542364, 15.66144914711986, 29.34714146037229, 40.13093818911391, 33.00097596455997, 18.473171175256986, 2.9681779366529457]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28789193123859014, "mean_inference_ms": 0.9624758334001413, "mean_action_processing_ms": 0.1282397054336721, "mean_env_wait_ms": 0.06798053235521573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002897500991821289, "StateBufferConnector_ms": 0.0025293827056884766, "ViewRequirementAgentConnector_ms": 0.053023338317871094}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1432000, "num_agent_steps_trained": 1432000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 569.613789032531, "num_env_steps_trained_throughput_per_sec": 569.613789032531, "timesteps_total": 716000, "num_env_steps_sampled_lifetime": 716000, "num_agent_steps_sampled_lifetime": 1432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1432000, "timers": {"training_iteration_time_ms": 5827.633, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5827.567, "sample_time_ms": 710.244, "learn_time_ms": 5101.697, "learn_throughput": 784.053, "synch_weights_time_ms": 14.998}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 1432000, "num_agent_steps_trained": 1432000}, "done": false, "training_iteration": 179, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-14-06", "timestamp": 1723396446, "time_this_iter_s": 7.028319835662842, "time_total_s": 1162.0286314487457, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f2fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1162.0286314487457, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 48.05, "ram_util_percent": 80.66999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8872450838641573, "cur_kl_coeff": 1.2914366647217518e-42, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07394924790060031, "policy_loss": -0.0010471997173832884, "vf_loss": 0.07499644788040313, "vf_explained_var": 0.9953084360808134, "kl": 0.005896991199860679, "entropy": 0.05731935614918863, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 172320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9459151417016983, "cur_kl_coeff": 5.169878828456424e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0871995710516785, "policy_loss": -0.0045689821614359975, "vf_loss": 0.09176855363427118, "vf_explained_var": 0.9945936360706885, "kl": 0.0030260653517377293, "entropy": 0.21190399018426737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 172320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -54.280341936164795, "predator_policy": -0.025080335085858163}, "policy_reward_max": {"prey_policy": 0.025080335085858163, "predator_policy": 54.280341936164795}, "policy_reward_mean": {"prey_policy": -25.442728846380263, "predator_policy": 25.442728846380263}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-31.89223726299482, -23.423547156492223, -16.077477674595954, -15.034140602482607, -18.64954815414929, -40.069747930611854, -29.093697920120864, -30.31195371838063, -36.9660152648345, -43.609720991257426, -20.682036160959495, -17.5206026193765, -12.834111525968646, -30.96318316517064, -20.663298270300345, -30.027319214557146, -28.957151434660023, 0.025080335085858163, -26.559894087947345, -21.07319266376143, -44.934725342234145, -51.21806592888487, -20.860714646396833, -23.129959091325425, -11.862818470213808, -27.319594039501776, -25.182686703076275, -28.754608512601802, -54.280341936164795, -27.50207229799464, -37.749965534777715, -32.412524869551504, -38.304225983514236, -18.168159985655535, -6.285429838567496, -7.000788192628416, -9.658736285175967, -13.065422557922217, -17.80994756924958, -23.85315383860217, -32.84015205602592, -7.316975633396082, -44.43141261407091, -26.59385844208394, -26.26230626971555, -41.35836296284163, -36.07213716639947, -27.582224759731698, -50.87289069393142, -5.053515894306441, -52.70769370097162, -32.763744544970514, -27.27964671295727, -7.582936753359597, -16.29744435130356, -19.18861316540978, -13.844337047950464, -17.102842979030946, -36.216983097718945, -41.45142628449696, -23.293781892489, -15.46996289859717, -31.85288550895892, -33.87280858682232, -7.718187998106092, -37.98533298958364, -16.403987288466112, -22.49117034944364, -31.463358339150112, -11.083953461304947, -7.798499916206144, -39.93262832295289, -23.22091786716155, -9.736846153156147, -29.6684293436966, -23.99297814796962, -21.14998998768789, -24.768757642849817, -24.833325345973588, -32.3743247796403, -26.726681165609484, -17.8675915849858, -22.88948885697551, -16.68422207538675, -19.45560265542364, -15.66144914711986, -29.34714146037229, -40.13093818911391, -33.00097596455997, -18.473171175256986, -2.9681779366529457, -13.912695152095331, -18.93435024655612, -34.20710680346676, -29.795101767730447, -38.31834428017376, -22.793699433307477, -42.40736648334758, -25.2075039009648, -29.821907300462378], "policy_predator_policy_reward": [31.89223726299482, 23.423547156492223, 16.077477674595954, 15.034140602482607, 18.64954815414929, 40.069747930611854, 29.093697920120864, 30.31195371838063, 36.9660152648345, 43.609720991257426, 20.682036160959495, 17.5206026193765, 12.834111525968646, 30.96318316517064, 20.663298270300345, 30.027319214557146, 28.957151434660023, -0.025080335085858163, 26.559894087947345, 21.07319266376143, 44.934725342234145, 51.21806592888487, 20.860714646396833, 23.129959091325425, 11.862818470213808, 27.319594039501776, 25.182686703076275, 28.754608512601802, 54.280341936164795, 27.50207229799464, 37.749965534777715, 32.412524869551504, 38.304225983514236, 18.168159985655535, 6.285429838567496, 7.000788192628416, 9.658736285175967, 13.065422557922217, 17.80994756924958, 23.85315383860217, 32.84015205602592, 7.316975633396082, 44.43141261407091, 26.59385844208394, 26.26230626971555, 41.35836296284163, 36.07213716639947, 27.582224759731698, 50.87289069393142, 5.053515894306441, 52.70769370097162, 32.763744544970514, 27.27964671295727, 7.582936753359597, 16.29744435130356, 19.18861316540978, 13.844337047950464, 17.102842979030946, 36.216983097718945, 41.45142628449696, 23.293781892489, 15.46996289859717, 31.85288550895892, 33.87280858682232, 7.718187998106092, 37.98533298958364, 16.403987288466112, 22.49117034944364, 31.463358339150112, 11.083953461304947, 7.798499916206144, 39.93262832295289, 23.22091786716155, 9.736846153156147, 29.6684293436966, 23.99297814796962, 21.14998998768789, 24.768757642849817, 24.833325345973588, 32.3743247796403, 26.726681165609484, 17.8675915849858, 22.88948885697551, 16.68422207538675, 19.45560265542364, 15.66144914711986, 29.34714146037229, 40.13093818911391, 33.00097596455997, 18.473171175256986, 2.9681779366529457, 13.912695152095331, 18.93435024655612, 34.20710680346676, 29.795101767730447, 38.31834428017376, 22.793699433307477, 42.40736648334758, 25.2075039009648, 29.821907300462378]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28805415191134803, "mean_inference_ms": 0.963167129300987, "mean_action_processing_ms": 0.12831083451153538, "mean_env_wait_ms": 0.06804644130606183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005659937858581543, "StateBufferConnector_ms": 0.002663850784301758, "ViewRequirementAgentConnector_ms": 0.05615401268005371}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 607.8266060434729, "num_env_steps_trained_throughput_per_sec": 607.8266060434729, "timesteps_total": 720000, "num_env_steps_sampled_lifetime": 720000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 5964.39, "restore_workers_time_ms": 0.017, "training_step_time_ms": 5964.324, "sample_time_ms": 784.931, "learn_time_ms": 5163.59, "learn_throughput": 774.655, "synch_weights_time_ms": 15.177}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 180, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-14-13", "timestamp": 1723396453, "time_this_iter_s": 6.586110830307007, "time_total_s": 1168.6147422790527, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f2fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1168.6147422790527, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 45.019999999999996, "ram_util_percent": 83.01}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2919285589518645, "cur_kl_coeff": 1.2914366647217518e-42, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1065020256464777, "policy_loss": 0.00045619772499776444, "vf_loss": 0.10604582763335202, "vf_explained_var": 0.9955954002837341, "kl": 0.00230770516867022, "entropy": 0.08539513925594898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 173280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3505208201551189, "cur_kl_coeff": 2.584939414228212e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1011003136857956, "policy_loss": -0.000855534260335844, "vf_loss": 0.10195584760707183, "vf_explained_var": 0.9956176704416673, "kl": 0.002873285978294016, "entropy": 0.2430317114572972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 173280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 1448000, "num_agent_steps_trained": 1448000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -54.280341936164795, "predator_policy": -0.025080335085858163}, "policy_reward_max": {"prey_policy": 0.025080335085858163, "predator_policy": 54.280341936164795}, "policy_reward_mean": {"prey_policy": -25.56838389727753, "predator_policy": 25.56838389727753}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-43.609720991257426, -20.682036160959495, -17.5206026193765, -12.834111525968646, -30.96318316517064, -20.663298270300345, -30.027319214557146, -28.957151434660023, 0.025080335085858163, -26.559894087947345, -21.07319266376143, -44.934725342234145, -51.21806592888487, -20.860714646396833, -23.129959091325425, -11.862818470213808, -27.319594039501776, -25.182686703076275, -28.754608512601802, -54.280341936164795, -27.50207229799464, -37.749965534777715, -32.412524869551504, -38.304225983514236, -18.168159985655535, -6.285429838567496, -7.000788192628416, -9.658736285175967, -13.065422557922217, -17.80994756924958, -23.85315383860217, -32.84015205602592, -7.316975633396082, -44.43141261407091, -26.59385844208394, -26.26230626971555, -41.35836296284163, -36.07213716639947, -27.582224759731698, -50.87289069393142, -5.053515894306441, -52.70769370097162, -32.763744544970514, -27.27964671295727, -7.582936753359597, -16.29744435130356, -19.18861316540978, -13.844337047950464, -17.102842979030946, -36.216983097718945, -41.45142628449696, -23.293781892489, -15.46996289859717, -31.85288550895892, -33.87280858682232, -7.718187998106092, -37.98533298958364, -16.403987288466112, -22.49117034944364, -31.463358339150112, -11.083953461304947, -7.798499916206144, -39.93262832295289, -23.22091786716155, -9.736846153156147, -29.6684293436966, -23.99297814796962, -21.14998998768789, -24.768757642849817, -24.833325345973588, -32.3743247796403, -26.726681165609484, -17.8675915849858, -22.88948885697551, -16.68422207538675, -19.45560265542364, -15.66144914711986, -29.34714146037229, -40.13093818911391, -33.00097596455997, -18.473171175256986, -2.9681779366529457, -13.912695152095331, -18.93435024655612, -34.20710680346676, -29.795101767730447, -38.31834428017376, -22.793699433307477, -42.40736648334758, -25.2075039009648, -29.821907300462378, -49.12788172174956, -39.340906090870575, -29.511141571472056, -25.284249878775594, -14.344652640053642, -18.22144830652005, -7.683568451239644, -42.88120682073195, -27.688815292976464], "policy_predator_policy_reward": [43.609720991257426, 20.682036160959495, 17.5206026193765, 12.834111525968646, 30.96318316517064, 20.663298270300345, 30.027319214557146, 28.957151434660023, -0.025080335085858163, 26.559894087947345, 21.07319266376143, 44.934725342234145, 51.21806592888487, 20.860714646396833, 23.129959091325425, 11.862818470213808, 27.319594039501776, 25.182686703076275, 28.754608512601802, 54.280341936164795, 27.50207229799464, 37.749965534777715, 32.412524869551504, 38.304225983514236, 18.168159985655535, 6.285429838567496, 7.000788192628416, 9.658736285175967, 13.065422557922217, 17.80994756924958, 23.85315383860217, 32.84015205602592, 7.316975633396082, 44.43141261407091, 26.59385844208394, 26.26230626971555, 41.35836296284163, 36.07213716639947, 27.582224759731698, 50.87289069393142, 5.053515894306441, 52.70769370097162, 32.763744544970514, 27.27964671295727, 7.582936753359597, 16.29744435130356, 19.18861316540978, 13.844337047950464, 17.102842979030946, 36.216983097718945, 41.45142628449696, 23.293781892489, 15.46996289859717, 31.85288550895892, 33.87280858682232, 7.718187998106092, 37.98533298958364, 16.403987288466112, 22.49117034944364, 31.463358339150112, 11.083953461304947, 7.798499916206144, 39.93262832295289, 23.22091786716155, 9.736846153156147, 29.6684293436966, 23.99297814796962, 21.14998998768789, 24.768757642849817, 24.833325345973588, 32.3743247796403, 26.726681165609484, 17.8675915849858, 22.88948885697551, 16.68422207538675, 19.45560265542364, 15.66144914711986, 29.34714146037229, 40.13093818911391, 33.00097596455997, 18.473171175256986, 2.9681779366529457, 13.912695152095331, 18.93435024655612, 34.20710680346676, 29.795101767730447, 38.31834428017376, 22.793699433307477, 42.40736648334758, 25.2075039009648, 29.821907300462378, 49.12788172174956, 39.340906090870575, 29.511141571472056, 25.284249878775594, 14.344652640053642, 18.22144830652005, 7.683568451239644, 42.88120682073195, 27.688815292976464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28824353149419646, "mean_inference_ms": 0.9639687642695699, "mean_action_processing_ms": 0.12839431205437546, "mean_env_wait_ms": 0.0681177804784723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005692958831787109, "StateBufferConnector_ms": 0.0026041269302368164, "ViewRequirementAgentConnector_ms": 0.05769014358520508}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1448000, "num_agent_steps_trained": 1448000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 580.106981456317, "num_env_steps_trained_throughput_per_sec": 580.106981456317, "timesteps_total": 724000, "num_env_steps_sampled_lifetime": 724000, "num_agent_steps_sampled_lifetime": 1448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1448000, "timers": {"training_iteration_time_ms": 6112.371, "restore_workers_time_ms": 0.017, "training_step_time_ms": 6112.306, "sample_time_ms": 802.05, "learn_time_ms": 5294.27, "learn_throughput": 755.534, "synch_weights_time_ms": 15.368}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 1448000, "num_agent_steps_trained": 1448000}, "done": false, "training_iteration": 181, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-14-19", "timestamp": 1723396459, "time_this_iter_s": 6.900867700576782, "time_total_s": 1175.5156099796295, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f65e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1175.5156099796295, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 41.300000000000004, "ram_util_percent": 82.85555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0973376383384068, "cur_kl_coeff": 6.457183323608759e-43, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06527360829847263, "policy_loss": 0.0005643312302709092, "vf_loss": 0.06470927798339593, "vf_explained_var": 0.9970759791632493, "kl": 0.0036312470395161037, "entropy": 0.061969435103431655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 174240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.003351392969489, "cur_kl_coeff": 1.292469707114106e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05515858015011569, "policy_loss": -0.004894134711745816, "vf_loss": 0.060052715063163, "vf_explained_var": 0.9971749626100064, "kl": 0.0033189265562679334, "entropy": 0.23046774707424145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 174240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -54.280341936164795, "predator_policy": -0.025080335085858163}, "policy_reward_max": {"prey_policy": 0.025080335085858163, "predator_policy": 54.280341936164795}, "policy_reward_mean": {"prey_policy": -25.968076540265955, "predator_policy": 25.968076540265955}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-20.663298270300345, -30.027319214557146, -28.957151434660023, 0.025080335085858163, -26.559894087947345, -21.07319266376143, -44.934725342234145, -51.21806592888487, -20.860714646396833, -23.129959091325425, -11.862818470213808, -27.319594039501776, -25.182686703076275, -28.754608512601802, -54.280341936164795, -27.50207229799464, -37.749965534777715, -32.412524869551504, -38.304225983514236, -18.168159985655535, -6.285429838567496, -7.000788192628416, -9.658736285175967, -13.065422557922217, -17.80994756924958, -23.85315383860217, -32.84015205602592, -7.316975633396082, -44.43141261407091, -26.59385844208394, -26.26230626971555, -41.35836296284163, -36.07213716639947, -27.582224759731698, -50.87289069393142, -5.053515894306441, -52.70769370097162, -32.763744544970514, -27.27964671295727, -7.582936753359597, -16.29744435130356, -19.18861316540978, -13.844337047950464, -17.102842979030946, -36.216983097718945, -41.45142628449696, -23.293781892489, -15.46996289859717, -31.85288550895892, -33.87280858682232, -7.718187998106092, -37.98533298958364, -16.403987288466112, -22.49117034944364, -31.463358339150112, -11.083953461304947, -7.798499916206144, -39.93262832295289, -23.22091786716155, -9.736846153156147, -29.6684293436966, -23.99297814796962, -21.14998998768789, -24.768757642849817, -24.833325345973588, -32.3743247796403, -26.726681165609484, -17.8675915849858, -22.88948885697551, -16.68422207538675, -19.45560265542364, -15.66144914711986, -29.34714146037229, -40.13093818911391, -33.00097596455997, -18.473171175256986, -2.9681779366529457, -13.912695152095331, -18.93435024655612, -34.20710680346676, -29.795101767730447, -38.31834428017376, -22.793699433307477, -42.40736648334758, -25.2075039009648, -29.821907300462378, -49.12788172174956, -39.340906090870575, -29.511141571472056, -25.284249878775594, -14.344652640053642, -18.22144830652005, -7.683568451239644, -42.88120682073195, -27.688815292976464, -37.74088473679172, -13.260228601912262, -28.334435707309673, -38.93953737513781, -47.30383234042418], "policy_predator_policy_reward": [20.663298270300345, 30.027319214557146, 28.957151434660023, -0.025080335085858163, 26.559894087947345, 21.07319266376143, 44.934725342234145, 51.21806592888487, 20.860714646396833, 23.129959091325425, 11.862818470213808, 27.319594039501776, 25.182686703076275, 28.754608512601802, 54.280341936164795, 27.50207229799464, 37.749965534777715, 32.412524869551504, 38.304225983514236, 18.168159985655535, 6.285429838567496, 7.000788192628416, 9.658736285175967, 13.065422557922217, 17.80994756924958, 23.85315383860217, 32.84015205602592, 7.316975633396082, 44.43141261407091, 26.59385844208394, 26.26230626971555, 41.35836296284163, 36.07213716639947, 27.582224759731698, 50.87289069393142, 5.053515894306441, 52.70769370097162, 32.763744544970514, 27.27964671295727, 7.582936753359597, 16.29744435130356, 19.18861316540978, 13.844337047950464, 17.102842979030946, 36.216983097718945, 41.45142628449696, 23.293781892489, 15.46996289859717, 31.85288550895892, 33.87280858682232, 7.718187998106092, 37.98533298958364, 16.403987288466112, 22.49117034944364, 31.463358339150112, 11.083953461304947, 7.798499916206144, 39.93262832295289, 23.22091786716155, 9.736846153156147, 29.6684293436966, 23.99297814796962, 21.14998998768789, 24.768757642849817, 24.833325345973588, 32.3743247796403, 26.726681165609484, 17.8675915849858, 22.88948885697551, 16.68422207538675, 19.45560265542364, 15.66144914711986, 29.34714146037229, 40.13093818911391, 33.00097596455997, 18.473171175256986, 2.9681779366529457, 13.912695152095331, 18.93435024655612, 34.20710680346676, 29.795101767730447, 38.31834428017376, 22.793699433307477, 42.40736648334758, 25.2075039009648, 29.821907300462378, 49.12788172174956, 39.340906090870575, 29.511141571472056, 25.284249878775594, 14.344652640053642, 18.22144830652005, 7.683568451239644, 42.88120682073195, 27.688815292976464, 37.74088473679172, 13.260228601912262, 28.334435707309673, 38.93953737513781, 47.30383234042418]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28846290610720027, "mean_inference_ms": 0.9644839169180548, "mean_action_processing_ms": 0.12846507031000884, "mean_env_wait_ms": 0.06815999267645892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005769968032836914, "StateBufferConnector_ms": 0.0026335716247558594, "ViewRequirementAgentConnector_ms": 0.05865371227264404}, "num_episodes": 5, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 651.2469683654172, "num_env_steps_trained_throughput_per_sec": 651.2469683654172, "timesteps_total": 728000, "num_env_steps_sampled_lifetime": 728000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 6166.04, "restore_workers_time_ms": 0.017, "training_step_time_ms": 6165.974, "sample_time_ms": 812.322, "learn_time_ms": 5337.228, "learn_throughput": 749.453, "synch_weights_time_ms": 15.806}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 182, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-14-26", "timestamp": 1723396466, "time_this_iter_s": 6.146309852600098, "time_total_s": 1181.6619198322296, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f65160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1181.6619198322296, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 35.2, "ram_util_percent": 82.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1021237566679096, "cur_kl_coeff": 3.2285916618043794e-43, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.11189229775530597, "policy_loss": -0.004507639225145492, "vf_loss": 0.11639993773569586, "vf_explained_var": 0.9949765610819061, "kl": 0.010494225224870025, "entropy": 0.08677693964758267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 175200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2389189986124014, "cur_kl_coeff": 6.46234853557053e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.11226651673884286, "policy_loss": -0.005675008255396582, "vf_loss": 0.11794152488631274, "vf_explained_var": 0.9948076608280341, "kl": 0.005413631612263595, "entropy": 0.22136998638355485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 175200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -54.280341936164795, "predator_policy": 2.9681779366529457}, "policy_reward_max": {"prey_policy": -2.9681779366529457, "predator_policy": 54.280341936164795}, "policy_reward_mean": {"prey_policy": -25.784255826959804, "predator_policy": 25.784255826959804}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-23.129959091325425, -11.862818470213808, -27.319594039501776, -25.182686703076275, -28.754608512601802, -54.280341936164795, -27.50207229799464, -37.749965534777715, -32.412524869551504, -38.304225983514236, -18.168159985655535, -6.285429838567496, -7.000788192628416, -9.658736285175967, -13.065422557922217, -17.80994756924958, -23.85315383860217, -32.84015205602592, -7.316975633396082, -44.43141261407091, -26.59385844208394, -26.26230626971555, -41.35836296284163, -36.07213716639947, -27.582224759731698, -50.87289069393142, -5.053515894306441, -52.70769370097162, -32.763744544970514, -27.27964671295727, -7.582936753359597, -16.29744435130356, -19.18861316540978, -13.844337047950464, -17.102842979030946, -36.216983097718945, -41.45142628449696, -23.293781892489, -15.46996289859717, -31.85288550895892, -33.87280858682232, -7.718187998106092, -37.98533298958364, -16.403987288466112, -22.49117034944364, -31.463358339150112, -11.083953461304947, -7.798499916206144, -39.93262832295289, -23.22091786716155, -9.736846153156147, -29.6684293436966, -23.99297814796962, -21.14998998768789, -24.768757642849817, -24.833325345973588, -32.3743247796403, -26.726681165609484, -17.8675915849858, -22.88948885697551, -16.68422207538675, -19.45560265542364, -15.66144914711986, -29.34714146037229, -40.13093818911391, -33.00097596455997, -18.473171175256986, -2.9681779366529457, -13.912695152095331, -18.93435024655612, -34.20710680346676, -29.795101767730447, -38.31834428017376, -22.793699433307477, -42.40736648334758, -25.2075039009648, -29.821907300462378, -49.12788172174956, -39.340906090870575, -29.511141571472056, -25.284249878775594, -14.344652640053642, -18.22144830652005, -7.683568451239644, -42.88120682073195, -27.688815292976464, -37.74088473679172, -13.260228601912262, -28.334435707309673, -38.93953737513781, -47.30383234042418, -35.48583825087325, -9.906377826238444, -16.177745832207783, -10.90374949828716, -40.72140448594513, -5.020367624154259, -39.314691076801076, -37.01101216036223, -31.346023168171683], "policy_predator_policy_reward": [23.129959091325425, 11.862818470213808, 27.319594039501776, 25.182686703076275, 28.754608512601802, 54.280341936164795, 27.50207229799464, 37.749965534777715, 32.412524869551504, 38.304225983514236, 18.168159985655535, 6.285429838567496, 7.000788192628416, 9.658736285175967, 13.065422557922217, 17.80994756924958, 23.85315383860217, 32.84015205602592, 7.316975633396082, 44.43141261407091, 26.59385844208394, 26.26230626971555, 41.35836296284163, 36.07213716639947, 27.582224759731698, 50.87289069393142, 5.053515894306441, 52.70769370097162, 32.763744544970514, 27.27964671295727, 7.582936753359597, 16.29744435130356, 19.18861316540978, 13.844337047950464, 17.102842979030946, 36.216983097718945, 41.45142628449696, 23.293781892489, 15.46996289859717, 31.85288550895892, 33.87280858682232, 7.718187998106092, 37.98533298958364, 16.403987288466112, 22.49117034944364, 31.463358339150112, 11.083953461304947, 7.798499916206144, 39.93262832295289, 23.22091786716155, 9.736846153156147, 29.6684293436966, 23.99297814796962, 21.14998998768789, 24.768757642849817, 24.833325345973588, 32.3743247796403, 26.726681165609484, 17.8675915849858, 22.88948885697551, 16.68422207538675, 19.45560265542364, 15.66144914711986, 29.34714146037229, 40.13093818911391, 33.00097596455997, 18.473171175256986, 2.9681779366529457, 13.912695152095331, 18.93435024655612, 34.20710680346676, 29.795101767730447, 38.31834428017376, 22.793699433307477, 42.40736648334758, 25.2075039009648, 29.821907300462378, 49.12788172174956, 39.340906090870575, 29.511141571472056, 25.284249878775594, 14.344652640053642, 18.22144830652005, 7.683568451239644, 42.88120682073195, 27.688815292976464, 37.74088473679172, 13.260228601912262, 28.334435707309673, 38.93953737513781, 47.30383234042418, 35.48583825087325, 9.906377826238444, 16.177745832207783, 10.90374949828716, 40.72140448594513, 5.020367624154259, 39.314691076801076, 37.01101216036223, 31.346023168171683]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28885656060052384, "mean_inference_ms": 0.9653904907183596, "mean_action_processing_ms": 0.12852461580555732, "mean_env_wait_ms": 0.06824571396404404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00567471981048584, "StateBufferConnector_ms": 0.0024651288986206055, "ViewRequirementAgentConnector_ms": 0.05872082710266113}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 683.1135423348029, "num_env_steps_trained_throughput_per_sec": 683.1135423348029, "timesteps_total": 732000, "num_env_steps_sampled_lifetime": 732000, "num_agent_steps_sampled_lifetime": 1464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 6218.613, "restore_workers_time_ms": 0.017, "training_step_time_ms": 6218.547, "sample_time_ms": 821.545, "learn_time_ms": 5380.022, "learn_throughput": 743.491, "synch_weights_time_ms": 16.358}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "training_iteration": 183, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-14-32", "timestamp": 1723396472, "time_this_iter_s": 5.859951019287109, "time_total_s": 1187.5218708515167, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9fbb940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1187.5218708515167, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 31.077777777777776, "ram_util_percent": 82.05555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9275218130865445, "cur_kl_coeff": 3.2285916618043794e-43, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07927839691037661, "policy_loss": -0.002893343283600795, "vf_loss": 0.08217174034119429, "vf_explained_var": 0.9973205131168167, "kl": 0.000981577742493824, "entropy": 0.07983671566471458, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 176160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9822203311603517, "cur_kl_coeff": 6.46234853557053e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08067713408757603, "policy_loss": -0.004240549847114986, "vf_loss": 0.08491768380530024, "vf_explained_var": 0.9972346528122823, "kl": 0.0026319219073191904, "entropy": 0.2103770602804919, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 176160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -52.70769370097162, "predator_policy": 2.9681779366529457}, "policy_reward_max": {"prey_policy": -2.9681779366529457, "predator_policy": 52.70769370097162}, "policy_reward_mean": {"prey_policy": -25.314803790355665, "predator_policy": 25.314803790355665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-38.304225983514236, -18.168159985655535, -6.285429838567496, -7.000788192628416, -9.658736285175967, -13.065422557922217, -17.80994756924958, -23.85315383860217, -32.84015205602592, -7.316975633396082, -44.43141261407091, -26.59385844208394, -26.26230626971555, -41.35836296284163, -36.07213716639947, -27.582224759731698, -50.87289069393142, -5.053515894306441, -52.70769370097162, -32.763744544970514, -27.27964671295727, -7.582936753359597, -16.29744435130356, -19.18861316540978, -13.844337047950464, -17.102842979030946, -36.216983097718945, -41.45142628449696, -23.293781892489, -15.46996289859717, -31.85288550895892, -33.87280858682232, -7.718187998106092, -37.98533298958364, -16.403987288466112, -22.49117034944364, -31.463358339150112, -11.083953461304947, -7.798499916206144, -39.93262832295289, -23.22091786716155, -9.736846153156147, -29.6684293436966, -23.99297814796962, -21.14998998768789, -24.768757642849817, -24.833325345973588, -32.3743247796403, -26.726681165609484, -17.8675915849858, -22.88948885697551, -16.68422207538675, -19.45560265542364, -15.66144914711986, -29.34714146037229, -40.13093818911391, -33.00097596455997, -18.473171175256986, -2.9681779366529457, -13.912695152095331, -18.93435024655612, -34.20710680346676, -29.795101767730447, -38.31834428017376, -22.793699433307477, -42.40736648334758, -25.2075039009648, -29.821907300462378, -49.12788172174956, -39.340906090870575, -29.511141571472056, -25.284249878775594, -14.344652640053642, -18.22144830652005, -7.683568451239644, -42.88120682073195, -27.688815292976464, -37.74088473679172, -13.260228601912262, -28.334435707309673, -38.93953737513781, -47.30383234042418, -35.48583825087325, -9.906377826238444, -16.177745832207783, -10.90374949828716, -40.72140448594513, -5.020367624154259, -39.314691076801076, -37.01101216036223, -31.346023168171683, -31.09043967205028, -29.18650619402467, -20.979924532872218, -18.217744381636116, -17.188332306887823, -22.82800034535335, -32.85606312725322, -17.885233181628433, -31.017124053087542], "policy_predator_policy_reward": [38.304225983514236, 18.168159985655535, 6.285429838567496, 7.000788192628416, 9.658736285175967, 13.065422557922217, 17.80994756924958, 23.85315383860217, 32.84015205602592, 7.316975633396082, 44.43141261407091, 26.59385844208394, 26.26230626971555, 41.35836296284163, 36.07213716639947, 27.582224759731698, 50.87289069393142, 5.053515894306441, 52.70769370097162, 32.763744544970514, 27.27964671295727, 7.582936753359597, 16.29744435130356, 19.18861316540978, 13.844337047950464, 17.102842979030946, 36.216983097718945, 41.45142628449696, 23.293781892489, 15.46996289859717, 31.85288550895892, 33.87280858682232, 7.718187998106092, 37.98533298958364, 16.403987288466112, 22.49117034944364, 31.463358339150112, 11.083953461304947, 7.798499916206144, 39.93262832295289, 23.22091786716155, 9.736846153156147, 29.6684293436966, 23.99297814796962, 21.14998998768789, 24.768757642849817, 24.833325345973588, 32.3743247796403, 26.726681165609484, 17.8675915849858, 22.88948885697551, 16.68422207538675, 19.45560265542364, 15.66144914711986, 29.34714146037229, 40.13093818911391, 33.00097596455997, 18.473171175256986, 2.9681779366529457, 13.912695152095331, 18.93435024655612, 34.20710680346676, 29.795101767730447, 38.31834428017376, 22.793699433307477, 42.40736648334758, 25.2075039009648, 29.821907300462378, 49.12788172174956, 39.340906090870575, 29.511141571472056, 25.284249878775594, 14.344652640053642, 18.22144830652005, 7.683568451239644, 42.88120682073195, 27.688815292976464, 37.74088473679172, 13.260228601912262, 28.334435707309673, 38.93953737513781, 47.30383234042418, 35.48583825087325, 9.906377826238444, 16.177745832207783, 10.90374949828716, 40.72140448594513, 5.020367624154259, 39.314691076801076, 37.01101216036223, 31.346023168171683, 31.09043967205028, 29.18650619402467, 20.979924532872218, 18.217744381636116, 17.188332306887823, 22.82800034535335, 32.85606312725322, 17.885233181628433, 31.017124053087542]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2890708860016964, "mean_inference_ms": 0.9663009609734597, "mean_action_processing_ms": 0.12862182472232012, "mean_env_wait_ms": 0.06832660286516294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005663394927978516, "StateBufferConnector_ms": 0.002435445785522461, "ViewRequirementAgentConnector_ms": 0.05851948261260986}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 638.5731588665981, "num_env_steps_trained_throughput_per_sec": 638.5731588665981, "timesteps_total": 736000, "num_env_steps_sampled_lifetime": 736000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 6301.66, "restore_workers_time_ms": 0.017, "training_step_time_ms": 6301.593, "sample_time_ms": 829.851, "learn_time_ms": 5454.572, "learn_throughput": 733.33, "synch_weights_time_ms": 16.542}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 184, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-14-38", "timestamp": 1723396478, "time_this_iter_s": 6.269769906997681, "time_total_s": 1193.7916407585144, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f2ff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1193.7916407585144, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 34.9375, "ram_util_percent": 82.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0037578410934658, "cur_kl_coeff": 1.6142958309021897e-43, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06396205407266582, "policy_loss": 0.0007621365519298706, "vf_loss": 0.06319991795147265, "vf_explained_var": 0.9976373949398597, "kl": 0.0022240890981554766, "entropy": 0.06892094925569836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 177120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0838225112917523, "cur_kl_coeff": 3.231174267785265e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0669087728706169, "policy_loss": -0.007916149947656473, "vf_loss": 0.07482492250128417, "vf_explained_var": 0.9974743547538917, "kl": 0.0032946616502929726, "entropy": 0.18980922869717082, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 177120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -52.70769370097162, "predator_policy": 2.9681779366529457}, "policy_reward_max": {"prey_policy": -2.9681779366529457, "predator_policy": 52.70769370097162}, "policy_reward_mean": {"prey_policy": -26.1736134269769, "predator_policy": 26.1736134269769}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-7.316975633396082, -44.43141261407091, -26.59385844208394, -26.26230626971555, -41.35836296284163, -36.07213716639947, -27.582224759731698, -50.87289069393142, -5.053515894306441, -52.70769370097162, -32.763744544970514, -27.27964671295727, -7.582936753359597, -16.29744435130356, -19.18861316540978, -13.844337047950464, -17.102842979030946, -36.216983097718945, -41.45142628449696, -23.293781892489, -15.46996289859717, -31.85288550895892, -33.87280858682232, -7.718187998106092, -37.98533298958364, -16.403987288466112, -22.49117034944364, -31.463358339150112, -11.083953461304947, -7.798499916206144, -39.93262832295289, -23.22091786716155, -9.736846153156147, -29.6684293436966, -23.99297814796962, -21.14998998768789, -24.768757642849817, -24.833325345973588, -32.3743247796403, -26.726681165609484, -17.8675915849858, -22.88948885697551, -16.68422207538675, -19.45560265542364, -15.66144914711986, -29.34714146037229, -40.13093818911391, -33.00097596455997, -18.473171175256986, -2.9681779366529457, -13.912695152095331, -18.93435024655612, -34.20710680346676, -29.795101767730447, -38.31834428017376, -22.793699433307477, -42.40736648334758, -25.2075039009648, -29.821907300462378, -49.12788172174956, -39.340906090870575, -29.511141571472056, -25.284249878775594, -14.344652640053642, -18.22144830652005, -7.683568451239644, -42.88120682073195, -27.688815292976464, -37.74088473679172, -13.260228601912262, -28.334435707309673, -38.93953737513781, -47.30383234042418, -35.48583825087325, -9.906377826238444, -16.177745832207783, -10.90374949828716, -40.72140448594513, -5.020367624154259, -39.314691076801076, -37.01101216036223, -31.346023168171683, -31.09043967205028, -29.18650619402467, -20.979924532872218, -18.217744381636116, -17.188332306887823, -22.82800034535335, -32.85606312725322, -17.885233181628433, -31.017124053087542, -37.6086635592157, -42.0368846764175, -44.20847222676504, -24.123747747019166, -37.16747406054673, -4.820446458288689, -19.39962598301212, -24.036651517904833, -19.465013740295458], "policy_predator_policy_reward": [7.316975633396082, 44.43141261407091, 26.59385844208394, 26.26230626971555, 41.35836296284163, 36.07213716639947, 27.582224759731698, 50.87289069393142, 5.053515894306441, 52.70769370097162, 32.763744544970514, 27.27964671295727, 7.582936753359597, 16.29744435130356, 19.18861316540978, 13.844337047950464, 17.102842979030946, 36.216983097718945, 41.45142628449696, 23.293781892489, 15.46996289859717, 31.85288550895892, 33.87280858682232, 7.718187998106092, 37.98533298958364, 16.403987288466112, 22.49117034944364, 31.463358339150112, 11.083953461304947, 7.798499916206144, 39.93262832295289, 23.22091786716155, 9.736846153156147, 29.6684293436966, 23.99297814796962, 21.14998998768789, 24.768757642849817, 24.833325345973588, 32.3743247796403, 26.726681165609484, 17.8675915849858, 22.88948885697551, 16.68422207538675, 19.45560265542364, 15.66144914711986, 29.34714146037229, 40.13093818911391, 33.00097596455997, 18.473171175256986, 2.9681779366529457, 13.912695152095331, 18.93435024655612, 34.20710680346676, 29.795101767730447, 38.31834428017376, 22.793699433307477, 42.40736648334758, 25.2075039009648, 29.821907300462378, 49.12788172174956, 39.340906090870575, 29.511141571472056, 25.284249878775594, 14.344652640053642, 18.22144830652005, 7.683568451239644, 42.88120682073195, 27.688815292976464, 37.74088473679172, 13.260228601912262, 28.334435707309673, 38.93953737513781, 47.30383234042418, 35.48583825087325, 9.906377826238444, 16.177745832207783, 10.90374949828716, 40.72140448594513, 5.020367624154259, 39.314691076801076, 37.01101216036223, 31.346023168171683, 31.09043967205028, 29.18650619402467, 20.979924532872218, 18.217744381636116, 17.188332306887823, 22.82800034535335, 32.85606312725322, 17.885233181628433, 31.017124053087542, 37.6086635592157, 42.0368846764175, 44.20847222676504, 24.123747747019166, 37.16747406054673, 4.820446458288689, 19.39962598301212, 24.036651517904833, 19.465013740295458]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28912041300581454, "mean_inference_ms": 0.9672966782800704, "mean_action_processing_ms": 0.1287675403599062, "mean_env_wait_ms": 0.06840882926327907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005710959434509277, "StateBufferConnector_ms": 0.0025053024291992188, "ViewRequirementAgentConnector_ms": 0.05921947956085205}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 642.9156394947071, "num_env_steps_trained_throughput_per_sec": 642.9156394947071, "timesteps_total": 740000, "num_env_steps_sampled_lifetime": 740000, "num_agent_steps_sampled_lifetime": 1480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1480000, "timers": {"training_iteration_time_ms": 6296.641, "restore_workers_time_ms": 0.018, "training_step_time_ms": 6296.593, "sample_time_ms": 846.798, "learn_time_ms": 5433.721, "learn_throughput": 736.144, "synch_weights_time_ms": 15.708}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "done": false, "training_iteration": 185, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-14-44", "timestamp": 1723396484, "time_this_iter_s": 6.230432987213135, "time_total_s": 1200.0220737457275, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f65e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1200.0220737457275, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 33.644444444444446, "ram_util_percent": 82.7888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8839382175977032, "cur_kl_coeff": 8.071479154510949e-44, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07378911548803443, "policy_loss": 0.00010378371831999781, "vf_loss": 0.07368533334423168, "vf_explained_var": 0.995394679531455, "kl": 0.0011131874290576545, "entropy": 0.06200938013595684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 178080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.020284920092672, "cur_kl_coeff": 1.6155871338926325e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07205892963174847, "policy_loss": -0.0024806095146535276, "vf_loss": 0.07453953940033292, "vf_explained_var": 0.9950844708209237, "kl": 0.0030290257457702696, "entropy": 0.1822752684354782, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 178080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -52.70769370097162, "predator_policy": 2.9681779366529457}, "policy_reward_max": {"prey_policy": -2.9681779366529457, "predator_policy": 52.70769370097162}, "policy_reward_mean": {"prey_policy": -26.199623084015094, "predator_policy": 26.199623084015094}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-52.70769370097162, -32.763744544970514, -27.27964671295727, -7.582936753359597, -16.29744435130356, -19.18861316540978, -13.844337047950464, -17.102842979030946, -36.216983097718945, -41.45142628449696, -23.293781892489, -15.46996289859717, -31.85288550895892, -33.87280858682232, -7.718187998106092, -37.98533298958364, -16.403987288466112, -22.49117034944364, -31.463358339150112, -11.083953461304947, -7.798499916206144, -39.93262832295289, -23.22091786716155, -9.736846153156147, -29.6684293436966, -23.99297814796962, -21.14998998768789, -24.768757642849817, -24.833325345973588, -32.3743247796403, -26.726681165609484, -17.8675915849858, -22.88948885697551, -16.68422207538675, -19.45560265542364, -15.66144914711986, -29.34714146037229, -40.13093818911391, -33.00097596455997, -18.473171175256986, -2.9681779366529457, -13.912695152095331, -18.93435024655612, -34.20710680346676, -29.795101767730447, -38.31834428017376, -22.793699433307477, -42.40736648334758, -25.2075039009648, -29.821907300462378, -49.12788172174956, -39.340906090870575, -29.511141571472056, -25.284249878775594, -14.344652640053642, -18.22144830652005, -7.683568451239644, -42.88120682073195, -27.688815292976464, -37.74088473679172, -13.260228601912262, -28.334435707309673, -38.93953737513781, -47.30383234042418, -35.48583825087325, -9.906377826238444, -16.177745832207783, -10.90374949828716, -40.72140448594513, -5.020367624154259, -39.314691076801076, -37.01101216036223, -31.346023168171683, -31.09043967205028, -29.18650619402467, -20.979924532872218, -18.217744381636116, -17.188332306887823, -22.82800034535335, -32.85606312725322, -17.885233181628433, -31.017124053087542, -37.6086635592157, -42.0368846764175, -44.20847222676504, -24.123747747019166, -37.16747406054673, -4.820446458288689, -19.39962598301212, -24.036651517904833, -19.465013740295458, -30.254068596011074, -25.71114787337298, -45.86501506309621, -35.68878414320191, -43.82242796993293, -23.04741833825235, -8.275045518377986, -39.16907276915681, -16.31166986889357], "policy_predator_policy_reward": [52.70769370097162, 32.763744544970514, 27.27964671295727, 7.582936753359597, 16.29744435130356, 19.18861316540978, 13.844337047950464, 17.102842979030946, 36.216983097718945, 41.45142628449696, 23.293781892489, 15.46996289859717, 31.85288550895892, 33.87280858682232, 7.718187998106092, 37.98533298958364, 16.403987288466112, 22.49117034944364, 31.463358339150112, 11.083953461304947, 7.798499916206144, 39.93262832295289, 23.22091786716155, 9.736846153156147, 29.6684293436966, 23.99297814796962, 21.14998998768789, 24.768757642849817, 24.833325345973588, 32.3743247796403, 26.726681165609484, 17.8675915849858, 22.88948885697551, 16.68422207538675, 19.45560265542364, 15.66144914711986, 29.34714146037229, 40.13093818911391, 33.00097596455997, 18.473171175256986, 2.9681779366529457, 13.912695152095331, 18.93435024655612, 34.20710680346676, 29.795101767730447, 38.31834428017376, 22.793699433307477, 42.40736648334758, 25.2075039009648, 29.821907300462378, 49.12788172174956, 39.340906090870575, 29.511141571472056, 25.284249878775594, 14.344652640053642, 18.22144830652005, 7.683568451239644, 42.88120682073195, 27.688815292976464, 37.74088473679172, 13.260228601912262, 28.334435707309673, 38.93953737513781, 47.30383234042418, 35.48583825087325, 9.906377826238444, 16.177745832207783, 10.90374949828716, 40.72140448594513, 5.020367624154259, 39.314691076801076, 37.01101216036223, 31.346023168171683, 31.09043967205028, 29.18650619402467, 20.979924532872218, 18.217744381636116, 17.188332306887823, 22.82800034535335, 32.85606312725322, 17.885233181628433, 31.017124053087542, 37.6086635592157, 42.0368846764175, 44.20847222676504, 24.123747747019166, 37.16747406054673, 4.820446458288689, 19.39962598301212, 24.036651517904833, 19.465013740295458, 30.254068596011074, 25.71114787337298, 45.86501506309621, 35.68878414320191, 43.82242796993293, 23.04741833825235, 8.275045518377986, 39.16907276915681, 16.31166986889357]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2893940876432261, "mean_inference_ms": 0.9684324235966888, "mean_action_processing_ms": 0.12889452332162885, "mean_env_wait_ms": 0.06850803750460745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057337284088134766, "StateBufferConnector_ms": 0.002513408660888672, "ViewRequirementAgentConnector_ms": 0.05949974060058594}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 674.4964388276754, "num_env_steps_trained_throughput_per_sec": 674.4964388276754, "timesteps_total": 744000, "num_env_steps_sampled_lifetime": 744000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 6279.061, "restore_workers_time_ms": 0.017, "training_step_time_ms": 6279.015, "sample_time_ms": 824.012, "learn_time_ms": 5439.023, "learn_throughput": 735.426, "synch_weights_time_ms": 15.553}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 186, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-14-50", "timestamp": 1723396490, "time_this_iter_s": 5.935000896453857, "time_total_s": 1205.9570746421814, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9fbb940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1205.9570746421814, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 31.61111111111111, "ram_util_percent": 81.97777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9387788373356064, "cur_kl_coeff": 4.0357395772554743e-44, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.053629045594425405, "policy_loss": -0.0013074587087127535, "vf_loss": 0.05493650438972206, "vf_explained_var": 0.9967835590864221, "kl": 0.001664645939159557, "entropy": 0.0649797883903375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 179040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8358869713265449, "cur_kl_coeff": 8.077935669463162e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03842789313445489, "policy_loss": -0.013303201033219617, "vf_loss": 0.05173109448927183, "vf_explained_var": 0.9967557259524862, "kl": 0.007160985784613505, "entropy": 0.20023404574021697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 179040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 1496000, "num_agent_steps_trained": 1496000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.12788172174956, "predator_policy": 2.9681779366529457}, "policy_reward_max": {"prey_policy": -2.9681779366529457, "predator_policy": 49.12788172174956}, "policy_reward_mean": {"prey_policy": -25.907092050557306, "predator_policy": 25.907092050557306}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-41.45142628449696, -23.293781892489, -15.46996289859717, -31.85288550895892, -33.87280858682232, -7.718187998106092, -37.98533298958364, -16.403987288466112, -22.49117034944364, -31.463358339150112, -11.083953461304947, -7.798499916206144, -39.93262832295289, -23.22091786716155, -9.736846153156147, -29.6684293436966, -23.99297814796962, -21.14998998768789, -24.768757642849817, -24.833325345973588, -32.3743247796403, -26.726681165609484, -17.8675915849858, -22.88948885697551, -16.68422207538675, -19.45560265542364, -15.66144914711986, -29.34714146037229, -40.13093818911391, -33.00097596455997, -18.473171175256986, -2.9681779366529457, -13.912695152095331, -18.93435024655612, -34.20710680346676, -29.795101767730447, -38.31834428017376, -22.793699433307477, -42.40736648334758, -25.2075039009648, -29.821907300462378, -49.12788172174956, -39.340906090870575, -29.511141571472056, -25.284249878775594, -14.344652640053642, -18.22144830652005, -7.683568451239644, -42.88120682073195, -27.688815292976464, -37.74088473679172, -13.260228601912262, -28.334435707309673, -38.93953737513781, -47.30383234042418, -35.48583825087325, -9.906377826238444, -16.177745832207783, -10.90374949828716, -40.72140448594513, -5.020367624154259, -39.314691076801076, -37.01101216036223, -31.346023168171683, -31.09043967205028, -29.18650619402467, -20.979924532872218, -18.217744381636116, -17.188332306887823, -22.82800034535335, -32.85606312725322, -17.885233181628433, -31.017124053087542, -37.6086635592157, -42.0368846764175, -44.20847222676504, -24.123747747019166, -37.16747406054673, -4.820446458288689, -19.39962598301212, -24.036651517904833, -19.465013740295458, -30.254068596011074, -25.71114787337298, -45.86501506309621, -35.68878414320191, -43.82242796993293, -23.04741833825235, -8.275045518377986, -39.16907276915681, -16.31166986889357, -20.06431540077004, -24.911697782523092, -13.028890922570913, -24.48308062862095, -12.03291399863243, -10.244437163975048, -29.797956074113934, -39.91337452204493, -19.254472514643187], "policy_predator_policy_reward": [41.45142628449696, 23.293781892489, 15.46996289859717, 31.85288550895892, 33.87280858682232, 7.718187998106092, 37.98533298958364, 16.403987288466112, 22.49117034944364, 31.463358339150112, 11.083953461304947, 7.798499916206144, 39.93262832295289, 23.22091786716155, 9.736846153156147, 29.6684293436966, 23.99297814796962, 21.14998998768789, 24.768757642849817, 24.833325345973588, 32.3743247796403, 26.726681165609484, 17.8675915849858, 22.88948885697551, 16.68422207538675, 19.45560265542364, 15.66144914711986, 29.34714146037229, 40.13093818911391, 33.00097596455997, 18.473171175256986, 2.9681779366529457, 13.912695152095331, 18.93435024655612, 34.20710680346676, 29.795101767730447, 38.31834428017376, 22.793699433307477, 42.40736648334758, 25.2075039009648, 29.821907300462378, 49.12788172174956, 39.340906090870575, 29.511141571472056, 25.284249878775594, 14.344652640053642, 18.22144830652005, 7.683568451239644, 42.88120682073195, 27.688815292976464, 37.74088473679172, 13.260228601912262, 28.334435707309673, 38.93953737513781, 47.30383234042418, 35.48583825087325, 9.906377826238444, 16.177745832207783, 10.90374949828716, 40.72140448594513, 5.020367624154259, 39.314691076801076, 37.01101216036223, 31.346023168171683, 31.09043967205028, 29.18650619402467, 20.979924532872218, 18.217744381636116, 17.188332306887823, 22.82800034535335, 32.85606312725322, 17.885233181628433, 31.017124053087542, 37.6086635592157, 42.0368846764175, 44.20847222676504, 24.123747747019166, 37.16747406054673, 4.820446458288689, 19.39962598301212, 24.036651517904833, 19.465013740295458, 30.254068596011074, 25.71114787337298, 45.86501506309621, 35.68878414320191, 43.82242796993293, 23.04741833825235, 8.275045518377986, 39.16907276915681, 16.31166986889357, 20.06431540077004, 24.911697782523092, 13.028890922570913, 24.48308062862095, 12.03291399863243, 10.244437163975048, 29.797956074113934, 39.91337452204493, 19.254472514643187]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2896898182698455, "mean_inference_ms": 0.969639212816768, "mean_action_processing_ms": 0.1290311073893754, "mean_env_wait_ms": 0.06861246875977547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057506561279296875, "StateBufferConnector_ms": 0.0025429725646972656, "ViewRequirementAgentConnector_ms": 0.060466885566711426}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1496000, "num_agent_steps_trained": 1496000, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 660.353588678575, "num_env_steps_trained_throughput_per_sec": 660.353588678575, "timesteps_total": 748000, "num_env_steps_sampled_lifetime": 748000, "num_agent_steps_sampled_lifetime": 1496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1496000, "timers": {"training_iteration_time_ms": 6291.825, "restore_workers_time_ms": 0.018, "training_step_time_ms": 6291.777, "sample_time_ms": 831.736, "learn_time_ms": 5444.158, "learn_throughput": 734.733, "synch_weights_time_ms": 15.456}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 1496000, "num_agent_steps_trained": 1496000}, "done": false, "training_iteration": 187, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-14-56", "timestamp": 1723396496, "time_this_iter_s": 6.06233286857605, "time_total_s": 1212.0194075107574, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9ed9700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1212.0194075107574, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 36.3, "ram_util_percent": 81.1875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.147601817160224, "cur_kl_coeff": 2.0178697886277371e-44, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05486097561515635, "policy_loss": 0.0005310801214363891, "vf_loss": 0.054329895211655335, "vf_explained_var": 0.9971573545287052, "kl": 0.003181651677740529, "entropy": 0.09449246604635846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9655689728135864, "cur_kl_coeff": 8.077935669463162e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.037450462491445555, "policy_loss": -0.014079739902323732, "vf_loss": 0.05153020234380771, "vf_explained_var": 0.9974597233658036, "kl": 0.007822041266354678, "entropy": 0.2417718555467824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.12788172174956, "predator_policy": 2.9681779366529457}, "policy_reward_max": {"prey_policy": -2.9681779366529457, "predator_policy": 49.12788172174956}, "policy_reward_mean": {"prey_policy": -25.715892352279692, "predator_policy": 25.715892352279692}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-33.87280858682232, -7.718187998106092, -37.98533298958364, -16.403987288466112, -22.49117034944364, -31.463358339150112, -11.083953461304947, -7.798499916206144, -39.93262832295289, -23.22091786716155, -9.736846153156147, -29.6684293436966, -23.99297814796962, -21.14998998768789, -24.768757642849817, -24.833325345973588, -32.3743247796403, -26.726681165609484, -17.8675915849858, -22.88948885697551, -16.68422207538675, -19.45560265542364, -15.66144914711986, -29.34714146037229, -40.13093818911391, -33.00097596455997, -18.473171175256986, -2.9681779366529457, -13.912695152095331, -18.93435024655612, -34.20710680346676, -29.795101767730447, -38.31834428017376, -22.793699433307477, -42.40736648334758, -25.2075039009648, -29.821907300462378, -49.12788172174956, -39.340906090870575, -29.511141571472056, -25.284249878775594, -14.344652640053642, -18.22144830652005, -7.683568451239644, -42.88120682073195, -27.688815292976464, -37.74088473679172, -13.260228601912262, -28.334435707309673, -38.93953737513781, -47.30383234042418, -35.48583825087325, -9.906377826238444, -16.177745832207783, -10.90374949828716, -40.72140448594513, -5.020367624154259, -39.314691076801076, -37.01101216036223, -31.346023168171683, -31.09043967205028, -29.18650619402467, -20.979924532872218, -18.217744381636116, -17.188332306887823, -22.82800034535335, -32.85606312725322, -17.885233181628433, -31.017124053087542, -37.6086635592157, -42.0368846764175, -44.20847222676504, -24.123747747019166, -37.16747406054673, -4.820446458288689, -19.39962598301212, -24.036651517904833, -19.465013740295458, -30.254068596011074, -25.71114787337298, -45.86501506309621, -35.68878414320191, -43.82242796993293, -23.04741833825235, -8.275045518377986, -39.16907276915681, -16.31166986889357, -20.06431540077004, -24.911697782523092, -13.028890922570913, -24.48308062862095, -12.03291399863243, -10.244437163975048, -29.797956074113934, -39.91337452204493, -19.254472514643187, -27.26417070355789, -16.67997732041417, -28.91602168630235, -20.087917046506504], "policy_predator_policy_reward": [33.87280858682232, 7.718187998106092, 37.98533298958364, 16.403987288466112, 22.49117034944364, 31.463358339150112, 11.083953461304947, 7.798499916206144, 39.93262832295289, 23.22091786716155, 9.736846153156147, 29.6684293436966, 23.99297814796962, 21.14998998768789, 24.768757642849817, 24.833325345973588, 32.3743247796403, 26.726681165609484, 17.8675915849858, 22.88948885697551, 16.68422207538675, 19.45560265542364, 15.66144914711986, 29.34714146037229, 40.13093818911391, 33.00097596455997, 18.473171175256986, 2.9681779366529457, 13.912695152095331, 18.93435024655612, 34.20710680346676, 29.795101767730447, 38.31834428017376, 22.793699433307477, 42.40736648334758, 25.2075039009648, 29.821907300462378, 49.12788172174956, 39.340906090870575, 29.511141571472056, 25.284249878775594, 14.344652640053642, 18.22144830652005, 7.683568451239644, 42.88120682073195, 27.688815292976464, 37.74088473679172, 13.260228601912262, 28.334435707309673, 38.93953737513781, 47.30383234042418, 35.48583825087325, 9.906377826238444, 16.177745832207783, 10.90374949828716, 40.72140448594513, 5.020367624154259, 39.314691076801076, 37.01101216036223, 31.346023168171683, 31.09043967205028, 29.18650619402467, 20.979924532872218, 18.217744381636116, 17.188332306887823, 22.82800034535335, 32.85606312725322, 17.885233181628433, 31.017124053087542, 37.6086635592157, 42.0368846764175, 44.20847222676504, 24.123747747019166, 37.16747406054673, 4.820446458288689, 19.39962598301212, 24.036651517904833, 19.465013740295458, 30.254068596011074, 25.71114787337298, 45.86501506309621, 35.68878414320191, 43.82242796993293, 23.04741833825235, 8.275045518377986, 39.16907276915681, 16.31166986889357, 20.06431540077004, 24.911697782523092, 13.028890922570913, 24.48308062862095, 12.03291399863243, 10.244437163975048, 29.797956074113934, 39.91337452204493, 19.254472514643187, 27.26417070355789, 16.67997732041417, 28.91602168630235, 20.087917046506504]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2897030728885451, "mean_inference_ms": 0.9700828091407818, "mean_action_processing_ms": 0.12906542457727965, "mean_env_wait_ms": 0.0686522509765845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005784392356872559, "StateBufferConnector_ms": 0.002587437629699707, "ViewRequirementAgentConnector_ms": 0.060935139656066895}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 658.0475845783433, "num_env_steps_trained_throughput_per_sec": 658.0475845783433, "timesteps_total": 752000, "num_env_steps_sampled_lifetime": 752000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 6304.802, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6304.76, "sample_time_ms": 820.071, "learn_time_ms": 5469.014, "learn_throughput": 731.393, "synch_weights_time_ms": 15.146}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 188, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-15-02", "timestamp": 1723396502, "time_this_iter_s": 6.08345890045166, "time_total_s": 1218.102866411209, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a787aee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1218.102866411209, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 34.87777777777777, "ram_util_percent": 81.00000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1616296633301924, "cur_kl_coeff": 1.0089348943138686e-44, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.16518222225495266, "policy_loss": -0.0009228654220351018, "vf_loss": 0.16610508835001384, "vf_explained_var": 0.9935521091644962, "kl": 0.0017949310740000223, "entropy": 0.08024375493017336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2252081631993255, "cur_kl_coeff": 8.077935669463162e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1412235258181075, "policy_loss": -0.009913063431667979, "vf_loss": 0.1511365898671405, "vf_explained_var": 0.994245132120947, "kl": 0.007867213317076006, "entropy": 0.25880500858960054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.12788172174956, "predator_policy": 2.9681779366529457}, "policy_reward_max": {"prey_policy": -2.9681779366529457, "predator_policy": 49.12788172174956}, "policy_reward_mean": {"prey_policy": -26.073031995564815, "predator_policy": 26.073031995564815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-23.22091786716155, -9.736846153156147, -29.6684293436966, -23.99297814796962, -21.14998998768789, -24.768757642849817, -24.833325345973588, -32.3743247796403, -26.726681165609484, -17.8675915849858, -22.88948885697551, -16.68422207538675, -19.45560265542364, -15.66144914711986, -29.34714146037229, -40.13093818911391, -33.00097596455997, -18.473171175256986, -2.9681779366529457, -13.912695152095331, -18.93435024655612, -34.20710680346676, -29.795101767730447, -38.31834428017376, -22.793699433307477, -42.40736648334758, -25.2075039009648, -29.821907300462378, -49.12788172174956, -39.340906090870575, -29.511141571472056, -25.284249878775594, -14.344652640053642, -18.22144830652005, -7.683568451239644, -42.88120682073195, -27.688815292976464, -37.74088473679172, -13.260228601912262, -28.334435707309673, -38.93953737513781, -47.30383234042418, -35.48583825087325, -9.906377826238444, -16.177745832207783, -10.90374949828716, -40.72140448594513, -5.020367624154259, -39.314691076801076, -37.01101216036223, -31.346023168171683, -31.09043967205028, -29.18650619402467, -20.979924532872218, -18.217744381636116, -17.188332306887823, -22.82800034535335, -32.85606312725322, -17.885233181628433, -31.017124053087542, -37.6086635592157, -42.0368846764175, -44.20847222676504, -24.123747747019166, -37.16747406054673, -4.820446458288689, -19.39962598301212, -24.036651517904833, -19.465013740295458, -30.254068596011074, -25.71114787337298, -45.86501506309621, -35.68878414320191, -43.82242796993293, -23.04741833825235, -8.275045518377986, -39.16907276915681, -16.31166986889357, -20.06431540077004, -24.911697782523092, -13.028890922570913, -24.48308062862095, -12.03291399863243, -10.244437163975048, -29.797956074113934, -39.91337452204493, -19.254472514643187, -27.26417070355789, -16.67997732041417, -28.91602168630235, -20.087917046506504, -34.94920677792449, -31.63760072911613, -32.53782761776712, -29.414231083925696, -8.845080513189178, -30.446188643393636, -11.092714702808001, -25.86854511794859, -39.672496394474884], "policy_predator_policy_reward": [23.22091786716155, 9.736846153156147, 29.6684293436966, 23.99297814796962, 21.14998998768789, 24.768757642849817, 24.833325345973588, 32.3743247796403, 26.726681165609484, 17.8675915849858, 22.88948885697551, 16.68422207538675, 19.45560265542364, 15.66144914711986, 29.34714146037229, 40.13093818911391, 33.00097596455997, 18.473171175256986, 2.9681779366529457, 13.912695152095331, 18.93435024655612, 34.20710680346676, 29.795101767730447, 38.31834428017376, 22.793699433307477, 42.40736648334758, 25.2075039009648, 29.821907300462378, 49.12788172174956, 39.340906090870575, 29.511141571472056, 25.284249878775594, 14.344652640053642, 18.22144830652005, 7.683568451239644, 42.88120682073195, 27.688815292976464, 37.74088473679172, 13.260228601912262, 28.334435707309673, 38.93953737513781, 47.30383234042418, 35.48583825087325, 9.906377826238444, 16.177745832207783, 10.90374949828716, 40.72140448594513, 5.020367624154259, 39.314691076801076, 37.01101216036223, 31.346023168171683, 31.09043967205028, 29.18650619402467, 20.979924532872218, 18.217744381636116, 17.188332306887823, 22.82800034535335, 32.85606312725322, 17.885233181628433, 31.017124053087542, 37.6086635592157, 42.0368846764175, 44.20847222676504, 24.123747747019166, 37.16747406054673, 4.820446458288689, 19.39962598301212, 24.036651517904833, 19.465013740295458, 30.254068596011074, 25.71114787337298, 45.86501506309621, 35.68878414320191, 43.82242796993293, 23.04741833825235, 8.275045518377986, 39.16907276915681, 16.31166986889357, 20.06431540077004, 24.911697782523092, 13.028890922570913, 24.48308062862095, 12.03291399863243, 10.244437163975048, 29.797956074113934, 39.91337452204493, 19.254472514643187, 27.26417070355789, 16.67997732041417, 28.91602168630235, 20.087917046506504, 34.94920677792449, 31.63760072911613, 32.53782761776712, 29.414231083925696, 8.845080513189178, 30.446188643393636, 11.092714702808001, 25.86854511794859, 39.672496394474884]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28998541876894574, "mean_inference_ms": 0.9711075736966589, "mean_action_processing_ms": 0.12918329607983303, "mean_env_wait_ms": 0.0687430018570464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005670785903930664, "StateBufferConnector_ms": 0.0025098323822021484, "ViewRequirementAgentConnector_ms": 0.060370564460754395}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 633.9588373789743, "num_env_steps_trained_throughput_per_sec": 633.9588373789743, "timesteps_total": 756000, "num_env_steps_sampled_lifetime": 756000, "num_agent_steps_sampled_lifetime": 1512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 6233.528, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6233.486, "sample_time_ms": 829.833, "learn_time_ms": 5388.948, "learn_throughput": 742.26, "synch_weights_time_ms": 14.196}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": false, "training_iteration": 189, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-15-09", "timestamp": 1723396509, "time_this_iter_s": 6.315938949584961, "time_total_s": 1224.418805360794, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9ed9f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1224.418805360794, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 36.044444444444444, "ram_util_percent": 80.96666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8718397585054238, "cur_kl_coeff": 5.044674471569343e-45, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07823709708415359, "policy_loss": -0.0019788411397409313, "vf_loss": 0.08021593828646777, "vf_explained_var": 0.9952634982143839, "kl": 0.0022975522212176284, "entropy": 0.05999805098205494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 181920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.11884006850111, "cur_kl_coeff": 8.077935669463162e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06309601445997638, "policy_loss": -0.008821679359486249, "vf_loss": 0.0719176931088441, "vf_explained_var": 0.9960657954836886, "kl": 0.00418674786713249, "entropy": 0.2424294577135394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 181920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.12788172174956, "predator_policy": 2.9681779366529457}, "policy_reward_max": {"prey_policy": -2.9681779366529457, "predator_policy": 49.12788172174956}, "policy_reward_mean": {"prey_policy": -26.536520330464437, "predator_policy": 26.536520330464437}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-17.8675915849858, -22.88948885697551, -16.68422207538675, -19.45560265542364, -15.66144914711986, -29.34714146037229, -40.13093818911391, -33.00097596455997, -18.473171175256986, -2.9681779366529457, -13.912695152095331, -18.93435024655612, -34.20710680346676, -29.795101767730447, -38.31834428017376, -22.793699433307477, -42.40736648334758, -25.2075039009648, -29.821907300462378, -49.12788172174956, -39.340906090870575, -29.511141571472056, -25.284249878775594, -14.344652640053642, -18.22144830652005, -7.683568451239644, -42.88120682073195, -27.688815292976464, -37.74088473679172, -13.260228601912262, -28.334435707309673, -38.93953737513781, -47.30383234042418, -35.48583825087325, -9.906377826238444, -16.177745832207783, -10.90374949828716, -40.72140448594513, -5.020367624154259, -39.314691076801076, -37.01101216036223, -31.346023168171683, -31.09043967205028, -29.18650619402467, -20.979924532872218, -18.217744381636116, -17.188332306887823, -22.82800034535335, -32.85606312725322, -17.885233181628433, -31.017124053087542, -37.6086635592157, -42.0368846764175, -44.20847222676504, -24.123747747019166, -37.16747406054673, -4.820446458288689, -19.39962598301212, -24.036651517904833, -19.465013740295458, -30.254068596011074, -25.71114787337298, -45.86501506309621, -35.68878414320191, -43.82242796993293, -23.04741833825235, -8.275045518377986, -39.16907276915681, -16.31166986889357, -20.06431540077004, -24.911697782523092, -13.028890922570913, -24.48308062862095, -12.03291399863243, -10.244437163975048, -29.797956074113934, -39.91337452204493, -19.254472514643187, -27.26417070355789, -16.67997732041417, -28.91602168630235, -20.087917046506504, -34.94920677792449, -31.63760072911613, -32.53782761776712, -29.414231083925696, -8.845080513189178, -30.446188643393636, -11.092714702808001, -25.86854511794859, -39.672496394474884, -40.435481457923245, -40.81942268015289, -25.76677234597746, -16.87653779146455, -25.81301714373688, -42.10358943495124, -23.965763717523757, -20.302041688107277, -26.738457663870204], "policy_predator_policy_reward": [17.8675915849858, 22.88948885697551, 16.68422207538675, 19.45560265542364, 15.66144914711986, 29.34714146037229, 40.13093818911391, 33.00097596455997, 18.473171175256986, 2.9681779366529457, 13.912695152095331, 18.93435024655612, 34.20710680346676, 29.795101767730447, 38.31834428017376, 22.793699433307477, 42.40736648334758, 25.2075039009648, 29.821907300462378, 49.12788172174956, 39.340906090870575, 29.511141571472056, 25.284249878775594, 14.344652640053642, 18.22144830652005, 7.683568451239644, 42.88120682073195, 27.688815292976464, 37.74088473679172, 13.260228601912262, 28.334435707309673, 38.93953737513781, 47.30383234042418, 35.48583825087325, 9.906377826238444, 16.177745832207783, 10.90374949828716, 40.72140448594513, 5.020367624154259, 39.314691076801076, 37.01101216036223, 31.346023168171683, 31.09043967205028, 29.18650619402467, 20.979924532872218, 18.217744381636116, 17.188332306887823, 22.82800034535335, 32.85606312725322, 17.885233181628433, 31.017124053087542, 37.6086635592157, 42.0368846764175, 44.20847222676504, 24.123747747019166, 37.16747406054673, 4.820446458288689, 19.39962598301212, 24.036651517904833, 19.465013740295458, 30.254068596011074, 25.71114787337298, 45.86501506309621, 35.68878414320191, 43.82242796993293, 23.04741833825235, 8.275045518377986, 39.16907276915681, 16.31166986889357, 20.06431540077004, 24.911697782523092, 13.028890922570913, 24.48308062862095, 12.03291399863243, 10.244437163975048, 29.797956074113934, 39.91337452204493, 19.254472514643187, 27.26417070355789, 16.67997732041417, 28.91602168630235, 20.087917046506504, 34.94920677792449, 31.63760072911613, 32.53782761776712, 29.414231083925696, 8.845080513189178, 30.446188643393636, 11.092714702808001, 25.86854511794859, 39.672496394474884, 40.435481457923245, 40.81942268015289, 25.76677234597746, 16.87653779146455, 25.81301714373688, 42.10358943495124, 23.965763717523757, 20.302041688107277, 26.738457663870204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2902677708591027, "mean_inference_ms": 0.9721345519500563, "mean_action_processing_ms": 0.12929980159406068, "mean_env_wait_ms": 0.06883280545897082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005679726600646973, "StateBufferConnector_ms": 0.002485036849975586, "ViewRequirementAgentConnector_ms": 0.060686707496643066}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 653.3898000455112, "num_env_steps_trained_throughput_per_sec": 653.3898000455112, "timesteps_total": 760000, "num_env_steps_sampled_lifetime": 760000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 6187.638, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6187.597, "sample_time_ms": 756.787, "learn_time_ms": 5416.299, "learn_throughput": 738.512, "synch_weights_time_ms": 14.008}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 190, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-15-15", "timestamp": 1723396515, "time_this_iter_s": 6.126820802688599, "time_total_s": 1230.5456261634827, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9ed9a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1230.5456261634827, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 33.233333333333334, "ram_util_percent": 80.77777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8614980810244257, "cur_kl_coeff": 2.5223372357846714e-45, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.025165914680837887, "policy_loss": -0.0010580059267037238, "vf_loss": 0.026223920125630684, "vf_explained_var": 0.9939013021066785, "kl": 0.0011991471486029997, "entropy": 0.0774407370830886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 182880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6132358133870487, "cur_kl_coeff": 4.038967834731581e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.01770319336161871, "policy_loss": -0.006308229326047392, "vf_loss": 0.024011422291126412, "vf_explained_var": 0.9944970885912577, "kl": 0.004308516207241908, "entropy": 0.22003232970212896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 182880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 1528000, "num_agent_steps_trained": 1528000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 5, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.12788172174956, "predator_policy": 2.9681779366529457}, "policy_reward_max": {"prey_policy": -2.9681779366529457, "predator_policy": 49.12788172174956}, "policy_reward_mean": {"prey_policy": -26.838276735754924, "predator_policy": 26.838276735754924}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-29.34714146037229, -40.13093818911391, -33.00097596455997, -18.473171175256986, -2.9681779366529457, -13.912695152095331, -18.93435024655612, -34.20710680346676, -29.795101767730447, -38.31834428017376, -22.793699433307477, -42.40736648334758, -25.2075039009648, -29.821907300462378, -49.12788172174956, -39.340906090870575, -29.511141571472056, -25.284249878775594, -14.344652640053642, -18.22144830652005, -7.683568451239644, -42.88120682073195, -27.688815292976464, -37.74088473679172, -13.260228601912262, -28.334435707309673, -38.93953737513781, -47.30383234042418, -35.48583825087325, -9.906377826238444, -16.177745832207783, -10.90374949828716, -40.72140448594513, -5.020367624154259, -39.314691076801076, -37.01101216036223, -31.346023168171683, -31.09043967205028, -29.18650619402467, -20.979924532872218, -18.217744381636116, -17.188332306887823, -22.82800034535335, -32.85606312725322, -17.885233181628433, -31.017124053087542, -37.6086635592157, -42.0368846764175, -44.20847222676504, -24.123747747019166, -37.16747406054673, -4.820446458288689, -19.39962598301212, -24.036651517904833, -19.465013740295458, -30.254068596011074, -25.71114787337298, -45.86501506309621, -35.68878414320191, -43.82242796993293, -23.04741833825235, -8.275045518377986, -39.16907276915681, -16.31166986889357, -20.06431540077004, -24.911697782523092, -13.028890922570913, -24.48308062862095, -12.03291399863243, -10.244437163975048, -29.797956074113934, -39.91337452204493, -19.254472514643187, -27.26417070355789, -16.67997732041417, -28.91602168630235, -20.087917046506504, -34.94920677792449, -31.63760072911613, -32.53782761776712, -29.414231083925696, -8.845080513189178, -30.446188643393636, -11.092714702808001, -25.86854511794859, -39.672496394474884, -40.435481457923245, -40.81942268015289, -25.76677234597746, -16.87653779146455, -25.81301714373688, -42.10358943495124, -23.965763717523757, -20.302041688107277, -26.738457663870204, -13.842142789007227, -28.454314016572532, -34.95139201211047, -18.54346505856747, -26.942680972682695], "policy_predator_policy_reward": [29.34714146037229, 40.13093818911391, 33.00097596455997, 18.473171175256986, 2.9681779366529457, 13.912695152095331, 18.93435024655612, 34.20710680346676, 29.795101767730447, 38.31834428017376, 22.793699433307477, 42.40736648334758, 25.2075039009648, 29.821907300462378, 49.12788172174956, 39.340906090870575, 29.511141571472056, 25.284249878775594, 14.344652640053642, 18.22144830652005, 7.683568451239644, 42.88120682073195, 27.688815292976464, 37.74088473679172, 13.260228601912262, 28.334435707309673, 38.93953737513781, 47.30383234042418, 35.48583825087325, 9.906377826238444, 16.177745832207783, 10.90374949828716, 40.72140448594513, 5.020367624154259, 39.314691076801076, 37.01101216036223, 31.346023168171683, 31.09043967205028, 29.18650619402467, 20.979924532872218, 18.217744381636116, 17.188332306887823, 22.82800034535335, 32.85606312725322, 17.885233181628433, 31.017124053087542, 37.6086635592157, 42.0368846764175, 44.20847222676504, 24.123747747019166, 37.16747406054673, 4.820446458288689, 19.39962598301212, 24.036651517904833, 19.465013740295458, 30.254068596011074, 25.71114787337298, 45.86501506309621, 35.68878414320191, 43.82242796993293, 23.04741833825235, 8.275045518377986, 39.16907276915681, 16.31166986889357, 20.06431540077004, 24.911697782523092, 13.028890922570913, 24.48308062862095, 12.03291399863243, 10.244437163975048, 29.797956074113934, 39.91337452204493, 19.254472514643187, 27.26417070355789, 16.67997732041417, 28.91602168630235, 20.087917046506504, 34.94920677792449, 31.63760072911613, 32.53782761776712, 29.414231083925696, 8.845080513189178, 30.446188643393636, 11.092714702808001, 25.86854511794859, 39.672496394474884, 40.435481457923245, 40.81942268015289, 25.76677234597746, 16.87653779146455, 25.81301714373688, 42.10358943495124, 23.965763717523757, 20.302041688107277, 26.738457663870204, 13.842142789007227, 28.454314016572532, 34.95139201211047, 18.54346505856747, 26.942680972682695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29054116321628676, "mean_inference_ms": 0.972766161280622, "mean_action_processing_ms": 0.12938845603648882, "mean_env_wait_ms": 0.06888423977967975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057212114334106445, "StateBufferConnector_ms": 0.002512216567993164, "ViewRequirementAgentConnector_ms": 0.06116688251495361}, "num_episodes": 5, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1528000, "num_agent_steps_trained": 1528000, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 645.167462966703, "num_env_steps_trained_throughput_per_sec": 645.167462966703, "timesteps_total": 764000, "num_env_steps_sampled_lifetime": 764000, "num_agent_steps_sampled_lifetime": 1528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1528000, "timers": {"training_iteration_time_ms": 6118.104, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6118.063, "sample_time_ms": 759.821, "learn_time_ms": 5343.802, "learn_throughput": 748.531, "synch_weights_time_ms": 13.931}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 1528000, "num_agent_steps_trained": 1528000}, "done": false, "training_iteration": 191, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-15-21", "timestamp": 1723396521, "time_this_iter_s": 6.207791090011597, "time_total_s": 1236.7534172534943, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f2faf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1236.7534172534943, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 32.91111111111111, "ram_util_percent": 81.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0483597089691707, "cur_kl_coeff": 1.2611686178923357e-45, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.14718270731633917, "policy_loss": -0.008261119620631993, "vf_loss": 0.15544382651569322, "vf_explained_var": 0.9923937441781163, "kl": 0.010313102156370667, "entropy": 0.062031978734982354, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 183840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3011404294831057, "cur_kl_coeff": 2.0194839173657906e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.15699077196622965, "policy_loss": -0.003964369252692753, "vf_loss": 0.16095514078527534, "vf_explained_var": 0.9925269616146882, "kl": 0.0019108327404616912, "entropy": 0.2292268518358469, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 183840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -49.12788172174956, "predator_policy": 4.820446458288689}, "policy_reward_max": {"prey_policy": -4.820446458288689, "predator_policy": 49.12788172174956}, "policy_reward_mean": {"prey_policy": -26.267516657108704, "predator_policy": 26.267516657108704}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-38.31834428017376, -22.793699433307477, -42.40736648334758, -25.2075039009648, -29.821907300462378, -49.12788172174956, -39.340906090870575, -29.511141571472056, -25.284249878775594, -14.344652640053642, -18.22144830652005, -7.683568451239644, -42.88120682073195, -27.688815292976464, -37.74088473679172, -13.260228601912262, -28.334435707309673, -38.93953737513781, -47.30383234042418, -35.48583825087325, -9.906377826238444, -16.177745832207783, -10.90374949828716, -40.72140448594513, -5.020367624154259, -39.314691076801076, -37.01101216036223, -31.346023168171683, -31.09043967205028, -29.18650619402467, -20.979924532872218, -18.217744381636116, -17.188332306887823, -22.82800034535335, -32.85606312725322, -17.885233181628433, -31.017124053087542, -37.6086635592157, -42.0368846764175, -44.20847222676504, -24.123747747019166, -37.16747406054673, -4.820446458288689, -19.39962598301212, -24.036651517904833, -19.465013740295458, -30.254068596011074, -25.71114787337298, -45.86501506309621, -35.68878414320191, -43.82242796993293, -23.04741833825235, -8.275045518377986, -39.16907276915681, -16.31166986889357, -20.06431540077004, -24.911697782523092, -13.028890922570913, -24.48308062862095, -12.03291399863243, -10.244437163975048, -29.797956074113934, -39.91337452204493, -19.254472514643187, -27.26417070355789, -16.67997732041417, -28.91602168630235, -20.087917046506504, -34.94920677792449, -31.63760072911613, -32.53782761776712, -29.414231083925696, -8.845080513189178, -30.446188643393636, -11.092714702808001, -25.86854511794859, -39.672496394474884, -40.435481457923245, -40.81942268015289, -25.76677234597746, -16.87653779146455, -25.81301714373688, -42.10358943495124, -23.965763717523757, -20.302041688107277, -26.738457663870204, -13.842142789007227, -28.454314016572532, -34.95139201211047, -18.54346505856747, -26.942680972682695, -17.841313472333525, -10.20846821511951, -9.237135764886675, -39.63638387584895, -7.4934751016413035, -7.592427693900653, -20.63292276323284, -37.37328083717388, -13.67824310704531], "policy_predator_policy_reward": [38.31834428017376, 22.793699433307477, 42.40736648334758, 25.2075039009648, 29.821907300462378, 49.12788172174956, 39.340906090870575, 29.511141571472056, 25.284249878775594, 14.344652640053642, 18.22144830652005, 7.683568451239644, 42.88120682073195, 27.688815292976464, 37.74088473679172, 13.260228601912262, 28.334435707309673, 38.93953737513781, 47.30383234042418, 35.48583825087325, 9.906377826238444, 16.177745832207783, 10.90374949828716, 40.72140448594513, 5.020367624154259, 39.314691076801076, 37.01101216036223, 31.346023168171683, 31.09043967205028, 29.18650619402467, 20.979924532872218, 18.217744381636116, 17.188332306887823, 22.82800034535335, 32.85606312725322, 17.885233181628433, 31.017124053087542, 37.6086635592157, 42.0368846764175, 44.20847222676504, 24.123747747019166, 37.16747406054673, 4.820446458288689, 19.39962598301212, 24.036651517904833, 19.465013740295458, 30.254068596011074, 25.71114787337298, 45.86501506309621, 35.68878414320191, 43.82242796993293, 23.04741833825235, 8.275045518377986, 39.16907276915681, 16.31166986889357, 20.06431540077004, 24.911697782523092, 13.028890922570913, 24.48308062862095, 12.03291399863243, 10.244437163975048, 29.797956074113934, 39.91337452204493, 19.254472514643187, 27.26417070355789, 16.67997732041417, 28.91602168630235, 20.087917046506504, 34.94920677792449, 31.63760072911613, 32.53782761776712, 29.414231083925696, 8.845080513189178, 30.446188643393636, 11.092714702808001, 25.86854511794859, 39.672496394474884, 40.435481457923245, 40.81942268015289, 25.76677234597746, 16.87653779146455, 25.81301714373688, 42.10358943495124, 23.965763717523757, 20.302041688107277, 26.738457663870204, 13.842142789007227, 28.454314016572532, 34.95139201211047, 18.54346505856747, 26.942680972682695, 17.841313472333525, 10.20846821511951, 9.237135764886675, 39.63638387584895, 7.4934751016413035, 7.592427693900653, 20.63292276323284, 37.37328083717388, 13.67824310704531]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2909752619836705, "mean_inference_ms": 0.9736909191083918, "mean_action_processing_ms": 0.1294532306747199, "mean_env_wait_ms": 0.06895543387045688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005797743797302246, "StateBufferConnector_ms": 0.0025360584259033203, "ViewRequirementAgentConnector_ms": 0.061314940452575684}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 614.3551532737234, "num_env_steps_trained_throughput_per_sec": 614.3551532737234, "timesteps_total": 768000, "num_env_steps_sampled_lifetime": 768000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 6154.987, "restore_workers_time_ms": 0.014, "training_step_time_ms": 6154.946, "sample_time_ms": 766.091, "learn_time_ms": 5374.677, "learn_throughput": 744.231, "synch_weights_time_ms": 13.669}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 192, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-15-27", "timestamp": 1723396527, "time_this_iter_s": 6.5178492069244385, "time_total_s": 1243.2712664604187, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a787ac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1243.2712664604187, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 39.71111111111111, "ram_util_percent": 81.71111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.152894010177503, "cur_kl_coeff": 1.2611686178923357e-45, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06756802634384561, "policy_loss": 4.0110393941480044e-05, "vf_loss": 0.0675279157711581, "vf_explained_var": 0.9980958392222722, "kl": 0.0022366506774821973, "entropy": 0.08964381860666132, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 184800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0760616923682391, "cur_kl_coeff": 1.0097419586828953e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.049157074556327035, "policy_loss": -0.018650063955283257, "vf_loss": 0.06780713819607627, "vf_explained_var": 0.9981045731032888, "kl": 0.010093460811219252, "entropy": 0.25607917512146133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 184800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 1544000, "num_agent_steps_trained": 1544000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -47.30383234042418, "predator_policy": 4.820446458288689}, "policy_reward_max": {"prey_policy": -4.820446458288689, "predator_policy": 47.30383234042418}, "policy_reward_mean": {"prey_policy": -26.02859713768297, "predator_policy": 26.02859713768297}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-14.344652640053642, -18.22144830652005, -7.683568451239644, -42.88120682073195, -27.688815292976464, -37.74088473679172, -13.260228601912262, -28.334435707309673, -38.93953737513781, -47.30383234042418, -35.48583825087325, -9.906377826238444, -16.177745832207783, -10.90374949828716, -40.72140448594513, -5.020367624154259, -39.314691076801076, -37.01101216036223, -31.346023168171683, -31.09043967205028, -29.18650619402467, -20.979924532872218, -18.217744381636116, -17.188332306887823, -22.82800034535335, -32.85606312725322, -17.885233181628433, -31.017124053087542, -37.6086635592157, -42.0368846764175, -44.20847222676504, -24.123747747019166, -37.16747406054673, -4.820446458288689, -19.39962598301212, -24.036651517904833, -19.465013740295458, -30.254068596011074, -25.71114787337298, -45.86501506309621, -35.68878414320191, -43.82242796993293, -23.04741833825235, -8.275045518377986, -39.16907276915681, -16.31166986889357, -20.06431540077004, -24.911697782523092, -13.028890922570913, -24.48308062862095, -12.03291399863243, -10.244437163975048, -29.797956074113934, -39.91337452204493, -19.254472514643187, -27.26417070355789, -16.67997732041417, -28.91602168630235, -20.087917046506504, -34.94920677792449, -31.63760072911613, -32.53782761776712, -29.414231083925696, -8.845080513189178, -30.446188643393636, -11.092714702808001, -25.86854511794859, -39.672496394474884, -40.435481457923245, -40.81942268015289, -25.76677234597746, -16.87653779146455, -25.81301714373688, -42.10358943495124, -23.965763717523757, -20.302041688107277, -26.738457663870204, -13.842142789007227, -28.454314016572532, -34.95139201211047, -18.54346505856747, -26.942680972682695, -17.841313472333525, -10.20846821511951, -9.237135764886675, -39.63638387584895, -7.4934751016413035, -7.592427693900653, -20.63292276323284, -37.37328083717388, -13.67824310704531, -34.27327752818979, -18.394413861619185, -33.433537838429956, -31.705298383684017, -33.37960652040902, -31.251280983429062, -31.91872849292632, -36.272821362988616, -27.292083746874678], "policy_predator_policy_reward": [14.344652640053642, 18.22144830652005, 7.683568451239644, 42.88120682073195, 27.688815292976464, 37.74088473679172, 13.260228601912262, 28.334435707309673, 38.93953737513781, 47.30383234042418, 35.48583825087325, 9.906377826238444, 16.177745832207783, 10.90374949828716, 40.72140448594513, 5.020367624154259, 39.314691076801076, 37.01101216036223, 31.346023168171683, 31.09043967205028, 29.18650619402467, 20.979924532872218, 18.217744381636116, 17.188332306887823, 22.82800034535335, 32.85606312725322, 17.885233181628433, 31.017124053087542, 37.6086635592157, 42.0368846764175, 44.20847222676504, 24.123747747019166, 37.16747406054673, 4.820446458288689, 19.39962598301212, 24.036651517904833, 19.465013740295458, 30.254068596011074, 25.71114787337298, 45.86501506309621, 35.68878414320191, 43.82242796993293, 23.04741833825235, 8.275045518377986, 39.16907276915681, 16.31166986889357, 20.06431540077004, 24.911697782523092, 13.028890922570913, 24.48308062862095, 12.03291399863243, 10.244437163975048, 29.797956074113934, 39.91337452204493, 19.254472514643187, 27.26417070355789, 16.67997732041417, 28.91602168630235, 20.087917046506504, 34.94920677792449, 31.63760072911613, 32.53782761776712, 29.414231083925696, 8.845080513189178, 30.446188643393636, 11.092714702808001, 25.86854511794859, 39.672496394474884, 40.435481457923245, 40.81942268015289, 25.76677234597746, 16.87653779146455, 25.81301714373688, 42.10358943495124, 23.965763717523757, 20.302041688107277, 26.738457663870204, 13.842142789007227, 28.454314016572532, 34.95139201211047, 18.54346505856747, 26.942680972682695, 17.841313472333525, 10.20846821511951, 9.237135764886675, 39.63638387584895, 7.4934751016413035, 7.592427693900653, 20.63292276323284, 37.37328083717388, 13.67824310704531, 34.27327752818979, 18.394413861619185, 33.433537838429956, 31.705298383684017, 33.37960652040902, 31.251280983429062, 31.91872849292632, 36.272821362988616, 27.292083746874678]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29110556275089994, "mean_inference_ms": 0.9742547988748056, "mean_action_processing_ms": 0.12952391393615945, "mean_env_wait_ms": 0.06899662565527338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003069281578063965, "StateBufferConnector_ms": 0.002422809600830078, "ViewRequirementAgentConnector_ms": 0.05737471580505371}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1544000, "num_agent_steps_trained": 1544000, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 643.3011194836786, "num_env_steps_trained_throughput_per_sec": 643.3011194836786, "timesteps_total": 772000, "num_env_steps_sampled_lifetime": 772000, "num_agent_steps_sampled_lifetime": 1544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1544000, "timers": {"training_iteration_time_ms": 6191.226, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6191.185, "sample_time_ms": 768.893, "learn_time_ms": 5408.585, "learn_throughput": 739.565, "synch_weights_time_ms": 13.194}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 1544000, "num_agent_steps_trained": 1544000}, "done": false, "training_iteration": 193, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-15-34", "timestamp": 1723396534, "time_this_iter_s": 6.223655939102173, "time_total_s": 1249.4949223995209, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f65a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1249.4949223995209, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 33.43333333333333, "ram_util_percent": 81.52222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2047435923789938, "cur_kl_coeff": 6.3058430894616785e-46, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.12303849618983805, "policy_loss": -0.002770320128426344, "vf_loss": 0.1258088171496638, "vf_explained_var": 0.9930118288223942, "kl": 0.002836415142000252, "entropy": 0.06843646201584003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 185760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.225043572485447, "cur_kl_coeff": 1.0097419586828953e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.11443201485623528, "policy_loss": -0.010204693367510724, "vf_loss": 0.12463670801710881, "vf_explained_var": 0.9929339383418362, "kl": 0.005455674314806831, "entropy": 0.2565674493089318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 185760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -47.30383234042418, "predator_policy": 4.820446458288689}, "policy_reward_max": {"prey_policy": -4.820446458288689, "predator_policy": 47.30383234042418}, "policy_reward_mean": {"prey_policy": -26.633565069043, "predator_policy": 26.633565069043}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-47.30383234042418, -35.48583825087325, -9.906377826238444, -16.177745832207783, -10.90374949828716, -40.72140448594513, -5.020367624154259, -39.314691076801076, -37.01101216036223, -31.346023168171683, -31.09043967205028, -29.18650619402467, -20.979924532872218, -18.217744381636116, -17.188332306887823, -22.82800034535335, -32.85606312725322, -17.885233181628433, -31.017124053087542, -37.6086635592157, -42.0368846764175, -44.20847222676504, -24.123747747019166, -37.16747406054673, -4.820446458288689, -19.39962598301212, -24.036651517904833, -19.465013740295458, -30.254068596011074, -25.71114787337298, -45.86501506309621, -35.68878414320191, -43.82242796993293, -23.04741833825235, -8.275045518377986, -39.16907276915681, -16.31166986889357, -20.06431540077004, -24.911697782523092, -13.028890922570913, -24.48308062862095, -12.03291399863243, -10.244437163975048, -29.797956074113934, -39.91337452204493, -19.254472514643187, -27.26417070355789, -16.67997732041417, -28.91602168630235, -20.087917046506504, -34.94920677792449, -31.63760072911613, -32.53782761776712, -29.414231083925696, -8.845080513189178, -30.446188643393636, -11.092714702808001, -25.86854511794859, -39.672496394474884, -40.435481457923245, -40.81942268015289, -25.76677234597746, -16.87653779146455, -25.81301714373688, -42.10358943495124, -23.965763717523757, -20.302041688107277, -26.738457663870204, -13.842142789007227, -28.454314016572532, -34.95139201211047, -18.54346505856747, -26.942680972682695, -17.841313472333525, -10.20846821511951, -9.237135764886675, -39.63638387584895, -7.4934751016413035, -7.592427693900653, -20.63292276323284, -37.37328083717388, -13.67824310704531, -34.27327752818979, -18.394413861619185, -33.433537838429956, -31.705298383684017, -33.37960652040902, -31.251280983429062, -31.91872849292632, -36.272821362988616, -27.292083746874678, -9.624165008463736, -38.040671323820675, -21.942487912665555, -16.171583949173833, -30.053231790969864, -45.52326818894701, -41.41072722534816, -45.0259041076747, -41.799531561612696], "policy_predator_policy_reward": [47.30383234042418, 35.48583825087325, 9.906377826238444, 16.177745832207783, 10.90374949828716, 40.72140448594513, 5.020367624154259, 39.314691076801076, 37.01101216036223, 31.346023168171683, 31.09043967205028, 29.18650619402467, 20.979924532872218, 18.217744381636116, 17.188332306887823, 22.82800034535335, 32.85606312725322, 17.885233181628433, 31.017124053087542, 37.6086635592157, 42.0368846764175, 44.20847222676504, 24.123747747019166, 37.16747406054673, 4.820446458288689, 19.39962598301212, 24.036651517904833, 19.465013740295458, 30.254068596011074, 25.71114787337298, 45.86501506309621, 35.68878414320191, 43.82242796993293, 23.04741833825235, 8.275045518377986, 39.16907276915681, 16.31166986889357, 20.06431540077004, 24.911697782523092, 13.028890922570913, 24.48308062862095, 12.03291399863243, 10.244437163975048, 29.797956074113934, 39.91337452204493, 19.254472514643187, 27.26417070355789, 16.67997732041417, 28.91602168630235, 20.087917046506504, 34.94920677792449, 31.63760072911613, 32.53782761776712, 29.414231083925696, 8.845080513189178, 30.446188643393636, 11.092714702808001, 25.86854511794859, 39.672496394474884, 40.435481457923245, 40.81942268015289, 25.76677234597746, 16.87653779146455, 25.81301714373688, 42.10358943495124, 23.965763717523757, 20.302041688107277, 26.738457663870204, 13.842142789007227, 28.454314016572532, 34.95139201211047, 18.54346505856747, 26.942680972682695, 17.841313472333525, 10.20846821511951, 9.237135764886675, 39.63638387584895, 7.4934751016413035, 7.592427693900653, 20.63292276323284, 37.37328083717388, 13.67824310704531, 34.27327752818979, 18.394413861619185, 33.433537838429956, 31.705298383684017, 33.37960652040902, 31.251280983429062, 31.91872849292632, 36.272821362988616, 27.292083746874678, 9.624165008463736, 38.040671323820675, 21.942487912665555, 16.171583949173833, 30.053231790969864, 45.52326818894701, 41.41072722534816, 45.0259041076747, 41.799531561612696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2910103676550402, "mean_inference_ms": 0.9747648435156769, "mean_action_processing_ms": 0.12963418847295213, "mean_env_wait_ms": 0.06904229717042452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029822587966918945, "StateBufferConnector_ms": 0.0023865699768066406, "ViewRequirementAgentConnector_ms": 0.05612075328826904}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 607.7583702359667, "num_env_steps_trained_throughput_per_sec": 607.7583702359667, "timesteps_total": 776000, "num_env_steps_sampled_lifetime": 776000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 6222.986, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6222.944, "sample_time_ms": 767.529, "learn_time_ms": 5441.778, "learn_throughput": 735.054, "synch_weights_time_ms": 13.084}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 194, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-15-40", "timestamp": 1723396540, "time_this_iter_s": 6.586284160614014, "time_total_s": 1256.081206560135, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9ed9f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1256.081206560135, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 39.24444444444445, "ram_util_percent": 82.6888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0954248398697624, "cur_kl_coeff": 3.1529215447308393e-46, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.11065853388790856, "policy_loss": 0.0006194512883060573, "vf_loss": 0.11003908184745038, "vf_explained_var": 0.9943783889214198, "kl": 0.0021514592556161356, "entropy": 0.07670022604676584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 186720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0092529746703804, "cur_kl_coeff": 1.0097419586828953e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.10487104360921269, "policy_loss": -0.011508797578426311, "vf_loss": 0.11637984034071754, "vf_explained_var": 0.993926876783371, "kl": 0.007297386504793568, "entropy": 0.31635792523932954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 186720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -45.86501506309621, "predator_policy": 4.820446458288689}, "policy_reward_max": {"prey_policy": -4.820446458288689, "predator_policy": 45.86501506309621}, "policy_reward_mean": {"prey_policy": -26.428318316676126, "predator_policy": 26.428318316676126}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-31.346023168171683, -31.09043967205028, -29.18650619402467, -20.979924532872218, -18.217744381636116, -17.188332306887823, -22.82800034535335, -32.85606312725322, -17.885233181628433, -31.017124053087542, -37.6086635592157, -42.0368846764175, -44.20847222676504, -24.123747747019166, -37.16747406054673, -4.820446458288689, -19.39962598301212, -24.036651517904833, -19.465013740295458, -30.254068596011074, -25.71114787337298, -45.86501506309621, -35.68878414320191, -43.82242796993293, -23.04741833825235, -8.275045518377986, -39.16907276915681, -16.31166986889357, -20.06431540077004, -24.911697782523092, -13.028890922570913, -24.48308062862095, -12.03291399863243, -10.244437163975048, -29.797956074113934, -39.91337452204493, -19.254472514643187, -27.26417070355789, -16.67997732041417, -28.91602168630235, -20.087917046506504, -34.94920677792449, -31.63760072911613, -32.53782761776712, -29.414231083925696, -8.845080513189178, -30.446188643393636, -11.092714702808001, -25.86854511794859, -39.672496394474884, -40.435481457923245, -40.81942268015289, -25.76677234597746, -16.87653779146455, -25.81301714373688, -42.10358943495124, -23.965763717523757, -20.302041688107277, -26.738457663870204, -13.842142789007227, -28.454314016572532, -34.95139201211047, -18.54346505856747, -26.942680972682695, -17.841313472333525, -10.20846821511951, -9.237135764886675, -39.63638387584895, -7.4934751016413035, -7.592427693900653, -20.63292276323284, -37.37328083717388, -13.67824310704531, -34.27327752818979, -18.394413861619185, -33.433537838429956, -31.705298383684017, -33.37960652040902, -31.251280983429062, -31.91872849292632, -36.272821362988616, -27.292083746874678, -9.624165008463736, -38.040671323820675, -21.942487912665555, -16.171583949173833, -30.053231790969864, -45.52326818894701, -41.41072722534816, -45.0259041076747, -41.799531561612696, -28.708536598031163, -33.353386170939025, -30.146606853798517, -32.22266708029239, -15.766114639725842, -22.27703793701401, -26.548150857680593, -8.585622546049516, -23.712221175075346], "policy_predator_policy_reward": [31.346023168171683, 31.09043967205028, 29.18650619402467, 20.979924532872218, 18.217744381636116, 17.188332306887823, 22.82800034535335, 32.85606312725322, 17.885233181628433, 31.017124053087542, 37.6086635592157, 42.0368846764175, 44.20847222676504, 24.123747747019166, 37.16747406054673, 4.820446458288689, 19.39962598301212, 24.036651517904833, 19.465013740295458, 30.254068596011074, 25.71114787337298, 45.86501506309621, 35.68878414320191, 43.82242796993293, 23.04741833825235, 8.275045518377986, 39.16907276915681, 16.31166986889357, 20.06431540077004, 24.911697782523092, 13.028890922570913, 24.48308062862095, 12.03291399863243, 10.244437163975048, 29.797956074113934, 39.91337452204493, 19.254472514643187, 27.26417070355789, 16.67997732041417, 28.91602168630235, 20.087917046506504, 34.94920677792449, 31.63760072911613, 32.53782761776712, 29.414231083925696, 8.845080513189178, 30.446188643393636, 11.092714702808001, 25.86854511794859, 39.672496394474884, 40.435481457923245, 40.81942268015289, 25.76677234597746, 16.87653779146455, 25.81301714373688, 42.10358943495124, 23.965763717523757, 20.302041688107277, 26.738457663870204, 13.842142789007227, 28.454314016572532, 34.95139201211047, 18.54346505856747, 26.942680972682695, 17.841313472333525, 10.20846821511951, 9.237135764886675, 39.63638387584895, 7.4934751016413035, 7.592427693900653, 20.63292276323284, 37.37328083717388, 13.67824310704531, 34.27327752818979, 18.394413861619185, 33.433537838429956, 31.705298383684017, 33.37960652040902, 31.251280983429062, 31.91872849292632, 36.272821362988616, 27.292083746874678, 9.624165008463736, 38.040671323820675, 21.942487912665555, 16.171583949173833, 30.053231790969864, 45.52326818894701, 41.41072722534816, 45.0259041076747, 41.799531561612696, 28.708536598031163, 33.353386170939025, 30.146606853798517, 32.22266708029239, 15.766114639725842, 22.27703793701401, 26.548150857680593, 8.585622546049516, 23.712221175075346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.291151796649788, "mean_inference_ms": 0.975328688780925, "mean_action_processing_ms": 0.12970464472848012, "mean_env_wait_ms": 0.06908432591892294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030339956283569336, "StateBufferConnector_ms": 0.0024298429489135742, "ViewRequirementAgentConnector_ms": 0.06156742572784424}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 670.0993856789099, "num_env_steps_trained_throughput_per_sec": 670.0993856789099, "timesteps_total": 780000, "num_env_steps_sampled_lifetime": 780000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 6197.746, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6197.708, "sample_time_ms": 763.189, "learn_time_ms": 5421.014, "learn_throughput": 737.869, "synch_weights_time_ms": 12.961}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 195, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-15-46", "timestamp": 1723396546, "time_this_iter_s": 5.975744009017944, "time_total_s": 1262.0569505691528, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f2faf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1262.0569505691528, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 32.800000000000004, "ram_util_percent": 81.91111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9494112531188875, "cur_kl_coeff": 1.5764607723654196e-46, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09803367573598128, "policy_loss": -0.0023529417398094666, "vf_loss": 0.10038661744862717, "vf_explained_var": 0.9919508193309109, "kl": 0.00390395645184738, "entropy": 0.09020857026334853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 187680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8987757286212097, "cur_kl_coeff": 1.0097419586828953e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07960838142801853, "policy_loss": -0.011556147949158912, "vf_loss": 0.09116452982076832, "vf_explained_var": 0.9918170766284068, "kl": 0.005157137753647543, "entropy": 0.3091688048404952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 187680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -45.86501506309621, "predator_policy": 2.7522992157976542}, "policy_reward_max": {"prey_policy": -2.7522992157976542, "predator_policy": 45.86501506309621}, "policy_reward_mean": {"prey_policy": -26.510009170338094, "predator_policy": 26.510009170338094}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-31.017124053087542, -37.6086635592157, -42.0368846764175, -44.20847222676504, -24.123747747019166, -37.16747406054673, -4.820446458288689, -19.39962598301212, -24.036651517904833, -19.465013740295458, -30.254068596011074, -25.71114787337298, -45.86501506309621, -35.68878414320191, -43.82242796993293, -23.04741833825235, -8.275045518377986, -39.16907276915681, -16.31166986889357, -20.06431540077004, -24.911697782523092, -13.028890922570913, -24.48308062862095, -12.03291399863243, -10.244437163975048, -29.797956074113934, -39.91337452204493, -19.254472514643187, -27.26417070355789, -16.67997732041417, -28.91602168630235, -20.087917046506504, -34.94920677792449, -31.63760072911613, -32.53782761776712, -29.414231083925696, -8.845080513189178, -30.446188643393636, -11.092714702808001, -25.86854511794859, -39.672496394474884, -40.435481457923245, -40.81942268015289, -25.76677234597746, -16.87653779146455, -25.81301714373688, -42.10358943495124, -23.965763717523757, -20.302041688107277, -26.738457663870204, -13.842142789007227, -28.454314016572532, -34.95139201211047, -18.54346505856747, -26.942680972682695, -17.841313472333525, -10.20846821511951, -9.237135764886675, -39.63638387584895, -7.4934751016413035, -7.592427693900653, -20.63292276323284, -37.37328083717388, -13.67824310704531, -34.27327752818979, -18.394413861619185, -33.433537838429956, -31.705298383684017, -33.37960652040902, -31.251280983429062, -31.91872849292632, -36.272821362988616, -27.292083746874678, -9.624165008463736, -38.040671323820675, -21.942487912665555, -16.171583949173833, -30.053231790969864, -45.52326818894701, -41.41072722534816, -45.0259041076747, -41.799531561612696, -28.708536598031163, -33.353386170939025, -30.146606853798517, -32.22266708029239, -15.766114639725842, -22.27703793701401, -26.548150857680593, -8.585622546049516, -23.712221175075346, -11.09288656033011, -33.04832944398816, -30.95393142911088, -34.94287806938874, -20.258347817132268, -31.73355101298011, -2.7522992157976542, -38.93713672347029, -26.027992003875507], "policy_predator_policy_reward": [31.017124053087542, 37.6086635592157, 42.0368846764175, 44.20847222676504, 24.123747747019166, 37.16747406054673, 4.820446458288689, 19.39962598301212, 24.036651517904833, 19.465013740295458, 30.254068596011074, 25.71114787337298, 45.86501506309621, 35.68878414320191, 43.82242796993293, 23.04741833825235, 8.275045518377986, 39.16907276915681, 16.31166986889357, 20.06431540077004, 24.911697782523092, 13.028890922570913, 24.48308062862095, 12.03291399863243, 10.244437163975048, 29.797956074113934, 39.91337452204493, 19.254472514643187, 27.26417070355789, 16.67997732041417, 28.91602168630235, 20.087917046506504, 34.94920677792449, 31.63760072911613, 32.53782761776712, 29.414231083925696, 8.845080513189178, 30.446188643393636, 11.092714702808001, 25.86854511794859, 39.672496394474884, 40.435481457923245, 40.81942268015289, 25.76677234597746, 16.87653779146455, 25.81301714373688, 42.10358943495124, 23.965763717523757, 20.302041688107277, 26.738457663870204, 13.842142789007227, 28.454314016572532, 34.95139201211047, 18.54346505856747, 26.942680972682695, 17.841313472333525, 10.20846821511951, 9.237135764886675, 39.63638387584895, 7.4934751016413035, 7.592427693900653, 20.63292276323284, 37.37328083717388, 13.67824310704531, 34.27327752818979, 18.394413861619185, 33.433537838429956, 31.705298383684017, 33.37960652040902, 31.251280983429062, 31.91872849292632, 36.272821362988616, 27.292083746874678, 9.624165008463736, 38.040671323820675, 21.942487912665555, 16.171583949173833, 30.053231790969864, 45.52326818894701, 41.41072722534816, 45.0259041076747, 41.799531561612696, 28.708536598031163, 33.353386170939025, 30.146606853798517, 32.22266708029239, 15.766114639725842, 22.27703793701401, 26.548150857680593, 8.585622546049516, 23.712221175075346, 11.09288656033011, 33.04832944398816, 30.95393142911088, 34.94287806938874, 20.258347817132268, 31.73355101298011, 2.7522992157976542, 38.93713672347029, 26.027992003875507]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2912937535367011, "mean_inference_ms": 0.9758738656120225, "mean_action_processing_ms": 0.1297747968058456, "mean_env_wait_ms": 0.06912469358209727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030268430709838867, "StateBufferConnector_ms": 0.002427816390991211, "ViewRequirementAgentConnector_ms": 0.061486124992370605}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 671.1647232330257, "num_env_steps_trained_throughput_per_sec": 671.1647232330257, "timesteps_total": 784000, "num_env_steps_sampled_lifetime": 784000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 6200.69, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6200.652, "sample_time_ms": 762.427, "learn_time_ms": 5424.6, "learn_throughput": 737.382, "synch_weights_time_ms": 13.14}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 196, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-15-52", "timestamp": 1723396552, "time_this_iter_s": 5.964792728424072, "time_total_s": 1268.021743297577, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9efcb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1268.021743297577, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 33.3625, "ram_util_percent": 82.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0546131311605373, "cur_kl_coeff": 7.882303861827098e-47, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0789003117880687, "policy_loss": -0.0041561633309659856, "vf_loss": 0.08305647478361304, "vf_explained_var": 0.994271550513804, "kl": 0.007129440686954874, "entropy": 0.09064051800863429, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 188640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0017951839448263, "cur_kl_coeff": 1.0097419586828953e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08416501627119335, "policy_loss": -0.0027278971997778474, "vf_loss": 0.08689291346042106, "vf_explained_var": 0.9938983280832568, "kl": 0.004252181526626183, "entropy": 0.29835512650509677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 188640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 1576000, "num_agent_steps_trained": 1576000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -45.86501506309621, "predator_policy": 2.7522992157976542}, "policy_reward_max": {"prey_policy": -2.7522992157976542, "predator_policy": 45.86501506309621}, "policy_reward_mean": {"prey_policy": -26.260189282822623, "predator_policy": 26.260189282822623}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-24.123747747019166, -37.16747406054673, -4.820446458288689, -19.39962598301212, -24.036651517904833, -19.465013740295458, -30.254068596011074, -25.71114787337298, -45.86501506309621, -35.68878414320191, -43.82242796993293, -23.04741833825235, -8.275045518377986, -39.16907276915681, -16.31166986889357, -20.06431540077004, -24.911697782523092, -13.028890922570913, -24.48308062862095, -12.03291399863243, -10.244437163975048, -29.797956074113934, -39.91337452204493, -19.254472514643187, -27.26417070355789, -16.67997732041417, -28.91602168630235, -20.087917046506504, -34.94920677792449, -31.63760072911613, -32.53782761776712, -29.414231083925696, -8.845080513189178, -30.446188643393636, -11.092714702808001, -25.86854511794859, -39.672496394474884, -40.435481457923245, -40.81942268015289, -25.76677234597746, -16.87653779146455, -25.81301714373688, -42.10358943495124, -23.965763717523757, -20.302041688107277, -26.738457663870204, -13.842142789007227, -28.454314016572532, -34.95139201211047, -18.54346505856747, -26.942680972682695, -17.841313472333525, -10.20846821511951, -9.237135764886675, -39.63638387584895, -7.4934751016413035, -7.592427693900653, -20.63292276323284, -37.37328083717388, -13.67824310704531, -34.27327752818979, -18.394413861619185, -33.433537838429956, -31.705298383684017, -33.37960652040902, -31.251280983429062, -31.91872849292632, -36.272821362988616, -27.292083746874678, -9.624165008463736, -38.040671323820675, -21.942487912665555, -16.171583949173833, -30.053231790969864, -45.52326818894701, -41.41072722534816, -45.0259041076747, -41.799531561612696, -28.708536598031163, -33.353386170939025, -30.146606853798517, -32.22266708029239, -15.766114639725842, -22.27703793701401, -26.548150857680593, -8.585622546049516, -23.712221175075346, -11.09288656033011, -33.04832944398816, -30.95393142911088, -34.94287806938874, -20.258347817132268, -31.73355101298011, -2.7522992157976542, -38.93713672347029, -26.027992003875507, -34.78528590252066, -34.269368891743554, -42.55220203005253, -18.282298939621647], "policy_predator_policy_reward": [24.123747747019166, 37.16747406054673, 4.820446458288689, 19.39962598301212, 24.036651517904833, 19.465013740295458, 30.254068596011074, 25.71114787337298, 45.86501506309621, 35.68878414320191, 43.82242796993293, 23.04741833825235, 8.275045518377986, 39.16907276915681, 16.31166986889357, 20.06431540077004, 24.911697782523092, 13.028890922570913, 24.48308062862095, 12.03291399863243, 10.244437163975048, 29.797956074113934, 39.91337452204493, 19.254472514643187, 27.26417070355789, 16.67997732041417, 28.91602168630235, 20.087917046506504, 34.94920677792449, 31.63760072911613, 32.53782761776712, 29.414231083925696, 8.845080513189178, 30.446188643393636, 11.092714702808001, 25.86854511794859, 39.672496394474884, 40.435481457923245, 40.81942268015289, 25.76677234597746, 16.87653779146455, 25.81301714373688, 42.10358943495124, 23.965763717523757, 20.302041688107277, 26.738457663870204, 13.842142789007227, 28.454314016572532, 34.95139201211047, 18.54346505856747, 26.942680972682695, 17.841313472333525, 10.20846821511951, 9.237135764886675, 39.63638387584895, 7.4934751016413035, 7.592427693900653, 20.63292276323284, 37.37328083717388, 13.67824310704531, 34.27327752818979, 18.394413861619185, 33.433537838429956, 31.705298383684017, 33.37960652040902, 31.251280983429062, 31.91872849292632, 36.272821362988616, 27.292083746874678, 9.624165008463736, 38.040671323820675, 21.942487912665555, 16.171583949173833, 30.053231790969864, 45.52326818894701, 41.41072722534816, 45.0259041076747, 41.799531561612696, 28.708536598031163, 33.353386170939025, 30.146606853798517, 32.22266708029239, 15.766114639725842, 22.27703793701401, 26.548150857680593, 8.585622546049516, 23.712221175075346, 11.09288656033011, 33.04832944398816, 30.95393142911088, 34.94287806938874, 20.258347817132268, 31.73355101298011, 2.7522992157976542, 38.93713672347029, 26.027992003875507, 34.78528590252066, 34.269368891743554, 42.55220203005253, 18.282298939621647]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2912469973520765, "mean_inference_ms": 0.9760142352646435, "mean_action_processing_ms": 0.1297690426240288, "mean_env_wait_ms": 0.06913756026467467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029959678649902344, "StateBufferConnector_ms": 0.0024067163467407227, "ViewRequirementAgentConnector_ms": 0.06028866767883301}, "num_episodes": 4, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1576000, "num_agent_steps_trained": 1576000, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 689.2268011739176, "num_env_steps_trained_throughput_per_sec": 689.2268011739176, "timesteps_total": 788000, "num_env_steps_sampled_lifetime": 788000, "num_agent_steps_sampled_lifetime": 1576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1576000, "timers": {"training_iteration_time_ms": 6175.314, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6175.277, "sample_time_ms": 756.546, "learn_time_ms": 5404.865, "learn_throughput": 740.074, "synch_weights_time_ms": 13.374}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 1576000, "num_agent_steps_trained": 1576000}, "done": false, "training_iteration": 197, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-15-58", "timestamp": 1723396558, "time_this_iter_s": 5.808210134506226, "time_total_s": 1273.8299534320831, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f7e430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1273.8299534320831, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 33.2125, "ram_util_percent": 81.3625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1938835666359713, "cur_kl_coeff": 7.882303861827098e-47, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.11225053367161308, "policy_loss": -0.002259290928001671, "vf_loss": 0.1145098245460152, "vf_explained_var": 0.991674522186319, "kl": 0.0040689408384121115, "entropy": 0.08082582230999832, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 189600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.316719185995559, "cur_kl_coeff": 5.0487097934144765e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.11133430831493267, "policy_loss": -0.00624286572492565, "vf_loss": 0.11757717393920757, "vf_explained_var": 0.9913673823699355, "kl": 0.0038643339135604766, "entropy": 0.3312945321512719, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 189600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -45.52326818894701, "predator_policy": 2.7522992157976542}, "policy_reward_max": {"prey_policy": -2.7522992157976542, "predator_policy": 45.52326818894701}, "policy_reward_mean": {"prey_policy": -26.134958635754185, "predator_policy": 26.134958635754185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-35.68878414320191, -43.82242796993293, -23.04741833825235, -8.275045518377986, -39.16907276915681, -16.31166986889357, -20.06431540077004, -24.911697782523092, -13.028890922570913, -24.48308062862095, -12.03291399863243, -10.244437163975048, -29.797956074113934, -39.91337452204493, -19.254472514643187, -27.26417070355789, -16.67997732041417, -28.91602168630235, -20.087917046506504, -34.94920677792449, -31.63760072911613, -32.53782761776712, -29.414231083925696, -8.845080513189178, -30.446188643393636, -11.092714702808001, -25.86854511794859, -39.672496394474884, -40.435481457923245, -40.81942268015289, -25.76677234597746, -16.87653779146455, -25.81301714373688, -42.10358943495124, -23.965763717523757, -20.302041688107277, -26.738457663870204, -13.842142789007227, -28.454314016572532, -34.95139201211047, -18.54346505856747, -26.942680972682695, -17.841313472333525, -10.20846821511951, -9.237135764886675, -39.63638387584895, -7.4934751016413035, -7.592427693900653, -20.63292276323284, -37.37328083717388, -13.67824310704531, -34.27327752818979, -18.394413861619185, -33.433537838429956, -31.705298383684017, -33.37960652040902, -31.251280983429062, -31.91872849292632, -36.272821362988616, -27.292083746874678, -9.624165008463736, -38.040671323820675, -21.942487912665555, -16.171583949173833, -30.053231790969864, -45.52326818894701, -41.41072722534816, -45.0259041076747, -41.799531561612696, -28.708536598031163, -33.353386170939025, -30.146606853798517, -32.22266708029239, -15.766114639725842, -22.27703793701401, -26.548150857680593, -8.585622546049516, -23.712221175075346, -11.09288656033011, -33.04832944398816, -30.95393142911088, -34.94287806938874, -20.258347817132268, -31.73355101298011, -2.7522992157976542, -38.93713672347029, -26.027992003875507, -34.78528590252066, -34.269368891743554, -42.55220203005253, -18.282298939621647, -40.74457101272518, -7.223417234911886, -24.256808457919384, -12.950653068377957, -12.962707780118663, -41.01473643086081, -21.557427798896402, -32.39178972290863, -25.218014825985037], "policy_predator_policy_reward": [35.68878414320191, 43.82242796993293, 23.04741833825235, 8.275045518377986, 39.16907276915681, 16.31166986889357, 20.06431540077004, 24.911697782523092, 13.028890922570913, 24.48308062862095, 12.03291399863243, 10.244437163975048, 29.797956074113934, 39.91337452204493, 19.254472514643187, 27.26417070355789, 16.67997732041417, 28.91602168630235, 20.087917046506504, 34.94920677792449, 31.63760072911613, 32.53782761776712, 29.414231083925696, 8.845080513189178, 30.446188643393636, 11.092714702808001, 25.86854511794859, 39.672496394474884, 40.435481457923245, 40.81942268015289, 25.76677234597746, 16.87653779146455, 25.81301714373688, 42.10358943495124, 23.965763717523757, 20.302041688107277, 26.738457663870204, 13.842142789007227, 28.454314016572532, 34.95139201211047, 18.54346505856747, 26.942680972682695, 17.841313472333525, 10.20846821511951, 9.237135764886675, 39.63638387584895, 7.4934751016413035, 7.592427693900653, 20.63292276323284, 37.37328083717388, 13.67824310704531, 34.27327752818979, 18.394413861619185, 33.433537838429956, 31.705298383684017, 33.37960652040902, 31.251280983429062, 31.91872849292632, 36.272821362988616, 27.292083746874678, 9.624165008463736, 38.040671323820675, 21.942487912665555, 16.171583949173833, 30.053231790969864, 45.52326818894701, 41.41072722534816, 45.0259041076747, 41.799531561612696, 28.708536598031163, 33.353386170939025, 30.146606853798517, 32.22266708029239, 15.766114639725842, 22.27703793701401, 26.548150857680593, 8.585622546049516, 23.712221175075346, 11.09288656033011, 33.04832944398816, 30.95393142911088, 34.94287806938874, 20.258347817132268, 31.73355101298011, 2.7522992157976542, 38.93713672347029, 26.027992003875507, 34.78528590252066, 34.269368891743554, 42.55220203005253, 18.282298939621647, 40.74457101272518, 7.223417234911886, 24.256808457919384, 12.950653068377957, 12.962707780118663, 41.01473643086081, 21.557427798896402, 32.39178972290863, 25.218014825985037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2913394338216535, "mean_inference_ms": 0.9763795463713929, "mean_action_processing_ms": 0.12981412599632722, "mean_env_wait_ms": 0.06916197144369628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029529333114624023, "StateBufferConnector_ms": 0.002411961555480957, "ViewRequirementAgentConnector_ms": 0.05999100208282471}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 716.016681945362, "num_env_steps_trained_throughput_per_sec": 716.016681945362, "timesteps_total": 792000, "num_env_steps_sampled_lifetime": 792000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 6126.101, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6126.065, "sample_time_ms": 751.052, "learn_time_ms": 5361.171, "learn_throughput": 746.106, "synch_weights_time_ms": 13.46}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 198, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-16-04", "timestamp": 1723396564, "time_this_iter_s": 5.591897010803223, "time_total_s": 1279.4218504428864, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9f65a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1279.4218504428864, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 28.45, "ram_util_percent": 81.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0301033799536525, "cur_kl_coeff": 3.941151930913549e-47, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.046613819025636376, "policy_loss": -0.001102653899336777, "vf_loss": 0.04771647320497626, "vf_explained_var": 0.9978351928293705, "kl": 0.001665093940862262, "entropy": 0.07216939300415107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 190560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0828543353825808, "cur_kl_coeff": 2.5243548967072383e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03496104439812674, "policy_loss": -0.009044072614293934, "vf_loss": 0.04400511668015194, "vf_explained_var": 0.9980616046736638, "kl": 0.003600479486150713, "entropy": 0.3268001323721061, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 190560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 1592000, "num_agent_steps_trained": 1592000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -45.52326818894701, "predator_policy": 2.7522992157976542}, "policy_reward_max": {"prey_policy": -2.7522992157976542, "predator_policy": 45.52326818894701}, "policy_reward_mean": {"prey_policy": -25.8153736980256, "predator_policy": 25.8153736980256}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-24.48308062862095, -12.03291399863243, -10.244437163975048, -29.797956074113934, -39.91337452204493, -19.254472514643187, -27.26417070355789, -16.67997732041417, -28.91602168630235, -20.087917046506504, -34.94920677792449, -31.63760072911613, -32.53782761776712, -29.414231083925696, -8.845080513189178, -30.446188643393636, -11.092714702808001, -25.86854511794859, -39.672496394474884, -40.435481457923245, -40.81942268015289, -25.76677234597746, -16.87653779146455, -25.81301714373688, -42.10358943495124, -23.965763717523757, -20.302041688107277, -26.738457663870204, -13.842142789007227, -28.454314016572532, -34.95139201211047, -18.54346505856747, -26.942680972682695, -17.841313472333525, -10.20846821511951, -9.237135764886675, -39.63638387584895, -7.4934751016413035, -7.592427693900653, -20.63292276323284, -37.37328083717388, -13.67824310704531, -34.27327752818979, -18.394413861619185, -33.433537838429956, -31.705298383684017, -33.37960652040902, -31.251280983429062, -31.91872849292632, -36.272821362988616, -27.292083746874678, -9.624165008463736, -38.040671323820675, -21.942487912665555, -16.171583949173833, -30.053231790969864, -45.52326818894701, -41.41072722534816, -45.0259041076747, -41.799531561612696, -28.708536598031163, -33.353386170939025, -30.146606853798517, -32.22266708029239, -15.766114639725842, -22.27703793701401, -26.548150857680593, -8.585622546049516, -23.712221175075346, -11.09288656033011, -33.04832944398816, -30.95393142911088, -34.94287806938874, -20.258347817132268, -31.73355101298011, -2.7522992157976542, -38.93713672347029, -26.027992003875507, -34.78528590252066, -34.269368891743554, -42.55220203005253, -18.282298939621647, -40.74457101272518, -7.223417234911886, -24.256808457919384, -12.950653068377957, -12.962707780118663, -41.01473643086081, -21.557427798896402, -32.39178972290863, -25.218014825985037, -33.43596949144173, -24.597944340253516, -24.27342639929742, -19.978537948081673, -16.56292154884791, -20.738602451227383, -14.94405349946565, -19.908627427594457, -17.92074583461077], "policy_predator_policy_reward": [24.48308062862095, 12.03291399863243, 10.244437163975048, 29.797956074113934, 39.91337452204493, 19.254472514643187, 27.26417070355789, 16.67997732041417, 28.91602168630235, 20.087917046506504, 34.94920677792449, 31.63760072911613, 32.53782761776712, 29.414231083925696, 8.845080513189178, 30.446188643393636, 11.092714702808001, 25.86854511794859, 39.672496394474884, 40.435481457923245, 40.81942268015289, 25.76677234597746, 16.87653779146455, 25.81301714373688, 42.10358943495124, 23.965763717523757, 20.302041688107277, 26.738457663870204, 13.842142789007227, 28.454314016572532, 34.95139201211047, 18.54346505856747, 26.942680972682695, 17.841313472333525, 10.20846821511951, 9.237135764886675, 39.63638387584895, 7.4934751016413035, 7.592427693900653, 20.63292276323284, 37.37328083717388, 13.67824310704531, 34.27327752818979, 18.394413861619185, 33.433537838429956, 31.705298383684017, 33.37960652040902, 31.251280983429062, 31.91872849292632, 36.272821362988616, 27.292083746874678, 9.624165008463736, 38.040671323820675, 21.942487912665555, 16.171583949173833, 30.053231790969864, 45.52326818894701, 41.41072722534816, 45.0259041076747, 41.799531561612696, 28.708536598031163, 33.353386170939025, 30.146606853798517, 32.22266708029239, 15.766114639725842, 22.27703793701401, 26.548150857680593, 8.585622546049516, 23.712221175075346, 11.09288656033011, 33.04832944398816, 30.95393142911088, 34.94287806938874, 20.258347817132268, 31.73355101298011, 2.7522992157976542, 38.93713672347029, 26.027992003875507, 34.78528590252066, 34.269368891743554, 42.55220203005253, 18.282298939621647, 40.74457101272518, 7.223417234911886, 24.256808457919384, 12.950653068377957, 12.962707780118663, 41.01473643086081, 21.557427798896402, 32.39178972290863, 25.218014825985037, 33.43596949144173, 24.597944340253516, 24.27342639929742, 19.978537948081673, 16.56292154884791, 20.738602451227383, 14.94405349946565, 19.908627427594457, 17.92074583461077]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29141126253599403, "mean_inference_ms": 0.9766523558149304, "mean_action_processing_ms": 0.12984773528792842, "mean_env_wait_ms": 0.06917987507545345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029000043869018555, "StateBufferConnector_ms": 0.002361774444580078, "ViewRequirementAgentConnector_ms": 0.058672547340393066}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1592000, "num_agent_steps_trained": 1592000, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 748.4954329071511, "num_env_steps_trained_throughput_per_sec": 748.4954329071511, "timesteps_total": 796000, "num_env_steps_sampled_lifetime": 796000, "num_agent_steps_sampled_lifetime": 1592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1592000, "timers": {"training_iteration_time_ms": 6029.55, "restore_workers_time_ms": 0.013, "training_step_time_ms": 6029.514, "sample_time_ms": 736.491, "learn_time_ms": 5279.096, "learn_throughput": 757.705, "synch_weights_time_ms": 13.545}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 1592000, "num_agent_steps_trained": 1592000}, "done": false, "training_iteration": 199, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-16-09", "timestamp": 1723396569, "time_this_iter_s": 5.348213195800781, "time_total_s": 1284.7700636386871, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9e2fe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1284.7700636386871, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 27.7625, "ram_util_percent": 81.02499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1392255064410468, "cur_kl_coeff": 1.9705759654567745e-47, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0790251970817432, "policy_loss": -0.000632496467975822, "vf_loss": 0.07965769326207615, "vf_explained_var": 0.9949022348349293, "kl": 0.001862257028679252, "entropy": 0.07952357797767036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 191520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0347146003507077, "cur_kl_coeff": 1.2621774483536191e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07051134287200209, "policy_loss": -0.014964420071676917, "vf_loss": 0.08547576202690835, "vf_explained_var": 0.9941839881241321, "kl": 0.0034675658331920324, "entropy": 0.32078889695306617, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 191520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 50000, "policy_reward_min": {"prey_policy": -45.52326818894701, "predator_policy": -0.8302307817541759}, "policy_reward_max": {"prey_policy": 0.8302307817541759, "predator_policy": 45.52326818894701}, "policy_reward_mean": {"prey_policy": -25.836799935329797, "predator_policy": 25.836799935329797}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_prey_policy_reward": [-20.087917046506504, -34.94920677792449, -31.63760072911613, -32.53782761776712, -29.414231083925696, -8.845080513189178, -30.446188643393636, -11.092714702808001, -25.86854511794859, -39.672496394474884, -40.435481457923245, -40.81942268015289, -25.76677234597746, -16.87653779146455, -25.81301714373688, -42.10358943495124, -23.965763717523757, -20.302041688107277, -26.738457663870204, -13.842142789007227, -28.454314016572532, -34.95139201211047, -18.54346505856747, -26.942680972682695, -17.841313472333525, -10.20846821511951, -9.237135764886675, -39.63638387584895, -7.4934751016413035, -7.592427693900653, -20.63292276323284, -37.37328083717388, -13.67824310704531, -34.27327752818979, -18.394413861619185, -33.433537838429956, -31.705298383684017, -33.37960652040902, -31.251280983429062, -31.91872849292632, -36.272821362988616, -27.292083746874678, -9.624165008463736, -38.040671323820675, -21.942487912665555, -16.171583949173833, -30.053231790969864, -45.52326818894701, -41.41072722534816, -45.0259041076747, -41.799531561612696, -28.708536598031163, -33.353386170939025, -30.146606853798517, -32.22266708029239, -15.766114639725842, -22.27703793701401, -26.548150857680593, -8.585622546049516, -23.712221175075346, -11.09288656033011, -33.04832944398816, -30.95393142911088, -34.94287806938874, -20.258347817132268, -31.73355101298011, -2.7522992157976542, -38.93713672347029, -26.027992003875507, -34.78528590252066, -34.269368891743554, -42.55220203005253, -18.282298939621647, -40.74457101272518, -7.223417234911886, -24.256808457919384, -12.950653068377957, -12.962707780118663, -41.01473643086081, -21.557427798896402, -32.39178972290863, -25.218014825985037, -33.43596949144173, -24.597944340253516, -24.27342639929742, -19.978537948081673, -16.56292154884791, -20.738602451227383, -14.94405349946565, -19.908627427594457, -17.92074583461077, -24.83452225518088, -37.90353680443783, -38.28398115047942, -11.331857314068053, -6.468987212793847, 0.8302307817541759, -21.032516530684454, -45.03688975874191, -26.66696809809316], "policy_predator_policy_reward": [20.087917046506504, 34.94920677792449, 31.63760072911613, 32.53782761776712, 29.414231083925696, 8.845080513189178, 30.446188643393636, 11.092714702808001, 25.86854511794859, 39.672496394474884, 40.435481457923245, 40.81942268015289, 25.76677234597746, 16.87653779146455, 25.81301714373688, 42.10358943495124, 23.965763717523757, 20.302041688107277, 26.738457663870204, 13.842142789007227, 28.454314016572532, 34.95139201211047, 18.54346505856747, 26.942680972682695, 17.841313472333525, 10.20846821511951, 9.237135764886675, 39.63638387584895, 7.4934751016413035, 7.592427693900653, 20.63292276323284, 37.37328083717388, 13.67824310704531, 34.27327752818979, 18.394413861619185, 33.433537838429956, 31.705298383684017, 33.37960652040902, 31.251280983429062, 31.91872849292632, 36.272821362988616, 27.292083746874678, 9.624165008463736, 38.040671323820675, 21.942487912665555, 16.171583949173833, 30.053231790969864, 45.52326818894701, 41.41072722534816, 45.0259041076747, 41.799531561612696, 28.708536598031163, 33.353386170939025, 30.146606853798517, 32.22266708029239, 15.766114639725842, 22.27703793701401, 26.548150857680593, 8.585622546049516, 23.712221175075346, 11.09288656033011, 33.04832944398816, 30.95393142911088, 34.94287806938874, 20.258347817132268, 31.73355101298011, 2.7522992157976542, 38.93713672347029, 26.027992003875507, 34.78528590252066, 34.269368891743554, 42.55220203005253, 18.282298939621647, 40.74457101272518, 7.223417234911886, 24.256808457919384, 12.950653068377957, 12.962707780118663, 41.01473643086081, 21.557427798896402, 32.39178972290863, 25.218014825985037, 33.43596949144173, 24.597944340253516, 24.27342639929742, 19.978537948081673, 16.56292154884791, 20.738602451227383, 14.94405349946565, 19.908627427594457, 17.92074583461077, 24.83452225518088, 37.90353680443783, 38.28398115047942, 11.331857314068053, 6.468987212793847, -0.8302307817541759, 21.032516530684454, 45.03688975874191, 26.66696809809316]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2914722835783211, "mean_inference_ms": 0.9768879688926142, "mean_action_processing_ms": 0.12987882052320537, "mean_env_wait_ms": 0.06919437452818046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002853989601135254, "StateBufferConnector_ms": 0.0023010969161987305, "ViewRequirementAgentConnector_ms": 0.05785834789276123}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 740.8583203650574, "num_env_steps_trained_throughput_per_sec": 740.8583203650574, "timesteps_total": 800000, "num_env_steps_sampled_lifetime": 800000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 5957.272, "restore_workers_time_ms": 0.013, "training_step_time_ms": 5957.237, "sample_time_ms": 732.048, "learn_time_ms": 5211.542, "learn_throughput": 767.527, "synch_weights_time_ms": 13.269}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 200, "trial_id": "5fdfb_00000", "date": "2024-08-11_13-16-14", "timestamp": 1723396574, "time_this_iter_s": 5.4036431312561035, "time_total_s": 1290.1737067699432, "pid": 32170, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "grid_size": 50, "max_steps": 500, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9efcb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1290.1737067699432, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 28.525, "ram_util_percent": 81.025}}
